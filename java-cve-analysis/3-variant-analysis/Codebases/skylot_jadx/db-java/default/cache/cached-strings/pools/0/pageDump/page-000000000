import PrintStreamimport Fieldimport ArrayListimport Arraysimport LinkedHashMapimport LinkedListimport Listimport Mapimport Nullableimport JCommanderimport ParameterDescriptionimport ParameterExceptionimport Parameterizedimport JadxDecompilerJCommander jc, ...;stmtsuper(...)...=...this.jcbuild(...)addObject(...)newBuilder(...)...[]parse(...)ParameterException eprintln(...)System.err... + ...getMessage(...)printUsage(...)List<ParameterDescription> fieldsParamsgetParameters(...)List<ParameterDescription> parametersnew ArrayList<ParameterDescription>(...)p3p4p5p6p7p8p9size(...)add(...)getMainParameterValue(...)addAll(...)ParameterDescription parameterisAssigned(...)Parameterized parameterizedgetParameterized(...)Object valget(...)getObject(...)set(...)PrintStream outSystem.outList<ParameterDescription> paramsMap<String,ParameterDescription> paramsMapnew LinkedHashMap<String,ParameterDescription>(...)p10p11p12p13p14p15p16p17p18p19int maxNamesLenJadxCLIArgs args(...)...getObjects(...)getVersion(...)getMainParameterDescription(...)ParameterDescription pint lenlength(...)getNames(...)put(...)getName(...)... > ...Field fgetFields(...)getClass(...)String nameStringBuilder optnew StringBuilder(...)String defaultValuegetDefaultValue(...)... == ...append(...)addSpaces(...)... - ...getDescription(...)... != .../** Get all declared fields of the specified class and all super classes ... */? ...List<Field> fieldListnew LinkedList<Field>(...)asList(...)getDeclaredFields(...)getSuperclass(...)Class<?> fieldTypegetType(...)int.classtoString(...)getInt(...)String.classisAssignableFrom(...)Enum<>.classEnum<?> valname(...)Exception eint i... < ......++// copy assigned field value to obj// print usage in not sorted fields order (by default its sorted by description)// ignoreimport Loggerimport LoggerFactoryimport JadxArgsimport NoOpCodeCacheimport JadxArgsValidateExceptionimport FileUtilsgetLogger(...)JadxCLI.classLogger LOG, ...;int resultexecute(...)JadxArgsValidateException eerror(...)deleteTempRootDir(...)exit(...)JadxCLIArgs jadxArgsnew JadxCLIArgs(...)processArgs(...)processAndSave(...)toJadxArgs(...)setCodeCache(...)new NoOpCodeCache(...)JadxDecompiler jadxnew JadxDecompiler(...)int errorsCountgetErrorsCount(...)load(...)save(...)printErrorsReport(...)info(...)import EnumSetimport Localeimport Setimport Collectorsimport Streamimport IStringConverterimport Parameterimport RenameEnumimport JadxExceptionnew ArrayList<String>(...)JadxArgs.DEFAULT_THREADS_COUNTallOf(...)RenameEnum.classLogHelper.LogLevelEnum.PROGRESSLogHelper.LogLevelEnum<obinit>(...)List<String> files, ...;String outDir, ...;String outDirSrc, ...;String outDirRes, ...;boolean skipResources, ...;boolean skipSources, ...;String singleClass, ...;String outputFormat, ...;boolean exportAsGradleProject, ...;int threadsCount, ...;boolean showInconsistentCode, ...;boolean useImports, ...;boolean debugInfo, ...;boolean inlineAnonymousClasses, ...;boolean replaceConsts, ...;boolean escapeUnicode, ...;boolean respectBytecodeAccessModifiers, ...;boolean deobfuscationOn, ...;int deobfuscationMinLength, ...;int deobfuscationMaxLength, ...;String deobfuscationMapFile, ...;boolean deobfuscationForceSave, ...;boolean deobfuscationUseSourceNameAsAlias, ...;boolean deobfuscationParseKotlinMetadata, ...;Set<RenameEnum> renameFlags, ...;RenameConverter.classboolean fsCaseSensitive, ...;boolean cfgOutput, ...;boolean rawCfgOutput, ...;boolean fallbackMode, ...;boolean verbose, ...;boolean quiet, ...;LogHelper.LogLevelEnum logLevel, ...;LogHelper.LogLevelConverter.classLogHelper.LogLevelConverterboolean printVersion, ...;boolean printHelp, ...;JCommanderWrapper<JadxCLIArgs> jcwnew JCommanderWrapper<JadxCLIArgs>(...)... && ...process(...)/** Set values only for options provided in cmd. ... */newInstance(...)!...overrideProvided(...)... <= ...new JadxException(...)setLogLevelFromArgs(...)JadxException eJadxArgs argsnew JadxArgs(...)setInputFiles(...)collect(...)map(...)toList(...)stream(...)...::...new Function<String,File>(...) { ... }toFile(...)setOutDir(...)setOutDirSrc(...)setOutDirRes(...)setOutputFormat(...)valueOf(...)JadxArgs.OutputFormatEnumtoUpperCase(...)setThreadsCount(...)setSkipSources(...)setClassFilter(...)...->...new Predicate<String>(...) { ... }equals(...)setSkipResources(...)setFallbackMode(...)setShowInconsistentCode(...)setCfgOutput(...)setRawCFGOutput(...)setReplaceConsts(...)setDeobfuscationOn(...)setDeobfuscationMapFile(...)setDeobfuscationForceSave(...)setDeobfuscationMinLength(...)setDeobfuscationMaxLength(...)setUseSourceNameAsClassAlias(...)setParseKotlinMetadata(...)setEscapeUnicode(...)setRespectBytecodeAccModifiers(...)setExportAsGradleProject(...)setUseImports(...)setDebugInfo(...)setInlineAnonymousClasses(...)setRenameCaseSensitive(...)isRenameCaseSensitive(...)setRenameValid(...)isRenameValid(...)setRenamePrintable(...)isRenamePrintable(...)setFsCaseSensitive(...)contains(...)RenameEnum.CASERenameEnum.VALIDRenameEnum.PRINTABLEString paramName, ...;this.paramNameSet<RenameEnum> setnoneOf(...)equalsIgnoreCase(...)String ssplit(...)Locale.ROOTIllegalArgumentException enew IllegalArgumentException(...)enumValuesString(...)values(...)joining(...)of(...)new Function<Enum<?>,String>(...) { ... }toLowerCase(...)import LevelLogHelper.classnew LogLevelEnum(...)Level.OFFLevel.ERRORLevel.WARNLevel.INFOLevel.DEBUGLogLevelEnum QUIET, ...;LogLevelEnum PROGRESS, ...;LogLevelEnum ERROR, ...;LogLevelEnum WARN, ...;LogLevelEnum INFO, ...;LogLevelEnum DEBUG, ...;Level level, ...;this.levelLogLevelEnum logLevelargs.logLevelisCustomLogConfig(...)args.quietLogLevelEnum.QUIETargs.verboseLogLevelEnum.DEBUGapplyLogLevel(...)Logger rootLoggerLogger.ROOT_LOGGER_NAMEsetLevel(...)getLevel(...)setLevelForClass(...)JadxDecompiler.class/** Try to detect if user provide custom logback config via -Dlogback.configurationFile= */String logbackConfiggetProperty(...)debug(...)// show progress for all levels except quietimport Pathimport Pathsimport JadxPluginManagerimport JadxInputPluginimport ILoadResultimport ClsSetimport ClassNodeimport RootNodeimport SignatureProcessor/** Utility class for convert dex or jar to jadx classes set (.jcst) */ConvertToClsSet.classList<Path> inputPathsnew Function<String,Path>(...) { ... }Path outputremove(...)JadxPluginManager pluginManagernew JadxPluginManager(...)List<ILoadResult> loadedInputsnew ArrayList<ILoadResult>(...)JadxArgs jadxArgsRootNode rootnew RootNode(...)SignatureProcessor signatureProcessornew SignatureProcessor(...)ClsSet setnew ClsSet(...)args.lengthusage(...)JadxInputPlugin inputPlugingetInputPlugins(...)loadFiles(...)setRenameFlags(...)JadxArgs.RenameEnum.classJadxArgs.RenameEnumloadClasses(...)init(...)ClassNode classNodegetClasses(...)visit(...)loadFrom(...)// from pre-decompilation stage run only SignatureProcessorimport BufferedInputStreamimport IOExceptionimport InputStreamimport Filesimport HashMapimport ZipEntryimport ZipFileimport TextResMapFileimport ResTableParser/** Utility class for convert '.arsc' to simple text file with mapping id to resource name */ConvertArscFile.classint rewritesCount, ...;Path resMapFileMap<Integer,String> resMapisReadable(...)read(...)new HashMap<Integer,String>(...)Path resFileResTableParser resTableParsernew ResTableParser(...)Map<Integer,String> singleResMapgetResourcesNames(...)getResStorage(...)endsWith(...)getFileName(...)ZipFile zipnew ZipFile(...)ZipEntry entrygetEntry(...)InputStream inputStreamgetInputStream(...)decode(...)new BufferedInputStream(...)newInputStream(...)mergeResMaps(...)write(...)Entry<Integer,String> entryMap<>.Entry<Integer,String>entrySet(...)Integer idgetKey(...)getValue(...)String prevNametoHexString(...)// not really needed// Load resources.arsc from android.jar// Load resources.arsc from extracted fileimport Testimport static MatcherAssert.assertThatimport static Matchers.isJadxCLIArgsTest.classassertThat(...)isReplaceConsts(...)is(...)isEscapeUnicode(...)isSkipSources(...)isUseImports(...)override(...)isDebugInfo(...)args.useImportsargs.debugInfoboolean resimport BeforeEachimport RenameConverterimport static Assertions.assertEqualsimport static Assertions.assertThrowsimport static Assertions.assertTrueRenameConverter converter, ...;new RenameConverter(...)convert(...)assertEquals(...)assertTrue(...)isEmpty(...)IllegalArgumentException thrownassertThrows(...)IllegalArgumentException.classnew Executable(...) { ... }import URISyntaxExceptionimport URLimport LinkOptionimport PathMatcherimport AfterAllimport static Assertions.assertThatTestInput.classdecompile(...)StringBuilder argsPath tempDircreateTempDir(...)List<Path> resultJavaFilescollectJavaFilesInDir(...)PathMatcher logAllFilesnew PathMatcher(...) { ... }toAbsolutePath(...)String inputSampleURL resourcegetResource(...)getClassLoader(...)String sampleFilegetRawPath(...)toURI(...)isNotNull(...)isEqualTo(...)isNotEmpty(...)Path pathcollectFilesInDir(...)doesNotContain(...)PathMatcher javaMatchergetPathMatcher(...)getFileSystem(...)Stream<Path> pathStreamwalk(...)filter(...)new Predicate<Path>(...) { ... }isRegularFile(...)LinkOption.NOFOLLOW_LINKSmatches(...)clearTempRootDir(...)// do not copy input files as resources-...JavaNode node, ...;int line, ...;int offset, ...;int usagePosition, ...;this.nodethis.linethis.offsetthis.usagePositionJavaClass parentgetDeclaringClass(...)...instanceof...CodePosition that... || ...that.linethat.offset... * ...StringBuilder sbimport SimpleCodeInfonew SimpleCodeInfo(...)ICodeInfo EMPTY, ...;import Fileimport Collectionsimport Predicateimport InMemoryCodeCachenew ArrayList<File>(...)new InMemoryCodeCache(...)OutputFormatEnum.JAVAmax(...)... / ...availableProcessors(...)getRuntime(...)int DEFAULT_THREADS_COUNT, ...;String DEFAULT_OUT_DIR, ...;String DEFAULT_SRC_DIR, ...;String DEFAULT_RES_DIR, ...;List<File> inputFiles, ...;File outDir, ...;File outDirSrc, ...;File outDirRes, ...;ICodeCache codeCache, ...;boolean rawCFGOutput, ...;Predicate<String> classFilter, ...;/** Predicate that allows to filter the classes to be process based on their full name */boolean useSourceNameAsClassAlias, ...;boolean parseKotlinMetadata, ...;File deobfuscationMapFile, ...;boolean respectBytecodeAccModifiers, ...;new RenameEnum(...)RenameEnum CASE, ...;RenameEnum VALID, ...;RenameEnum PRINTABLE, ...;new OutputFormatEnum(...)OutputFormatEnum JAVA, ...;OutputFormatEnum JSON, ...;OutputFormatEnum outputFormat, ...;new File(...)this.inputFilessingletonList(...)this.outDirthis.outDirSrcthis.outDirResthis.threadsCountthis.cfgOutputthis.rawCFGOutputthis.fallbackModethis.showInconsistentCodethis.useImportsthis.debugInfothis.inlineAnonymousClassesthis.skipResourcesthis.skipSourcesthis.classFilterthis.deobfuscationOnthis.deobfuscationForceSavethis.useSourceNameAsClassAliasthis.parseKotlinMetadatathis.deobfuscationMinLengththis.deobfuscationMaxLengththis.deobfuscationMapFilethis.escapeUnicodethis.replaceConststhis.respectBytecodeAccModifiersthis.exportAsGradleProjectthis.fsCaseSensitiveupdateRenameFlag(...)this.renameFlagsOutputFormatEnum.JSONthis.outputFormatthis.codeCache// use default optionsimport NotNullException.classJadxArgsValidator.classcheckInputFiles(...)validateOutDirs(...)isDebugEnabled(...)List<File> inputFilesgetInputFiles(...)new JadxArgsValidateException(...)File inputFileString fileNamestartsWith(...)File filecheckFile(...)File outDirgetOutDir(...)File srcDirgetOutDirSrc(...)File resDirgetOutDirRes(...)makeDirFromInput(...)JadxArgs.DEFAULT_SRC_DIRJadxArgs.DEFAULT_RES_DIRcheckDir(...)String outDirNameint poslastIndexOf(...)substring(...)JadxArgs.DEFAULT_OUT_DIRexists(...)getAbsolutePath(...)isDirectory(...)import Closeableimport Collectionimport Comparatorimport Objectsimport ConcurrentHashMapimport ExecutorServiceimport Executorsimport TimeUnitimport JadxPluginimport Jadximport AFlagimport LineAttrNodeimport jadx.core.dex.nodes.*import SaveCodeimport ExportGradleProjectimport Utilsimport JadxRuntimeExceptionimport BinaryXMLParserimport ResContainerimport ResourcesSaver/** Jadx API usage example: ... */new ConcurrentHashMap<ClassNode,JavaClass>(...)new ConcurrentHashMap<MethodNode,JavaMethod>(...)new ConcurrentHashMap<FieldNode,JavaField>(...)JadxArgs args, ...;JadxPluginManager pluginManager, ...;List<ILoadResult> loadedInputs, ...;RootNode root, ...;List<JavaClass> classes, ...;List<ResourceFile> resources, ...;BinaryXMLParser xmlParser, ...;Map<ClassNode,JavaClass> classesMap, ...;Map<MethodNode,JavaMethod> methodsMap, ...;Map<FieldNode,JavaField> fieldsMap, ...;this(...)this.argsreset(...)validate(...)loadInputFiles(...)initClassPath(...)loadResources(...)getResources(...)runPreDecompileStage(...)initPasses(...)collectionMap(...)new Function<File,Path>(...) { ... }toPath(...)clear(...)ILoadResult loadResultcloseInputs(...)forEach(...)new Consumer<ILoadResult>(...) { ... }close(...)register(...)isSkipResources(...)ExecutorService exgetSaveExecutor(...)shutdown(...)awaitTermination(...)TimeUnit.DAYSInterruptedException einterrupt(...)currentThread(...)int threadsCountgetThreadsCount(...)ExecutorService executornewFixedThreadPool(...)File sourcesOutDirFile resOutDirnew JadxRuntimeException(...)isExportAsGradleProject(...)ResourceFile androidManifestorElseThrow(...)findFirst(...)new Predicate<ResourceFile>(...) { ... }ResourceType.MANIFESTnew Supplier<IllegalStateException>(...) { ... }new IllegalStateException(...)ResContainer stringsgetSubFiles(...)loadContent(...)ResourceType.ARSCnew Predicate<ResContainer>(...) { ... }ExportGradleProject exportnew ExportGradleProject(...)getSrcOutDir(...)getResOutDir(...)appendResourcesSave(...)appendSourcesSave(...)Set<String> inputFileNamestoSet(...)new Function<File,String>(...) { ... }ResourceFile resourceFilegetOriginalName(...)new ResourcesSaver(...)Predicate<String> classFiltergetClassFilter(...)JavaClass clsgetClassNode(...)AFlag.DONT_GENERATEtest(...)getFullName(...)new Runnable(...) { ... }ICodeInfo codegetCodeInfo(...)emptyList(...)List<ClassNode> classNodeListList<JavaClass> clsListnew ArrayList<JavaClass>(...)JavaClass javaClassnew JavaClass(...)unmodifiableList(...)new ResourcesLoader(...)List<JavaClass> classListMap<String,List<JavaClass>> mapnew HashMap<String,List<JavaClass>>(...)List<JavaPackage> packagesnew ArrayList<JavaPackage>(...)String pkggetPackage(...)computeIfAbsent(...)new Function<String,List<JavaClass>>(...) { ... }Entry<String,List<JavaClass>> entryMap<>.Entry<String,List<JavaClass>>new JavaPackage(...)sort(...)JavaPackage pkgcomparing(...)String.CASE_INSENSITIVE_ORDERnew Function<JavaClass,String>(...) { ... }getErrorCount(...)getErrorsCounter(...)getWarnsCount(...)printMissingClasses(...)getClsp(...)printReport(...)/** Internal API. Not Stable! */new BinaryXMLParser(...)getMethods(...)new Consumer<JavaMethod>(...) { ... }getMethodNode(...)new Consumer<JavaField>(...) { ... }getFieldNode(...)JavaClass innerClsgetInnerClasses(...)loadJavaClass(...)ClassNode parentClassgetTopParentClass(...)JavaClass parentJavaClasshasNotGeneratedParent(...)JavaMethod javaMethodgetJavaClassByNode(...)getParentClass(...)JavaField javaFieldLineAttrNode nodegetJavaMethodByNode(...)getJavaFieldByNode(...)VariableNode varNodenew JavaVariable(...)new Function<?,JavaNode>(...) { ... }convertNode(...)new Predicate<JavaNode>(...) { ... }nonNull(...)Map<CodePosition,Object> mapgetAnnotations(...)new CodePosition(...)JavaClass jClsint defLinegetDecompiledLine(...)// ignore resource made from input file// load parent class if inner// class or parent classes can be excluded from generation// parent class not loaded yetimport AccessInfoimport FieldNodeimport MethodNodeJadxDecompiler decompiler, ...;ClassNode cls, ...;JavaClass parent, ...;List<JavaClass> innerClasses, ...;List<JavaField> fields, ...;List<JavaMethod> methods, ...;boolean listsLoaded, ...;this.decompilerthis.clsthis.parent/** Inner classes constructor */getCodeStr(...)reloadCode(...)getSmali(...)unload(...)int inClsCountint fieldsCountint methodsCountList<JavaClass> listClassNode innerloadLists(...)this.innerClassesList<JavaField> fldsnew ArrayList<JavaField>(...)FieldNode fnew JavaField(...)this.fieldsList<JavaMethod> mthsnew ArrayList<JavaMethod>(...)MethodNode mnew JavaMethod(...)new Function<JavaMethod,String>(...) { ... }this.methodsgetRootDecompiler(...)emptyMap(...)getCodeAnnotations(...)Map<CodePosition,JavaNode> resultMapnew HashMap<CodePosition,JavaNode>(...)Entry<CodePosition,Object> entryMap<>.Entry<CodePosition,Object>CodePosition codePositionJavaNode nodeconvertNodes(...)getUseIn(...)getJavaNodeAtPosition(...)getDefinitionPosition(...)getLineMapping(...)getShortName(...)getRawName(...)...?...:...getAccessFlags(...)(...).clshashCode(...)import ArgTypeFieldNode field, ...;this.fieldgetAlias(...)tryToResolveClassAlias(...)root(...)(...).fieldimport ATypeimport MethodOverrideAttrMethodNode mth, ...;this.mthgetMethodInfo(...)List<ArgType> infoArgTypesgetArgumentsTypes(...)List<ArgType> argumentsgetArgTypes(...)new Function<ArgType,ArgType>(...) { ... }ArgType retTypegetReturnType(...)MethodOverrideAttr ovrdAttrAType<>.METHOD_OVERRIDEJadxDecompiler decompilergetRelatedMthNodes(...)isConstructor(...)isClassInit(...)(...).mthString name, ...;this.namethis.classescompareTo(...)o.nameJavaPackage thatthat.name// TODO: store full package nameimport VariableNodeJavaClass cls, ...;VariableNode node, ...;getVariableNode(...)import ZipSecurityimport ResourceEntryFile zipFile, ...;String entryName, ...;this.zipFilethis.entryNameResourceType type, ...;ZipRef zipRef, ...;String deobfName, ...;isValidZipEntryName(...)new ResourceFile(...)this.typethis.zipRefint indexformat(...)getTypeName(...)getConfig(...)getKeyName(...)ICodeInfo content, ...;this.contenttextResource(...)getDeobfName(...)new ResourceType(...)new HashMap<String,ResourceType>(...)ResourceType typeString extgetExts(...)ResourceType prevResourceType CODE, ...;ResourceType XML, ...;ResourceType ARSC, ...;ResourceType FONT, ...;ResourceType IMG, ...;ResourceType MEDIA, ...;ResourceType LIB, ...;ResourceType MANIFEST, ...;ResourceType UNKNOWN, ...;...[] exts, ...;this.extsMap<String,ResourceType> EXT_MAP, ...;int dotResourceType resTypeimport ByteArrayOutputStreamimport FileInputStreamimport ZipRefimport CodeWriterimport Res9patchStreamDecoderimport static FileUtils.READ_BUFFER_SIZEimport static FileUtils.copyStream// TODO: move to core packageResourcesLoader.classJadxDecompiler jadxRef, ...;this.jadxRefgetArgs(...)List<ResourceFile> listnew ArrayList<ResourceFile>(...)loadFile(...)ZipRef zipRefgetZipRef(...)new FileInputStream(...)ZipFile zipFilegetZipFile(...)getEntryName(...)new IOException(...)isValidZipEntry(...)getInputStreamForEntry(...)getSize(...)decodeStream(...)new ResourceDecoder<ResContainer>(...) { ... }CodeWriter cwnew CodeWriter(...)appendStackTrace(...)getCause(...)finish(...)ICodeInfo contentgetXmlParser(...)decodeFiles(...)getRoot(...)decodeImage(...)resourceFileLink(...)ByteArrayOutputStream osnew ByteArrayOutputStream(...)Res9patchStreamDecoder decodernew Res9patchStreamDecoder(...)decodedData(...)toByteArray(...)isZipFile(...)visitZipEntries(...)new BiFunction<ZipFile,ZipEntry,Object>(...) { ... }addEntry(...)addResourceFile(...)getFileType(...)ResourceFile rfcreateResourceFile(...)setZipRef(...)new ZipRef(...)ByteArrayOutputStream baoscopyStream(...)import ICodeCacheimport ICodeInfonew ConcurrentHashMap<String,ICodeInfo>(...)Map<String,ICodeInfo> storage, ...;// do nothingimport CodePositionString code, ...;Map<Integer,Integer> lineMapping, ...;Map<CodePosition,Object> annotations, ...;this.codethis.lineMappingthis.annotationsboolean DEBUG, ...;boolean DEBUG_WITH_ERRORS, ...;boolean DEBUG_USAGE, ...;// TODO: fix errorsboolean DEBUG_TYPE_INFERENCE, ...;boolean DEBUG_OVERLOADED_CASTS, ...;String CLASS_OBJECT, ...;String CLASS_STRING, ...;String CLASS_CLASS, ...;String CLASS_THROWABLE, ...;String CLASS_EXCEPTION, ...;String CLASS_ENUM, ...;String CLASS_STRING_BUILDER, ...;String DALVIK_ANNOTATION_PKG, ...;String DALVIK_SIGNATURE, ...;String DALVIK_INNER_CLASS, ...;String DALVIK_THROWS, ...;String DALVIK_ANNOTATION_DEFAULT, ...;String DEFAULT_PACKAGE_NAME, ...;String ANONYMOUS_CLASS_PREFIX, ...;String MTH_TOSTRING_SIGNATURE, ...;import Enumerationimport Manifestimport AttachMethodDetailsimport AttachTryCatchVisitorimport ClassModifierimport ConstInlineVisitorimport ConstructorVisitorimport DeboxingVisitorimport DotGraphVisitorimport EnumVisitorimport ExtractFieldInitimport FallbackModeVisitorimport FixAccessModifiersimport GenericTypesVisitorimport IDexTreeVisitorimport InitCodeVariablesimport InlineMethodsimport MarkFinallyVisitorimport MarkMethodsForInlineimport MethodInvokeVisitorimport ModVisitorimport MoveInlineVisitorimport OverrideMethodVisitorimport PrepareForCodeGenimport ProcessAnonymousimport ProcessInstructionsVisitorimport ReSugarCodeimport RenameVisitorimport ShadowFieldVisitorimport SimplifyVisitorimport BlockExceptionHandlerimport BlockFinishimport BlockProcessorimport BlockSplitterimport DebugInfoApplyVisitorimport DebugInfoAttachVisitorimport CheckRegionsimport CleanRegionsimport IfRegionVisitorimport LoopRegionVisitorimport RegionMakerVisitorimport ReturnVisitorimport ProcessVariablesimport CodeShrinkVisitorimport SSATransformimport TypeInferenceVisitorimport UsageInfoVisitorJadx.classConsts.DEBUGList<IDexTreeVisitor> passesnew ArrayList<IDexTreeVisitor>(...)new AttachTryCatchVisitor(...)new ProcessInstructionsVisitor(...)new FallbackModeVisitor(...)new OverrideMethodVisitor(...)new RenameVisitor(...)new UsageInfoVisitor(...)isFallbackMode(...)getFallbackPassesList(...)new DebugInfoAttachVisitor(...)new BlockSplitter(...)isRawCFGOutput(...)dumpRaw(...)new BlockProcessor(...)new BlockExceptionHandler(...)new BlockFinish(...)new AttachMethodDetails(...)new SSATransform(...)new MoveInlineVisitor(...)new ConstructorVisitor(...)new InitCodeVariables(...)new MarkFinallyVisitor(...)new ConstInlineVisitor(...)new TypeInferenceVisitor(...)new DebugInfoApplyVisitor(...)new InlineMethods(...)new GenericTypesVisitor(...)new ShadowFieldVisitor(...)new DeboxingVisitor(...)new ModVisitor(...)new CodeShrinkVisitor(...)new ReSugarCode(...)isCfgOutput(...)dump(...)new RegionMakerVisitor(...)new IfRegionVisitor(...)new ReturnVisitor(...)new CleanRegions(...)new MethodInvokeVisitor(...)new SimplifyVisitor(...)new CheckRegions(...)new EnumVisitor(...)new ExtractFieldInit(...)new FixAccessModifiers(...)new ProcessAnonymous(...)new ClassModifier(...)new LoopRegionVisitor(...)new MarkMethodsForInline(...)new ProcessVariables(...)new PrepareForCodeGen(...)dumpRegions(...)ClassLoader classLoaderEnumeration<URL> resourceshasMoreElements(...)InputStream isopenStream(...)nextElement(...)Manifest manifestnew Manifest(...)String vergetMainAttributes(...)import CodeGenimport LoadStageimport DepthTraversalimport static ProcessState.GENERATED_AND_UNLOADEDimport static ProcessState.LOADEDimport static ProcessState.NOT_LOADEDimport static ProcessState.PROCESS_COMPLETEimport static ProcessState.PROCESS_STARTEDgetState(...)getClassInfo(...)AFlag.CLASS_DEEP_RELOADdeepUnload(...)runPreDecompileStageForClass(...)setState(...)setLoadStage(...)LoadStage.CODEGEN_STAGEAFlag.RELOAD_AT_CODEGEN_STAGELoadStage.PROCESS_STAGEIDexTreeVisitor visitorgetPasses(...)generate(...)AFlag.DONT_UNLOAD_CLASSThrowable eaddError(...)getSimpleName(...)ClassNode topParentClassgenerateCode(...)ClassNode depClsgetDependencies(...)// nothing to do// allow to run code generation againimport BufferedOutputStreamimport DataInputStreamimport DataOutputStreamimport OutputStreamimport StandardCopyOptionimport ZipInputStreamimport ZipOutputStreamimport ClassInfoimport MethodInfoimport DecodeException/** Classes list for import into classpath graph */ClsSet.classnew ArgType[]String CLST_EXTENSION, ...;String CLST_FILENAME, ...;String CLST_PATH, ...;String JADX_CLS_SET_HEADER, ...;int VERSION, ...;String STRING_CHARSET, ...;...[] EMPTY_ARGTYPE_ARRAY, ...;this.rootnew TypeEnum(...)TypeEnum WILDCARD, ...;TypeEnum GENERIC, ...;TypeEnum GENERIC_TYPE_VARIABLE, ...;TypeEnum OUTER_GENERIC, ...;TypeEnum OBJECT, ...;TypeEnum ARRAY, ...;TypeEnum PRIMITIVE, ...;...[] classes, ...;long startTimecurrentTimeMillis(...)InputStream inputgetResourceAsStream(...)long timesum(...)mapToInt(...)new ToIntFunction<ClspClass>(...) { ... }getMethodsMap(...)classes.lengthList<ClassNode> listMap<String,ClspClass> namesnew HashMap<String,ClspClass>(...)int kClassNode clsArgType clsTypeString clsRawNameClspClass nClassnew ClspClass(...)setTypeParameters(...)getGenericTypeParameters(...)setMethods(...)getMethodsDetails(...)new ClspClass[]getCls(...)setParents(...)makeParentsArray(...)...[...]List<MethodNode> methodsListList<ClspMethod> methodsnew ArrayList<ClspMethod>(...)MethodNode mthprocessMethodDetails(...)AccessInfo accessFlagsClspMethod clspMethodnew ClspMethod(...)getTypeParameters(...)getThrows(...)rawValue(...)isBridge(...)isPrivate(...)isSynthetic(...)ArgType superClassgetSuperClass(...)ArgType[] parentsgetInterfaces(...)ArgType ifaceClspClass clsString outputNamemakeDirsForFile(...)BufferedOutputStream outputStreamnew BufferedOutputStream(...)newOutputStream(...)Path tempcreateTempFile(...)copy(...)StandardCopyOption.REPLACE_EXISTINGZipOutputStream outnew ZipOutputStream(...)ZipInputStream innew ZipInputStream(...)String clstboolean clstReplacedgetNextEntry(...)String entryNameZipEntry copyEntrynew ZipEntry(...)setLastModifiedTime(...)getLastModifiedTime(...)putNextEntry(...)DataOutputStream outnew DataOutputStream(...)writeBytes(...)writeByte(...)writeInt(...)String clsNamewriteString(...)getSortedMethodsList(...)writeArgTypesArray(...)getParents(...)writeArgTypesList(...)writeShort(...)ClspMethod methodwriteMethod(...)MethodInfo methodInfowriteArgType(...)containsGenericArgs(...)getRawAccessFlags(...)int sizewriteUnsignedByte(...)ArgType typearr.lengthisPrimitive(...)ordinal(...)TypeEnum.PRIMITIVEcharAt(...)getPrimitiveType(...)getOuterType(...)TypeEnum.OUTER_GENERICgetInnerType(...)getWildcardType(...)ArgType.WildcardBoundWildcardBound boundgetWildcardBound(...)TypeEnum.WILDCARDgetNum(...)ArgType.WildcardBound.UNBOUNDisGeneric(...)TypeEnum.GENERICgetId(...)getGenericTypes(...)isGenericType(...)TypeEnum.GENERIC_TYPE_VARIABLEgetExtendTypes(...)isObject(...)TypeEnum.OBJECTisArray(...)TypeEnum.ARRAYgetArrayElement(...)readZipEntries(...)new BiConsumer<ZipEntry,InputStream>(...) { ... }DataInputStream innew DataInputStream(...)byte[] headernew byte[]int readHeaderLengthint versionreadByte(...)int clsCountreadInt(...)new String(...)new DecodeException(...)readString(...)object(...)ClassInfo clsInfofromType(...)getClsType(...)readArgTypesArray(...)readArgTypesList(...)readClsMethods(...)int mCountreadShort(...)int jreadMethod(...)List<ArgType> argTypesreadArgType(...)List<ArgType> genericArgTypesArgType genericRetTypeList<ArgType> typeParametersint accFlagsList<ArgType> throwListfromDetails(...)int countList<ArgType> listnew ArrayList<ArgType>(...)ArgType[] arrint ordinal... >= ...values(...).lengthgetByNum(...)ArgType objTypeArgType outerTypeArgType innerTypeString typeVarList<ArgType> extendTypeschar shortNameArgType.WILDCARDwildcard(...)outerGeneric(...)generic(...)genericType(...)array(...)byte[] bytesgetBytes(...)bytes.lengthreadUnsignedByte(...)int res...+=...... & ...// cls is java.lang.Object// preserve modified time/** Class node in classpath graph */ArgType clsType, ...;int id, ...;...[] parents, ...;Map<String,ClspMethod> methodsMap, ...;List<ArgType> typeParameters, ...;this.clsTypethis.idthis.parentsList<ClspMethod> listthis.methodsMaprequireNonNull(...)Map<String,ClspMethod> mapnew HashMap<String,ClspMethod>(...)ClspMethod mthgetShortId(...)setMethodsMap(...)this.typeParametersnClass.clsTypeimport HashSetimport WeakHashMapimport IMethodDetails/** Classes hierarchy graph with methods additional info */synchronizedMap(...)new WeakHashMap<K,V>(...)new HashSet<String>(...)ClspGraph.classMap<String,Set<String>> superTypesCache, ...;Map<String,ClspClass> nameMap, ...;Set<String> missingClasses, ...;loadFromClstFile(...)addClasspath(...)getClassesCount(...)addToMap(...)addClass(...)containsKey(...)getDeclClass(...)getMethodFromClass(...)ArgType parentClspClass clspParentgetClspClass(...)ClspMethod methodFromParentnew SimpleMethodDetails(...)String rawNameClspClass clspClass/** @return */Set<String> ancgetSuperTypes(...)List<String> listString clskeySet(...)isImplements(...)searchCommonParent(...)ArgType pClspClass nClsString rSet<String> fromCacheSet<String> resultemptySet(...)addSuperTypes(...)putInSuperTypesCache(...)Set<String> emptyArgType parentTypeClspClass parentClsboolean isNewwarn(...)List<String> clsNames// deep search// unknown methodimport AccessFlags/** Method node in classpath graph. */MethodInfo methodInfo, ...;List<ArgType> argTypes, ...;ArgType returnType, ...;List<ArgType> throwList, ...;int accFlags, ...;this.methodInfothis.argTypesthis.returnTypethis.throwListthis.accFlagsAccessFlags.VARARGSClspMethod otherother.methodInfoList<ArgType> throwsListnotEmpty(...)listToString(...)isVarArg(...)/** Method details build from MethodInfo. ... */AccessFlags.PUBLICimport Iteratorimport Entryimport IFieldDataimport EncodedValueimport IAnnotationimport Constsimport IAttributeNodeimport AnnotationsListimport MethodParametersimport FieldInfoimport StringUtilsClassGen classGen, ...;this.classGenList<AnnotationsList> paramListgetParamList(...)AnnotationsList aListIAnnotation agetAll(...)formatAnnotation(...)AType<>.ANNOTATION_LISTString aClsgetAnnotationClass(...)Consts.DALVIK_ANNOTATION_PKGstartLine(...)ClassNode annClsresolveClass(...)Map<String,EncodedValue> vlgetValues(...)useClass(...)Iterator<Entry<String,EncodedValue>> ititerator(...)hasNext(...)Entry<String,EncodedValue> enext(...)String paramNamegetParamName(...)encodeValue(...)searchMethodByShortName(...)Iterator<ArgType> itArgType exuseType(...)IAnnotation angetAnnotation(...)Consts.DALVIK_ANNOTATION_DEFAULTEncodedValue defValueIAnnotation defAnnotation// TODO: refactor this boilerplate codeObject valueIterator<?> itBoolean.TRUEformatByte(...)formatShort(...)unescapeChar(...)getStringUtils(...)formatInteger(...)formatLong(...)formatFloat(...)formatDouble(...)unescapeString(...)FieldInfo fieldfromData(...)makeStaticFieldAccess(...)EncodedValue v// don't add "value = " if no other parameters// TODO: save value type and search using signature// must be a static field// TODOimport EncodedTypeimport AttrNodeimport FieldInitAttrimport EnumClassAttrimport EnumFieldimport JadxErrorimport SkipMethodArgsAttrimport PrimitiveTypeimport ConstructorInsnimport InsnNodeimport CodeGenUtilsimport ErrorsCounterimport CodegenExceptionnew HashSet<ClassInfo>(...)ClassGen parentGen, ...;AnnotationGen annotationGen, ...;boolean fallback, ...;Set<ClassInfo> imports, ...;int clsDeclLine, ...;boolean bodyGenStarted, ...;isShowInconsistentCode(...)parentClsGen.useImportsparentClsGen.fallbackparentClsGen.showInconsistentCodethis.parentGenthis.fallbackthis.annotationGennew AnnotationGen(...)CodeWriter clsBodyCodeWriter clsCodeint importsCountaddClassCode(...)newLine(...)List<ClassInfo> sortedImportsnew ArrayList<ClassInfo>(...)new Function<ClassInfo,String>(...) { ... }getAliasFullName(...)new Consumer<ClassInfo>(...) { ... }attachAnnotation(...)Consts.DEBUG_USAGEaddClassUsageInfo(...)addComments(...)insertDecompilationProblems(...)addClassDeclaration(...)addClassBody(...)AccessInfo afArgType supisInterface(...)AccessFlags.STATICAccessFlags.ABSTRACTisEnum(...)AccessFlags.FINALisInner(...)AccessFlags.PRIVATEaddForClass(...)insertRenameInfo(...)addSourceFileInfo(...)startLineWithNum(...)getSourceLine(...)makeString(...)isAnnotation(...)attachDefinition(...)getAliasShortName(...)addGenericTypeParameters(...)ArgType.OBJECTArgType interfArgType genericInfoArgType gaddImport(...)/** @param ... */setBodyGenStarted(...)getLine(...)incIndent(...)addFields(...)addInnerClsAndMethods(...)decIndent(...)sorted(...)comparingInt(...)flatMap(...)new Function<List<? extends NotificationAttrNode & ...>,Stream<? extends ? extends NotificationAttrNode & ...>>(...) { ... }new Predicate<? extends NotificationAttrNode & ...>(...) { ... }new ToIntFunction<? extends NotificationAttrNode & ...>(...) { ... }new Consumer<? extends NotificationAttrNode & ...>(...) { ... }addInnerClass(...)addMethod(...)ClassGen inClGennew ClassGen(...)getParentGen(...)getImports(...)ClassNode innerClsAFlag.ANONYMOUS_CLASSint savedIndentgetIndent(...)addMethodCode(...)AFlag.RESTART_CODEGENaddMultiLine(...)setIndent(...)isNoCode(...)MethodGen mthGennew MethodGen(...)addDefinition(...)boolean badCodeAFlag.INCONSISTENT_CODEAType<>.JADX_ERRORgetRegion(...)getFallbackMethodGen(...)addInstructions(...)List<JadxError> errorsList<String> warnsAType<>.JADX_WARNdistinct(...)new Consumer<JadxError>(...) { ... }Throwable causegetError(...)new Consumer<String>(...) { ... }addEnumFields(...)addField(...)FieldInitAttr fvAType<>.FIELD_INITaddFieldUsageInfo(...)addForField(...)isRenamed(...)getFieldInfo(...)addRenamedComment(...)isConst(...)EncodedValue encodedValuegetEncodedValue(...)EncodedType.ENCODED_NULLliteralToString(...)isInsn(...)InsnGen insnGenmakeInsnGen(...)getInsnMth(...)addInsnBody(...)getInsn(...)FieldNode fieldEnumClassAttr enumFieldsAType<>.ENUM_CLASSInsnGen igenIterator<EnumField> itEnumField fConstructorInsn constrInsngetConstrInsn(...)MethodNode callMthresolveMethod(...)getCallMth(...)int skipCountgetEnumCtrSkipArgsCount(...)getField(...)getArgsCount(...)getStaticMethod(...)generateMethodArguments(...)isInnerClassesPresents(...)isMethodsPresents(...)isFieldsPresents(...)SkipMethodArgsAttr skipArgsAttrAType<>.SKIP_MTH_ARGSgetSkipCount(...)new InsnGen(...)makeInsn(...)InsnGen.Flags.BODY_ONLY_NOWRAPInsnGen.FlagsPrimitiveType stypePrimitiveType.OBJECTPrimitiveType.ARRAYgetLongName(...)List<ArgType> genericsuseClassShortName(...)ArgType gtArgType wtgetStr(...)ClassInfo classInfofromName(...)addClsName(...)useClassInternal(...)String fullNameString shortNameisClassInnerFor(...)expandInnerClassName(...)isBothClassesInOneTopClass(...)searchCollision(...)isDefaultPackage(...)getAliasPkg(...)getAliasNameWithoutPackage(...)ClassInfo importClsString parentList<ClassInfo> clsListClassInfo parentClsboolean addImportreverse(...)ClassInfo aClassInfo bClassInfo phasAlias(...)List<ClassNode> depsList<ClassNode> useInList<MethodNode> useInMthsgetUseInMth(...)ClassNode useClsMethodNode useMththis.bodyGenStarted// 'static' and 'private' modifier not allowed for top classes (not inner)// import not needed, force use short name// don't add import if this class from same package// ignore classes from default package// useCls - is a top classimport Callableimport JsonCodeGenICodeInfo.EMPTYgetOutputFormat(...)generateJavaCode(...)generateJson(...)ClassGen clsGenwrapCodeGen(...)new Callable<ICodeInfo>(...) { ... }makeClass(...)JsonCodeGen codeGennew JsonCodeGen(...)String clsJsonnew Callable<String>(...) { ... }call(...)Exception eximport TreeMapCodeWriter.classnew String[]String NL, ...;String INDENT_STR, ...;boolean ADD_LINE_NUMBERS, ...;...[] INDENT_CACHE, ...;StringBuilder buf, ...;String indentStr, ...;int indent, ...;Map<Integer,Integer> lineMap, ...;this.bufthis.indentthis.indentStraddLine(...)addLineIndent(...)String lnattachSourceLine(...)replace(...)countMatches(...)...--code.annotationsCodePosition posint usagePosgetUsagePosition(...)bufLength(...)getNode(...)setDefPosition(...)getDefPosition(...)setUsagePosition(...)getOffset(...)Entry<Integer,Integer> entryMap<>.Entry<Integer,Integer>code.lineMapcode.linecode.offsetcode.bufint curIndentINDENT_CACHE.lengthstrRepeat(...)updateIndent(...)...-=...LineAttrNode node, ...;new DefinitionWrapper(...)new HashMap<CodePosition,Object>(...)new TreeMap<Integer,Integer>(...)removeFirstEmptyLine(...)processDefinitionAnnotations(...)delete(...)removeIf(...)new Predicate<Entry<CodePosition,Object>>(...) { ... }Object vLineAttrNode lsetDecompiledLine(...)import Queueimport ArithNodeimport IfOpimport InsnTypeimport InsnArgimport InsnWrapArgimport LiteralArgimport Compareimport IfConditionimport Modenew LinkedList<IfCondition>(...)Queue<IfCondition> stack, ...;poll(...)insnGen.mgeninsnGen.fallbacknew CondStack(...)wrap(...)push(...)getMode(...)addCompare(...)getCompare(...)addTernary(...)addNot(...)addAndOr(...)pop(...)boolean wrapisWrapNeeded(...)isArgWrapNeeded(...)addArg(...)IfOp opgetOp(...)InsnArg firstArggetA(...)InsnArg secondArggetB(...)isLiteral(...)ArgType.BOOLEANLiteralArg litgetLiteral(...)invert(...)IfOp.EQgetStack(...)IfOp.NEaddWarn(...)getSymbol(...)first(...)second(...)third(...)String modeMode.ANDIterator<IfCondition> itisCompare(...)AFlag.DONT_WRAPMode.NOTInsnNode insngetWrapInsn(...)InsnType insnTypeisInsnWrap(...)InsnType.ARITH// == true// != trueimport MethodHandleTypeimport NameMapperimport FieldReplaceAttrimport GenericInfoAttrimport LoopLabelAttrimport ArithOpimport BaseInvokeNodeimport ConstClassNodeimport ConstStringNodeimport FillArrayInsnimport FilledNewArrayNodeimport GotoNodeimport IfNodeimport IndexInsnNodeimport InvokeCustomNodeimport InvokeNodeimport InvokeTypeimport NewArrayNodeimport SwitchInsnimport CodeVarimport Namedimport NamedArgimport RegisterArgimport SSAVarimport TernaryInsnimport RegionUtilsimport static VariableNode.VarKindimport static AndroidResourcesUtils.handleAppResFieldInsnGen.classFlags.classFlags.BODY_ONLYFlags.BODY_ONLY_NOWRAPMethodGen mgen, ...;boolean attachInsns, ...;new Flags(...)Flags BODY_ONLY, ...;Flags BODY_ONLY_NOWRAP, ...;Flags INLINE, ...;this.mgenthis.attachInsnsisJsonOutput(...)isRegister(...)CodeVar codeVargetCodeVar(...)VariableNode nodegetVariable(...)getIndex(...)useArg(...)getNameGen(...)lit(...)addWrappedArg(...)isNamed(...)new CodegenException(...)InsnNode wrapInsnAFlag.FORCE_ASSIGN_INLINEFlags.INLINEFlags flagsRegisterArg arggetResult(...)AFlag.DECLARE_VARdeclareVar(...)getSVar(...)VarKind.VARisFinal(...)setName(...)assignArg(...)ClassNode pClsFieldNode fieldNodedeepResolveField(...)FieldReplaceAttr replaceAType<>.FIELD_REPLACEgetReplaceType(...)getClsRef(...)getVarRef(...)addArgDot(...)ClassInfo declClassboolean fieldFromThisClassisBodyGenStarted(...)handleAppResField(...)getClassGen(...)Set<Flags> EMPTY_FLAGS, ...;Set<Flags> BODY_ONLY_FLAG, ...;Set<Flags> BODY_ONLY_NOWRAP_FLAGS, ...;InsnType.REGION_ARGmakeInsnBody(...)RegisterArg resArgattachLineAnnotation(...)AFlag.COMMENT_OUTSSAVar vargetUseCount(...)InsnType.CONSTRUCTORassignVar(...)String strgetString(...)LiteralArg arggetArg(...)char opLoopLabelAttr labelAttrAType<>.LOOP_LABELFillArrayInsn arrayNodeIfNode ifInsnSwitchInsn swint[] keysgetKeys(...)int[] targetsgetTargets(...)makeArith(...)oneArgInsn(...)getLoopLabel(...)makeConstructor(...)makeInvoke(...)ArgType arrayTypegetArrayType(...)int dimgetArrayDimension(...)getArrayRootElement(...)filledNewArray(...)String arrStrdataToString(...)fillArray(...)FieldInfo fieldInfoinstanceField(...)staticField(...)Iterator<InsnArg> itgetArguments(...)isFallback(...)makeTernary(...)fallbackOnlyInsn(...)getLabelName(...)getTarget(...)keys.lengthgetDefaultCaseOffset(...)getInitType(...)InsnArg insnArg/** In most cases must be combined with new array instructions. ... */InsnArg arrArgArgType elemTypeList<LiteralArg> argsgetLiteralArgs(...)isTypeKnown(...)ArgType elementTypegetElementType(...)selectFirst(...)String msgCodegenException eint cgetClassType(...)isAnonymous(...)ensureProcessed(...)inlineAnonymousConstructor(...)addInlinedClass(...)isSelf(...)isSuper(...)isThis(...)GenericInfoAttr genericInfoAttrAType<>.GENERIC_INFOisExplicit(...)boolean firstMethodNode ctorAFlag.ANONYMOUS_CONSTRUCTORInvokeType typegetInvokeType(...)MethodInfo callMthMethodNode callMthNodedeepResolveMethod(...)InvokeType.CUSTOMmakeInvokeLambda(...)InsnArg argClassInfo superCallClsgetClassForSuperCall(...)ClassInfo insnClsgetCallInsn(...)AType<>.METHOD_DETAILSisUseRef(...)makeRefLambda(...)isInlineInsn(...)makeSimpleLambda(...)makeInlinedLambdaMethod(...)InsnNode callInsnInvokeNode invokeInsngetHandleType(...)MethodHandleType.INVOKE_STATICMethodInfo implMthInfogetImplMthInfo(...)int implArgsCountint callArgsCountint startArgAFlag.THISisVoid(...)MethodGen callMthGenNameGen nameGenList<ArgType> implArgsList<RegisterArg> callArgsgetArgRegs(...)int extArgsCountinheritUsedNames(...)CodeVar argCodeVarRegisterArg extArgClassNode topClassClassNode nextParentClassInfo nextClsInfoisInstanceOf(...)int argsCountboolean firstArgAFlag.SKIP_FIRST_ARGint argOrigPosAFlag.SKIP_ARGisSkip(...)processVarArg(...)/** Expand varArgs from filled array. */AFlag.VARARG_CALLInsnType.FILLED_NEW_ARRAYInsnArg elemArgInsnArg firstInsnArg secondConditionGen condGennew ConditionGen(...)isTrue(...)isFalse(...)getCondition(...)addCastIfNeeded(...)ArgType.BYTElong lit1long lit2ArgType.SHORTArgType.CHARisPrintableChar(...)AFlag.ARITH_ONEARGmakeArithOneArg(...)ArithOp opInsnArg resArgArithOp.ADDArithOp.SUBisInteger(...)String opSymbol// Android specific resources class handler/* fallback mode instructions */// only fallback - make new instance in constructor invoke// unknown type// hide empty anonymous constructors// FIXME: add 'this' for equals methods in scope// use 'super' instead 'this' in 0 arg// force set external arg names into call method args// skip 'this' arg// search call class// search failed, just return parent class// wrap insn in brackets for save correct operation order// "++" or "--"// +=, -=, ...import JumpInfoimport CatchAttrimport InsnUtilsimport JadxOverflowExceptionimport static FallbackOption.BLOCK_DUMPimport static FallbackOption.COMMENTED_DUMPimport static FallbackOption.FALLBACK_MODEimport static VariableNode.*MethodGen.classNameGen nameGen, ...;getAnnotationGen(...)this.nameGennew NameGen(...)AccessInfo clsAccFlagsAccessInfo aiList<RegisterArg> argsaddMthUsageInfo(...)addOverrideAnnotation(...)addForMethod(...)isVirtual(...)isStatic(...)subList(...)addComment(...)addMethodArguments(...)addThrows(...)EncodedValue defgetAnnotationDefaultValue(...)MethodOverrideAttr overrideAttrisAtBaseMth(...)getOverrideList(...)new Function<IMethodDetails,String>(...) { ... }new Function<MethodNode,String>(...) { ... }MethodParameters paramsAnnotationAType<>.ANNOTATION_MTH_PARAMETERSIterator<RegisterArg> itRegisterArg mthArgSSAVar ssaVarCodeVar varArgType argTypeArgType varTypeVarKind.ARGfromMthArg(...)addForParameter(...)ArgType.UNKNOWNisVarArgs(...)ArgType elTypeaddFallbackMethodCode(...)dumpInstructions(...)addRegionInsns(...)RegionGen regionGennew RegionGen(...)makeRegion(...)Error e...|...new JadxOverflowException(...)InsnNode[] insnArrgetInstructions(...)DecodeException elong insnCountEstimatecount(...)new Predicate<InsnNode>(...) { ... }InsnType.NOPinsnArr.lengthgetThisArg(...)addFallbackInsns(...)new FallbackOption(...)FallbackOption FALLBACK_MODE, ...;FallbackOption BLOCK_DUMP, ...;FallbackOption COMMENTED_DUMP, ...;int startIndentboolean attachInsnsInsnNode prevInsnJadxError errorneedLabel(...)boolean escapeCommentisCommentEscapeNeeded(...)CatchAttr catchAttrAType<>.CATCH_BLOCKInsnGen.Flags.INLINEInsnType.CONST_STRAType<>.EXC_HANDLERAType<>.JUMPInsnType.IFList<JumpInfo> jumpsJumpInfo jumpgetSrc(...)getDest(...)int target/** Return fallback variant of method codegen */formatOffset(...)// don't add method name and arguments// don't add 'abstract' and 'public' to methods in interface// don't add 'public' for annotations// add 'default' for method with code in interface// constructor// add default value if in annotation class// null for abstract or interface methods// add argument annotation// occur on decompilation errors// change last array argument to varargs// load original instructions// don't add label for ifs else branchnewConstStringMap(...)Consts.CLASS_STRINGConsts.CLASS_CLASSConsts.CLASS_THROWABLEConsts.CLASS_OBJECTMap<String,String> OBJ_ALIAS, ...;Set<String> varNames, ...;addNamesUsedInClass(...)otherNameGen.varNamesClassNode innerClassgetRootPkgs(...)getCacheStorage(...)getUniqueVarName(...)makeArgName(...)getFallbackName(...)RegisterArg.THIS_ARG_NAME// TODO: avoid name collision with variables namesgetLoop(...)guessName(...)isValidAndPrintable(...)List<SSAVar> ssaVarsgetSsaVars(...)getAssign(...)getRegNum(...)RegisterArg assignArgInsnNode assignInsngetParentInsn(...)makeNameFromInsn(...)isReserved(...)makeNameForType(...)makeNameForPrimitive(...)makeNameForObject(...)escape(...)String aliasgetAliasForObject(...)ClassInfo extClsInfoString vNameString v1InvokeNode invConstructorInsn comakeNameFromInvoke(...)String wNameArgType declTypeArgType.CLASS// add all root package names to avoid collisions with full class names// TODO: use all vars for better name generation// all characters are upper caseimport DeclareVariablesAttrimport ForceReturnAttrimport Regionimport SwitchRegionimport CaseInfoimport SynchronizedRegionimport TryCatchRegionimport IfRegionimport ForEachLoopimport ForLoopimport LoopRegionimport LoopTypeimport ExceptionHandlerimport BlockUtilsRegionGen.classmakeSimpleBlock(...)makeSimpleRegion(...)declareVars(...)makeIf(...)makeSwitch(...)makeLoop(...)makeTryCatch(...)makeSynchronizedRegion(...)DeclareVariablesAttr declVarsAType<>.DECLARE_VARIABLESCodeVar vgetVars(...)IContainer cgetSubBlocks(...)ForceReturnAttr retAttrAType<>.FORCE_RETURNgetReturnInsn(...)boolean commentIContainer elsgetElseRegion(...)List<BlockNode> conditionBlocksgetConditionBlocks(...)BlockNode blockNodeInsnNode lastInsngetLastInsn(...)makeRegionIndent(...)getThenRegion(...)connectElseIf(...)/** Connect if-else-if block */AFlag.ELSE_IF_CHAINList<IContainer> subBlocksIContainer elseBlockgetStart(...)getInfo(...)IfCondition conditionConditionGen conditionGenLoopType typegetBody(...)ForLoop forLoopgetInitInsn(...)getIncrInsn(...)ForEachLoop forEachLoopgetVarArg(...)getIterableArg(...)isConditionAtEnd(...)getConditionSourceLine(...)getEnterInsn(...)SwitchInsn insngetHeader(...)CaseInfo caseInfogetCases(...)List<Object> keysgetContainer(...)Object kSwitchRegion.DEFAULT_CASE_KEYaddCaseKey(...)FieldNode fnFieldInitAttr valueAttrExceptionHandler allHandlerIContainer finallyRegiongetFinallyRegion(...)getTryRegion(...)Entry<ExceptionHandler,IContainer> entryMap<>.Entry<ExceptionHandler,IContainer>getCatchRegions(...)ExceptionHandler handlerisCatchAll(...)makeCatchBlock(...)IContainer regiongetHandlerRegion(...)ArgType.THROWABLEIterator<ClassInfo> itgetCatchTypes(...)VarKind.CATCH_ARGRegisterArg regassignNamedArg(...)// infinite loop// print original value, sometimes replaced with incorrect field// TODO: move search of 'allHandler' to 'TryCatchRegion'// throwing exception is too late at this pointimport IDexNodeTypeGen.classmakeQualifiedObjectName(...)signature(...)/** Convert literal arg to string (preferred method) */AFlag.EXPLICIT_PRIMITIVE_TYPE/** Convert literal value to string according to value type ... */String nabs(...)PrimitiveType.FLOATintBitsToFloat(...)PrimitiveType.DOUBLElongBitsToDouble(...)long litisNaN(...)import FieldNamingPolicyimport Gsonimport GsonBuilderimport ClassGenimport MethodGenimport JsonClassimport JsonCodeLineimport JsonFieldimport JsonMethodcreate(...)disableHtmlEscaping(...)setFieldNamingPolicy(...)setPrettyPrinting(...)FieldNamingPolicy.LOWER_CASE_WITH_DASHESnew GsonBuilder(...)Gson GSON, ...;JsonClass jsonClsprocessCls(...)toJson(...)ClassGen classGennew JsonClass(...)setPkg(...)setDex(...)getInputFileName(...)setAlias(...)setType(...)getClassTypeStr(...)setAccessFlags(...)setSuperClass(...)getTypeAlias(...)setInterfaces(...)new Function<ArgType,String>(...) { ... }setDeclaration(...)addMethods(...)addInnerClasses(...)List<String> importssetImports(...)List<ClassNode> innerClassessetInnerClasses(...)new ArrayList<JsonClass>(...)JsonClass innerJsonClssetFields(...)new ArrayList<JsonField>(...)JsonField jsonFieldnew JsonField(...)new ArrayList<JsonMethod>(...)JsonMethod jsonMthnew JsonMethod(...)setSignature(...)setReturnType(...)setArguments(...)setLines(...)fillMthCode(...)setOffset(...)getMethodCodeOffset(...)String codeStrString[] linesCodeWriter.NLMap<Integer,Integer> lineMappingMap<CodePosition,Object> annotationslong mthCodeOffsetint linesCountlines.lengthList<JsonCodeLine> codeLinesnew ArrayList<JsonCodeLine>(...)String codeLineint lineJsonCodeLine jsonCodeLinenew JsonCodeLine(...)setCode(...)setSourceLine(...)long offsetimport FileWriterimport Writerimport JsonClsMappingimport JsonFieldMappingimport JsonMappingimport JsonMthMappingJsonMappingGen.classJsonMapping mappingnew JsonMapping(...)File outDirSrcgetAbsoluteFile(...)File mappingFilefillMapping(...)Writer writernew FileWriter(...)List<ClassNode> classessetClasses(...)new ArrayList<JsonClsMapping>(...)JsonClsMapping jsonClsnew JsonClsMapping(...)setInner(...)setJson(...)getAliasFullPath(...)setTopClass(...)List<MethodNode> methodsnew ArrayList<JsonMthMapping>(...)MethodNode methodJsonMthMapping jsonMethodnew JsonMthMapping(...)List<FieldNode> fieldsnew ArrayList<JsonFieldMapping>(...)JsonFieldMapping jsonFieldnew JsonFieldMapping(...)import SerializedNameString pkg, ...;String type, ...;String superClass, ...;// class, interface, enumList<String> interfaces, ...;String dex, ...;List<JsonField> fields, ...;List<JsonMethod> methods, ...;List<JsonClass> innerClasses, ...;List<String> imports, ...;this.superClassthis.interfacesthis.pkgthis.dexthis.importsString offset, ...;Integer sourceLine, ...;this.sourceLineString signature, ...;String returnType, ...;List<String> arguments, ...;List<JsonCodeLine> lines, ...;this.signaturethis.argumentsthis.linesString alias, ...;String declaration, ...;int accessFlags, ...;this.aliasthis.declarationthis.accessFlagsString json, ...;boolean inner, ...;String topClass, ...;List<JsonFieldMapping> fields, ...;List<JsonMthMapping> methods, ...;this.jsonthis.innerthis.topClassList<JsonClsMapping> classes, ...;Deobfuscator deobfuscator, ...;PackageNode pkg, ...;this.deobfuscatorString prefixDeobfClsInfo parentDeobfClsInfogetClsMap(...)makeNameWithoutPkg(...)getNameWithoutPackage(...)Deobfuscator.INNER_CLASS_SEPARATORgetFullAlias(...)Deobfuscator.CLASS_NAME_SEPARATORimport Charsetimport StandardOpenOptionimport static StandardCharsets.UTF_8new HashMap<String,String>(...)new HashMap<String,Set<String>>(...)DeobfPresets.classCharset MAP_FILE_CHARSET, ...;Path deobfMapFile, ...;Map<String,String> pkgPresetMap, ...;Map<String,String> clsPresetMap, ...;Map<String,String> fldPresetMap, ...;Map<String,String> mthPresetMap, ...;Map<String,Set<String>> varPresetMap, ...;Path deobfMapPathgetPathDeobfMapPath(...)new DeobfPresets(...)File deobfMapFilegetDeobfuscationMapFile(...)Path inputFilePathString baseNamegetPathBaseName(...)resolve(...)getParent(...)this.deobfMapFile/** Loads deobfuscator presets */List<String> linesreadAllLines(...)String lString[] vasplitAndTrim(...)String origNametrim(...)va.lengthString[] mthIDAndVarIndexVariableNode.VAR_SEPARATORmthIDAndVarIndex.lengthSet<String> nameListnew Function<String,Set<String>>(...) { ... }makeVarSecIndex(...)String[] vv.lengthEntry<String,String> pkgEntryMap<>.Entry<String,String>Entry<String,String> clsEntryEntry<String,String> fldEntryEntry<String,String> mthEntryEntry<String,Set<String>> varEntryMap<>.Entry<String,Set<String>>String valString[] indexAndNameindexAndName.lengthStandardOpenOption.WRITEStandardOpenOption.CREATEStandardOpenOption.TRUNCATE_EXISTINGmakeRawFullName(...)getRawFullId(...)String keygetRenameKey(...)String newIndexmakeVarIndex(...)String oldIndexSet<String> indexSetindexOf(...)import java.util.*import SourceFileAttrimport KotlinMetadataUtilsnew LinkedHashMap<ClassInfo,DeobfClsInfo>(...)new HashMap<FieldInfo,String>(...)new HashMap<MethodInfo,String>(...)new PackageNode(...)new TreeSet<String>(...)Deobfuscator.classString CLASS_NAME_SEPARATOR, ...;String INNER_CLASS_SEPARATOR, ...;DeobfPresets deobfPresets, ...;Map<ClassInfo,DeobfClsInfo> clsMap, ...;Map<FieldInfo,String> fldMap, ...;Map<MethodInfo,String> mthMap, ...;PackageNode rootPackage, ...;Set<String> pkgSet, ...;Set<String> reservedClsNames, ...;int maxLength, ...;int minLength, ...;boolean useSourceNameAsAlias, ...;int pkgIndex, ...;int clsIndex, ...;int fldIndex, ...;int mthIndex, ...;this.minLengthgetDeobfuscationMinLength(...)this.maxLengthgetDeobfuscationMaxLength(...)this.useSourceNameAsAliasisUseSourceNameAsClassAlias(...)isParseKotlinMetadata(...)this.deobfPresetsisDeobfuscationForceSave(...)getPkgPresetMap(...)addPackagePreset(...)initIndexes(...)Path deobfMapFilegetDeobfMapFile(...)fillDeobfPresets(...)PackageNode pgetInnerPackages(...)getRootPackage(...)PackageNode ppdfsPackageName(...)DeobfClsInfo deobfClsInfogetClsPresetMap(...)FieldInfo fldgetFldPresetMap(...)MethodInfo mthgetMthPresetMap(...)preProcessClass(...)preProcess(...)dumpAlias(...)processClass(...)isR(...)PackageNode pkgNodegetPkg(...)changeShortName(...)hasAnyAlias(...)changePkg(...)getPackageNode(...)AFlag.DONT_RENAMErenameField(...)renameMethod(...)getFieldAlias(...)makeFieldAlias(...)Set<String> namesgetVarPresetMap(...)getMethodAlias(...)setVarNameMap(...)applyMethodAlias(...)makeMethodAlias(...)String prevresolveOverriding(...)MethodNode ovrdMthPackageNode pkg/** Gets package node for full package name ... */PackageNode resultPackageNode parentNodeString pkgNameint idxgetInnerPackageByName(...)addInnerPackage(...)ClassInfo parentClsInfoString pkgFullNamegetForCls(...)processPackageFull(...)new DeobfClsInfo(...)String clsShortNameboolean badNameshouldRename(...)makeClsAlias(...)String fullPkgNameClassInfo kotlinClsgetClassName(...)prepareNameFull(...)getAliasFromSourceFile(...)makeClsPrefix(...)prepareNamePart(...)/** Generate a prefix for a class name that bases on certain class properties, certain ... */String resultClassNode currentClsisAbstract(...)String superClsNameArgType intfString intfClsNameSourceFileAttr sourceFileAttrAType<>.SOURCE_FILEClassNode otherClsgetForFld(...)getAssignedAlias(...)MethodNode relatedMthNodeString assignedAliasgetForMth(...)PackageNode parentPkggetParentPackage(...)isDeobfuscationOn(...)isValidIdentifier(...)isAllCharsPrintable(...)String pkgAliasremoveInvalidCharsMiddle(...)removeInvalidChars(...)makeHashName(...)getClassFullName(...)dumpClassAlias(...)getPackageName(...)ArgType.INT// not needed anymore// check if package renamed// rename not needed// Process current class and all super classes// e.g. Activity or Fragment// e.g. AsyncTask// e.g. Callable// e.g. View.OnClickListener// e.g. DialogInterface.OnClickListener// doPkg for all parent packages except root that not hasAliasesimport Patternimport static StringUtils.notEmptycompile(...)Pattern VALID_JAVA_IDENTIFIER, ...;Pattern VALID_JAVA_FULL_IDENTIFIER, ...;Set<String> RESERVED_NAMES, ...;matcher(...)isJavaIdentifierStart(...)isJavaIdentifierPart(...)/** Return modified string with removed: ... */int codePointcodePointAt(...)isValidIdentifierPart(...)/** Return string with removed invalid chars, see {@link #removeInvalidCharsMiddle} ... */isValidIdentifierStart(...)import ArrayDequeimport Dequechar SEPARATOR_CHAR, ...;PackageNode parentPackage, ...;List<PackageNode> innerPackages, ...;String packageName, ...;String packageAlias, ...;String cachedPackageFullName, ...;String cachedPackageFullAlias, ...;this.packageNamethis.parentPackageDeque<PackageNode> ppgetParentPackages(...)StringBuilder resultnew ArrayList<PackageNode>(...)pkg.parentPackage/** Gets inner package node by name ... *//** Fills stack with parent packages exclude root node ... */new ArrayDeque<PackageNode>(...)PackageNode currentPkgnew AFlag(...)AFlag MTH_ENTER_BLOCK, ...;AFlag TRY_ENTER, ...;AFlag TRY_LEAVE, ...;AFlag LOOP_START, ...;AFlag LOOP_END, ...;AFlag SYNTHETIC, ...;AFlag RETURN, ...;AFlag ORIG_RETURN, ...;// block contains only return instructionAFlag DONT_WRAP, ...;AFlag DONT_INLINE, ...;AFlag DONT_INLINE_CONST, ...;AFlag DONT_GENERATE, ...;AFlag COMMENT_OUT, ...;// process as usual, but don't output to generated codeAFlag REMOVE, ...;// process as usual, but comment insn in generated codeAFlag HIDDEN, ...;// can be completely removedAFlag DONT_RENAME, ...;// instruction used inside other instruction but not listed in argsAFlag ADDED_TO_REGION, ...;// do not rename during deobfuscationAFlag FINALLY_INSNS, ...;AFlag SKIP_FIRST_ARG, ...;AFlag SKIP_ARG, ...;AFlag ANONYMOUS_CONSTRUCTOR, ...;// skip argument in invoke callAFlag ANONYMOUS_CLASS, ...;AFlag THIS, ...;AFlag SUPER, ...;AFlag METHOD_ARGUMENT, ...;/** RegisterArg attribute for method arguments */AFlag IMMUTABLE_TYPE, ...;/** Type of RegisterArg or SSAVar can't be changed */AFlag FORCE_ASSIGN_INLINE, ...;/** Force inline instruction with inline assign */AFlag CUSTOM_DECLARE, ...;AFlag DECLARE_VAR, ...;// variable for this register don't need declarationAFlag ELSE_IF_CHAIN, ...;AFlag WRAPPED, ...;AFlag ARITH_ONEARG, ...;AFlag FALL_THROUGH, ...;AFlag VARARG_CALL, ...;AFlag EXPLICIT_PRIMITIVE_TYPE, ...;/** Use constants with explicit type: cast '(byte) 1' or type letter '7L' */AFlag EXPLICIT_CAST, ...;AFlag SOFT_CAST, ...;AFlag INCONSISTENT_CODE, ...;// synthetic cast to help type inference (allow unchecked casts for generics)AFlag REQUEST_IF_REGION_OPTIMIZE, ...;// warning about incorrect decompilationAFlag RESTART_CODEGEN, ...;// Class processing flags// run if region visitor againAFlag RELOAD_AT_CODEGEN_STAGE, ...;// codegen must be executed againAFlag CLASS_DEEP_RELOAD, ...;// class can't be analyzed at 'process' stage => unload before 'codegen' stageAFlag DONT_UNLOAD_CLASS, ...;// perform deep class unload (reload) before process// don't unload class after code generation (only for tests and debug!)import EdgeInsnAttrimport EnumMapAttrimport IgnoreEdgeAttrimport LocalVarsDebugInfoAttrimport LoopInfoimport MethodInlineAttrimport MethodTypeVarsAttrimport PhiListAttrimport RegDebugInfoAttrimport RenameReasonAttrimport ExcHandlerAttrimport SplitterBlockAttr/** Attribute types enumeration, ... */new AType<AnnotationsList>(...)new AType<RenameReasonAttr>(...)new AType<AttrList<JadxError>>(...)new AType<AttrList<String>>(...)new AType<SourceFileAttr>(...)new AType<EnumClassAttr>(...)new AType<EnumMapAttr>(...)new AType<FieldInitAttr>(...)new AType<FieldReplaceAttr>(...)new AType<LocalVarsDebugInfoAttr>(...)new AType<MethodInlineAttr>(...)new AType<MethodParameters>(...)new AType<SkipMethodArgsAttr>(...)new AType<MethodOverrideAttr>(...)new AType<MethodTypeVarsAttr>(...)new AType<DeclareVariablesAttr>(...)new AType<PhiListAttr>(...)new AType<IgnoreEdgeAttr>(...)new AType<ForceReturnAttr>(...)new AType<CatchAttr>(...)new AType<SplitterBlockAttr>(...)new AType<AttrList<LoopInfo>>(...)new AType<AttrList<EdgeInsnAttr>>(...)new AType<ExcHandlerAttr>(...)new AType<LoopLabelAttr>(...)new AType<AttrList<JumpInfo>>(...)new AType<IMethodDetails>(...)new AType<GenericInfoAttr>(...)new AType<RegDebugInfoAttr>(...)new HashSet<AType<?>>(...)AType<AnnotationsList> ANNOTATION_LIST, ...;// class, method, fieldAType<RenameReasonAttr> RENAME_REASON, ...;AType<AttrList<JadxError>> JADX_ERROR, ...;// class, methodAType<AttrList<String>> JADX_WARN, ...;// code failed to decompile completelyAType<AttrList<String>> COMMENTS, ...;// mark code as inconsistent (code can be viewed)AType<SourceFileAttr> SOURCE_FILE, ...;// class// any additional info about decompilationAType<EnumClassAttr> ENUM_CLASS, ...;AType<EnumMapAttr> ENUM_MAP, ...;AType<FieldInitAttr> FIELD_INIT, ...;// fieldAType<FieldReplaceAttr> FIELD_REPLACE, ...;AType<LocalVarsDebugInfoAttr> LOCAL_VARS_DEBUG_INFO, ...;// methodAType<MethodInlineAttr> METHOD_INLINE, ...;AType<MethodParameters> ANNOTATION_MTH_PARAMETERS, ...;AType<SkipMethodArgsAttr> SKIP_MTH_ARGS, ...;AType<MethodOverrideAttr> METHOD_OVERRIDE, ...;AType<MethodTypeVarsAttr> METHOD_TYPE_VARS, ...;AType<DeclareVariablesAttr> DECLARE_VARIABLES, ...;// regionAType<PhiListAttr> PHI_LIST, ...;// blockAType<IgnoreEdgeAttr> IGNORE_EDGE, ...;AType<ForceReturnAttr> FORCE_RETURN, ...;AType<CatchAttr> CATCH_BLOCK, ...;AType<SplitterBlockAttr> SPLITTER_BLOCK, ...;AType<AttrList<LoopInfo>> LOOP, ...;AType<AttrList<EdgeInsnAttr>> EDGE_INSN, ...;AType<ExcHandlerAttr> EXC_HANDLER, ...;// block or insnAType<LoopLabelAttr> LOOP_LABEL, ...;// instructionAType<AttrList<JumpInfo>> JUMP, ...;AType<IMethodDetails> METHOD_DETAILS, ...;AType<GenericInfoAttr> GENERIC_INFO, ...;AType<RegDebugInfoAttr> REG_DEBUG_INFO, ...;// registerSet<AType<?>> SKIP_ON_UNLOAD, ...;new ArrayList<T>(...)AType<AttrList> type, ...;List<T> list, ...;new EmptyAttrStorage(...)AttributeStorage EMPTY_ATTR_STORAGE, ...;AttributeStorage storage, ...;initStorage(...)AttributeStorage copyFromattrNode.storageAttributeStorage storenew AttributeStorage(...)unloadIfEmpty(...)/** Remove all attribute with exceptions from {@link AType#SKIP_ON_UNLOAD} */unloadAttributes(...)getAttributeStrings(...)import IdentityHashMap/** Storage for different attribute types: ... */int flagsCountSet<AFlag> flags, ...;Map<AType<?>,IAttribute> attributes, ...;AFlag.classwriteAttributes(...)AttrList<T> listnew AttrList<T>(...)getList(...)otherList.flagsputAll(...)otherList.attributesAttrList<T> attrListAType<? extends IAttribute> typeIAttribute anew IdentityHashMap<AType<?>,IAttribute>(...)Set<AType<?>> skipOnUnloadAType<>.SKIP_ON_UNLOADnew Predicate<AType<?>>(...) { ... }AFlag atoAttrString(...)new Comparator<String>(...) { ... }import IAttributeimport ICodeNodeAnnotationsList attrListpack(...)addAttr(...)Map<String,IAnnotation> annMapnew HashMap<String,IAnnotation>(...)IAnnotation annnew AnnotationsList(...)Map<String,IAnnotation> map, ...;this.mapList<AnnotationsList> listnew ArrayList<AnnotationsList>(...)List<IAnnotation> annListnew MethodParameters(...)List<AnnotationsList> paramList, ...;this.paramListEncodedValue.NULLFieldInitConstAttr.NULL_VALUEnew FieldInitConstAttr(...)new FieldInitInsnAttr(...)import static Objects.requireNonNullFieldInitAttr NULL_VALUE, ...;EncodedValue value, ...;this.valueInsnNode insn, ...;this.insn/** List of variables to be declared at region start. */new ArrayList<CodeVar>(...)List<CodeVar> vars, ...;import AttrListimport BlockNodeBlockNode start, ...;BlockNode end, ...;EdgeInsnAttr edgeInsnAttrnew EdgeInsnAttr(...)AType<>.EDGE_INSNthis.startthis.endEdgeInsnAttr thatisDeepEquals(...)that.startthat.endthat.insnhash(...)ConstructorInsn constrInsn, ...;this.constrInsnList<EnumField> fields, ...;MethodNode staticMethod, ...;this.staticMethodnew HashMap<Object,Object>(...)Map<Object,Object> map, ...;Map<FieldNode,KeyValueMap> fieldsMap, ...;KeyValueMap mapgetMap(...)new KeyValueMap(...)new HashMap<FieldNode,KeyValueMap>(...)AType<>.ENUM_MAPnew ReplaceWith(...)ReplaceWith CLASS_INSTANCE, ...;ReplaceWith VAR, ...;ReplaceWith replaceType, ...;Object replaceObj, ...;this.replaceTypeReplaceWith.CLASS_INSTANCEthis.replaceObjReplaceWith.VARInsnNode returnInsn, ...;this.returnInsnList<ArgType> genericTypes, ...;boolean explicit, ...;this.genericTypesthis.explicitnew HashSet<BlockNode>(...)Set<BlockNode> blocks, ...;AType<>.IGNORE_EDGEString error, ...;Throwable cause, ...;this.errorthis.causeJadxError otherother.errorStringBuilder strgetStackTrace(...)int src, ...;int dest, ...;this.srcthis.destJumpInfo otherother.destother.srcint sourceLine, ...;int decompiledLine, ...;int defPosition, ...;// the position exactly where a node declared at in decompiled java code.this.defPositionthis.decompiledLineimport ILocalVarimport static CodeWriter.NLList<ILocalVar> localVars, ...;this.localVarsAType<>.LOCAL_VARS_DEBUG_INFOimport EdgeSet<BlockNode> loopBlocks, ...;LoopInfo parentLoop, ...;this.loopBlocksunmodifiableSet(...)getAllPathsBlocks(...)/** Return source blocks of exit edges. <br> ... */Set<BlockNode> nodesSet<BlockNode> blocksgetLoopBlocks(...)BlockNode blockBlockNode sgetSuccessors(...)/** Return loop exit edges. */List<Edge> edgesnew LinkedList<Edge>(...)new Edge(...)selectOther(...)getPredecessors(...)this.parentLoop// exit: successor node not from this loop, (don't change to getCleanSuccessors)LoopInfo loop, ...;this.loopnew MethodInlineAttr(...)MethodInlineAttr INLINE_NOT_NEEDED, ...;List<RegisterArg> allArgRegsgetAllArgRegs(...)int[] regNumsnew int[]MethodInlineAttr miaAType<>.COMMENTS...[] argsRegNums, ...;/** Store method arguments register numbers to allow remap registers */this.argsRegNumsAType<>.METHOD_INLINEnotNeeded(...)import SortedSetList<IMethodDetails> overrideList, ...;/** All methods overridden by current method. Current method excluded, empty for base method. */SortedSet<MethodNode> relatedMthNodes, ...;/** All method nodes from override hierarchy. Current method included. */this.overrideListthis.relatedMthNodesimport static Utils.isEmpty/** Set of known type variables at current method */new MethodTypeVarsAttr(...)MethodTypeVarsAttr EMPTY, ...;Set<ArgType> typeVars, ...;this.typeVarsAType<>.METHOD_TYPE_VARSNotificationAttrNode.classwarning(...)addWarnComment(...)String commentStrimport PhiInsnnew LinkedList<PhiInsn>(...)List<PhiInsn> list, ...;AType<>.PHI_LISTPhiInsn phiInsngetAttributesString(...)ArgType type, ...;AType<>.REG_DEBUG_INFORegDebugInfoAttr thatthat.typeString description, ...;this.descriptionRenameReasonAttr renameReasonAttrAType<>.RENAME_REASONrenameReasonAttr.descriptionnotValid(...)notPrintable(...)import BitSetint argNumindexInListByRef(...)skipArg(...)SkipMethodArgsAttr attrnew SkipMethodArgsAttr(...)skip(...)BitSet skipArgs, ...;this.skipArgsnew BitSet(...)cardinality(...)String fileName, ...;this.fileName... | ...AccessFlags.PROTECTEDint VISIBILITY_FLAGS, ...;new AFType(...)AFType CLASS, ...;AFType FIELD, ...;AFType METHOD, ...;AFType type, ...;containsFlag(...)new AccessInfo(...)~...int currentVisFlagsint unsetAllVisFlagsAccessFlags.INTERFACEAccessFlags.ANNOTATIONAccessFlags.NATIVEAccessFlags.CONSTRUCTORAccessFlags.ENUMAccessFlags.SYNTHETICAccessFlags.BRIDGEAccessFlags.SYNCHRONIZEDAccessFlags.DECLARED_SYNCHRONIZEDAccessFlags.TRANSIENTAccessFlags.VOLATILEStringBuilder codeisPublic(...)isProtected(...)isNative(...)isSynchronized(...)isVolatile(...)isTransient(...)AccessFlags.STRICTAccessFlags.SUPERisPackagePrivate(...)getVisibility(...)String shortName, ...;String fullName, ...;this.shortNamethis.fullNameClassInfo parentClass, ...;ClassAliasInfo alias, ...;splitAndApplyNames(...)checkClassType(...)ClassInfo clsgetInfoStorage(...)ClassInfo newClsInfonew ClassInfo(...)putCls(...)ClassAliasInfo newAliasnew ClassAliasInfo(...)fillAliasFullName(...)setFullName(...)makeFullClsName(...)String aliasFullNamemakeAliasFullName(...)String fullObjectNameString clsPkgint sepString parClsNamemakeFullName(...)String innerSepString parentFullNamemakeAliasRawFullName(...)File.separatorCharClassInfo topClsthis.parentClassClassInfo otherother.type// TODO: check case with method declared in array class like ( clone in int[])new ValueStorage(...)new HashMap<ClassNode,ValueStorage>(...)new ConcurrentHashMap<Object,FieldNode>(...)new HashSet<Object>(...)Map<Object,FieldNode> values, ...;Set<Object> duplicates, ...;FieldNode prevIterator<Entry<Object,FieldNode>> itEntry<Object,FieldNode> entryboolean replaceEnabled, ...;ValueStorage globalValues, ...;Map<ClassNode,ValueStorage> classes, ...;Map<Integer,String> resourcesNames, ...;this.replaceEnabledAccessInfo accFlagsaddConstField(...)removeForCls(...)getClsValues(...)new Function<ClassNode,ValueStorage>(...) { ... }boolean foundInGlobalClassNode currentFieldNode rFieldgetResourceField(...)ValueStorage classValuesClassInfo parentClassClassNode appResClassgetAppResClass(...)String[] partsString typeNameString fieldNameparts.lengthsearchFieldByName(...)PrimitiveType typelong literalfloat fdouble dgetConstField(...)compare(...)this.resourcesNamesimport TypeGenClassInfo declClass, ...;this.declClassnew FieldInfo(...)getParentClassType(...)other.namefieldInfo.namefieldInfo.typefieldInfo.declClassnew HashMap<ArgType,ClassInfo>(...)new HashMap<FieldInfo,FieldInfo>(...)new HashMap<MethodInfo,MethodInfo>(...)new HashMap<Integer,MethodInfo>(...)Map<ArgType,ClassInfo> classes, ...;Map<FieldInfo,FieldInfo> fields, ...;Map<MethodInfo,MethodInfo> uniqueMethods, ...;// use only one MethodInfo instanceMap<Integer,MethodInfo> methods, ...;// can contain same method with different ids (from different dex files)ClassInfo prevMethodInfo prevFieldInfo fimport IMethodProtoimport IMethodRefArgType retType, ...;String shortId, ...;Map<String,String> varNameMap, ...;this.retTypethis.shortIdmakeShortId(...)InfoStorage infoStorageint uniqIdgetUniqId(...)MethodInfo prevMthgetByUniqId(...)ArgType parentClsTypeArgType returnTypeList<ArgType> argsnew Function<String,ArgType>(...) { ... }MethodInfo newMthnew MethodInfo(...)MethodInfo uniqMthputMethod(...)putByUniqId(...)makeSignature(...)ArgType argotherMthInfo.argTypesotherMthInfo.nameotherMthInfo.shortId/** Method name and signature */String[] indexesAndNameindexesAndName.lengthMethodInfo otherother.shortIdother.declClassint clsCmpimport InsnDatareg(...)fixResultType(...)fixArgType(...)getRegsCount(...)new ArithNode(...)LiteralArg litArgisBitOp(...)ArgType.INT_BOOLEANArgType.NARROW_NUMBERS_NO_FLOATArithOp op, ...;this.opsetResult(...)/** Create one argument arithmetic instructions (a+=2). ... */ArithNode insnArithNode otherisSame(...)isSameLiteral(...)other.opInsnArg thisSecondInsnArg otherSecondlong thisLitlong otherLitArithNode copyduplicate(...)copyCommonParams(...)insnTypeToString(...)// both not literals// both literalsnew ArithOp(...)ArithOp ADD, ...;ArithOp SUB, ...;ArithOp MUL, ...;ArithOp DIV, ...;ArithOp REM, ...;ArithOp AND, ...;ArithOp OR, ...;ArithOp XOR, ...;ArithOp SHL, ...;ArithOp SHR, ...;ArithOp USHR, ...;String symbol, ...;this.symbol/** Return offset to match method args from {@link #getCallMth()} */InsnType.CONST_CLASSnew ConstClassNode(...)ConstClassNode otherother.clsTypeString str, ...;this.strnew ConstStringNode(...)ConstStringNode otherother.strgetInstance(...)import IArrayPayloadunknown(...)PrimitiveType.BYTEPrimitiveType.BOOLEANPrimitiveType.SHORTPrimitiveType.CHARPrimitiveType.INTPrimitiveType.LONGArgType ONE_BYTE_TYPE, ...;ArgType TWO_BYTES_TYPE, ...;ArgType FOUR_BYTES_TYPE, ...;ArgType EIGHT_BYTES_TYPE, ...;Object data, ...;int size, ...;int elemSize, ...;ArgType elemType, ...;getData(...)getElementSize(...)InsnType.FILL_ARRAY_DATAthis.datathis.sizethis.elemSizethis.elemTypeList<LiteralArg> listnew ArrayList<LiteralArg>(...)Object arraybyte bshort bint blong bFillArrayData otherother.elemTypeother.dataFillArrayData copynew FillArrayData(...)copy.elemTypeint target, ...;FillArrayData arrayData, ...;InsnType.FILL_ARRAYthis.targetthis.arrayDataFillArrayInsn otherother.arrayDataFillArrayInsn copynew FillArrayInsn(...)FilledNewArrayNode othernew FilledNewArrayNode(...)InsnType.GOTOnew GotoNode(...)import static BlockUtils.getBlockByOffsetimport static BlockUtils.selectOtherIfOp op, ...;BlockNode thenBlock, ...;BlockNode elseBlock, ...;narrowTypeByOp(...)ArgType WIDE_TYPE, ...;// change default types priorityArgType NUMBERS_TYPE, ...;BlockNode tmpsetArg(...)List<BlockNode> successorsgetBlockByOffset(...)boolean replacedgetStartOffset(...)IfNode otherIfNode copynew IfNode(...)copy.thenBlockcopy.elseBlocknew IfOp(...)IfOp EQ, ...;IfOp NE, ...;IfOp LT, ...;IfOp LE, ...;IfOp GT, ...;IfOp GE, ...;Object index, ...;this.indexnew IndexInsnNode(...)IndexInsnNode otherother.indexindexToString(...)import ICodeReaderimport ISwitchPayloadInsnDecoder.classMethodNode method, ...;this.methodInsnNode[] instructionsnew InsnNode[]getInsnsCount(...)visitInstructions(...)new Consumer<InsnData>(...) { ... }int offsetnew InsnNode(...)new JadxError(...)getOpcode(...)LiteralArg narrowLitArgArgType.NARROWLiteralArg wideLitArgArgType.WIDEInsnNode constStrInsngetIndexAsString(...)InsnNode instInsnInsnType.INSTANCE_OFgetIndexAsType(...)ArgType castTypeInsnNode checkCastInsnInsnType.CHECK_CASTFieldInfo igetFldgetIndexAsField(...)InsnNode igetInsnInsnType.IGETFieldInfo iputFldInsnNode iputInsnInsnType.IPUTFieldInfo sgetFldInsnNode sgetInsnInsnType.SGETFieldInfo sputFldInsnNode sputInsnInsnType.SPUTInsnNode arrLenInsnInsnType.ARRAY_LENGTHIndexInsnNode newInstInsnInsnType.NEW_INSTANCEArgType arrTypeinsn(...)InsnType.MOVE_RESULTInsnType.CONSTArgType.STRINGInsnNode constClsInsnInsnType.MOVEArgType.UNKNOWN_OBJECTarith(...)ArgType.DOUBLEArgType.FLOATArgType.LONGarithLit(...)ArithOp.MULArithOp.DIVArithOp.REMArithOp.ANDArithOp.XORArithOp.ORArithOp.USHRArithOp.SHLArithOp.SHRneg(...)not(...)cast(...)IfOp.GTIfOp.GEIfOp.LTIfOp.LEcmp(...)InsnType.CMP_LInsnType.CMP_GInsnType.THROWInsnType.MOVE_EXCEPTIONArgType.UNKNOWN_OBJECT_NO_ARRAYInsnType.RETURNtryResolveFieldType(...)arrayGet(...)ArgType.INT_FLOATarrayPut(...)invoke(...)InvokeType.STATICInvokeType.DIRECTInvokeType.INTERFACEInvokeType.SUPERInvokeType.VIRTUALnew NewArrayNode(...)typeImmutableReg(...)ArgType.UNKNOWN_ARRAYgetPayload(...)new SwitchInsn(...)new SwitchData(...)InsnType.MONITOR_ENTERInsnType.MONITOR_EXITresolveField(...)boolean typeImmutableint regsCountInsnArg[] regsnew InsnArg[]InsnNode noderegs.lengthint rgetReg(...)int regNumInsnNode inodeInsnType.CASTMethodInfo mthInfofromRef(...)getIndexAsMethod(...)new InvokeNode(...)InsnType.AGETtypeImmutableIfKnownReg(...)ArgType.NARROW_INTEGRALInsnType.APUTbuildLit(...)InsnType.NEGInsnType.NOT// move-result will be process in invoke and filled-new-array instructions// node.setResult(resReg == -1 ? null : InsnArg.reg(resReg, arrType));new InsnType(...)InsnType CONST, ...;InsnType CONST_STR, ...;InsnType CONST_CLASS, ...;InsnType ARITH, ...;InsnType NEG, ...;InsnType NOT, ...;InsnType MOVE, ...;InsnType CAST, ...;InsnType RETURN, ...;InsnType GOTO, ...;InsnType THROW, ...;InsnType MOVE_EXCEPTION, ...;InsnType CMP_L, ...;InsnType CMP_G, ...;InsnType IF, ...;InsnType SWITCH, ...;InsnType SWITCH_DATA, ...;InsnType MONITOR_ENTER, ...;InsnType MONITOR_EXIT, ...;InsnType CHECK_CAST, ...;InsnType INSTANCE_OF, ...;InsnType ARRAY_LENGTH, ...;InsnType FILL_ARRAY, ...;InsnType FILL_ARRAY_DATA, ...;InsnType FILLED_NEW_ARRAY, ...;InsnType AGET, ...;InsnType APUT, ...;InsnType NEW_ARRAY, ...;InsnType NEW_INSTANCE, ...;InsnType IGET, ...;InsnType IPUT, ...;InsnType SGET, ...;InsnType SPUT, ...;InsnType INVOKE, ...;InsnType MOVE_RESULT, ...;InsnType NOP, ...;// replacement for removed instructions// *** Additional instructions ***InsnType TERNARY, ...;InsnType CONSTRUCTOR, ...;InsnType BREAK, ...;InsnType CONTINUE, ...;InsnType STR_CONCAT, ...;// strings concatenationInsnType ONE_ARG, ...;// just generate one argumentInsnType PHI, ...;InsnType REGION_ARG, ...;// fake insn to keep arguments which will be used in regions codegenimport ICallSiteimport IMethodHandleICallSite callSitegetIndexAsCallSite(...)List<EncodedValue> valuesIMethodHandle callMthHandlecheckLinkerMethod(...)isField(...)buildMethodCall(...)IMethodProto lambdaProtoMethodInfo lambdaInfofromMethodProto(...)MethodHandleType methodHandleTypeInvokeCustomNode invokeCustomNodenew InvokeCustomNode(...)ClassInfo implClsString implNameIMethodProto implProtoMethodInfo callMthInfogetMethodRef(...)InvokeNode invokeNodebuildInvokeNode(...)setHandleType(...)setImplMthInfo(...)MethodHandleType.INVOKE_CONSTRUCTORConstructorInsn ctrInsnnew ConstructorInsn(...)setCallInsn(...)setInlineInsn(...)IMethodProto effectiveMthProtoboolean sameArgssetUseRef(...)AFlag.DONT_INLINEInvokeType invokeTypeconvertInvokeType(...)boolean instanceCallint callArgNumList<ArgType> callArgTypesnew NamedArg(...)/** Expect LambdaMetafactory.metafactory method */IMethodHandle methodHandleIMethodRef methodRef// inline only synthetic methods from same class// prevent args inlining into not generated invoke custom node// copy insn args// fill remaining args with NamedArg// start from instance type// instance arg typeMethodInfo implMthInfo, ...;MethodHandleType handleType, ...;InsnNode callInsn, ...;boolean inlineInsn, ...;boolean useRef, ...;InvokeCustomNode copyInvokeCustomNode otherother.handleTypeother.implMthInfoother.callInsnother.inlineInsnother.useRefthis.implMthInfothis.handleTypethis.callInsnthis.inlineInsnthis.useRefInsnType.INVOKEappendArgs(...)InvokeType type, ...;MethodInfo mth, ...;addReg(...)getRegCount(...)InvokeNode otherother.mthnew InvokeType(...)InvokeType STATIC, ...;InvokeType DIRECT, ...;InvokeType VIRTUAL, ...;InvokeType INTERFACE, ...;InvokeType SUPER, ...;InvokeType POLYMORPHIC, ...;InvokeType CUSTOM, ...;ArgType arrType, ...;InsnType.NEW_ARRAYthis.arrTypeNewArrayNode otherother.arrTypeimport InsnRemoverList<BlockNode> blockBinds, ...;// map arguments to blocks (in same order as in arguments list)InsnType.PHIthis.blockBindsnew ArrayList<BlockNode>(...)bindArg(...)getArgIndex(...)removeArg(...)updateUsedInPhiList(...)int argIndexaddUsedInPhi(...)unbindArgUsage(...)new PhiInsn(...)...[] keys, ...;...[] targets, ...;InsnType.SWITCH_DATAthis.keysthis.targetsint dataTarget, ...;boolean packed, ...;SwitchData switchData, ...;// type of switch insn, if true can contain filler keysint def, ...;...[] modifiedKeys, ...;// next instruction...[] targetBlocks, ...;BlockNode defTargetBlock, ...;InsnType.SWITCHthis.dataTargetthis.packedint switchOffsetthis.switchDatathis.deftargets.lengthnew BlockNode[]targetBlocks.lengthSwitchInsn otherother.dataTargetother.packedSwitchInsn copycopy.switchDatacopy.defcopy.targetBlockscopy.defTargetBlockgetSwitchData(...)int caseCountObject[] newKeysnew Object[]// fix targetsimport Functionimport TestOnlyimport TypeCompareEnumprimitive(...)PrimitiveType.VOIDobjectNoCache(...)Consts.CLASS_ENUMConsts.CLASS_EXCEPTIONArgType INT, ...;ArgType BOOLEAN, ...;ArgType BYTE, ...;ArgType SHORT, ...;ArgType CHAR, ...;ArgType FLOAT, ...;ArgType DOUBLE, ...;ArgType LONG, ...;ArgType VOID, ...;ArgType OBJECT, ...;ArgType CLASS, ...;ArgType STRING, ...;ArgType ENUM, ...;ArgType THROWABLE, ...;ArgType EXCEPTION, ...;ArgType OBJECT_ARRAY, ...;ArgType WILDCARD, ...;ArgType UNKNOWN, ...;ArgType UNKNOWN_OBJECT, ...;ArgType UNKNOWN_OBJECT_NO_ARRAY, ...;ArgType UNKNOWN_ARRAY, ...;ArgType NARROW, ...;ArgType NARROW_NUMBERS, ...;ArgType NARROW_INTEGRAL, ...;ArgType NARROW_NUMBERS_NO_BOOL, ...;ArgType NARROW_NUMBERS_NO_FLOAT, ...;ArgType WIDE, ...;ArgType INT_FLOAT, ...;ArgType INT_BOOLEAN, ...;int hash, ...;new PrimitiveArg(...)new ObjectType(...)String cleanObjectNamecleanObjectName(...)new GenericType(...)new WildcardType(...)WildcardBound.UNBOUNDnew GenericObject(...)new OuterGenericObject(...)new ArrayArg(...)new UnknownArg(...)new PrimitiveType[]...[] EMPTY_POSSIBLES, ...;PrimitiveType type, ...;this.hash(...).typeString objName, ...;this.objName(...).objNameList<ArgType> extendTypes, ...;this.extendTypesinternalEquals(...)(...).extendTypesList<ArgType> extTypesnew WildcardBound(...)WildcardBound EXTENDS, ...;WildcardBound UNBOUND, ...;// upper bound (? extends A)WildcardBound SUPER, ...;// no bounds (?)int num, ...;// lower bound (? super A)this.numWildcardBound bound, ...;this.bound(...).boundList<ArgType> generics, ...;this.genericscalcHash(...)(...).genericsObjectType outerType, ...;ObjectType innerType, ...;this.outerTypethis.innerType(...).outerType(...).innerType...[] ARRAY_POSSIBLES, ...;ArgType arrayElement, ...;this.arrayElementArrayArg otherArr...[] possibleTypes, ...;this.possibleTypesPrimitiveType t(...).possibleTypespossibleTypes.lengtharrayToStr(...)new UnsupportedOperationException(...)TypeCompareEnum resultcompareTypes(...)getTypeCompare(...)getTypeUpdate(...)isNarrow(...)isClsKnown(...)isObjectOrArray(...)PrimitiveType primitiveTypegetPossibleTypes(...)ArgType.VOIDchar fArgType arrayElementcontainsGeneric(...)ArgType wildcardTypecontainsTypeVariable(...)List<ArgType> genericTypesArgType genericType/** Recursively visit all subtypes of this type. ... */R rapply(...)visitTypes(...)R res// TODO: add cachingList<SSAVar> ssaVars, ...;// before type inference can be null and set only for immutable typesboolean isFinal, ...;boolean isThis, ...;boolean isDeclared, ...;int index, ...;new CodeVar(...)setThis(...)setDeclared(...)setSsaVars(...)new SSAVar(...)new ArrayList<SSAVar>(...)this.ssaVars/** Merge flags with OR operator */isDeclared(...)setFinal(...)/** Instruction argument, ... */InsnArg.classInsnNode parentInsn, ...;new RegisterArg(...)AFlag.IMMUTABLE_TYPEmakeWithFixedType(...)AFlag.WRAPPEDnew InsnWrapArg(...)this.parentInsnwrapInstruction(...)InsnNode parentwrapInsnIntoArg(...)InsnArg oldArgsetNameIfUnknown(...)RegisterArg registerArgunbindResult(...)InsnType typewrapArg(...)/** Prefer {@link InsnArg#wrapInsnIntoArg(InsnNode)}. ... */isConstInsn(...)copyAttributesFrom(...)setParentInsn(...)// preserve variable name for move insn (needed in `for-each` loop for iteration variable)// result not needed in wrapped insnInsnNode wrappedInsn, ...;/** Use {@link InsnArg#wrapInsnIntoArg(InsnNode)} instead this constructor */RegisterArg resultthis.wrappedInsnInsnWrapArg copycopyWithoutResult(...)InsnWrapArg thatInsnNode thisInsnInsnNode thatInsnthat.wrappedInsnnew LiteralArg(...)fixLiteralType(...)ArgType.NARROW_NUMBERSArgType.NARROW_NUMBERS_NO_BOOLlong literal, ...;this.literal... ^ ...... >>> ...LiteralArg thatthat.literalString valueJadxRuntimeException ex// can't convert literal to string(...).namenew PrimitiveType(...)PrimitiveType BOOLEAN, ...;PrimitiveType CHAR, ...;PrimitiveType BYTE, ...;PrimitiveType SHORT, ...;PrimitiveType INT, ...;PrimitiveType FLOAT, ...;PrimitiveType LONG, ...;PrimitiveType DOUBLE, ...;PrimitiveType OBJECT, ...;PrimitiveType ARRAY, ...;PrimitiveType VOID, ...;String longName, ...;this.longNameString THIS_ARG_NAME, ...;String SUPER_ARG_NAME, ...;int regNum, ...;SSAVar sVar, ...;// not null after SSATransform passthis.regNumgetTypeInfo(...)getImmutableType(...)isTypeImmutable(...)this.sVarAFlag.SUPERRegisterArg duplicatemakeNewSVar(...)RegisterArg dupsetSVar(...)arg.regNumarg.typeRegisterArg otherother.regNumArgType initTypeisAttrStorageEmpty(...)// initial type, not changing, can be unknown// only 'set' here, 'assign' or 'use' will binds laterimport TypeInfonew ArrayList<RegisterArg>(...)new TypeInfo(...)SSAVar.classint version, ...;RegisterArg assign, ...;List<RegisterArg> useList, ...;List<PhiInsn> usedInPhi, ...;TypeInfo typeInfo, ...;CodeVar codeVar, ...;this.versionthis.assignforceSetInitType(...)Consts.DEBUG_TYPE_INFERENCEtoShortString(...)ArgType imTypeupdateType(...)removeUse(...)new Predicate<RegisterArg>(...) { ... }new ArrayList<PhiInsn>(...)new Predicate<PhiInsn>(...) { ... }this.usedInPhiInsnNode parentInsn/** Concat assign PHI insn and usedInPhi */PhiInsn assignPhiList<PhiInsn> listthis.codeVaraddSsaVar(...)getBounds(...)this.typeInfossaVar.regNumssaVar.versionSet<ArgType> typesnew HashSet<ArgType>(...)List<RegisterArg> useArgsRegDebugInfoAttr debugInfoAttrgetRegType(...)MethodInfo callMth, ...;CallType callType, ...;new CallType(...)CallType CONSTRUCTOR, ...;CallType SUPER, ...;// just new instanceCallType THIS, ...;// super callCallType SELF, ...;// call constructor from other constructorthis.callMththis.callTypegetCallType(...)CallType.SELFCallType.THISCallType.SUPERCallType.CONSTRUCTORConstructorInsn otherother.callMthother.callType// call itself// self constructorIfCondition condition, ...;this.conditionInsnType.TERNARYsimplify(...)IfCondition.Mode.NOTIfCondition.ModeInsnArg tmpgetRegisterArgs(...)TernaryInsn thatthat.conditionTernaryInsn copynew TernaryInsn(...)copy.conditionrebindArgs(...)// invertedimport EmptyBitSetimport static Utils.lockListnew ArrayList<InsnNode>(...)EmptyBitSet.EMPTYint startOffset, ...;List<InsnNode> instructions, ...;List<BlockNode> predecessors, ...;List<BlockNode> successors, ...;List<BlockNode> cleanSuccessors, ...;BitSet doms, ...;// all dominatorsBitSet domFrontier, ...;// dominance frontierBlockNode idom, ...;// immediate dominatorList<BlockNode> dominatesOn, ...;// blocks on which dominates this blockthis.startOffsetcleanSuccessors(...)lockList(...)/** Return all successor which are not exception handler or followed by loop back edge */List<BlockNode> sucListList<BlockNode> toRemoveIgnoreEdgeAttr ignoreEdgeAttrList<BlockNode> resultBlockNode bisBlockMustBeCleared(...)AFlag.LOOP_ENDList<LoopInfo> loopsAType<>.LOOPLoopInfo loopgetBlocks(...)removeAll(...)/** Check if 'block' dominated on this node *//** Dominators of this node (exclude itself) */this.domsthis.domFrontier/** Immediate dominator */this.idomAFlag.SYNTHETICAFlag.RETURNBlockNode otherother.idother.startOffseto.idimport LinkedHashSetimport Consumerimport IClassDataimport ProcessClassimport FieldInitConstAttrimport NotificationAttrNodeimport AFTypeProcessState.NOT_LOADEDLoadStage.NONEClassNode.classIClassData clsData, ...;ClassInfo clsInfo, ...;AccessInfo accessFlags, ...;ArgType superClass, ...;List<ArgType> interfaces, ...;List<MethodNode> methods, ...;List<FieldNode> fields, ...;List<ClassNode> innerClasses, ...;List<ClassNode> inlinedClasses, ...;String smali, ...;// store smaliClassNode parentClass, ...;// store parent for inner classes or 'this' otherwiseProcessState state, ...;LoadStage loadStage, ...;List<ClassNode> dependencies, ...;/** Top level classes used in this class (only for top level classes, empty for inners) */List<ClassNode> useIn, ...;/** Classes which uses this class */List<MethodNode> useInMth, ...;/** Methods which uses this class (by instructions only, definition is excluded) */Map<MethodInfo,MethodNode> mthInfoMap, ...;// cache mapsthis.clsInfothis.clsDatainitialLoad(...)String superTypegetSuperType(...)getInterfacesTypes(...)new ArrayList<MethodNode>(...)new ArrayList<FieldNode>(...)visitFieldsAndMethods(...)new Consumer<IFieldData>(...) { ... }new Consumer<IMethodData>(...) { ... }attach(...)loadStaticValues(...)initAccessFlags(...)addSourceFilenameAttr(...)getSourceFile(...)buildCache(...)/** Restore original access flags from Dalvik annotation if present */int accFlagsValueConsts.DALVIK_INNER_CLASSAFType.CLASSnew ClassNode(...)ProcessState.PROCESS_COMPLETEaddClassNode(...)// Create empty classList<FieldNode> staticFieldsnew Predicate<FieldNode>(...) { ... }getStaticFieldInitValues(...)constValue(...)processConstFields(...)getConstValues(...)new SourceFileAttr(...)ProcessState stateclearAttributes(...)removeForClass(...)runForClass(...)ICodeCache codeCachegetCodeCache(...)ICodeInfo codeInfonew Consumer<MethodNode>(...) { ... }new Consumer<ClassNode>(...) { ... }new Consumer<FieldNode>(...) { ... }this.loadStagethis.smalinew HashMap<MethodInfo,MethodNode>(...)getConstFieldByLiteralArg(...)equalsNameAndType(...)/** Return first method by original short name ... */ClassNode parentClassNode parentClsaccept(...)/** Get all inner and inlined classes recursively ... */getInnerAndInlinedClassesRecursive(...)ClassNode inlinedClsnew ArrayList<ClassNode>(...)cls.parentClassArgType.ENUMsearchMethodByShortId(...)isDefaultConstructor(...)/** Internal class info (don't use in code generation and external api). */Set<ClassNode> allInlinedClassesnew LinkedHashSet<ClassNode>(...)lineSeparator(...)getDisassembledCode(...)this.stateClassNode topClsgetLoadStage(...)this.dependenciesthis.useInthis.useInMthClassNode otherother.clsInfo// only java.lang.Object don't have super class// incorrect initialization will be removed if assign found in constructor// process const fields// manually added classBlockNode source, ...;BlockNode target, ...;this.sourceEdge edgeedge.sourceedge.targetFieldInfo fieldInfo, ...;AccessInfo accFlags, ...;List<MethodNode> useIn, ...;new FieldNode(...)this.fieldInfoAFType.FIELDFieldNode otherother.fieldInfo/** Return list of branches in this region. ... *//** Unique id for use in 'toString()' method *//** On demand loading *//** Free resources *//** Lightweight replacement for BlockNode in regions. ... */List<InsnNode> insns, ...;this.insnsInsnType insnType, ...;RegisterArg result, ...;List<InsnArg> arguments, ...;new ArrayList<InsnArg>(...)this.insnTypeattachArg(...)InsnType.ONE_ARGthis.resultsetAssign(...)use(...)InsnArg asameRegAndSVar(...)/** Replace instruction arg with another using recursive search. */replaceArg(...)canReorder(...)canReorderRecursive(...)/** 'Soft' equals, don't compare arguments, only instruction specific parameters. */other.insnTypeother.argumentsInsnArg otherArgInsnNode otherWrapInsn/** 'Hard' equals, compare all arguments */other.resultcopyLines(...)/** Make copy of InsnNode object. ... */InsnNode.class/** See {@link #copy()} */InsnNode copyRegisterArg resDupArg/** Fix SSAVar info in register arguments. ... *//** Compare instruction only by identity. */String argsStrString separator// check wrapped instructions// wrap argsnew LoadStage(...)LoadStage NONE, ...;LoadStage PROCESS_STAGE, ...;LoadStage CODEGEN_STAGE, ...;// dependencies not yet loaded// all dependencies loadedimport IDebugInfoimport IMethodDataimport NameGenimport InsnDecoderimport jadx.core.dex.instructions.args.*import VarKindimport TypeUtilsnew ArrayList<VariableNode>(...)MethodNode.classMethodInfo mthInfo, ...;ICodeReader codeReader, ...;boolean methodIsVirtual, ...;int insnsCount, ...;boolean noCode, ...;int regsCount, ...;boolean loaded, ...;// additional info available after load, keep on unloadRegisterArg thisArg, ...;// decompilation data, reset on unloadList<RegisterArg> argsList, ...;...[] instructions, ...;List<BlockNode> blocks, ...;BlockNode enterBlock, ...;List<BlockNode> exitBlocks, ...;List<SSAVar> sVars, ...;List<ExceptionHandler> exceptionHandlers, ...;List<LoopInfo> loops, ...;Region region, ...;List<VariableNode> variables, ...;MethodNode methodNodenew MethodNode(...)getParamsAnnotations(...)ICodeReader codeReadergetCodeReader(...)this.mthInfoAFType.METHODthis.methodIsVirtualisDirect(...)this.noCodethis.codeReaderthis.insnsCountgetVariableName(...)setIndex(...)new VariableNode(...)this.variablesInsnDecoder decodernew InsnDecoder(...)initArguments(...)this.regsCountgetRegistersCount(...)this.instructionsList<RegisterArg> listInsnNode insnNodeRegisterArg resultArgTypeUtils typeUtilsgetTypeUtils(...)ArgType thisClsTypeexpandTypeVariables(...)ArgType expandedTypeRegisterArg regArgAFlag.METHOD_ARGUMENTaddDebugComment(...)List<RegisterArg> argRegsnew Consumer<BlockNode>(...) { ... }lock(...)this.enterBlockthis.exitBlocksnew ArrayList<LoopInfo>(...)setId(...)List<LoopInfo> listnew ArrayList<ExceptionHandler>(...)ExceptionHandler hgetHandleOffset(...)getTryBlock(...)ClassInfo catchTypeaddCatchType(...)new Predicate<ExceptionHandler>(...) { ... }isRemoved(...)Consts.DALVIK_THROWSList<EncodedValue> typesnew Function<EncodedValue,ArgType>(...) { ... }/** Return true if exists method with same name and arguments count */MethodInfo thisMthInfoisOverloadedBy(...)isMethodArgsOverloaded(...)getMethodUtils(...)int defaultArgCountClassNode outerClsgetNextSVarVersion(...)int vSSAVar sVarthis.regiongetCodeOffset(...)getDebugInfo(...)/** Calculate instructions count at currect stage */instructions.lengthmapToLong(...)new ToLongFunction<BlockNode>(...) { ... }/** Raw instructions count in method bytecode */MethodNode otherother.mthInfoo.mthInfo// set name with user renamed previously.// let NameGen record this name or gen an valid name.// don't unload retType, argTypes, typeParameters// method already loaded// TODO: registers not needed without code// load without code// same handlers from different try blocks// will merge later// quick check in current class// workaround for non-static inner class constructor, that has synthetic argumentnew ProcessState(...)ProcessState NOT_LOADED, ...;ProcessState LOADED, ...;ProcessState PROCESS_STARTED, ...;ProcessState PROCESS_COMPLETE, ...;ProcessState GENERATED_AND_UNLOADED, ...;import ResourceFileimport ResourceTypeimport ResourcesLoaderimport ClspGraphimport ConstStorageimport InfoStorageimport MethodUtilsimport TypeCompareimport TypeUpdateimport CacheStorageimport AndroidResourcesUtilsimport ResourceStorageimport ValuesParsernew ErrorsCounter(...)new InfoStorage(...)new CacheStorage(...)new HashMap<ClassInfo,ClassNode>(...)RootNode.classList<IDexTreeVisitor> preDecompilePasses, ...;List<IDexTreeVisitor> passes, ...;ErrorsCounter errorsCounter, ...;StringUtils stringUtils, ...;ConstStorage constValues, ...;InfoStorage infoStorage, ...;CacheStorage cacheStorage, ...;TypeUpdate typeUpdate, ...;MethodUtils methodUtils, ...;TypeUtils typeUtils, ...;Map<ClassInfo,ClassNode> clsMap, ...;List<ClassNode> classes, ...;ClspGraph clsp, ...;String appPackage, ...;ClassNode appResClass, ...;this.preDecompilePassesgetPreDecompilePassesList(...)this.passesgetPassesList(...)this.stringUtilsnew StringUtils(...)this.constValuesnew ConstStorage(...)this.typeUpdatenew TypeUpdate(...)this.methodUtilsnew MethodUtils(...)this.typeUtilsnew TypeUtils(...)ILoadResult loadedInputvisitClasses(...)new Consumer<IClassData>(...) { ... }RootNode.thisaddDummyClass(...)groupingBy(...)new Function<ClassNode,ClassInfo>(...) { ... }new Predicate<Entry<ClassInfo,List<ClassNode>>>(...) { ... }new Consumer<Entry<ClassInfo,List<ClassNode>>>(...) { ... }new Function<ClassNode,String>(...) { ... }initInnerClasses(...)String typeStrClassNode clsNodeaddSyntheticClass(...)ResourceFile arscResTableParser parsernew ResourceDecoder<ResTableParser>(...) { ... }ResTableParser tableParserprocessResources(...)updateObfuscatedFiles(...)setResourcesNames(...)getAppPackage(...)searchAppResClass(...)this.clspClspGraph newClspnew ClspGraph(...)addApp(...)long startint renamedCountResourceStorage resStorageValuesParser valuesParsernew ValuesParser(...)getStrings(...)Map<String,ResourceEntry> entryNamesnew HashMap<String,ResourceEntry>(...)ResourceEntry resEntrygetSimpleValueString(...)ResourceFile resourceList<ClassNode> innerList<ClassNode> updatednotInner(...)ClassNode updClsupdateNames(...)IDexTreeVisitor passList<ClassNode> notInnerClassessearchMethod(...)MethodNode foundClassNode superNodeArgType iFaceTypeClassNode iFaceNodesearchField(...)searchFieldByNameAndType(...)FieldNode found// class name duplication detected// sort classes by name, expect top classes before inner// move inner classes// reload names for inner classes of updated parentsnew VarKind(...)VarKind VAR, ...;// they are also used for variable renaming// note: better not change the order of these fields,VarKind ARG, ...;VarKind CATCH_ARG, ...;String VAR_SEPARATOR, ...;VarKind varKind, ...;// do not contain '='this.varKindkindToStr(...)String kindSignatureParser.classchar STOP_CHAR, ...;String sign, ...;int end, ...;int pos, ...;int mark, ...;String signaturegetSignature(...)new SignatureParser(...)Consts.DALVIK_SIGNATUREList<String> stringsnew Function<EncodedValue,String>(...) { ... }mergeSignature(...)int next/** Exclusive slice. ... */int start/** Inclusive slice (includes current character) */int lastint startPoschar chlookAhead(...)char cdebugString(...)mark(...)skipUntil(...)inclusiveSlice(...)ArgType objconsumeObjectType(...)String typeVarNameconsumeUntil(...)consume(...)consumeType(...)int chString objslice(...)List<ArgType> typeVarsconsumeGenericArgs(...)ArgType innernew LinkedList<ArgType>(...)ArgType.WildcardBound.EXTENDSArgType.WildcardBound.SUPER/** Map of generic types names to extends classes. ... */String idList<ArgType> typesconsumeExtendsTypesList(...)tryConsume(...)/** List of types separated by ':' last type is 'java.lang.Object'. ... */boolean nextint limit// primitive type (one char)// stop before next nested inner class// generic type start ('<')// type parsing not completed, proceed to inner class// for every nested inner type create nested type object// just prevent endless loop, args count can be different for synthetic methodsimport ClspClassimport ClspMethodIMethodDetails methodDetailsgetMethodDetails(...)MethodNode mthNode/** Search methods with same name and args count in class hierarchy starting from {@code startCls} ... */processMethodArgsOverloaded(...)List<IMethodDetails> listnew ArrayList<IMethodDetails>(...)boolean isMthConstructorArgType parentInterfaceClspClass clsDetailsgetClsDetails(...)ClspMethod clspMth// class info not availableimport static Utils.notEmptyexpandTypeVar(...)getKnownTypeVarsAtMethod(...)boolean allExtendsEmptynew Function<ArgType,Object>(...) { ... }ArgType typeVarsetExtendTypes(...)MethodTypeVarsAttr typeVarsAttrSet<ArgType> typeVarscollectKnownTypeVarsAtMethod(...)MethodTypeVarsAttr varsAttrgetTypeVars(...)ClassNode declClsvisitParentClasses(...)/** Replace generic types in {@code typeWithGeneric} using instance types ... */Map<ArgType,ArgType> replaceMapgetTypeVariablesMapping(...)replaceTypeVariablesUsingMap(...)getClassGenerics(...)List<ArgType> actualTypesint genericParamsCountnew HashMap<ArgType,ArgType>(...)ArgType actualTypeIMethodDetails mthDetailsMap<ArgType,ArgType> mapint argCountmin(...)addTypeVarMapping(...)List<ArgType> methodArgTypesint firstArgOffsetgetFirstArgOffset(...)ArgType methodArgTypeArgType insnTypeArgType replacedArgType newWildcardTypeList<ArgType> newTypes// TODO: resolve inner type vars: 'List<T> -> List<String>' to 'T -> String'// TODO build complete map for type variablesimport IContainerimport IRegionAbstractRegion.classIRegion parent, ...;setParent(...)List<IContainer> blocks, ...;this.blocksnew ArrayList<IContainer>(...)updateParent(...)new Function<IContainer,String>(...) { ... }baseString(...)import IBranchRegionnew Object(...)Object DEFAULT_CASE_KEY, ...;BlockNode header, ...;List<CaseInfo> cases, ...;this.headerthis.casesnew ArrayList<CaseInfo>(...)List<Object> keys, ...;IContainer container, ...;this.containernew CaseInfo(...)new Function<CaseInfo,IContainer>(...) { ... }caseInfo.containerList<IContainer> allgetCaseContainers(...)List<String> keyStringsnew Function<Object,String>(...) { ... }InsnNode enterInsn, ...;List<InsnNode> exitInsns, ...;this.enterInsnnew Region(...)import TryCatchBlockIContainer tryRegion, ...;Map<ExceptionHandler,IContainer> catchRegions, ...;IContainer finallyRegion, ...;TryCatchBlock tryCatchBlock, ...;this.tryRegiongetHandlersCount(...)this.tryCatchBlockthis.catchRegionsnew LinkedHashMap<ExceptionHandler,IContainer>(...)getHandlers(...)IContainer handlerRegionisFinally(...)this.finallyRegionIfNode insn, ...;AFlag.HIDDENinvertCondition(...)/** Change 'a != false' to 'a == true' */changeCondition(...)litTrue(...)new Mode(...)Mode COMPARE, ...;Mode TERNARY, ...;Mode NOT, ...;Mode AND, ...;Mode OR, ...;Mode mode, ...;List<IfCondition> args, ...;Compare compare, ...;this.modeMode.COMPAREthis.comparec.modec.comparenew ArrayList<IfCondition>(...)c.argsfromIfNode(...)new IfCondition(...)new Compare(...)Mode.TERNARYIfCondition nMode modeList<IfCondition> argsList<IfCondition> newArgsternary(...)IfCondition argMode.ORcond.compareCompare cIfCondition isimplifyCmpOp(...)normalize(...)IfCondition simplint negCountIfNode insnArithOp arithOpIfOp ifOpboolean isTrueIfNode if1litFalse(...)IfNode if2new LinkedList<RegisterArg>(...)String opIfCondition otherother.modeother.argsother.compare// arguments was changed// for condition with a lot of negations => make invertSet<BlockNode> mergedBlocks, ...;Set<BlockNode> skipBlocks, ...;List<InsnNode> forceInlineInsns, ...;BlockNode outBlock, ...;BlockNode ifBlock, ...;getMergedBlocks(...)getSkipBlocks(...)getForceInlineInsns(...)this.thenBlockthis.elseBlockthis.mergedBlocksthis.skipBlocksthis.forceInlineInsnsIfCondition invertedConditionIfInfo tmpIfnew IfInfo(...)getElseBlock(...)getThenBlock(...)setIfBlock(...)getIfBlock(...)IfInfo infoaddInsnsForForcedInline(...)this.outBlockthis.ifBlockimport AbstractRegionList<BlockNode> conditionBlocks, ...;IContainer thenRegion, ...;IContainer elseRegion, ...;this.thenRegionthis.elseRegionthis.conditionBlocksList<BlockNode> listIfCondition condIContainer tmpint sourceLineList<IContainer> branches// swap regionsInsnNode varArgInsn, ...;InsnNode iterableArgInsn, ...;getPreHeader(...)// store for-each args in fake instructions to// save code semantics and allow args manipulations like args inlining// will be declared at codegenInsnNode initInsn, ...;InsnNode incrInsn, ...;this.initInsnthis.incrInsnLoopInfo info, ...;/** loop header contains one 'if' insn, equals null for infinite loop */BlockNode conditionBlock, ...;BlockNode preCondition, ...;// instruction which must be executed before condition in every loopIRegion body, ...;boolean conditionAtEnd, ...;LoopType type, ...;this.infothis.conditionBlockfromIfBlock(...)this.conditionAtEndthis.body/** Set instructions which must be executed before condition in every loop */this.preCondition/** Check if pre-conditions can be inlined into loop condition */List<InsnNode> insnsgetIfInsn(...)RegisterArg resboolean foundcontainsVar(...)/** Move all preCondition block instructions before conditionBlock instructions */List<InsnNode> condInsnsList<InsnNode> preCondInsns// search result arg in other insns// or in if insnTryCatchBlock tryBlock, ...;this.tryBlockExceptionHandler handler, ...;this.handlercatchTypeStr(...)import TreeSetnew TreeSet<ClassInfo>(...)Set<ClassInfo> catchTypes, ...;int handleOffset, ...;BlockNode handlerBlock, ...;IContainer handlerRegion, ...;InsnArg arg, ...;boolean isFinally, ...;boolean removed, ...;this.handleOffset/** Add exception type to catch block ... */this.catchTypesClassInfo typeSet<ClassInfo> typesthis.handlerBlockthis.handlerRegionthis.argthis.isFinallythis.removedExceptionHandler thatthat.handleOffsetthat.catchTypesthat.tryBlock/* , tryBlock */BlockNode block, ...;this.blockAType<>.SPLITTER_BLOCKList<ExceptionHandler> handlers, ...;// references for fast remove/modifyCatchAttr attr, ...;new CatchAttr(...)containsAll(...)tb.handlersnew ExceptionHandler(...)ExceptionHandler addedHandleraddExceptionHandler(...)setTryBlock(...)/** Use only before BlockSplitter */Iterator<ExceptionHandler> itunbindHandler(...)removeWholeBlock(...)ExcHandlerAttr excHandlerAttrSplitterBlockAttr splittergetHandlerBlock(...)skipPredSyntheticPaths(...)AFlag.REMOVEgetHandler(...)BlockNode splitterBlockgetBlock(...)BlockNode successormarkForRemove(...)removeAttr(...)getBasicBlocks(...)getInsns(...)addInsn(...)this.handlerstryBlock.handlersExceptionHandler ehTryCatchBlock otherother.handlers// skip synthetic loop exit blocks// self destruction// clear// no op implementationCodeShrinkVisitor.classTypeInferenceVisitor.classMethodInvokeVisitor.classattachMethodDetails(...)import ICatchimport ITryimport static ProcessInstructionsVisitor.getNextInsnOffsetProcessInstructionsVisitor.classinitTryCatches(...)List<ITry> triesgetTries(...)int handlersCountSet<Integer> addrsnew HashSet<Integer>(...)List<TryCatchBlock> catchesnew ArrayList<TryCatchBlock>(...)ITry tryDataTryCatchBlock catchBlockprocessHandlers(...)getCatch(...)TryCatchBlock outerTryTryCatchBlock innerTrycontainsAllHandlers(...)removeSameHandlers(...)TryCatchBlock tryCatchBlockint addrExcHandlerAttr ehAttrnew ExcHandlerAttr(...)markTryBounds(...)getStartAddress(...)int endgetInstructionCount(...)boolean tryBlockStartedcanThrowException(...)AFlag.TRY_ENTERgetNextInsnOffset(...)AFlag.TRY_LEAVEint[] handlerAddrArrgetAddresses(...)String[] handlerTypesgetTypes(...)handlerAddrArr.lengthTryCatchBlock tcBlocknew TryCatchBlock(...)getCatchAllAddress(...)addHandler(...)// TODO: run modify in later passes// resolve nested try blocks:// inner block contains all handlers from outer block => remove these handlers from inner block// each handler must be only in one try/catch block// TODO: don't override existing attributeModVisitor.classFixAccessModifiers.classProcessAnonymous.classisEmptySyntheticClass(...)removeSyntheticFields(...)removeSyntheticMethods(...)removeEmptyMethods(...)cleanInsnsInAnonymousConstructor(...)/** Remove synthetic fields if type is outer class or class will be inlined (anonymous) */boolean inlineClassNode fieldsClsint foundremoveFieldUsageFromConstructor(...)new FieldReplaceAttr(...)List<InsnNode> instructionsIndexInsnNode putInsnskipFirstArgument(...)InsnNode igetgetUseList(...)removeBridgeMethod(...)isRemovedClassInArgs(...)modifySyntheticMethod(...)ClassNode argClsClassInfo argClsInfo/** Remove synthetic constructor and redirect calls to existing constructor */ConstructorInsn constrRegisterArg firstArgList<InsnNode> allInsnscollectAllInsns(...)InsnNode wrappedInsncheckSyntheticWrapper(...)isMethodUnique(...)MethodNode wrappedMthAccessInfo wrappedAccFlagsregistersAndCastsOnly(...)changeVisibility(...)MethodInfo miMethodNode otherMthMethodInfo omiList<BlockNode> bbisAllBlocksEmpty(...)isNonDefaultConstructorExists(...)/** Remove super call and put into removed fields from anonymous constructor */ConstructorInsn ctorInsnFieldInfo fldInfo// other arg usage -> wrap with IGET insn// remove synthetic constructor for inner classes// check if missing class from current top class// remove first arg for non-static class (references to outer class)// remove unused args// rename method only from current class// all args must be registers passed from method args (allow only casts insns)// remove confirmed, change visibility and name if needed// must be public// remove public empty constructors (static or default)// don't remove default constructor if other constructors existsSSATransform.classMarkFinallyVisitor.classList<InsnNode> toRemovecheckInsn(...)removeAllAndUnbind(...)InsnArg constArgforbidNullInlines(...)isUsedInPhi(...)InsnNode constGetreplaceConst(...)/** Don't inline null object */List<RegisterArg> useListRegisterArg useArgcanUseNull(...)AFlag.DONT_INLINE_CONSTgetInstanceArg(...)int replaceCountcanInline(...)AFlag.FINALLY_INSNSInsnNode useInsnArgType litArgTypeneedExplicitCast(...)BaseInvokeNode callInsn// all usages forbids inlining// all check passed, run replace// arg replaced, made some optimizationsMoveInlineVisitor.classreplaceInvoke(...)InsnRemover removernew InsnRemover(...)setBlock(...)processInvoke(...)perform(...)RegisterArg instanceArgInsnNode instArgAssignInsngetAssignInsn(...)boolean removeConstructorInsn replaceprocessConstructor(...)isNewInstance(...)MethodNode defCoaddAndUnbind(...)InsnNode newInstInsnremoveAssignChain(...)RegisterArg instArgaddWithoutUnbind(...)replaceInsn(...)/** Replace call of synthetic constructor with all 'null' args ... */boolean passThisString ctrIdMethodNode defCtrConstructorInsn newInsnallArgsNull(...)/** Remove instructions on 'move' chain until instruction with type 'insnType' */// convert from 'use' to 'assign'// default constructor not implemented// remove super() call in instance initializer// replace all usages of 'instArg' with result of this constructor instruction/** Remove primitives boxing ... */ProcessVariables.classSet<MethodInfo> valueOfMths, ...;new HashSet<MethodInfo>(...)valueOfMth(...)ArgType boxTypeClassInfo boxClsList<InsnNode> insnListInsnNode replaceInsncheckForReplace(...)ArgType primitiveTypeboolean forbidInlineInsnNode constInsnisNeedExplicitCast(...)canChangeTypeToPrimitive(...)Set<ArgType> useTypescollectUseTypes(...)import DebugChecksDebugChecks.checksEnabledrunChecksAfterVisitor(...)import IBlockboolean PRINT_DOMINATORS, ...;boolean PRINT_DOMINATORS_INFO, ...;boolean useRegions, ...;boolean rawInsn, ...;new DotGraphVisitor(...)this.useRegionsthis.rawInsnFile outRootDirnew DumpDotGraph(...)CodeWriter dot, ...;CodeWriter conn, ...;File dir, ...;this.dirString attrsattributesString(...)processMethodRegion(...)processBlock(...)makeName(...)getEnterBlock(...)Set<IBlock> regionsBlocksnew HashSet<IBlock>(...)processRegion(...)getExceptionHandlers(...)getAllRegionBlocks(...)IRegion rprocessIBlock(...)String insnsinsertInsns(...)BlockNode falsePathgetDoms(...)getIDom(...)getDomFrontier(...)getDominatesOn(...)BlockNode nextString styleaddEdge(...)BlockNode cBlockNode dombitSetToBlocks(...)StringBuilder attrsString attrgetAttributesStringsList(...)CodeWriter codetoArray(...)// TODO replace \"import Optionalimport BlockInsnPairimport static InsnUtils.checkInsnTypeimport static InsnUtils.getSingleArgimport static InsnUtils.getWrappedInsnReSugarCode.classExtractFieldInit.classMethodInfo enumValueOfMth, ...;convertToEnum(...)MethodNode classInitMthgetClassInitMth(...)List<FieldNode> valuesCandidatesFieldNode valuesFieldBlockInsnPair valuesInitPairgetValuesInitInsn(...)BlockNode staticBlockInsnNode valuesInitInsnList<EnumField> enumFieldsEnumClassAttr attrnew EnumClassAttr(...)Optional<FieldNode> valuesOptfindAny(...)isPresent(...)extractEnumFieldsFromInsn(...)setStaticMethod(...)EnumField enumFieldgetConstString(...)processConstructorInsn(...)countInsns(...)shrinkMethod(...)removeEnumMethods(...)ClassInfo enumClsInfoList<RegisterArg> regsMethodNode ctrMthClassNode enumClsprocessEnumCls(...)markArgsForSkip(...)removeWithoutUnbind(...)extractEnumFieldsFromFilledArray(...)extractEnumFieldsFromInvoke(...)isZeroLiteral(...)MethodNode valuesMthBlockNode returnBlockgetOne(...)getExitBlocks(...)InsnNode returnInsngetWrappedInsn(...)getSingleArg(...)isVoidReturn(...)FieldInfo searchFieldIndexInsnNode indexInsnNodenew BlockInsnPair(...)new ArrayList<EnumField>(...)EnumField fieldprocessEnumFieldByField(...)processEnumFiledByRegister(...)FieldNode enumFieldNodesearchFieldPutInsn(...)getConstructorInsn(...)RegisterArg sgetResultcreateEnumFieldByConstructor(...)InsnNode constrInsnClassNode constrClsnew EnumField(...)String valuesMethodFieldInfo valuesFieldInfoString shortIdsimpleValueOfMth(...)usesValuesField(...)boolean defaultIdsearchSingleReturnInsn(...)IndexInsnNode castInsncheckInsnType(...)Predicate<InsnNode> insnTestsearchInsn(...)MethodNode innerMthsetCls(...)castConstructorInsn(...)Object constValuegetConstValueByInsn(...)// search "$VALUES" field (holds all enum values)// search "$VALUES" array init and collect enum fields// all checks complete, perform transform// use string arg from the constructor as enum field name// handle redirection of values array fill (added in java 15)// empty enum// usually constructor signature is '<init>(Ljava/lang/String;I)V'.// sometimes for one field enum second arg can be omitted// remove compiler generated methods// skip first and second args// check content// remove constructor, because it is anonymous classClassModifier.classcheckStaticFieldsInit(...)moveStaticFieldsInit(...)moveCommonFieldsInit(...)MethodNode clinitprocessStaticFieldAssign(...)/** Remove a final field in place initialization if it an assign found in class init method */List<InsnNode> initInsnsgetFieldAssigns(...)addFieldInitAttr(...)MethodNode constrMth, ...;List<InsnNode> putInsns, ...;this.constrMthList<MethodNode> constrListgetConstructorsList(...)List<InitInfo> infoListnew ArrayList<InitInfo>(...)InitInfo commonSet<FieldInfo> fieldsnew HashSet<FieldInfo>(...)MethodNode constrMthInitInfo infonew InitInfo(...)getPutInsns(...)compareInsns(...)InsnNode putInsngetConstrMth(...)InsnNode baseInsnInsnNode otherInsnSet<RegisterArg> regsnew HashSet<RegisterArg>(...)List<MethodNode> listList<InsnNode> assignInsnsFieldInfo putNodeinsnValue(...)// TODO: check not only first block// compare collected instructions// all checks passed// exclude fields from super classes// exclude inherited fields (not declared in this class)import JsonMappingGenremoveInsn(...)// remove 'exception catch' for instruction which don't throw any exceptions// ??boolean respectAccessModifiers, ...;this.respectAccessModifiersisRespectBytecodeAccModifiers(...)int newVisFlagfixClassVisibility(...)fixMethodVisibility(...)AccessInfo newAccFlagsvisibilityName(...)boolean canInline// check if private inner class is used outside// if class is used in inlinable method => make it public// make virtual methods public// make abstract methods public// enum constructor can't be public// TODO: make public if used outside// make other direct methods privateGenericTypesVisitor.classattachGenericTypesInfo(...)new GenericInfoAttr(...)/** Visitor interface for traverse dex tree *//** Called after loading dex tree, but before visitor traversal. *//** Visit class ... *//** Visit method */initCodeVars(...)getSVars(...)resetTypeAndCodeVar(...)RegisterArg thisArginitCodeVar(...)isCodeVarSet(...)AFlag.CUSTOM_DECLAREsetCodeVar(...)List<PhiInsn> phiListgetPhiList(...)Set<SSAVar> varsnew LinkedHashSet<SSAVar>(...)collectConnectedVars(...)setCodeVarType(...)new Consumer<SSAVar>(...) { ... }mergeFlagsFrom(...)List<ArgType> imTypesnew Function<SSAVar,ArgType>(...) { ... }new Predicate<ArgType>(...) { ... }int imCountSSAVar resultVarnew Consumer<InsnArg>(...) { ... }InlineMethods.classprocessInvokeInsn(...)IMethodDetails callMthDetailsreloadAtCodegenStage(...)inlineMethod(...)InsnNode inlCopyIMethodDetails methodDetailsAttrisAssignNeeded(...)makeFakeArg(...)getArgsRegNums(...)List<RegisterArg> inlArgsregNums.lengthRegisterArg rInsnArg replRegisterArg fakeArg// TODO: sort inner classes process order by dependencies!// method not yet loaded => will retry at codegen stage// add fake result to make correct java expression (see test TestGetterInlineNegative)// remap args// replace args// replaceInsn replaces the attributes as well, make sure to preserve METHOD_DETAILSimport ElementTypeimport Retentionimport RetentionPolicyimport Target/** Annotation for describe dependencies of jadx visitors */RetentionPolicy.RUNTIMEElementType.TYPE/** Visitor short name (identifier) *//** Detailed visitor description *//** This visitor must be run <b>after</b> listed visitors *//** This visitor must be run <b>before</b> listed visitors */import FinallyExtractInfoimport InsnsSliceConstInlineVisitor.classisNoExceptionHandlers(...)clearExceptionHandlers(...)ExceptionHandler excHandlerprocessExceptionHandler(...)Exception excInnerboolean noExitNodeInsnNode reThrowInsnBlockNode excBlockgetCleanSuccessors(...)boolean extractedextractFinally(...)/** Search and mark common code from 'try' block and 'handlers'. */List<BlockNode> handlerBlocksBlockNode handlerBlockBlockNode startBlockFinallyExtractInfo extractInfonew FinallyExtractInfo(...)TryCatchBlock tryBlockSet<BlockNode> splitterscollectBlocksDominatedByWithExcHandlers(...)removeHandler(...)ExceptionHandler otherHandlerBlockNode checkBlocksearchDuplicateInsns(...)resetIncomplete(...)getFinallyInsnsSlice(...)getDuplicateSlices(...)SplitterBlockAttr splitterAttrBlockNode splBlockBlockNode splitterBlockNode startSet<BlockNode> checkSetnew LinkedHashSet<BlockNode>(...)checkSlices(...)setFinally(...)InsnsSlice finallySliceList<InsnNode> finallyInsnsListgetInsnsList(...)InsnsSlice dupSliceList<InsnNode> dupInsnsListInsnNode finallyInsnList<InsnNode> insnsListInsnNode dupInsnmarkSlice(...)copyCodeVars(...)boolean allInsnMarkedSSAVar fromSsaVarSSAVar toSsaVargetCheckedBlocks(...)getStartBlock(...)searchFromFirstBlock(...)isStartBlock(...)isComplete(...)checkBlocksTree(...)checkTempSlice(...)/** 'Finally' instructions can start in the middle of the first block. */List<InsnNode> dupInsnsList<InsnNode> finallyInsnsint endPosboolean completeInsnsSlice slicenew InsnsSlice(...)int endIndexcheckInsns(...)setComplete(...)InsnNode startInsnInsnNode remInsnsameInsns(...)List<BlockNode> finallyCSList<BlockNode> dupCSBlockNode finSBlockBlockNode dupSBlockgetAllHandlerBlocks(...)compareBlocks(...)addBlock(...)int dupInsnCountint finallyInsnCountInsnsSlice finallyInsnsSliceaddInsns(...)InsnArg remArgInsnArg fArg// reload method without applying this visitor// TODO: make more common and less hacky// check if handler has exit edge to block not from this handler// remove empty catch// remove 'finally' from 'catch' handlers// remove 'finally' from 'try' blocks (dominated by splitter block)// 'finally' extract confirmed, apply// ignore slice with only one 'if' insn// fast check from end of block// check from block start// search start insn// put instructions into slices// both slices completed// fill dup insns slice// fill finally insns slice// compare slices// TODO: add additional slices checks// and try to extract common part if found difference// TODO: check instance arg in ConstructorInsn// TODO: compare literalsList<BlockNode> blocksMethodInlineAttr inlinedinlineMth(...)inlineNotNeeded(...)addInlineAttr(...)List<RegisterArg> regArgsfixVisibilityOfInlineCode(...)markForInline(...)InvokeNode invokeObject indexObj// synthetic field getter// set arg from 'return' instruction// synthetic field setter or method invoke// TODO: inline field arithmetics. Disabled tests: TestAnonymousClass3a and TestAnonymousClass5// unbind SSA variables from copy instruction// TODO: calculate more precisely// field access must be already fixed in ModVisitor.fixFieldUsage methodimport MutableMethodDetailsSimplifyVisitor.classprocessInsn(...)processUnknown(...)ArgType lastlast(...)processOverloaded(...)ArgType callClsgetCallClassFromInvoke(...)List<IMethodDetails> overloadMethodscollectOverloadedMethods(...)Map<ArgType,ArgType> typeVarsMappinggetTypeVarsMapping(...)IMethodDetails effectiveMthDetailsresolveTypeVars(...)List<IMethodDetails> effectiveOverloadMethodsint argsOffsetList<ArgType> compilerVarTypescollectCompilerVarTypes(...)List<ArgType> castTypessearchCastTypes(...)IMethodDetails overloadMethodapplyArgsCast(...)/** Method details not found => add cast for 'null' args */replaceUnknownTypes(...)InsnArg instanceArgArgType declClsTypeArgType callClsTypegetClsCallType(...)Map<ArgType,ArgType> clsTypeVarsMap<ArgType,ArgType> mthTypeVarsgetTypeVarMappingForInvoke(...)mergeMaps(...)int origPosArgType compilerTypeInsnNode castInsnInsnArg wrapCastAFlag.EXPLICIT_CASTboolean fixedList<ArgType> fixedArgTypesMutableMethodDetails mutableMethodDetailsnew MutableMethodDetails(...)ArgType resolvedTypesetArgTypes(...)setRetType(...)boolean changedisOverloadResolved(...)ArgType mthTypeConsts.DEBUG_OVERLOADED_CASTSList<IMethodDetails> strictMethodsfilterApplicableMethods(...)new Function<TypeCompareEnum,Boolean>(...) { ... }isStrictTypes(...)List<IMethodDetails> resolvedMethodsisTypeApplicable(...)isEqual(...)isNarrowOrEqual(...)TypeCompareEnum.WIDER_BY_GENERICIMethodDetails misMethodAcceptable(...)List<ArgType> mthTypesTypeCompare typeCompareList<ArgType> resultgetCompilerVarType(...)/** Return type as seen by compiler */LiteralArg literalArgInsnWrapArg wrapArg// run before cast remove and StringBuilder replace// parentMth.addComment("JADX DEBUG: got method details: " + mthDetails);// not overloaded// resolve generic type variables// search cast types to resolve overloading// static call// protect already existed cast// type variables erased from method info by compiler// try compile types// replace unknown types// replace generic types// if just one arg => cast will resolve// TODO: try to minimize casts count// not resolved -> cast all args// TODO: search closest method, instead filtering// nullimport AnnotationVisibilityimport static BlockUtils.replaceInsn/** Visitor for modify method instructions ... */doubleToLongBits(...)floatToIntBits(...)long DOUBLE_TO_BITS, ...;long FLOAT_TO_BITS, ...;replaceConstInAnnotations(...)replaceStep(...)removeStep(...)iterativeRemoveStep(...)NewArrayNode newArrInsnInsnNode nextInsngetFirstUseSkipMove(...)processAnonymousConstructor(...)replaceConstKeys(...)FillArrayInsn fillArrInsncheckArrSizes(...)InsnNode filledArrmakeFilledArrayInsn(...)processMoveException(...)processArith(...)removeCheckCast(...)fixPrimitiveCast(...)fixFieldUsage(...)/** If field is not visible from use site => cast to origin class */ArgType instanceTypeInsnArg castArgTypeCompareEnum.NARROW_BY_GENERICisFieldVisibleInMethod(...)ClassNode fieldClsboolean sameScopeTypeCompareEnum.NARROWmodifyKey(...)TernaryInsn ternarymakeBooleanConvertInsn(...)InsnArg zeromake(...)long litValInsnArg oneIfNode ifNodereplaceConstsInAnnotationForAttrNode(...)AnnotationsList annotationsListIAnnotation annotationAnnotationVisibility.SYSTEMEntry<String,EncodedValue> entryMap<>.Entry<String,EncodedValue>setValue(...)replaceConstValue(...)FieldNode constFieldEncodedType.ENCODED_ARRAYList<EncodedValue> listValreplaceAll(...)new UnaryOperator<EncodedValue>(...) { ... }new EncodedValue(...)EncodedType.ENCODED_FIELDArgType tInsnArg litArgInsnNode fGetint dataSizeInsnArg arrSizeArggetConstValueByArg(...)isCastDuplicate(...)isCastNeeded(...)InsnNode moveArgType assignCastType/** Remove unnecessary instructions */isResultArgNotUsed(...)Map<InsnArg,FieldNode> argsMapgetArgsToFieldsMapping(...)Entry<InsnArg,FieldNode> entryMap<>.Entry<InsnArg,FieldNode>Map<InsnArg,FieldNode> mapnew LinkedHashMap<InsnArg,FieldNode>(...)List<RegisterArg> argListgetParentInsnSkipMove(...)ConstructorInsn superConstr/** Return first usage instruction for arg. ... */int useCountArgType insnArrayTypeArgType insnElementTypegetArgType(...)InsnNode moveInsnNamedArg namedArg// replace with filled array if 'fill-array' is next instruction// cast not needed// unknown field// insert cast// package-private or protected// same package// protected// true if use class is subclass of field class// replace boolean to (byte/char/short/long/double/float) cast with ternary// result arg used both in this insn and exception handler,// exception var moved to external variable => replace with 'move' insnmoveInline(...)processMove(...)InsnArg moveArgRegDebugInfoAttr debugInfoInsnArg replaceArg// all checks passed, execute inlineRenameVisitor.classOverrideMethodVisitor.classList<ArgType> superTypescollectSuperTypes(...)processMth(...)MethodOverrideAttr attrprocessOverrideMethods(...)IMethodDetails baseMthfixMethodReturnType(...)fixMethodArgTypes(...)MethodOverrideAttr resultList<IMethodDetails> overrideListArgType superTypesearchOverriddenMethod(...)isMethodVisibleInCls(...)buildOverrideAttr(...)Map<String,ClspMethod> methodsMapEntry<String,ClspMethod> entryMap<>.Entry<String,ClspMethod>String mthShortIdMethodNode supMthList<IMethodDetails> mergedOverrideListmergeLists(...)List<IMethodDetails> cleanOverrideListapplyOverrideAttr(...)boolean dontRenameanyMatch(...)new Predicate<IMethodDetails>(...) { ... }SortedSet<MethodNode> relatedMethodsList<MethodNode> mthNodesgetMethodNodes(...)int depthnew TreeSet<MethodNode>(...)SortedSet<MethodNode> setsetRelatedMthNodes(...)new MethodOverrideAttr(...)listTail(...)IMethodDetails md/** NOTE: Simplified version of method from ModVisitor.isFieldVisibleInMethod */Map<String,ArgType> superTypesnew LinkedHashMap<String,ArgType>(...)addSuperType(...)String superClsupdateReturnType(...)ArgType baseReturnTypeArgType baseClsTypeCompareEnum compareResultArgType targetRetTypereplaceClassGenerics(...)List<ArgType> mthArgTypesList<ArgType> baseArgTypesList<ArgType> newArgTypesArgType newTypeupdateArgType(...)updateArgTypes(...)ArgType baseArgArgType targetArgType// traced to base method// trace stopped at already processed method -> start merging// don't rename method if override list contains not resolved method// merge related methods from all override attributes// use one of already allocated sets// skip current (first) method// package-privateimport InsnContainerimport InsnList/** Prepare instructions for code generation pass, ... */setClassSourceLine(...)removeInstructions(...)checkInline(...)removeParenthesis(...)modifyArith(...)moveConstructorInConstructor(...)Iterator<InsnNode> itisNameEquals(...)List<InsnNode> list/** Remove parenthesis for wrapped insn in arith '+' or '-' ... */ArithNode arithIfCondition c/** Replace arithmetic operation with short form ... */boolean replacesameCodeVar(...)/** Check that 'super' or 'this' call in constructor is a first instruction. ... */searchConstructorCall(...)Region oldRootRegionboolean firstInsnisFirstInsn(...)DeclareVariablesAttr declVarsAttrString callTypeBlockNode blockByInsngetBlockByInsn(...)Region regionnew InsnContainer(...)setRegion(...)Set<RegisterArg> regArgs/** Use source line from top method */int minLineorElse(...)new Function<List<? extends LineAttrNode & ...>,Stream<? extends ? extends LineAttrNode & ...>>(...) { ... }new Predicate<? extends LineAttrNode & ...>(...) { ... }new ToIntFunction<? extends LineAttrNode & ...>(...) { ... }// remove redundant moves: unused result and same args names (a = a;)// replace 'move' with inner wrapped instruction// move not needed// move constructor instruction to new root regionisInlineAnonymousClasses(...)markAnonymousClass(...)isLambdaCls(...)isDigit(...)new Predicate<MethodNode>(...) { ... }countStaticFields(...)import FillArrayDataimport SwitchDataBlockSplitter.classinitJumps(...)insnByOffset.lengthint nextInsnOffsetint dataTargetgetDataTarget(...)InsnNode switchDataInsngetInsnAtOffset(...)FillArrayInsn fillArrayInsnInsnNode arrDataInsnaddJump(...)attachSwitchData(...)mergeMoveResult(...)setArrayData(...)RegisterArg moveResnew JumpInfo(...)// default caseinitClsEnumMap(...)...|=...processNewArray(...)processEnumSwitch(...)/** Replace new-array and sequence of array-put to new filled-array instruction. */Object arrayLenConstRegisterArg arrArgint putIndexList<InsnNode> arrPutsnew Function<RegisterArg,InsnNode>(...) { ... }InsnNode lastPutint replaceIndexcheckPutInsn(...)InsnNode arrPutInsnNode putInsnArg indexArgEnumMapInfo enumMapInfocheckEnumMapAccess(...)FieldNode enumMapFieldgetMapField(...)InsnArg invArgEnumMapAttr.KeyValueMapKeyValueMap valueMapgetEnumMap(...)getKeys(...).lengthObject keyObject newKeycheckAndHideClass(...)MethodNode clsInitMthEnumMapAttr mapAttrnew EnumMapAttr(...)addToEnumMap(...)ClassNode syntheticClassEnumMapInfo mapInfoInsnArg enumArgInsnNode sgetObject indexint literalInsnArg sgetArgInsnNode invInsnnew EnumMapInfo(...)/** If all static final synthetic fields have DONT_GENERATE => hide whole class */FieldNode mapField, ...;this.mapField// check sequential array put with increasing index// check that all puts in current block// checks complete, apply// replace confirmedimport DeobfuscatorDeobfuscator deobfuscatornew Deobfuscator(...)checkClasses(...)savePresets(...)checkClassName(...)checkFields(...)checkMethods(...)isFsCaseSensitive(...)Set<String> clsFullPathsString newShortNamegetClsAlias(...)new RenameReasonAttr(...)processRootPackages(...)fixClsShortName(...)String deobfNameString clsAliascheckPackage(...)String aliasPkgString fullPkgAliasgetPkgAlias(...)Consts.DEFAULT_PACKAGE_NAMEchar firstCharboolean renameValidString cleanClsNameConsts.ANONYMOUS_CLASS_PREFIXboolean notUniqueboolean notValidboolean notPrintableforceRenameField(...)forceRenameMethod(...)Set<String> rootPkgscollectRootPkgs(...)setRootPkgs(...)Set<String> fullPkgsString rootPkggetRootPkg(...)int dotPos// rename failed, use deobfuscator// check inner classes names// Rename methods with same signature/* this flag not set yet */// rename field if collide with any root packageimport PrintWriterSaveCode.classgetFileExtension(...)File outFileprepareFile(...)PrintWriter outnew PrintWriter(...)OutputFormatEnum outputFormatMap<String,FieldFixInfo> fixInfoMap, ...;Map<String,FieldFixInfo> mapnew HashMap<String,FieldFixInfo>(...)Map<FieldInfo,FieldFixType> fieldFixMapsearchShadowedFields(...)FieldFixInfo fixInfonew FieldFixInfo(...)fixInfo.fieldFixMapthis.fixInfoMapfixShadowFieldAccess(...)Map<FieldInfo,FieldFixType> fieldFixMap, ...;new FieldFixType(...)FieldFixType SUPER, ...;FieldFixType CAST, ...;List<FieldNode> allFieldscollectAllInstanceFields(...)Map<String,List<FieldNode>> mapByNamegroupByName(...)Map<FieldInfo,FieldFixType> fixMapnew HashMap<FieldInfo,FieldFixType>(...)new Predicate<Entry<String,List<FieldNode>>>(...) { ... }boolean fromThisClsFieldNode otherFieldFieldFixType.SUPERFieldFixType.CASTMap<String,List<FieldNode>> groupByNamenew HashMap<String,List<FieldNode>>(...)new Function<String,List<FieldNode>>(...) { ... }List<FieldNode> fieldsListClassNode currentClassFieldFixInfo fieldFixInfoFieldFixType fieldFixTypefieldFixInfo.fieldFixMapfixFieldAccess(...)// only one super class contains same field => can use super// several super classes contains same field => can't use super, need cast to exact class// convert 'this' to 'super'// apply castimport SignatureParserimport static Collections.unmodifiableListparseClassSignature(...)parseFieldSignature(...)parseMethodSignature(...)SignatureParser spfromNode(...)consumeGenericTypeParameters(...)validateClsType(...)List<ArgType> interfacesupdateGenericClsData(...)ArgType gTypevalidateParsedType(...)List<ArgType> parsedArgTypesconsumeMethodArgs(...)ArgType parsedRetTypeList<ArgType> checkedArgTypescheckArgTypes(...)List<ArgType> resultArgTypesupdateTypeParameters(...)updateTypes(...)ArrayList<ArgType> newArgTypesArgType parsedTypeArgType mthArgTypeTypeCompareEnum.CONFLICT// apply before expand args// ignore for enums// add synthetic arg for outer class (see test TestGeneric8)MethodInfo stringGetBytesMth, ...;simplifyBlock(...)int insnCountInsnNode modInsnsimplifyInsn(...)unbindInsn(...)simplifyArgs(...)simplifyArith(...)simplifyIf(...)simplifyTernary(...)convertInvoke(...)convertFieldArith(...)processCast(...)simplifyStringConstructor(...)InsnNode arrInsngetElemType(...)int printablebyte[] arrInsnNode constStrInvokeNode inInsnArg bytesArgArgType castToType/** Simplify 'cmp' instruction in if condition */InsnArg fInsnNode wi/** Simplify condition in ternary operation */simplifyCondition(...)/** Simplify chains of calls to StringBuilder#append() plus constructor of StringBuilder. ... */Consts.CLASS_STRING_BUILDERConsts.MTH_TOSTRING_SIGNATUREList<InsnNode> callChainflattenInsnChainUntil(...)convertStringBuilderChain(...)List<InsnNode> useChaincollectUseChain(...)int toStrIdxBlockNode assignBlockList<InsnNode> blockInsnsint assignIdxint chainSizeint lastInsnList<InsnArg> argsInsnNode firstInsnboolean stringArgFoundList<InsnArg> dupArgsnew Function<InsnArg,InsnArg>(...) { ... }List<InsnArg> simplifiedArgsconcatConstArgs(...)InsnNode concatInsnInsnType.STR_CONCATInsnNode chainInsngetArgFromAppend(...)removeStringBuilderInsns(...)checkResult(...)boolean prevConstboolean curConstList<InsnArg> newArgsList<String> concatListisConstConcatNeeded(...)String constStrgetConcatArg(...)concatStrings(...)literalToRawString(...)/* String concat without assign to variable will cause compilation error *//** Remove and unbind all instructions with StringBuilder */InsnRemover insnRemoverunbindAllArgs(...)List<InsnNode> chainInsnNode wr/** Convert field arith operation to arith instruction ... */InsnNode wrapInsnType wrapTypeInsnArg getWrapInsnNode getInsnType getTypeFieldInfo innerFieldInsnNode concatInsnArg regInsnArg putRegArithNode aroneArgOp(...)// some insns removed => restart block processing// Don't removes CHECK_CAST for wrapped INVOKE if invoked method returns different type// Convert 'new StringBuilder(xxx).append(yyy).append(zzz).toString() to STRING_CONCAT insn// Convert 'StringBuilder sb = new StringBuilder(xxx); sb.append(yyy); String str = sb.toString();'// all insns must be in one block and sequential// all check passed// found 2 consecutive constants// fix 'c + (-1)' => 'c - (1)'import AbstractVisitormarkExceptionHandlers(...)updateCleanSuccessors(...)processExceptionHandlers(...)processTryCatchBlocks(...)/** Set exception handler attribute for whole block */ExcHandlerAttr handlerAttrInsnNode meBlockNode nodecollectBlocksDominatedBy(...)onlyAllHandler(...)TryCatchBlock handlerBlockmerge(...)/** If all instructions in block have same 'catch' attribute mark it as 'TryCatch' block. */CatchAttr commonCatchAttr// set correct type for 'move-exception' operation// handler arguments not used// remove 'monitor-exit' from exception handler blocks// if 'throw' in exception handler block have 'catch' - merge these catch blocksfixSplitterBlock(...)finishBasicBlocks(...)/** For every exception handler must be only one splitter block, ... */Map<BlockNode,SplitterBlockAttr> splittersnew HashMap<BlockNode,SplitterBlockAttr>(...)BlockNode topSplittergetTopBlock(...)BlockNode predskipSyntheticPredecessor(...)Entry<BlockNode,SplitterBlockAttr> entryMap<>.Entry<BlockNode,SplitterBlockAttr>import static BlockSplitter.connectimport static EmptyBitSet.EMPTYBlockProcessor.classprocessBlocksTree(...)removeMarkedBlocks(...)clearBlocksState(...)computeDominators(...)independentBlockTreeMod(...)updateExitBlocks(...)modifyBlocksTree(...)checkForUnreachableBlocks(...)computeDominanceFrontier(...)registerLoops(...)processNestedLoops(...)AFlag.LOOP_STARTList<BlockNode> predecessorsint predsCountint sameInsnCountgetSameLastInsnCount(...)getLastInsns(...)insertAtStart(...)List<InsnNode> newInsnListInsnNode curInsngetInsnsFromEnd(...)isInsnsEquals(...)sameArgs(...)List<BlockNode> basicBlocksint nBlocksBlockNode entryBlocksetDoms(...)calcDominators(...)markLoops(...)calcImmediateDominators(...)BitSet domSetBitSet dor(...)and(...)BlockNode idomList<BlockNode> predsBitSet bsnextSetBit(...)andNot(...)setIDom(...)addDominatesOn(...)List<BlockNode> domSortedBlocksDeque<BlockNode> stacknew LinkedList<BlockNode>(...)BlockNode exitsetDomFrontier(...)BlockNode dominatedcomputeBlockDF(...)BitSet domFrontierBitSet frontierint pboolean noSuccessorsboolean exitBlockaddExitBlock(...)new LoopInfo(...)new Consumer<LoopInfo>(...) { ... }registerLoop(...)getLoopsCount(...)LoopInfo outLoopgetLoops(...)LoopInfo innerLoopLoopInfo parentLoopgetParentLoop(...)setParentLoop(...)mergeExceptionHandlers(...)checkLoops(...)mergeConstReturn(...)splitReturnBlocks(...)BlockNode exitBlockRegisterArg constArgInsnArg retArgsameReg(...)mergeConstAndReturnBlocks(...)cleanExitNodes(...)removeConnection(...)BlockNode basicBlockdeduplicateBlockInsns(...)removeEmptyBlock(...)removeEmptyDetachedBlocks(...)int loopsCountsplitLoops(...)insertPreHeader(...)insertBlockForProdecessors(...)insertBlocksForBreak(...)insertBlocksForContinue(...)/** Insert simple path block before loop header */BlockNode preHeaderstartNewBlock(...)BlockNode newEnterBlockAFlag.MTH_ENTER_BLOCKsetEnterBlock(...)connect(...)replaceConnection(...)/** Insert additional blocks for possible 'break' insertion */boolean changegetExitEdges(...)BlockNode targetBlockNode sourcegetSource(...)insertBlockBetween(...)/** Insert additional blocks for possible 'continue' insertion */BlockNode loopEndgetEnd(...)/** Insert additional block if loop header has several predecessors (exclude back edges) */BlockNode loopHeaderBlockNode firstnew Predicate<BlockNode>(...) { ... }boolean oneHeaderBlockNode newLoopEndLoopInfo la/** Merge handlers for multi-exception catch */List<BlockNode> blocksForMergecollectExcHandlerBlocks(...)mergeHandlers(...)getMoveExceptionRegister(...)BlockNode nextBlockBlockNode predBlockcheckOtherExcHandler(...)ExcHandlerAttr otherExcHandlerAttrTryCatchBlock otherTryBlockRegisterArg otherRegaddCatchTypes(...)detachBlock(...)splitReturn(...)/** Splice return block if several predecessors presents */AFlag.ORIG_RETURNfilterPredecessors(...)isReturnArgAssignInPred(...)BlockNode newRetBlockInsnNode oldInsncopyWithoutSsa(...)Iterator<BlockNode> iteratorremoveBlock(...)// revert calculations// recalculate dominators tree// search for same instruction at end of all predecessors blocks// TODO: implement insn extraction into separate block for partial predecessors// clear self dominance// Every successor that dominates its predecessor is a header of a loop,// block -> successor is a back edge.// don't count back edge// multiple predecessors// several back edges connected to one loop header => make additional blockimport TargetInsnNodeSet<InsnType> SEPARATE_INSNS, ...;// leave these instructions alone in block nodecheckInstructions(...)initBasicBlocks(...)splitBasicBlocks(...)initBlocksInTargetNodes(...)removeJumpAttr(...)removeInsns(...)removeUnreachableBlocks(...)unloadInsnArr(...)/** Init 'then' and 'else' blocks for 'if' instruction. */initBlocks(...)Map<Integer,BlockNode> blocksMapnew HashMap<Integer,BlockNode>(...)BlockNode curBlockboolean startNewisSeparate(...)BlockNode newBlockisDoWhile(...)isSplitByJump(...)connectNewBlock(...)insertSplitterBlock(...)setupConnections(...)/** Make separate block for exception handler. New block already added if MOVE_EXCEPTION insn exists. ... */BlockNode excHandlerBlocksetHandlerBlock(...)/** For try/catch make empty (splitter) block for connect handlers */new SplitterBlockAttr(...)new BlockNode(...)replaceTarget(...)replaceTargetBlock(...)BlockNode srcBlockBlockNode thisBlockconnectExceptionHandlers(...)CatchAttr catchesSplitterBlockAttr splboolean tryEndinitHandlerBlock(...)BlockNode blockByOffsetList<JumpInfo> pJumpsList<JumpInfo> cJumpsIfNode ifsBlockNode targetBlockSet<BlockNode> toRemovelong notEmptyBlockscollectSuccessors(...)int insnsCountnew ToIntFunction<BlockNode>(...) { ... }canRemoveBlock(...)new ArrayDeque<BlockNode>(...)// split into blocks// setup missing connections// add this insn in new block// skip self loop in handler// split 'do-while' block (last instruction: 'if', target this block)new ArrayList<InsnsSlice>(...)ExceptionHandler finallyHandler, ...;List<BlockNode> allHandlerBlocks, ...;List<InsnsSlice> duplicateSlices, ...;Set<BlockNode> checkedBlocks, ...;InsnsSlice finallyInsnsSlice, ...;BlockNode startBlock, ...;this.finallyHandlerthis.startBlockthis.allHandlerBlocksnew IdentityHashMap<InsnNode,BlockNode>(...)List<InsnNode> insnsList, ...;Map<InsnNode,BlockNode> insnMap, ...;boolean complete, ...;Set<BlockNode> setthis.completenew Function<InsnNode,String>(...) { ... }import JadxVisitorimport TypeUpdateResultDebugInfoApplyVisitor.classapplyDebugInfo(...)checkTypes(...)formatMsg(...)getDetailedVarInfo(...)collectVarDebugInfo(...)fixLinesForReturn(...)fixNamesForPhiInsns(...)Set<RegDebugInfoAttr> debugInfoSetnew HashSet<RegDebugInfoAttr>(...)int dbgCountaddRegDbdInfo(...)new Consumer<RegisterArg>(...) { ... }searchDebugInfoByOffset(...)LocalVarsDebugInfoAttr debugInfoAttrOptional<Integer> maxnew Function<RegisterArg,Integer>(...) { ... }getInsnOffsetByArg(...)new Comparator<Integer>(...) { ... }int startOffsetint endOffsetILocalVar localVargetLocalVars(...)int startAddrint endAddrgetEndOffset(...)isInside(...)getVarType(...)TypeUpdateResult resultapplyWithWiderAllow(...)TypeUpdateResult.REJECT/** Fix debug info for splitter 'return' instructions */InsnNode origReturnList<InsnNode> newReturnsInsnNode retInsnArg newArgRegisterArg oldArgRegRegisterArg newArgReggetUsedInPhi(...)addArgName(...)setNameForInsn(...)DebugInfoAttachVisitor.classIDebugInfo debugInfoprocessDebugInfo(...)attachSourceLines(...)getSourceLineMapping(...)attachDebugInfo(...)setMethodSourceLine(...)Integer sourceLineILocalVar varnew RegDebugInfoAttr(...)new LocalVarsDebugInfoAttr(...)String signcheckSignature(...)boolean applyArgType el/** Set method source line from first instruction */// attach to method argumentsList<ArgType> typeParams, ...;List<ArgType> throwTypes, ...;boolean varArg, ...;this.typeParamsthis.throwTypesthis.varArgimport InsnGenCheckRegions.classSet<BlockNode> blocksInRegionstraverse(...)new (...)new AbstractRegionVisitor(...) { ... }AFlag.ADDED_TO_REGIONString blockCodegetBlockInsnStr(...)MethodGen mgInsnGen ig// check if all blocks included in regions// check loop conditionsnew RemoveRegionVisitor(...)IRegionVisitor REMOVE_REGION_VISITOR, ...;new Predicate<IContainer>(...) { ... }canRemoveRegion(...)IContainer subBlockint ITERATIVE_LIMIT_MULTIPLIER, ...;traverseInternal(...)boolean repeattraverseIterativeStepInternal(...)IRegion regionenterRegion(...)new Consumer<IContainer>(...) { ... }leaveRegion(...)visitRegion(...)IContainer subContStackOverflowError overflow/** If return 'true' traversal will be restarted. */import IfInfoimport static RegionMaker.isEqualPathsimport static RegionMaker.isEqualReturnBlocksimport static BlockUtils.getNextBlockimport static BlockUtils.isPathExistsIfMakerHelper.classIfInfo nextmergeNestedIfNodes(...)BlockNode thenBlockBlockNode elseBlockboolean badThenisBadBranchBlock(...)boolean badElseIfInfo ifInfosetOutBlock(...)List<BlockNode> thenSCList<BlockNode> elseSCsameElements(...)getPathCross(...)getOutBlock(...)BlockNode disPathExists(...)isBackEdge(...)List<LoopInfo> startLoopsList<LoopInfo> endLoopsLoopInfo startLoopLoopInfo endLoopallPathsFromIf(...)Set<BlockNode> ifBlocksBlockNode curThenBlockNode curElseboolean followThenBranchIfInfo nextIfgetNextIf(...)boolean assignInlineNeededboolean thenPathSameisEqualPaths(...)boolean elsePathSameIfInfo resultmergeIfInfo(...)isFollowBackEdge(...)BlockNode mergedBlockisInversionNeeded(...)BlockNode otherBranchBlockcheckConditionBranches(...)skipSyntheticSuccessor(...)checkForTernaryInCondition(...)canMerge(...)boolean sameOutsresetForceInlineInsns(...)searchNestedIf(...)IfInfo nextThenIfInfo nextElsemergeTernaryConditions(...)IfCondition newConditionconfirmMerge(...)Mode mergeOperationBlockNode otherPathBlockgetCrossBlock(...)skipSimplePath(...)BlockNode firstSkipBlockNode secondSkipisSameBlocks(...)isEqualReturnBlocks(...)InsnNode forceInlineInsncanSelectNext(...)getNextIfNodeInfo(...)boolean passList<InsnNode> forceInlineInsnsIfInfo nextInfomakeIfInfo(...)InsnNode usePlaceblockContains(...)getNextBlock(...)// select 'then', 'else' and 'exit' blocks// check if block at end of loop edge// search for same loop// don't inline assigns into loop condition// invert current node for match pattern// complex condition, run additional checks// this is nested conditions with different mode (i.e (a && b) || c),// search next condition for merge, get null if failed// don't inline assigns inside simple condition// search next nested if block// skip synthetic successor if both parts leads to same block// skip this block and search in successors chain// check that all instructions can be inlined// TODO?import static RegionUtils.insnsCountnew TernaryMod(...)new ProcessIfRegionVisitor(...)new RemoveRedundantElseVisitor(...)TernaryMod TERNARY_VISITOR, ...;ProcessIfRegionVisitor PROCESS_IF_REGION_VISITOR, ...;RemoveRedundantElseVisitor REMOVE_REDUNDANT_ELSE_VISITOR, ...;traverseIterative(...)IfRegion ifRegionsimplifyIfCondition(...)moveReturnToThenBlock(...)moveBreakToThenBlock(...)markElseIfChains(...)removeRedundantElseBlock(...)IContainer elseRegionboolean thenIsEmptyinvertIfRegion(...)hasSimpleReturnBlock(...)isIfRegion(...)hasBreakInsn(...)/** Mark if-else-if chains */IContainer elsRegionIRegion parentRegion newRegionhasExitBlock(...)insnsCount(...)replaceSubBlock(...)setElseRegion(...)// move 'if' from then to make 'else if' chain/* && insnsCount(ifRegion.getThenRegion()) < 2 */// code style check:// will remove 'return;' from 'then' and 'else' with one instruction// see #jadx.tests.integration.conditions.TestConditions9LoopRegionVisitor.classAFlag.REQUEST_IF_REGION_OPTIMIZEprocessLoopRegion(...)checkForIndexedLoop(...)checkIterableForEach(...)/** Check for indexed loop. */BlockNode loopEndBlockInsnNode incrInsnRegisterArg incrArgList<PhiInsn> phiInsnListList<RegisterArg> condArgsRegisterArg initArgInsnNode initInsnLoopType arrForEachcheckArrayForEach(...)usedOnlyInLoop(...)RegisterArg iArgassignOnlyInLoop(...)StackOverflowError errornew ForLoop(...)ArithNode arithNodeInsnArg litInsnArg condArgRegisterArg arrIndexInsnNode arrGetInsnCompare compareInsnNode lenInsnArg bCondArgInsnArg arrayArgRegisterArg iterVarnew ForEachLoop(...)containsWrappedInsn(...)InsnArg wrapArgsearchWrappedInsnParent(...)injectFakeInsns(...)dontGenerateIfNotUsed(...)RegisterArg iteratorArgList<RegisterArg> itUseListInsnArg iterableArgInsnNode hasNextCallInsnNode nextCallList<InsnNode> toSkipnew LinkedList<InsnNode>(...)checkInvoke(...)isRegionContainsBlock(...)fixIterableType(...)RegisterArg itArgArgType iterableTypeArgType immutableType/** Check if instruction is a interface invoke with corresponding parameters. */argInLoop(...)InsnArg phiArg// optimize `if` block after instructions remove// can't make loop if argument from increment instruction is assign in loop// array for each loop confirmed// cast not inlined// can't change type// allow to iterate over not generified collection only for Object vars/** Extract blocks to separate try/catch region */Map<BlockNode,TryCatchBlock> tryBlocksMapnew HashMap<BlockNode,TryCatchBlock>(...)IRegionIterativeVisitor visitornew IRegionIterativeVisitor(...) { ... }checkAndWrap(...)searchTryCatchDominators(...)traverseIncludingExcHandlers(...)Set<TryCatchBlock> tryBlocksnew HashSet<TryCatchBlock>(...)CatchAttr cTryCatchBlock tbprocessTryCatchBlock(...)List<BlockNode> domBlocksBlockNode domBlockTryCatchBlock prevTBEntry<BlockNode,TryCatchBlock> entryMap<>.Entry<BlockNode,TryCatchBlock>BlockNode dominatorwrapBlocks(...)/** Extract all block dominated by 'dominator' to separate region and mark as try/catch block */Region tryRegionTryCatchRegion tryCatchRegionnew TryCatchRegion(...)IContainer firstNodeLoopRegion loopIContainer conthasPathThroughBlock(...)isHandlerPath(...)setTryCatchBlock(...)getCatchAttr(...)AbstractRegion aReg// collect all try/catch blocks// for each try block search nearest dominator block// mth.addWarn("No exception handlers in catch block: " + tb);// search dominator blocks in this region (don't need to go deeper)// replace first node by region// fix parents for tryRegion sub blocksimport static IfMakerHelper.confirmMergeimport static IfMakerHelper.makeIfInfoimport static IfMakerHelper.mergeNestedIfNodesimport static IfMakerHelper.searchNestedIfimport static BlockUtils.skipSyntheticSuccessorRegionMaker.classint regionsLimit, ...;BitSet processedBlocks, ...;int regionsCount, ...;int blocksCountthis.processedBlocksthis.regionsLimitRegion rpeekRegion(...)int startBlockIdcontainsExit(...)insertEdgeInsns(...)List<EdgeInsnAttr> edgeInsnsaddOneInsnOfType(...)InsnType.BREAKInsnType.CONTINUEEdgeInsnAttr edgeInsn/** Recursively traverse all blocks from 'block' until block from 'exits' */boolean processedint loopCountprocessLoop(...)processIf(...)processSwitch(...)processMonitorEnter(...)BlockNode loopStartSet<BlockNode> exitBlocksSetgetExitNodes(...)List<BlockNode> exitBlocksBlockNode nextStartLoopRegion loopRegionmakeLoopRegion(...)IRegion outerRegionIfInfo condInfoBlockNode outmakeEndlessLoop(...)insertContinue(...)setCondition(...)BlockNode loopExitEdge exitEdgeinsertLoopBreak(...)Region bodyaddExit(...)setBody(...)BlockNode loopBodyBlockNode conditionBlock/** Select loop exit and construct LoopRegion */new LoopRegion(...)isEmptySimplePath(...)setPreCondition(...)checkPreCondition(...)getAllLoopsForBlock(...)boolean allOuterBlockNode outerBlockList<LoopInfo> outLoopListcheckLoopExits(...)List<Edge> exitEdgesOptional<Edge> mainEdgeOptnew Predicate<Edge>(...) { ... }Edge mainExitEdgeBlockNode mainOutBlockBlockNode outBlockBlockNode crossBlockinExceptionHandlerBlocks(...)getExceptionHandlersCount(...)List<BlockNode> simplePathbuildSimplePath(...)Set<BlockNode> pathscheckLastInsnType(...)BlockNode lastBlockBlockNode insertBlockboolean confirmInsnNode breakInsnList<BlockNode> cscanInsertBreak(...)addEdgeInsn(...)addBreakLabel(...)List<LoopInfo> exitLoopList<LoopInfo> inLoopsnew LoopLabelAttr(...)Set<BlockNode> loopExitNodescanInsertContinue(...)InsnNode contBlockNode codePredboolean gotoExitisDominator(...)isDominatedOnBlocks(...)SynchronizedRegion synchRegionnew SynchronizedRegion(...)Set<BlockNode> exitsSet<BlockNode> cacheSetBlockNode bodytraverseMonitorExits(...)InsnNode exitInsngetExitInsns(...)BlockNode insnBlocktraverseMonitorExitsCross(...)/** Traverse from monitor-enter thru successors and collect blocks contains monitor-exit *//** Traverse from monitor-enter thru successors and search for exit paths cross */boolean crossboolean pBlockNode resIfInfo currentIfIfInfo mergedIfIfInfo modifiedIfrestructureIf(...)new IfRegion(...)setConditionBlocks(...)setThenRegion(...)List<EdgeInsnAttr> edgeInsnAttrsRegion elseRegionboolean fromThisIfBlockNode ifBlockgetTargets(...).lengthMap<BlockNode,List<Object>> blocksMapnew LinkedHashMap<BlockNode,List<Object>>(...)BlockNode[] targetBlocksArrgetTargetBlocks(...)BlockNode defCasegetDefTargetBlock(...)getLoopForBlock(...)SwitchRegion swnew SwitchRegion(...)Map<BlockNode,BlockNode> fallThroughCasesnew LinkedHashMap<BlockNode,BlockNode>(...)new Function<BlockNode,List<Object>>(...) { ... }new ArrayList<Object>(...)calcPostDomOut(...)insertContinueInSwitch(...)BitSet caseBlocksblocksToBitSet(...)BlockNode fallThroughBlocksearchFallThroughCase(...)isBadCasesOrder(...)Map<BlockNode,List<Object>> newBlocksMapreOrderSwitchCases(...)Entry<BlockNode,List<Object>> entryList<Object> keysListBlockNode caseBlockaddCase(...)Region caseRegionremoveExit(...)AFlag.FALL_THROUGHremoveEmptyCases(...)BitSet dfSet<BlockNode> allPathsBlocksMap<BlockNode,BitSet> bitSetMapcalcPartialPostDominance(...)BitSet pdomsintersects(...)getOneIntersectionBlock(...)BitSet caseExitscopyBlocksBitSet(...)bitSetToOneBlock(...)BitSet outscalcImmediatePostDominator(...)BitSet ipdomsnewBlocksBitSet(...)isAnyPathExists(...)Set<BlockNode> pathBlocksBlockNode ipdomcalcPartialImmediatePostDominator(...)/** Remove empty case blocks: ... */boolean defaultCaseIsEmptynew Predicate<CaseInfo>(...) { ... }isPacked(...)BlockNode nextCaseBlocknew Comparator<BlockNode>(...) { ... }BlockNode nextABlockNode keyint endIdBlockNode pSet<TryCatchBlock> tcsTryCatchBlock tcBlockNode handlerList<BlockNode> sBlockNode ssBlockNode crossprocessExcHandler(...)processHandlersOutBlocks(...)/** Search handlers successor blocks not included in any region. */Set<IBlock> allRegionBlocksSet<IBlock> succBlocksRegion excOutRegionIBlock lastBlockgetLastBlock(...)IBlock blocknew RegionStack(...)RegionStack stackList<BlockNode> handlerExitsboolean inLoopaddExits(...)setHandlerRegion(...)isSyntheticPath(...)BlockNode n1BlockNode n2List<InsnNode> b1InsnsList<InsnNode> b2InsnsInsnNode i1InsnNode i2isReturnBlock(...)// set exit blocks scan order priority// this can help if loop have several exits (after using 'break' or 'return' in loop)// invert loop condition if 'then' points to exit// add 'break' instruction before path cross between main loop exit and sub-exit// exit to already processed outer loop// empty loop body// add blocks from loop start to first condition block// skip nested loop condition// if we can't merge pre-condition this is not correct header// bad condition if successors going out of all loops// goes to outer loop// no exit found => endless loop// all exit paths must be same or don't cross (will be inside loop)// insert 'break' for exits// check if there no outer switch (TODO: very expensive check)// process special cases// try/catch at loop end// found cross// add label to 'break' if needed// search for parent loop// remove arg from MONITOR_EXIT to allow inline in MONITOR_ENTER// don't add exit blocks which leads to method end blocks ('return', 'throw', etc)// we can still try using this as an exit block to make sure it's visited.// block already included in other 'if' region// invert simple condition (compiler often do it)// all attempts failed// insert edge insns in new 'else' branch// TODO: make more common algorithm// map case blocks to keys// search 'out' block - 'next' block after whole switch statement// in exits or last insn in loop => no 'out' block// treat 'continue' as exit// no 'continue'// no other outs instead back edge to loop start// out block already processed, prevent endless loop// detect fallthrough cases// check fallthrough cases order// 'break' instruction will be inserted in RegionMakerVisitor.PostRegionVisitor// simple case: for only one exit which is equal to method exit block// fast search: union of blocks dominance frontier// work if no fallthrough cases and no returns inside switch// slow search: calculate partial post-dominance for every exit node// search predecessor of loop end on path from this successor/** Pack blocks into regions for code generation */RegionMakerVisitor.classnew PostRegionVisitor(...)IRegionVisitor POST_REGION_VISITOR, ...;RegionMaker rmnew RegionMaker(...)RegionStack stateIRegion expOutBlockpostProcessRegions(...)processForceInlineInsns(...)removeSynchronized(...)boolean needShrinknew Function<BlockNode,Stream<? extends InsnNode>>(...) { ... }mergePreCondition(...)insertEdgeInsn(...)/** Insert insn block from edge insn attribute. */IContainer lastEdgeInsnAttr insnAttrgetBranches(...)Set<IBlock> blocksaddBreakToContainer(...)addBreakForBlock(...)hasExitEdge(...)addBreak(...)IContainer blockContainergetBlockContainer(...)Region startRegionInsnNode synchInsnInsnNode exit// fill region structure// make try-catch regions// merge conditions in loops// insert 'break' in switch cases (run after try/catch insertion)// replace synchronized block with inner region// remove 'monitor-enter' instruction// remove 'monitor-exit' instruction// run region cleaner again// assume that CodeShrinker will be run after thisRegionStack.classint REGIONS_STACK_LIMIT, ...;Set<BlockNode> exits, ...;IRegion region, ...;this.exitsc.exitsnew State(...)Deque<State> stack, ...;State curState, ...;this.stacknew ArrayDeque<State>(...)this.curStatecopyWith(...)/** Add boundary(exit) node for current stack frame ... */curState.exitscurState.regionimport ListIterator/** Remove unnecessary return instructions for void methods */new ReturnRemoverVisitor(...)BlockNode.classnoTrailInstructions(...)blockNotInLoop(...)LoopRegion.class/** Check that there are no code after this block in regions structure */IContainer curContainerListIterator<IContainer> itSubBlocklistIterator(...)hasPrevious(...)previous(...)/** Check if container not contains instructions, ... */IContainer block// remove useless returns in void methods// ignore paths on other branches/** Convert 'if' to ternary operation */makeTernaryInsn(...)IContainer thenRegionBlockNode tbgetTernaryInsnBlock(...)BlockNode ebBlockNode headerInsnNode thenInsnInsnNode elseInsnRegisterArg thenResArgRegisterArg elseResArgprocessOneBranchTernary(...)checkLineStats(...)containsTernary(...)PhiInsn thenPhigetOnlyOneUseInPhi(...)PhiInsn elsePhiInsnArg thenArgInsnArg elseArgTernaryInsn ternInsnclearConditionBlocks(...)InsnNode retInsnIContainer container/** Return 'true' if there are several args with same source lines */PhiInsn tPhiPhiInsn ePhiMap<Integer,Integer> mapnew HashMap<Integer,Integer>(...)new BiFunction<Integer,Integer,Integer>(...) { ... }/** Convert one variable change with only 'then' branch: ... */replaceWithTernary(...)RegisterArg otherArg// force ternary conversion to inline all code in 'super' or 'this' calls// sometimes source lines incorrect// no debug info// don't make nested ternary by default// TODO: add addition checks// remove 'if' instruction// shrink method again// one arg is literalnew ArrayDeque<IRegion>(...)Deque<IRegion> regionStack, ...;IRegion curRegionpeek(...)processBlockTraced(...)import TracedRegionVisitornew LinkedHashMap<SSAVar,VarUsage>(...)List<RegisterArg> args, ...;Map<SSAVar,VarUsage> usageMap, ...;UsePlace usePlacenew UsePlace(...)regionProcess(...)LoopType loopTypeVarUsage usagegetUsage(...)getAssigns(...)getUses(...)new Function<SSAVar,VarUsage>(...) { ... }new VarUsage(...)// result// argsimport AbstractRegionVisitorimport DepthRegionTraversalList<CodeVar> codeVarscollectCodeVars(...)CollectUsageRegionVisitor usageCollectornew CollectUsageRegionVisitor(...)Map<SSAVar,VarUsage> ssaUsageMapgetUsageMap(...)Map<CodeVar,List<VarUsage>> codeVarUsagemergeUsageMaps(...)removeUnusedResults(...)checkCodeVars(...)Entry<CodeVar,List<VarUsage>> entrycanRemoveResult(...)removeSVar(...)int unknownTypesCountArgType codeVarTypeArgType ssaTypeTypeCompare comparatorVarUsage mergedUsageVarUsage varUsagecheckDeclareAtAssign(...)declareVarInRegion(...)Map<CodeVar,List<SSAVar>> codeVarsnew LinkedHashMap<CodeVar,List<SSAVar>>(...)List<SSAVar> listnew Function<CodeVar,List<SSAVar>>(...) { ... }Entry<CodeVar,List<SSAVar>> entryCodeVar localCodeVarnew LinkedHashMap<CodeVar,List<VarUsage>>(...)List<VarUsage> listnew ArrayList<VarUsage>(...)VarUsage uUsePlace assigncanDeclareAt(...)getVar(...)UsePlace useisRegionContainsRegion(...)isAllUseAfter(...)/** Check if all {@code usePlaces} are after {@code checkPlace} */Set<UsePlace> toChecknew HashSet<UsePlace>(...)boolean blockFoundnew Predicate<UsePlace>(...) { ... }isContainerContainsUsePlace(...)DeclareVariablesAttr dvnew DeclareVariablesAttr(...)addVar(...)// TODO: reduce code vars by name if debug info applied (need checks for variable scopes)// collect all variables usage// check if variable can be declared at one of assigns// TODO: search closest region for declare// region not found, declare at method start// workaround for declare variables used in several loops// can't declare in else-if chain between 'else' and next 'if'// TODO: make index for faster checkIBlock block, ...;usePlace.regionusePlace.blocknew ArrayList<UsePlace>(...)SSAVar var, ...;List<UsePlace> assigns, ...;List<UsePlace> uses, ...;this.varList<ArgsInfo> argsList, ...;int inlineBorder, ...;ArgsInfo inlinedInsn, ...;this.argsListthis.posthis.inlineBorderaddArgs(...)canMove(...)inline(...)ArgsInfo startInfoList<RegisterArg> movedArgsBitSet movedSetboolean canReorderstartInfo.insnArgsInfo argsInfoargsInfo.insngetInlinedInsn(...)usedArgAssign(...)argsInfo.inlinedInsnnew WrapInfo(...)ArgsInfo parentinlinedInsn.pos// previous instruction or on edge of inline bordershrinkBlock(...)simplifyMoveInsns(...)InsnList insnListnew InsnList(...)List<ArgsInfo> argsListnew ArrayList<ArgsInfo>(...)List<WrapInfo> wrapListnew ArrayList<WrapInfo>(...)new ArgsInfo(...)ListIterator<RegisterArg> itWrapInfo wrapInfoboolean assignInlineint assignPosgetVariableUseCount(...)canMoveBetweenBlocks(...)assignInline(...)InsnArg wrappedArgList<RegisterArg> argsListBitSet argsboolean startCheckSet<BlockNode> pathsBlocksisBlocksInSameRegion(...)// allow inline only one use arg// another block// just move instruction into arg, don't unbind/copy/duplicate// allow move inside same synchronized region// don't move from synchronized block// skip checks for not generated blocks// replace 'move' with wrapped insnRegisterArg arg, ...;LiveVarAnalysis.class...[] uses, ...;...[] defs, ...;...[] liveIn, ...;...[] assignBlocks, ...;int bbCountthis.usesinitBitSetArray(...)this.defsthis.assignBlocksfillBasicBlockInfo(...)processLiveInfo(...)liveIn.lengthisLive(...)int blockIdBitSet genBitSet killBitSet[] liveInBlocksint iterationsLimitBitSet prevInBitSet newInthis.liveInBitSet[] arraynew BitSet[]...[] vars, ...;...[] versions, ...;RenameState statenew RenameState(...)new SSAVar[]startVar(...)state.mthcopyOf(...)state.versionsstate.varsstate.vars.lengththis.varsthis.versionsBlockFinish.classLiveVarAnalysis lanew LiveVarAnalysis(...)boolean repeatFixrunAnalysis(...)placePhi(...)renameVariables(...)fixLastAssignInTry(...)removeBlockerInsns(...)markThisArgs(...)fixUselessPhi(...)hidePhiInsns(...)BitSet hasPhiBitSet processedDeque<BlockNode> workListBitSet assignBlocksgetAssignBlocks(...)int idBlockNode dfaddPhi(...)PhiListAttr phiListnew PhiListAttr(...)RenameState initStateDeque<RenameState> stacknew LinkedList<RenameState>(...)initPhiInEnterBlock(...)renameVarsInBlock(...)copyFrom(...)bindPhiArg(...)/** Fix last try/catch assign instruction */PhiInsn phifixPhiInTryCatch(...)boolean removedList<PhiInsn> insnToRemoveIterator<PhiInsn> itfixPhiWithSameArgs(...)removePhiList(...)boolean allSameisSameArgs(...)replacePhiWithMove(...)removeUsedInPhi(...)int phiIndexSSAVar assignSSAVar argVarinlinePhiInsn(...)InsnNode mSSAVar resVarmarkOneArgAsThis(...)/* TODO: fix registers removing */// check if args must be removed// phi result not used// try inline// replace SSAVar in 'useArg' to SSAVar from 'arg'// no need to replace whole RegisterArg// don't inline into exception handler// mark all moved 'this'List<SSAVar> relatedVars, ...;this.relatedVarscollectRelatedVars(...)new Function<SSAVar,String>(...) { ... }new BoundEnum(...)BoundEnum ASSIGN, ...;BoundEnum USE, ...;/** Information to restrict types by applying constraints (or boundaries) *//** 'Dynamic' type bound allows to use requested and not yet applied types ... *//** This method will be executed instead of {@link ITypeBound#getType()} ... *//** Listener function - triggered on type update ... *//** Allow to ignore down casts (return arg type instead cast type) ... */IndexInsnNode insn, ...;BoundEnum.ASSIGNBoundEnum bound, ...;TypeBoundConst thatthat.bound/** Special dynamic bound for invoke with generics. ... */InvokeNode invokeNode, ...;ArgType genericReturnType, ...;this.invokeNodethis.genericReturnTypeArgType resultGenericisWildcard(...)TypeBoundInvokeAssign thatthat.invokeNodeBaseInvokeNode invokeNode, ...;ArgType genericArgType, ...;this.genericArgTypeBoundEnum.USETypeBoundInvokeUse thatimport WildcardBoundimport static TypeCompareEnum.CONFLICTimport static TypeCompareEnum.EQUALimport static TypeCompareEnum.NARROWimport static TypeCompareEnum.NARROW_BY_GENERICimport static TypeCompareEnum.UNKNOWNimport static TypeCompareEnum.WIDERimport static TypeCompareEnum.WIDER_BY_GENERICTypeCompare.classComparator<ArgType> comparator, ...;Comparator<ArgType> reversedComparator, ...;this.comparatornew ArgTypeComparator(...)this.reversedComparatorreversed(...)compareObjects(...)/** Compare two type and return result for first argument (narrow, wider or conflict) */boolean firstKnownboolean secondKnownboolean firstArrayboolean secondArrayboolean firstPrimitiveboolean secondPrimitiveboolean firstObjboolean secondObjTypeCompareEnum.EQUALcompareWithUnknown(...)compareArrayWithOtherType(...)int variantLengetPossibleTypes(...).lengthPrimitiveType firstPrimitiveTypePrimitiveType secondPrimitiveTypePrimitiveType knownPrimitivePrimitiveType[] possibleTypesPrimitiveType possibleTypeboolean objectsEqualsboolean firstGenericTypeboolean secondGenericTypeboolean firstGenericboolean secondGenericboolean firstIsObjClsArgType firstWildcardTypeArgType secondWildcardTypecompareGenericTypeWithObject(...)List<ArgType> firstGenericTypesList<ArgType> secondGenericTypescompareWildcardTypes(...)ArgType firstOuterTypeArgType secondOuterTypeTypeCompareEnum resWildcardBound firstWildcardBoundWildcardBound secondWildcardBoundTypeCompareEnum wildcardComparecompareTypeVariables(...)ArgType extendTypeList<ArgType> firstExtendTypesremoveObject(...)List<ArgType> secondExtendTypesint firstExtSizeint secondExtSize/* && secondArray */// both arrays/* && !secondKnown */// primitive types conflicts with objects// both generics on same object// both wildcards// check outer types// compare generics arraysnew TypeCompareEnum(...)TypeCompareEnum EQUAL, ...;TypeCompareEnum NARROW, ...;TypeCompareEnum NARROW_BY_GENERIC, ...;TypeCompareEnum WIDER, ...;// same basic type with genericTypeCompareEnum WIDER_BY_GENERIC, ...;TypeCompareEnum CONFLICT, ...;// same basic type without genericTypeCompareEnum UNKNOWN, ...;AttachMethodDetails.classList<Function<MethodNode,Boolean>> resolvers, ...;this.resolversnew Function<MethodNode,Boolean>(...) { ... }initTypeBounds(...)runTypePropagation(...)tryInsertCasts(...)tryDeduceTypes(...)trySplitConstInsns(...)tryToFixIncompatiblePrimitives(...)tryInsertAdditionalMove(...)runMultiVariableSearch(...)tryRemoveGenerics(...)assignImmutableTypes(...)Function<MethodNode,Boolean> resolver/** Check if all types resolved *//** Collect initial type bounds from assign and usages */attachBounds(...)mergePhiBounds(...)/** Guess type from usage and try to set it to current variable ... */setImmutableType(...)setBestType(...)TypeSearch typeSearchnew TypeSearch(...)run(...)applyWithWiderIgnSame(...)JadxOverflowException ecalculateFromBounds(...)TypeInfo typeInfoSet<ITypeBound> boundsOptional<ArgType> bestTypeOptselectBestTypeFromBounds(...)ArgType candidateTypeITypeBound boundTypeUpdateResult.CHANGEDgetComparator(...)new Function<ITypeBound,ArgType>(...) { ... }RegisterArg assignaddAssignBound(...)addBound(...)makeUseBound(...)PhiInsn usedInPhinew TypeBoundConst(...)LiteralArg constLitmakeAssignInvokeBound(...)new TypeBoundCheckCastAssign(...)ArgType boundTypeArgType genericReturnTypegetMethodGenericReturnType(...)new TypeBoundInvokeAssign(...)TypeBoundInvokeUse invokeUseBoundmakeInvokeUseBound(...)AFlag.SOFT_CASTnew TypeBoundInvokeUse(...)makePossibleTypesList(...)ArgType arrElemTypeITypeBound bconvertFromPrimitiveType(...)deduceType(...)tryPossibleTypes(...)tryWiderObjects(...)boolean resolvedtryRawType(...)Set<ArgType> objTypesnew LinkedHashSet<ArgType>(...)checkRawType(...)ArgType rawTypeint addedList<SSAVar> mthSVarsint varsCounttryInsertVarCast(...)rerun(...)insertAssignCast(...)insertUseCasts(...)int useCastsRegisterArg useReginsertSoftUseCast(...)RegisterArg newAssignArgduplicateWithNewSSAVar(...)makeSoftCastInsn(...)insertAfterInsn(...)BlockNode useBlockRegisterArg newUseArginsertBeforeInsn(...)boolean constSplittedcheckAndSplitConstInsn(...)InsnNode copyInsncopyWithNewSsaVar(...)RegisterArg phiArggetArgBySsaVar(...)int insnsAddedPhiListAttr phiListAttrtryInsertAdditionalInsn(...)/** Add MOVE instruction before PHI in bound blocks to make 'soft' type link. ... */ArgType phiTypegetCommonTypeForPhiArgs(...)insertMovesForPhi(...)ArgType phiArgTypegetBlockByArgIndex(...)checkBlockForInsnInsert(...)boolean addInsnType assignTypeinsertMove(...)SSAVar newSsaVarClspGraph clspString ancestorArgType ancestorTypeint ssaVarsCountprocessIncompatiblePrimitives(...)getBound(...)canBeAnyNumber(...)fixBooleanUsage(...)RegisterArg boundArgint insnIndexTernaryInsn convertInsnprepareBooleanConvertInsn(...)ArithNode arithInsnInsnNode convertInsnnotBooleanToInt(...)InsnNode notInsnInsnArg notArggetSsaImmutableType(...)markAsImmutable(...)// don't add primitive types// try best type from bounds again// try all possible types (useful for primitives)// for objects try super types// cast not needed if compare with null// for every PHI make separate CONST insn// all args have same known type => nothing to do here// check if instructions can be inserted// check passed => apply// can't insert move in a block with 'separate' instruction => try previous block by simple path// new vars will be added at list end if fix is applied (can't use for-each loop)// replace cast// replace (boolean ^ 1) with (!boolean)// insert before insnnew LinkedHashSet<ITypeBound>(...)Set<ITypeBound> bounds, ...;/** Slow and memory consuming multi-variable type search algorithm. ... */TypeSearch.classint VARS_PROCESS_LIMIT, ...;int CANDIDATES_COUNT_LIMIT, ...;int SEARCH_ITERATION_LIMIT, ...;TypeSearchState state, ...;TypeCompare typeCompare, ...;new TypeSearchState(...)this.typeCompareboolean searchSuccessList<TypeSearchVarInfo> varsgetUnresolvedVars(...)fillTypeCandidates(...)collectConstraints(...)new Consumer<TypeSearchVarInfo>(...) { ... }resolveIndependentVariables(...)search(...)fullCheck(...)applyResolvedVars(...)List<TypeSearchVarInfo> resolvedVarsgetResolvedVars(...)List<TypeSearchVarInfo> updatedVarsnew ArrayList<TypeSearchVarInfo>(...)boolean applySuccessTypeSearchVarInfo vargetCurrentType(...)TypeUpdateResult resint nlong countgetCandidateTypes(...)...*=...TypeSearchVarInfo firstnextType(...)TypeSearchVarInfo nextsetTypeResolved(...)boolean allRelatedVarsResolvedallMatch(...)getConstraints(...)new Function<ITypeConstraint,Stream<? extends SSAVar>>(...) { ... }getRelatedVars(...)new Predicate<SSAVar>(...) { ... }isTypeResolved(...)getVarInfo(...)singleCheck(...)ITypeConstraint constraintcheck(...)TypeSearchVarInfo varInfoArgType currentTypeSet<ArgType> assignsSet<ArgType> usesSet<ArgType> candidateTypesmarkResolved(...)addCandidateTypes(...)ArgType assignTypegetWiderTypes(...)ArgType useTypegetNarrowTypes(...)addUsageTypeCandidates(...)setCurrentType(...)setCandidateTypes(...)ArrayList<ArgType> typesgetReversedComparator(...)ArgType aputTypeaddCandidateType(...)inBounds(...)Set<String> ancestorsexpandUnknownType(...)List<String> impListgetImplementations(...)setConstraints(...)new ArrayList<ITypeConstraint>(...)addConstraint(...)makeConstraint(...)makeMoveConstraint(...)makePhiConstraint(...)new AbstractTypeConstraint(...) { ... }ArgType resTypeisWider(...)// quick search for variables without dependencies// ignore unknown variables// type already set// prepare vars// check all types combinations// mark all vars as resolved// variable is independent, run single search// a lot of objects to returnMap<SSAVar,TypeSearchVarInfo> varInfoMap, ...;List<SSAVar> varsthis.varInfoMapnew LinkedHashMap<SSAVar,TypeSearchVarInfo>(...)new TypeSearchVarInfo(...)new Predicate<TypeSearchVarInfo>(...) { ... }boolean typeResolved, ...;ArgType currentType, ...;List<ArgType> candidateTypes, ...;int currentIndex, ...;List<ITypeConstraint> constraints, ...;this.currentTypethis.typeResolvedthis.candidateTypes/** Switch {@code currentType} to next candidate ... */... % ...this.constraintsimport EnumMapimport Supplierimport static TypeUpdateResult.CHANGEDimport static TypeUpdateResult.REJECTimport static TypeUpdateResult.SAMETypeUpdate.classMap<InsnType,ITypeListener> listenerRegistry, ...;TypeCompare comparator, ...;this.listenerRegistryinitListenerRegistry(...)new TypeCompare(...)/** Perform recursive type checking and type propagation for all related variables */TypeUpdateFlags.FLAGS_EMPTY/** Allow wider types for apply from debug info and some special cases */TypeUpdateFlags.FLAGS_WIDER/** Force type setting */TypeUpdateFlags.FLAGS_WIDER_IGNSAMETypeUpdateInfo updateInfonew TypeUpdateInfo(...)updateTypeChecked(...)List<TypeUpdateEntry> updatesgetUpdates(...)new Consumer<TypeUpdateEntry>(...) { ... }applyUpdates(...)isIgnoreSame(...)getFlags(...)isAllowWider(...)updateTypeForSsaVar(...)requestUpdate(...)requestUpdateForSsaVar(...)TypeUpdateResult useResultisProcessed(...)checkUpdatesCount(...)runListeners(...)rollbackUpdate(...)Error errorITypeListener listenerupdate(...)checkBound(...)checkAssignForUnknown(...)boolean candidateArrayMap<InsnType,ITypeListener> registrynew EnumMap<InsnType,ITypeListener>(...)InsnType.classnew ITypeListener(...) { ... }sameFirstArgListener(...)moveListener(...)allSameListener(...)arrayGetListener(...)arrayPutListener(...)ifListener(...)arithListener(...)suggestAllSameListener(...)checkCastListener(...)invokeListener(...)BaseInvokeNode invokeisAssign(...)Set<ArgType> knownTypeVarsgetMth(...)Map<ArgType,ArgType> typeVarsMapapplyInvokeTypes(...)new Supplier<ArgType>(...) { ... }new Function<Integer,ArgType>(...) { ... }int argOffsetcheckType(...)TypeCompareEnum compareInsnArg invokeArgBoolean hasUnknownnew Function<ArgType,Boolean>(...) { ... }InsnArg changeArgboolean assignChangedboolean correctTypeTypeCompareEnum cmp/** All args must have same types *//** Try to set candidate type to all args, don't fail on reject */IndexInsnNode checkCastTypeCompareEnum compResultInsnArg putArgArgType putTypeTypeCompareEnum.WIDERInsnArg updateArgArgType updateArgTypecanBeObject(...)canBeArray(...)canBePrimitive(...)// don't changed type// allow replace object to same object with known generic type// due to incomplete information about external methods and fields// TODO: implement backward type propagation (from result to instance)// generics can't be resolved => use as is// resolve types before apply// allow result to be wider// force all args to boolean// propagate generic type to result// index argument// allow wider result (i.e allow put in Object[] any objects)// index// soft checks for objects and array - exact type not comparednew TypeUpdateFlags(...)TypeUpdateFlags FLAGS_EMPTY, ...;TypeUpdateFlags FLAGS_WIDER, ...;TypeUpdateFlags FLAGS_WIDER_IGNSAME, ...;boolean allowWider, ...;boolean ignoreSame, ...;this.allowWiderthis.ignoreSamenew ArrayList<TypeUpdateEntry>(...)TypeUpdateFlags flags, ...;List<TypeUpdateEntry> updates, ...;int updatesLimitCount, ...;this.flagsthis.updatesLimitCountnew TypeUpdateEntry(...)TypeUpdateEntry updateEntryTypeUpdateEntry entryTypeUpdateEntry updatenew Predicate<TypeUpdateEntry>(...) { ... }// maximum registers count to update at oncenew EnumMap<InsnType,List<ITypeListener>>(...)Map<InsnType,List<ITypeListener>> listenersMap, ...;new Function<InsnType,List<ITypeListener>>(...) { ... }new ArrayList<ITypeListener>(...)List<ITypeListener> listnew TypeUpdateResult(...)TypeUpdateResult REJECT, ...;TypeUpdateResult SAME, ...;TypeUpdateResult CHANGED, ...;new UseSet<ClassNode,ClassNode>(...)new UseSet<ClassNode,MethodNode>(...)new UseSet<FieldNode,MethodNode>(...)new UseSet<MethodNode,MethodNode>(...)UseSet<ClassNode,ClassNode> clsDeps, ...;UseSet<ClassNode,ClassNode> clsUsage, ...;UseSet<ClassNode,MethodNode> clsUseInMth, ...;UseSet<FieldNode,MethodNode> fieldUsage, ...;UseSet<MethodNode,MethodNode> mthUsage, ...;new BiConsumer<ClassNode,Set<ClassNode>>(...) { ... }setDependencies(...)sortedList(...)setUseIn(...)new BiConsumer<ClassNode,Set<MethodNode>>(...) { ... }setUseInMth(...)new BiConsumer<FieldNode,Set<MethodNode>>(...) { ... }new BiConsumer<MethodNode,Set<MethodNode>>(...) { ... }processType(...)clsUse(...)/** Add method usage: {@code useMth} occurrence found in {@code mth} code */new Consumer<ArgType>(...) { ... }List<T> list// exclude class usage in self methods// implicit usageimport OpcodeUsageInfoVisitor.classUsageInfo usageInfonew UsageInfo(...)ArgType interfaceTypeprocessMethod(...)processInstructions(...)Opcode.UNKNOWNgetIndexType(...)ArgType usedTypefieldUse(...)methodUse(...)// add method override as use// sort by alias name// TODO: process annotations and genericsimport BiConsumernew HashMap<K,Set<V>>(...)Map<K,Set<V>> useMap, ...;Set<V> setnew Function<K,Set<V>>(...) { ... }new HashSet<V>(...)Entry<K,Set<V>> entryMap<>.Entry<K,Set<V>>// self excludedString applicationLabel, ...;Integer minSdkVersion, ...;Integer targetSdkVersion, ...;Integer versionCode, ...;String versionName, ...;this.applicationLabelthis.minSdkVersionthis.targetSdkVersionthis.versionCodethis.versionNameimport StringReaderimport DocumentBuilderimport DocumentBuilderFactoryimport Documentimport Elementimport NodeListimport InputSourceExportGradleProject.classSet<String> IGNORE_CLS_NAMES, ...;File projectDir, ...;File appDir, ...;File srcOutDir, ...;File resOutDir, ...;ApplicationParams applicationParams, ...;this.projectDirthis.appDirthis.srcOutDirthis.resOutDirthis.applicationParamsgetApplicationParams(...)parseAndroidManifest(...)parseAppStrings(...)makeDirs(...)saveProjectBuildGradle(...)saveApplicationBuildGradle(...)saveSettingsGradle(...)skipGeneratedClasses(...)TemplateFile tmplfromResources(...)getApplicationName(...)String appPackagegetMinSdkVersion(...)getTargetSdkVersion(...)getVersionCode(...)getVersionName(...)Element manifestitem(...)getElementsByTagName(...)Element usesSdkElement applicationInteger versionCodegetAttribute(...)String versionNameInteger minSdkInteger targetSdkString appNameString appLabelNameNodeList stringsgetLength(...)String stringNamegetNodeValue(...)getNamedItem(...)getAttributes(...)getTextContent(...)new ApplicationParams(...)DocumentBuilder buildernewDocumentBuilder(...)Document documentnew InputSource(...)new StringReader(...)getDocumentElement(...)String contentgetText(...)parseXml(...)import FileNotFoundExceptionimport FileOutputStream/** Simple template engine ... */State NONE, ...;State START, ...;State VARIABLE, ...;State END, ...;State.NONEState state, ...;StringBuilder curVariable, ...;boolean skip, ...;String templateName, ...;InputStream template, ...;Map<String,String> values, ...;InputStream resTemplateFile.classnew FileNotFoundException(...)new TemplateFile(...)this.templateNamethis.templateByteArrayOutputStream outOutputStream outnew FileOutputStream(...)available(...)InputStream inParserState statenew ParserState(...)state.skipState stateparser.stateState.VARIABLEparser.curVariableState.STARTparser.skipString varNameState.ENDprocessVar(...)BlockInsnPair thatthat.blockcleanBlockList(...)/** Remove exception handlers from block nodes list */List<BlockNode> ret/** Remove exception handlers from block nodes bitset *//** Return predecessors list without blocks contains 'IGNORE_EDGE' attribute. ... */IgnoreEdgeAttr edgeAttr/** Check if instruction contains in block (use == for comparison, not equals) */InsnNode bisearchBlockWithPhi(...)getBlockByWrappedInsn(...)BlockNode bnfoundWrappedInsn(...)InsnArg resfoundWrappedInsnInCondition(...)IfNode cmpInsnIfCondition nestedCondBitSet copy/** Return first successor which not exception handler and not follow loop back edge *//** Return successor on path to 'pathEnd' block */Set<BlockNode> path/** Collect blocks from all possible execution paths from 'start' to 'end' */addPredecessors(...)List<BlockNode> nodestraverseSuccessorsUntil(...)BlockNode fromboolean topBlockNode toBlockNode currentNode/** Search for first node which not dominated by dom, starting from start */traverseWhileDominates(...)BitSet bBlockNode end/** Collect all block dominated by 'dominator', starting from 'start' */collectWhileDominates(...)/** Collect all block dominated by 'dominator', starting from 'start', include exception handlers */BlockNode currentBlock/** Set 'SKIP' flag for all synthetic predecessors from start block. *//** Return true if on path from start to end no instructions and no branches. *//** Return successor of synthetic block or same block otherwise. *//** Return predecessor of synthetic block or same block otherwise. */BlockNode enterBlock/** Replace insn by index i in block, ... */RegisterArg prevResultInsnNode instructiongetInsnIndexInBlock(...)Map<BlockNode,BitSet> mapnew HashMap<BlockNode,BitSet>(...)BitSet initSetBitSet exitBitSetBitSet postDomsBlockNode sccBitSet scPDomsBlockNode oneSuccessorcalcPostDominance(...)Map<BlockNode,BitSet> pDomsMapBlockNode pdomBlock// already checked// Don't unbind result for same register.// Unbind will remove arg from PHI and not add it back on rebind.Set<String> rootPkgs, ...;this.rootPkgsList<String> commentsSSAVar svar/** Check invariants and information consistency for registers and SSA variables */boolean checksEnabled, ...;Class<? extends IDexTreeVisitor> visitorClsPrepareForCodeGen.classcheckMethod(...)checkVar(...)TernaryInsn ternaryInsnboolean assignRegcheckRegisterArg(...)containsInListByRef(...)BlockNode parentInsnBlockcontainsArg(...)List<PhiInsn> phisgetBlockByArg(...)/* not final! */// checkPHI(mth);DebugUtils.classFile outnew AbstractVisitor(...) { ... }Set<IRegion> regionsnew LinkedHashSet<IRegion>(...)new TracedRegionVisitor(...) { ... }printRegions(...)printRegion(...)printWithAttributes(...)printInsns(...)List<String> insnStringsnotBlank(...)new Function<String,String>(...) { ... }Iterator<String> itString insnStrList<String> attrStringsEntry<?,?> entryMap<>.Entry<?,?>new Exception(...)new EmptyBitSet(...)long serialVersionUID, ...;BitSet EMPTY, ...;/** Return constant literal from {@code jadx.api.plugins.input.data.annotations.EncodedValue} ... */// noinspection RedundantCastnew HashSet<IAttributeNode>(...)ErrorsCounter.classboolean PRINT_MTH_SIZE, ...;Set<IAttributeNode> errorNodes, ...;int errorsCount, ...;Set<IAttributeNode> warnNodes, ...;int warnsCount, ...;addWarning(...)typeName(...)String detailsList<String> errorsIAttributeNode nodeString nodeNameString err// don't print full stack traceimport NoSuchElementExceptionimport RandomAccessimport UnaryOperator/** Simple immutable list implementation ... */...[] arr, ...;this.arrE enew Iterator<E>(...) { ... }int len, ...;IndexOutOfBoundsException enew NoSuchElementException(...)ImmutableList<?> otherother.arrList<?> otherE e1Object e2List<InsnNode> list, ...;this.listIterator<InsnNode> iteratorInsnNode next/** Helper class for correct instructions removing, ... */List<InsnNode> toRemove, ...;List<InsnNode> instrList, ...;this.toRemovethis.instrListunbindInsns(...)removeSsaVar(...)boolean allPhisConsts.DEBUG_WITH_ERRORSnew Function<RegisterArg,String>(...) { ... }InsnWrapArg wrap// and here can be several instructions with same content// Don't use 'instrList.removeAll(toRemove)' because it will remove instructions by contentInsnNode remInsnNode ir// check if all usage only in PHI insns// remove by pointer (don't use equals)InsnUtils.class/** Search constant assigned to provided arg. ... */InsnNode parInsn/** Return constant value from insn or null if not constant. ... */FieldInitAttr attrconvertToConstValue(...)/** Search instruction of specific type and condition in method. ... */InsnNode foundInsnrecursiveInsnCheck(...)IContainer brList<IContainer> blocksunknownContainerType(...)/** Return true if last block in region has no successors or jump out insn (return or break) */isInsnExitContainer(...)AttrList<LoopInfo> loopInfoAttrListLoopLabelAttr loopLabelAttrLoopInfo loopInfoIContainer bCatchAttr cbList<IContainer> list/** Check if {@code region} contains in {@code container}. ... */isRegionContainsExcHandlerRegion(...)IContainer res/** Check if two blocks in same region on same level ... */IContainer firstContainerisDominatedBy(...)// check if after throw execution can continue in current container// process sub blocks// process try blockStringUtils DEFAULT_INSTANCE, ...;String WHITES, ...;String WORD_SEPARATORS, ...;StringBuilder resprocessCharInsideString(...)getSpecialStringForChar(...)/** Represent single char best way possible */String replaceescapeXmlChar(...)commonEscapeAndAppend(...)escapeWhiteSpaceChar(...)int subStrLen/** returns how many lines does it have between start to pos in content. */int tempPos/** returns lines that contain pos to end if end is not -1. */int headPos// get to line head// get to line endimport StringWriterDepthTraversal.classString JADX_API_PACKAGE, ...;String STACKTRACE_STOP_CLS_NAME, ...;new Function<?,String>(...) { ... }new Function<T,String>(...) { ... }Iterator<T> itStringWriter swnew StringWriter(...)PrintWriter pwfilterRecursive(...)printStackTrace(...)getBuffer(...)OutputStream wnew OutputStream(...) { ... }flush(...)StackTraceElement[] stackTraceint lengthstackTrace.lengthStackTraceElement prevElementStackTraceElement stackTraceElementsetStackTrace(...)copyOfRange(...)List<R> resultnew ArrayList<R>(...)T tnew ImmutableList<T>(...)/** Sub list from startIndex (inclusive) to list end */List<T> resultparameters.lengthMap<String,String> resultunmodifiableMap(...)/** Merge two maps. Return HashMap as result. Second map will override values from first map. */Map<K,V> resultnew HashMap<K,V>(...)// ignore filter exceptions// stop condition not found -> just cut tail to any jadx classimport ProcessState/** Android resources specific handlers */AndroidResourcesUtils.classClassNode resClsList<ClassNode> candidatessearchClassByShortName(...)ClassNode newResClsaddResourceFields(...)ClassNode rClsMap<Integer,FieldNode> resFieldsMapfillResFieldsMap(...)Map<String,ClassNode> innerClsMapnew TreeMap<String,ClassNode>(...)ResourceEntry resourceString resTypeNameClassNode typeClsnew Function<String,ClassNode>(...) { ... }addClassForResType(...)String resNameFieldInfo rFieldInfofrom(...)EncodedValue valueEncodedType.ENCODED_INTClassNode newTypeClsnew HashMap<Integer,FieldNode>(...)ConstStorage constStorageMap<Object,FieldNode> constFieldsgetGlobalConstFields(...)Map<>.Entry<Object,FieldNode>import DataInput/** @author */DataInput mDelegate, ...;this.mDelegateskipBytes(...)readUnsignedShort(...)readUTF(...)readLong(...)readLine(...)readFully(...)readFloat(...)readDouble(...)readChar(...)readBoolean(...)/** Copyright 2014 Ryszard Winiewski <brut.alll@gmail.com> ... */int[] arrayint gotshort gotbyte gotskipCheckChunkTypeInt(...)/** The general contract of DataInput doesn't guarantee all the bytes requested will be skipped ... */int totalint curStringBuilder stringshort chimport BufferedImageimport ImageIOBufferedImage imint wgetWidth(...)int hgetHeight(...)BufferedImage im2new BufferedImage(...)BufferedImage.TYPE_INT_ARGBNinePatch npgetNinePatch(...)int[] xDivsnp.xDivsint[] yDivsnp.yDivsdrawImage(...)createGraphics(...)drawHLine(...)np.padLeftnp.padRightdrawVLine(...)np.padTopnp.padBottomxDivs.lengthyDivs.lengthExtDataInput dinew ExtDataInput(...)find9patchChunk(...)IOException exint xsetRGB(...)int yint NP_CHUNK_TYPE, ...;int NP_COLOR, ...;// npTcint padLeft, ...;int padRight, ...;int padTop, ...;int padBottom, ...;...[] xDivs, ...;...[] yDivs, ...;this.padLeftthis.padRightthis.padTopthis.padBottomthis.xDivsthis.yDivsbyte numXDivsbyte numYDivsint padLeftint padRightint padTopint padBottomreadIntArray(...)new NinePatch(...)import BufferedReaderimport InputStreamReaderimport StandardCharsetsint SPLIT_POS, ...;BufferedReader brnew BufferedReader(...)new InputStreamReader(...)StandardCharsets.UTF_8String lineparseLine(...)parseInt(...)new TreeMap<Integer,String>(...)import JarEntryimport JarOutputStreamFileUtils.classcreateTempRootDir(...)int READ_BUFFER_SIZE, ...;int MAX_FILENAME_LENGTH, ...;String JADX_TMP_INSTANCE_PREFIX, ...;String JADX_TMP_PREFIX, ...;BufferedInputStream inJarEntry entrynew JarEntry(...)setTime(...)lastModified(...)closeEntry(...)getParentFile(...)Object MKDIR_SYNC, ...;mkdirs(...)File[] contentlistFiles(...)deleteDir(...)reverseOrder(...)new Function<Path,File>(...) { ... }new Consumer<File>(...) { ... }Path TEMP_ROOT_DIR, ...;String jadxTmpDirgetenv(...)Path dircreateTempDirectory(...)deleteOnExit(...)byte[] bufferIOException eFile saveFilecutFileName(...)int dotIndexint cutAtchar[] hexArraytoCharArray(...)char[] hexCharsnew char[]byte[] headersint readheaders.lengthString headerStringbytesToHex(...)List<String> filesListEnumeration<? extends ZipEntry> entriesentries(...)getZipFileList(...)isZipFileCanBeOpen(...)int extEndIndex// TODO: parse data from d1 (protobuf encoded) to get original method names and other useful infoKotlinMetadataUtils.classString KOTLIN_METADATA_ANNOTATION, ...;String KOTLIN_METADATA_D2_PARAMETER, ...;String KOTLIN_METADATA_CLASSNAME_REGEX, ...;/** Try to get class info from Kotlin Metadata annotation */IAnnotation metadataAnnotationList<EncodedValue> d2ParamgetParamAsList(...)EncodedValue firstValueEncodedType.ENCODED_STRINGString rawClassNameimport Random/* TODO: ... */BinaryXMLParser.classboolean ATTR_NEW_LINE, ...;Map<Integer,String> resNames, ...;Map<String,String> nsMap, ...;Set<String> nsMapGenerated, ...;Map<String,String> tagAttrDeobfNames, ...;CodeWriter writer, ...;...[] strings, ...;String currentTag, ...;boolean firstElement, ...;ValuesParser valuesParser, ...;boolean isLastEnd, ...;boolean isOneLine, ...;int namespaceDepth, ...;...[] resourceIds, ...;RootNode rootNode, ...;String appPackageName, ...;this.rootNodenew ParserStream(...)isBinaryXml(...)loadToCodeWriter(...)readInt16(...)readInt32(...)getPos(...)int typeparseStringPoolNoType(...)parseResourceMap(...)parseNameSpace(...)parseCData(...)parseNameSpaceEnd(...)parseElement(...)parseElementEnd(...)die(...)int beginLineNumberint commentint beginPrefixint beginURIString nsValuecontainsValue(...)putIfAbsent(...)int endLineNumberint endPrefixint endURIint lineNumberint strIndexString escapedStrescapeXML(...)long sizeint elementBegLineNumberint startNSint startNSNameint attributeStartint attributeSizeint attributeCountint idIndexint classIndexint styleIndexboolean attrNewLinedeobfClassName(...)getValidTagAttributeName(...)Entry<String,String> entryparseAttribute(...)int attributeNSint attributeNameint attributeRawValueint attrValDataTypereadInt8(...)int attrValDataString shortNsNameString attrNamegetAttributeName(...)String decodedAttraddIndent(...)getAttributeNS(...)memorizePackageName(...)isDeobfCandidateAttr(...)attachClassNode(...)decodeAttribute(...)String attrUrlisResInternalId(...)generateNameForNS(...)int resIdint typeEndgetAndroidResMap(...)strings.lengthString androidResNamedecodeValue(...)int elementNSint elementNameIdString elemNameString generatedisValidName(...)generateTagAttrName(...)Random rnew Random(...)nextInt(...)String clsFullNamesearchClassByFullAlias(...)String newName// version// header size// NullType is just doing nothing// skip padding on file end// TODO: Check element chunk size// actually is elementName...// do not add generated value to nsMap// because attrUrl might be used in a neighbor element, but never defined// cut type before /// reference custom processing// if (elementNS != -1) {// writer.add(getString(elementNS)).add(':');ParserStream is, ...;checkInt16(...)readUInt32(...)long chunkEndint stringCountint styleCountint flagslong stringsStartlong stylesStartint[] stringsOffsetreadInt32Array(...)int[] stylesOffsetString[] stringsbyte[] strDatareadInt8Array(...)checkPos(...)extractString8(...)extractString16(...)skipStrLen8(...)strArray.length... << ...ParserStream.STRING_CHARSET_UTF8skipStrLen16(...)ParserStream.STRING_CHARSET_UTF16// UTF-8// UTF-16// don't trust specified string length, read until \0// stringsOffset can be same for different indexesimport NamedNodeMapimport Nodenew HashMap<String,MAttr>(...)ManifestAttributes.classString ATTR_XML, ...;String MANIFEST_ATTR_XML, ...;new MAttrType(...)MAttrType ENUM, ...;MAttrType FLAG, ...;new LinkedHashMap<Long,String>(...)MAttrType type, ...;Map<Long,String> values, ...;Map<String,MAttr> attrMap, ...;ManifestAttributes instance, ...;new ManifestAttributes(...)parseAll(...)loadXML(...)Document docInputStream xmlStreamDocumentBuilder dBuildergetSecureDbf(...)NodeList nodeListgetChildNodes(...)Node nodehasChildNodes(...)getNodeType(...)Node.ELEMENT_NODEparseAttrList(...)Node tempNodehasAttributes(...)NamedNodeMap nodeMapgetNodeName(...)parseValues(...)MAttr attrNamedNodeMap attributesNode nameNodenew MAttr(...)MAttrType.ENUMMAttrType.FLAGNode valueNodelong keyString nodeValueparseLong(...)NumberFormatException eEntry<Long,String> entryMap<>.Entry<Long,String>deleteCharAt(...)new double[]makeResInternal(...)String ANDROID_NS_URL, ...;String ANDROID_NS_VALUE, ...;int RES_NULL_TYPE, ...;/** Chunk types */int RES_STRING_POOL_TYPE, ...;int RES_TABLE_TYPE, ...;int RES_XML_TYPE, ...;int RES_XML_FIRST_CHUNK_TYPE, ...;int RES_XML_START_NAMESPACE_TYPE, ...;int RES_XML_END_NAMESPACE_TYPE, ...;int RES_XML_START_ELEMENT_TYPE, ...;int RES_XML_END_ELEMENT_TYPE, ...;int RES_XML_CDATA_TYPE, ...;int RES_XML_LAST_CHUNK_TYPE, ...;int RES_XML_RESOURCE_MAP_TYPE, ...;int RES_TABLE_PACKAGE_TYPE, ...;int RES_TABLE_TYPE_TYPE, ...;int RES_TABLE_TYPE_SPEC_TYPE, ...;int TYPE_NULL, ...;// Contains no data./** Type constants */int TYPE_REFERENCE, ...;// The 'data' holds a ResTable_ref, a reference to another resource table entry.int TYPE_ATTRIBUTE, ...;// The 'data' holds an attribute resource identifier.int TYPE_STRING, ...;// The 'data' holds an index into the containing resource table's global value string pool.int TYPE_FLOAT, ...;// The 'data' holds a single-precision floating point number.int TYPE_DIMENSION, ...;// The 'data' holds a complex number encoding a dimension value, such as "100in".int TYPE_FRACTION, ...;// The 'data' holds a complex number encoding a fraction of a container.int TYPE_DYNAMIC_REFERENCE, ...;/** The 'data' holds a dynamic reference, a reference to another resource table entry. ... */int TYPE_DYNAMIC_ATTRIBUTE, ...;/** According to the sources of apktool this type seem to be related to themes ... */int TYPE_FIRST_INT, ...;// Beginning of integer flavors...int TYPE_INT_DEC, ...;// The 'data' is a raw integer value of the form n..n.int TYPE_INT_HEX, ...;// The 'data' is a raw integer value of the form 0xn..n.int TYPE_INT_BOOLEAN, ...;// The 'data' is either 0 or 1, for input "false" or "true" respectively.int TYPE_FIRST_COLOR_INT, ...;// Beginning of color integer flavors...int TYPE_INT_COLOR_ARGB8, ...;// The 'data' is a raw integer value of the form #aarrggbb.int TYPE_INT_COLOR_RGB8, ...;// The 'data' is a raw integer value of the form #rrggbb.int TYPE_INT_COLOR_ARGB4, ...;// The 'data' is a raw integer value of the form #argb.int TYPE_INT_COLOR_RGB4, ...;// The 'data' is a raw integer value of the form #rgb.int TYPE_LAST_COLOR_INT, ...;// ...end of integer flavors.int TYPE_LAST_INT, ...;int COMPLEX_UNIT_SHIFT, ...;// types, as defined below.// Where the unit type information is. This gives us 16 possibleint COMPLEX_UNIT_MASK, ...;int COMPLEX_UNIT_PX, ...;// TYPE_DIMENSION: Value is raw pixels.int COMPLEX_UNIT_DIP, ...;// TYPE_DIMENSION: Value is Device Independent Pixels.int COMPLEX_UNIT_SP, ...;// TYPE_DIMENSION: Value is a Scaled device independent Pixels.int COMPLEX_UNIT_PT, ...;// TYPE_DIMENSION: Value is in points.int COMPLEX_UNIT_IN, ...;// TYPE_DIMENSION: Value is in inches.int COMPLEX_UNIT_MM, ...;// TYPE_DIMENSION: Value is in millimeters.int COMPLEX_UNIT_FRACTION, ...;// TYPE_FRACTION: A basic fraction of the overall size.int COMPLEX_UNIT_FRACTION_PARENT, ...;// TYPE_FRACTION: A fraction of the parent size.int COMPLEX_RADIX_SHIFT, ...;// representations as defined below.// appears in the mantissa. This give us 4 possible fixed point// Where the radix information is, telling where the decimal placeint COMPLEX_RADIX_MASK, ...;int COMPLEX_RADIX_23P0, ...;// The mantissa is an integral number -- i.e., 0xnnnnnn.0int COMPLEX_RADIX_16P7, ...;// The mantissa magnitude is 16 bits -- i.e, 0xnnnn.nnint COMPLEX_RADIX_8P15, ...;// The mantissa magnitude is 8 bits -- i.e, 0xnn.nnnnint COMPLEX_RADIX_0P23, ...;// The mantissa magnitude is 0 bits -- i.e, 0x0.nnnnnnint COMPLEX_MANTISSA_SHIFT, ...;// precision. The top bit is the sign.// Where the actual value is. This gives us 23 bits ofint COMPLEX_MANTISSA_MASK, ...;double MANTISSA_MULT, ...;...[] RADIX_MULTS, ...;int SORTED_FLAG, ...;/** String pool flags */int UTF8_FLAG, ...;int NO_ENTRY, ...;int FLAG_COMPLEX, ...;// It is followed by an array of ResTable_map structures.// If set, this is a complex entry, holding a set of name/value mappings./** ResTable_entry */int FLAG_PUBLIC, ...;// If set, this resource has been declared public, so libraries are allowed to reference it.int FLAG_WEAK, ...;// This is only useful during linking with other resource tables.// If set, this is a weak resource and may be overriden by strong resources of the same name/type.int ATTR_TYPE, ...;/** ResTable_map */int ATTR_MIN, ...;// For integral attributes, this is the minimum value it can hold.int ATTR_MAX, ...;// For integral attributes, this is the maximum value it can hold.int ATTR_L10N, ...;// Localization of this resource is can be encouraged or required with an aapt flag if this is setint ATTR_OTHER, ...;// for plural support, see android.content.res.PluralRules#attrForQuantity(int)int ATTR_ZERO, ...;int ATTR_ONE, ...;int ATTR_TWO, ...;int ATTR_FEW, ...;int ATTR_MANY, ...;Map<Integer,String> PLURALS_MAP, ...;int ATTR_TYPE_ANY, ...;// Bit mask of allowed types, for use with ATTR_TYPE.int ATTR_TYPE_REFERENCE, ...;// Attribute holds a references to another resource.int ATTR_TYPE_STRING, ...;// Attribute holds a generic string.int ATTR_TYPE_INTEGER, ...;// optionally specify a constrained range of possible integer values.// Attribute holds an integer value. ATTR_MIN and ATTR_MIN canint ATTR_TYPE_BOOLEAN, ...;// Attribute holds a boolean integer.int ATTR_TYPE_COLOR, ...;// Attribute holds a color value.int ATTR_TYPE_FLOAT, ...;// Attribute holds a floating point value.int ATTR_TYPE_DIMENSION, ...;// Attribute holds a dimension value, such as "20px".int ATTR_TYPE_FRACTION, ...;// Attribute holds a fraction value, such as "20%".int ATTR_TYPE_ENUM, ...;// supplied as additional entries in the map.// Attribute holds an enumeration. The enumeration values areint ATTR_TYPE_FLAGS, ...;// Attribute holds a bitmaks of flags. The flag bit values areint ATTR_L10N_NOT_REQUIRED, ...;// Enum of localization modes, for use with ATTR_L10Nint ATTR_L10N_SUGGESTED, ...;import EOFExceptionforName(...)Charset STRING_CHARSET_UTF16, ...;Charset STRING_CHARSET_UTF8, ...;...[] EMPTY_INT_ARRAY, ...;...[] EMPTY_BYTE_ARRAY, ...;InputStream input, ...;long readPos, ...;this.inputint b1int b2int b3int b4int[] arrlong poslong skippedthrowException(...)markSupported(...)b.lengthnew IndexOutOfBoundsException(...)new EOFException(...)new DataType(...)DataType TEXT, ...;DataType DECODED_DATA, ...;DataType RES_LINK, ...;DataType RES_TABLE, ...;DataType dataType, ...;List<ResContainer> subFiles, ...;new ResContainer(...)DataType.TEXTDataType.DECODED_DATADataType.RES_LINKDataType.RES_TABLEthis.subFilesthis.dataTypeResContainer thatimport Matcherimport EntryConfigimport RawNamedValueimport RawValuenew ResourceStorage(...)ResTableParser.classPattern VALID_RES_KEY_PATTERN, ...;...[] typeStrings, ...;...[] keyStrings, ...;this.typeStringsthis.keyStringsboolean useRawResName, ...;/** No renaming, pattern checking or name generation. Required for res-map.txt building */ResourceStorage resStorage, ...;this.useRawResNamedecodeTableChunk(...)ValuesParser vpResXmlGen resGennew ResXmlGen(...)makeXmlDump(...)List<ResContainer> xmlFilesmakeResourcesXml(...)resourceTable(...)CodeWriter writerSet<String> addedValuesResourceEntry riString formatint pkgCountparseStringPool(...)parsePackage(...)int headerSizelong endPosreadString16Fixed(...)long typeStringsOffsetlong keyStringsOffsetString[] typeStringsString[] keyStringsPackageChunk pkgnew PackageChunk(...)skipToPos(...)deobfKeyStrings(...)setAppPackage(...)long chunkStartparseTypeSpecChunk(...)parseTypeChunk(...)int keysCountkeyStrings.lengthString keyStringmakeNewKeyName(...)Set<String> keySetint entryCountint entryFlaglong entriesStartEntryConfig configparseConfig(...)int[] entryIndexescheckInt8(...)config.isInvalidgetTypeStrings(...)getQualifiers(...)parseEntry(...)int keyint resRefString origKeyNamegetKeyStrings(...)ResourceEntry newResEntrynew ResourceEntry(...)getResName(...)ResourceEntry prevResEntrysearchEntryWithSameName(...)ResourceEntry replaceForPrevEntrycopyWithId(...)addRename(...)int parentRefList<RawNamedValue> valuesnew ArrayList<RawNamedValue>(...)setParentRef(...)parseValueMap(...)setNamedValues(...)setSimpleValue(...)parseValue(...)String renamedKeygetRename(...)Matcher mString newResNameString cleanedResNamefind(...)group(...)int nameRefnew RawNamedValue(...)int dataTypeint datanew RawValue(...)short mccshort mncchar[] languageunpackLocaleOrRegion(...)char[] countrybyte orientationbyte touchscreenint densitybyte keyboardbyte navigationbyte inputFlagsshort screenWidthshort screenHeightshort sdkVersionbyte screenLayoutbyte uiModeshort smallestScreenWidthDpshort screenWidthDpshort screenHeightDpchar[] localeScriptchar[] localeVariantbyte screenLayout2byte colorModereadScriptOrVariantChar(...)new EntryConfig(...)... >> ...int firstint secondint third/* int size = *//* int lastPublicType = *//* int lastPublicKey = *//* int typeIdOffset = *//* int headerSize = */// rename also previous entry for consistency// Making sure origKeyName compliant with resource file name rules// autogenerate key name, appended with cleaned origKeyName to be human-friendly// inputPad0// minorVersion must always be 0// reserved padding// check high bit, if so we have a packed 3 letter code// since this function handles languages & regions, we add the value(s) to the base char// which is usually 'a' or '0' depending on language or region.import static ParserConstants.PLURALS_MAPimport static ParserConstants.TYPE_REFERENCESet<String> SKIP_RES_TYPES, ...;ValuesParser vp, ...;this.resStoragethis.vpMap<String,CodeWriter> contMapnew HashMap<String,CodeWriter>(...)List<ResContainer> filesnew ArrayList<ResContainer>(...)String fnaddValue(...)Entry<String,CodeWriter> entryMap<>.Entry<String,CodeWriter>CodeWriter contentgetSimpleValue(...)String valueStraddSimpleValue(...)String itemTaggetNamedValues(...)getRawValue(...)String formatValuegetTypeAsString(...)ValuesParser.ATTR_TYPE_ENUMValuesParser.ATTR_TYPE_FLAGSgetParentRef(...)RawNamedValue valueaddItem(...)ValuesParser.ATTR_TYPE_REFERENCEValuesParser.ATTR_TYPE_STRINGValuesParser.ATTR_TYPE_INTEGERValuesParser.ATTR_TYPE_BOOLEANValuesParser.ATTR_TYPE_COLORValuesParser.ATTR_TYPE_FLOATValuesParser.ATTR_TYPE_DIMENSIONValuesParser.ATTR_TYPE_FRACTIONString nameStrdecodeNameRef(...)getNameRef(...)int intValString newValString quantityescapeResStrValue(...)escapeResValue(...)String qualifiers// remove duplicated resources.new ArrayList<ResourceEntry>(...)new TreeMap<ResourceEntry,ResourceEntry>(...)thenComparing(...)new Function<ResourceEntry,String>(...) { ... }Comparator<ResourceEntry> RES_ENTRY_NAME_COMPARATOR, ...;List<ResourceEntry> list, ...;Map<ResourceEntry,ResourceEntry> uniqNameEntries, ...;/** Names in one config and type must be unique */Map<Integer,String> renames, ...;/** Preserve same name for same id across different configs */new ToIntFunction<ResourceEntry>(...) { ... }this.appPackageMap<Integer,String> mapResourceEntry entry// don't remove from unique names so old name stays occupiedResourcesSaver.classResourceFile resourceFile, ...;this.resourceFilesaveResources(...)getDataType(...)ResContainer.DataType.RES_TABLEResContainer.DataTypesaveToFile(...)ResContainer subFileisInSubDirectory(...)getPath(...)byte[] datagetDecodedData(...)ResourceFile resFilegetResLink(...)saveResourceFile(...)new ResourceDecoder<Object>(...) { ... }Path targetdeleteIfExists(...)// delete partially written file/** This class defines the basic XML character properties. The data ... */fill(...)...[] CHARS, ...;/** Character flags. */// Constantsint MASK_VALID, ...;/** Valid character mask. */int MASK_SPACE, ...;/** Space character mask. */int MASK_NAME_START, ...;/** Name start character mask. */int MASK_NAME, ...;/** Name character mask. */int MASK_PUBID, ...;/** Pubid character mask. */int MASK_CONTENT, ...;/** Content character mask. Special characters are those that can ... */int MASK_NCNAME_START, ...;/** NCName start character mask. */int MASK_NCNAME, ...;/** NCName character mask. *//** Returns true if the specified character is a supplemental character. ... */// Public static methods// <clinit>()/** Returns true the supplemental character corresponding to the given ... *//** Returns the high surrogate of a supplemental character ... *//** Returns the low surrogate of a supplemental character ... *//** Returns whether the given character is a high surrogate ... *//** Returns whether the given character is a low surrogate ... *//** Returns true if the specified character is valid. This method ... *//** Returns true if the specified character is invalid. ... */// isValid(int):booleanisValid(...)/** Returns true if the specified character can be considered content. ... */// isInvalid(int):boolean/** Returns true if the specified character can be considered markup. ... */// isContent(int):boolean/** Returns true if the specified character is a space character ... */// isMarkup(int):boolean/** Returns true if the specified character is a valid name start ... */// isSpace(int):boolean/** Returns true if the specified character is a valid name ... */// isNameStart(int):boolean/** Returns true if the specified character is a valid NCName start ... */// isName(int):boolean/** Returns true if the specified character is a valid NCName ... */// isNCNameStart(int):boolean/** Returns true if the specified character is a valid Pubid ... */// isNCName(int):boolean/** Check to see if a string is a valid Name according to [5] ... *//* [5] Name ::= (Letter | '_' | ':') (NameChar)* */// isPubid(int):booleanisNameStart(...)++...isName(...)/** Check to see if a string is a valid NCName according to [4] ... *//* from the namespace rec ... */// isValidName(String):booleanisNCNameStart(...)isNCName(...)/** Check to see if a string is a valid Nmtoken according to [7] ... *//* [7] Nmtoken ::= (NameChar)+ */// isValidNCName(String):boolean/** Returns true if the encoding name is a valid IANA encoding. ... */// encodings/** Returns true if the encoding name is a valid Java encoding. ... */// isValidIANAEncoding(String):boolean/** Trims space characters as defined by production [3] in ... */// other methodsint lengthMinusOneisSpace(...)--.../* Licensed to the Apache Software Foundation (ASF) under one or more ... */// Static initialization// Initializing the Character Flag Array// Code generated by: XMLCharGenerator.// Fill 3 of value (byte) 49// Fill 6 of value (byte) 49// Fill 2 of value (byte) -71// Fill 10 of value (byte) -71// Fill 2 of value (byte) 49// Fill 26 of value (byte) -3// Fill 2 of value (byte) 33// Fill 60 of value (byte) 33// Fill 8 of value (byte) 33// Fill 23 of value (byte) -19// Fill 31 of value (byte) -19// Fill 58 of value (byte) -19// Fill 11 of value (byte) -19// Fill 8 of value (byte) -19// Fill 53 of value (byte) -19// Fill 68 of value (byte) -19// Fill 9 of value (byte) 33// Fill 36 of value (byte) -19// Fill 3 of value (byte) 33// Fill 2 of value (byte) -19// Fill 4 of value (byte) 33// Fill 30 of value (byte) -19// Fill 56 of value (byte) 33// Fill 89 of value (byte) -19// Fill 18 of value (byte) 33// Fill 7 of value (byte) -19// Fill 14 of value (byte) 33// Fill 2 of value (byte) -87// Fill 46 of value (byte) 33// Fill 70 of value (byte) -87// Fill 26 of value (byte) 33// Fill 36 of value (byte) 33// Fill 3 of value (byte) -19// Fill 20 of value (byte) -19// Fill 44 of value (byte) -19// Fill 18 of value (byte) -19// Fill 13 of value (byte) 33// Fill 12 of value (byte) -19// Fill 66 of value (byte) -19// Fill 4 of value (byte) -87// Fill 28 of value (byte) -19// Fill 55 of value (byte) 33// Fill 38 of value (byte) -19// Fill 7 of value (byte) 33// Fill 10 of value (byte) 33// Fill 17 of value (byte) -87// Fill 23 of value (byte) -87// Fill 3 of value (byte) -87// Fill 11 of value (byte) 33// Fill 27 of value (byte) -19// Fill 5 of value (byte) 33// Fill 26 of value (byte) -19// Fill 10 of value (byte) -19// Fill 8 of value (byte) -87// Fill 10 of value (byte) -87// Fill 6 of value (byte) 33// Fill 71 of value (byte) -19// Fill 5 of value (byte) -19// Fill 15 of value (byte) -19// Fill 4 of value (byte) -19// Fill 15 of value (byte) -87// Fill 519 of value (byte) 33// Fill 16 of value (byte) -87// Fill 17 of value (byte) 33// Fill 22 of value (byte) -19// Fill 7 of value (byte) -87// Fill 16 of value (byte) 33// Fill 6 of value (byte) -19// Fill 5 of value (byte) -87// Fill 12 of value (byte) -87// Fill 12 of value (byte) 33// Fill 6 of value (byte) -87// Fill 15 of value (byte) 33// Fill 9 of value (byte) -87// Fill 16 of value (byte) -19// Fill 145 of value (byte) 33// Fill 46 of value (byte) -19// Fill 39 of value (byte) 33// Fill 62 of value (byte) 33// Fill 33 of value (byte) -19// Fill 20 of value (byte) -87// Fill 21 of value (byte) -87// Fill 230 of value (byte) 33// Fill 39 of value (byte) -19// Fill 41 of value (byte) 33// Fill 40 of value (byte) 33// Fill 3078 of value (byte) 33// Fill 156 of value (byte) -19// Fill 90 of value (byte) -19// Fill 13 of value (byte) -19// Fill 211 of value (byte) 33// Fill 13 of value (byte) -87// Fill 68 of value (byte) 33// Fill 81 of value (byte) 33// Fill 3714 of value (byte) 33// Fill 25 of value (byte) 33// Fill 9 of value (byte) -19// Fill 84 of value (byte) -19// Fill 40 of value (byte) -19// Fill 7379 of value (byte) 33// Fill 20902 of value (byte) -19// Fill 3162 of value (byte) 33// Fill 11172 of value (byte) -19// Fill 92 of value (byte) 33// Fill 8190 of value (byte) 33// trim(String):String// class XMLChar/* modifies android:name attributes and xml tags which are old class names ... */Map<String,String> DEOBF_MAP, ...;getNewClassName(...)String oldNameimport ParserConfigurationExceptionDocumentBuilderFactory secureDbf, ...;XmlSecurity.classsetFeature(...)setXIncludeAware(...)setExpandEntityReferences(...)/** Original source code can be found ... */EntryConfig.classshort mcc, ...;short mnc, ...;...[] language, ...;...[] region, ...;byte orientation, ...;byte touchscreen, ...;int density, ...;byte keyboard, ...;byte navigation, ...;byte inputFlags, ...;short screenWidth, ...;short screenHeight, ...;short sdkVersion, ...;byte screenLayout, ...;byte uiMode, ...;short smallestScreenWidthDp, ...;short screenWidthDp, ...;short screenHeightDp, ...;...[] localeScript, ...;...[] localeVariant, ...;byte screenLayout2, ...;byte colorMode, ...;boolean isInvalid, ...;String mQualifiers, ...;localeScript.lengthlocaleVariant.lengththis.mccthis.mncthis.languagethis.orientationthis.touchscreenthis.densitythis.keyboardthis.navigationthis.inputFlagsthis.screenWidththis.screenHeightthis.sdkVersionthis.screenLayoutthis.uiModethis.smallestScreenWidthDpthis.screenWidthDpthis.screenHeightDpthis.localeScriptthis.localeVariantthis.screenLayout2this.colorModethis.isInvalidgenerateQualifiers(...)StringBuilder retgetLocaleString(...)getNaturalSdkVersionRequirement(...)region.lengthtoUpper(...)EntryConfig otherthis.mQualifiersother.mQualifiersint hashint sErrCounter, ...;// but it would be hard right now and this feature is very rarely used.// TODO: Dirty static hack. This counter should be a part of ResPackage,byte SDK_BASE, ...;byte SDK_BASE_1_1, ...;byte SDK_CUPCAKE, ...;byte SDK_DONUT, ...;byte SDK_ECLAIR, ...;byte SDK_ECLAIR_0_1, ...;byte SDK_ECLAIR_MR1, ...;byte SDK_FROYO, ...;byte SDK_GINGERBREAD, ...;byte SDK_GINGERBREAD_MR1, ...;byte SDK_HONEYCOMB, ...;byte SDK_HONEYCOMB_MR1, ...;byte SDK_HONEYCOMB_MR2, ...;byte SDK_ICE_CREAM_SANDWICH, ...;byte SDK_ICE_CREAM_SANDWICH_MR1, ...;byte SDK_JELLY_BEAN, ...;byte SDK_JELLY_BEAN_MR1, ...;byte SDK_JELLY_BEAN_MR2, ...;byte SDK_KITKAT, ...;byte SDK_LOLLIPOP, ...;byte SDK_LOLLIPOP_MR1, ...;byte SDK_MNC, ...;byte SDK_NOUGAT, ...;byte SDK_NOUGAT_MR1, ...;byte SDK_OREO, ...;byte SDK_OREO_MR1, ...;byte SDK_P, ...;byte ORIENTATION_ANY, ...;byte ORIENTATION_PORT, ...;byte ORIENTATION_LAND, ...;byte ORIENTATION_SQUARE, ...;byte TOUCHSCREEN_ANY, ...;byte TOUCHSCREEN_NOTOUCH, ...;byte TOUCHSCREEN_STYLUS, ...;byte TOUCHSCREEN_FINGER, ...;int DENSITY_DEFAULT, ...;int DENSITY_LOW, ...;int DENSITY_MEDIUM, ...;int DENSITY_400, ...;int DENSITY_TV, ...;int DENSITY_HIGH, ...;int DENSITY_XHIGH, ...;int DENSITY_XXHIGH, ...;int DENSITY_XXXHIGH, ...;int DENSITY_ANY, ...;int DENSITY_NONE, ...;int MNC_ZERO, ...;short MASK_LAYOUTDIR, ...;short SCREENLAYOUT_LAYOUTDIR_ANY, ...;short SCREENLAYOUT_LAYOUTDIR_LTR, ...;short SCREENLAYOUT_LAYOUTDIR_RTL, ...;short SCREENLAYOUT_LAYOUTDIR_SHIFT, ...;short MASK_SCREENROUND, ...;short SCREENLAYOUT_ROUND_ANY, ...;short SCREENLAYOUT_ROUND_NO, ...;short SCREENLAYOUT_ROUND_YES, ...;byte KEYBOARD_ANY, ...;byte KEYBOARD_NOKEYS, ...;byte KEYBOARD_QWERTY, ...;byte KEYBOARD_12KEY, ...;byte NAVIGATION_ANY, ...;byte NAVIGATION_NONAV, ...;byte NAVIGATION_DPAD, ...;byte NAVIGATION_TRACKBALL, ...;byte NAVIGATION_WHEEL, ...;byte MASK_KEYSHIDDEN, ...;byte KEYSHIDDEN_ANY, ...;byte KEYSHIDDEN_NO, ...;byte KEYSHIDDEN_YES, ...;byte KEYSHIDDEN_SOFT, ...;byte MASK_NAVHIDDEN, ...;byte NAVHIDDEN_ANY, ...;byte NAVHIDDEN_NO, ...;byte NAVHIDDEN_YES, ...;byte MASK_SCREENSIZE, ...;byte SCREENSIZE_ANY, ...;byte SCREENSIZE_SMALL, ...;byte SCREENSIZE_NORMAL, ...;byte SCREENSIZE_LARGE, ...;byte SCREENSIZE_XLARGE, ...;byte MASK_SCREENLONG, ...;byte SCREENLONG_ANY, ...;byte SCREENLONG_NO, ...;byte SCREENLONG_YES, ...;byte MASK_UI_MODE_TYPE, ...;byte UI_MODE_TYPE_ANY, ...;byte UI_MODE_TYPE_NORMAL, ...;byte UI_MODE_TYPE_DESK, ...;byte UI_MODE_TYPE_CAR, ...;byte UI_MODE_TYPE_TELEVISION, ...;byte UI_MODE_TYPE_APPLIANCE, ...;byte UI_MODE_TYPE_WATCH, ...;byte UI_MODE_TYPE_VR_HEADSET, ...;byte UI_MODE_TYPE_GODZILLAUI, ...;// start - miuibyte UI_MODE_TYPE_SMALLUI, ...;byte UI_MODE_TYPE_MEDIUMUI, ...;byte UI_MODE_TYPE_LARGEUI, ...;byte UI_MODE_TYPE_HUGEUI, ...;byte MASK_UI_MODE_NIGHT, ...;// end - miuibyte UI_MODE_NIGHT_ANY, ...;byte UI_MODE_NIGHT_NO, ...;byte UI_MODE_NIGHT_YES, ...;byte COLOR_HDR_MASK, ...;byte COLOR_HDR_NO, ...;byte COLOR_HDR_SHIFT, ...;byte COLOR_HDR_UNDEFINED, ...;byte COLOR_HDR_YES, ...;byte COLOR_UNDEFINED, ...;byte COLOR_WIDE_UNDEFINED, ...;byte COLOR_WIDE_NO, ...;byte COLOR_WIDE_YES, ...;byte COLOR_WIDE_MASK, ...;/** Copyright (C) 2018 Ryszard Winiewski <brut.alll@gmail.com> ... */// check for old style non BCP47 tags// allows values-xx-rXX, values-xx, values-xxx-rXX// denies values-xxx, anything else// BCP47// early return, no language or regionint nameRef, ...;RawValue rawValue, ...;this.nameRefthis.rawValueint dataType, ...;int data, ...;String pkgName, ...;String typeName, ...;String keyName, ...;String config, ...;int parentRef, ...;RawValue simpleValue, ...;List<RawNamedValue> namedValues, ...;this.pkgNamethis.typeNamethis.keyNamethis.configResourceEntry copycopy.parentRefthis.parentRefcopy.simpleValuethis.simpleValuecopy.namedValuesthis.namedValuesimport NumberFormatimport ParserConstantsValuesParser.classMap<Integer,String> androidResMap, ...;Map<Integer,String> resMap, ...;this.stringsthis.resMaploadAndroidResMap(...)RawValue simpleValueList<RawNamedValue> namedValuesList<String> strListfloatToString(...)String riString androidRidecodeComplex(...)int refdouble valueint unitTypeString unitdoubleToString(...)NumberFormat ffloor(...)isInfinite(...)setMaximumFractionDigits(...)setMinimumIntegerDigits(...)// remove trailing zeroes/** Indicates a test which is known to fail. ... */ElementType.METHODimport Methodimport AfterTestExecutionCallbackimport ExtensionContextimport TestExecutionExceptionHandlernew HashSet<Method>(...)Set<Method> knownFailedMethods, ...;isNotYetImplemented(...)getTestMethod(...)getExecutionException(...)new AssertionError(...)getTestClass(...)NotYetImplemented.classimport static FileUtils.toFileJadxArgsValidatorOutDirsTest.classsetOutDirs(...)checkOutDirs(...)String inputFileBasemakeArgs(...)import Matchersimport static Matchers.notNullValueFile sampleApkgetFileFromSampleDir(...)getCode(...)hasSize(...)String TEST_SAMPLES_DIR, ...;JadxDecompilerTest.classString pathStrgetFile(...)notNullValue(...)// test simple apk loading// test class print// TODO add more testsimport static NameMapper.isValidIdentifierimport static NameMapper.removeInvalidCharsimport static NameMapper.removeInvalidCharsMiddleimport static Assertions.assertSameAccessInfo accessInfoAccessInfo resultassertSame(...)ArgTypeTest.classArgType firstArgType secondArgType wildcardArgType[] genericTypesArgType baseArgType genericInnerArgType genericInner2import static ArgType.STRINGimport static ArgType.arrayimport static ArgType.genericimport static ArgType.genericTypeimport static ArgType.objectArgType listClsMap<ArgType,ArgType> typeMapsingletonMap(...)replaceTypeVar(...)ArgType resultTypeas(...)import ExtendWithimport NotYetImplementedExtensionimport static ArgType.BOOLEANimport static ArgType.BYTEimport static ArgType.CHARimport static ArgType.CLASSimport static ArgType.EXCEPTIONimport static ArgType.INTimport static ArgType.NARROWimport static ArgType.NARROW_INTEGRALimport static ArgType.OBJECTimport static ArgType.SHORTimport static ArgType.THROWABLEimport static ArgType.UNKNOWNimport static ArgType.UNKNOWN_ARRAYimport static ArgType.UNKNOWN_OBJECTimport static ArgType.wildcardNotYetImplementedExtension.classTypeCompareTest.classTypeCompare compare, ...;firstIsNarrow(...)ArgType integerTypeArgType wildClassArgType mapClsArgType setClsArgType keyTypeArgType valueTypeArgType mapGenericArgType setGenericArgType setWildcardArgType clsWildcardArgType clsExtendedWildcardWildcardBound.EXTENDSArgType listWildcardArgType collWildcardArgType collSuperWildcardWildcardBound.SUPERArgType vTypeArgType rTypeArgType tTypeArgType tStringTypeArgType tObjTypeArgType npeTypeArgType hashMapTypeArgType innerEntrySetTypeArgType firstInstanceArgType secondInstance// TODO implement compare for wildcard with bounds// check clsp graph// T extends Exception// target checksimport BeforeAllimport static Matchers.hasSizeTypeUtilsTest.classList<ArgType> classGenericsArgType genericArgType resultArgType expected// check classpath graph// prepare input// replaceMap<Integer,String> androidResMapimport InvocationTargetExceptionimport Modifierimport ExecutionExceptionimport Futureimport TimeoutExceptionimport AfterEachimport JadxInternalAccessimport DynamicCompilerimport StaticCompilerimport TestUtilsimport static FileUtils.addFileToJarimport static StringUtils.leftPadimport static StringUtils.rightPadimport static Matchers.containsStringimport static Matchers.emptyimport static Matchers.notimport static Assertions.assertFalseimport static Assertions.assertNotNullimport static Assertions.failString TEST_DIRECTORY, ...;String TEST_DIRECTORY2, ...;String OUT_DIR, ...;String CHECK_METHOD_NAME, ...;/** Run auto check method if defined: ... */boolean deleteTmpFiles, ...;boolean withDebugInfo, ...;boolean unloadCls, ...;boolean compile, ...;boolean useEclipseCompiler, ...;boolean allowWarnInCode, ...;boolean printLineNumbers, ...;boolean printSmali, ...;DynamicCompiler dynamicCompiler, ...;JadxDecompiler jadxDecompiler, ...;this.deleteTmpFilesthis.unloadClsthis.withDebugInfothis.compilethis.useEclipseCompilerFile jargetJarForClass(...)getClassNodeFromFiles(...)fail(...)decompileAndCheck(...)JadxDecompiler dinsertResources(...)printCodeWithLineNumbers(...)printSmali(...)runChecks(...)checkCode(...)runAutoCheck(...)int curLineString lineNumStrleftPad(...)rightPad(...)assertFalse(...)hasErrors(...)containsString(...)AttrList<String> commentsAttrString commentClass<?> origClsMethod checkMthClassNotFoundException egetMethod(...)NoSuchMethodException evoid.classgetModifiers(...)limitExecTime(...)new Callable<Object>(...) { ... }getConstructor(...)newSingleThreadExecutor(...)Future<T> futuresubmit(...)TimeUnit.SECONDSTimeoutException excancel(...)rethrow(...)Throwable exshutdownNow(...)new RuntimeException(...)boolean resultnew DynamicCompiler(...)new Class<?>[]assertNotNull(...)List<File> filescompileClass(...)String pathFile tempempty(...)JarOutputStream jonew JarOutputStream(...)addFileToJar(...)createTempFileNoDelete(...)String rootClsNameString javaFileNameList<File> compileFileListPath outTmpnew Predicate<File>(...) { ... }String codedisableCompilation(...)// Use only for debug purposethis.printSmali// needed for post decompile check// enable debug checks// use same value on all systems// run 'check' method from original class// run 'check' method from decompiled class// don't delete on exit// remove classes which are parents for test classString SMALI_TESTS_PROJECT, ...;String SMALI_TESTS_DIR, ...;String SMALI_TESTS_EXT, ...;File smaliFilegetSmaliFile(...)/** Preferred method for one file smali test */getClassNodeFromSmaliWithPkg(...)getTestPkg(...)getTestName(...)getClassNodeFromSmali(...)collectSmaliFiles(...)searchCls(...)loadFromSmaliFiles(...)String smaliFilesDirFile smaliDirgetSmaliDir(...)String[] smaliFileNameslist(...)new FilenameFilter(...) { ... }File pathFromRootimport URIimport SimpleJavaFileObjectCharSequence content, ...;Kind.SOURCE.extensionKind.SOURCEimport SecureClassLoaderimport FileObjectimport ForwardingJavaFileManagerimport JavaFileObjectimport StandardJavaFileManagerimport static JavaFileObject.KindDynamicClassLoader classLoader, ...;new DynamicClassLoader(...)JavaClassObject clsObjectnew JavaClassObject(...)new ConcurrentHashMap<String,JavaClassObject>(...)new ConcurrentHashMap<String,Class<?>>(...)Map<String,JavaClassObject> clsMap, ...;Map<String,Class<?>> clsCache, ...;Class<?> clsreplaceClass(...)findClass(...)loadClass(...)Class<?> cacheClsbyte[] clsBytesdefineClass(...)clsBytes.lengthimport JavaCompilerimport JavaFileManagerimport ToolProviderimport IntegrationTestimport static JavaCompiler.CompilationTaskDynamicCompiler.classList<ClassNode> clsNodeList, ...;JavaFileManager fileManager, ...;this.clsNodeListJavaCompiler compilergetSystemJavaCompiler(...)List<JavaFileObject> jFilesnew ArrayList<JavaFileObject>(...)CompilationTask compilerTaskgetTask(...)new ClassFileManager(...)getStandardFileManager(...)new CharSequenceJavaFileObject(...)Class<?> typeObject instmakeInstance(...)Method reflMthClass<?> decompiledClsgetComponentType(...)ByteArrayOutputStream bos, ...;kind.extensionimport CompilationTaskimport EclipseCompilerList<String> COMMON_ARGS, ...;StandardJavaFileManager fileManagerIterable<? extends JavaFileObject> compilationUnitsgetJavaFileObjectsFromFiles(...)StaticFileManager staticFileManagernew StaticFileManager(...)List<String> optionsCompilationTask taskBoolean resultnew EclipseCompiler(...)outputFiles(...)List<File> files, ...;JavaFileObject.KindJavaFileObject.Kind.CLASSnew ClassFileObject(...)File file, ...;this.fileimport Descriptionimport TypeSafeMatcherint count, ...;String substring, ...;this.countthis.substringappendValue(...)appendText(...)new CountString(...)countString(...)String indentindent(...)CodeWriter.INDENT_STRimport Assertionsnew JadxClassNodeAssertions(...)new JadxCodeAssertions(...)import AbstractObjectAssertimport static JadxAssertions.assertThatJadxClassNodeAssertions.classisNotBlank(...)JadxCodeAssertions codeAssertionsprint(...)import AbstractStringAssertJadxCodeAssertions.classint actualCountfailWithMessage(...)countLine(...)String indentStrcontainsLines(...)containsLine(...)containsOnlyOnce(...)import JavaClassimport static Matchers.greaterThanBaseExternalTest.classgetSamplesDir(...)processAll(...)processByPatterns(...)printErrorReport(...)int processedgreaterThan(...)boolean decompileisMthMatch(...)printMethods(...)isMatch(...)String dashLineMap<Integer,MethodNode> methodsMapint decompiledLineStringBuilder mthCodeint startLinegetCommentLinesCount(...)int bracketsMethodNode mthAtLineMap<Integer,MethodNode> linesMapnew HashMap<Integer,MethodNode>(...)// jadx.saveSources();// stop if next method started// also count brackets for detect method endimport AttributeStorageimport static AFlag.SYNTHETICimport static Matchers.nullValuenew AType<TestAttr>(...)AType<TestAttr> TEST, ...;TestAttr attrnew TestAttr(...)nullValue(...)String JAVA_LANG_EXCEPTION, ...;String JAVA_LANG_THROWABLE, ...;ArgType objExcArgType objThrJadxVisitorsOrderTest.classcheckPassList(...)List<Class<?>> classListnew ArrayList<Class<?>>(...)Set<Class<?>> passClsSetnew HashSet<Class<?>>(...)Class<? extends IDexTreeVisitor> passClassJadxVisitor infoJadxVisitor.classboolean firstOccurrenceString passNameClass<? extends IDexTreeVisitor> clsrunBefore(...)int beforeIndexrunAfter(...)String[] validNamesString validNameisValidFullIdentifier(...)String[] invalidNamesString invalidNameimport static ArgType.outerGenericimport static Collections.emptyListimport static Collections.singletonListimport static Assertions.assertThatExceptionOfTypeimport static Matchers.equalToString objectStrequalTo(...)checkWildcards(...)ArgType expectedTypecheckGenerics(...)List<ArgType> genericsListList<ArgType> expectedListobjs.lengthisThrownBy(...)assertThatExceptionOfType(...)JadxRuntimeException.classnew ThrowingCallable(...) { ... }// nested 'outerGeneric' objectscheckStringUnescape(...)checkCharUnescape(...)checkResStrValueEscape(...)import TemplateFileString resimport static IfCondition.Modeimport static Mode.ANDimport static Mode.COMPAREimport static Mode.NOTimport static Mode.ORimport static IfCondition.mergeimport static IfCondition.notimport static IfCondition.simplifymakeCondition(...)mockArg(...)IfCondition simpIfCondition amakeSimpleCondition(...)IfCondition bmakeNegCondition(...)IfCondition f// 'a != false' => 'a == true'// !(!a) => a// '!(!a || !b)' => 'a && b'// '(!a || !b) && !c' => '!((a && b) || c)'import static JadxMatchers.countStringint BUTTON_01, ...;R.id.BUTTON_01R.idTestRFieldAccess.classimport static JadxMatchers.containsOneint buttonConstValueTestCls.classClassNode idClsFieldNode buttonFieldFieldInitAttr fieldInitAttrInteger buttonValuesetResMap(...)containsOne(...)// unknown R class// check 'R' class// check inner 'id' class// check 'Button' fieldint f, ...;ElementType.FIELDcode(...)import static CoreMatchers.containsStringimport static CoreMatchers.notimport DocumentedMethod errMethod d...[].classMethod maMyAnnotation anew Thread(...)getExceptionTypes(...).lengthgetExceptionTypes(...)getAnnotations(...).lengthannotationType(...)Deprecated.classnum(...)Thread.State.TERMINATEDstate(...)Thread.Stateint a, ...;noDebugInfo(...)Method testgetDeclaredMethod(...)A annotationA.classx(...)enableDeobfuscation(...)// force rename 'value' methodElementType.PARAMETERimport NotYetImplementedint vp, ...;buffer.lengthimport SmaliTestgetClassNodeFromSmaliWithPath(...)// @formatter:on/* Smali Code equivalent: ... */// @formatter:offint instanceField, ...;int staticField, ...;String result, ...;A a, ...;this.a.fthis.anew Vector2(...)int tileX, ...;int tileY, ...;Vector2 targetPos, ...;Vector2 directVect, ...;Vector2 newPos, ...;Random rdint directionfloat hPossqrt(...)directVect.xdirectVect.ytargetPos.xtargetPos.ynewPos.xnewPos.y.../=...float x, ...;float y, ...;this.xthis.yother.xother.yshorts(...)bytes(...)ints(...)longs(...)floats(...)doubles(...)test1(...)test2(...)/* public boolean test1() { ... */TestCls2.classuseEclipseCompiler(...)int ARRAY_SIZE, ...;// replaced constant break filled array creationnew long[]int CONST_INT, ...;getClassNodeFromSmaliFiles(...)...[] bytes, ...;...[] a, ...;...[] b, ...;int[] aint[][] anew int[][]a.lengthimport static CoreMatchers.instanceOfnew float[]new short[]test4(...)instanceOf(...)byte[] inputArrObject result...[] payload, ...;char[] atoChars(...)this.payloadarraycopy(...)bArr.lengthnew Obj(...)TestByte.classmethod(...)new TestByte(...)short[] arrTestShort.classnew TestShort(...)boolean a, ...;boolean b, ...;TestCls3.classTestCls4.class/* private boolean showConsent; ... */byte myByte, ...;short myShort, ...;/* public final class TestComplexIf { ... *//* public void test() { ... */f(...)boolean autoStop, ...;boolean qualityReading, ...;int lastValidRaw, ...;int adataProcess(...)int timeLeftboolean rint SOMETHING, ...;import static JadxMatchers.containsLines/* public static class TestConditions18 { ... */int c, ...;String d, ...;String f, ...;/* public boolean check(Object obj) { ... */Pattern PATTERN, ...;isDigitsOnly(...)new A(...)boolean inRangeTestCls pager, ...;TestCls listView, ...;isUsable(...)hasMore(...)hasRunningLoaders(...)getLoaderManager(...)getLastVisiblePosition(...)showMore(...)// no ternary operatorrunTest(...)String field, ...;String swapField, ...;String subthis.swapFieldtestWrap(...)/** Issue #820 */boolean a0, ...;int a1, ...;int a2, ...;int a3, ...;int a4, ...;int executedCount, ...;boolean finished, ...;int repeatCount, ...;isRun(...)action(...)checkTrue(...)checkFalse(...)/* private Set test(HashMap<String, Object> hashMap) { ... */String a, ...;String b, ...;other.athis.bother.bTestCls othernew TestCls(...)// assertThat(code, containsLines(3, "if (this.b != null ? this.b.equals(other.b) : other.b == null)// {"));// assertThat(code, containsLines(4, "return true;"));// assertThat(code, containsLines(2, "return false;"));/* public class A { ... */int field, ...;int innerField, ...;MethodNode funcMethodNode innerFuncMethodNode innerFunc2MethodNode innerFunc3FieldNode innerFieldint testClassLinecheckLine(...)// check source lines (available only for instructions and methods)// check decompiled linesimport WeakReferenceWeakReference<TestCls> f, ...;// keep at line 18TestCls storenew WeakReference<TestCls>(...)printLineNumbers(...)MethodNode test1MethodNode test2MethodNode test3/** Parameter register reused in variables assign with different types and names ... *//* public static class TestCls { ... */// TODO: don't use current variables naming in tests// rename everythingTestCls.I f, ...;TestCls.IQueue<T> a, ...;Queue<I> b, ...;List<X> c, ...;TestCls.I.XTestCls<>.class/* @file:JvmName("TestKotlinMetadata") ... */prepareArgs(...)a(...)satisfies(...)extracting(...)new Function<ClassNode,MethodNode>(...) { ... }new Function<MethodNode,MethodOverrideAttr>(...) { ... }new Consumer<MethodOverrideAttr>(...) { ... }// disable rename by length// disable all renaming options/* public enum TestEnumObfuscated { ... */TestCls E0, ...;TestCls E1, ...;TestCls E2, ...;TestCls E3, ...;TestCls E4, ...;TestCls E5, ...;TestCls E6, ...;TestCls E7, ...;TestCls E8, ...;TestCls E9, ...;TestCls E10, ...;TestCls E11, ...;TestCls E12, ...;TestCls E13, ...;TestCls E14, ...;TestCls E15, ...;TestCls E16, ...;TestCls E17, ...;TestCls E18, ...;TestCls E19, ...;TestCls E20, ...;TestCls E21, ...;TestCls E22, ...;TestCls E23, ...;TestCls E24, ...;TestCls E25, ...;TestCls E26, ...;TestCls E27, ...;TestCls E28, ...;TestCls E29, ...;TestCls E30, ...;TestCls E31, ...;TestCls E32, ...;TestCls E33, ...;TestCls E34, ...;TestCls E35, ...;TestCls E36, ...;TestCls E37, ...;TestCls E38, ...;TestCls E39, ...;TestCls E40, ...;TestCls E41, ...;TestCls E42, ...;TestCls E43, ...;TestCls E44, ...;TestCls E45, ...;TestCls E46, ...;TestCls E47, ...;TestCls E48, ...;TestCls E49, ...;TestCls E50, ...;TestCls E51, ...;TestCls E52, ...;TestCls E53, ...;TestCls E54, ...;TestCls E55, ...;TestCls E56, ...;TestCls E57, ...;TestCls E58, ...;TestCls E59, ...;TestCls E60, ...;TestCls E61, ...;TestCls E62, ...;TestCls E63, ...;TestCls E64, ...;TestCls E65, ...;TestCls E66, ...;TestCls E67, ...;TestCls E68, ...;TestCls E69, ...;TestCls E70, ...;TestCls E71, ...;TestCls E72, ...;TestCls E73, ...;TestCls E74, ...;TestCls E75, ...;TestCls E76, ...;TestCls E77, ...;TestCls E78, ...;TestCls E79, ...;TestCls E80, ...;TestCls E81, ...;TestCls E82, ...;TestCls E83, ...;TestCls E84, ...;TestCls E85, ...;TestCls E86, ...;TestCls E87, ...;TestCls E88, ...;TestCls E89, ...;TestCls E90, ...;TestCls E91, ...;TestCls E92, ...;TestCls E93, ...;TestCls E94, ...;TestCls E95, ...;TestCls E96, ...;TestCls E97, ...;TestCls E98, ...;TestCls E99, ...;TestCls E100, ...;int CONST, ...;/** Match the length of the $VALUES array. */new Direction(...)Direction NORTH, ...;Direction SOUTH, ...;Direction EAST, ...;Direction WEST, ...;new Singleton(...)Singleton INSTANCE, ...;import JadxMatchersnew Operation(...) { ... }Operation PLUS, ...;Operation MINUS, ...;removeLineComments(...)import static DoubleOperations.DIVIDEimport static DoubleOperations.TIMESnew DoubleOperations(...) { ... }DoubleOperations TIMES, ...;DoubleOperations DIVIDE, ...;String op, ...;int three, ...;new Numbers(...)Numbers ONE, ...;Numbers TWO, ...;Numbers THREE, ...;Numbers FOUR, ...;Numbers.ONENumbers.THREENumbers.FOUR// assertThat(code, containsOne("THREE(three)"));// assertThat(code, containsOne("assertTrue(Numbers.ONE.getNum() == 1);"));new ResType(...)ResType CODE, ...;ResType MANIFEST, ...;ResType XML, ...;ResType ARSC, ...;ResType FONT, ...;ResType IMG, ...;ResType LIB, ...;ResType UNKNOWN, ...;ResType.CODE// assertThat(code, not(containsString("private ResType")));getClassNodeFromSmaliWithClsName(...)Numbers ZERO, ...;int n, ...;this.ngetN(...)TestCls.Numbers.ZEROTestCls.NumbersTestCls.Numbers.ONENumbers.ZEROnew Types(...)new ArrayList<Types>(...)Types INT, ...;Types FLOAT, ...;Types LONG, ...;Types DOUBLE, ...;Types OBJECT, ...;Types ARRAY, ...;Set<Types> primitives, ...;List<Types> references, ...;Types.INTgetPrimitives(...)Types.referencesint C1, ...;int C2, ...;int C4, ...;String S, ...;NumString.ONENumString.TWObyte num, ...;NumString str, ...;new NumString(...)NumString ONE, ...;NumString TWO, ...;Numbers.NumString.ONEgetNumStr(...)Numbers.NumStringnew Count(...)Count ONE, ...;Count TWO, ...;Count THREE, ...;testEnum(...)Count.ONECount.TWOCount.THREETestSwitchOverEnum.classnew Animal(...)Animal CAT, ...;Animal DOG, ...;Animal.DOGTestSwitchOverEnum2.classsetFallback(...)/* private int x; ... *//* Incorrect class signature, super class is equals to this class: <T:Ljava/lang/Object;>Lgenerics/TestClassSignature<TT;>; */allowWarnInCode(...)T n, ...;intValue(...)import ReferenceQueueObject id, ...;Map<Object,ItemReference<V>> items, ...;WeakReference<V> refthis.itemsClass<?>[] aA aI ideclare(...)// TODO: @Override missing for class C// assertThat(code, countString(4, "@Override"));SuperClass<>.ToImportSuperClass<>.classSuperClass<>.ToImport.classSuperClass<>.NotToImport.classSuperClass<>.NotToImportA<String> anew A<String>(...)A<String>.B<Exception>B<Exception> bnew B<Exception>(...)A<String>.C<>C<> cnew C(...)new A<Set<String>>(...)D dnew D(...)new E(...)A<>.classA<>.B<>.classA<>.B<>A<>.C<>.classA<>.C<>/* public class TestGetterInlineNegative { ... */testRun(...)long inanoTime(...)/* public void onViewCreated(View view, @Nullable Bundle bundle) { ... */String SERVER_ERR, ...;String NOT_FOUND, ...;String LIST_TAG, ...;String TEMP_TAG, ...;String MIN_TAG, ...;String MAX_TAG, ...;String MILLIS_TAG, ...;String WEATHER_TAG, ...;String DESC_TAG, ...;List<Day> reportListnew ArrayList<Day>(...)JSONObject jsonObjnew JSONObject(...)JSONArray daysgetJSONArray(...)JSONObject cgetJSONObject(...)long millisgetLong(...)JSONObject tempString maxString minJSONArray weatherString weatherDescDay dnew Day(...)setMilis(...)setMinTmp(...)setMaxTmp(...)setWeatherDesc(...)JSONException e/* package inline; ... */ClassNode aClsClassNode bClsClassNode cCls// TODO: update dependencies?// assertThat(aCls.getDependencies()).contains(cCls);// assertThat(cCls.getUsedIn()).contains(aCls);func(...)// assertThat(code, containsString("return f;"));// assertThat(code, containsString("return func();"));// Temporary solutionTestCls.thisTestCls.superinvokeSuperCall(...)invokeCall(...)TestSyntheticInline2.class// strange java compiler bug// Base class in unknownimport FilenameFilterString[] filesfiles.lengthRandom randomint a2int a3new A(...) { ... }nextDouble(...)TestAnonymousClass10.TestClslong lnextLong(...)print2(...)print3(...)BasicAbstract outer, ...;BasicAbstract inner, ...;new BasicAbstract(...) { ... }new TestCls(...) { ... }/* public class OuterCls implements Runnable { ... */// remove block commentsnew Thread(...) { ... }Something anew Something(...) { ... }Inner.thisdouble d, ...;start(...)p(...)int r, ...;Inner.this.fInner.this.rInner innernew Inner(...)inner.finner.rimport static Matchers.sameInstancenew HashMap<String,TestCls>(...)Map<String,TestCls> map, ...;TestCls clsint listSizeIterator<TestCls> iteratornew Iterator<TestCls>(...) { ... }int counter, ...;cls.anew Iterable<TestCls>(...) { ... }TestCls vIterable<TestCls> itTestCls nextv.asameInstance(...)next.aimport FutureTaskCallable<String> c, ...;new FutureTask<String>(...) { ... }this.cString c, ...;setC(...)setD(...)TestInner2.classimport Timerimport TimerTaskschedule(...)new Timer(...)new TerminateTask(...)new C(...).cString i0, ...;String i1, ...;String i2, ...;TestCls.this.i0I0.this.i0I0.thisI0.this.i1I1.this.i0I1.thisI1.this.i1I1.this.i2i(...)new I1(...)new I0(...)/* public class TestCls { ... */// and must compilemth(...)TestInnerClassSyntheticConstructor.class// must compile, no usage of removed synthetic empty class/** Issue: https://github.com/skylot/jadx/issues/336 *//* private class MyAsync extends AsyncTask<Uri, Uri, List<Uri>> { ... */C.FLOAT_CONSTfloat FLOAT_CONST, ...;C.INT_CONSTint INT_CONST, ...;C2.INT_CONST// .containsOne("@A(C.INT_CONST)") // TODO: remove brackets for single element/** Issue: https://github.com/skylot/jadx/issues/397 */outerMethod(...)X.classtest3(...)/** Test cast for 'unknown' but overloaded method *//* public boolean test() { ... */new B(...)B b, ...;// not A.a()A is, ...;String[] typesString[] keysC pkgstrs(...)String TAG, ...;exc(...)log(...)TestSuperInvoke.class// negative caseboolean b1, ...;boolean IS_VALID, ...;// TODO: .containsOne("b1 && isValid(\"test\")");new Supplier<Exception>(...) { ... }RuntimeException.classnew Function<String,Integer>(...) { ... }call1(...)call2(...)new Function<Integer,String>(...) { ... }testMthRef(...)testMthRef2(...)// .containsOne("return Object::toString;") // TODOtest4a(...)test5(...)int sumString t/** Issue #977 */// no exception// expectedPoint tiletile.yint x, ...;int y, ...;Map<String,Point> mapnew HashMap<String,Point>(...)new Point(...)this.f// assertThat(code, containsOne("a[i]++;"));import static Matchers.anyOffuncB(...)funcC(...)sleep(...)anyOf(...)StringBuilder builder, ...;boolean tryMkdirFile ffprt(...)// end of writeMorewriteMore(...)// @Test// On first error, try creating the base dirs.// end of while true, loop to allow retry of fos.write after mkdir...[...].lengthint[][] testArrayIterator<String> it, ...;this.it// 'return null' worksint atint endAtnew boolean[][]...[] occupied, ...;boolean placingStone, ...;int[] extraArrayextraArray.lengthint tXint tYnew File[]Authorization authgetAuthorizations(...)getToken(...)Set<T> a, ...;Set<T> b, ...;Set<T> setT s// TODO move return outside 'if'Object itemIterator<String> iterator, ...;SomeCls filter, ...;String nextString filteredString otherStrString s1String s2f1(...)f2(...)int tmptestFor(...)int z...[] lowercases, ...;char[] cchar c1char c2new HashMap<Integer,MyItem>(...)int idx, ...;Map<Integer,MyItem> mCache, ...;this.mCacheitems.lengthMyItem existingItem...[...].idxexistingItem.name...[...].nameimport static Matchers.emptyString/* public class A {} ... */long namesCountList<String> namescontainsInAnyOrder(...)emptyString(...)/* public class do- {} ... */commonChecks(...)//@formatter:on/* ----------------------------------------------------------- ... *///@formatter:offList<ClassNode> clsListClassNode firstA// expect field to be renamedimport LiveVarAnalysis/* public class do { ... *//* package do.if; ... */Bug(...)new Bug(...)m(...)int intField, ...;/* private SomeObject test(double r23, double r25, SomeObject r27) { ... */Boolean vtestInt(...)testBoolean(...)testByte(...)parseByte(...)testShort(...)parseShort(...)testChar(...)testLong(...)testConstInline(...)// don't mind weird comparisons// need to get primitive without using boxing or literal// otherwise will get same result after decompilation// checks for 'check' methodnew HashMap<String,Pair<Long,String>>(...)F first, ...;S second, ...;Map<String,Pair<Long,String>> cache, ...;Pair<Long,String> pairthis.cachepair.firstString s, ...;// empty/** Test duplicate 'check-cast' instruction produced because of bug in javac: ... */dontUnloadClass(...)Random.classList<String> s, ...;int i, ...;BasicAbstract x, ...;super.fieldint other, ...;new B(...).fieldnew C(...).fieldnew C(...).othernew D(...).field// IPUT for A.field// IPUT for C.field not A.field !!!import MalformedURLExceptionnew URL(...)MalformedURLException eURL A, ...;new URL[]...[] A, ...;// Note: follow code will not be extracted:// a = new String[]{new String("a")};/* public Cls.InnerCls field; ... */float[] fa// skipException exception, ...;b(...)Exception exc/** Issue #858. ... *//* public class TestInsnsBeforeSuper2 extends java.lang.Exception { ... */new HashMap<ClassLoader,Map<String,Creator<?>>>(...)Map<ClassLoader,Map<String,Creator<?>>> M_CREATORS, ...;Parcelable.Creator<?>Parcelable.Creator<T>Creator<T> creatorMap<String,Creator<?>> mapnew HashMap<String,Creator<?>>(...)Class<?> cParcelable.Creator<>IllegalAccessException ee(...)ClassCastException eNoSuchFieldException eParcelable.ClassLoaderCreator<?>createFromParcel(...)Parcelable.ClassLoaderCreator<T>// TODO: add additional checksimport Propertiesimport CountDownLatchnew CountDownLatch(...)String PROPERTIES_FILE, ...;CountDownLatch mInitializedLatch, ...;int mC2KServerPort, ...;String mSuplServerHost, ...;int mSuplServerPort, ...;String mC2KServerHost, ...;Properties mPropertiesnew Properties(...)Thread mThreadFileInputStream streamString portStringawait(...)String prefix, ...;JadxArgs.OutputFormatEnum.JSONs(...)// expected no errorsmethod2(...)// argument type not changed to String// cast not eliminatedObject retint abcint a00, ...;C a00, ...;super.a00(...).a00B bsub(...)String S1, ...;String S2, ...;String S3, ...;String S4, ...;String S5, ...;String s6, ...;MyException.class/** Test the StringBuilder simplification part of {@link SimplifyVisitor} ... */TestStringBuilderElimination2.TestCls1.classTestStringBuilderElimination2.TestCls1String sInitboolean bTestStringBuilderElimination2.TestCls2.classTestStringBuilderElimination2.TestCls2/** Simplified version of org.apache.commons.lang3.StringUtils.reverse() */TestClsStringUtilsReverse.classTestClsChainWithDelete.class// A chain with non-final variables// a chain we can't simplifyupdateF(...)TestClsNegative.classK k, ...;V v, ...;TestStringConcatWithoutResult.classboolean LOG_DEBUG, ...;String tag, ...;TestCls5.classbyte b, ...;TestClsNegative2.class/* public class Test { ... */a.str// everything is 'A' :)A AA(...)A.AA A, ...;// ignore checkstyleremoveBlockComments(...)// remove comment about inlined classString CONST, ...;List<String> list, ...;A ONE, ...;A TWO, ...;boolean isLongtouchable, ...;boolean isMultiTouchZoom, ...;boolean isCanZoomIn, ...;boolean isCanZoomOut, ...;boolean isScrolling, ...;float multiTouchZoomOldDist, ...;this.isLongtouchablethis.isMultiTouchZoomfloat distthis.multiTouchZoomOldDistfloat scalethis.isCanZoomInthis.isCanZoomOutthis.isScrolling// assertThat(code, countString(4, "break;"));// assertThat(code, countString(2, "return;"));// TODO: remove redundant break and returns// TODO finish break with label from switch// fallthrough// code correctness checks done in 'check' method...>>=...int CONST_ABC, ...;int CONST_CDE, ...;int CONST_CDE_PRIVATE, ...;TestCls.Inner.classTestCls.Inner// case 5: removed// TODO: implement 'invoke-custom' support// assertThat(catchThrowable(() -> test(1)))// .isInstanceOf(IllegalStateException.class).hasMessageContaining("1");// assertThat(catchThrowable(() -> test(3)))// .isInstanceOf(IllegalStateException.class).hasMessageContaining("Other");// no break;// assertThat(code, countString(3, "break;"));// TODO: remove redundant break/* public final void test() { ... */boolean f, ...;Object o, ...;this.othis.i/* public boolean test(int i) { ... */// ???String DISPLAY_NAME, ...;Cursor cursorString[] projectionint columnIndexgetColumnIndexOrThrow(...)query(...)moveToFirst(...)import ByteArrayInputStreamnew Result(...)closeQuietly(...)int mCode, ...;new ByteArrayInputStream(...)int result, ...;boolean success// java compiler optimization: 'success' variable completely removed and no code duplication:/* public String test() { ... */File outputimport ProviderExceptionimport DateTimeExceptionRuntimeException eimport ConstructorReflectiveOperationException e// TODO: store vararg attribute for methods from classpath// assertThat(code, containsOne("constructor.newInstance();"));InterruptedException ignoredException ignoredInputStream bisIOException ignore/** Issue #62. */TestClass.classObject OBJ, ...;wait(...)import static Matchers.isAMyException e, ...;new MyException(...)MyException myExcthis.eisA(...)// assertThat(code, containsOne("this.f = true;")); // TODO: fix registers in duplicated code/* public static String test(Context context, int i) { ... */parents.lengthOutputStream outputStreamIOException ignoredC cList<E> listnew ArrayList<E>(...)toNext(...)AssertionError e// passFileOutputStream output// Ignoredimport ScannerScanner scanneruseDelimiter(...)new Scanner(...)import static Assertions.assertNullassertNull(...)/* public Exception test() { ... */String catchExcVarName/* private static void test(AutoCloseable closeable) { ... *//** Issue: https://github.com/skylot/jadx/issues/395 *//* private static void test(String s) { ... */Properties field, ...;Properties propertiesException unused/* private static String test(boolean b) { ... */import static Assertions.assertNotEqualsTestCls sevenTestCls sixassertNotEquals(...)/** Issue #962 */boolean publicField, ...;boolean packagePrivateField, ...;boolean protectedField, ...;boolean privateField, ...;(...).publicField(...).protectedField(...).packagePrivateField(...).privateField// cast to 'A' needed only hereT data, ...;// no Integer cast// no String castint passedint failedInner<Object> innernew Inner<Object>(...)overload(...)new ObjIList(...)InheritableThreadLocal<Map<String,String>> inheritableThreadLocal, ...;Map<String,String> mapthis.inheritableThreadLocalMap<>.Entry<K,V>Entry<K,V> entryentry.mValueV mValue, ...;this.mValue/** Issue https://github.com/skylot/jadx/issues/956 */...[] elements, ...;Object[] arrthis.elementsT objnew NullPointerException(...)/* public void test(long j, boolean z) { ... */short shIBase impluseBase(...)useRoot(...)// this move is removed in no-debug byte-code// test 'this' move and constructor invocation on moved register/* Method argument assigned with different types in separate branches */int valWeakReference<T> ref, ...;this.refnew HashMap<Set<?>,List<?>>(...)Set<?> CONST, ...;Map<Set<?>,List<?>> map, ...;List<?> obj/* public Date test() throws Exception { ... *//** Issue 921 (second case) */useInt(...)// replaced with xor in smali test// .containsOne("useInt(!z ? 1 : 0);") // TODO: convert to ternary/** Issue 1002 ... *//* public final <T, K> List<T> test(List<? extends T> list, Set<? extends T> set, Function<? super T, ? extends K> function) { ... */int cmpString testObject obj, ...;this.objmakeObj(...)Runnable runnable, ...;this.runnablemakeRunnable(...)getObj(...)Runnable rTestCls resTestCls somethingTestCls thisVarisNull(...)int field1, ...;int field2, ...;this.field2Object storeThrowable excAbstractTest.classMethod mthAbstractTest testInvocationTargetException eboolean enabled, ...;int i2setEnabled(...)this.enabledtestIfInLoop(...)// assertThat(code, containsOne("i++;"));// assertThat(code, containsOne("if (i == 2) {"));Logger log, ...;/* public static <T> j a(i<? super T> iVar, c<T> cVar) { ... */String used, ...;// and compilableList<Object> listObject oTestEnhancedFor.classimport SwingUtilitiesimport UIManagerimport LogHelperimport JadxSettingsimport JadxSettingsAdapterimport MainWindowimport NLSimport SystemInfoimport LogCollectorJadxGUI.classJadxSettings settingssetLogLevel(...)LogHelper.LogLevelEnum.INFOtryDefaultLookAndFeel(...)setLookAndFeel(...)getSystemLookAndFeelClassName(...)setLocale(...)getLangLocale(...)printSystemInfo(...)invokeLater(...)new MainWindow(...)String defLafSystemInfo.JADX_VERSIONSystemInfo.JAVA_VMSystemInfo.JAVA_VERSystemInfo.OS_NAMESystemInfo.OS_VERSION// overwrite loaded settings by command line argumentsimport ThreadPoolExecutorimport javax.swing.*import JavaPackageimport static FileUtils.toFilesJadxWrapper.classJadxSettings settings, ...;List<Path> openPaths, ...;this.settingsthis.openPathstoFiles(...)Runnable saveThreadPoolExecutor exsetRootDir(...)isTerminating(...)long totalgetTaskCount(...)long donegetCompletedTaskCount(...)setProgress(...)new Consumer<JavaClass>(...) { ... }/** Get the complete list of classes *//** Get all classes that are not excluded by the excluded packages settings */List<String> excludedPackagesgetExcludedPackages(...)new Predicate<JavaClass>(...) { ... }String exclude// TODO: move to CLI and filter classes in JadxDecompilerString excludedPackagesString newExclusionsetExcludedPackages(...)sync(...)join(...)getPackages(...)/** @param */import ProgressPanel/** Class for run tasks in background with progress bar indication. ... */BackgroundExecutor.classMainWindow mainWindow, ...;ProgressPanel progressPane, ...;ThreadPoolExecutor taskQueueExecutor, ...;this.mainWindowthis.progressPanegetProgressPane(...)this.taskQueueExecutormakeTaskQueueExecutor(...)TaskWorker taskWorkernew TaskWorker(...)new SimpleTask(...)IBackgroundTask task, ...;long jobsCount, ...;this.taskaddPropertyChangeListener(...)List<Runnable> jobsscheduleJobs(...)getSettings(...)changeLabel(...)getTitle(...)changeCancelBtnVisible(...)canBeCanceled(...)runInCurrentThread(...)runInExecutor(...)Runnable jobcalcProgress(...)isCancelled(...)ThreadPoolExecutor executorwaitTermination(...)isTerminated(...)changeIndeterminate(...)round(...)setVisible(...)onFinish(...)String title, ...;List<Runnable> jobs, ...;Runnable onFinish, ...;this.titlethis.jobsthis.onFinish// force terminationimport JadxWrapperBackgroundJob.classJadxWrapper wrapper, ...;ThreadPoolExecutor executor, ...;Future<Boolean> future, ...;this.wrapperthis.executorExecutorService shutdownExecutorFutureTask<Boolean> tasknew ShutdownTask(...)new Callable<Boolean>(...) { ... }runJob(...)isDone(...)import JOptionPaneimport SwingWorkerimport CacheObjectimport UiUtilsimport TextSearchIndex/** Deprecated. Use {@link BackgroundExecutor} instead. */BackgroundWorker.classCacheObject cache, ...;TextSearchIndex searchIndexgetTextIndex(...)gc(...)memoryInfo(...)getDecompileJob(...)getIndexJob(...)getSkippedCount(...)str(...)showMessageDialog(...)Future<Boolean> futuregetInfoString(...)getProgress(...)getIncludedClasses(...)addTask(...)import CodeLinesInfoimport CodeUsageInfoimport StringRefIndexJob.classTextSearchIndex indexnew TextSearchIndex(...)CodeUsageInfo usageInfonew CodeUsageInfo(...)getNodeCache(...)setTextIndex(...)setUsageInfo(...)indexResource(...)indexCls(...)getUsageInfo(...)CodeLinesInfo linesInfonew CodeLinesInfo(...)List<StringRef> linessplitLines(...)indexNames(...)isFreeMemoryAvailable(...)indexCode(...)classCodeIndexSkipped(...)import BufferedWriterimport PathTypeAdapternew ArrayList<String[]>(...)JadxProject.classregisterTypeHierarchyAdapter(...)Path.classsingleton(...)int CURRENT_SETTINGS_VERSION, ...;String PROJECT_EXTENSION, ...;Path projectPath, ...;List<Path> filesPath, ...;List<String[]> treeExpansions, ...;boolean saved, ...;boolean initial, ...;int projectVersion, ...;// Don't remove. Used in json serializationthis.projectPathupgradeSettings(...)changed(...)getFilePaths(...)this.filesPathIterator<String[]> itisParentOfExpansion(...)child.lengthparent.lengthString[] arrisAutoSaveProject(...)setProjectPath(...)getProjectPath(...)BufferedWriter writernewBufferedWriter(...)JadxProject projectfromJson(...)project.settingsproject.savedimport java.awt.*import RSyntaxTextAreaimport JadxCLIArgsimport EditorThemeimport FontUtilsimport LangLocaleNoConverter.classNoValidator.classNoValueValidator<>.classCommaParameterSplitter.classnew ArrayList<Path>(...)defaultLocale(...)new HashMap<String,WindowLocation>(...)JFrame.NORMALJadxSettings.classgetFont(...)new RSyntaxTextArea(...)Path USER_HOME, ...;int RECENT_PROJECTS_COUNT, ...;Font DEFAULT_FONT, ...;Set<String> SKIP_FIELDS, ...;Path lastSaveProjectPath, ...;Path lastOpenFilePath, ...;Path lastSaveFilePath, ...;boolean flattenPackage, ...;boolean checkForUpdates, ...;List<Path> recentProjects, ...;String fontStr, ...;String editorThemePath, ...;LangLocale langLocale, ...;boolean autoStartJobs, ...;String excludedPackages, ...;boolean autoSaveProject, ...;boolean showHeapUsageBar, ...;Map<String,WindowLocation> windowPos, ...;int mainWindowExtendedState, ...;boolean codeAreaLineWrap, ...;int srhResourceSkipSize, ...;String srhResourceFileExt, ...;boolean keepCommonDialogOpen, ...;int treeWidth, ...;/** UI setting: the width of the tree showing the classes, resources, ... */int settingsVersion, ...;String cmdSelectClass, ...;JadxSettings jadxSettingsnew JadxSettings(...)fixOnLoad(...)store(...)this.lastOpenFilePathpartialSync(...)new Consumer<JadxSettings>(...) { ... }settings.lastOpenFilePaththis.lastSaveProjectPathsettings.lastSaveProjectPaththis.lastSaveFilePathsettings.lastSaveFilePaththis.flattenPackagesettings.flattenPackagethis.checkForUpdatessettings.recentProjectsWindowLocation posnew WindowLocation(...)getWindowId(...)settings.windowPosint extendedStategetMainWindowExtendedState(...)setExtendedState(...)isContainedInAnyScreen(...)setBounds(...)Rectangle boundsgetX(...)getY(...)GraphicsDevice gdgetScreenDevices(...)getLocalGraphicsEnvironment(...)getDefaultConfiguration(...)this.showHeapUsageBarsettings.showHeapUsageBarthis.excludedPackagesthis.langLocalethis.rawCfgOutputthis.verbosethis.deobfuscationUseSourceNameAsAliasthis.deobfuscationParseKotlinMetadatathis.respectBytecodeAccessModifiersthis.autoStartJobsthis.autoSaveProjectthis.treeWidthsettings.treeWidthJadxSettings.this.treeWidthJadxSettings.thisloadByStr(...)setFont(...)this.fontStrconvertToStr(...)this.logLevelthis.editorThemePaththis.mainWindowExtendedStatesettings.mainWindowExtendedStatethis.codeAreaLineWrapsetDeobfuscationUseSourceNameAsAlias(...)setDeobfuscationParseKotlinMetadata(...)setAutoStartJobs(...)setEditorThemePath(...)getDefaultTheme(...)setLangLocale(...)setRespectBytecodeAccessModifiers(...)getFontName(...)import Rectangleimport Preferencesimport ExclusionStrategyimport FieldAttributesimport InstanceCreatorimport JsonObjectimport JadxGUIimport RectangleTypeAdapterJadxSettingsAdapter.classuserNodeForPackage(...)new ExclusionStrategy(...) { ... }hasModifier(...)JadxSettings.SKIP_FIELDSModifier.PUBLICModifier.TRANSIENTGsonExclude.classRectangle.classsetExclusionStrategies(...)String JADX_GUI_KEY, ...;Preferences PREFS, ...;ExclusionStrategy EXCLUDE_FIELDS, ...;GsonBuilder GSON_BUILDER, ...;String jsonSettingsfromString(...)makeDefault(...)getAsJsonObject(...)toJsonTree(...)populate(...)registerTypeAdapter(...)new InstanceCreator<T>(...) { ... }/** Annotation for specifying fields that should not be be saved/loaded */import Clipboardimport StringSelectionimport ActionEventimport ItemEventimport MouseAdapterimport MouseEventimport ChangeEventimport ChangeListenerimport DocumentEventimport DocumentListenerimport JFontChooserJadxSettingsWindow.classString startSettings, ...;LangLocale prevLang, ...;boolean needReload, ...;this.startSettingsthis.prevLanginitUI(...)setTitle(...)setSize(...)setDefaultCloseOperation(...)setModalityType(...)ModalityType.APPLICATION_MODALsetWindowIcons(...)setLocationRelativeTo(...)JPanel panelnew JPanel(...)JPanel leftPanelJPanel rightPanelJButton saveBtnnew JButton(...)JButton cancelButtonJButton resetBtnJButton copyBtnJPanel buttonPaneContainer contentPanegetContentPane(...)JScrollPane scrollPanenew JScrollPane(...)KeyStroke strokeEscgetKeyStroke(...)InputMap inputMapgetInputMap(...)getRootPane(...)JComponent.WHEN_IN_FOCUSED_WINDOWsetLayout(...)new BoxLayout(...)BoxLayout.LINE_AXISsetBorder(...)createEmptyBorder(...)BoxLayout.PAGE_AXISmakeDeobfuscationGroup(...)makeRenameGroup(...)makeProjectGroup(...)makeEditorGroup(...)makeOtherGroup(...)makeSearchResGroup(...)makeDecompilationGroup(...)addActionListener(...)new ActionListener(...) { ... }enableComponents(...)reOpenFile(...)JOptionPane.INFORMATION_MESSAGEdispose(...)showConfirmDialog(...)JadxSettingsWindow.thisJOptionPane.YES_NO_OPTIONJOptionPane.YES_OPTIONString defaultsloadSettings(...)needReload(...)repaint(...)JsonObject settingsJsonmakeJsonObject(...)String settingsTextClipboard clipboardgetSystemClipboard(...)getDefaultToolkit(...)StringSelection selectionnew StringSelection(...)setContents(...)createHorizontalGlue(...)createRigidArea(...)new Dimension(...)setUnitIncrement(...)getVerticalScrollBar(...)setHorizontalScrollBarPolicy(...)BorderLayout.CENTERBorderLayout.PAGE_ENDsetDefaultButton(...)getActionMap(...)new AbstractAction(...) { ... }Component componentgetComponents(...)JCheckBox deobfOnnew JCheckBox(...)JCheckBox deobfForceSpinnerNumberModel minLenModelnew SpinnerNumberModel(...)JSpinner minLenSpinnernew JSpinner(...)SpinnerNumberModel maxLenModelJSpinner maxLenSpinnerJCheckBox deobfSourceAliasJCheckBox deobfKotlinMetadataSettingsGroup deobfGroupnew SettingsGroup(...)Collection<JComponent> connectedComponentssetSelected(...)addItemListener(...)new ItemListener(...) { ... }getStateChange(...)ItemEvent.SELECTEDaddChangeListener(...)new ChangeListener(...) { ... }isDeobfuscationUseSourceNameAsAlias(...)isDeobfuscationParseKotlinMetadata(...)addRow(...)end(...)enableComponentList(...)JCheckBox renameCaseSensitiveJCheckBox renameValidJCheckBox renamePrintableSettingsGroup groupJadxArgs.RenameEnum.CASEJadxArgs.RenameEnum.VALIDJadxArgs.RenameEnum.PRINTABLEnew Consumer<JComponent>(...) { ... }JCheckBox autoSavesetAutoSaveProject(...)JButton fontBtnEditorTheme[] editorThemesgetAllThemes(...)JComboBox<EditorTheme> themesCbxnew JComboBox<EditorTheme>(...)JLabel fontLabelgetFontLabelStr(...)EditorTheme themegetEditorThemePath(...)setSelectedItem(...)getSelectedIndex(...)EditorTheme editorThemeaddMouseListener(...)new MouseAdapter(...) { ... }JFontChooser fontChoosernew JFontChooser(...)showDialog(...)setSelectedFont(...)JFontChooser.OK_OPTIONFont fontgetSelectedFont(...)setText(...)String fontStyleNameconvertFontStyleToString(...)getStyle(...)JCheckBox fallbackJCheckBox showInconsistentCodeJCheckBox resourceDecodeSpinnerNumberModel spinnerModelJSpinner threadsCountJButton editExcludedPackagesJCheckBox autoStartJobsJCheckBox escapeUnicodeJCheckBox replaceConstsJCheckBox respectBytecodeAccessModifiersJCheckBox useImportsJCheckBox inlineAnonymousJCheckBox fsCaseSensitiveSettingsGroup otherString oldExcludedPackagesshowInputDialog(...)isAutoStartJobs(...)isRespectBytecodeAccessModifiers(...)JComboBox<LangLocale> languageCbxnew JComboBox<LangLocale>(...)getLangLocales(...)JCheckBox updateJCheckBox cfgJCheckBox rawCfgLangLocale localegetSelectedItem(...)isCheckForUpdates(...)setCheckForUpdates(...)isRawCfgOutput(...)setRawCfgOutput(...)int prevSizegetSrhResourceSkipSize(...)String prevExtsgetSrhResourceFileExt(...)SpinnerNumberModel sizeLimitModelJSpinner spinnerJTextField fileExtFieldnew JTextField(...)setSrhResourceSkipSize(...)addDocumentListener(...)getDocument(...)new DocumentListener(...) { ... }setSrhResourceFileExt(...)GridBagConstraints c, ...;int row, ...;createTitledBorder(...)new GridBagLayout(...)new GridBagConstraints(...)c.insetsnew Insets(...)c.weightyJLabel jLabelnew JLabel(...)c.gridysetLabelFor(...)setHorizontalAlignment(...)c.gridxc.gridwidthc.anchorGridBagConstraints.LINE_STARTc.weightxc.fillGridBagConstraints.NONEGridBagConstraints.REMAINDERGridBagConstraints.CENTERGridBagConstraints.HORIZONTALsetToolTipText(...)new PropertyChangeListener(...) { ... }getNewValue(...)createVerticalGlue(...)// remove irrelevant preferencesString windowId, ...;Rectangle bounds, ...;this.windowIdthis.boundsimport Certificateimport Iconimport ImageIconimport ExceptionUtilsimport StringEscapeUtilsimport ApkVerifierimport CertificateManagerApkSignature.classopenIcon(...)ImageIcon CERTIFICATE_ICON, ...;File openFile, ...;String content, ...;File apkFileResourceFile.ZipRefnew ApkSignature(...)this.openFileApkVerifier verifiernew Builder(...)ApkVerifier.BuilderApkVerifier.ResultResult resultverify(...)StringEscapeUtils.BuilderBuilder builderbuilder(...)StringEscapeUtils.ESCAPE_HTML4String warnString sigSuccKeyString sigFailKeyisVerified(...)writeIssues(...)getErrors(...)getV1SchemeSigners(...)isVerifiedUsingV1Scheme(...)V1SchemeSignerInfo signerApkVerifier.Result.V1SchemeSignerInfogetSignatureFileName(...)writeCertificate(...)getCertificate(...)getWarnings(...)getV2SchemeSigners(...)isVerifiedUsingV2Scheme(...)V2SchemeSignerInfo signerApkVerifier.Result.V2SchemeSignerInfogetV3SchemeSigners(...)isVerifiedUsingV3Scheme(...)V3SchemeSignerInfo signerApkVerifier.Result.V3SchemeSignerInfoCertificateManager certMgrnew CertificateManager(...)generateHeader(...)generatePublicKey(...)generateSignature(...)generateFingerprint(...)ApkVerifier.IssueWithParamsList<IssueWithParams> unprotIssuesnew Predicate<IssueWithParams>(...) { ... }getIssue(...)ApkVerifier.Issue.JAR_SIG_UNPROTECTED_ZIP_ENTRYApkVerifier.IssueList<IssueWithParams> remainingIssuesIssueWithParams issuegetParams(...)// Only show the ApkSignature node if an AndroidManifest.xml is present.// Without a manifest the Google ApkVerifier refuses to work.// Unprotected Zip entry issues are very common, handle them separatelyimport JavaNodeJNode jNode, ...;JClass jParent, ...;StringRef line, ...;int lineNum, ...;boolean precise, ...;this.jNodethis.jParentgetJParent(...)this.lineNumgetIcon(...)getJavaNode(...)getRootClass(...)JClass parentmakeLongString(...)CodeNode codeNodecodeNode.jNodethis.preciseimport SyntaxConstantsimport JavaFieldimport JavaMethodImageIcon ICON_CLASS, ...;ImageIcon ICON_CLASS_DEFAULT, ...;ImageIcon ICON_CLASS_PRIVATE, ...;ImageIcon ICON_CLASS_PROTECTED, ...;ImageIcon ICON_INTERFACE, ...;ImageIcon ICON_ENUM, ...;ImageIcon ICON_ANNOTATION, ...;this.loadedreload(...)removeAllChildren(...)new TextNode(...)JClass innerClsnew JClass(...)JavaField fnew JField(...)JavaMethod mnew JMethod(...)SyntaxConstants.SYNTAX_STYLE_JAVAgetAccessInfo(...)import OverlayIconImageIcon ICON_FLD_DEF, ...;ImageIcon ICON_FLD_PRI, ...;ImageIcon ICON_FLD_PRO, ...;ImageIcon ICON_FLD_PUB, ...;ImageIcon ICON_TRANSIENT, ...;ImageIcon ICON_VOLATILE, ...;JavaField field, ...;OverlayIcon iconmakeIcon(...)typeFormat(...)typeFormatHtml(...)typeStr(...)ImageIcon ICON_MTH_DEF, ...;ImageIcon ICON_MTH_PRI, ...;ImageIcon ICON_MTH_PRO, ...;ImageIcon ICON_MTH_PUB, ...;ImageIcon ICON_CONSTRUCTOR, ...;ImageIcon ICON_SYNC, ...;JavaMethod mth, ...;StringBuilder basemakeBaseString(...)import DefaultMutableTreeNode/** Return top level JClass or self if already at top. */SyntaxConstants.SYNTAX_STYLE_NONEJavaNode javaNodeImageIcon PACKAGE_ICON, ...;List<JClass> classes, ...;List<JPackage> innerPackages, ...;isPkgEnabled(...)new Function<JavaClass,JClass>(...) { ... }new ArrayList<JPackage>(...)new ArrayList<JClass>(...)this.innerPackagesnoneMatch(...)isEnabled(...)JPackage pkgJClass clsJResource resNode, ...;String text, ...;this.textthis.resNodeimport ResourceFileContentnew ArrayList<JResource>(...)SyntaxConstants.SYNTAX_STYLE_JAVASCRIPTSyntaxConstants.SYNTAX_STYLE_TYPESCRIPTSyntaxConstants.SYNTAX_STYLE_JSONSyntaxConstants.SYNTAX_STYLE_CSSSyntaxConstants.SYNTAX_STYLE_LESSSyntaxConstants.SYNTAX_STYLE_HTMLSyntaxConstants.SYNTAX_STYLE_XMLSyntaxConstants.SYNTAX_STYLE_YAMLSyntaxConstants.SYNTAX_STYLE_PROPERTIES_FILESyntaxConstants.SYNTAX_STYLE_INISyntaxConstants.SYNTAX_STYLE_SQLImageIcon ROOT_ICON, ...;ImageIcon FOLDER_ICON, ...;ImageIcon FILE_ICON, ...;ImageIcon MANIFEST_ICON, ...;ImageIcon JAVA_ICON, ...;ImageIcon ERROR_ICON, ...;new JResType(...)JResType ROOT, ...;JResType DIR, ...;JResType FILE, ...;List<JResource> files, ...;JResType type, ...;ResourceFile resFile, ...;this.resFileJResType.DIRJResType.ROOTComparator<JResource> typeComparatornew ToIntFunction<JResource>(...) { ... }r.typeComparator<JResource> nameComparatornew Function<JResource,String>(...) { ... }JResource resgetContent(...)ResContainer rcJResType.FILEisSupportedForView(...)loadCurrentSingleRes(...)loadSubNodes(...)new ResourceDecoder<ICodeInfo>(...) { ... }String[] pathString resShortNamepath.lengthResourceFileContent fileContentnew ResourceFileContent(...)ResourceType.XMLaddPath(...)new JResource(...)JResource currentRootgetFiles(...)String fgetResDir(...)JResource resDirJResource fileString syntaxgetSyntaxByExtension(...)getSyntaxName(...)Map<String,String> EXTENSION_TO_FILE_SYNTAX, ...;ResourceType.CODEnew OverlayIcon(...)// fake leaf to force show expand button// real sub nodes will load on expand in loadNode() method// single nodeimport JResTypeboolean flatPackages, ...;List<JResource> resListgetHierarchyResources(...)ApkSignature signaturegetApkSignature(...)new JSources(...)JResource jResJResource rootString splitPathStrquote(...)File.separatorString rfNameJResource curRfJResource subRFgetResourceByName(...)JResource subEnumeration<?> enbreadthFirstEnumeration(...)this.flatPackagesList<Path> pathsgetOpenPaths(...)isFlatPackages(...)new JPackage(...)List<JPackage> rootPkgsgetHierarchyPackages(...)JPackage jPackage/** Convert packages list to hierarchical packages representation ... */Map<String,JPackage> pkgMapnew HashMap<String,JPackage>(...)Set<JPackage> innerPackagesnewSetFromMap(...)new IdentityHashMap<K,V>(...)addPackage(...)List<JPackage> innerPackagesJPackage innerPkgString innerNamesetInnerPackages(...)updateBothNames(...)new Predicate<JPackage>(...) { ... }JPackage replacedString prevPartJPackage prevPkgupdateName(...)// build packages hierarchy// merge packages without classes// remove empty packages// use identity set for collect inner packages// find root packagesimport JavaVariableJClass cls, ...;JavaVariable var, ...;String label, ...;this.labelnew Font(...)Font.BOLDURL logoURLIcon logonew ImageIcon(...)JLabel nameJLabel descJLabel versionString javaVmString javaVerJLabel javaVmLabelJLabel javaVerLabelJPanel textPaneJButton closesetAlignmentX(...)import JNodeimport CodeAreaRSyntaxTextArea textArea, ...;JScrollPane spnew BorderLayout(...)loadCommonSettings(...)getMainWindow(...)getTabbedPane(...)import KeyAdapterimport KeyEventimport WindowAdapterimport WindowEventimport AbstractTableModelimport TableCellRendererimport TableColumnimport TableColumnModelimport SearchContextimport SearchEngineimport BackgroundJobimport BackgroundWorkerimport DecompileJobimport jadx.gui.treemodel.*import AbstractCodeAreaimport JumpPositionCommonSearchDialog.classint RESULTS_PER_PAGE, ...;TabbedPane tabbedPane, ...;Font codeFont, ...;ResultsModel resultsModel, ...;ResultsTable resultsTable, ...;JLabel resultsInfoLabel, ...;JLabel warnLabel, ...;String highlightText, ...;boolean highlightTextCaseInsensitive, ...;boolean highlightTextUseRegex, ...;this.tabbedPanegetCacheObject(...)this.codeFontloadWindowPos(...)LoadTask tasknew LoadTask(...)loadFinishedCommon(...)loadFinished(...)addWindowListener(...)new WindowAdapter(...) { ... }openInit(...)CommonSearchDialog.thisupdateTable(...)updateProgressLabel(...)int selectedIdgetSelectedRow(...)JumpPosition jmpPosJNode nodegetValueAt(...)setPrecise(...)new JumpPosition(...)getResNode(...)isPrecisePos(...)codeJump(...)getKeepCommonDialogOpen(...)saveWindowPos(...)addEscapeShortCutToDispose(...)JButton openBtnJCheckBox cbKeepOpennew ProgressPanel(...)openSelectedItem(...)setKeepCommonDialogOpen(...)isSelected(...)ResultsTableCellRenderer renderernew ResultsTableCellRenderer(...)Enumeration<TableColumn> columnsgetColumns(...)getColumnModel(...)JPanel resultsPanelJPanel paginationPanelJButton nextPageButtonJButton prevPageButtonnew ResultsModel(...)addTableModelListener(...)new TableModelListener(...) { ... }new ResultsTable(...)setShowHorizontalLines(...)setDragEnabled(...)setSelectionMode(...)setColumnSelectionAllowed(...)setAutoResizeMode(...)setAutoscrolls(...)setDefaultRenderer(...)Object.classTableColumn columnsetCellRenderer(...)getClickCount(...)addKeyListener(...)new KeyAdapter(...) { ... }getKeyCode(...)KeyEvent.VK_ENTERsetForeground(...)Color.REDComponent.LEFT_ALIGNMENTBoxLayout.X_AXISnextPage(...)switchPage(...)prevPage(...)scrollRectToVisible(...)new Rectangle(...)String statusTextgetDisplayedResultsStart(...)getDisplayedResultsEnd(...)getResultCount(...)ResultsTableCellRenderer renderer, ...;this.rendererResultsModel modelgetModel(...)TableColumnModel columnModelint widthint firstColMaxWidthint rowCountgetRowCount(...)int columnCountgetColumnCount(...)Component nodeCompComponent codeCompisAddDescColumn(...)int colint colWidthgetColumn(...)int rowComponent compprepareRenderer(...)getPreferredSize(...).widthgetPreferredSize(...)getPreferredWidth(...)setPreferredWidth(...)updateUI(...)setRowHeight(...)getPreferredSize(...).heightnew ArrayList<JNode>(...)...[] COLUMN_NAMES, ...;ArrayList<JNode> rows, ...;boolean addDescColumn, ...;int start, ...;ensureCapacity(...)JNode rowhasDescString(...)new HashMap<Integer,Component>(...)JLabel emptyLabel, ...;Font font, ...;Color codeSelectedColor, ...;Color codeBackground, ...;Map<Integer,Component> componentCache, ...;RSyntaxTextArea areagetDefaultArea(...)this.fontthis.codeSelectedColorgetSelectionColor(...)this.codeBackgroundgetBackground(...)makeID(...)makeCell(...)updateSelection(...)setBackground(...)getSelectionBackground(...)getSelectionForeground(...)getForeground(...)RSyntaxTextArea textAreaJLabel labelmakeLongStringHtml(...)setOpaque(...)new GridLayout(...)setEditable(...)setSyntaxEditingStyle(...)makeDescString(...)setRows(...)setColumns(...)SearchContext searchContextnew SearchContext(...)setMatchCase(...)setMarkAll(...)setRegularExpression(...)markAll(...)loadStartCommon(...)loadStart(...)BackgroundWorker backgroundWorkergetBackgroundWorker(...)DecompileJob decompileJobBackgroundJob indexJobexec(...)processAndWait(...)setCursor(...)getPredefinedCursor(...)Cursor.WAIT_CURSORsetIndeterminate(...)TextSearchIndex textIndex// resultsTable.setBackground(CodeArea.CODE_BACKGROUND);// setRowHeight(Math.max(nodeComp.getPreferredSize().height, codeComp.getPreferredSize().height +// 4));JNode node, ...;/** Allows to show a tool tip on the tab e.g. for displaying a long path of the ... */import FocusManagerimport SwingSchedulersimport Flowableimport Disposableimport SchedulersgetCurrentManager(...)HeapUsageBar.classnew Color(...)new UpdateData(...)double GB, ...;Color GREEN, ...;Color RED, ...;Runtime runtime, ...;FocusManager focusManager, ...;double maxGB, ...;long limit, ...;String labelTemplate, ...;Disposable timer, ...;Color currentColor, ...;long maxMemorymaxMemory(...)setBorderPainted(...)setStringPainted(...)UiUtils.MIN_FREE_MEMORYsetMaximum(...)setColor(...)HeapUsageBar.thisstartTimer(...)int value, ...;Color color, ...;UpdateData SKIP_UPDATE, ...;subscribe(...)subscribeOn(...)distinctUntilChanged(...)edt(...)interval(...)newThread(...)new Function<Long,UpdateData>(...) { ... }prepareUpdate(...)new Predicate<UpdateData>(...) { ... }new BiPredicate<UpdateData,UpdateData>(...) { ... }a.labelb.labelnew Consumer<UpdateData>(...) { ... }applyUpdate(...)UpdateData updateDatalong usedtotalMemory(...)freeMemory(...)getActiveWindow(...)updateData.valueupdateData.labelupdateData.colorupdate.valuesetString(...)update.labelupdate.colorUpdateData update// pass only if label changed// skip update if app window not activeJHtmlPane textArea, ...;new JHtmlPane(...)setCaretPosition(...)setContentType(...)Graphics2D g2dsetRenderingHint(...)RenderingHints.KEY_ANTIALIASINGRenderingHints.VALUE_ANTIALIAS_ONpaint(...)// otherwise the start view will be the last lineimport ImageViewerimport JResourceBufferedImage imgloadImage(...)ImageViewer imageViewernew ImageViewer(...)getComponent(...)getResFile(...)ResContainer resContainerDataType dataTypeResContainer.DataType.DECODED_DATAResContainer.DataType.RES_LINKnew ResourceDecoder<BufferedImage>(...) { ... }// no opimport JClassimport JPackageJPackagePopupMenu.classJMenuItem menuItemmakeRenameMenuItem(...)makeExcludeItem(...)List<String> aliasShortPartssplitPackage(...)String rawPackagegetRawPackage(...)List<String> aliasPartsList<String> rawPartsJMenuItem renameSubMenunew JMenu(...)JPackage renamePkgconcat(...)JMenuItem pkgItemnew JMenuItem(...)rename(...)String aliasShortPkgJPackage pkgPartJMenuItem pkgPartItemList<JClass> classesJMenuItem excludeItemnew JCheckBoxMenuItem(...)JadxWrapper wrappergetWrapper(...)addExcludedPackage(...)removeExcludedPackage(...)// can be longer then alias parts// single case => no submenuimport ILogListenernew Level[]...[] LEVEL_ITEMS, ...;RSyntaxTextArea textPane, ...;registerLogListener(...)JPanel controlPaneJComboBox<Level> cbnew JComboBox<Level>(...)JLabel levelLabelBorderLayout.PAGE_STARTModalityType.MODELESSLogCollector logCollectorresetListener(...)registerListener(...)new ILogListener(...) { ... }import DataFlavorimport Transferableimport DnDConstantsimport DropTargetDragEventimport DropTargetDropEventimport DropTargetEventimport DropTargetListenerimport static FileUtils.toPaths/** Enables drop support from external applications for the {@link MainWindow} (load dropped APK ... */MainDropTarget.classisDataFlavorSupported(...)DataFlavor.javaFileListFlavoracceptDrag(...)DnDConstants.ACTION_COPYrejectDrag(...)processDrag(...)rejectDrop(...)acceptDrop(...)getDropAction(...)Transferable transferablegetTransferable(...)List<File> transferDatagetTransferData(...)dropComplete(...)open(...)toPaths(...)import AWTEventimport BorderLayoutimport Componentimport Dimensionimport DisplayModeimport Fontimport GraphicsDeviceimport GraphicsEnvironmentimport HeadlessExceptionimport Toolkitimport DropTargetimport ActionListenerimport AbstractActionimport Actionimport Boximport JCheckBoxMenuItemimport JDialogimport JFileChooserimport JFrameimport JMenuimport JMenuBarimport JMenuItemimport JPanelimport JPopupMenuimport JScrollPaneimport JSplitPaneimport JToggleButtonimport JToolBarimport JTreeimport ProgressMonitorimport WindowConstantsimport MenuEventimport MenuListenerimport TreeExpansionEventimport TreeWillExpandListenerimport FileNameExtensionFilterimport DefaultTreeCellRendererimport DefaultTreeModelimport TreeNodeimport TreePathimport TreeSelectionModelimport Themeimport BackgroundExecutorimport IndexJobimport JadxProjectimport JadxSettingsWindowimport ApkSignatureimport JFieldimport JLoadableNodeimport JMethodimport JRootimport AbstractCodeContentPanelimport JadxUpdateimport IUpdateCallbackimport Releaseimport Linkimport static Functions.EMPTY_RUNNABLEimport static FileUtils.fileNamesToPathsimport static KeyStroke.getKeyStrokeMainWindow.classString DEFAULT_TITLE, ...;double BORDER_RATIO, ...;double WINDOW_RATIO, ...;double SPLIT_PANE_RESIZE_WEIGHT, ...;ImageIcon ICON_OPEN, ...;ImageIcon ICON_ADD_FILES, ...;ImageIcon ICON_SAVE_ALL, ...;ImageIcon ICON_EXPORT, ...;ImageIcon ICON_CLOSE, ...;ImageIcon ICON_FLAT_PKG, ...;ImageIcon ICON_SEARCH, ...;ImageIcon ICON_FIND, ...;ImageIcon ICON_BACK, ...;ImageIcon ICON_FORWARD, ...;ImageIcon ICON_PREF, ...;ImageIcon ICON_DEOBF, ...;ImageIcon ICON_LOG, ...;ImageIcon ICON_JADX, ...;CacheObject cacheObject, ...;JadxProject project, ...;Action newProjectAction, ...;Action saveProjectAction, ...;JPanel mainPanel, ...;JSplitPane splitPane, ...;JTree tree, ...;DefaultTreeModel treeModel, ...;JRoot treeRoot, ...;HeapUsageBar heapUsageBar, ...;boolean treeReloading, ...;boolean isFlattenPackage, ...;JToggleButton flatPkgButton, ...;JCheckBoxMenuItem flatPkgMenuItem, ...;JToggleButton deobfToggleBtn, ...;JCheckBoxMenuItem deobfMenuItem, ...;Link updateLink, ...;BackgroundWorker backgroundWorker, ...;BackgroundExecutor backgroundExecutor, ...;Theme editorTheme, ...;new JadxWrapper(...)this.cacheObjectnew CacheObject(...)resetCache(...)registerBundledFonts(...)initMenuAndToolbar(...)registerMouseNavigationButtons(...)checkForUpdate(...)newProject(...)this.backgroundExecutornew BackgroundExecutor(...)setLocationAndPosition(...)setDividerLocation(...)getTreeWidth(...)isShowHeapUsageBar(...)closeWindow(...)processCommandLineArgs(...)openFileOrProject(...)fileNamesToPaths(...)handleSelectClassOption(...)getCmdSelectClass(...)searchJavaClassByClassName(...)makeFrom(...)searchJavaClassByOrigClassName(...)JOptionPane.ERROR_MESSAGEgetDefPos(...)new IUpdateCallback(...) { ... }String titleJFileChooser fileChooserbuildFileChooser(...)int retJFileChooser.APPROVE_OPTIONsetLastOpenFilePath(...)getCurrentDirectory(...)getSelectedFiles(...)String[] extsString descriptionnew JFileChooser(...) { ... }JDialog dialogcreateDialog(...)windowClosed(...)Path currentDirectorygetLastOpenFilePath(...)JadxProject.PROJECT_EXTENSIONsetAcceptAllFileFilterUsed(...)setFileFilter(...)new FileNameExtensionFilter(...)setMultiSelectionEnabled(...)setCurrentDirectory(...)ensureProjectIsSaved(...)new JadxProject(...)clearTree(...)saveProjectAs(...)new JFileChooser(...)getLastSaveProjectPath(...)showSaveDialog(...)getSelectedFile(...)setLastSaveProjectPath(...)resolveSibling(...)JOptionPane.NO_OPTIONsaveAs(...)openProject(...)setFilePath(...)openFile(...)initTree(...)runBackgroundJobs(...)isSaved(...)isInitial(...)JOptionPane.YES_NO_CANCEL_OPTIONJOptionPane.CANCEL_OPTIONList<Path> filePathsaddRecentProject(...)Path projectPathString pathStringsetJRoot(...)setJadxSettings(...)setDecompileJob(...)new DecompileJob(...)setIndexJob(...)new IndexJob(...)cancelBackgroundJobs(...)new BackgroundWorker(...)new TimerTask(...) { ... }cancelAll(...)stop(...)List<Path> openedFileMap<String,Integer> openTabsstoreOpenTabs(...)restoreOpenTabs(...)new LinkedHashMap<String,Integer>(...)Entry<JNode,ContentPanel> entryMap<>.Entry<JNode,ContentPanel>getOpenTabs(...)String classRealNameJumpPosition positiongetCurrentPosition(...)Entry<String,Integer> entryMap<>.Entry<String,Integer>int positionJavaClass newClasssearchJavaClassByRawName(...)JNode newNodeJadxArgs decompilerArgsgetLastSaveFilePath(...)setFileSelectionMode(...)ProgressMonitor progressMonitornew ProgressMonitor(...)setLastSaveFilePath(...)setMillisToPopup(...)saveAll(...)new JRoot(...)setFlatPackages(...)setRoot(...)reloadTree(...)List<String[]> treeExpansionsgetTreeExpansions(...)expand(...)expandRow(...)TreeNode[] pathNodesgetPathToRoot(...)TreePath pathnew TreePath(...)String[] expansiongetPathExpansion(...)expandPath(...)getChildCount(...)getChildAt(...)setFlattenPackage(...)Object rootJRoot treeRootboolean deobfOnshowResource(...)showSimpleNode(...)JNode objgetJNodeUnderMouse(...)JPackagePopupMenu menunew JPackagePopupMenu(...)show(...)JPopupMenu menunew JPopupMenu(...)JMenuItem jmigetPathForLocation(...)getLastPathComponent(...)ContentPanel selectedContentPanelgetSelectedCodePanel(...)searchClassInTree(...)setSelectionPath(...)makeVisible(...)scrollPathToVisible(...)requestFocus(...)Action openActionAction addFilesActionaddFiles(...)Action saveProjectAsActionAction saveAllActionAction exportActionJMenu recentProjectsAction prefsActionnew JadxSettingsWindow(...)MainWindow.thisAction exitActionJCheckBoxMenuItem heapUsageBarMenuItemAction syncActionsyncWithEditor(...)Action textSearchActionContentPanel panelString preferTextgetSelectedText(...)getCodeArea(...)searchText(...)new SearchDialog(...)Action clsSearchActionAction deobfActiontoggleDeobfuscation(...)Action logActionnew LogViewer(...)Action aboutActionnew AboutDialog(...)Action backActionnavBack(...)Action forwardActionnavForward(...)JMenu fileJMenu viewJMenu navJMenu toolsJMenu helpJMenuBar menuBarnew JMenuBar(...)ActionListener flatPkgActiontoggleFlattenPackage(...)JToolBar toolbarnew JToolBar(...)putValue(...)Action.SHORT_DESCRIPTIONAction.ACCELERATOR_KEYKeyEvent.VK_OctrlButton(...)saveProject(...)KeyEvent.VK_SKeyEvent.VK_EaddMenuListener(...)new RecentProjectsMenuListener(...)KeyEvent.VK_PKeyEvent.SHIFT_DOWN_MASKisFlattenPackage(...)setShowHeapUsageBar(...)KeyEvent.VK_TKeyEvent.VK_FKeyEvent.VK_NKeyEvent.VK_DKeyEvent.ALT_DOWN_MASKnew JToggleButton(...)KeyEvent.VK_LKeyEvent.VK_ESCAPEKeyEvent.VK_RIGHTsetMnemonic(...)addSeparator(...)KeyEvent.VK_VKeyEvent.VK_HsetJMenuBar(...)new Link(...)JadxUpdate.JADX_RELEASES_URLsetFloatable(...)BorderLayout.NORTHDefaultMutableTreeNode treeRootNodenew DefaultMutableTreeNode(...)JPanel leftPaneJScrollPane treeScrollPanesetMinimumSize(...)new JSplitPane(...)setResizeWeight(...)new DefaultTreeModel(...)new JTree(...)getSelectionModel(...)TreeSelectionModel.SINGLE_TREE_SELECTIONisLeftMouseButton(...)nodeClickAction(...)isRightMouseButton(...)treeRightClickAction(...)getLastSelectedPathComponent(...)new DefaultTreeCellRenderer(...) { ... }Component cgetTreeCellRendererComponent(...)setIcon(...)addTreeWillExpandListener(...)new TreeWillExpandListener(...) { ... }Object nodeloadNode(...)addTreeExpansion(...)removeTreeExpansion(...)setLeftComponent(...)new TabbedPane(...)setRightComponent(...)new DropTarget(...)new MainDropTarget(...)new HeapUsageBar(...)BorderLayout.SOUTHsetContentPane(...)Toolkit toolkitaddAWTEventListener(...)AWTEvent.MOUSE_EVENT_MASKnew AWTEventListener(...) { ... }MouseEvent mouseEventgetID(...)MouseEvent.MOUSE_PRESSEDint rawButtongetButton(...)int buttonremapMouseButton(...)SystemInfo.IS_LINUXList<String> pathListgetParentPath(...)isExpanded(...)TreeNode nodeTreeNode nTreePath childpathByAddingChild(...)getExpandedPaths(...)getDefaultScreenDevice(...)DisplayMode modegetDisplayMode(...)Font largerFontderiveFont(...)setEditorTheme(...)setTreeWidth(...)getDividerLocation(...)setMainWindowExtendedState(...)getExtendedState(...)JMenu menu, ...;this.menuSet<Path> currentnew HashSet<Path>(...)List<JMenuItem> itemsgetRecentProjects(...)new Function<Path,JMenuItem>(...) { ... }new Consumer<JMenuItem>(...) { ... }// TODO: decompilation freezes sometime with several threads// node not register in treeimport PropertyChangeEventimport PropertyChangeListenerimport BorderFactoryimport BoxLayoutimport JButtonimport JLabelimport JProgressBarIcon ICON_CANCEL, ...;JProgressBar progressBar, ...;JLabel progressLabel, ...;JButton cancelButton, ...;boolean showCancelButton, ...;this.showCancelButtonnew JProgressBar(...)setPreferredSize(...)getIconWidth(...)getIconHeight(...)setFocusPainted(...)setContentAreaFilled(...)getPropertyName(...)int progresssetLabel(...)firePropertyChange(...)import Containerimport FlowLayoutimport JTextFieldimport SwingConstantsimport jadx.api.*import DeobfPresetsimport ClassCodeContentPanelimport CodePanelimport jadx.gui.utils.*RenameDialog.classJTextField renameField, ...;RenameDialog renameDialognew RenameDialog(...)checkSettings(...)StringBuilder errorMessageboolean validJOptionPane.OK_CANCEL_OPTIONJOptionPane.OK_OPTIONMethodNode relatedMthgetJavaVarNode(...)updateVariableName(...)String renameTextgetDecompiler(...)refreshDeobfMapFile(...)refreshState(...)DeobfPresets deobfPresetsupdateDeobfMap(...)RenameVisitor renameVisitorJNodeCache nodeCacheList<JavaNode> toUpdatenew ArrayList<JavaNode>(...)Set<JClass> updatedTopClassesnew Function<JavaNode,JNode>(...) { ... }new Function<JNode,JClass>(...) { ... }new Predicate<JClass>(...) { ... }getOverrideRelatedMethods(...)getJavaMethod(...)processPackage(...)refreshTabs(...)getBackgroundExecutor(...)new Function<JClass,Runnable>(...) { ... }refreshJClass(...)String rawFullPkgString rawFullPkgDotrefreshIndex(...)ContentPanel contentPanelJClass rootClassClassCodeContentPanel codePanelCodePanel javaPanelgetJavaCodePanel(...)refresh(...)JButton renameBtnJLabel lblJLabel nodeLabelJPanel renamePaneinitButtonsPanel(...)selectAll(...)new TextStandardActions(...)new FlowLayout(...)FlowLayout.LEFT// TODO: can't open dialog, 'node' is replaced with new one after reopen// reinit tree// search all classes in package// also include all usages (for import fix)// always pack (ignore saved windows sizes)import BackpressureStrategyimport Emitterimport TextStandardActionsSearchDialog.classboolean textSearch, ...;new SearchOptions(...)SearchOptions CLASS, ...;SearchOptions METHOD, ...;SearchOptions FIELD, ...;SearchOptions CODE, ...;SearchOptions IGNORE_CASE, ...;SearchOptions USE_REGEX, ...;SearchOptions Resource, ...;Set<SearchOptions> options, ...;JTextField searchField, ...;Disposable searchDisposable, ...;SearchEventEmitter searchEmitter, ...;this.textSearchSet<SearchOptions> lastSearchOptionsgetLastSearchOptions(...)this.optionsSearchOptions.CODESearchOptions.IGNORE_CASESearchOptions.CLASSregisterInitOnOpen(...)String lastSearchgetLastSearch(...)prepare(...)JLabel findLabelJCheckBox caseChBoxmakeOptionsCheckBox(...)JCheckBox regexChBoxSearchOptions.USE_REGEXJCheckBox resChBoxSearchOptions.ResourceJCheckBox clsChBoxJCheckBox mthChBoxSearchOptions.METHODJCheckBox fldChBoxSearchOptions.FIELDJCheckBox codeChBoxJPanel searchInPanelJPanel searchOptionsBox boxcreateHorizontalBox(...)JPanel searchPaneinitResultsTable(...)searchFieldSubscribe(...)initCommon(...)setRowSelectionInterval(...)Flowable<String> flowable, ...;Emitter<String> emitter, ...;BackpressureStrategy.LATESTnew FlowableOnSubscribe<String>(...) { ... }saveEmitter(...)this.emitteronNext(...)Flowable<String> textChangesonTextFieldChanges(...)Flowable<String> searchEventsgetFlowable(...)new SearchEventEmitter(...)doOnError(...)observeOn(...)switchMap(...)doOnNext(...)single(...)new Function<String,Publisher<? extends List<JNode>>>(...) { ... }toFlowable(...)prepareSearch(...)new Consumer<Throwable>(...) { ... }new Consumer<List<JNode>>(...) { ... }processSearchResults(...)showSearchState(...)buildSearch(...)String textsetLastSearch(...)setLastSearchOptions(...)performSearch(...)debounce(...)TimeUnit.MILLISECONDSDocumentListener listenerchange(...)setDisposable(...)new Disposable(...) { ... }boolean disposed, ...;removeDocumentListener(...)isDisposed(...)JCheckBox chBoxemitSearch(...)// SearchDialog is opened by menu item, let loadFinished to set textimport BasicButtonUIImageIcon ICON_CLOSE_INACTIVE, ...;ContentPanel contentPanel, ...;JLabel label, ...;this.contentPanelgetLabelFont(...)String toolTipgetTabTooltip(...)JButton closeBtnMouseAdapter clickAdapterisMiddleMouseButton(...)closeCodePanel(...)createTabPopupMenu(...)getSelectedComponent(...)setSelectedComponent(...)FlowLayout.CENTERsetRolloverIcon(...)setRolloverEnabled(...)setUI(...)new BasicButtonUI(...)setFocusable(...)String nodeFullNamegetNodeFullName(...)JMenuItem closeTabMap<JNode,ContentPanel> openTabsJMenuItem copyRootClassNamesetClipboardString(...)JMenuItem closeOtherJMenuItem closeAllList<ContentPanel> contentPanelsnew ArrayList<ContentPanel>(...)closeAllTabs(...)ContentPanel cpJMenuItem itemJClass jClassimport java.awt.event.*import BadLocationExceptionimport jadx.gui.ui.codearea.*import JumpManagernew LinkedHashMap<JNode,ContentPanel>(...)new JumpManager(...)TabbedPane.classMap<JNode,ContentPanel> openTabs, ...;JumpManager jumps, ...;ContentPanel curTab, ...;ContentPanel lastTab, ...;setTabLayoutPolicy(...)addMouseWheelListener(...)new MouseWheelListener(...) { ... }getWheelRotation(...)int maxIndexgetTabCount(...)setSelectedIndex(...)interceptTabKey(...)enableSwitchingTabs(...)addKeyEventDispatcher(...)getCurrentKeyboardFocusManager(...)new KeyEventDispatcher(...) { ... }KeyEvent.CTRL_DOWN_MASKint ctrlDown, ...;long ctrlInterval, ...;long curint codeboolean consumeKeyEvent.VK_TABboolean isReleasedKeyEvent.KEY_RELEASEDisActive(...)KeyEvent.VK_CONTROLboolean doSwitchgetModifiersEx(...)switchPanel(...)ContentPanel tabfocusOnCodePanel(...)indexOfComponent(...)setLastTabAdjacentToCurTab(...)getComponentAt(...)AbstractCodeContentPanel contentPanelgetContentPanel(...)AbstractCodeArea codeAreaisPrecise(...)scrollToPos(...)getLineOfOffset(...)BadLocationException escrollToLine(...)int lineNumint offsgetLineStartOffset(...)isWhite(...)JumpPosition curPosaddPosition(...)showCode(...)ContentPanel selectedCodePanelJumpPosition posgetPrev(...)updateCurPosition(...)getNext(...)makeContentPanel(...)listen(...)addContentPanel(...)setTabComponentAt(...)makeTabComponent(...)ResourceType.IMGnew ImagePanel(...)new CodeContentPanel(...)new HtmlPanel(...)new ClassCodeContentPanel(...)new TabComponent(...)int tabCountComponent tabComponentgetTabComponentAt(...)new FocusManager(...)boolean active, ...;FocusManager listener, ...;addFocusListener(...)getSmaliCodeArea(...)getHtmlArea(...)getCurrentCodeArea(...)requestFocusInWindow(...)// don't do nothing when tab is not on focus.// consume Tab key event anyway// the gap of the release of ctrl and tab is very close, nearly the same time,// but ctrl released first.// switch between source and smali// all closed// a tab was closed by not the current one.// lastTab was closed// curTab was closed and lastTab is the current one.// it's switching between lastTab and curTab.getUsageList(...)// TODO: highlight only needed node usageimport CaretEventimport CaretListenerimport PopupMenuEventimport PopupMenuListenerimport javax.swing.text.*import ContentPanelAbstractCodeArea.classJPopupMenu popupMenugetPopupMenu(...)JCheckBoxMenuItem wrapItemgetLineWrap(...)Caret caretgetCaret(...)setMarkOccurrences(...)setCodeFoldingEnabled(...)setLineWrap(...)isCodeAreaLineWrap(...)setAction(...)setCodeAreaLineWrap(...)new Consumer<ContentPanel>(...) { ... }isVisible(...)addPopupMenuListener(...)new PopupMenuListener(...) { ... }setUpdatePolicy(...)DefaultCaret.ALWAYS_UPDATEnew FocusListener(...) { ... }// the caret to be repainted.// and when regained set back to true will force// when lost focus set visible to false,// fix caret missing bug.addCaretListener(...)new CaretListener(...) { ... }int lastPos, ...;String lastText, ...;getCaretPosition(...)highlightCaretWord(...)getWordByPosition(...)highlightAllMatches(...)isWordSeparator(...)getWordStart(...)getWordEnd(...)printf(...)/** Implement in this method the code that loads and sets the content to be displayed *//** Implement in this method the code that reloads node from cache and sets the new content to be ... */setAntiAliasingEnabled(...)getEditorTheme(...)centerCurrentLine(...)forceCurrentLineHighlightRepaint(...)setCaretAtLine(...)JViewport viewportgetAncestorOfClass(...)JViewport.classRectangle rmodelToView(...)int extentHeightgetExtentSize(...).heightgetExtentSize(...)Dimension viewSizegetViewSize(...)int viewHeightviewSize.heightr.ysetViewPosition(...)isConsumed(...)SearchContext contextsetWholeWord(...)JumpPosition jpgetCaretLineNumber(...)import TabbedPane/** The abstract base class for a content panel that show text based code or a.g. a resource */import EmptyBorder/** Displays one class with two different view: ... */CodePanel javaCodePanel, ...;CodePanel smaliCodePanel, ...;JTabbedPane areaTabbedPane, ...;new CodePanel(...)new CodeArea(...)new SmaliArea(...)new EmptyBorder(...)new JTabbedPane(...)CodePanel selectedPanelboolean toSmaliimport RSyntaxDocumentimport Tokenimport TokenTypesimport JNodeCache/** The {@link AbstractCodeArea} implementation used for displaying Java code and text based ... */CodeArea.classboolean isJavaCodeCodeLinkGenerator codeLinkGeneratornew CodeLinkGenerator(...)setSyntaxStyle(...)new JadxTokenMaker(...)addMenuItems(...)setHyperlinksEnabled(...)setLinkScanningMask(...)InputEvent.CTRL_DOWN_MASKsetLinkGenerator(...)isControlDown(...)navToDecl(...)getPoint(...)addMouseMotionListener(...)new MouseHoverHighlighter(...)viewToModel(...)JumpPosition jumpgetJumpLinkAtOffset(...)CodeArea.thisFindUsageAction findUsagenew FindUsageAction(...)GoToDeclarationAction goToDeclarationnew GoToDeclarationAction(...)RenameAction renamenew RenameAction(...)JPopupMenu popupint sourceOffsetTokenTypes.IDENTIFIERTokenTypes.ANNOTATIONTokenTypes.MARKUP_TAG_ATTRIBUTE_VALUEgetTextArray(...)getTextOffset(...)/** Search node by offset in {@code jCls} code and return its definition position ... */JavaNode foundNodegetJavaNodeAtOffset(...)JNode jNodeconvertJavaNode(...)getJNodeAtOffset(...)/** Search referenced java node by offset in {@code jCls} code */int lineOffset// skip quote at start (")// fast skip// TODO: add direct mapping for code offset to CodeWriter (instead of line and line offset pair)CodePanel codePanel, ...;getSearchBar(...)JNode nimport HyperlinkEventimport LinkGeneratorimport LinkGeneratorResultCodeLinkGenerator.classCodeArea codeArea, ...;this.codeAreagetLinkSourceOffset(...)getJumpBySourceOffset(...)JumpPosition defPosnew LinkGeneratorResult(...) { ... }new HyperlinkEvent(...)HyperlinkEvent.EventType.ACTIVATEDHyperlinkEvent.EventTypeToken tokenmodelToToken(...)adjustOffsetForToken(...)getDefPosForNodeAtOffset(...)// ignore self jumpimport Separatorimport SearchDialog/** A panel combining a {@link SearchBar and a scollable {@link CodeArea} */SearchBar searchBar, ...;AbstractCodeArea codeArea, ...;JScrollPane codeScrollPane, ...;KeyStroke keyJMenuItem searchItemJMenuItem globalSearchItemAbstractAction searchActiontoggle(...)AbstractAction globalSearchActionMainWindow mainWindowSeparator separatornew Separator(...)new SearchBar(...)addKeyBinding(...)Action.NAMEinitLineNumbers(...)LineNumbers numbersnew LineNumbers(...)setUseSourceLines(...)isUseSourceLines(...)setRowHeaderView(...)Set<Integer> uniqueSourceLinesint tokenIndexint lineCountgetLineCount(...)int lineDiffgetTokenListForLine(...)int newPosgetOffsetOfTokenByIndex(...)getTokenIndexByOffset(...)refreshToViewport(...)getViewport(...)getCodeScrollPane(...)Point viewPositiongetViewPosition(...)getNextToken(...)// after rename the change of document is undetectable, so// use Token offset to calculate the new caret position.new EditorTheme[]new EditorTheme(...)String RSTA_THEME_PATH, ...;...[] ALL_THEMES, ...;String path, ...;this.pathimport UsageDialogKeyEvent.VK_XgetNodeUnderCaret(...)showUsageDialog(...)UsageDialog usageDialognew UsageDialog(...)getNodeByOffset(...)doJump(...)T node, ...;Point posgetLocation(...)getPointerInfo(...)viewToToken(...)convertPointFromScreen(...)import Segmentimport TokenImplimport JavaTokenMakerJadxTokenMaker.classToken tokensgetTokenList(...)TokenTypes.NULLprocessTokens(...)Token prevToken currentmergeLongClassNames(...)String lexemegetLexeme(...)isClassNameStart(...)Token replaceconcatTokensUntil(...)TokenImpl implsetNextToken(...)char[] lineTokenImpl tokennew TokenImpl(...)getLanguageIndex(...)line.length// try to replace long class name with one token// full class name// inner class references from parent classimport Colorimport FontMetricsimport Graphicsimport Graphics2Dimport Insetsimport Pointimport RenderingHintsimport Shapeimport Borderimport CompoundBorderimport MatteBorderimport Viewimport SyntaxSchemeLineNumbers.classgetDesktopProperty(...)int NUM_HEIGHT, ...;Map<?,?> DESKTOP_HINTS, ...;boolean useSourceLines, ...;int lastDigits, ...;int lastLine, ...;Color numberColor, ...;Color normalNumColor, ...;Border border, ...;Insets textAreaInsets, ...;Rectangle visibleRect, ...;ICodeInfo codeInfo, ...;SyntaxScheme syntaxSchemegetSyntaxScheme(...)getStyle(...).foregroundToken.LITERAL_NUMBER_DECIMAL_INTToken.ANNOTATIONToken.LITERAL_STRING_DOUBLE_QUOTEnew MatteBorder(...)Token.COMMENT_MULTILINEsetBorderGap(...)Border innernew CompoundBorder(...)Element rootgetDefaultRootElement(...)int linesgetElementCount(...)int digitsFontMetrics fontMetricsgetFontMetrics(...)charWidth(...)Insets insetsgetInsets(...)int preferredWidthinsets.leftinsets.rightDimension dFont baseFontgetSize2D(...)Dimension sizeint availableWidthsize.widthboolean lineWrapint cellHeightgetLineHeight(...)int ascentgetMaxAscent(...)int currentLineint topLineView parentViewRectangle editorRectint endYvisibleRect.yvisibleRect.heightboolean isCurLineupdateColor(...)getClipBounds(...)getVisibleRect(...)applyRenderHints(...)fillRect(...)size.heighttextAreaInsets.topint topPositionvisibleRect.xRectangle topLineBoundsgetLineBounds(...)getView(...)getRootView(...)getUI(...)getElementIndex(...)getEditorBoundingRect(...)topLineBounds.yString lineStrgetTextLineNumber(...)stringWidth(...)drawString(...)Rectangle lineBoundslineBounds.heightShape allocgetChildAllocation(...)bounds.widthbounds.heightbounds.xbounds.yinsets.topinsets.bottomsetRenderingHints(...)RenderingHints.KEY_RENDERINGRenderingHints.VALUE_RENDER_QUALITYRenderingHints.KEY_TEXT_ANTIALIASINGRenderingHints.VALUE_TEXT_ANTIALIAS_ONRenderingHints.KEY_FRACTIONALMETRICSRenderingHints.VALUE_FRACTIONALMETRICS_ONint caretPositionthis.useSourceLinesimport MouseMotionAdapterimport Highlighterimport SmartHighlightPainterMouseHoverHighlighter.classCodeLinkGenerator codeLinkGenerator, ...;Highlighter.HighlightPainter highlighter, ...;Highlighter.HighlightPainterObject tag, ...;int highlightedTokenOffset, ...;this.codeLinkGeneratorthis.highlighternew SmartHighlightPainter(...)getMarkOccurrencesColor(...)addHighlight(...)removeHighlight(...)int tokenOffsetJavaNode nodeAtOffsetgetNodeAtOffset(...)getHighlighter(...)// don't repaint highlightimport RenameDialogimport static KeyEvent.VK_NRenameAction.classshowRenameDialog(...)showMessageBox(...)canRename(...)popupMenuWillBecomeVisible(...)import SearchResultSearchBar.classColor COLOR_BG_ERROR, ...;Color COLOR_BG_WARN, ...;Color COLOR_BG_NORMAL, ...;Icon ICON_UP, ...;Icon ICON_DOWN, ...;Icon ICON_CLOSE, ...;RSyntaxTextArea rTextArea, ...;JCheckBox markAllCB, ...;JCheckBox regexCB, ...;JCheckBox wholeWordCB, ...;JCheckBox matchCaseCB, ...;JButton prevButtonJButton nextButtonActionListener forwardListenerJButton closeButtonboolean visibleString searchTextboolean forwardboolean matchCaseboolean regexboolean wholeWordSearchResult resultsetSearchFor(...)setSearchForward(...)int caretPoswasFound(...)getNextMatchPos(...)this.rTextArea// TODO hack: move cursor before previous search for not jump to next occurrenceimport TextNodeJNode textNode, ...;this.textNode// this area contains only smali without other node attributesimport Readerimport Typeimport HttpURLConnectionimport TypeTokenJadxUpdate.classnew Gson(...)new TypeToken<List<Release>>(...) { ... }new Comparator<Release>(...) { ... }checkAndCompare(...)String JADX_RELEASES_URL, ...;String GITHUB_API_URL, ...;String GITHUB_RELEASES_URL, ...;Type RELEASES_LIST_TYPE, ...;Comparator<Release> RELEASE_COMPARATOR, ...;Runnable runRelease releasecheckForNewRelease(...)onUpdate(...)Thread threadsetPriority(...)Thread.MIN_PRIORITYString versionList<Release> listRelease latestnew Predicate<Release>(...) { ... }isPreRelease(...)URL objHttpURLConnection conopenConnection(...)setRequestMethod(...)getResponseCode(...)Reader readerclean(...)String[] s1int l1s1.lengthString[] s2int l2s2.lengthboolean checkFirstboolean zeroTailisZeroTail(...)// skip equals parts// compare first non-equal ordinal numberlong size, ...;int downloadCount, ...;String downloadUrl, ...;String createdAt, ...;this.downloadCountthis.downloadUrlthis.createdAtboolean preRelease, ...;List<Asset> assets, ...;this.preReleasethis.assetsAsset assetgetAssets(...)DecompileJob decompileJob, ...;IndexJob indexJob, ...;TextSearchIndex textIndex, ...;CodeUsageInfo usageInfo, ...;String lastSearch, ...;JNodeCache jNodeCache, ...;Set<SearchOptions> lastSearchOptions, ...;SearchDialog.SearchOptionsJRoot jRoot, ...;new JNodeCache(...)SearchDialog.SearchOptions.classthis.decompileJobthis.textIndexthis.lastSearchthis.usageInfothis.indexJobthis.lastSearchOptionsthis.jRootimport MessageDigestimport NoSuchAlgorithmExceptionimport Principalimport PublicKeyimport CertificateEncodingExceptionimport CertificateFactoryimport X509Certificateimport DSAPublicKeyimport RSAPublicKeyCertificateManager.classString CERTIFICATE_TYPE_NAME, ...;Certificate cert, ...;X509Certificate x509cert, ...;StringBuilder strBuildCollection<? extends Certificate> certificatesreadCertificates(...)Certificate certCertificateManager certificateManagergenerateText(...)CertificateFactory cfgenerateCertificates(...)String typethis.certStringBuilder builderPrincipal subjectDNgetSubjectDN(...)getSerialNumber(...)getNotBefore(...)getNotAfter(...)getSigAlgName(...)getSigAlgOID(...)getThumbPrint(...)PublicKey publicKeygetPublicKey(...)generateRSAPublicKey(...)generateDSAPublicKey(...)RSAPublicKey pubgetAlgorithm(...)getPublicExponent(...)getModulus(...)DSAPublicKey pubgenerateTextForX509(...)MessageDigest mdbyte[] dergetEncoded(...)byte[] digestdigest(...)hexify(...)char[] hexDigitsStringBuilder bufbyte aByte// serial number// Get subject// lgtm [java/weak-cryptographic-algorithm]import NavigableMapnew TreeMap<Integer,JavaNode>(...)NavigableMap<Integer,JavaNode> map, ...;JavaMethod mthMap<>.Entry<Integer,JavaNode>Entry<Integer,JavaNode> entryfloorEntry(...)import CodeNodenew ConcurrentHashMap<JNode,UsageInfo>(...)CodeUsageInfo.classnew ArrayList<CodeNode>(...)List<CodeNode> usageList, ...;JNodeCache nodeCache, ...;this.nodeCacheMap<JNode,UsageInfo> usageMap, ...;Map<CodePosition,JavaNode> usageEntry<CodePosition,JavaNode> entryMap<>.Entry<CodePosition,JavaNode>addUsage(...)new Function<JNode,UsageInfo>(...) { ... }JavaNode javaNodeByLinegetJavaNodeByLine(...)StringRef codeLinesetPrecisePos(...)new CodeNode(...)new Predicate<Entry<JNode,UsageInfo>>(...) { ... }removeUsageIf(...)new Predicate<CodeNode>(...) { ... }import StyleContextFontUtils.classopenFontTTF(...)Font FONT_HACK, ...;GraphicsEnvironment grEnvFontUtils.FONT_HACKregisterFont(...)int styleparseFontStyle(...)StyleContext scgetDefaultStyleContext(...)Font.ITALICString fontPathUiUtils.classcreateFont(...)Font.TRUETYPE_FONTnew ConcurrentHashMap<JavaNode,JNode>(...)Map<JavaNode,JNode> cache, ...;JClass pJavaField fldJavaVariable varnew JVariable(...)new ArrayList<JumpPosition>(...)List<JumpPosition> list, ...;int currentPos, ...;ignoreJump(...)JumpPosition currentgetCurrent(...)// undefined jump line in same node // TODO: find the cause// replace currentgetJavaField(...)position.lineposition.nodeposition.posLocale locale, ...;this.localenew Locale(...)import MouseListenerimport static Desktop.ActionLink.classString url, ...;this.urlColor.BLUEbrowse(...)new Cursor(...)Cursor.HAND_CURSORCursor.DEFAULT_CURSORisDesktopSupported(...)Desktop desktopgetDesktop(...)isSupported(...)Action.BROWSEnew URI(...)String osMap<String,String> envcommand(...)new ProcessBuilder(...)showUrlDialog(...)JTextArea urlAreanew JTextArea(...)import MissingResourceExceptionimport PropertyResourceBundleimport ResourceBundleimport Vectornew Vector<LangLocale>(...)new HashMap<LangLocale,ResourceBundle>(...)LangLocale defLangnew LangLocale(...)getDefault(...)new Consumer<LangLocale>(...) { ... }Vector<LangLocale> LANG_LOCALES, ...;Map<LangLocale,ResourceBundle> LANG_LOCALES_MAP, ...;ResourceBundle FALLBACK_MESSAGES_MAP, ...;LangLocale LOCAL_LOCALE, ...;ResourceBundle localizedMessagesMap, ...;// Use these two fields to avoid invoking Map.get() method twice.LangLocale currentLocale, ...;ResourceBundle bundlegetSystemClassLoader(...)URL bundleUrlnew PropertyResourceBundle(...)MissingResourceException eMissingResourceException ignored// As default language// definitely exists// use fallback string// fallback to english if unsupportednew ArrayList<Icon>(...)Icon icon, ...;List<Icon> icons, ...;double A, ...;double B, ...;...[] OVERLAY_POS, ...;this.iconpaintIcon(...)Icon subIconint dxint dyimport TypeAdapterimport JsonReaderimport JsonTokenimport JsonWriternew TypeAdapter<Path>(...) { ... }value(...)JsonToken.NULLnextNull(...)nextString(...)TypeAdapter<Path> SINGLETON, ...;new TypeAdapter<Rectangle>(...) { ... }beginObject(...)endObject(...)Rectangle rectanglenextName(...)rectangle.xrectangle.yrectangle.widthrectangle.heightTypeAdapter<Rectangle> SINGLETON, ...;Locale.ENGLISHString JADX_VERSION, ...;String JAVA_VM, ...;String JAVA_VER, ...;String OS_NAME, ...;String OS_VERSION, ...;String LOWER_OS_NAME, ...;boolean IS_WINDOWS, ...;boolean IS_MAC, ...;boolean IS_LINUX, ...;import JTextComponentimport UndoManagerJTextComponent textComponent, ...;JPopupMenu popup, ...;UndoManager undoManager, ...;Action undoAction, ...;Action redoAction, ...;Action cutAction, ...;Action copyAction, ...;Action pasteAction, ...;Action deleteAction, ...;Action selectAllAction, ...;this.textComponentthis.undoManagernew UndoManager(...)initActions(...)addPopupItems(...)addKeyActions(...)registerListeners(...)canUndo(...)undo(...)canRedo(...)redo(...)cut(...)paste(...)replaceSelection(...)KeyStroke undoKeyKeyEvent.VK_ZKeyStroke redoKeyKeyEvent.VK_RaddUndoableEditListener(...)new UndoableEditListener(...) { ... }addEdit(...)getEdit(...)boolean enabledboolean editableisEditable(...)boolean nonemptyboolean markedboolean pasteAvailablegetContents(...)DataFlavor.stringFlavorint nxgetSize(...).widthgetSize(...).heightimport InputEventimport MagicConstantInputEvent.classcalculateMinFreeMemory(...)getCtrlButton(...)ImageIcon ICON_STATIC, ...;ImageIcon ICON_FINAL, ...;ImageIcon ICON_ABSTRACT, ...;ImageIcon ICON_NATIVE, ...;long MIN_FREE_MEMORY, ...;/** The minimum about of memory in bytes we are trying to keep free, otherwise the application may ... */String iconPathcreateImage(...)escapeHtml(...)Icon iconOverlayIcon overIconRuntime runtimelong minFreelong totalFreelong allocatedMemorylong freeMemory/** Adapt character case for case insensitive searches */List<Image> iconsnew ArrayList<Image>(...)openImage(...)setIconImages(...)int CTRL_BNT_KEY, ...;getMenuShortcutKeyMask(...)KeyStroke strokeregisterKeyboardAction(...)import LoggerContextimport PatternLayoutimport ILoggingEventimport AppenderBaseimport Layoutnew LinkedList<LogEvent>(...)new LogCollector(...)int BUFFER_SIZE, ...;LogCollector INSTANCE, ...;LoggerContext loggerContextgetLoggerContext(...)PatternLayout layoutnew PatternLayout(...)setContext(...)setPattern(...)addAppender(...)Layout<ILoggingEvent> layout, ...;ILogListener listener, ...;Deque<LogEvent> buffer, ...;Level leveldoLayout(...)isGreaterOrEqual(...)getFilterLevel(...)onAppend(...)addLast(...)new LogEvent(...)pollFirst(...)this.layoutthis.listenerLogEvent eventgetMsg(...)String msg, ...;this.msgCodeIndex.classList<CodeNode> values, ...;BackpressureStrategy.BUFFERnew FlowableOnSubscribe<CodeNode>(...) { ... }getSearchString(...)CodeNode nodegetLineStr(...)setPos(...)onComplete(...)import java.util.concurrent.*import FlowableEmitterimport JResSearchNodeimport static StringUtils.*List<JResource> resNodes, ...;Set<String> extSet, ...;String fileExts, ...;boolean anyExt, ...;int sizeLimit, ...;int lastPosint lastLineOccurredJResSearchNode lastNodeint searchStrLensetStartPos(...)String lineTextcountLinesByPos(...)new JResSearchNode(...)refreshSettings(...)new FlowableOnSubscribe<JResSearchNode>(...) { ... }JResource resNodetraverseTree(...)shouldSearchXML(...)new Consumer<JResource>(...) { ... }ResourceFile fileFile zfileException ignoregetJadxSettings(...)getJRoot(...)// commit the final result node.// resource from ARSC is unknown size// reindexSearchSettings.classString searchString, ...;boolean useRegex, ...;boolean ignoreCase, ...;Pattern regexPattern, ...;int startPos, ...;this.searchStringthis.useRegexthis.ignoreCase/* Return whether Regex search should be done *//* Return whether case will be ignored *//* Return search string *//* Return the starting index */this.startPos/* Set Starting Index *//* get Regex Pattern */this.regexPattern/* Runs Pattern.compile if using Regex. If not using Regex return true ... */Pattern.CASE_INSENSITIVE/* Checks if searchArea matches the searched string found in searchSettings *//* Returns the position within searchArea that the searched string found in searchSettings was ... */Matcher matcherindexOfIgnoreCase(...)new ConcurrentHashMap<JNode,String>(...)Map<JNode,String> data, ...;new Predicate<Entry<JNode,String>>(...) { ... }new FlowableOnSubscribe<JNode>(...) { ... }Entry<JNode,String> entryMap<>.Entry<JNode,String>isMatched(...)import static UiUtils.caseCharString refStr, ...;int length, ...;new StringRef(...)subString(...)this.refStrthis.lengthchar firstcaseChar(...)int maxint targetLenList<StringRef> listnew ArrayList<StringRef>(...)int offStringRef otherSliceotherSlice.offsetString refStrString otherRefStrotherSlice.refStrotherSlice.lengthimport static SearchOptions.CLASSimport static SearchOptions.CODEimport static SearchOptions.FIELDimport static SearchOptions.IGNORE_CASEimport static SearchOptions.METHODimport static SearchOptions.Resourceimport static SearchOptions.USE_REGEXTextSearchIndex.classSimpleIndex clsNamesIndex, ...;SimpleIndex mthSignaturesIndex, ...;SimpleIndex fldSignaturesIndex, ...;CodeIndex codeIndex, ...;ResourceIndex resIndex, ...;List<JavaClass> skippedClasses, ...;this.resIndexnew ResourceIndex(...)this.clsNamesIndexnew SimpleIndex(...)this.mthSignaturesIndexthis.fldSignaturesIndexthis.codeIndexnew CodeIndex(...)JNode mthNodeJNode fldNodeStringRef lineint lineLengthJNode nodeAtLineindex(...)boolean ignoreCaseboolean useRegexFlowable<JNode> resultSearchSettings searchSettingsnew SearchSettings(...)preCompile(...)searchInSkippedClasses(...)searchNext(...)int lineStartint lineEndthis.skippedClassesPath guiJavaPath, ...;Path i18nPath, ...;List<String> reference, ...;String referenceName, ...;new Consumer<Path>(...) { ... }compareToReference(...)trimComment(...)int p0failLine(...)Set<String> keysnewBufferedReader(...)import Factoryimport static Arrays.asListimport static Mockito.mockimport static Mockito.whenJSources sources, ...;JRoot rootmock(...)JRoot.classthenReturn(...)when(...)newPkg(...)List<JPackage> outJPackage jPkgnewPackage(...)newClass(...)checkCompare(...)String CERTIFICATE_TEST_DIR, ...;String DSA, ...;String RSA, ...;String EMPTY, ...;String emptyPath, ...;CertificateManager certificateManagerRSA, ...;CertificateManager certificateManagerDSA, ...;String certPathgetResourcePath(...)getCertificateManger(...)String stringJumpManager jm, ...;makeJumpPos(...)JumpPosition pos1JumpPosition pos2JumpPosition pos3JumpPosition pos4JumpPosition pos5// 1@// 1 - 2@// 1@ - 2// 1 - 3@// 1@ - 3// 1 - 2 - 3@// 1 - 2 - 3 - 4@// 1 - 2 - 3@ - 4// 1 - 2@ - 3 - 4// 1 - 2 - 5@// 1 - 2@ - 5// 1@ - 2 - 5import static StringRef.fromStrimport static StringRef.subStringfromStr(...)checkStr(...)checkTrim(...)checkSplit(...)List<StringRef> expectedStringRegListnew Function<String,StringRef>(...) { ... }// compare with original splitimport ByteStreamsimport DexConstsDexFileLoader.classint dexUniqId, ...;new Function<File,List<DexReader>>(...) { ... }loadDexFromFile(...)new Predicate<List<DexReader>>(...) { ... }new Function<List<DexReader>,Stream<? extends DexReader>>(...) { ... }new Consumer<DexReader>(...) { ... }checkFileMagic(...)byte[] magicDexConsts.MAX_MAGIC_SIZEmagic.lengthisStartWithBytes(...)DexConsts.DEX_FILE_MAGICDexReader dexReadernew DexReader(...)getNextUniqId(...)readAllBytes(...)DexConsts.ZIP_FILE_MAGICcollectDexFromZip(...)List<DexReader> resultnew ArrayList<DexReader>(...)expectedBytes.lengthfileMagic.lengthresetDexUniqId(...)import JadxPluginInfoimport EmptyLoadResultnew JadxPluginInfo(...)loadDexFiles(...)List<DexReader> dexReaderscollectDexFiles(...)EmptyLoadResult.INSTANCEnew DexLoadResult(...)import IResourceDataList<DexReader> dexReaders, ...;Closeable closeable, ...;this.dexReadersthis.closeableimport ByteBufferimport DexClassDataimport DexHeaderimport SectionReaderimport AnnotationsParserint uniqId, ...;String inputFileName, ...;ByteBuffer buf, ...;DexHeader header, ...;this.uniqIdthis.inputFileNamenew DexHeader(...)new SectionReader(...)getClassDefsSize(...)int classDefsOffgetClassDefsOff(...)SectionReader inAnnotationsParser annotationsParsernew AnnotationsParser(...)DexClassData classDatanew DexClassData(...)shiftOffset(...)DexClassData.SIZEimport InsnIndexTypeimport ICustomPayloadimport DexCodeReaderDexCodeReader codeData, ...;SectionReader externalReader, ...;SectionReader secondExtReader, ...;DexInsnInfo insnInfo, ...;boolean decoded, ...;int opcodeUnit, ...;...[] argsReg, ...;ICustomPayload payload, ...;this.codeDatathis.externalReaderthis.secondExtReaderDexInsnInfo infothis.insnInfogetApiOpcode(...)getFieldData(...)getCallSite(...)this.argsRegthis.decodedthis.opcodeUnitisDecoded(...)import DexExceptionimport DexArrayPayloadimport DexSwitchPayloadnew DexInsnFormat(...) { ... }int[] regsgetArgsReg(...)nibble2(...)nibble3(...)setLiteral(...)signedNibble3(...)byte1(...)setTarget(...)signedByte1(...)readUShort(...)...<<=...byte0(...)DexOpcodes.CONST_HIGH16readRegsList(...)readRegsRange(...)int firstKeysetPayload(...)new DexSwitchPayload(...)setLength(...)int elemSizeObject datareadByteArray(...)readUByte(...)short[] arraylong[] arraynew DexException(...)new DexArrayPayload(...)DexInsnFormat FORMAT_10X, ...;DexInsnFormat FORMAT_12X, ...;DexInsnFormat FORMAT_11N, ...;DexInsnFormat FORMAT_11X, ...;DexInsnFormat FORMAT_10T, ...;DexInsnFormat FORMAT_20T, ...;DexInsnFormat FORMAT_20BC, ...;DexInsnFormat FORMAT_22X, ...;DexInsnFormat FORMAT_21T, ...;DexInsnFormat FORMAT_21S, ...;DexInsnFormat FORMAT_21H, ...;DexInsnFormat FORMAT_21C, ...;DexInsnFormat FORMAT_23X, ...;DexInsnFormat FORMAT_22B, ...;DexInsnFormat FORMAT_22T, ...;DexInsnFormat FORMAT_22S, ...;DexInsnFormat FORMAT_22C, ...;DexInsnFormat FORMAT_22CS, ...;DexInsnFormat FORMAT_30T, ...;DexInsnFormat FORMAT_32X, ...;DexInsnFormat FORMAT_31I, ...;DexInsnFormat FORMAT_31T, ...;DexInsnFormat FORMAT_31C, ...;DexInsnFormat FORMAT_35C, ...;DexInsnFormat FORMAT_35MS, ...;DexInsnFormat FORMAT_35MI, ...;DexInsnFormat FORMAT_3RC, ...;DexInsnFormat FORMAT_3RMS, ...;DexInsnFormat FORMAT_3RMI, ...;DexInsnFormat FORMAT_45CC, ...;DexInsnFormat FORMAT_4RCC, ...;DexInsnFormat FORMAT_51I, ...;DexInsnFormat FORMAT_PACKED_SWITCH_PAYLOAD, ...;DexInsnFormat FORMAT_SPARSE_SWITCH_PAYLOAD, ...;DexInsnFormat FORMAT_FILL_ARRAY_DATA_PAYLOAD, ...;int regsCount1int rsnibble0(...)nibble1(...)setRegsCount(...)int startRegsetArgsReg(...)DexInsnInfo[] arrnew DexInsnInfo[]DexOpcodes.NOPOpcode.NOPDexInsnFormat.FORMAT_10XDexOpcodes.MOVEOpcode.MOVEDexInsnFormat.FORMAT_12XDexOpcodes.MOVE_FROM16DexInsnFormat.FORMAT_22XDexOpcodes.MOVE_16DexInsnFormat.FORMAT_32XDexOpcodes.MOVE_WIDEOpcode.MOVE_WIDEDexOpcodes.MOVE_WIDE_FROM16DexOpcodes.MOVE_WIDE_16DexOpcodes.MOVE_OBJECTOpcode.MOVE_OBJECTDexOpcodes.MOVE_OBJECT_FROM16DexOpcodes.MOVE_OBJECT_16DexOpcodes.MOVE_RESULTOpcode.MOVE_RESULTDexInsnFormat.FORMAT_11XDexOpcodes.MOVE_RESULT_WIDEDexOpcodes.MOVE_RESULT_OBJECTDexOpcodes.MOVE_EXCEPTIONOpcode.MOVE_EXCEPTIONDexOpcodes.RETURN_VOIDOpcode.RETURN_VOIDDexOpcodes.RETURNOpcode.RETURNDexOpcodes.RETURN_WIDEDexOpcodes.RETURN_OBJECTDexOpcodes.CONST_4Opcode.CONSTDexInsnFormat.FORMAT_11NDexOpcodes.CONST_16DexInsnFormat.FORMAT_21SDexOpcodes.CONSTDexInsnFormat.FORMAT_31IDexInsnFormat.FORMAT_21HDexOpcodes.CONST_WIDE_16Opcode.CONST_WIDEDexOpcodes.CONST_WIDE_32DexOpcodes.CONST_WIDEDexInsnFormat.FORMAT_51IDexOpcodes.CONST_WIDE_HIGH16DexOpcodes.CONST_STRINGOpcode.CONST_STRINGDexInsnFormat.FORMAT_21CInsnIndexType.STRING_REFDexOpcodes.CONST_STRING_JUMBODexInsnFormat.FORMAT_31CDexOpcodes.CONST_CLASSOpcode.CONST_CLASSInsnIndexType.TYPE_REFDexOpcodes.MONITOR_ENTEROpcode.MONITOR_ENTERDexOpcodes.MONITOR_EXITOpcode.MONITOR_EXITDexOpcodes.CHECK_CASTOpcode.CHECK_CASTDexOpcodes.INSTANCE_OFOpcode.INSTANCE_OFDexInsnFormat.FORMAT_22CDexOpcodes.ARRAY_LENGTHOpcode.ARRAY_LENGTHDexOpcodes.NEW_INSTANCEOpcode.NEW_INSTANCEDexOpcodes.NEW_ARRAYOpcode.NEW_ARRAYDexOpcodes.FILLED_NEW_ARRAYOpcode.FILLED_NEW_ARRAYDexInsnFormat.FORMAT_35CDexOpcodes.FILLED_NEW_ARRAY_RANGEOpcode.FILLED_NEW_ARRAY_RANGEDexInsnFormat.FORMAT_3RCDexOpcodes.FILL_ARRAY_DATAOpcode.FILL_ARRAY_DATADexInsnFormat.FORMAT_31TDexOpcodes.THROWOpcode.THROWDexOpcodes.GOTOOpcode.GOTODexInsnFormat.FORMAT_10TDexOpcodes.GOTO_16DexInsnFormat.FORMAT_20TDexOpcodes.GOTO_32DexInsnFormat.FORMAT_30TDexOpcodes.PACKED_SWITCHOpcode.PACKED_SWITCHDexOpcodes.SPARSE_SWITCHOpcode.SPARSE_SWITCHDexOpcodes.CMPL_FLOATOpcode.CMPL_FLOATDexInsnFormat.FORMAT_23XDexOpcodes.CMPG_FLOATOpcode.CMPG_FLOATDexOpcodes.CMPL_DOUBLEOpcode.CMPL_DOUBLEDexOpcodes.CMPG_DOUBLEOpcode.CMPG_DOUBLEDexOpcodes.CMP_LONGOpcode.CMP_LONGDexOpcodes.IF_EQOpcode.IF_EQDexInsnFormat.FORMAT_22TDexOpcodes.IF_NEOpcode.IF_NEDexOpcodes.IF_LTOpcode.IF_LTDexOpcodes.IF_GEOpcode.IF_GEDexOpcodes.IF_GTOpcode.IF_GTDexOpcodes.IF_LEOpcode.IF_LEDexOpcodes.IF_EQZOpcode.IF_EQZDexInsnFormat.FORMAT_21TDexOpcodes.IF_NEZOpcode.IF_NEZDexOpcodes.IF_LTZOpcode.IF_LTZDexOpcodes.IF_GEZOpcode.IF_GEZDexOpcodes.IF_GTZOpcode.IF_GTZDexOpcodes.IF_LEZOpcode.IF_LEZDexOpcodes.AGETOpcode.AGETDexOpcodes.AGET_WIDEOpcode.AGET_WIDEDexOpcodes.AGET_OBJECTOpcode.AGET_OBJECTDexOpcodes.AGET_BOOLEANOpcode.AGET_BOOLEANDexOpcodes.AGET_BYTEOpcode.AGET_BYTEDexOpcodes.AGET_CHAROpcode.AGET_CHARDexOpcodes.AGET_SHORTOpcode.AGET_SHORTDexOpcodes.APUTOpcode.APUTDexOpcodes.APUT_WIDEOpcode.APUT_WIDEDexOpcodes.APUT_OBJECTOpcode.APUT_OBJECTDexOpcodes.APUT_BOOLEANOpcode.APUT_BOOLEANDexOpcodes.APUT_BYTEOpcode.APUT_BYTEDexOpcodes.APUT_CHAROpcode.APUT_CHARDexOpcodes.APUT_SHORTOpcode.APUT_SHORTDexOpcodes.IGETOpcode.IGETInsnIndexType.FIELD_REFDexOpcodes.IGET_WIDEDexOpcodes.IGET_OBJECTDexOpcodes.IGET_BOOLEANDexOpcodes.IGET_BYTEDexOpcodes.IGET_CHARDexOpcodes.IGET_SHORTDexOpcodes.IPUTOpcode.IPUTDexOpcodes.IPUT_WIDEDexOpcodes.IPUT_OBJECTDexOpcodes.IPUT_BOOLEANDexOpcodes.IPUT_BYTEDexOpcodes.IPUT_CHARDexOpcodes.IPUT_SHORTDexOpcodes.SGETOpcode.SGETDexOpcodes.SGET_WIDEDexOpcodes.SGET_OBJECTDexOpcodes.SGET_BOOLEANDexOpcodes.SGET_BYTEDexOpcodes.SGET_CHARDexOpcodes.SGET_SHORTDexOpcodes.SPUTOpcode.SPUTDexOpcodes.SPUT_WIDEDexOpcodes.SPUT_OBJECTDexOpcodes.SPUT_BOOLEANDexOpcodes.SPUT_BYTEDexOpcodes.SPUT_CHARDexOpcodes.SPUT_SHORTDexOpcodes.INVOKE_VIRTUALOpcode.INVOKE_VIRTUALInsnIndexType.METHOD_REFDexOpcodes.INVOKE_SUPEROpcode.INVOKE_SUPERDexOpcodes.INVOKE_DIRECTOpcode.INVOKE_DIRECTDexOpcodes.INVOKE_STATICOpcode.INVOKE_STATICDexOpcodes.INVOKE_INTERFACEOpcode.INVOKE_INTERFACEDexOpcodes.INVOKE_VIRTUAL_RANGEOpcode.INVOKE_VIRTUAL_RANGEDexOpcodes.INVOKE_SUPER_RANGEOpcode.INVOKE_SUPER_RANGEDexOpcodes.INVOKE_DIRECT_RANGEOpcode.INVOKE_DIRECT_RANGEDexOpcodes.INVOKE_STATIC_RANGEOpcode.INVOKE_STATIC_RANGEDexOpcodes.INVOKE_INTERFACE_RANGEOpcode.INVOKE_INTERFACE_RANGEDexOpcodes.NEG_INTOpcode.NEG_INTDexOpcodes.NOT_INTOpcode.NOT_INTDexOpcodes.NEG_LONGOpcode.NEG_LONGDexOpcodes.NOT_LONGOpcode.NOT_LONGDexOpcodes.NEG_FLOATOpcode.NEG_FLOATDexOpcodes.NEG_DOUBLEOpcode.NEG_DOUBLEDexOpcodes.INT_TO_LONGOpcode.INT_TO_LONGDexOpcodes.INT_TO_FLOATOpcode.INT_TO_FLOATDexOpcodes.INT_TO_DOUBLEOpcode.INT_TO_DOUBLEDexOpcodes.LONG_TO_INTOpcode.LONG_TO_INTDexOpcodes.LONG_TO_FLOATOpcode.LONG_TO_FLOATDexOpcodes.LONG_TO_DOUBLEOpcode.LONG_TO_DOUBLEDexOpcodes.FLOAT_TO_INTOpcode.FLOAT_TO_INTDexOpcodes.FLOAT_TO_LONGOpcode.FLOAT_TO_LONGDexOpcodes.FLOAT_TO_DOUBLEOpcode.FLOAT_TO_DOUBLEDexOpcodes.DOUBLE_TO_INTOpcode.DOUBLE_TO_INTDexOpcodes.DOUBLE_TO_LONGOpcode.DOUBLE_TO_LONGDexOpcodes.DOUBLE_TO_FLOATOpcode.DOUBLE_TO_FLOATDexOpcodes.INT_TO_BYTEOpcode.INT_TO_BYTEDexOpcodes.INT_TO_CHAROpcode.INT_TO_CHARDexOpcodes.INT_TO_SHORTOpcode.INT_TO_SHORTDexOpcodes.ADD_INTOpcode.ADD_INTDexOpcodes.SUB_INTOpcode.SUB_INTDexOpcodes.MUL_INTOpcode.MUL_INTDexOpcodes.DIV_INTOpcode.DIV_INTDexOpcodes.REM_INTOpcode.REM_INTDexOpcodes.AND_INTOpcode.AND_INTDexOpcodes.OR_INTOpcode.OR_INTDexOpcodes.XOR_INTOpcode.XOR_INTDexOpcodes.SHL_INTOpcode.SHL_INTDexOpcodes.SHR_INTOpcode.SHR_INTDexOpcodes.USHR_INTOpcode.USHR_INTDexOpcodes.ADD_LONGOpcode.ADD_LONGDexOpcodes.SUB_LONGOpcode.SUB_LONGDexOpcodes.MUL_LONGOpcode.MUL_LONGDexOpcodes.DIV_LONGOpcode.DIV_LONGDexOpcodes.REM_LONGOpcode.REM_LONGDexOpcodes.AND_LONGOpcode.AND_LONGDexOpcodes.OR_LONGOpcode.OR_LONGDexOpcodes.XOR_LONGOpcode.XOR_LONGDexOpcodes.SHL_LONGOpcode.SHL_LONGDexOpcodes.SHR_LONGOpcode.SHR_LONGDexOpcodes.USHR_LONGOpcode.USHR_LONGDexOpcodes.ADD_FLOATOpcode.ADD_FLOATDexOpcodes.SUB_FLOATOpcode.SUB_FLOATDexOpcodes.MUL_FLOATOpcode.MUL_FLOATDexOpcodes.DIV_FLOATOpcode.DIV_FLOATDexOpcodes.REM_FLOATOpcode.REM_FLOATDexOpcodes.ADD_DOUBLEOpcode.ADD_DOUBLEDexOpcodes.SUB_DOUBLEOpcode.SUB_DOUBLEDexOpcodes.MUL_DOUBLEOpcode.MUL_DOUBLEDexOpcodes.DIV_DOUBLEOpcode.DIV_DOUBLEDexOpcodes.REM_DOUBLEOpcode.REM_DOUBLEDexOpcodes.ADD_INT_2ADDRDexOpcodes.SUB_INT_2ADDRDexOpcodes.MUL_INT_2ADDRDexOpcodes.DIV_INT_2ADDRDexOpcodes.REM_INT_2ADDRDexOpcodes.AND_INT_2ADDRDexOpcodes.OR_INT_2ADDRDexOpcodes.XOR_INT_2ADDRDexOpcodes.SHL_INT_2ADDRDexOpcodes.SHR_INT_2ADDRDexOpcodes.USHR_INT_2ADDRDexOpcodes.ADD_LONG_2ADDRDexOpcodes.SUB_LONG_2ADDRDexOpcodes.MUL_LONG_2ADDRDexOpcodes.DIV_LONG_2ADDRDexOpcodes.REM_LONG_2ADDRDexOpcodes.AND_LONG_2ADDRDexOpcodes.OR_LONG_2ADDRDexOpcodes.XOR_LONG_2ADDRDexOpcodes.SHL_LONG_2ADDRDexOpcodes.SHR_LONG_2ADDRDexOpcodes.USHR_LONG_2ADDRDexOpcodes.ADD_FLOAT_2ADDRDexOpcodes.SUB_FLOAT_2ADDRDexOpcodes.MUL_FLOAT_2ADDRDexOpcodes.DIV_FLOAT_2ADDRDexOpcodes.REM_FLOAT_2ADDRDexOpcodes.ADD_DOUBLE_2ADDRDexOpcodes.SUB_DOUBLE_2ADDRDexOpcodes.MUL_DOUBLE_2ADDRDexOpcodes.DIV_DOUBLE_2ADDRDexOpcodes.REM_DOUBLE_2ADDRDexOpcodes.ADD_INT_LIT16Opcode.ADD_INT_LITDexInsnFormat.FORMAT_22SDexOpcodes.RSUB_INTOpcode.RSUB_INTDexOpcodes.MUL_INT_LIT16Opcode.MUL_INT_LITDexOpcodes.DIV_INT_LIT16Opcode.DIV_INT_LITDexOpcodes.REM_INT_LIT16Opcode.REM_INT_LITDexOpcodes.AND_INT_LIT16Opcode.AND_INT_LITDexOpcodes.OR_INT_LIT16Opcode.OR_INT_LITDexOpcodes.XOR_INT_LIT16Opcode.XOR_INT_LITDexOpcodes.ADD_INT_LIT8DexInsnFormat.FORMAT_22BDexOpcodes.RSUB_INT_LIT8DexOpcodes.MUL_INT_LIT8DexOpcodes.DIV_INT_LIT8DexOpcodes.REM_INT_LIT8DexOpcodes.AND_INT_LIT8DexOpcodes.OR_INT_LIT8DexOpcodes.XOR_INT_LIT8DexOpcodes.SHL_INT_LIT8Opcode.SHL_INT_LITDexOpcodes.SHR_INT_LIT8Opcode.SHR_INT_LITDexOpcodes.USHR_INT_LIT8Opcode.USHR_INT_LITDexOpcodes.INVOKE_POLYMORPHICOpcode.INVOKE_POLYMORPHICDexInsnFormat.FORMAT_45CCDexOpcodes.INVOKE_POLYMORPHIC_RANGEOpcode.INVOKE_POLYMORPHIC_RANGEDexInsnFormat.FORMAT_4RCCDexOpcodes.INVOKE_CUSTOMOpcode.INVOKE_CUSTOMDexOpcodes.INVOKE_CUSTOM_RANGEOpcode.INVOKE_CUSTOM_RANGEDexOpcodes.CONST_METHOD_HANDLEOpcode.CONST_METHOD_HANDLEDexOpcodes.CONST_METHOD_TYPEOpcode.CONST_METHOD_TYPEnew ConcurrentHashMap<Integer,DexInsnInfo>(...)registerPayload(...)DexOpcodes.PACKED_SWITCH_PAYLOADOpcode.PACKED_SWITCH_PAYLOADDexInsnFormat.FORMAT_PACKED_SWITCH_PAYLOADDexOpcodes.SPARSE_SWITCH_PAYLOADOpcode.SPARSE_SWITCH_PAYLOADDexInsnFormat.FORMAT_SPARSE_SWITCH_PAYLOADDexOpcodes.FILL_ARRAY_DATA_PAYLOADOpcode.FILL_ARRAY_DATA_PAYLOADDexInsnFormat.FORMAT_FILL_ARRAY_DATA_PAYLOAD...[] INSN_INFO, ...;Map<Integer,DexInsnInfo> PAYLOAD_INFO, ...;new DexInsnInfo(...)InsnIndexType.NONEint opcodeint opcode, ...;Opcode apiOpcode, ...;DexInsnFormat format, ...;InsnIndexType indexType, ...;this.opcodethis.apiOpcodethis.formatthis.indexTypeint NOP, ...;int MOVE, ...;int MOVE_FROM16, ...;int MOVE_16, ...;int MOVE_WIDE, ...;int MOVE_WIDE_FROM16, ...;int MOVE_WIDE_16, ...;int MOVE_OBJECT, ...;int MOVE_OBJECT_FROM16, ...;int MOVE_OBJECT_16, ...;int MOVE_RESULT, ...;int MOVE_RESULT_WIDE, ...;int MOVE_RESULT_OBJECT, ...;int MOVE_EXCEPTION, ...;int RETURN_VOID, ...;int RETURN, ...;int RETURN_WIDE, ...;int RETURN_OBJECT, ...;int CONST_4, ...;int CONST_16, ...;int CONST_HIGH16, ...;int CONST_WIDE_16, ...;int CONST_WIDE_32, ...;int CONST_WIDE, ...;int CONST_WIDE_HIGH16, ...;int CONST_STRING, ...;int CONST_STRING_JUMBO, ...;int CONST_CLASS, ...;int MONITOR_ENTER, ...;int MONITOR_EXIT, ...;int CHECK_CAST, ...;int INSTANCE_OF, ...;int ARRAY_LENGTH, ...;int NEW_INSTANCE, ...;int NEW_ARRAY, ...;int FILLED_NEW_ARRAY, ...;int FILLED_NEW_ARRAY_RANGE, ...;int FILL_ARRAY_DATA, ...;int THROW, ...;int GOTO, ...;int GOTO_16, ...;int GOTO_32, ...;int PACKED_SWITCH, ...;int SPARSE_SWITCH, ...;int CMPL_FLOAT, ...;int CMPG_FLOAT, ...;int CMPL_DOUBLE, ...;int CMPG_DOUBLE, ...;int CMP_LONG, ...;int IF_EQ, ...;int IF_NE, ...;int IF_LT, ...;int IF_GE, ...;int IF_GT, ...;int IF_LE, ...;int IF_EQZ, ...;int IF_NEZ, ...;int IF_LTZ, ...;int IF_GEZ, ...;int IF_GTZ, ...;int IF_LEZ, ...;int AGET, ...;int AGET_WIDE, ...;int AGET_OBJECT, ...;int AGET_BOOLEAN, ...;int AGET_BYTE, ...;int AGET_CHAR, ...;int AGET_SHORT, ...;int APUT, ...;int APUT_WIDE, ...;int APUT_OBJECT, ...;int APUT_BOOLEAN, ...;int APUT_BYTE, ...;int APUT_CHAR, ...;int APUT_SHORT, ...;int IGET, ...;int IGET_WIDE, ...;int IGET_OBJECT, ...;int IGET_BOOLEAN, ...;int IGET_BYTE, ...;int IGET_CHAR, ...;int IGET_SHORT, ...;int IPUT, ...;int IPUT_WIDE, ...;int IPUT_OBJECT, ...;int IPUT_BOOLEAN, ...;int IPUT_BYTE, ...;int IPUT_CHAR, ...;int IPUT_SHORT, ...;int SGET, ...;int SGET_WIDE, ...;int SGET_OBJECT, ...;int SGET_BOOLEAN, ...;int SGET_BYTE, ...;int SGET_CHAR, ...;int SGET_SHORT, ...;int SPUT, ...;int SPUT_WIDE, ...;int SPUT_OBJECT, ...;int SPUT_BOOLEAN, ...;int SPUT_BYTE, ...;int SPUT_CHAR, ...;int SPUT_SHORT, ...;int INVOKE_VIRTUAL, ...;int INVOKE_SUPER, ...;int INVOKE_DIRECT, ...;int INVOKE_STATIC, ...;int INVOKE_INTERFACE, ...;int INVOKE_VIRTUAL_RANGE, ...;int INVOKE_SUPER_RANGE, ...;int INVOKE_DIRECT_RANGE, ...;int INVOKE_STATIC_RANGE, ...;int INVOKE_INTERFACE_RANGE, ...;int NEG_INT, ...;int NOT_INT, ...;int NEG_LONG, ...;int NOT_LONG, ...;int NEG_FLOAT, ...;int NEG_DOUBLE, ...;int INT_TO_LONG, ...;int INT_TO_FLOAT, ...;int INT_TO_DOUBLE, ...;int LONG_TO_INT, ...;int LONG_TO_FLOAT, ...;int LONG_TO_DOUBLE, ...;int FLOAT_TO_INT, ...;int FLOAT_TO_LONG, ...;int FLOAT_TO_DOUBLE, ...;int DOUBLE_TO_INT, ...;int DOUBLE_TO_LONG, ...;int DOUBLE_TO_FLOAT, ...;int INT_TO_BYTE, ...;int INT_TO_CHAR, ...;int INT_TO_SHORT, ...;int ADD_INT, ...;int SUB_INT, ...;int MUL_INT, ...;int DIV_INT, ...;int REM_INT, ...;int AND_INT, ...;int OR_INT, ...;int XOR_INT, ...;int SHL_INT, ...;int SHR_INT, ...;int USHR_INT, ...;int ADD_LONG, ...;int SUB_LONG, ...;int MUL_LONG, ...;int DIV_LONG, ...;int REM_LONG, ...;int AND_LONG, ...;int OR_LONG, ...;int XOR_LONG, ...;int SHL_LONG, ...;int SHR_LONG, ...;int USHR_LONG, ...;int ADD_FLOAT, ...;int SUB_FLOAT, ...;int MUL_FLOAT, ...;int DIV_FLOAT, ...;int REM_FLOAT, ...;int ADD_DOUBLE, ...;int SUB_DOUBLE, ...;int MUL_DOUBLE, ...;int DIV_DOUBLE, ...;int REM_DOUBLE, ...;int ADD_INT_2ADDR, ...;int SUB_INT_2ADDR, ...;int MUL_INT_2ADDR, ...;int DIV_INT_2ADDR, ...;int REM_INT_2ADDR, ...;int AND_INT_2ADDR, ...;int OR_INT_2ADDR, ...;int XOR_INT_2ADDR, ...;int SHL_INT_2ADDR, ...;int SHR_INT_2ADDR, ...;int USHR_INT_2ADDR, ...;int ADD_LONG_2ADDR, ...;int SUB_LONG_2ADDR, ...;int MUL_LONG_2ADDR, ...;int DIV_LONG_2ADDR, ...;int REM_LONG_2ADDR, ...;int AND_LONG_2ADDR, ...;int OR_LONG_2ADDR, ...;int XOR_LONG_2ADDR, ...;int SHL_LONG_2ADDR, ...;int SHR_LONG_2ADDR, ...;int USHR_LONG_2ADDR, ...;int ADD_FLOAT_2ADDR, ...;int SUB_FLOAT_2ADDR, ...;int MUL_FLOAT_2ADDR, ...;int DIV_FLOAT_2ADDR, ...;int REM_FLOAT_2ADDR, ...;int ADD_DOUBLE_2ADDR, ...;int SUB_DOUBLE_2ADDR, ...;int MUL_DOUBLE_2ADDR, ...;int DIV_DOUBLE_2ADDR, ...;int REM_DOUBLE_2ADDR, ...;int ADD_INT_LIT16, ...;int RSUB_INT, ...;int MUL_INT_LIT16, ...;int DIV_INT_LIT16, ...;int REM_INT_LIT16, ...;int AND_INT_LIT16, ...;int OR_INT_LIT16, ...;int XOR_INT_LIT16, ...;int ADD_INT_LIT8, ...;int RSUB_INT_LIT8, ...;int MUL_INT_LIT8, ...;int DIV_INT_LIT8, ...;int REM_INT_LIT8, ...;int AND_INT_LIT8, ...;int OR_INT_LIT8, ...;int XOR_INT_LIT8, ...;int SHL_INT_LIT8, ...;int SHR_INT_LIT8, ...;int USHR_INT_LIT8, ...;int INVOKE_POLYMORPHIC, ...;int INVOKE_POLYMORPHIC_RANGE, ...;int INVOKE_CUSTOM, ...;int INVOKE_CUSTOM_RANGE, ...;int CONST_METHOD_HANDLE, ...;int CONST_METHOD_TYPE, ...;int PACKED_SWITCH_PAYLOAD, ...;// payload pseudo-instructionsint SPARSE_SWITCH_PAYLOAD, ...;int FILL_ARRAY_DATA_PAYLOAD, ...;List<EncodedValue> values, ...;this.valuesimport SmaliUtilsint SIZE, ...;SectionReader in, ...;AnnotationsParser annotationsParser, ...;this.inthis.annotationsParserint typeIdxpos(...)String clsTypereadTypeList(...)absPos(...)int strIdxgetDexReader(...)int classDataOffgetClassDataOff(...)SectionReader dataint staticFieldsCountreadUleb128(...)int instanceFieldsCountint directMthCountint virtualMthCountgetAnnotationsOff(...)visitFields(...)visitMethods(...)Map<Integer,Integer> annotationOffsetMapreadFieldsAnnotationOffsetMap(...)DexFieldData fieldDatanew DexFieldData(...)setParentClassType(...)readFields(...)int fieldIdfillFieldData(...)setAnnotationsOffset(...)getOffsetFromMap(...)DexMethodData methodDatanew DexMethodData(...)readMethodsAnnotationOffsetMap(...)Map<Integer,Integer> paramsAnnOffsetMapreadMethodParamsAnnRefOffsetMap(...)setMethodRef(...)new DexMethodRef(...)setDirect(...)readMethods(...)DexCodeReader dexCodeReadernew DexCodeReader(...)int mthIdxint codeOffDexMethodRef methodRefinitMethodRef(...)setCodeReader(...)setMthId(...)setParamAnnotationsOffset(...)Integer offsetint staticValuesOffgetStaticValuesOff(...)parseEncodedArray(...)readClassAnnotations(...)getAbsPos(...)byte[] dexBufgetBuf(...)getSmaliCode(...)getClassDefOffset(...)import DexInsnDataimport DexInsnFormatimport DexInsnInfoimport DebugInfoParserimport DexCatchimport DexTryDataint mthId, ...;DexCodeReader copygetMthId(...)DexInsnData insnDatanew DexInsnData(...)int opcodeUnitDexInsnInfo insnInfosetInsnInfo(...)setOpcodeUnit(...)setDecoded(...)DexInsnFormat formatgetFormat(...)getInsnInfo(...)getOpcodeUnit(...)getCodeData(...).ingetCodeData(...)DexCodeReader codeReadercodeReader.inint debugOffDebugInfoParser debugInfoParsernew DebugInfoParser(...)initMthArgs(...)getMethodParamTypes(...)int triesCountgetTriesCount(...)int paddingint triesOffsetgetTriesOffset(...)Map<Integer,ICatch> catchHandlersgetCatchHandlers(...)List<ITry> triesListnew ArrayList<ITry>(...)int handlerOffICatch catchHandlernew DexTryData(...)int byteOffsetStartMap<Integer,ICatch> mapnew HashMap<Integer,ICatch>(...)int byteIndexint sizeAndTypereadSleb128(...)int handlersLenint[] addrint catchAllAddrnew DexCatch(...)this.mthId// in code units (2 byte)...[] DEX_FILE_MAGIC, ...;...[] ZIP_FILE_MAGIC, ...;// 'dex\n'int MAX_MAGIC_SIZE, ...;int ENDIAN_CONSTANT, ...;int NO_INDEX, ...;String parentClassType, ...;int annotationsOffset, ...;this.parentClassTypethis.annotationsOffsetreadAnnotationList(...)String version, ...;int classDefsSize, ...;int classDefsOff, ...;int stringIdsOff, ...;int typeIdsOff, ...;int typeIdsSize, ...;int fieldIdsSize, ...;int fieldIdsOff, ...;int protoIdsSize, ...;int protoIdsOff, ...;int methodIdsOff, ...;int methodIdsSize, ...;int callSiteOff, ...;int methodHandleOff, ...;int checksumbyte[] signatureint fileSizeint endianTagint linkSizeint linkOffint mapListOffint stringIdsSizeint dataOffDexConsts.ENDIAN_CONSTANTreadMapList(...)import SmaliPrinterDexMethodRef methodRef, ...;boolean isDirect, ...;int paramAnnotationsOffset, ...;DexCodeReader codeReader, ...;this.methodRefprintMethod(...)this.paramAnnotationsOffsetgetAnnotationsParser(...)readAnnotationRefList(...)List<String> argTypes, ...;listToStr(...)import DexReaderint dexIdx, ...;// lazy loading infoSectionReader sectionReader, ...;loadMethodRef(...)this.dexIdxthis.sectionReader// not loadedimport ByteOrderimport FieldRefHandleimport MethodRefHandleimport EncodedValueParserimport Leb128import MUtf8import static DexConsts.NO_INDEXDexReader dexReader, ...;this.dexReadersectionReader.dexReaderByteBuffer dupBuforder(...)ByteOrder.LITTLE_ENDIANposition(...)getShort(...)StandardCharsets.US_ASCIIint[] typeIdsreadUShortArray(...)List<String> typesint typeIdint typeIdsOffgetTypeIdsOff(...)int stringIdsOffgetStringIdsOff(...)int strOffint clsTypeIdxint fieldIdsOffgetFieldIdsOff(...)int classTypeIdxint nameIdxint callSiteOffgetCallSiteOff(...)new DexCallSite(...)int methodHandleOffgetMethodHandleOff(...)MethodHandleType handleTypegetMethodHandleType(...)int refIdnew FieldRefHandle(...)new MethodRefHandle(...)MethodHandleType.STATIC_PUTMethodHandleType.STATIC_GETMethodHandleType.INSTANCE_PUTMethodHandleType.INSTANCE_GETMethodHandleType.INVOKE_INSTANCEMethodHandleType.INVOKE_DIRECTMethodHandleType.INVOKE_INTERFACEinitUniqId(...)setDexIdx(...)setSectionReader(...)DexHeader headerint methodIdsOffgetMethodIdsOff(...)int protoIdxint protoIdsOffgetProtoIdsOff(...)int returnTypeIdxint paramsOffList<String> argTypesreadTypeListAt(...)new DexMethodProto(...)readUnsignedLeb128(...)readSignedLeb128(...)// TODO: make string pool cache?// shortyIdxSectionReader ext, ...;int fieldsCount, ...;int methodsCount, ...;int paramsRefCount, ...;this.extthis.fieldsCountthis.methodsCountthis.paramsRefCountint classAnnotationsOffsetint fieldIdxint fieldAnnOffsetint methodIdxint methodAnnOffsetint methodAnnRefOffsetList<IAnnotation> listnew ArrayList<IAnnotation>(...)int annOffsetreadAnnotation(...)List<List<IAnnotation>> listnew ArrayList<List<IAnnotation>>(...)int refOffAnnotationVisibility visibilityint typeIndexMap<String,EncodedValue> valuesnew LinkedHashMap<String,EncodedValue>(...)getVisibilityValue(...)new DexAnnotation(...)AnnotationVisibility.BUILDAnnotationVisibility.RUNTIMEAnnotationVisibility visibility, ...;Map<String,EncodedValue> values, ...;this.visibilityint ENCODED_BYTE, ...;int ENCODED_SHORT, ...;int ENCODED_CHAR, ...;int ENCODED_INT, ...;int ENCODED_LONG, ...;int ENCODED_FLOAT, ...;int ENCODED_DOUBLE, ...;int ENCODED_METHOD_TYPE, ...;int ENCODED_METHOD_HANDLE, ...;int ENCODED_STRING, ...;int ENCODED_TYPE, ...;int ENCODED_FIELD, ...;int ENCODED_ENUM, ...;int ENCODED_METHOD, ...;int ENCODED_ARRAY, ...;int ENCODED_ANNOTATION, ...;int ENCODED_NULL, ...;int ENCODED_BOOLEAN, ...;int argAndTypeint argEncodedType.ENCODED_BOOLEANEncodedType.ENCODED_BYTEEncodedType.ENCODED_SHORTparseNumber(...)EncodedType.ENCODED_CHARparseUnsignedInt(...)EncodedType.ENCODED_LONGEncodedType.ENCODED_FLOATEncodedType.ENCODED_DOUBLEEncodedType.ENCODED_TYPEEncodedType.ENCODED_ANNOTATIONEncodedType.ENCODED_METHODEncodedType.ENCODED_METHOD_TYPEgetMethodProto(...)EncodedType.ENCODED_METHOD_HANDLEgetMethodHandle(...)new ArrayList<EncodedValue>(...)long resultlong lastMap<Integer,Integer> sourceLineMap, ...;this.sourceLineMapint DBG_END_SEQUENCE, ...;int DBG_ADVANCE_PC, ...;int DBG_ADVANCE_LINE, ...;int DBG_START_LOCAL, ...;int DBG_START_LOCAL_EXTENDED, ...;int DBG_END_LOCAL, ...;int DBG_RESTART_LOCAL, ...;int DBG_SET_PROLOGUE_END, ...;int DBG_SET_EPILOGUE_BEGIN, ...;int DBG_SET_FILE, ...;int DBG_FIRST_SPECIAL, ...;// the smallest special opcodeint DBG_LINE_BASE, ...;// the smallest line number incrementint DBG_LINE_RANGE, ...;// the number of line increments represented...[] locals, ...;int codeSize, ...;List<ILocalVar> resultList, ...;Map<Integer,Integer> linesMap, ...;String sourceFile, ...;...[] argRegs, ...;this.localsnew LocalVar[]this.codeSizeint[] argRegsArrgetTypeLen(...)this.argRegsboolean varsInfoFoundint paramsCountnew ArrayList<ILocalVar>(...)int nameIdreadUleb128p1(...)new LocalVar(...)addrChange(...)setLine(...)int addrIncLocalVar varDexConsts.NO_INDEXint signrestartVar(...)endVar(...)this.sourceFileint adjustedOpCodeisEnd(...)setSourceLines(...)new DebugInfo(...)int newAddrint maxAddrLocalVar prevLocalVar newVar// process '0' instructionboolean isEnd, ...;int endOffset, ...;this.signthis.isEnd/** Sets end address of local variable ... */this.endOffset...[] addr, ...;...[] types, ...;int allAddr, ...;this.addrthis.typesthis.allAddrICatch catchHandler, ...;int startAddr, ...;this.catchHandlerthis.startAddrSmaliCodeWriter codeWriter, ...;IMethodData mth, ...;InsnData insn, ...;this.codeWriterStringBuilder code, ...;buildIndent(...)StringBuilder simport DexOpcodesSmaliInsnFormat instance, ...;SmaliInsnFormat instanceSmaliInsnFormat.instancenew SmaliInsnFormat(...)Map<Integer,InsnFormatter> formatters, ...;registerFormatters(...)Map<Integer,InsnFormatter> mapnew HashMap<Integer,InsnFormatter>(...)new InsnFormatter(...) { ... }getCodeWriter(...)staticFieldInsn(...)constInsn(...)stringInsn(...)invokeInsn(...)oneArgsInsn(...)noArgsInsn(...)gotoInsn(...)simpleInsn(...)SmaliCodeWriter codeInsnData insnregAt(...)field(...)literal(...)regsList(...)int rawOpcodeUnitgetRawOpcodeUnit(...)InsnFormatter insnFormatterInsnFormatterInfo formatInfonew InsnFormatterInfo(...)new SmaliCodeWriter(...)// TODO: complete listimport DexMethodDataimport DexMethodRefimport static AccessFlagsScope.METHOD// TODO: not finishedSmaliCodeWriter codeWriterSmaliInsnFormat insnFormatInsnFormatterInfo formatterInfosetInsn(...)int signBits// Sign extend if appropriatechar[] outchar aimport ClassDefinitionimport BaksmaliOptionsimport DexBackedClassDefimport DexBackedDexFileimport IndentingWriterSmaliUtils.classStringWriter stringWriterDexBackedDexFile dexFilenew DexBackedDexFile(...)DexBackedClassDef dexBackedClassDefnew DexBackedClassDef(...)ClassDefinition classDefinitionnew ClassDefinition(...)new BaksmaliOptions(...)writeTo(...)new IndentingWriter(...)import AtomicIntegerimport AccessFlagsScopeimport SmaliTestUtilsprocessFile(...)getSystemResource(...)compileSmaliFromResource(...)List<Path> filesILoadResult resultnew DexInputPlugin(...)AtomicInteger countnew AtomicInteger(...)AccessFlagsScope.CLASSgetAndIncrement(...)disassembleMethod(...)isGreaterThan(...)import Smaliimport SmaliOptionsPath inputcompileSmali(...)Path tempFileSmaliOptions optionsnew SmaliOptions(...)List<String> inputFileNamesnew Function<Path,Path>(...) { ... }new Function<Path,String>(...) { ... }options.outputDexFileassemble(...)import ClassReadernew ClassReader(...)ConvertResult.classList<Path> converted, ...;List<Path> tmpPaths, ...;Path tmpPathimport DxContextimport MainString CHARSET_NAME, ...;Main.ArgumentsString dxErrorsByteArrayOutputStream errOutDxContext contextnew DxContext(...)DxArgs argsnew DxArgs(...)runDx(...)new Main(...)import FileSystemsimport FileTimeJavaConvertLoader.classConvertResult resultnew ConvertResult(...)processJars(...)processAars(...)processClassFiles(...)PathMatcher jarMatcherconvertJar(...)List<Path> clsFilesPath jarFilePath filegetNameFromClassFile(...)addTempPath(...)PathMatcher aarMatcherPath tempJarsaveInputStreamToFile(...)repackAndConvertJar(...)convertSimpleJar(...)Boolean repackNeedednew BiFunction<ZipFile,ZipEntry,Boolean>(...) { ... }byte[] clsFileContentinputStreamToByteArray(...)addJarEntry(...)Path tempDirectoryaddConvertedFiles(...)PathMatcher dexMatcherbyte[] fileContentFileTime lastModifiedTimetoMillis(...)ByteArrayOutputStream output// check if jar need a full repackage// Spring Boot jar// exclude duplicated classes// contains sub jars// need to exclude module filesimport DexInputPlugingetConverted(...)String pluginId, ...;this.pluginIdimport ServiceLoadernew HashMap<Class<? extends JadxPlugin>,JadxPlugin>(...)JadxPluginManager.classMap<Class<? extends JadxPlugin>,JadxPlugin> allPlugins, ...;ServiceLoader<JadxPlugin> jadxPluginsJadxPlugin.classJadxPlugin jadxPlugingetPluginInfo(...)new ArrayList<JadxPlugin>(...)new Predicate<JadxPlugin>(...) { ... }isInstance(...)JadxInputPlugin.classnew Function<JadxPlugin,JadxInputPlugin>(...) { ... }int PUBLIC, ...;int PRIVATE, ...;int PROTECTED, ...;int STATIC, ...;int FINAL, ...;int SYNCHRONIZED, ...;int SUPER, ...;int VOLATILE, ...;int BRIDGE, ...;int TRANSIENT, ...;int VARARGS, ...;int NATIVE, ...;int INTERFACE, ...;int ABSTRACT, ...;int STRICT, ...;int SYNTHETIC, ...;int ANNOTATION, ...;int ENUM, ...;int CONSTRUCTOR, ...;int DECLARED_SYNCHRONIZED, ...;hasFlag(...)new AccessFlagsScope(...)AccessFlagsScope CLASS, ...;AccessFlagsScope FIELD, ...;AccessFlagsScope METHOD, ...;/** Map instruction offset to source line number *//** Lazy loading for method info, until load() is called only getUniqId() can be used */new MethodHandleType(...)MethodHandleType STATIC_PUT, ...;MethodHandleType STATIC_GET, ...;MethodHandleType INSTANCE_PUT, ...;MethodHandleType INSTANCE_GET, ...;MethodHandleType INVOKE_STATIC, ...;MethodHandleType INVOKE_INSTANCE, ...;MethodHandleType INVOKE_DIRECT, ...;MethodHandleType INVOKE_CONSTRUCTOR, ...;MethodHandleType INVOKE_INTERFACE, ...;new AnnotationVisibility(...)AnnotationVisibility BUILD, ...;AnnotationVisibility RUNTIME, ...;AnnotationVisibility SYSTEM, ...;new EncodedType(...)EncodedType ENCODED_NULL, ...;EncodedType ENCODED_BOOLEAN, ...;EncodedType ENCODED_BYTE, ...;EncodedType ENCODED_SHORT, ...;EncodedType ENCODED_CHAR, ...;EncodedType ENCODED_INT, ...;EncodedType ENCODED_LONG, ...;EncodedType ENCODED_FLOAT, ...;EncodedType ENCODED_DOUBLE, ...;EncodedType ENCODED_STRING, ...;EncodedType ENCODED_TYPE, ...;EncodedType ENCODED_ENUM, ...;EncodedType ENCODED_FIELD, ...;EncodedType ENCODED_METHOD, ...;EncodedType ENCODED_METHOD_TYPE, ...;EncodedType ENCODED_METHOD_HANDLE, ...;EncodedType ENCODED_ARRAY, ...;EncodedType ENCODED_ANNOTATION, ...;EncodedValue NULL, ...;EncodedType type, ...;Object value, ...;EncodedValue thatnew EmptyLoadResult(...)EmptyLoadResult INSTANCE, ...;IFieldData fieldRef, ...;MethodHandleType type, ...;this.fieldRef// already loadedIMethodRef methodRef, ...;new InsnIndexType(...)InsnIndexType NONE, ...;InsnIndexType TYPE_REF, ...;InsnIndexType STRING_REF, ...;InsnIndexType FIELD_REF, ...;InsnIndexType METHOD_REF, ...;new Opcode(...)Opcode UNKNOWN, ...;Opcode NOP, ...;Opcode ADD_DOUBLE, ...;Opcode ADD_FLOAT, ...;Opcode ADD_INT, ...;Opcode ADD_INT_LIT, ...;Opcode ADD_LONG, ...;Opcode AND_INT, ...;Opcode AND_INT_LIT, ...;Opcode AND_LONG, ...;Opcode AGET, ...;Opcode AGET_BOOLEAN, ...;Opcode AGET_BYTE, ...;Opcode AGET_CHAR, ...;Opcode AGET_OBJECT, ...;Opcode AGET_SHORT, ...;Opcode AGET_WIDE, ...;Opcode APUT, ...;Opcode APUT_BOOLEAN, ...;Opcode APUT_BYTE, ...;Opcode APUT_CHAR, ...;Opcode APUT_OBJECT, ...;Opcode APUT_SHORT, ...;Opcode APUT_WIDE, ...;Opcode ARITH, ...;Opcode ARRAY_LENGTH, ...;Opcode CAST, ...;Opcode CHECK_CAST, ...;Opcode CMPG_DOUBLE, ...;Opcode CMPG_FLOAT, ...;Opcode CMPL_DOUBLE, ...;Opcode CMPL_FLOAT, ...;Opcode CMP_G, ...;Opcode CMP_L, ...;Opcode CMP_LONG, ...;Opcode CONST, ...;Opcode CONST_CLASS, ...;Opcode CONST_STRING, ...;Opcode CONST_WIDE, ...;Opcode DIV_DOUBLE, ...;Opcode DIV_FLOAT, ...;Opcode DIV_INT, ...;Opcode DIV_INT_LIT, ...;Opcode DIV_LONG, ...;Opcode DOUBLE_TO_FLOAT, ...;Opcode DOUBLE_TO_INT, ...;Opcode DOUBLE_TO_LONG, ...;Opcode FLOAT_TO_DOUBLE, ...;Opcode FLOAT_TO_INT, ...;Opcode FLOAT_TO_LONG, ...;Opcode GOTO, ...;Opcode IF, ...;Opcode IF_EQ, ...;Opcode IF_EQZ, ...;Opcode IF_GE, ...;Opcode IF_GEZ, ...;Opcode IF_GT, ...;Opcode IF_GTZ, ...;Opcode IF_LE, ...;Opcode IF_LEZ, ...;Opcode IF_LT, ...;Opcode IF_LTZ, ...;Opcode IF_NE, ...;Opcode IF_NEZ, ...;Opcode INSTANCE_OF, ...;Opcode INT_TO_BYTE, ...;Opcode INT_TO_CHAR, ...;Opcode INT_TO_DOUBLE, ...;Opcode INT_TO_FLOAT, ...;Opcode INT_TO_LONG, ...;Opcode INT_TO_SHORT, ...;Opcode INVOKE_DIRECT, ...;Opcode INVOKE_DIRECT_RANGE, ...;Opcode INVOKE_INTERFACE, ...;Opcode INVOKE_INTERFACE_RANGE, ...;Opcode INVOKE_STATIC, ...;Opcode INVOKE_STATIC_RANGE, ...;Opcode INVOKE_SUPER, ...;Opcode INVOKE_SUPER_RANGE, ...;Opcode INVOKE_VIRTUAL, ...;Opcode INVOKE_VIRTUAL_RANGE, ...;Opcode IGET, ...;Opcode IPUT, ...;Opcode SGET, ...;Opcode SPUT, ...;Opcode LONG_TO_DOUBLE, ...;Opcode LONG_TO_FLOAT, ...;Opcode LONG_TO_INT, ...;Opcode MONITOR_ENTER, ...;Opcode MONITOR_EXIT, ...;Opcode MOVE, ...;Opcode MOVE_EXCEPTION, ...;Opcode MOVE_OBJECT, ...;Opcode MOVE_RESULT, ...;Opcode MOVE_WIDE, ...;Opcode MUL_DOUBLE, ...;Opcode MUL_FLOAT, ...;Opcode MUL_INT, ...;Opcode MUL_INT_LIT, ...;Opcode MUL_LONG, ...;Opcode NEG, ...;Opcode NEG_DOUBLE, ...;Opcode NEG_FLOAT, ...;Opcode NEG_INT, ...;Opcode NEG_LONG, ...;Opcode NEW_INSTANCE, ...;Opcode NOT, ...;Opcode NOT_INT, ...;Opcode NOT_LONG, ...;Opcode OR_INT, ...;Opcode OR_INT_LIT, ...;Opcode OR_LONG, ...;Opcode REM_DOUBLE, ...;Opcode REM_FLOAT, ...;Opcode REM_INT, ...;Opcode REM_INT_LIT, ...;Opcode REM_LONG, ...;Opcode RETURN, ...;Opcode RETURN_VOID, ...;Opcode RSUB_INT, ...;Opcode SHL_INT, ...;Opcode SHL_INT_LIT, ...;Opcode SHL_LONG, ...;Opcode SHR_INT, ...;Opcode SHR_INT_LIT, ...;Opcode SHR_LONG, ...;Opcode SUB_DOUBLE, ...;Opcode SUB_FLOAT, ...;Opcode SUB_INT, ...;Opcode SUB_LONG, ...;Opcode THROW, ...;Opcode USHR_INT, ...;Opcode USHR_INT_LIT, ...;Opcode USHR_LONG, ...;Opcode XOR_INT, ...;Opcode XOR_INT_LIT, ...;Opcode XOR_LONG, ...;Opcode NEW_ARRAY, ...;Opcode FILLED_NEW_ARRAY, ...;Opcode FILLED_NEW_ARRAY_RANGE, ...;Opcode FILL_ARRAY, ...;Opcode FILL_ARRAY_DATA, ...;Opcode FILL_ARRAY_DATA_PAYLOAD, ...;Opcode SWITCH, ...;Opcode PACKED_SWITCH, ...;Opcode PACKED_SWITCH_PAYLOAD, ...;Opcode SPARSE_SWITCH, ...;Opcode SPARSE_SWITCH_PAYLOAD, ...;Opcode INVOKE_POLYMORPHIC, ...;Opcode INVOKE_POLYMORPHIC_RANGE, ...;Opcode INVOKE_CUSTOM, ...;Opcode INVOKE_CUSTOM_RANGE, ...;Opcode CONST_METHOD_HANDLE, ...;Opcode CONST_METHOD_TYPE, ...;import FilterInputStreamlong maxSize, ...;long currentPos, ...;this.maxSizeimport BiFunctionZipSecurity.classint MAX_SIZE_DIFF, ...;// size of uncompressed zip entry shouldn't be bigger of compressed in MAX_SIZE_DIFF timesint MAX_ENTRIES_COUNT, ...;isInSubDirectoryInternal(...)getCanonicalFile(...)// and prevents cases like "../classes.dex", to limit output only to the specified directory// checks that entry name contains no any traversalsFile currentPathFile canonicallong compressedSizegetCompressedSize(...)long uncompressedSizeisZipBomb(...)LimitedInputStream limitednew LimitedInputStream(...)/** Visit valid entries in zip file. ... */int entriesProcessedR resultSmaliConvert.classPath tmpDex, ...;List<Path> smaliFilesfilterSmaliFiles(...)this.tmpDexoptions.verboseErrorscollectSystemErrors(...)PrintStream systemErrPrintStream errnew PrintStream(...)setErr(...)PathMatcher matcherSmaliConvert convertnew SmaliConvert(...)getDexFiles(...)ClassLoader clsLoaderList<String> clsListint timeoutFile pathnew TestFilter(...)String fileObject cTestAnnotations.classnew TestAnnotations(...)C1.FLOAT_CONSTC2.FLOAT_CONSTA c1C1.classA c2C2.classnew TestAnnotationsParser(...)boolean[][][][][][][][] anew boolean[][][][][][][][]new TestArrays(...)// fill-array-data// filled-new-array// filled-new-array/rangelong cdouble fString aString argTestCF cnew TestCF(...)test1a(...)test1b(...)test1c(...)test2a(...)testIfElse(...)testIfElse2(...)Object readyMutex, ...;boolean ready, ...;/** Test infinite loop */simpleLoops(...)new TestCF2(...)// TODO add checksIterator<String> it1Iterator<String> it2int eString searchMeString substringboolean foundItint f2, ...;this.f2List<String> list1testSwitchInLoop(...)testNestedLoops(...)testReturnInLoop(...)testReturnInLoop2(...)testComplexIfInLoop(...)testComplexIfInLoop2(...)testComplexIfInLoop3(...)testLoops(...)testInline(...)testInline2(...)new TestCF3(...)// int max = searchMe.length() - substring.length();// test: for (int i = 0; i <= max; i++) {// int n = substring.length();// int j = i;// int k = 0;// while (n-- != 0) {// if (searchMe.charAt(j++) != substring.charAt(k++)) {// continue test;// foundIt = true;// break test;// System.out.println(foundIt ? "Found it" : "Didn't find it");// TODO this line required to omit generic information because it create List<Object>// List<String> list2 = Arrays.asList(null, null, null);// assertEquals(testReturnInLoop(list2), "error");// assertEquals(testReturnInLoop2(list2), "error");// assertTrue(testLabeledBreakContinue());testComplexIf(...)checkComplexIf(...)new TestCF4(...)boolean notInRangeboolean inctest6(...)new TestConditions(...)String DOG, ...;String dDirection dDirection.EASTOperation.PLUSDoubleOperations.TIMESSingleton.INSTANCEnew TestEnum(...)boolean BOOL, ...;int ZERO, ...;String STR, ...;double PI, ...;boolean fbz, ...;boolean fb, ...;int fi, ...;int fiz, ...;String fstr, ...;double fd, ...;...[] fda, ...;int si, ...;ConstFields.CONST_INTConstFields.BOOLConstFields.ZEROConstFields.STRConstFields.PItestConstsFields(...)new TestFields(...)new OrderedPair<String,Integer>(...)new OrderedPair<String,Box<Integer>>(...)new Box<Integer>(...)List<String> strings, ...;T t, ...;this.tBox<Integer> integerBox, ...;K key, ...;V value, ...;this.keyPair<String,Integer> p1, ...;OrderedPair<String,Box<Integer>> p, ...;// Generic static methodPair<Integer,String> p1new OrderedPair<Integer,String>(...)Pair<Integer,String> p2boolean sameT eObject elemNode next, ...;this.nextTestGenerics a, ...;new TestConstructor(...)new TestGenerics(...)// TODO: add other checksimport A/** Tests: ... */new TestImports(...)import Eimport Dnew E(...) { ... }new D.E(...) { ... }new TestImports2(...)A cA, ...;int b, ...;int bbb, ...;z(...)B b1new B(...) { ... }TestInitializers.countersetB(...)B b2int bb, ...;B b3A.agetBBB(...)new TestInitializers(...)MyThread2 thrnew MyThread2(...)new Object(...) { ... }TestInner cnew TestInner(...)Runnable myRunnableTestInner.countMyThread threadnew MyThread(...)TestInner.MyThreadMyInceptionThread thread2new MyInceptionThread(...)TestInner.MyInceptionThreadfunc2(...)func3(...)// value from java.lang.reflect.ModifierMethod[] mthsgetDeclaredMethods(...)c(...)d(...)int modifiersnew TestInner2(...)TestInner3.this.i0TestInner3.thisint D, ...;TestInner2.BTestInner2.Dnew TestInnerNames(...)char[] caTestInvoke invnew TestInvoke(...)getF(...)testVarArgs(...)testVarArgs2(...)testSameArgTypes(...)testStringEscape(...)testStringConcat(...)new TestSwitch(...)test0(...)exc2(...)boolean fthis.mDiscovering// TODO: remove 'synchronized(TestTryCatch.class)' block in decompiled versionObject mObject, ...;boolean mDiscovering, ...;test7(...)testSynchronize(...)testSynchronize2(...)testSynchronize3(...)test8(...)test8a(...)catchInLoop(...)new TestTryCatch(...)int f1, ...;this.f1// return t.testMoveThis(--a);// return t;// if (a == 0)// TestTypeResolver t = this;// public Object testMoveThis(int a) {// return b;// b = 1;// if (a == 5)// Object b = new Exception();// public static Object testVarsPropagation(int a) {new TestTypeResolver(...)// super(c > 0 ? c : -c, 1);// assertTrue((Integer) testVarsPropagation(5) == 1);// assertTrue(testVarsPropagation(1).getClass() == Exception.class);// assertTrue(testMoveThis(f1) == this);/** Code example from ... */Object s1Object s2doPrint(...)new Integer(...)testOverloadedMethods(...)new TestTypeResolver2(...)// correct call/** Some unicode strings from: ... */new TestUnicode(...)// LogLevelConverter.classint[].classint[][][].classString[].classString[][].classExtensions.class                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           %I    S    