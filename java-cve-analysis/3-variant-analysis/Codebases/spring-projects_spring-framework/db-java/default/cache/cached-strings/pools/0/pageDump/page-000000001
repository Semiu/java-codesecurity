PageAssembler<String> assembler6, ...;// assertNull(bf.getBean(AssemblerInjection.class).assembler1);  TODO: accidental match// assertNull(bf.getBean(AssemblerInjection.class).assembler2);RegisterBeanPhaseImportingConfiguration.classParseConfigurationPhaseImportingConfiguration.classUnconditionalImportingConfiguration.classRegisterBeanPhaseConditionConfiguration.classBarConfiguration.classParseConfigurationPhaseConditionConfiguration.classUnconditionalConfiguration.classRegisterBeanPhaseCondition.classParseConfigurationPhaseCondition.class/** <p> ... */Spr3775InitDestroyLifecycleTests.classString LIFECYCLE_TEST_BEAN, ...;/** LIFECYCLE_TEST_BEAN. */debugMethods(...)createBeanFactoryAndRegisterBean(...)InitDestroyBean beanassertMethodOrdering(...)bean.initMethodsbean.destroyMethodsCustomInitializingDisposableBean.classCustomInitializingDisposableBean beanInitializingDisposableWithShadowedMethodsBean.classInitializingDisposableWithShadowedMethodsBean beanCustomAnnotatedInitDestroyBean.classCustomAnnotatedInitDestroyBean beanCustomAnnotatedInitDestroyWithShadowedMethodsBean.classCustomAnnotatedInitDestroyWithShadowedMethodsBean beanAllInOneBean.classAllInOneBean beanList<String> initMethods, ...;List<String> destroyMethods, ...;/** Tests to verify that FactoryBean semantics are the same in Configuration ... */doAssertions(...)Spr6602Tests.classBar bar1Bar bar2BarFactory barFactory1BarFactory.classBarFactory barFactory2Bar bar3Bar bar4barFactory(...)new BarFactory(...)import ComponentScanAndImportAnnotationInteractionTestsComponentScanAndImportAnnotationInteractionTests.ImportedConfig.classComponentScanAndImportAnnotationInteractionTests.ImportedConfigimport Colour/** System tests covering use of {@link Autowired} and {@link Value} within ... */AutowiredConfigurationTests.classColour.REDColour.classAutowiredMethodConfig.classColorConfig.classOptionalAutowiredMethodConfig.classAutowiredConstructorConfig.classgetBean(...).colourObjectFactoryConstructorConfig.classMultipleConstructorConfig.classdoTestValueInjection(...)ValueConfigWithMetaAnnotation.classValueConfigWithAliasedMetaAnnotation.classValueConfigWithProviderFields.classValueConfigWithProviderConstructorArguments.classValueConfigWithProviderMethodArguments.classcontentLength(...)Colour colour, ...;// @Autowiredthis.colourString name2, ...;this.name2Provider<String> name, ...;Provider<String> name2, ...;import ConfigurationClassPostProcessorimport Primary/** Unit tests proving that the various attributes available via the {@link Bean} ... */beanDef(...)// will probably never happen, doesn't make much sense/** Tests proving that @Qualifier annotations work when used ... */StandardConfig.classStandardPojo.classStandardPojo pojopojo.testBeanpojo.testBean2ScopedConfig.classScopedProxyConfig.classCustomConfig.classCustomPojo.classCustomPojo pojoTestBean testBean2RootBeanDefinition customPojoCustomConfigWithAttributeOverride.classBoring.class// a shared scoped proxyimport AnnotationBeanNameGenerator/** Unit tests ensuring that configuration class bean names as expressed via @Configuration ... */A.B.classnew AnnotationBeanNameGenerator(...) { ... }/** System tests covering use of AspectJ {@link Aspect}s in conjunction with {@link Configuration} classes. ... */assertAdviceWasApplied(...)ConfigurationWithAspect.classConfigurationClassAspectIntegrationTests.classApplication.classCountingAspect.classnew BiConsumer<String,Runnable>(...) { ... }new NameChangingAspect(...)// TODO: returns just 1 as of AspectJ 1.9 beta 3, not detecting the applicable lambda expression anymore// assertEquals(2, ctx.getBean(CountingAspect.class).count);import PropertyPlaceholderConfigurer/** Miscellaneous system tests covering {@link Bean} naming, aliases, scoping and ... */customBeanNameIsRespected(...)ConfigWithBeanWithCustomName.classConfigWithBeanWithCustomName.testBeanConfigWithBeanWithCustomNameConfiguredViaValueAttribute.classConfigWithBeanWithCustomNameConfiguredViaValueAttribute.testBeanGenericApplicationContext acaliasesAreRespected(...)ConfigWithBeanWithAliases.classConfigWithBeanWithAliases.testBeanConfigWithBeanWithAliasesConfiguredViaValueAttribute.classConfigWithBeanWithAliasesConfiguredViaValueAttribute.testBeanBeanFactory factorynew Consumer<Object>(...) { ... }ConfigWithBeanWithProviderImplementation.classConfigWithBeanWithProviderImplementation.testBeanConfigWithSetWithProviderImplementation.classConfigWithSetWithProviderImplementation.setConfigWithFinalBean.classSimplestPossibleConfig.classString stringBeanConfigWithNonSpecificReturnTypes.classListableBeanFactory factoryConfigWithPrototypeBean.classITestBean bazConfigWithNullReference.classAdaptiveInjectionPoints adaptiveAdaptiveInjectionPoints.classadaptive.adaptiveInjectionPoint1adaptive.adaptiveInjectionPoint2AdaptiveResourceInjectionPoints adaptiveAdaptiveResourceInjectionPoints.classRootBeanDefinition placeholderConfigurerSpousyTestBean listenerSpousyTestBean.classConfigWithPostProcessor.classlistener.refreshedConfigWithFunctionalRegistration.classConfigWithApplicationListener configConfigWithApplicationListener.classconfig.closedOverloadedBeanMismatch.classConfigWithDynamicPrototype.classPrototypeDependency.classPrototypeInterface p1PrototypeInterface.classPrototypeInterface p2PrototypeInterface p3PrototypeOne.class(...).prototypeDependencyPrototypeTwo.class/** Creates a new {@link BeanFactory}, populates it with a {@link BeanDefinition} ... */ConfigurationClassPostProcessor ccppSet<String> set, ...;ListFactoryBean fbnew SpousyTestBean(...)bar(...)TestBean barbaz(...)TestBean adaptiveInjectionPoint1, ...;TestBean adaptiveInjectionPoint2, ...;this.adaptiveInjectionPoint2String myProp, ...;new POBPP(...) { ... }String nameSuffix, ...;this.nameSuffix// @Beanboolean refreshed, ...;Supplier<TestBean> testBeanSuppliernew ApplicationListener<ContextClosedEvent>(...) { ... }setLawyer(...)PrototypeDependency prototypeDependency, ...;new PrototypeOne(...)new PrototypeTwo(...)// method name should not be registered// SPR-11830// gh-26019// no autowired dependency here, in contrast to above/** A configuration class that registers a non-static placeholder configurer {@code @Bean} ... *//** Test which proves that a non-static property placeholder bean cannot be declared ... */ConfigWithValueFieldAndPlaceholderConfigurer.classConfigWithValueFieldAndStaticPlaceholderConfigurer.classConfigWithValueField.classConfigWithPlaceholderConfigurer.classnew PropertySourcesPlaceholderConfigurer(...)// Proof that the @Value field did not get set:// ctx.register(ConfigWithPlaceholderConfigurer.class);/** Ensures that @Configuration is supported properly as a meta-annotation. ... */TestBean aTestBean bb(...)/** Corners the bug originally reported by SPR-8824, where the presence of two ... */new ExampleFactoryBean(...)new ExampleBeanPostProcessor(...)new ExampleApplicationEventListener(...)ExampleBean exampleBean, ...;this.exampleBeannew ExampleApplicationEvent(...)/** Tests that @Import may be used both as a locally declared and meta-declared ... */MultiMetaImportConfig.classMultiMetaImportConfigWithLocalImport.classMultiMetaImportConfigWithLocalImportWithBeanOverride.classImportFromBean.classConfig2a.classimport PropertiesBeanDefinitionReader/** Integration tests for {@link ImportResource} support. ... */ImportXmlConfig.classFirstLevelSubConfig.classSecondLevelSubConfig.classImportXmlWithAopNamespaceConfig.classImportXmlWithConfigurationClass.classPropertySource<?> propertySourceImportXmlAutowiredConfig.classImportNonXmlResourceConfig.classTestBean xmlDeclaredBean, ...;PropertiesBeanDefinitionReader.class/** System tests for {@link Import} annotation support. ... */processConfigurationClasses(...)int configClassesint beansInClassesConfigurationWithImportAnnotation.classassertBeanDefinitionCount(...)OtherConfigurationWithImportAnnotation.classOtherConfiguration.class// ------------------------------------------------------------------------DataSourceConfig.classaccountRepository(...)FirstLevel.classWithMultipleArgumentsToImportAnnotation.classWithMultipleArgumentsThatWillCauseDuplication.classFoo1.classFoo2.classOuterConfig.InnerConfig.classOuterConfig.InnerConfigExternalConfig.classSecondLevel.classThirdLevel.classInitBean.classInitBean.initializedRightConfig.classConfigAnnotated.classNonConfigAnnotated.class/** Test that values supplied to @Configuration(value="...") are propagated as the ... */import ConditionContextimport Conditionalimport ConfigurationConditionConditionalThenUnconditional.classUnconditionalThenConditional.classConditionalConfiguration.classBeanOne beanOne, ...;BeanProvidingConfiguration.classNeverMatchingCondition.classnew BeanOne(...)/* Copyright 2012-2019 the original author or authors. ... *//** Unit tests cornering the bug exposed in SPR-6779. ... */autowiredConfigClassIsEnhanced(...)ConfigThatDoesImport.classConfigThatDoesNotImport.classConfigToBeAutowired.classConfig configconfig.autowiredConfigautowiredConfigClassBeanMethodsRespectScoping(...)TestBean testBean1ConfigThatImportsNonConfigClass.classConfigThatImportsNonConfigClass configconfig.testBeanConfigToBeAutowired autowiredConfig, ...;/** Reproduces SPR-8756, which has been marked as "won't fix" for reasons ... */Foo foo1Foo foo2ReproConfig.classfoo2.barfoo1.barWorkaroundConfig.classreproBar(...)workaroundBar(...)// <-- i.e. @Bean was registered// <-- i.e. @Bean *not* enhanced// <-- i.e. @Bean *was* enhanced/** Tests that scopes are properly supported by using a custom Scope implementations ... */String flag, ...;String SCOPE, ...;CustomScope customScope, ...;GenericApplicationContext ctx, ...;new CustomScope(...)ScopedConfigurationClass.classgenericTestScope(...)Object bean1Object bean2Object bean3Object newBean1Object sameBean1Object newBean2Object newBean3customScope.createNewScopeObject beanAInScopeObject beanBInScopeObject newBeanAInScopeObject newBeanBInScopeTestBean singletonITestBean spouseFromBFTestBean spouseFromBFscopedProxyClass(...)scopedProxyInterface(...)/** Simple scope implementation which creates object based on a flag. ... */boolean createNewScope, ...;// make the scope create a new object// make the scope create a new object .. again// get hidden bean// the scope proxy has kicked in// create a new bean// get the bean again from the BF// make sure the name has been updated// get the bean again// reset the flag back// if a new object is requested or none exists under the current// name, create one/** Tests for SPR-10668. ... */ChildConfig.classMyComponent.classMyComponent component, ...;new MyComponentImpl(...)int createCount, ...;int scopeCount, ...;Foo bean1Foo bean2new MyTestScope(...)MyTestConfiguration.class// Should not have invoked constructor for the proxy instance// Proxy mode should create new scoped object on each method callimport static ConfigurableBeanFactory.SCOPE_PROTOTYPEimport static ConfigurableBeanFactory.SCOPE_SINGLETONTestContext.classCustomCondition conditionCustomCondition.classFirstService firstServiceSecondService secondServicenew CustomCondition(...)new FirstService(...)new SecondService(...)new DependencyOne(...)new DependencyTwo(...)boolean condition, ...;DependencyOne dependency, ...;DependencyTwo dependency, ...;MyConfig.classMyConfig confignew Dependency(...)new MyPostProcessor(...)someDependency(...)import Bar// ---- reproduce ----packagePrivateBar(...)// ---- workaround ----protectedBar(...)import Spr9031Component/** Unit tests cornering bug SPR-9031. ... *//** Use of @Import to register LowLevelConfig results in ASM-based annotation ... */HighLevelConfig.classgetBean(...).scannedLowLevelConfig.class/** Direct registration of LowLevelConfig results in reflection-based annotation ... */MarkerAnnotation.classSpr9031Component scanned, ...;// annotation is not parsed// fails to wire when LowLevelConfig is processed with ASM because nested @Filterimport MarkerAnnotationimport Tckimport Carimport Convertibleimport Driversimport DriversSeatimport FuelTankimport Seatimport Tireimport V8Engineimport Cupholderimport SpareTireimport Jsr330ScopeMetadataResolverAnnotatedBeanDefinitionReader bdrCar carCar.classnew Jsr330ScopeMetadataResolver(...)Convertible.classDriversSeat.classDrivers.classSeat.classV8Engine.classSpareTire.classCupholder.classTire.classFuelTank.classtestsFor(...)import Descriptionimport AEnclosingConfigAEnclosingConfig.class// These fail prior to fixing SPR-10546assertLoadsMyBean(...)AEnclosingConfig.ChildConfig.classAEnclosingConfig.ChildConfig/** Prior to fixing SPR-10546 this might have succeeded depending on the ordering the ... */AEnclosingWithImportResourceConfig.classAEnclosingWithImportResourceConfig.ChildConfig.classAEnclosingWithImportResourceConfig.ChildConfigAEnclosingWithComponentScanConfig.classAEnclosingWithComponentScanConfig.ChildConfig.classAEnclosingWithComponentScanConfig.ChildConfigAEnclosingWithGrandparentConfig.classAEnclosingWithGrandparentConfig.ChildConfig.classAEnclosingWithGrandparentConfig.ChildConfigImportChildConfig.class// These worked prior, but validating they continue to workAEnclosingWithImportConfig.classAEnclosingWithImportConfig.ChildConfig.classAEnclosingWithImportConfig.ChildConfigimport ParentConfig/** Note the name of {@link AEnclosingConfig} is chosen to help ensure scanning picks up ... *//** Tests cornering the regression reported in SPR-12233. ... */ImportConfiguration.classComponentScanningConfiguration.classNeverConfigurationCondition.classimport ImportBeanDefinitionRegistrarTestImport.scannedTestImport.classTestConfiguration.classboolean scanned, ...;State state, ...;anyMethod(...)ScanningConfiguration.classScannedComponent.classScannedComponent.State.classScannedComponent.State/** Tests cornering the regression reported in SPR-8761. ... *//** Prior to the fix for SPR-8761, this test threw because the nested MyComponent ... *//** Tests cornering the bug in which @Configuration classes that @ComponentScan themselves ... *//** This test failed with ConflictingBeanDefinitionException prior to fixes for ... */Spr8808Tests.class// scan *this* packageimport BeanAge/** Class used to test the functionality of factory method bean definitions ... */// to be ignoredsetCountry(...)new DependencyBean(...)/** Class to test that @FactoryMethods are detected only when inside a class with an @Component ... */// This should *not* recognized as a bean since it does not reside inside an @ComponentMockEnvironment envGenericXmlApplicationContext applicationContextTestClient clientTestClient.classgetBars(...)isBool(...)List<Bar> bars, ...;boolean bool, ...;Map<String,Resource> resourceMap, ...;this.barsthis.boolthis.resourceMapTestEvents.classnew GenericTestEvent<T>(...)GenericTestEvent<?> wildcardEvent, ...;import Fluximport Monoimport AbstractIdentifiableimport AnotherTestEventimport EventCollectorimport GenericEventPojoimport Identifiableimport TestEventimport SettableListenableFutureimport MethodValidationPostProcessorEventCollector eventCollector, ...;CountDownLatch countDownLatch, ...;// 1 call by defaultTestEvent eventnew TestEvent(...)TestEventListener listenerTestEventListener.classassertNoEventReceived(...)this.eventCollectorassertEvent(...)assertTotalEventsCount(...)getEventCollector(...)MetaAnnotationListenerTestBean beanMetaAnnotationListenerTestBean.classContextEventListener listenerContextEventListener.classList<Object> eventsgetEvents(...)List<Object> eventsAfterStopContextRefreshedEvent.classContextStoppedEvent.classAnnotationConfigApplicationContext failingContextBasicConfiguration.classInvalidMethodSignatureEventListener.classBeanInitializationException.classAnotherTestEvent eventnew AnotherTestEvent(...)ReplyEventListener replyEventListenerReplyEventListener.classSet<Object> repliesSettableListenableFuture<String> futurenew SettableListenableFuture<String>(...)just(...)SimpleService proxyAnnotatedSimpleService proxyAnnotatedSimpleService.classAnnotatedProxyTestBean.classCglibProxyTestBean proxyCglibProxyTestBean.classCglibProxyWithPrivateMethod.classCustomScope customScopeCustomScopeTestBean proxyCustomScopeTestBean.classcustomScope.activeString threadNameAsyncEventListener listenerAsyncEventListener.classloadAsync(...)this.countDownLatchSimpleService listenerdoLoad(...)AsyncConfigurationWithInterfaces.classSimpleProxyTestBean.classExceptionEventListener listenerExceptionEventListener.classGenericEventListener listenerGenericEventListener.classResolvableTypeEventListener listenerResolvableTypeEventListener.classGenericEventPojo<String> eventnew GenericEventPojo<String>(...)GenericEventPojo<Long> eventnew GenericEventPojo<Long>(...)validateConditionMatch(...)ConditionalEventListener.classMethodValidationPostProcessor.classConditionalEventInterface listenerConditionalEventInterface.classlong maxLongOrderedTestListener listenerOrderedTestListener.classlistener.orderEventOnPostConstruct.classMissingEventListener.classUseMissingEventListener.classList<Class<?>> allClassesAsyncConfiguration.classEventCollector.classCountDownLatch.classnew EventCollector(...)new TestConditionEvaluator(...)addEvent(...)collectEvent(...)event.contentevent.msghandleString(...)List<String> order, ...;ApplicationEventPublisher publisher, ...;this.publisherObject instance, ...;// reply// No response// reply (no listener for 4L)// SPR-15122import BeanThatBroadcastsimport BeanThatListens/** Unit and integration tests for the ApplicationContext event support. ... */StringEventListener.classcreateGenericTestEvent(...)GenericTestEvent<>.classgetGenericApplicationEventType(...)new StringEvent(...)new LongEvent(...)new SmartGenericTestEvent<String>(...)new SmartGenericTestEvent<Long>(...)ApplicationListener<ApplicationEvent> listenerSimpleApplicationEventMulticaster smcint invocationApplicationEvent evtsetTaskExecutor(...)new Executor(...) { ... }RuntimeException thrownnew Consumer<RuntimeException>(...) { ... }MyOrderedListener1 listener1new MyOrderedListener1(...)MyOrderedListener2 listener2new MyOrderedListener2(...)new MyEvent(...)new MyOtherEvent(...)listener1.seenEventsMyOrderedListener3 listener1new MyOrderedListener3(...)MyOrderedListener4 listener2new MyOrderedListener4(...)ApplicationListener<ApplicationEvent> proxy1ApplicationListener<ApplicationEvent> proxy2EventPublicationInterceptor interceptornew EventPublicationInterceptor(...)setApplicationEventClass(...)MyEvent.classRootBeanDefinition listener2MyOrderedListener2.classMyOrderedListener1.classMyOtherEvent event1MyEvent event2MyEvent event3MyOtherEvent event4AbstractApplicationEventMulticaster multicasterAbstractApplicationEventMulticaster.classmulticaster.retrieverCacheMyPayloadListener listenerMyPayloadListener.classlistener.seenPayloadsRootBeanDefinition nestedChildStaticApplicationContext.classRootBeanDefinition listener1DefMyEvent event1SimpleApplicationEventMulticaster multicasterAbstractApplicationContext.APPLICATION_EVENT_MULTICASTER_BEAN_NAMESimpleApplicationEventMulticaster.classRootBeanDefinition listenerMyNonSingletonListener.classMyOtherEvent event2MyNonSingletonListener.seenEventsRootBeanDefinition listenerDefBeanThatListens.classBeanThatBroadcasts broadcasterBeanThatBroadcasts.classbroadcaster.receivedCountTestBean listenergetEventCount(...)Set<MyEvent> seenEventsnew HashSet<MyEvent>(...)new ApplicationListener<MyEvent>(...) { ... }ApplicationListener<MyEvent> listenernew ErrorHandler(...) { ... }StaticApplicationContext.APPLICATION_EVENT_MULTICASTER_BEAN_NAMEnew ApplicationListener<ApplicationEvent>(...) { ... }new ClassCastException(...)BeanThatListens listenerEventPublishingBeanPostProcessor.classEventPublishingInitMethod.classAsyncEventPublishingInitMethod.classnew ArrayList<ApplicationEvent>(...)List<ApplicationEvent> seenEvents, ...;this.seenEventsMyOrderedListener1 otherListener, ...;this.otherListenerthis.otherListener.seenEventsSet<Object> seenPayloads, ...;this.seenPayloadsnew HashSet<ApplicationEvent>(...)Set<ApplicationEvent> seenEvents, ...;MyOrderedListener3 otherListener, ...;Thread threadnew SampleEvents(...)SampleEvents sampleEvents, ...;SampleEvents.classcreateGenericEventType(...)PayloadTestEvent<>.classPayloadStringTestEvent.classcreateTestInstance(...)ApplicationListenerMethodAdapter adapterGenericTestEvent<String> eventhandleGenericString(...)this.sampleEventsEntityWrapper<>.classEntityWrapper<String> payloadnew EntityWrapper<String>(...)new PayloadApplicationEvent<EntityWrapper<String>>(...)handleGenericStringPayload(...)EntityWrapper<Integer> payloadnew EntityWrapper<Integer>(...)new PayloadApplicationEvent<EntityWrapper<Integer>>(...)handleGenericAnyPayload(...)withNoCause(...)new InvalidProxyTestBean(...)InvalidProxyTestBean.classStaticApplicationListenerMethodAdapter listenernew StaticApplicationListenerMethodAdapter(...)PayloadApplicationEvent<String> eventnew PayloadApplicationEvent<String>(...)PayloadApplicationEvent<Long> eventnew PayloadApplicationEvent<Long>(...)handleStringAnnotationClasses(...)handleStringAnnotationValueAndParameter(...)PayloadApplicationEvent<Integer> event2new PayloadApplicationEvent<Integer>(...)PayloadApplicationEvent<Double> event3new PayloadApplicationEvent<Double>(...)handleStringOrInteger(...)ApplicationListenerMethodAdapter listenerObject targetBean, ...;this.targetBeanT entity, ...;this.entityV something, ...;// Always accept such event when the type is unknownTestEventWithNoValidOneArgObjectCtor.classTestApplicationListener listenernew TestApplicationListener(...)new TestContext(...)TestApplicationListener otherListenerTestEvent.classEventPublicationInterceptor.classFactoryBeanTestListener.class// should automatically receive applicationEventPublisher reference// invoke any method on the advised proxy to see if the interceptor has been invoked// two events: ContextRefreshedEvent and TestEventSmartApplicationListener smartListenerGenericApplicationListenerAdapter listenerGenericTestEvent<String> stringEventStringEvent stringEventLongEvent stringEventGenericTestEvent<Long> longEventObjectEventListener.classUpperBoundEventListener.classRawApplicationListener.classGenericApplicationListenerAdapter adapter// Demonstrates we can't inject that event because the generic type is lost// But it works if we specify the type properly// or if the event provides its precise type// Demonstrates it works if we actually use the subtype// Demonstrates we cant inject that event because the listener has a wildcard// Demonstrates we cant inject that event because the listener has a raw typeLifecycleTestBean lifecycleBeanLifecycleListener listenerLifecycleTestBean.classLifecycleListener.classgetStartedCount(...)getStoppedCount(...)int startedCount, ...;int stoppedCount, ...;this.startedCountthis.stoppedCountApplicationContext acAuditableListener.classAuditablePayloadEvent<String> eventnew AuditablePayloadEvent<String>(...)getBean(...).eventsList<Auditable> eventsnew ArrayList<Auditable>(...)ApplicationListener<AuditablePayloadEvent<String>> listenernew ApplicationListener<AuditablePayloadEvent<String>>(...) { ... }ApplicationListener<AuditablePayloadEvent<Integer>> mismatchnew ApplicationListener<AuditablePayloadEvent<Integer>>(...) { ... }ConfigurableApplicationContext acList<String> eventsApplicationListener<PayloadApplicationEvent<String>> listenerforPayload(...)ApplicationListener<PayloadApplicationEvent<Integer>> mismatchnew Consumer<Integer>(...) { ... }List<Auditable> events, ...;AbstractIdentifiable thatthat.idObject content, ...;this.content/** Test utility to collect and assert events. ... */new LinkedMultiValueMap<String,Object>(...)MultiValueMap<String,Object> content, ...;/** Register an event for the specified listener. *//** Return the events that the specified listener has received. The list of events ... *//** Assert that the listener identified by the specified id has not received any event. *//** Assert that the specified listener has not received any event. *//** Assert that the listener identified by the specified id has received the ... */List<Object> actualevents.length/** Assert that the specified listener has received the specified events, in ... *//** Assert the number of events received by this instance. Checks that ... */int actualEntry<String,List<Object>> entryMap<>.Entry<String,List<Object>>/** Clear the collected events, allowing for reuse of the collector. *//** A simple POJO that implements {@link ResolvableTypeProvider}. ... */T value, ...;GenericEventPojo<?> thatthat.value/** A simple marker interface used to identify an event or an event listener ... *//** Return a unique global id used to identify this instance. *//** A basic test event that can be uniquely identified easily. ... */IdentifiableApplicationEvent thatString msg, ...;this.msgimport TestInfogetTestMethod(...)AnnotatedElementKey instanceassertKeyEquals(...)AnnotatedElementKey firstAnnotatedElementKey secondimport AccessControlExceptionimport PermissionProperties placeholdersGenericBeanDefinition bd0GenericBeanDefinition bd1GenericBeanDefinition bd2GenericBeanDefinition bd3GenericBeanDefinition bd4GenericBeanDefinition bd5GenericBeanDefinition bd6new Scope(...) { ... }ValueTestBean.classConstructorValueTestBean.classMethodValueTestBean.classPropertyValueTestBean.classValueTestBean tb3ConstructorValueTestBean tb4MethodValueTestBean tb5PropertyValueTestBean tb6tb3.agetb3.ageFactorytb3.countrytb3.countryFactorytb3.optionalValue1tb3.optionalValue2tb3.optionalValue3tb3.tbtb4.nametb4.agetb4.countrytb4.tbtb5.nametb5.agetb5.countrytb5.tbtb6.nametb6.agetb6.countrytb6.tbGenericConversionService csnew GenericConversionService(...)PrototypeTestBean.classnew Converter<String,String>(...) { ... }GenericApplicationContext.CONVERSION_SERVICE_BEAN_NAMEPrototypeTestBean tbgetCountry2(...)SecurityManager oldSecurityManagerSecurityManager securityManagernew SecurityManager(...) { ... }new AccessControlException(...)ResourceInjectionBean resourceInjectionBeanresourceInjectionBean.resourceresourceInjectionBean.urlresourceInjectionBean.uriresourceInjectionBean.fileresourceInjectionBean.inputStreamresourceInjectionBean.readerObjectFactory<Integer> ageFactory, ...;ObjectFactory<String> countryFactory, ...;Optional<String> optionalValue1, ...;Optional<String> optionalValue2, ...;Optional<String> optionalValue3, ...;String country2, ...;this.country2URL url, ...;URI uri, ...;File file, ...;InputStream inputStream, ...;Reader reader, ...;// allow everything elsenew TestExpressionEvaluator(...)TestExpressionEvaluator expressionEvaluator, ...;Expression expressiongetTestExpression(...)hasParsedExpression(...)expressionEvaluator.testCacheMap<ExpressionKey,Expression> testCache, ...;mockSpelExpressionParser(...)this.testCacheSpelExpressionParser parser/** Integration tests for {@link EnvironmentAccessor}, which is registered with ... */import CarFactoryBean/** Unit tests for expressions accessing beans and factory beans. ... */parseRaw(...)Expression notFactoryExprExpression noBeanExprExpression noFactoryBeanExprnew SimpleBeanResolver(...)CarFactoryBean.classnew Car(...)StaticApplicationContext ac, ...;Boat.class// SPR9511// No such bean// No such factory beanimport SpelCompiler/** Unit tests for compilation of {@link MapAccessor}. ... */Map<String,Object> testMapgetSimpleTestMap(...)SpelExpressionParser sepExpression exMap<String,Map<String,Object>> nestedMapgetNestedTestMap(...)MapGetter mapGetternew MapGetter(...)Map<String,Map<String,Object>> map2new HashMap<String,Map<String,Object>>(...)// basic// compound expression// nested map// avoiding inserting checkcast because first part of expression returns a Map/** Unit tests for {@link MethodBasedEvaluationContext}. ... */ParameterNameDiscoverer paramDiscover, ...;SampleMethods.classMethodBasedEvaluationContext contextthis.paramDiscoverimport GenericGroovyApplicationContextGenericGroovyApplicationContext ctxnew GenericGroovyApplicationContext(...)Object frameworkObject companyGroovyApplicationContextTests.classLocaleContext lcLocale.GERMANYsetDefaultLocale(...)setDefaultTimeZone(...)boolean condition5/** Tests for {@link CandidateComponentsIndexLoader}. ... */CandidateComponentsIndex indexSet<String> componentsIOException causeCandidateComponentsTestClassLoader classLoadernew CandidateComponentsTestClassLoader(...)/** Tests for {@link CandidateComponentsIndex}. ... */createSampleProperties(...)Set<String> actualAbstractApplicationContext contextLifecycleTestBean bean1LifecycleTestBean bean2LifecycleTestBean bean3LifecycleTestBean bean4String errorString startErrorString stopErrorString notStartedErrorString orderErrorgetStartOrder(...)String notStoppedErrorgetStopOrder(...)Logic l, ...;this.loutput(...)/** Tests the interaction between {@link ApplicationContext} implementations and ... */StaticApplicationContext acTestBeanFactoryPostProcessor bfppnew TestBeanFactoryPostProcessor(...)bfpp.wasCalledTestBeanFactoryPostProcessor.classbfpp.initValueTestBeanDefinitionRegistryPostProcessor bdrppnew TestBeanDefinitionRegistryPostProcessor(...)new PrioritizedBeanDefinitionRegistryPostProcessor(...)bdrpp.wasCalledgetBean(...).wasCalledOuterBeanDefinitionRegistryPostProcessor.classPrioritizedOuterBeanDefinitionRegistryPostProcessor.classgetBean(...).receivedListeningBeanFactoryPostProcessor.classNestingBeanFactoryPostProcessor.classgetListeningBean(...).receivedgetListeningBean(...)ListeningBean.classString initValue, ...;this.initValueboolean wasCalled, ...;this.wasCalledTestBeanDefinitionRegistryPostProcessor.classPrioritizedBeanDefinitionRegistryPostProcessor.classApplicationEvent received, ...;this.receivedListeningBean listeningBean, ...;this.listeningBeanString PATH, ...;String RESOURCE_CONTEXT, ...;String CONTEXT_WILDCARD, ...;String CONTEXT_A, ...;String CONTEXT_B, ...;String CONTEXT_C, ...;String FQ_CONTEXT_A, ...;String FQ_CONTEXT_B, ...;String FQ_CONTEXT_C, ...;String SIMPLE_CONTEXT, ...;String FQ_SIMPLE_CONTEXT, ...;String FQ_ALIASED_CONTEXT_C, ...;String INVALID_VALUE_TYPE_CONTEXT, ...;String CHILD_WITH_PROXY_CONTEXT, ...;String INVALID_CLASS_CONTEXT, ...;String CLASS_WITH_PLACEHOLDER_CONTEXT, ...;String ALIAS_THAT_OVERRIDES_PARENT_CONTEXT, ...;String ALIAS_FOR_PARENT_CONTEXT, ...;String TEST_PROPERTIES, ...;isProperlyDestroyed(...)checkExceptionFromInvalidValueType(...)new ExceptionInInitializerError(...)ByteArrayOutputStream baosString dumpnew PrintStream(...)IOException ioexnew FactoryBeanAndApplicationListener(...)Service service1Service service2AutowiredService autowiredService1AutowiredService autowiredService2List<Resource> resourcesgetResources(...).lengthClassPathXmlApplicationContext childObject someMsObject yourMsObject myMsObject someMs2assertOneMessageSourceOnly(...)String[] beanNamesForTypeMap<?,StaticMessageSource> beansOfTypebeanNamesForType.lengthnew ClassPathXmlApplicationContext(...) { ... }ClassPathXmlApplicationContextTests.class// re-refresh (after construction refresh)// regular close call// re-activating and re-closing the context (SPR-13425)import ConverterFactoryConversionServiceFactoryBean factorynew ConversionServiceFactoryBean(...)ConversionService serviceSet<Object> convertersnew Converter<String,Foo>(...) { ... }new ConverterFactory<String,Bar>(...) { ... }new Converter<String,T>(...) { ... }new GenericConverter(...) { ... }Baz.classnew Baz(...)setConverters(...)doTestConversionServiceInApplicationContext(...)FileSystemResource.classResourceTestBean tbgetResourceArray(...).lengthgetResourceMap(...)getResourceArrayMap(...)get(...).lengthimport DirectFieldAccessorObject lifecycleProcessorDefaultLifecycleProcessor.classLifecycleProcessor beanObject contextLifecycleProcessorCopyOnWriteArrayList<Lifecycle> startedBeansnew CopyOnWriteArrayList<Lifecycle>(...)TestSmartLifecycleBean beanforStartupTests(...)setAutoStartup(...)DummySmartLifecycleBean.classDummySmartLifecycleBean beanDummySmartLifecycleFactoryBean.classDummySmartLifecycleFactoryBean beanTestSmartLifecycleBean dependencyTestSmartLifecycleBean beanMinTestSmartLifecycleBean bean1TestSmartLifecycleBean bean2TestSmartLifecycleBean bean3TestSmartLifecycleBean beanMaxTestLifecycleBean simpleBean1TestLifecycleBean simpleBean2TestSmartLifecycleBean smartBean1TestSmartLifecycleBean smartBean2CopyOnWriteArrayList<Lifecycle> stoppedBeansforShutdownTests(...)TestSmartLifecycleBean bean4TestSmartLifecycleBean bean5TestSmartLifecycleBean bean6TestSmartLifecycleBean bean7new TestLifecycleBean(...)Lifecycle bean1Lifecycle bean2Lifecycle bean3Lifecycle bean4Lifecycle bean5Lifecycle bean6Lifecycle bean7TestSmartLifecycleBean bean99TestSmartLifecycleBean beanNegativeTestLifecycleBean simpleBeanCopyOnWriteArrayList<Lifecycle> startedBeans, ...;CopyOnWriteArrayList<Lifecycle> stoppedBeans, ...;this.startedBeansthis.stoppedBeansboolean autoStartup, ...;new TestSmartLifecycleBean(...)this.autoStartupint delaynew DummySmartLifecycleBean(...)DummySmartLifecycleBean bean, ...;// clean start so that simpleBean is included// should start since it's a dependency of an auto-started bean// calling stop() before the delay to preserve// invocation order in the 'stoppedBeans' list// ignore/** Tests covering the integration of the {@link Environment} into ... */ConfigurableApplicationContext parentAnnotationConfigApplicationContext childConfigurableEnvironment.classimport EnvironmentTestUtils/** Tests integration between Environment and SecurityManagers. See SPR-9970. ... */SecurityManager originalSecurityManager, ...;Map<String,String> env, ...;getModifiableSystemEnvironment(...)AbstractEnvironment.ACTIVE_PROFILES_PROPERTY_NAMEAnnotatedBeanDefinitionReader readerC1.class// Disallowing access to System#getenv means that our// ReadOnlySystemAttributesMap will come into play.// Disallowing access to the spring.profiles.active property means that// the BeanDefinitionReader won't be able to determine which profiles are// active. We should see an INFO-level message in the console about this// and as a result, any components marked with a non-default profile will// be ignored.import FlightRecorderApplicationStartupFlightRecorderApplicationStartup applicationStartupnew FlightRecorderApplicationStartup(...)/** Unit tests for {@link GenericXmlApplicationContext}. ... */GenericXmlApplicationContextTests.classClass<?> RELATIVE_CLASS, ...;String RESOURCE_BASE_PATH, ...;String RESOURCE_NAME, ...;String FQ_RESOURCE_PATH, ...;int startCounter, ...;int stopCounter, ...;int startOrder, ...;int stopOrder, ...;this.startOrderthis.stopOrder/** Tests for {@link LiveBeansView} ... */MockEnvironment environment, ...;createApplicationContext(...)searchLiveBeansViewMeans(...)LiveBeansView.MBEAN_DOMAIN_PROPERTY_NAMEassertSingleLiveBeansViewMbean(...)ConfigurableApplicationContext childContextConfigurableApplicationContext.classSet<ObjectName> objectNamesgetCanonicalName(...)LiveBeansView.MBEAN_APPLICATION_KEYqueryNames(...)// Only one MBean// Root context removes itAssembler a, ...;/** Advice object that implements <i>multiple</i> Advice interfaces. ... */import PropertyResourceConfigurer/** Integration tests for {@link PropertyResourceConfigurer} implementations requiring ... */String userDirgetUserDir(...)new Predicate<BeanInitializationException>(...) { ... }cleanPath(...)// slight hack for Linux/Unix systemsPropertySourcesPlaceholderConfigurer ppcgetAppliedPropertySources(...)localPropertiesOverride(...)setPropertySources(...)new Properties(...) { ... }PropertySource<?> psnew PropertySource<Object>(...) { ... }ClassPathResource doesNotHaveClassPathResource setToTrueOptionalTestBean.classOptional<String> name, ...;//pc.setIgnoreUnresolvablePlaceholders(false); // the default// SPR-10619doTestMessageAccess(...)String basepathResourceBundleMessageSource.classReloadableResourceBundleMessageSource.classMessageSourceAccessor accessorMessageSourceResolvable resolvablesetDefault(...)Locale.ENGLISHnew Locale(...)NoSuchMessageException.classGenericApplicationContext parentResourceBundleMessageSource msReloadableResourceBundleMessageSource msnew ReloadableResourceBundleMessageSource(...)setCacheMillis(...)setConcurrentRefresh(...)setCommonMessages(...)Properties fileCharsetssetFileEncodings(...)Locale.UKMessageSourceResourceBundle rbeMessageSourceResourceBundle rbg// test default message without and with args// test resolvable with default message, without and with args// test message args// Initial cache attempt// Late enough for a re-cache attempt/** Unit tests cornering SPR-7502. ... *//** Defensively zero-out static factory count - other tests ... */getSerializableFactoryMap(...)assertFactoryCountThroughoutLifecycle(...)registerMisconfiguredBeanDefinition(...)serializableFactoryCount(...)// ignore - this is expected on refresh() for failure case testsboolean properlyDestroyed, ...;BeanCreationNotAllowedException exthis.properlyDestroyed// Should have thrown BeanCreationNotAllowedExceptionimport AwaitilityTestBean[] beansThread thread1Thread thread2until(...)pollInterval(...)atMost(...)new Callable<Boolean>(...) { ... }// Arrange// Act// AssertFilterAdapter adapterFilterAdapter.classBuilding.classgetSupportedTypes(...)Entrance.classDwelling.classString extensionPrefix, ...;Map<String,Class<? extends DomainEntity>> supportedTypes, ...;this.extensionPrefiximport AbstractApplicationContextTestsimport ACATester/** Tests for static application context with custom application event multicaster. ... */StaticApplicationContext sac, ...;PropertiesBeanDefinitionReader readerTestApplicationEventMulticaster.classthis.sacACATester.classTestApplicationEventMulticaster.counterevents(...)/** Tests for static application context. ... */String MSG_TXT1_US, ...;String MSG_TXT1_UK, ...;String MSG_TXT2_US, ...;String MSG_TXT3_US, ...;Locale.US/** We really are testing the AbstractMessageSource class here. ... *//** Example taken from the javadocs for the java.text.MessageFormat class */String[] codes1MessageSourceResolvable resolvable1String[] codes2MessageSourceResolvable resolvable2String[] codes3MessageSourceResolvable resolvable3String[] codes4MessageSourceResolvable resolvable4StaticMessageSource messageSourceMap<String,String> usMessagesaddMessages(...)StaticMessageSource sourceStaticMessageSource parent// Try with Locale.US// The first time searching, we don't care about for this test// Now msg better be as expected// Now msg better be as expected even with different args/* Try with Locale.US ... */// Try with Locale.UK// Try with Locale.US - Use a different test msg that requires no args// first code valid// only second code valid// no code valid, but default given// no code valid, no defaultnew NoOpAdvice(...)/** A no-op {@link Runnable} implementation. ... */// explicit no-op/** Test that it performs the correct lookup. */LocalInterfaceWithBusinessMethods ejbLocalInterfaceWithBusinessMethods.classContext mockContextmockContext(...)configuredInterceptor(...)NamingException nexnew NamingException(...)JndiTemplate jtnew JndiTemplate(...) { ... }LocalSlsbInvokerInterceptor sinew LocalSlsbInvokerInterceptor(...)NamingException.classBusinessMethods.classBusinessMethods targettargetMethod(...)LocalInterface ejbLocalInterface.classLocalInterfaceWithBusinessMethods targettestException(...)new ApplicationException(...)SlsbHome mockHomeSlsbHome.classContext mockCtxContext.class/** Needed so that we can mock the create() method. */// default resourceRef=false should cause this to fail, as java:/comp/env will not// automatically be addedMyEjb myEjbMyEjb.classMyHome homeMyHome.classLocalStatelessSessionProxyFactoryBean fbnew LocalStatelessSessionProxyFactoryBean(...)MyBusinessMethods mbmsetBusinessInterface(...)MyBusinessMethods.classCreateException cexnew CreateException(...)getBusinessInterface(...)EjbAccessException.class// parameterize// Need lifecycle methods// no java:comp/env prefix// Will do JNDI lookup to get home but won't call create// Could actually try to figure out interface from create?// Don't set business interface// Check it's a singleton// Expect no methods on homeSimpleRemoteSlsbInvokerInterceptor sicreateInterceptor(...)new SimpleRemoteSlsbInvokerInterceptor(...)RemoteInterface ejbRemoteInterface.classconfiguredProxy(...)RemoteInterface targetsetExposeAccessContext(...)doTestInvokesMethodOnEjbInstance(...)int lookupCountsetLookupHomeOnStartup(...)setCacheHome(...)doTestInvokesMethodOnEjbInstanceWithConnectExceptionWithRefresh(...)setRefreshHomeOnConnectFailure(...)BusinessInterface targetBusinessInterface.classRemoteAccessException.classdoTestException(...)/** Needed so that we can mock create() method. */// Also business exception!?new SimpleRemoteStatelessSessionProxyFactoryBean(...)SimpleRemoteStatelessSessionProxyFactoryBean fbMyLocalBusinessMethods mbmMyLocalBusinessMethods.class// TODO might want to control this behaviour...// Do we really want to call remove after a remote exception?// rely on default setting of resourceRef=false, no auto addition of java:/comp/env prefixComponentDefinition componentassertPropertyValue(...)LocalStatelessSessionProxyFactoryBean.classSimpleRemoteStatelessSessionProxyFactoryBean.class/** Tests for {@link DateFormatter}. ... */Calendar.JUNECalendar.JANUARYString[] charsString ttestJodaStylePatterns(...)DateTimeFormatter jodaFormatterDateTimeZone.UTCString jodaPrintedCalendar calCalendar.HOURimport FormattingConversionServiceimport DataBinderDataBinder binder, ...;DateFormatterRegistrar registrarsetup(...)SimpleDateBean beannew SimpleDateBean(...)new FormattingConversionService(...)getChildren(...)new DataBinder(...)MutablePropertyValues propertyValuesDateFormatter dateFormattersetFormatter(...)String expectednew ArrayList<SimpleDateBean>(...)Long millis, ...;Long millisAnnotated, ...;Calendar calendarAnnotated, ...;Date dateAnnotated, ...;Date dateAnnotatedPattern, ...;Date isoDate, ...;Date isoTime, ...;Date isoDateTime, ...;List<SimpleDateBean> children, ...;this.millisthis.millisAnnotatedthis.calendarAnnotatedthis.dateAnnotatedthis.dateAnnotatedPatternthis.isoDatethis.isoTimethis.isoDateTime// TODO This currently passes because of the Date(String) constructor fallback is used// SPR-10105// This is a format that cannot be parsed by new Date(String)new DateTimeFormatterFactoryBean(...)DateTimeFormatterFactoryBean factory, ...;TimeZone ZURICH, ...;// Potential test timezone, both have daylight savings on October 21stTimeZone NEW_YORK, ...;TimeZone TEST_TIMEZONE, ...;// Ensure that we are testing against a timezone other than the default.DateTimeFormatterFactory factory, ...;DateTime dateTime, ...;DateTimeFormatter fallbackapplyLocale(...)DateTimeZone dateTimeZoneDateTime dateTimeString offsetimport ISOChronologyJodaTimeFormatterRegistrar registrarJodaTimeBean beannew JodaTimeBean(...)new JodaTimeContext(...)forID(...)setJodaTimeContext(...)patternForStyle(...)setDateFormatter(...)initDirectFieldAccess(...)setTimeFormatter(...)new LocalDateTime(...)getInstanceUTC(...)setUseIsoFormat(...)setDateTimeFormatter(...)DataBinder bindernew ArrayList<JodaTimeBean>(...)LocalDate localDate, ...;LocalDate localDateAnnotated, ...;LocalTime localTime, ...;LocalTime localTimeAnnotated, ...;LocalDateTime localDateTime, ...;LocalDateTime localDateTimeAnnotated, ...;DateTime dateTimeAnnotated, ...;DateTime dateTimeAnnotatedDefault, ...;DateTime dateTimeAnnotatedPattern, ...;LocalDate isoDate, ...;LocalTime isoTime, ...;DateTime isoDateTime, ...;Instant instantAnnotated, ...;Instant mutableDateTimeAnnotated, ...;Period period, ...;Duration duration, ...;YearMonth yearMonth, ...;MonthDay monthDay, ...;List<JodaTimeBean> children, ...;this.localDatethis.localDateAnnotatedthis.localTimethis.localTimeAnnotatedthis.localDateTimethis.localDateTimeAnnotatedthis.dateTimethis.dateTimeAnnotatedthis.dateTimeAnnotatedPatternthis.dateTimeAnnotatedDefaultthis.instantAnnotatedthis.mutableDateTimeAnnotatedthis.durationthis.yearMonththis.monthDayLocalDateTime dateTime, ...;ZoneId dateTimeZoneDateTimeFormatterRegistrar registrarDateTimeBean beannew DateTimeBean(...)new DateTimeContext(...)setDateTimeContext(...)TimeZone defaultZonenew ArrayList<DateTimeBean>(...)LocalDateTime dateTimeAnnotatedPattern, ...;LocalDateTime isoDateTime, ...;Instant instant, ...;Year year, ...;Month month, ...;List<DateTimeBean> children, ...;this.instantthis.yearthis.monthimport Randomimport DisplayNameimport DisplayNameGenerationimport ReplaceUnderscoresimport ExtensionContextimport Argumentsimport ArgumentsProviderimport ArgumentsSourceimport static Instant.MAXimport static Instant.MINimport static ZoneId.systemDefaultRandomInstantProvider.classRFC1123SerializedInstantProvider.classISOSerializedInstantProvider.class/** Unit tests for {@link InstantFormatter}. ... */ReplaceUnderscores.classInstantFormatter instantFormatter, ...;Instant expectedDateTimeFormatter.ISO_INSTANTnew TemporalQuery<Instant>(...) { ... }Instant actualString actualnew Random(...)long DATA_SET_SIZE, ...;Random random, ...;limit(...)provideArguments(...)new Function<?,Arguments>(...) { ... }randomInstantStream(...)concat(...)mapToObj(...)now(...)longs(...)getEpochSecond(...)new LongFunction<Instant>(...) { ... }ofEpochSecond(...)new Function<Instant,String>(...) { ... }Instant min, ...;// RFC-1123 supports only 4-digit yearsInstant max, ...;// make sure that the data set includes current instantCurrencyStyleFormatter formatter, ...;ParseException.classRoundingMode.DOWNInteger numberDefault, ...;Double numberDefaultAnnotated, ...;BigDecimal currency, ...;BigDecimal percent, ...;BigDecimal pattern, ...;...[] patternArray, ...;List<BigDecimal> patternList, ...;List<BigDecimal> patternList2, ...;this.numberDefaultthis.numberDefaultAnnotatedthis.percentthis.patternArraythis.patternListthis.patternList2NumberStyleFormatter formatter, ...;PercentStyleFormatter formatter, ...;import DefaultFormattingConversionServiceMoneyHolder beannew MoneyHolder(...)getAmount(...)FormattedMoneyHolder1 beannew FormattedMoneyHolder1(...)FormattedMoneyHolder2 beannew FormattedMoneyHolder2(...)FormattedMoneyHolder3 beannew FormattedMoneyHolder3(...)FormattedMoneyHolder4 beannew FormattedMoneyHolder4(...)FormattedMoneyHolder5 beannew FormattedMoneyHolder5(...)MonetaryAmount amount, ...;CurrencyUnit unit, ...;this.amountNumberFormat.Style.NUMBERNumberFormat.StyleNumberFormat.Style.PERCENTFormattingConversionServiceFactoryBean factorynew FormattingConversionServiceFactoryBean(...)FormattingConversionService fcsTypeDescriptor descriptorsetRegisterDefaultFormatters(...)ConversionFailedException.classSet<Object> formattersnew TestBeanFormatter(...)new SpecialIntAnnotationFormatterFactory(...)setFormatters(...)getSpecialInt(...)Set<FormatterRegistrar> registrarsnew HashSet<FormatterRegistrar>(...)new TestFormatterRegistrar(...)setFormatterRegistrars(...)double pattern, ...;int specialInt, ...;this.specialIntTestBean objectsetSpecialInt(...)Set<Class<?>> fieldTypes, ...;alias(...)new Printer<Integer>(...) { ... }new Parser<Integer>(...) { ... }import DateTimeParserimport JodaDateTimeFormatAnnotationFormatterFactoryimport ReadablePartialPrinterFormattingConversionService formattingService, ...;String formattednew LocalDate(...)LocalDate datenew Converter<DateTime,LocalDate>(...) { ... }ValueBean valueBeanFormattingConversionServiceFactoryBean.classvalueBean.dateMetaValueBean.classMetaValueBean valueBeanvalueBean.numberdoTestFormatFieldForAnnotation(...)Model.classModelWithPlaceholders.classtoDateTimeAtCurrentTime(...)List<Date> datesnew ArrayList<Date>(...)Object modelConfigurablePropertyAccessor accessornew Converter<Date,Long>(...) { ... }new Converter<DateTime,Date>(...) { ... }new NullReturningFormatter(...)new JodaDateTimeFormatAnnotationFormatterFactory(...) { ... }MyDate.classnew Converter<MyDate,Long>(...) { ... }new Converter<MyDate,Date>(...) { ... }new MyDate(...)ModelWithSubclassField.classregisterDefaultValue(...)new Formatter<T>(...) { ... }addPrinter(...)addParser(...)Formatter<?> formatternew IntegerConverter(...)Converter<?,?> converteraddConverterFactory(...)new IntegerConverterFactory(...)ConverterFactory<?,?> converterFactoryDouble number, ...;List<Date> dates, ...;this.datesMyDate date, ...;ReflectiveLoadTimeWeaver handler/** Unit tests for the {@link ReflectiveLoadTimeWeaver} class. ... */JustAddTransformerClassLoader classLoadernew JustAddTransformerClassLoader(...)ReflectiveLoadTimeWeaver weavernew ClassFileTransformer(...) { ... }getNumTimesGetThrowawayClassLoaderCalled(...)ClassLoader throwawayClassLoaderTotallyCompliantClassLoader classLoadernew TotallyCompliantClassLoader(...)int numTimesAddTransformerCalled, ...;this.numTimesAddTransformerCalledint numTimesGetThrowawayClassLoaderCalled, ...;this.numTimesGetThrowawayClassLoaderCallednew ResourceOverridingShadowingClassLoader(...)String EXISTING_RESOURCE, ...;ClassLoader thisClassLoader, ...;ResourceOverridingShadowingClassLoader overridingLoader, ...;override(...)countElements(...)int elts/** Base JMX test class that pre-loads an ApplicationContext from a user-configurable file. Override the ... */getApplicationContextPath(...)import BindExceptionimport ExtendWithimport LifecycleMethodExecutionExceptionHandlerimport TestExecutionExceptionHandlerimport TestAbortedExceptionimport BindExceptionHandlerimport MBeanTestUtils/** <p>If you run into the <em>"Unsupported protocol: jmxmp"</em> error, you will need to ... */BindExceptionHandler.classonSetUp(...)releaseServer(...)onTearDown(...)getServer(...)resetMBeanServers(...)/** Start the specified {@link MBeanExporter}. */handleBindException(...)new TestAbortedException(...)// Abort test?// Else rethrow to conform to the contracts of TestExecutionExceptionHandler and LifecycleMethodExecutionExceptionHandler// used to test invalid methods that exist in the proxy interface/** @@org.springframework.jmx.export.metadata.ManagedResource ... */boolean isSuperman, ...;/** @@org.springframework.jmx.export.metadata.ManagedAttribute ... *//** @@org.springframework.jmx.export.metadata.ManagedOperation(currencyTimeLimit=30) *//** @@org.springframework.jmx.export.metadata.ManagedAttribute(description="The ... */this.isSuperman/** @@org.springframework.jmx.export.metadata.ManagedOperation(description="Add ... *//** Test method that is not exposed by the MetadataAssembler. */import MemoryMXBeanimport ThreadMXBeanimport AbstractMBeanServerTestsimport IJmxTestBeanimport JmxTestBeanimport AbstractReflectiveMBeanInfoAssemblerimport SocketUtilsString OBJECT_NAME, ...;JmxTestBean target, ...;boolean runTests, ...;MBeanExporter adapternew MBeanExporter(...)new JmxTestBean(...)setBeans(...)new ProxyTestAssembler(...)MBeanProxyFactoryBean factorynew MBeanProxyFactoryBean(...)getServerConnection(...)setProxyInterface(...)IJmxTestBean.classIJmxTestBean proxyIJmxTestBean proxy1IJmxTestBean proxy2InvalidInvocationException.classmyOperation(...)IJmxTestBean beandontExposeMe(...)findAvailableTcpPort(...)JMXConnectorServer connectorsetServiceUrl(...)setConnectOnStartup(...)setRefreshOnConnectFailure(...)BindException exMBeanClientInterceptor interceptornew MBeanClientInterceptor(...)MemoryMXBean proxyMemoryMXBean.classgetMax(...)getHeapMemoryUsage(...)ThreadMXBean proxyThreadMXBean.classgetThreadInfo(...)// should skip connection to the server// now start the connector// should now be able to access data via the lazy proxytearDown(...)import AbstractJmxTestsSimpleDateFormat df, ...;DateRange drDateRange.classgetStartDate(...)getEndDate(...)ObjectName onameDate startJmxDate endJmxDate startDate, ...;Date endDate, ...;this.startDatethis.endDateboolean exceptOnInit, ...;this.exceptOnInitJmxTestBean beanMBeanExporter exporterRequiredModelMBean beanMBeanInfo infoFromServerObjectName objectNameTemplateJmxTestBean bean1JmxTestBean bean2ObjectName reg1ObjectName reg2new ObjectNamingStrategy(...) { ... }assertIsRegistered(...)assertObjectNameMatchesTemplate(...)setEnsureUniqueRuntimeObjectNames(...)InstanceAlreadyExistsException.classMBeanExportException.class/** Integration tests for the {@link MBeanExporter} class. ... */Map<String,NotificationListener> listenersnew HashMap<String,NotificationListener>(...)setNotificationListenerMappings(...)NotificationListener dummyListenernew NotificationListener(...) { ... }getBeanMap(...)new Consumer<MBeanExportException>(...) { ... }InstanceNotFoundException.classInvokeDetectAssembler asmnew InvokeDetectAssembler(...)new TestDynamicMBean(...)Object nameasm.invokedObjectInstance instancegetObjectInstance(...)MockMBeanExporterListener listener1new MockMBeanExporterListener(...)MockMBeanExporterListener listener2setListeners(...)assertListener(...)Object nameValueSelfNamingTestBean testBeannew SelfNamingTestBean(...)Person preRegisteredPerson springRegisteredString objectName2ObjectInstance instance2String otherNamesetExposeManagedResourceClassLoader(...)String exportedBeanNameMap<String,Object> beansToExportMBeanExporter.AUTODETECT_NONEnew NamedBeanAutodetectCapableMBeanInfoAssemblerStub(...)MBeanExporter.AUTODETECT_MBEANassertIsNotRegistered(...)String notToBeExportedBeanNameMBeanExporter.AUTODETECT_ALLMBeanExporter.AUTODETECT_ASSEMBLER/** Want to ensure that said MBean is not exported twice. */setAutodetectModeName(...)MockMBeanExporterListener listenergetUnregistered(...)BeanDefinitionBuilder testBeanJmxTestBean.classObject testBeanInstanceStubNotificationListener listenernew StubNotificationListener(...)BeanDefinitionBuilder builder1BeanDefinitionBuilder builder2RuntimeExceptionThrowingConstructorBean.classString objectName1String firstBeanNameString secondBeanNameaddExcludedBean(...)ProperSomethingFactoryBean.classNullSomethingFactoryBean.classObjectName desiredgetRegistered(...)new ArrayList<ObjectName>(...)List<ObjectName> registered, ...;List<ObjectName> unregistered, ...;new ArrayList<Notification>(...)List<Notification> notifications, ...;this.notificationsCollection<String> namedBeans, ...;this.namedBeansnew Something(...)Something.class// put null in as a value...// the MBean with the supplied object name does not exist...// should still be the first bean with name Rob Harrop// should still be the new bean with name Sally Greenwood// MBean has a bad ObjectName, so if said MBean is autodetected, an exception will be thrown...// SPR-2158// SPR-3302// SPR-3625import NotificationListenerRegistrarCountingAttributeChangeNotificationListener listenernew CountingAttributeChangeNotificationListener(...)Map<> notificationListenersObject handbackNotificationListenerBean listenerBeansetHandback(...)setNotificationListeners(...)getLastHandback(...)String nameAttributeString ageAttributesetNotificationFilter(...)new NotificationFilter(...) { ... }AttributeChangeNotification changeNotificationMap<> listenerMappingsString beanName1String beanName2ObjectName objectName1ObjectName objectName2SelfNamingTestBean testBean1SelfNamingTestBean testBean2NotificationListenerRegistrar registrarnew NotificationListenerRegistrar(...)setMappedObjectNames(...)Map<> attributeCounts, ...;Map<> attributeHandbacks, ...;AttributeChangeNotification attNotificationInteger currentCountthis.attributeCountsthis.attributeHandbacksInteger count// update the attribute// update the attributes// try to update the attribute again//registrar.setMappedObjectNames(new Object[] {objectName, objectName2});import MBeanConstructorInfoimport MBeanNotificationInfoimport NotificationBroadcasterSupportimport NotificationPublisher/** Integration tests for the Spring JMX {@link NotificationPublisher} functionality. ... */new CountingNotificationListener(...)CountingNotificationListener listener, ...;MyNotificationPublisher publishergetNotificationPublisher(...)listener.countnew MyNotificationPublisher(...)MyNotificationPublisherMBean publisherNotification lastNotification, ...;this.lastNotificationNotificationPublisher notificationPublisher, ...;this.notificationPublishernew Notification(...)new MBeanInfo(...)new MBeanAttributeInfo[]new MBeanConstructorInfo[]new MBeanOperationInfo[]new MBeanNotificationInfo[]MyNotificationPublisherMBean.class// need to touch the MBean proxyInteger ageMBeanAttributeInfo attrnew MBeanAttributeInfo(...)TestDynamicMBean.classimport AbstractMetadataAssemblerTestsModelMBeanInfo infgetMBeanInfoFromAssembler(...)ModelMBeanAttributeInfo attrModelMBeanOperationInfo opgetAssembler(...)ModelMBeanAttributeInfo attr2new AnnotationTestSubBean(...)getExpectedAttributeCount(...)getExpectedOperationCount(...)MetricType.COUNTERnew FactoryCreatedAnnotationTestBean(...)FactoryCreatedAnnotationTestBean instance, ...;FactoryCreatedAnnotationTestBean.classString colour, ...;String bar, ...;import EnableMBeanExportimport MBeanExportConfigurationimport MBeanExporterTestsimport TestDynamicMBean/** Tests for {@link EnableMBeanExport} and {@link MBeanExportConfiguration}. ... */AnnotationConfigApplicationContext ctx, ...;LazyNamingConfiguration.classvalidateAnnotationTestBean(...)ProxyConfiguration.classInvalidMetadataException.classPackagePrivateConfiguration.classPackagePrivateTestBean.classPackagePrivateInterfaceImplementationConfiguration.classPackagePrivateAnnotationTestBean.classPackagePrivateExtensionConfiguration.classPlaceholderBasedConfiguration.classLazyAssemblingConfiguration.classvalidateMBeanAttribute(...)ComponentScanConfiguration.classnew MBeanServerFactoryBean(...)AnnotationTestBean beannew AnnotationTestBean(...)new AnnotationTestBeanFactory(...)MBeanExporterTests.Personnew PackagePrivateTestBean(...)PackagePrivateTestBeanExtension beannew PackagePrivateTestBeanExtension(...)new PackagePrivateAnnotationTestBean(...)import MXBeanFooNotX.classFooX.classString AGE_ATTRIBUTE, ...;MBeanInfo infgetOperations(...).lengthgetAttributes(...).lengthMBeanAttributeInfo[] infinf.lengthMBeanOperationInfo[] infModelMBeanOperationInfo getModelMBeanOperationInfo setMBeanNotificationInfo[] notificationsgetNotifications(...)getNotifTypes(...)notifications.lengthnotifTypes.length// beans are registered at this point - just grab them from the serverString QUEUE_SIZE_METRIC, ...;String CACHE_ENTRIES_METRIC, ...;/** Tests the situation where the attribute is only defined on the getter. *//** Tests the situation where the property only has a getter. *//** Tests the situation where the property only has a setter. */ModelMBeanOperationInfo operIJmxTestBean tbcreateJmxTestBean(...)MetadataMBeanInfoAssembler assemblerModelMBeanAttributeInfo metricModelMBeanOperationInfo operationsetAttributeSource(...)getAttributeSource(...)InterfaceBasedMBeanInfoAssembler assemblernew InterfaceBasedMBeanInfoAssembler(...)setManagedInterfaces(...)ICustomJmxBean.classgetWithMapping(...)IAdditionalTestMethods.classassertNickName(...)setInterfaceMappings(...)MethodExclusionMBeanInfoAssembler assemblernew MethodExclusionMBeanInfoAssembler(...)setIgnoredMethodMappings(...)setIgnoredMethods(...)/* https://opensource.atlassian.com/projects/spring/browse/SPR-2754 */Properties ignored// this bean does not have any ignored methods on it, so must obviously not be ignored...MethodNameBasedMBeanInfoAssembler assemblersetManagedMethods(...)new MethodNameBasedMBeanInfoAssembler(...)setMethodMappings(...)MBeanOperationInfo operationSetAgeObjectNamingStrategy stratgetStrategy(...)getCorrectObjectName(...)IdentityNamingStrategy strategynew IdentityNamingStrategy(...)getKeyProperty(...)IdentityNamingStrategy.TYPE_KEYIdentityNamingStrategy.HASH_CODE_KEYKeyNamingStrategy stratsetMappingLocation(...)setMappings(...)import SpringModelMBeancreateObjectName(...)NotificationPublisher publisherStubSpringModelMBean mbeannew StubSpringModelMBean(...)Notification notificationgetActualNotification(...)new AttributeChangeNotification(...)Notification actualNotification, ...;this.actualNotification/** Integration tests for {@link ConnectorServerFactoryBean}. ... */ConnectorServerFactoryBean beannew ConnectorServerFactoryBean(...)checkServerConnection(...)JMXServiceURL serviceURLJMXConnector connectorMBeanServerConnection connectiongetMBeanCount(...)// Try to get the connector bean.// Try to connect using client.// Get the MBean server connection.// Test for MBean server equality./** Unit tests for {@link JmxUtils}. ... */JmxClass.classSpecializedJmxInterface.classJmxInterface.classDynamicMBean mbeanStandardMBean mbeannew StandardMBeanImpl(...)FooX foonew FooX(...)Abc abcnew Abc(...)AttributeTestBean.classObject managedResourceObjectName uniqueNameString typePropertyJmxUtils.IDENTITY_OBJECT_NAME_KEY// Correctly returns true for a class// Correctly returns false since JmxUtils won't navigate to the extended interface// Incorrectly returns true since it doesn't detect that this is an interface/** Integration tests for {@link MBeanServerConnectionFactoryBean}. ... */MBeanServerConnectionFactoryBean beannew MBeanServerConnectionFactoryBean(...)JMXConnectorServer connectorServerstartConnectorServer(...)JMXServiceURL jmxServiceUrl// perform simple MBean count test/** Integration tests for {@link MBeanServerFactoryBean}. ... */MBeanServerFactoryBean beangetDefaultDomain(...)setLocateExistingServerIfPossible(...)MBeanServer otherServersetAgentId(...)assertCreation(...)setRegisterWithFactory(...)hasInstance(...)new Predicate<MBeanServer>(...) { ... }import NamingManager/** Tests for {@link JndiLocatorDelegate}. ... */Field builderFieldNamingManager.classObject oldBuilderisDefaultJndiEnvironmentAvailable(...)JndiObjectFactoryBean jofnew JndiObjectFactoryBean(...)setDefaultObject(...)import SimpleNamingContext/** Unit tests for {@link JndiPropertySource}. ... */JndiPropertySource psnew JndiPropertySource(...)SimpleNamingContext contextnew SimpleNamingContext(...)JndiTemplate jndiTemplatenew JndiLocatorDelegate(...) { ... }new JndiTemplateEditor(...)JndiTemplateEditor je// These properties are meaningless for JNDI, but we don't worry about that:// the underlying JNDI implementation will throw exceptions when the user tries// to look anything upContext contextObject o2NameNotFoundException neNameNotFoundException.classTypeMismatchNamingException.class/** Simple {@link ConfigurableEnvironment} implementation exposing ... */MockPropertySource propertySource, ...;/** Create a new {@code MockEnvironment} with a single {@link MockPropertySource}. */this.propertySource/** Set a property on the underlying {@link MockPropertySource} for this environment. *//** Convenient synonym for {@link #setProperty} that returns the current instance. ... */import UnmarshalExceptionCountingRmiProxyFactoryBean factorynew CountingRmiProxyFactoryBean(...)IRemoteBean proxysetServiceInterface(...)IRemoteBean.classRemoteBean.namefactory.counterdoTestRmiProxyFactoryBeanWithException(...)ConnectIOException.classUnknownHostException.classNoSuchObjectException.classStubNotFoundException.classUnmarshalException.classdoTestRmiProxyFactoryBeanWithExceptionAndRefresh(...)setRefreshStubOnConnectFailure(...)IBusinessBean proxyIBusinessBean.classIWrongBusinessBean proxyIWrongBusinessBean.classRemoteProxyFailureException.classsetOtherName(...)doTestRmiProxyFactoryBeanWithBusinessInterfaceAndException(...)RemoteConnectFailureException.classdoTestRmiProxyFactoryBeanWithBusinessInterfaceAndExceptionAndRefresh(...)boolean isRemoteConnectFailureRmiClientInterceptor clientnew RmiClientInterceptor(...)RemoteBean rbnew RemoteBean(...)Method setNameMethodnew MethodInvocation(...) { ... }RemoteInvocation invString serviceUrlRmiProxyFactoryBean factorynew RmiProxyFactoryBean(...) { ... }new RmiInvocationHandler(...) { ... }Class<?> exClass// let's see if the remote invocation object works// this is a bit BS, but we need to test it// shouldn't go through to remote service// should go throughint originalStackTraceLngthgetStackTrace(...).length// just want to ensure that it doesn't bomb/** Unit tests for {@link AnnotationAsyncExecutionInterceptor}. ... */AnnotationAsyncExecutionInterceptor i// method level// class level// method and class level -> method value overrides// method and class level -> method value, even if empty, overrides// meta annotation with qualifierinitContext(...)AsyncAnnotationBeanPostProcessor.classThread mainThreadThread asyncThreadgetThread(...)new Supplier<ITestBean>(...) { ... }BeanDefinition processorDefinitionBeanDefinition executorDefinitionAsyncAnnotationBeanPostProcessorTests.TestBean.classAsyncAnnotationBeanPostProcessorTests.TestBeanBeanDefinition executorDefinition2TestableAsyncUncaughtExceptionHandler exceptionHandlerTestableAsyncUncaughtExceptionHandler.classisCalled(...)failWithVoid(...)assertCalledWith(...)ConfigWithExceptionHandler.classFuture<Object> resultfailWithFuture(...)assertFutureWithException(...)failWithListenableFuture(...)ExecutionException.classnew TestableAsyncUncaughtExceptionHandler(...)new DirectExecutor(...)Thread thread, ...;CountDownLatch latch, ...;this.threadthis.latchException eexceptionHandler(...)String originalThreadName, ...;int listenerCalled, ...;int listenerConstructed, ...;AsyncMethodBean asyncTestAsyncMethodBean.classFuture<String> futurereturnSomething(...)ListenableFuture<String> listenableFuturereturnSomethingListenable(...)CompletableFuture<String> completableFuturereturnSomethingCompletable(...)DefaultAdvisorAutoProxyCreator.classdoNothing(...)SimpleInterface asyncTestSimpleInterface.classSimpleAsyncMethodBean.classAsyncMethodWithQualifierBean asyncTestAsyncMethodWithQualifierBean.classFuture<String> future2returnSomething2(...)SimpleAsyncMethodWithQualifierBean.classAsyncClassBean asyncTestAsyncClassBean.classRegularInterface asyncTestRegularInterface.classAsyncClassBeanWithInterface.classAsyncInterface asyncTestAsyncInterface.classAsyncInterfaceBean.classDynamicAsyncInterfaceBean.classAsyncMethodsInterface asyncTestAsyncMethodsInterface.classAsyncMethodsInterfaceBean.classDynamicAsyncMethodsInterfaceBean.classAsyncMethodListener.classAsyncClassListener.classforExecutionException(...)forValue(...)AsyncInterface proxy, ...;DefaultIntroductionAdvisor advisorAsyncMethodsInterface proxy, ...;Set<String> valuesListenableFuture<String> futurenew ListenableFutureCallback<String>(...) { ... }completable(...)thenAccept(...)Set<Throwable> valuesnew SuccessCallback<String>(...) { ... }import CustomizableThreadFactory/** Tests use of @EnableAsync on @Configuration classes. ... */AsyncBean asyncBeanAsyncBean.classwork(...)AsyncBeanUser asyncBeanUserAsyncBeanUser.classgetAsyncBean(...)AsyncConfigWithMockito.classAsyncBeanWithInterface.classAsyncBeanWithExecutorQualifiedByName asyncBeanAsyncBeanWithExecutorQualifiedByName.classFuture<Thread> workerThread0work0(...)Future<Thread> workerThreadFuture<Thread> workerThread2work2(...)Future<Thread> workerThread3work3(...)AsyncWithExecutorQualifiedByNameConfig.classdoesNotStartWith(...)OrderedAsyncConfig.classCustomAsyncBean.classboolean isAsyncAdvisedCustomAsyncAnnotationConfig.class/** Fails with classpath errors on trying to classload AnnotationAsyncExecutionAspect. */AspectJAsyncAnnotationConfig.classCustomExecutorBean.classgetThreadOfExecution(...)CustomExecutorConfig.classfail(...)untilAsserted(...)new ThrowingRunnable(...) { ... }CustomExecutorBeanConfig.classExecutorPostProcessor.classSpr14949ConfigA.classAsyncInterface asyncBeanSpr14949ConfigB.classJdkProxyConfiguration.classnew AsyncResult<Thread>(...)Thread threadOfExecution, ...;this.threadOfExecutionAsyncBean asyncBean, ...;this.asyncBeanCustomAsync.classnew AsyncBean(...)new AsyncBeanWithExecutorQualifiedByName(...)new CustomizableThreadFactory(...)executor(...)new AsyncService(...)UserConfiguration.classnew AsyncBeanWithInterface(...)new AsyncBeanUser(...)// SPR-14949import ThreadPoolTaskSchedulerimport IntervalTask/** Tests use of @EnableScheduling on @Configuration classes. ... */FixedRateTaskConfig.classScheduledTaskHolder.classisGreaterThanOrEqualTo(...)AtomicInteger.classFixedRateTaskConfigSubclass.classExplicitSchedulerConfig.classgetBean(...).threadNameAmbiguousExplicitSchedulerConfig.classExplicitScheduledTaskRegistrarConfig.classSchedulingEnabled_withAmbiguousTaskSchedulers_butNoActualTasks.classSchedulingEnabled_withAmbiguousTaskSchedulers_andSingleTask.classSchedulingEnabled_withAmbiguousTaskSchedulers_andSingleTask_disambiguatedByScheduledTaskRegistrar.classgetBean(...).executedByThreadThreadAwareWorker.classSchedulingEnabled_withAmbiguousTaskSchedulers_andSingleTask_disambiguatedBySchedulerNameAttribute.classSchedulingEnabled_withTaskAddedVia_configureTasks.classTriggerTaskConfig.classAtomicInteger counterFixedRateTaskConfig_withInitialDelay.classisBetween(...)counter(...)String threadName, ...;ThreadPoolTaskScheduler schedulernew ThreadPoolTaskScheduler(...)taskScheduler1(...)String executedByThread, ...;worker(...).executedByThreadworker(...)new ThreadAwareWorker(...)taskScheduler2(...)taskScheduler(...)// No exception raised as of 4.3, aligned with the behavior for @Async methods (SPR-14030)// The @Scheduled method should have been called at least once but// not more times than the delay allows.StaticApplicationContext context, ...;ScheduledAnnotationBeanPostProcessor.classFixedDelayTestBean.classScheduledTaskHolder postProcessorScheduledTaskRegistrar registrarList<IntervalTask> fixedDelayTasksScheduledMethodRunnable runnableFixedRateTestBean.classList<IntervalTask> fixedRateTasksFixedRateWithInitialDelayTestBean.classSeveralFixedRatesWithRepeatedScheduledAnnotationTestBean.classseveralFixedRates(...)SeveralFixedRatesWithSchedulesContainerAnnotationTestBean.classFixedRatesSubBean.classFixedRatesDefaultBean.classIntervalTask task1ScheduledMethodRunnable runnable1IntervalTask task2ScheduledMethodRunnable runnable2CronTestBean.classList<CronTask> cronTasksCronWithTimezoneTestBean.classTrigger triggerCronTrigger cronTriggerDate lastScheduledExecutionTimeDate lastActualExecutionTimeDate lastCompletionTimeTriggerContext triggerContextDate nextExecutionTimeCronWithInvalidTimezoneTestBean.classBeanDefinition validationDefinitionProxiedCronTestBean.classProxiedCronTestBeanDependent.classMetaAnnotationFixedRateTestBean.classComposedAnnotationFixedRateTestBean.classMetaAnnotationCronTestBean.classString businessHoursCronExpressionBeanDefinition placeholderDefinitionPropertyPlaceholderWithCronTestBean.classpropertyPlaceholderWithFixedDelay(...)PropertyPlaceholderWithFixedDelayTestBean.classpropertyPlaceholderWithFixedRate(...)PropertyPlaceholderWithFixedRateTestBean.classExpressionWithCronTestBean.classMap<String,String> schedulesPropertyPlaceholderMetaAnnotationTestBean.classNonVoidReturnTypeTestBean.classEmptyAnnotationTestBean.classInvalidCronTestBean.classNonEmptyParamListTestBean.classnew SeveralFixedRatesWithRepeatedScheduledAnnotationTestBean(...)// 15-04-2013 4:00 GMT+10// 4:30// 6:00// assert that 6:00 is next execution time/** An {@link AsyncUncaughtExceptionHandler} implementation used for testing purposes. ... */UncaughtExceptionDescriptor descriptor, ...;boolean throwUnexpectedException, ...;this.throwUnexpectedExceptionnew UncaughtExceptionDescriptor(...)descriptor.exdescriptor.methodimport CancellationExceptionimport AtomicReferenceAsyncListenableTaskExecutor executor, ...;String testName, ...;String threadNamePrefix, ...;Object outcome, ...;this.testNamethis.threadNamePrefixbuildExecutor(...)TestTask tasknew TestTask(...)assertThreadNamePrefix(...)dontCatchUncaughtExceptions(...)task.exceptionFuture<?> future1Future<?> future2shutdownExecutor(...)CancellationException.classListenableFuture<?> futureListenableFuture<?> future1ListenableFuture<?> future2TestCallable tasknew TestCallable(...)task.lastThreadtask.latchnew AtomicReference<Exception>(...)int expectedRunCount, ...;AtomicInteger actualRunCount, ...;AtomicReference<Exception> exception, ...;Thread lastThread, ...;this.expectedRunCountRuntimeException exception/* ignore */import NoOpRunnableimport static Assertions.assertThatCodeThreadPoolExecutor concurrentExecutor, ...;setThreadFactory(...)new ConcurrentTaskExecutor(...)Runnable taskConcurrentTaskExecutor executordoesNotThrowAnyException(...)assertThatCode(...)new NoOpRunnable(...)new TaskDecorator(...) { ... }import static Mockito.atLeastScheduledExecutorFactoryBean factorynew ScheduledExecutorFactoryBean(...)setPoolSize(...)new ScheduledExecutorFactoryBean(...) { ... }setScheduledExecutorTasks(...)new NoOpScheduledExecutorTask(...)setWaitForTasksToCompleteOnShutdown(...)new ScheduledExecutorTask(...)pauseToLetTaskStart(...)setPeriod(...)setFixedRate(...)atLeast(...)setContinueScheduledExecutionAfterException(...)setDelay(...)InterruptedException ignored// nice long wait...// invoke destroy before tasks have even been scheduled...// Mock must never have been called// the null must not propagateExecutorConfig.classFutureTask<String> tasknew FutureTask<String>(...)new Callable<String>(...) { ... }new ThreadPoolExecutorFactoryBean(...)ThreadPoolTaskScheduler scheduler, ...;TestErrorHandler errorHandlernew TestErrorHandler(...)errorHandler.lastErrornew TestTrigger(...)errorHandler.latchThrowable lastError, ...;this.lastErrorint maxRunCount, ...;this.maxRunCountthis.actualRunCountAnnotationDrivenBeanDefinitionParserTests.classObject executorObject postProcessorObject schedulerObject exceptionHandlerExecutorBeanDefinitionParserTests.classgetCorePoolSize(...)getMaxPoolSize(...)getQueueCapacity(...)getKeepAliveSeconds(...)getAllowCoreThreadTimeOut(...)CustomizableThreadCreator executorCustomizableThreadCreator.classgetThreadNamePrefix(...)import Timeout/** Tests ensuring that tasks scheduled using the &lt;task:scheduled&gt; element ... */ConfigurableApplicationContext applicationContextTask taskTask.classtask.executedboolean executed, ...;/* Do Nothing *//** Unit tests for {@link ScheduledTaskRegistrar}. ... */Runnable no_op, ...;ScheduledTaskRegistrar taskRegistrar, ...;getTriggerTaskList(...)this.taskRegistrargetCronTaskList(...)getFixedRateTaskList(...)getFixedDelayTaskList(...)TriggerTask mockTriggerTaskTriggerTask.classsetTriggerTasksList(...)CronTask mockCronTaskCronTask.classsetCronTasksList(...)IntervalTask mockFixedRateTaskIntervalTask.classsetFixedRateTasksList(...)IntervalTask mockFixedDelayTasksetFixedDelayTasksList(...)Object testBean, ...;ScheduledTasksBeanDefinitionParserTests.classScheduledTaskRegistrar.classObject schedulerBeanObject schedulerRefList<IntervalTask> tasksScheduledMethodRunnable.classList<CronTask> tasksList<TriggerTask> tasksTestTrigger.classSchedulerBeanDefinitionParserTests.classInteger size/** Unit tests for {@link BitsCronField}. ... */has(...)clearRange(...)setRange(...)new Condition<BitsCronField>(...) { ... }import static DayOfWeek.FRIDAYimport static DayOfWeek.MONDAYimport static DayOfWeek.SUNDAYimport static DayOfWeek.THURSDAYimport static DayOfWeek.TUESDAYimport static DayOfWeek.WEDNESDAYimport static TemporalAdjusters.nextnew Condition<Temporal>(...) { ... }Condition<Temporal> weekday, ...;CronExpression expressionLocalDateTime lastLocalDateTime expectedwithNano(...)plusSeconds(...)withSecond(...)LocalDateTime nowplusMinutes(...)withMinute(...)LocalDateTime actualint yearwithHour(...)withDayOfMonth(...)plusDays(...)plusMonths(...)withMonth(...)getYear(...)ZonedDateTime lastZonedDateTime expectedZonedDateTime actualwithYear(...)getDayOfWeek(...)plusHours(...)plusYears(...)getDayOfMonth(...)plusWeeks(...)// September: 30 days// August: 31 days and not a daylight saving boundary// October: 31 days and a daylight saving boundary in CET// next trigger is in one second because second is wildcard// This is a Saturday// Next day is a week day so add one// Next trigger is 3 months later// L-3 =  third-to-last day of the month// last Friday (5) of the monthisValidExpression(...)import MethodSourceimport static Arguments.arguments/** Unit tests for {@link CronTrigger}. ... */Calendar calendar, ...;this.calendarroundup(...)CronTrigger triggerTriggerContext contextgetTriggerContext(...)setUp(...)GregorianCalendar calendarassertMatchesNextSecond(...)Date localDateSimpleTriggerContext contextTriggerContext context1TriggerContext context2Object actual1Calendar.TUESDAYObject actual2TriggerContext context3CronTrigger trigger1CronTrigger trigger2Calendar.MARCHDate localDateTimearguments(...)// October// September// November// 10=November// TODO: maybe try and detect this as a special case in parser?// 2=February// 7 am is the trigger time// Add two days because we start on Saturday// set expected next trigger time// Next trigger is 3 months latter// This trigger has to be somewhere in between 2am and 3am// Clocks go forward an hour so 2am doesn't exist in CET for this localDateTimeDate nowPeriodicTrigger triggernew PeriodicTrigger(...)Date nextcontext(...)assertNegligibleDifference(...)long periodsetInitialDelay(...)assertApproximateDifference(...)TimeUnit.MINUTESTimeUnit.HOURSPeriodicTrigger trigger1PeriodicTrigger trigger2PeriodicTrigger trigger3// utility methodslong variancenew TestTriggerContext(...)asDate(...)// helper classDate scheduled, ...;Date actual, ...;Date completion, ...;this.scheduledthis.actualthis.completion/** Unit tests for {@link QuartzCronField}. ... */QuartzCronField fieldLocalDate lastLocalDate expectedLocalDate actualDayOfWeek.TUESDAY// last Thursday (4) of the month/** Twee advice that 'scrambles' the return value ... *//** Simple interface used in testing the scripted beans support. ... */import StaticScriptSourceScriptEvaluator evaluatornew BshScriptEvaluator(...)Map<String,Object> argumentsimport Refreshableimport Calculatorimport ConfigurableMessengerimport Messengerimport TestBeanAwareMessengerCalculator calcMessenger messengerString desiredMessageCalculator.classMessenger.classConfigurableMessenger messengersetMessage(...)ConfigurableMessenger messenger2Refreshable refreshablegetRefreshCount(...)new Predicate<NestedRuntimeException>(...) { ... }ScriptCompilationException.classScriptSource scriptScriptSource.classString badScriptBshScriptFactory factorynew BshScriptFactory(...)ScriptFactoryPostProcessor.INLINE_SCRIPT_PREFIXBshScriptUtils.BshExecutionException.classBshScriptUtils.BshExecutionExceptiongetScriptedObject(...)Collection<String> beanNamesMessenger messengerImplMessenger messengerInstanceTestBeanAwareMessenger messengerByTypeTestBeanAwareMessenger messengerByNameCollection<Messenger> beansCalculator calculatorMessenger eventListenerimport AbstractRefreshableTargetSourceString CONFIG, ...;String PROXY_CONFIG, ...;AbstractRefreshableTargetSource targetSourceAbstractRefreshableTargetSource.classlong delayITestBean otherBeangetOtherBean(...)Object testBeanGenericXmlApplicationContext context, ...;LogUserAdvice.classgetCountBefore(...)// No proxy here because the pointcut only applies to the concrete class, not the interfacenew GroovyScriptFactory(...)LogUserAdvice logAdvice, ...;GroovyScriptFactory scriptFactory, ...;GroovyClassLoader gclClass<?> class1Class<?> class2Object testBean1Method method1Object testBean2Method method2import ImportCustomizerimport StandardScriptEvaluatornew GroovyScriptEvaluator(...)GroovyScriptEvaluator evaluatorMyBytecodeProcessor processornew MyBytecodeProcessor(...)setBytecodePostprocessor(...)getCompilerConfiguration(...)processor.processedImportCustomizer importCustomizernew ImportCustomizer(...)addStarImports(...)setCompilationCustomizers(...)StandardScriptEvaluator evaluatornew StandardScriptEvaluator(...)setLanguage(...)import DelegatingMetaClassimport CallCounterimport ContextScriptBeanimport static Assertions.assertThatNullPointerExceptionGroovyScriptFactory factorynew Predicate<ScriptCompilationException>(...) { ... }Object scriptedObjectassertThatNullPointerException(...)CallCounter countingAspectConcreteMessenger.classMap<?,Messenger> beansgetBean(...).processedMyBytecodeProcessor.class/** Tests the SPR-2098 bug whereby no more than 1 property element could be ... */ContextScriptBean beanContextScriptBean bean2testMetaClass(...)Object factoryDelegatingMetaClass dmcnew DelegatingMetaClass(...) { ... }setMetaClass(...)// Check can cast to GroovyObject// SPR-6268// Check that AnnotationUtils works with concrete proxied script classes// expect the exception we threw in the custom metaclass to show it got invoked// System.out.println("Method:" + method.getName());// System.out.println("***********************************************************************************");// System.out.println("Exception caught:");// e.printStackTrace();import BytecodeProcessorSet<String> processed, ...;this.processedimport StreamUtilsResourceScriptSource scriptSourcelong lastModifiedemptyInput(...)new byte[]// underlying File is asked for so that the last modified time can be checked...// And then mock the file changing; i.e. the File says it has been modified// does not support File-based reading; delegates to InputStream-style reading...//resource.getFile();//mock.setThrowable(new FileNotFoundException());// Must now report back as having been modified// Must now continue to report back as not having been modified 'cos the Resource does not support access as a File (and so the lastModified date cannot be determined).import GroovyScriptFactoryString MESSAGE_TEXT, ...;String MESSENGER_BEAN_NAME, ...;String PROCESSOR_BEAN_NAME, ...;String CHANGED_SCRIPT, ...;String EXPECTED_CHANGED_MESSAGE_TEXT, ...;int DEFAULT_SECONDS_TO_PAUSE, ...;String DELEGATING_SCRIPT, ...;new ScriptFactoryPostProcessor(...)BeanDefinition processorBeanDefinitioncreateScriptFactoryPostProcessor(...)BeanDefinition scriptedBeanDefinitioncreateScriptedGroovyBean(...)StaticScriptSource sourceMessenger refreshedMessengerpauseToLetRefreshDelayKickIn(...)BeanDefinitionBuilder collaboratorBuilderDefaultMessengerService.classString collaboratorBeanNameDefaultMessengerService collaboratorGenericApplicationContext businessContextBeanDefinitionBuilder scriptedBeanBuilderGroovyScriptFactory.classGenericApplicationContext presentationCtxStubMessenger.classnew Predicate<FatalBeanException>(...) { ... }String BEAN_WITH_DEPENDENCY_NAMEMessenger messenger1Messenger messenger2ScriptFactoryPostProcessor processorprocessor.scriptBeanFactoryStaticScriptSource.classMessenger messenger, ...;this.messenger// quote the returned message (this is the change)...// cool; now let's change the script and check the refresh behaviour...// the updated script surrounds the message in quotes before returning...// ok, is this change reflected in the reference that the collaborator has?// just tests that the (singleton) script-backed bean is able to be instantiated with references to its collaborators// needs The Sundays compiler; must NOT throw any exception here...import DisabledForJreRangeimport static JRE.JAVA_15/** {@link StandardScriptFactory} (lang:std) tests for JavaScript. ... */// Nashorn JavaScript engine removed in Java 15/** Unit tests for the StaticScriptSource class. ... */String SCRIPT_TEXT, ...;StaticScriptSource source, ...;boolean isModifiedStateContextResource contextResource, ...;Map<String,Resource[]> resourceArrayMap, ...;this.inputStreamthis.contextResourcethis.resourceArrayMapnew ModelMap(...)/* SPR-2185 - Null model assertion causes backwards compatibility issue */ModelMap modelString bingString[] stringsstrings.lengthint[] intsints.lengthArrayList<String> listString barList<TestBean> beansMap<String,TestBean> beansnew HashMap<String,TestBean>(...)ModelMap mapSomeInnerClass innernew SomeInnerClass(...)UKInnerClass innernew UKInnerClass(...)SomeInnerClass valMap<?,?> targetCloneable.classSomeInnerClass.class//Null model arguments added without a name being explicitly supplied are not allowed// must not add if collection is empty...// Null model arguments added without a name being explicitly supplied are not allowed/** Utilities for MBean tests. ... *//** Resets MBeanServerFactory and ManagementFactory to a known consistent state. ... */ManagementFactory.classimport NullValueInNestedPathExceptionimport FieldAccessBeanFieldAccessBean rodnew FieldAccessBean(...)Map<?,?> mFieldAccessBean tbsetIgnoreUnknownFields(...)BindException.classnew Consumer<BindException>(...) { ... }BindingResult brMap<?,?> modelimport AbstractListimport ListIteratorimport InvalidPropertyExceptionimport MethodInvocationExceptionimport BeanWithObjectPropertyBindingResult othersetIgnoreInvalidFields(...)FieldError ageErrorFieldError touchyErrorDataBinder binder2getRequiredBindingResult(...)getCode(...)MethodInvocationException.classBeanWithObjectProperty tbnew BeanWithObjectProperty(...)FormattingConversionService conversionServicenew Formatter<String>(...) { ... }BeanWithIntegerList tbnew BeanWithIntegerList(...)getIntegerList(...)addCustomFormatter(...)DataBinder dataBinderDefaultFormattingConversionService conversionServiceNameBean beannew NameBean(...)new NameBeanConverter(...)setAllowedFields(...)String[] disallowedFieldssetDisallowedFields(...)disallowedFields.length/** Tests for required field, both null, non-existing and empty strings. */setRequiredFields(...)new Formatter<Integer>(...) { ... }Book booknew Book(...)getTitle(...)getISBN(...)getNInStock(...)OptionalHolder beannew OptionalHolder(...)DataBinder dbErrors errorsValidator testValidatornew TestBeanValidator(...)Validator spouseValidatornew SpouseValidator(...)BeanPropertyBindingResult errorsDefaultMessageCodesResolver codesResolvernew CustomCollectionEditor(...) { ... }TreeSet<>.classBeanPropertyBindingResult errors2FieldError nameErrorBeanPropertyBindingResult exStaticMessageSource msSerializablePerson tbObjectOutputStream oosByteArrayInputStream baisObjectInputStream oisnew ObjectInputStream(...)BindException ex2Form formnew Form(...)MutablePropertyValues mpvgetF(...)DefaultMessageCodesResolver messageCodesResolverinitBeanPropertyAccess(...)BeanPropertyBindingResult.classString Title, ...;String ISBN, ...;int nInStock, ...;this.ISBNthis.nInStockList<E> list, ...;listIterator(...)Map<String,Object> f, ...;new GrowingList<Object>(...)// Should not throw// expected, because stack was empty// expected, because stack was reset by setNestedPath// This next code is only generated because of the registered editor, using the// registered type of the editor as guess for the content type of the collection.// SPR-14888// SPR-15009// allow configuration after set a MessageCodesResolver// Keep a default MessageCodesResolver// gh-24347import Format/** Tests for {@link DefaultMessageCodesResolver}. ... */DefaultMessageCodesResolver resolver, ...;setMessageCodeFormatter(...)Format.POSTFIX_ERROR_CODEnew MessageCodeFormatter(...) { ... }/** Unit tests for {@link ValidationUtils}. ... */new EmptyValidator(...)new EmptyOrWhitespaceValidator(...)// Test null// Test empty String// Test whitespace String// Test OKimport NotNullimport Sizeimport CommonAnnotationBeanPostProcessorimport AsyncAnnotationAdvisorBeanValidationPostProcessor.classNotNullConstrainedBean.classwithMessageContainingAll(...)RootBeanDefinition bvppAfterInitConstraintBean.classimport Maximport DefaultMyValidBean beannew MyValidBean(...)doTestProxyValidation(...)MyValidBean.classMyValidInterface<>.classmyValidMethod(...)ValidationException.classmyValidAsyncMethod(...)myGenericMethod(...)LazyMethodValidationConfig.classCustomValidatorBean.classMyValidFactoryBean.classnew Consumer<MyValidInterface<>>(...) { ... }LazyMethodValidationConfigWithProxyTargetClass.classMyGroup.classOtherGroup.classDefault.classMethodValidationPostProcessor postProcessornew MethodValidationPostProcessor(...)setValidator(...)import Constraintimport ConstraintValidatorContextimport Payloadimport Validimport BeanPropertyBindingResultnew SpringValidatorAdapter(...)Validator nativeValidator, ...;SpringValidatorAdapter validatorAdapter, ...;StaticMessageSource messageSource, ...;Validator nativeValidatorthis.nativeValidatorsetPassword(...)setConfirmPassword(...)ConstraintViolation<>.classFieldError error1FieldError error2setEmail(...)setConfirmEmail(...)setAlwaysUseMessageFormat(...)Parent parentnew Parent(...)getChildList(...)createChildren(...)getChildSet(...)Child child1new Child(...)Child child2String password, ...;String confirmPassword, ...;String email, ...;String confirmEmail, ...;this.passwordthis.confirmPasswordthis.emailthis.confirmEmailSameGroup.classSameValidator.classString comparingField, ...;field(...)comparingField(...)message(...)BeanWrapper beanWrapperObject fieldValueObject comparingFieldValuedisableDefaultConstraintViolation(...)addConstraintViolation(...)addPropertyNode(...)buildConstraintViolationWithTemplate(...)new LinkedHashSet<Child>(...)new ArrayList<Child>(...)Integer id, ...;Set<Child> childSet, ...;List<Child> childList, ...;this.childSetthis.childListInteger age, ...;Parent parent, ...;AnythingValidator.classList<Field> fieldsErrorsnew ArrayList<Field>(...)new Consumer<Field>(...) { ... }getDefaultConstraintMessageTemplate(...)// SPR-13406// SPR-15123// SPR-16177import HibernateValidatorimport HibernateValidatorFactoryLocalValidatorFactoryBean validatornew LocalValidatorFactoryBean(...)ValidPerson personnew ValidPerson(...)Set<ConstraintViolation<ValidPerson>> resultConstraintViolation<ValidPerson> cvNotNull.classHibernateValidatorFactory.classsetProviderClass(...)HibernateValidator.classIterator<ConstraintViolation<ValidPerson>> iteratorConstraintViolation<?> cvsetStreet(...)getAddress(...)ValidAddress.classList<String> errorCodesObjectError globalErrorLocalValidatorFactoryBean.classperson.expectsAutowiredValidatorgetAddressList(...)new ValidAddress(...)getAddressSet(...)MainBean mainBeannew MainBean(...)Object rejectedMainBeanWithOptional mainBeannew MainBeanWithOptional(...)ListContainer listContainernew ListContainer(...)addString(...)new ArrayList<ValidAddress>(...)new LinkedHashSet<ValidAddress>(...)ValidAddress address, ...;List<ValidAddress> addressList, ...;Set<ValidAddress> addressSet, ...;boolean expectsAutowiredValidator, ...;this.addressListthis.addressSetString street, ...;this.streetNameAddressValidator.classvalue.namevalue.address.streetvalue.addressvalue.expectsAutowiredValidatornew InnerBean(...)InnerBean inner, ...;InnerValidator.classList<String> list, ...;NotXListValidator.classatIndex(...)inIterable(...)addBeanNode(...)/** Mixin to provide stateful locking functionality. ... *//** This field demonstrates additional state in the mixin *//** Note that we need to override around advice. ... */new LockedException(...)/** Advisor for use with a LockMixin. Applies to all classes. ... */String TEST_NAMESPACE, ...;/** Must be supplied as XML */TestApplicationListener listener, ...;/** Subclass must register this */TestApplicationListener parentListener, ...;/** Must register a TestListener. ... */ACATester acaObject aca2doTestEvents(...)this.parentListenerMyEvent eventByteArrayOutputStream boszeroCounter(...)BeanThatListens bzero(...)// See SPR-10945 Serialized events result in a null source//String[] listenerNames = ((ListableBeanFactory) applicationContext).getBeanDefinitionNames(ApplicationListener.class);//assertTrue("listeners include beanThatListens", Arrays.asList(listenerNames).contains("beanThatListens"));new ArrayList<Runnable>(...)List<Runnable> callbacks, ...;Iterator<Runnable> itApplicationContext ac, ...;this.ac// check re-initialization// check message source availabilityint receivedCount, ...;/** A stub {@link ApplicationListener}. ... */BeanThatBroadcasts beanThatBroadcasts, ...;int eventCount, ...;Map<?,BeanThatListens> beansbeanThatBroadcasts.applicationContextthis.beanThatBroadcastsbeanThatBroadcasts.receivedCount/** Listener that maintains a global count of events. ... */import TestEntity/** Abstract cache annotation tests (containing several reusable methods). ... */CacheableService<?> ccs, ...;CacheManager cm, ...;/** @return */Collection<String> cnthis.cmthis.ccsObject r1Object r2Object r3cacheNull(...)cacheSync(...)cacheSyncNull(...)evictEarly(...)evictWithException(...)Object r4evictAll(...)evictAllEarly(...)conditional(...)conditionalSync(...)varArgsKey(...)int nrnullInvocations(...)nullValue(...)rootVars(...)String expectedKeythrowCheckedSync(...)throwUncheckedSync(...)int oneint threeconditionalUpdate(...)Cache primaryCache secondarymultiCache(...)multiEvict(...)multiUpdate(...)Long idLong.MIN_VALUETestEntity entitynew TestEntity(...)putRefersToResult(...)multiCacheAndEvict(...)multiConditionalCacheAndEvict(...)testCacheable(...)testCacheableNull(...)testCacheableSync(...)testCacheableSyncNull(...)testEvict(...)testEvictEarly(...)testEvictException(...)testEvictAll(...)testEvictAllEarly(...)testEvictWithKey(...)testEvictWithKeyEarly(...)testConditionalExpression(...)testConditionalExpressionSync(...)testUnlessExpression(...)testKeyExpression(...)testVarArgsKey(...)testNullValue(...)AnnotatedClassCacheableService.nullInvocationstestMethodName(...)testRootVars(...)customKeyGenerator(...)Object expectedKeyunknownCustomKeyGenerator(...)CacheManager customCmcustomCacheManager(...)unknownCustomCacheManager(...)testNullArg(...)testCheckedThrowable(...)testCheckedThrowableSync(...)testUncheckedThrowable(...)testUncheckedThrowableSync(...)testCacheUpdate(...)testConditionalCacheUpdate(...)testMultiCache(...)testMultiEvict(...)testMultiPut(...)testPutRefersToResult(...)testMultiCacheAndEvict(...)testMultiConditionalCacheAndEvict(...)// exception occurred, eviction skipped, data should still be in the cache// assert the method name is used// the check method is also cached// Checks that the custom keyGenerator was usedString CACHE_NAME, ...;T cachedoTestCacheGetCallable(...)doTestCacheGetCallableNotInvokedWithHit(...)/** Test that a call to get with a Callable concurrently properly synchronize the ... */List<Object> resultsnew CopyOnWriteArrayList<Object>(...)Runnable runnew Callable<Integer>(...) { ... }// not changed// make sure the thread will overlap// Only one method got invokedString CACHE_NAME_NO_NULL, ...;/** General cache-related test utilities. ... *//** Create a {@link SimpleCacheManager} with the specified cache(s). ... */SimpleCacheManager resultList<Cache> caches/** Assert the following key is not held within the specified cache(s). *//** Assert the following key has a matching value within the specified cache(s). *//** A custom {@link KeyGenerator} that exposes the algorithm used to compute the key ... */import SimpleKeyGeneratorAtomicLong nullInvocations, ...;// multi annotations/** Basic service interface for caching tests. ... *//** Simple cacheable service. ... */this.nullInvocations/** Simple test entity for use with caching tests. ... */(...).id/** A test {@link ClassLoader} that can be used in a testing context to control the ... *//** Create a test {@link ClassLoader} that disable the use of the index, even ... */enumeration(...)/** Create a test {@link ClassLoader} that creates an index with the ... */new Function<Resource,URL>(...) { ... }Enumeration<URL> resourceUrls, ...;IOException cause, ...;this.resourceUrlsthis.causeCandidateComponentsIndexLoader.COMPONENTS_RESOURCE_LOCATION/** Copy of the standard {@link org.springframework.context.testfixture.jndi.jndi.ExpectedLookupTemplate} ... */Map<String,Object> jndiObjects, ...;/** Construct a new JndiTemplate that will always return given objects for ... *//** Construct a new JndiTemplate that will always return the given object, ... *//** Add the given object to the list of JNDI objects that this template will expose. ... */this.jndiObjects/** If the name is the expected name specified in the constructor, return the ... */import Nameimport NameClassPairimport NameParserimport NamingEnumerationimport OperationNotSupportedException/** Copy of the standard {@link org.springframework.mock.jndi.SimpleNamingContext} ... */new Hashtable<String,Object>(...)String root, ...;Hashtable<String,Object> boundObjects, ...;Hashtable<String,Object> environment, ...;/** Create a new naming context. *//** Create a new naming context with the given naming root. */this.rootthis.boundObjects/** Create a new naming context with the given naming root, ... */// Actual implementations of Context methods follownew NameClassPairEnumeration(...)new BindingEnumeration(...)/** Look up the object with the given name. ... */Object foundString boundName/** Bind the given object to the given name. ... */String subcontextNameContext subcontext// Unsupported methods follow: no support for javax.naming.Namenew OperationNotSupportedException(...)Iterator<T> iterator, ...;String rootcontext.rootMap<String,T> contentsnew HashMap<String,T>(...)context.boundObjectsthis.iteratornew NameClassPair(...)// cannot happenimport InitialContextFactoryimport InitialContextFactoryBuilder/** Copy of the standard {@link org.springframework.mock.jndi.SimpleNamingContextBuilder} ... */SimpleNamingContextBuilder activated, ...;/** An instance of this class bound to JNDI. */Object initializationLock, ...;/** Checks if a SimpleNamingContextBuilder is active. ... *//** If no SimpleNamingContextBuilder is already configuring JNDI, ... */SimpleNamingContextBuilder buildernew SimpleNamingContextBuilder(...)/** Register the context builder by registering it with the JNDI NamingManager. ... */hasInitialContextFactoryBuilder(...)setInitialContextFactoryBuilder(...)/** Temporarily deactivate this context builder. It will remain registered with ... *//** Clear all bindings in this context builder, while keeping it active. *//** Bind the given object under the given name, for all naming contexts ... *//** Simple InitialContextFactoryBuilder implementation, ... */Object icfContext.INITIAL_CONTEXT_FACTORYClass<?> icfClassInitialContextFactory.classnew InitialContextFactory(...) { ... }// Clear already activated context builder.// Create and activate new context builder.// The activate() call will cause an assignment to the activated variable.// Default case...import Completionimport ProcessingEnvironmentimport Processorimport RoundEnvironmentimport SourceVersionimport AnnotationMirrorimport ExecutableElementimport TypeElement/** Annotation {@link Processor} that writes {@link CandidateComponentsMetadata} ... */ElementKind.CLASSElementKind.INTERFACESet<ElementKind> TYPE_KINDS, ...;MetadataStore metadataStore, ...;MetadataCollector metadataCollector, ...;TypeHelper typeHelper, ...;List<StereotypesProvider> stereotypesProviders, ...;latest(...)this.stereotypesProvidersgetStereotypesProviders(...)this.typeHelpernew TypeHelper(...)this.metadataStorenew MetadataStore(...)this.metadataCollectornew MetadataCollector(...)readMetadata(...)processing(...)getRootElements(...)new Consumer<? extends Element>(...) { ... }processElement(...)processingOver(...)writeMetaData(...)List<StereotypesProvider> resultnew ArrayList<StereotypesProvider>(...)TypeHelper typeHelpernew IndexedStereotypesProvider(...)new StandardStereotypesProvider(...)new PackageInfoStereotypesProvider(...)addMetadataFor(...)staticTypesIn(...)getEnclosedElements(...)new Consumer<TypeElement>(...) { ... }Set<String> stereotypesnew Consumer<StereotypesProvider>(...) { ... }getStereotypes(...)new ItemMetadata(...)CandidateComponentsMetadata metadatagetItems(...)writeMetadata(...)List<TypeElement> listnew ArrayList<TypeElement>(...)Modifier.STATIC/** Meta-data for candidate components. ... */List<ItemMetadata> items, ...;new ArrayList<ItemMetadata>(...)/** A {@link StereotypesProvider} implementation that extracts the stereotypes ... */String INDEXED_ANNOTATION, ...;ElementKind kindSet<Element> seennew HashSet<Element>(...)collectStereotypesOnAnnotations(...)collectStereotypesOnTypes(...)AnnotationMirror annotationgetAllAnnotationMirrors(...)Element nextcollectStereotypes(...)Element superClassisAnnotatedWithIndexed(...)getDirectInterfaces(...)new Consumer<Element>(...) { ... }isIndexedAnnotation(...)getCandidateAnnotationElement(...)asElement(...)getAnnotationMirrors(...)// We need to visit all indexed annotations./** Represents one entry in the index. The type defines the identify of the target ... */Set<String> stereotypes, ...;this.stereotypes/** Used by {@link CandidateComponentsIndexer} to collect {@link CandidateComponentsMetadata}. ... */List<ItemMetadata> metadataItems, ...;ProcessingEnvironment processingEnvironment, ...;CandidateComponentsMetadata previousMetadata, ...;Set<String> processedSourceTypes, ...;/** Create a new {@code MetadataProcessor} instance. ... */this.processingEnvironmentthis.previousMetadatamarkAsProcessed(...)this.processedSourceTypesthis.metadataItemsnew CandidateComponentsMetadata(...)ItemMetadata itemList<ItemMetadata> itemsshouldBeMerged(...)String sourceTypedeletedInCurrentBuild(...)processedInCurrentBuild(...)getTypeElement(...)getElementUtils(...)import FileObjectimport StandardLocation/** Store {@link CandidateComponentsMetadata} on the filesystem. ... */String METADATA_PATH, ...;ProcessingEnvironment environment, ...;openInputStream(...)getMetadataResource(...)OutputStream outputStreamopenOutputStream(...)createMetadataResource(...)write(...)read(...)getFiler(...)StandardLocation.CLASS_OUTPUTcreateResource(...)// Failed to read metadata -> ignore./** A {@link StereotypesProvider} implementation that provides the ... */String STEREOTYPE, ...;ElementKind.PACKAGE/** Marshaller to write {@link CandidateComponentsMetadata} as properties. ... */new SortedProperties(...)new Consumer<ItemMetadata>(...) { ... }CandidateComponentsMetadata resultSet<String> candidatesimport Writerimport Entry/** Specialization of {@link Properties} that sorts properties alphanumerically ... */lineSeparator(...)new Function<Object,String>(...) { ... }comparingByKey(...)String EOL, ...;Comparator<Object> keyComparator, ...;Comparator<Entry<Object,Object>> entryComparator, ...;boolean omitComments, ...;/** Construct a new {@code SortedProperties} instance that honors the supplied ... */this.omitComments/** Construct a new {@code SortedProperties} instance with properties populated ... */String contentsString lineStringWriter stringWriterstoreToXML(...)/** Return a sorted enumeration of the keys in this {@link Properties} object. ... *//** Return a sorted set of the keys in this {@link Properties} object. ... */Set<Object> sortedKeys/** Return a sorted set of the entries in this {@link Properties} object. ... */Set<Entry<Object,Object>> sortedEntriesnew TreeSet<Entry<Object,Object>>(...)/** A {@link StereotypesProvider} that extract a stereotype for each ... *//** Provide the list of stereotypes that match an {@link Element}. ... *//** Return the stereotypes that are present on the given {@link Element}. ... */import QualifiedNameableimport DeclaredTypeimport TypeMirrorimport Types/** Type utilities. ... */ProcessingEnvironment env, ...;Types types, ...;this.envthis.typesgetTypeUtils(...)asType(...)DeclaredType declaredTypeElement enclosingElementgetEnclosingElement(...)/** Return the super class of the specified{@link Element} or null if this ... */List<? extends TypeMirror> superTypesdirectSupertypes(...)/** Return the interfaces that are <strong>directly</strong> implemented by the ... */List<Element> directInterfacesnew ArrayList<Element>(...)Element e// reached java.lang.Object// index 0 is the super class// This may fail if one of the annotations is not available.import FileInputStreamimport ManagedBeanimport Embeddableimport Entityimport MappedSuperclassimport TempDirimport AbstractControllerimport MetaControllerIndexedimport SampleComponentimport SampleControllerimport SampleEmbeddedimport SampleMetaControllerimport SampleMetaIndexedControllerimport SampleNonStaticEmbeddedimport SampleNoneimport SampleRepositoryimport SampleServiceimport SampleManagedBeanimport SampleNamedimport SampleTransactionalimport SampleConverterimport SampleEmbeddableimport SampleEntityimport SampleMappedSuperClassimport Repoimport SampleRepoimport SampleSmartRepoimport SampleSpecializedRepoimport SmartRepoimport SpecializedRepoimport TestCompiler/** Tests for {@link CandidateComponentsIndexer}. ... */TestCompiler compiler, ...;this.compilernew TestCompiler(...)SampleNone.classCandidateComponentsIndexerTests.classtestComponent(...)SampleComponent.classSampleController.classSampleMetaController.classtestSingleComponent(...)SampleRepository.classSampleMetaIndexedController.classMetaControllerIndexed.classAbstractController.classSampleManagedBean.classManagedBean.classSampleNamed.classSampleTransactional.classTransactional.classSampleEntity.classEntity.classSampleMappedSuperClass.classMappedSuperclass.classSampleEmbeddable.classEmbeddable.classSampleConverter.classConverter.classSampleSpecializedRepo.classRepo<>.classSampleRepo.classSampleSmartRepo.classSmartRepo<>.classSpecializedRepo<>.classString nestedTypeSampleEmbedded.classSampleEmbedded.Another.AnotherPublicCandidate.classSampleEmbedded.Another.AnotherPublicCandidateSampleEmbedded.AnotherSampleEmbedded.PublicCandidate.classSampleEmbedded.PublicCandidateSampleNonStaticEmbedded.classClass<?> cCandidateComponentsIndexer processornew CandidateComponentsIndexer(...)getTask(...)readGeneratedMetadata(...)getOutputLocation(...)File metadataFileMetadataStore.METADATA_PATHisFile(...)FileInputStream fileInputStreamnew FileInputStream(...)// Validate nested type structure/** AssertJ {@link Condition} to help test {@link CandidateComponentsMetadata}. ... */new Condition<CandidateComponentsMetadata>(...)new Predicate<CandidateComponentsMetadata>(...) { ... }ItemMetadata itemMetadatafindFirst(...)new Predicate<ItemMetadata>(...) { ... }/** Tests for {@link PropertiesMarshaller}. ... */ByteArrayOutputStream outputStreamCandidateComponentsMetadata readMetadatacreateItem(...)/** Abstract {@link Component} that shouldn't be registered. ... *//** Sample meta-annotation. ... *//** A test annotation that triggers a dedicated entry in the index. ... *//** Test candidate for {@link Component}. ... *//** Test candidate for {@link Controller}. ... *//** Test candidate for an embedded {@link Component}. ... *//** Test candidate for a {@code Controller} defined using a meta-annotation. ... *//** Test candidate for a {@code Controller} that adds both the ... *//** Candidate with a inner class that isn't static (and should therefore not be added). ... *//** Candidate with no matching annotation. ... *//** Test candidate for {@link Repository}. ... *//** Test candidate for {@link Service}. ... *//** Copy of the {@code @Scope} annotation for testing purposes. *//** Test candidate for a CDI {@link ManagedBean}. ... *//** Test candidate for a CDI {@link Named} bean. ... *//** Test candidate for {@link Transactional}. This verifies that the annotation processor ... *//** Test candidate for {@link Converter}. ... *//** Test candidate for {@link Embeddable}. ... *//** Test candidate for {@link Entity}. ... *//** Test candidate for {@link MappedSuperclass}. ... *//** A sample interface flagged with {@link Indexed} to indicate that a stereotype ... *//** A sample that gets its stereotype via an abstract class. ... *//** A sample that implements both interface used to demonstrate that no ... *//** A sample that does not directly implement the {@link Repo} interface. ... *//** A {@link Repo} that requires an extra stereotype. ... */import JavaCompilerimport JavaFileObjectimport StandardJavaFileManagerimport ToolProvider/** Wrapper to make the {@link JavaCompiler} easier to use in tests. ... */File ORIGINAL_SOURCE_FOLDER, ...;JavaCompiler compiler, ...;StandardJavaFileManager fileManager, ...;File outputLocation, ...;getSystemJavaCompiler(...)Iterable<? extends File> tempthis.outputLocationthis.fileManagergetStandardFileManager(...)StandardLocation.SOURCE_OUTPUTnew IntFunction<String[]>(...) { ... }Iterable<? extends JavaFileObject> javaFileObjectsgetJavaFileObjects(...)new TestCompilationTask(...)File[] filesnew File[]getSourceFolder(...)sourcePathFor(...)/** A compilation task. */JavaCompiler.CompilationTask task, ...;JavaCompiler.CompilationTasksetProcessors(...)import LoadingCache/** Spring {@link org.springframework.cache.Cache} adapter implementation ... */Cache<Object,Object> cache, ...;/** Create a {@link CaffeineCache} instance with the specified name and the ... */new LoadFunction(...)getIfPresent(...)PutIfAbsentFunction callablenew PutIfAbsentFunction(...)callable.calledinvalidateAll(...)this.calledCallable<?> valueLoader, ...;this.valueLoaderimport CacheLoaderimport Caffeineimport CaffeineSpec/** {@link CacheManager} implementation that lazily builds {@link CaffeineCache} ... */newBuilder(...)new CopyOnWriteArrayList<String>(...)Caffeine<Object,Object> cacheBuilder, ...;CacheLoader<Object,Object> cacheLoader, ...;Map<String,Cache> cacheMap, ...;Collection<String> customCacheNames, ...;/** Construct a dynamic CaffeineCacheManager, ... *//** Construct a static CaffeineCacheManager, ... */createCaffeineCache(...)/** Set the Caffeine to use for building each individual ... */doSetCaffeine(...)/** Set the {@link CaffeineSpec} to use for building each individual ... *//** Set the Caffeine cache specification String to use for building each ... */this.cacheBuilderrefreshCommonCaches(...)/** Set the Caffeine CacheLoader to use for building each individual ... */this.cacheLoader/** Register the given native Caffeine Cache instance with this cache manager, ... */this.customCacheNamesadaptCaffeineCache(...)/** Adapt the given new native Caffeine Cache instance to Spring's {@link Cache} ... */new CaffeineCache(...)/** Build a common {@link CaffeineCache} instance for the specified cache name, ... */createNativeCaffeineCache(...)/** Build a common Caffeine Cache instance for the specified cache name, ... *//** Recreate the common caches with the current state of this manager. *//** Support classes for the open source cache in ... */import Ehcacheimport Status/** {@link Cache} implementation on top of an {@link Ehcache} instance. ... */Ehcache cache, ...;/** Create an {@link EhCacheCache} instance. ... */Status statusgetStatus(...)Status.STATUS_ALIVEgetObjectValue(...)acquireWriteLockOnKey(...)loadValue(...)releaseWriteLockOnKey(...)T valuenew Element(...)Element existingElementgetSize(...)// one more attempt with the write lockimport AbstractTransactionSupportingCacheManager/** CacheManager backed by an EhCache {@link net.sf.ehcache.CacheManager}. ... *//** Create a new EhCacheCacheManager, setting the target EhCache CacheManager ... *//** Create a new EhCacheCacheManager for the given backing EhCache CacheManager. ... *//** Set the backing EhCache {@link net.sf.ehcache.CacheManager}. *//** Return the backing EhCache {@link net.sf.ehcache.CacheManager}. */buildCacheManager(...)Collection<Cache> cachesnew LinkedHashSet<Cache>(...)new EhCacheCache(...)getEhcache(...)Ehcache ehcache// Check the EhCache cache again (in case the cache was added at runtime)import CacheExceptionimport BootstrapCacheLoaderimport CacheConfigurationimport BlockingCacheimport CacheEntryFactoryimport SelfPopulatingCacheimport UpdatingCacheEntryFactoryimport UpdatingSelfPopulatingCacheimport CacheEventListener/** {@link FactoryBean} that creates a named EhCache {@link net.sf.ehcache.Cache} instance ... */boolean blocking, ...;CacheEntryFactory cacheEntryFactory, ...;BootstrapCacheLoader bootstrapCacheLoader, ...;Set<CacheEventListener> cacheEventListeners, ...;boolean disabled, ...;setMaxEntriesLocalHeap(...)setMaxEntriesLocalDisk(...)setTimeToLiveSeconds(...)setTimeToIdleSeconds(...)/** Set a CacheManager from which to retrieve a named Cache instance. ... *//** Set a name for which to retrieve or create a cache instance. ... *//** Set the time to live. ... *//** Set the time to idle. ... *//** Set the disk spool buffer size (in MB). ... */setDiskSpoolBufferSizeMB(...)/** Set whether to use a blocking cache that lets read attempts block ... */this.blocking/** Set an EhCache {@link net.sf.ehcache.constructs.blocking.CacheEntryFactory} ... */this.cacheEntryFactory/** Set an EhCache {@link net.sf.ehcache.bootstrap.BootstrapCacheLoader} ... */this.bootstrapCacheLoader/** Specify EhCache {@link net.sf.ehcache.event.CacheEventListener cache event listeners} ... */this.cacheEventListeners/** Set whether this cache should be marked as disabled. ... */this.disabledEhcache rawCacheboolean cacheExistscacheExists(...)Ehcache decoratedCachecreateCache(...)setBootstrapCacheLoader(...)CacheEventListener listenerregisterListener(...)getCacheEventNotificationService(...)addCache(...)setDisabled(...)replaceCacheWithDecoratedCache(...)/** Create a raw Cache object based on the configuration of this FactoryBean. */new Cache(...)/** Decorate the given Cache, if necessary. ... */new UpdatingSelfPopulatingCache(...)new SelfPopulatingCache(...)new BlockingCache(...)/** Predict the particular {@code Ehcache} implementation that will be returned from ... */UpdatingSelfPopulatingCache.classSelfPopulatingCache.classBlockingCache.class// If no cache name given, use bean name as cache name.// If no CacheManager given, fetch the default.// Fetch cache region: If none with the given name exists, create one on the fly.// Needs to happen after listener registration but before setStatisticsEnabledimport ConfigurationFactory/** {@link FactoryBean} that exposes an EhCache {@link net.sf.ehcache.CacheManager} ... */Resource configLocation, ...;String cacheManagerName, ...;boolean acceptExisting, ...;boolean shared, ...;boolean locallyManaged, ...;/** Set the location of the EhCache config file. A typical value is "/WEB-INF/ehcache.xml". ... */this.configLocation/** Set the name of the EhCache CacheManager (if a specific name is desired). ... */this.cacheManagerName/** Set whether an existing EhCache CacheManager of the same name will be accepted ... */this.acceptExisting/** Set whether the EhCache CacheManager should be shared (as a singleton at the ... */this.sharedConfiguration configurationparseConfiguration(...)new CacheManager(...)this.locallyManaged// Old-school EhCache singleton sharing...// No way to find out whether we actually created a new CacheManager// or just received an existing singleton reference.// EhCache 2.5+: Reusing an existing CacheManager of the same name.// Basically the same code as in CacheManager.getInstance(String),// just storing whether we're dealing with an existing instance.// Throwing an exception if a CacheManager of the same name exists already.../** Convenient builder methods for EhCache 2.5+ {@link CacheManager} setup, ... *//** Build an EhCache {@link CacheManager} from the default configuration. ... *//** Build an EhCache {@link CacheManager} from the given configuration resource. ... *//** Parse EhCache configuration from the given resource, for further use with ... */new CacheException(...)/** Support classes for the open source cache ... */import EntryProcessorimport EntryProcessorExceptionimport MutableEntry/** {@link org.springframework.cache.Cache} implementation on top of a ... *//** Create a {@code JCacheCache} instance. ... */new ValueLoaderEntryProcessor<T>(...)EntryProcessorException exboolean setCallable<T> valueLoadernew EntryProcessorException(...)/** {@link org.springframework.cache.CacheManager} implementation ... *//** Create a new {@code JCacheCacheManager} without a backing JCache ... *//** Create a new {@code JCacheCacheManager} for the given backing JCache ... *//** Set the backing JCache {@link CacheManager javax.cache.CacheManager}. *//** Return the backing JCache {@link CacheManager javax.cache.CacheManager}. */getCachingProvider(...)Cache<Object,Object> jcachenew JCacheCache(...)// Check the JCache cache again (in case the cache was added at runtime)/** {@link FactoryBean} for a JCache {@link CacheManager javax.cache.CacheManager}, ... */URI cacheManagerUri, ...;Properties cacheManagerProperties, ...;/** Specify the URI for the desired {@code CacheManager}. ... */this.cacheManagerUri/** Specify properties for the to-be-created {@code CacheManager}. ... */this.cacheManagerPropertiesimport AbstractCachingConfigurationimport CachingConfigurerimport DefaultJCacheOperationSourceimport JCacheOperationSource/** Abstract JSR-107 specific {@code @Configuration} class providing common ... */Supplier<CacheResolver> exceptionCacheResolver, ...;this.exceptionCacheResolverexceptionCacheResolver(...)new DefaultJCacheOperationSource(...)/** Extension of {@link CachingConfigurer} for the JSR-107 implementation. ... *//** Return the {@link CacheResolver} bean to use to resolve exception caches for ... *//** An extension of {@link CachingConfigurerSupport} that also implements ... */import BeanFactoryJCacheOperationSourceAdvisorimport JCacheInterceptorBeanFactoryJCacheOperationSourceAdvisor advisornew BeanFactoryJCacheOperationSourceAdvisor(...)JCacheInterceptor interceptornew JCacheInterceptor(...)/** Support package for declarative JSR-107 caching configuration. Used ... */import AbstractCacheInvoker/** A base interceptor for JSR-107 cache annotations. ... *//** Resolve the cache to use. ... */extractFrom(...)/** Convert the collection of caches in a single expected element. ... *//** Abstract implementation of {@link JCacheOperationSource} that caches attributes ... */new ConcurrentHashMap<MethodClassKey,Object>(...)Object NULL_CACHING_ATTRIBUTE, ...;Map<MethodClassKey,Object> cache, ...;MethodClassKey cacheKeyObject cachedJCacheOperation<?> operationcomputeCacheOperation(...)findCacheOperation(...)/** Subclasses need to implement this to return the caching operation ... */import CacheInvocationParameterimport CacheMethodDetails/** A base {@link JCacheOperation} that operates with a key. ... */List<CacheParameterDetail> keyParameterDetails, ...;/** Create a new instance. ... */this.keyParameterDetailsinitializeKeyParameterDetails(...)this.allParameterDetails/** Return the {@link KeyGenerator} to use to compute cache keys. *//** Return the {@link CacheInvocationParameter} for the parameters that are to be ... */List<CacheInvocationParameter> resultnew ArrayList<CacheInvocationParameter>(...)CacheParameterDetail keyParameterDetailint parameterPositiongetParameterPosition(...)toCacheInvocationParameter(...)new CacheInvocationParameter[]List<CacheParameterDetail> allnew ArrayList<CacheParameterDetail>(...)List<CacheParameterDetail> annotatedCacheParameterDetail allParameterisValue(...)isKey(...)import CacheKeyimport CacheValueimport ExceptionTypeFilter/** A base {@link JCacheOperation} implementation. ... */CacheMethodDetails<A> methodDetails, ...;List<CacheParameterDetail> allParameterDetails, ...;/** Construct a new {@code AbstractJCacheOperation}. ... */this.methodDetailsinitializeAllParameterDetails(...)List<CacheParameterDetail> resultCacheParameterDetail detailnew CacheParameterDetail(...)getCacheAnnotation(...)getCacheName(...)/** Return the {@link ExceptionTypeFilter} to use to filter exceptions thrown while ... *//** Convenience method for subclasses to create a specific {@code ExceptionTypeFilter}. ... */new ExceptionTypeFilter(...)/** Details for a single cache parameter. */Class<?> rawType, ...;Set<Annotation> annotations, ...;int parameterPosition, ...;boolean isKey, ...;boolean isValue, ...;boolean foundKeyAnnotationboolean foundValueAnnotationthis.rawTypethis.annotationsnew LinkedHashSet<Annotation>(...)CacheKey.classCacheValue.classthis.parameterPositionthis.isKeythis.isValuenew CacheInvocationParameterImpl(...)/** A single cache invocation parameter. */CacheParameterDetail detail, ...;this.detailthis.detail.rawTypethis.detail.annotationsthis.detail.parameterPositionimport CacheKeyInvocationContext/** A base interceptor for JSR-107 key-based cache annotations. ... *//** Generate a key for the specified invocation. ... */KeyGenerator keyGenerator/** Create a {@link CacheKeyInvocationContext} based on the specified invocation. ... */new DefaultCacheKeyInvocationContext<A>(...)import CacheDefaultsimport CacheKeyGeneratorimport CacheRemoveimport CacheRemoveAllimport CacheResolverFactoryimport CacheResult/** Implementation of the {@link JCacheOperationSource} interface that reads ... */CacheResult cacheResultCacheResult.classCacheRemove cacheRemoveCacheRemove.classCacheRemoveAll cacheRemoveAllCacheRemoveAll.classint foundcountNonNull(...)CacheDefaults defaultsgetCacheDefaults(...)createCacheResultOperation(...)createCachePutOperation(...)createCacheRemoveOperation(...)createCacheRemoveAllOperation(...)CacheDefaults annotationCacheDefaults.classdetermineCacheName(...)cacheName(...)CacheResolverFactory cacheResolverFactorydetermineCacheResolverFactory(...)cacheResolverFactory(...)determineKeyGenerator(...)cacheKeyGenerator(...)CacheMethodDetails<CacheResult> methodDetailscreateMethodDetails(...)CacheResolver cacheResolverCacheResolver exceptionCacheResolverString exceptionCacheNameexceptionCacheName(...)getExceptionCacheResolver(...)new CacheResultOperation(...)CacheMethodDetails<CachePut> methodDetailsCacheMethodDetails<CacheRemove> methodDetailsnew CacheRemoveOperation(...)CacheMethodDetails<CacheRemoveAll> methodDetailsnew CacheRemoveAllOperation(...)new DefaultCacheMethodDetails<A>(...)new CacheResolverAdapter(...)getDefaultCacheResolver(...)getDefaultExceptionCacheResolver(...)CacheResolverFactory.classCacheKeyGenerator.classnew KeyGeneratorAdapter(...)getDefaultKeyGenerator(...)generateDefaultCacheName(...)/** Generate a default cache name for the specified {@link Method}. ... */List<String> parameters/** Locate or create an instance of the specified cache strategy {@code type}. ... *//** Return the default {@link CacheResolver} if none is set. *//** Return the default exception {@link CacheResolver} if none is set. *//** Return the default {@link KeyGenerator} if none is set. *//** Advisor driven by a {@link JCacheOperationSource}, used to include a ... */new JCacheOperationSourcePointcut(...) { ... }JCacheOperationSource cacheOperationSource, ...;JCacheOperationSourcePointcut pointcut, ...;/** Set the {@link org.springframework.aop.ClassFilter} to use for this pointcut. ... *//** Intercept methods annotated with {@link CachePut}. ... */CachePutOperation operationCacheKeyInvocationContext<CachePut> invocationContextcreateCacheKeyInvocationContext(...)boolean earlyPutisEarlyPut(...)getValueParameter(...)cacheValue(...)ThrowableWrapper exgetExceptionTypeFilter(...)resolveCache(...)/** The {@link JCacheOperation} implementation for a {@link CachePut} operation. ... */ExceptionTypeFilter exceptionTypeFilter, ...;CacheParameterDetail valueParameterDetail, ...;CachePut annCacheParameterDetail valueParameterDetailinitializeValueParameterDetail(...)this.exceptionTypeFiltercreateExceptionTypeFilter(...)cacheFor(...)noCacheFor(...)this.valueParameterDetail/** Specify if the cache should be updated before invoking the method. By default, ... */afterInvocation(...)/** Return the {@link CacheInvocationParameter} for the parameter holding the value ... */CacheParameterDetail resultCacheParameterDetail parameter/** Intercept methods annotated with {@link CacheRemoveAll}. ... */CacheRemoveAllOperation operationboolean earlyRemoveisEarlyRemove(...)/** The {@link JCacheOperation} implementation for a {@link CacheRemoveAll} operation. ... */CacheRemoveAll annevictFor(...)noEvictFor(...)/** Specify if the cache should be cleared before invoking the method. By default, the ... *//** Intercept methods annotated with {@link CacheRemove}. ... */CacheRemoveOperation operationremoveValue(...)ThrowableWrapper wrapperException/** The {@link JCacheOperation} implementation for a {@link CacheRemove} operation. ... */CacheRemove ann/** Specify if the cache entry should be removed before invoking the method. ... */import CacheInvocationContextimport JCacheCache/** Spring's {@link CacheResolver} implementation that delegates to a standard ... */CacheResolver target, ...;/** Create a new instance with the JSR-107 cache resolver to invoke. *//** Return the underlying {@link javax.cache.annotation.CacheResolver} ... */CacheInvocationContext<?> cacheInvocationContextCache<Object,Object> cacheimport SerializationUtils/** Intercept methods annotated with {@link CacheResult}. ... */CacheResultOperation operationCache exceptionCacheresolveExceptionCache(...)isAlwaysInvoked(...)ValueWrapper cachedValuecheckForCachedException(...)Object invocationResultcacheException(...)/** Check for a cached exception. If the exception is found, throw it directly. */ValueWrapper resultrewriteCallStack(...)/** Rewrite the call stack of the specified {@code exception} so that it matches ... */Throwable clonecloneException(...)StackTraceElement[] callStackStackTraceElement[] cachedCallStackfindCommonAncestorIndex(...)int cachedIndexStackTraceElement[] resultcallStack.lengthdeserialize(...)serialize(...)// Cannot find common ancestor// exception parameter cannot be cloned/** The {@link JCacheOperation} implementation for a {@link CacheResult} operation. ... */CacheResolver exceptionCacheResolver, ...;String exceptionCacheName, ...;CacheResult anncachedExceptions(...)nonCachedExceptions(...)this.exceptionCacheName/** Specify if the method should always be invoked regardless of a cache hit. ... */skipGet(...)/** Return the {@link CacheResolver} instance to use to resolve the cache to ... *//** Return the name of the cache to cache exceptions, or {@code null} if ... *//** The default {@link CacheOperationInvocationContext} implementation used ... */JCacheOperation<A> operation, ...;...[] allParameters, ...;this.allParametersgetAllParameters(...)/** The default {@link CacheKeyInvocationContext} implementation. ... */...[] keyParameters, ...;CacheInvocationParameter valueParameter, ...;this.keyParametersgetKeyParameters(...)this.valueParameter/** The default {@link CacheMethodDetails} implementation. ... */A cacheAnnotation, ...;String cacheName, ...;this.cacheAnnotationthis.cacheName/** The default {@link JCacheOperationSource} implementation delegating ... */SingletonSupplier<CacheManager> cacheManager, ...;SingletonSupplier<CacheResolver> exceptionCacheResolver, ...;SingletonSupplier<KeyGenerator> adaptedKeyGenerator, ...;/** Construct a new {@code DefaultJCacheOperationSource} with the default key generator. ... *//** Construct a new {@code DefaultJCacheOperationSource} with the given cache manager, ... *//** Set the default {@link CacheManager} to use to lookup cache by name. ... *//** Return the specified cache manager to use, if any. *//** Set the {@link CacheResolver} to resolve regular caches. If none is set, a default ... *//** Return the specified cache resolver to use, if any. *//** Set the {@link CacheResolver} to resolve exception caches. If none is set, a default ... *//** Return the specified exception cache resolver to use, if any. *//** Set the default {@link KeyGenerator}. If none is set, a {@link SimpleKeyGenerator} ... *//** Return the specified key generator to use. */getDefaultCacheManager(...)new LazyCacheResolver(...)this.adaptedKeyGenerator/** Only resolve the default exception cache resolver when an exception needs to be handled. ... */new SimpleExceptionCacheResolver(...)// Make sure that the cache resolver is initialized. An exception cache resolver is only// required if the exceptionCacheName attribute is set on an operation.import BasicOperation/** Base class for JSR-107 caching aspects, such as the {@link JCacheInterceptor} ... */CacheResultInterceptor cacheResultInterceptor, ...;CachePutInterceptor cachePutInterceptor, ...;CacheRemoveEntryInterceptor cacheRemoveEntryInterceptor, ...;CacheRemoveAllInterceptor cacheRemoveAllInterceptor, ...;/** Set the CacheOperationSource for this cache aspect. */this.cacheResultInterceptornew CacheResultInterceptor(...)this.cachePutInterceptornew CachePutInterceptor(...)this.cacheRemoveEntryInterceptornew CacheRemoveEntryInterceptor(...)this.cacheRemoveAllInterceptornew CacheRemoveAllInterceptor(...)getCacheOperation(...)CacheOperationInvocationContext<?> contextcreateCacheOperationInvocationContext(...)new DefaultCacheInvocationContext<Annotation>(...)CacheOperationInvoker adapternew CacheOperationInvokerAdapter(...)BasicOperation operationCacheOperationInvoker delegate, ...;// Check whether aspect is enabled to cope with cases where the AJ is pulled in automatically/** Construct a new {@code JCacheInterceptor} with the default error handler. *//** Construct a new {@code JCacheInterceptor} with the given error handler. ... *//** Model the base of JSR-107 cache operation through an interface contract. ... *//** Return the {@link CacheResolver} instance to use to resolve the cache ... *//** Return the {@link CacheInvocationParameter} instances based on the ... *//** Interface used by {@link JCacheInterceptor}. Implementations know how to source ... *//** Return the cache operations for this method, or {@code null} ... *//** A Pointcut that matches if the underlying {@link JCacheOperationSource} ... */JCacheOperationSource cas/** Obtain the underlying {@link JCacheOperationSource} (may be {@code null}). ... */JCacheOperationSourcePointcut otherPcJCacheOperationSourcePointcut.class/** Spring's {@link KeyGenerator} implementation that either delegates to a standard JSR-107 ... */CacheKeyGenerator cacheKeyGenerator, ...;/** Create an instance with the given {@link KeyGenerator} so that {@link javax.cache.annotation.CacheKey} ... *//** Create an instance used to wrap the specified {@link javax.cache.annotation.CacheKeyGenerator}. */this.cacheKeyGenerator/** Return the target key generator to use in the form of either a {@link KeyGenerator} ... */CacheKeyInvocationContext<?> invocationContextgenerateCacheKey(...)doGenerate(...)List<Object> parametersCacheInvocationParameter paramgetAllParameters(...).lengtharrayToList(...)AbstractJCacheKeyOperation<Annotation> keyCacheOperationnew DefaultCacheKeyInvocationContext<Annotation>(...)/** A simple {@link CacheResolver} that resolves the exception cache ... */CacheResultOperation cacheResultOperationgetExceptionCacheName(...)/** AOP-based solution for declarative caching demarcation using JSR-107 annotations. ... *//** Implementation package for JSR-107 (javax.cache aka "JCache") based caches. ... */import AbstractCacheManager/** Base class for CacheManager implementations that want to support built-in ... */boolean transactionAware, ...;/** Set whether this CacheManager should expose transaction-aware Cache objects. ... */this.transactionAware/** Return whether this CacheManager has been configured to be transaction-aware. */isTransactionAware(...)new TransactionAwareCacheDecorator(...)import TransactionSynchronizationimport TransactionSynchronizationManager/** Cache decorator which synchronizes its {@link #put}, {@link #evict} and ... */Cache targetCache, ...;/** Create a new TransactionAwareCache for the given target Cache. ... */this.targetCache/** Return the target Cache that this Cache should delegate to. */isSynchronizationActive(...)registerSynchronization(...)new TransactionSynchronization(...) { ... }TransactionAwareCacheDecorator.this.targetCacheTransactionAwareCacheDecorator.this/** Proxy for a target {@link CacheManager}, exposing transaction-aware {@link Cache} objects ... */CacheManager targetCacheManager, ...;/** Create a new TransactionAwareCacheManagerProxy, setting the target CacheManager ... *//** Create a new TransactionAwareCacheManagerProxy for the given target CacheManager. ... */this.targetCacheManager/** Set the target CacheManager to proxy. */Cache targetCache/** Transaction-aware decorators for the org.springframework.cache package. ... *//** Exception thrown on failed authentication. ... *//** Constructor for MailAuthenticationException. ... *//** Base class for all mail exceptions. ... *//** Constructor for MailException. ... *//** This is a common interface for mail messages, allowing a user to set key ... *//** Exception thrown if illegal message properties are encountered. ... *//** Constructor for MailParseException. ... *//** Exception to be thrown by user code if a mail cannot be prepared properly, ... *//** Constructor for MailPreparationException. ... *//** Exception thrown when a mail sending error is encountered. ... */Map<Object,Exception> failedMessages, ...;...[] messageExceptions, ...;/** Constructor for MailSendException. ... */this.failedMessagesnew LinkedHashMap<Object,Exception>(...)this.messageExceptions/** Constructor for registration of failed messages, with the ... */new Exception[]/** Return a Map with the failed messages as keys, and the thrown exceptions ... *//** Return an array with thrown message exceptions. ... */String baseMessagethis.messageExceptions.lengthException subEx/** This interface defines a strategy for sending simple mails. Can be ... *//** Send the given simple mail message. ... *//** Send the given array of simple mail messages in batch. ... *//** Models a simple mail message, including data such as the from, to, cc, subject, ... */String from, ...;String replyTo, ...;...[] to, ...;...[] cc, ...;...[] bcc, ...;Date sentDate, ...;String subject, ...;/** Create a new {@code SimpleMailMessage}. *//** Copy constructor for creating a new {@code SimpleMailMessage} from the state ... */this.fromgetFrom(...)this.replyTogetReplyTo(...)this.tocopyOrNull(...)getTo(...)this.ccgetCc(...)this.bccgetBcc(...)this.sentDategetSentDate(...)this.subjectgetText(...)/** Copy the contents of this message to the given target message. ... */setFrom(...)setReplyTo(...)setTo(...)setCc(...)setBcc(...)setSentDate(...)setSubject(...)setText(...)SimpleMailMessage otherMessageotherMessage.fromotherMessage.replyTootherMessage.tootherMessage.ccotherMessage.bccotherMessage.sentDateotherMessage.subjectotherMessage.textimport FileTypeMapimport MimetypesFileTypeMap/** Spring-configurable {@code FileTypeMap} implementation that will read ... */Resource mappingLocation, ...;/** The {@code Resource} to load the mapping file from. */...[] mappings, ...;/** Used to configure additional mappings. */FileTypeMap fileTypeMap, ...;/** The delegate FileTypeMap, compiled from the mappings in the mapping file ... *//** Specify the {@code Resource} from which mappings are loaded. ... */this.mappingLocation/** Specify additional MIME type mappings as lines that follow the ... *//** Creates the final merged mapping set. */getFileTypeMap(...)/** Return the delegate FileTypeMap, compiled from the mappings in the mapping file ... */this.fileTypeMapcreateFileTypeMap(...)/** Compile a {@link FileTypeMap} from the mappings in the given mapping file ... */MimetypesFileTypeMap fileTypeMapnew MimetypesFileTypeMap(...)String mappingaddMimeTypes(...)/** Delegates to the underlying FileTypeMap. ... */getContentType(...)import AddressExceptionimport InternetAddress/** Editor for {@code java.mail.internet.InternetAddress}, ... */new InternetAddress(...)AddressException exInternetAddress valuetoUnicodeString(...)import MimeMessageimport MailExceptionimport MailSender/** Extended {@link org.springframework.mail.MailSender} interface for JavaMail, ... *//** Create a new JavaMail MimeMessage for the underlying JavaMail Session ... *//** Send the given JavaMail MIME message. ... *//** Send the given array of JavaMail MIME messages in batch. ... *//** Send the JavaMail MIME message prepared by the given MimeMessagePreparator. ... *//** Send the JavaMail MIME messages prepared by the given MimeMessagePreparators. ... */import Addressimport AuthenticationFailedExceptionimport MessagingExceptionimport NoSuchProviderExceptionimport Sessionimport Transportimport MailAuthenticationExceptionimport MailParseExceptionimport MailPreparationExceptionimport MailSendExceptionimport SimpleMailMessage/** Production implementation of the {@link JavaMailSender} interface, ... */String DEFAULT_PROTOCOL, ...;/** The default protocol: 'smtp'. */int DEFAULT_PORT, ...;/** The default port: -1. */String HEADER_MESSAGE_ID, ...;Properties javaMailProperties, ...;Session session, ...;String protocol, ...;String username, ...;FileTypeMap defaultFileTypeMap, ...;/** Create a new instance of the {@code JavaMailSenderImpl} class. ... */ConfigurableMimeFileTypeMap fileTypeMapnew ConfigurableMimeFileTypeMap(...)this.defaultFileTypeMap/** Set JavaMail properties for the {@code Session}. ... */this.javaMailPropertiesthis.session/** Allow Map access to the JavaMail properties of this sender, ... *//** Set the JavaMail {@code Session}, possibly pulled from JNDI. ... *//** Return the JavaMail {@code Session}, ... *//** Set the mail protocol. Default is "smtp". */this.protocol/** Return the mail protocol. *//** Set the mail server host, typically an SMTP host. ... *//** Return the mail server host. *//** Set the mail server port. ... *//** Return the mail server port. *//** Set the username for the account at the mail host, if any. ... */this.username/** Return the username for the account at the mail host. *//** Set the password for the account at the mail host, if any. ... *//** Return the password for the account at the mail host. *//** Set the default encoding to use for {@link MimeMessage MimeMessages} ... *//** Return the default encoding for {@link MimeMessage MimeMessages}, ... *//** Set the default Java Activation {@link FileTypeMap} to use for ... *//** Return the default Java Activation {@link FileTypeMap} for ... */// Implementation of MailSendersend(...)new SimpleMailMessage[]List<MimeMessage> mimeMessagesnew ArrayList<MimeMessage>(...)simpleMessages.lengthSimpleMailMessage simpleMessageMimeMailMessage messagenew MimeMailMessage(...)createMimeMessage(...)copyTo(...)getMimeMessage(...)doSend(...)new MimeMessage[]/** This implementation creates a SmartMimeMessage, holding the specified ... */// Implementation of JavaMailSendernew SmartMimeMessage(...)getSession(...)getDefaultFileTypeMap(...)new MimeMessage(...)new MailParseException(...)new MimeMessagePreparator[]mimeMessagePreparators.lengthMimeMessagePreparator preparatorMimeMessage mimeMessageMailException exMessagingException exnew MailPreparationException(...)/** Validate that this instance can connect to the server that it is configured ... */Transport transportconnectTransport(...)/** Actually send the given array of MimeMessages via JavaMail. ... */Map<Object,Exception> failedMessagesmimeMessages.lengthisConnected(...)AuthenticationFailedException exnew MailAuthenticationException(...)new MailSendException(...)String messageIdgetMessageID(...)Address[] addressesgetAllRecipients(...)saveChanges(...)setHeader(...)sendMessage(...)new Address[]/** Obtain and connect a Transport from the underlying JavaMail Session, ... */String usernamegetUsername(...)String passwordgetPassword(...)getTransport(...)/** Obtain a Transport object from the given JavaMail Session, ... */// Check transport connection first...// Ignore - we're reconnecting anyway// Effectively, all remaining messages failed...// Send message via current transport...// Preserve explicitly specified message id...// probably from a placeholder// in conjunction with "" username, this means no password to useimport MailMessage/** Implementation of the MailMessage interface for a JavaMail MIME message, ... */MimeMessageHelper helper, ...;/** Create a new MimeMailMessage based on the given MimeMessageHelper. ... *//** Create a new MimeMailMessage based on the given JavaMail MimeMessage. ... */new MimeMessageHelper(...)/** Return the MimeMessageHelper that this MimeMailMessage is based on. *//** Return the JavaMail MimeMessage that this MimeMailMessage is based on. */import UnsupportedEncodingExceptionimport DataHandlerimport FileDataSourceimport BodyPartimport Messageimport MimeBodyPartimport MimeMultipartimport MimePartimport MimeUtilityimport InputStreamSource/** Helper class for populating a {@link javax.mail.internet.MimeMessage}. ... */int MULTIPART_MODE_NO, ...;/** Constant indicating a non-multipart message. */int MULTIPART_MODE_MIXED, ...;/** Constant indicating a multipart message with a single root multipart ... */int MULTIPART_MODE_RELATED, ...;int MULTIPART_MODE_MIXED_RELATED, ...;/** Constant indicating a multipart message with a root multipart element ... */String MULTIPART_SUBTYPE_MIXED, ...;String MULTIPART_SUBTYPE_RELATED, ...;String MULTIPART_SUBTYPE_ALTERNATIVE, ...;String CONTENT_TYPE_ALTERNATIVE, ...;String CONTENT_TYPE_HTML, ...;String CONTENT_TYPE_CHARSET_SUFFIX, ...;String HEADER_PRIORITY, ...;MimeMessage mimeMessage, ...;MimeMultipart rootMimeMultipart, ...;MimeMultipart mimeMultipart, ...;String encoding, ...;boolean encodeFilenames, ...;boolean validateAddresses, ...;/** Create a new MimeMessageHelper for the given MimeMessage, ... */this.mimeMessagethis.encodingcreateMimeMultiparts(...)/** Return the underlying MimeMessage object. *//** Determine the MimeMultipart objects to use, which will be used ... */MimeMultipart mixedMultipartnew MimeMultipart(...)MimeMultipart relatedMultipartMimeMultipart rootMixedMultipartMimeMultipart nestedRelatedMultipartMimeBodyPart relatedBodyPartnew MimeBodyPart(...)setMimeMultiparts(...)setContent(...)addBodyPart(...)/** Set the given MimeMultipart objects for use by this MimeMessageHelper. ... */this.rootMimeMultipartthis.mimeMultipart/** Return whether this helper is in multipart mode, ... *//** Return the root MIME "multipart/mixed" object, if any. ... *//** Return the underlying MIME "multipart/related" object, if any. ... *//** Determine the default encoding for the given MimeMessage. ... *//** Return the specific character encoding used for this message, if any. *//** Determine the default Java Activation FileTypeMap for the given MimeMessage. ... */FileTypeMap fileTypeMap/** Set the Java Activation Framework {@code FileTypeMap} to use ... *//** Return the {@code FileTypeMap} used by this MimeMessageHelper. ... *//** Set whether to encode attachment filenames passed to this helper's ... */this.encodeFilenames/** Return whether to encode attachment filenames passed to this helper's ... *//** Set whether to validate all addresses which get passed to this helper. ... */this.validateAddresses/** Return whether this helper will validate all addresses passed to it. ... *//** Validate the given mail address. ... */isValidateAddresses(...)/** Validate all given mail addresses. ... */InternetAddress addressvalidateAddress(...)parseAddress(...)new InternetAddress[]InternetAddress replyToAddresssetRecipient(...)Message.RecipientType.TOMessage.RecipientTypevalidateAddresses(...)setRecipients(...)InternetAddress[] addressesto.lengthaddRecipient(...)Message.RecipientType.CCcc.lengthaddCc(...)Message.RecipientType.BCCbcc.lengthaddBcc(...)InternetAddress[] parsedInternetAddress rawparsed.lengthnew AddressException(...)getPersonal(...)UnsupportedEncodingException exnew MessagingException(...)/** Set the priority ("X-Priority" header) of the message. ... *//** Set the sent-date of the message. ... *//** Set the subject of the message, using the correct encoding. ... *//** Set the given text directly as content in non-multipart mode ... */MimePart partToUseisMultipart(...)getMainPart(...)setHtmlTextToMimePart(...)setPlainTextToMimePart(...)/** Set the given plain text and HTML text as alternatives, offering ... */MimeMultipart messageBodyMimeBodyPart plainTextPartMimeBodyPart htmlTextPartMimeMultipart mimeMultipartgetMimeMultipart(...)MimeBodyPart bodyPartBodyPart bpgetBodyPart(...)MimeBodyPart mimeBodyPart/** Add an inline element to the MimeMessage, taking the content from a ... */setDisposition(...)MimeBodyPart.INLINEsetContentID(...)setDataHandler(...)new DataHandler(...)FileDataSource dataSourcenew FileDataSource(...)setFileTypeMap(...)addInline(...)String contentType/** Add an inline element to the MimeMessage, taking the content from an ... */DataSource dataSourcecreateDataSource(...)/** Add an attachment to the MimeMessage, taking the content from a ... */MimeBodyPart.ATTACHMENTsetFileName(...)isEncodeFilenames(...)encodeText(...)getRootMimeMultipart(...)addAttachment(...)/** Add an attachment to the MimeMessage, taking the content from an ... *//** Create an Activation Framework DataSource for the given InputStreamSource. ... */new DataSource(...) { ... }// Create the plain text part of the message.// Create the HTML text part of the message./** Callback interface for the preparation of JavaMail MIME messages. ... *//** Prepare the given new MimeMessage instance. ... *//** Special subclass of the standard JavaMail {@link MimeMessage}, carrying a ... *//** Create a new SmartMimeMessage. ... *//** Return the default encoding of this message, or {@code null} if none. *//** Return the default FileTypeMap of this message, or {@code null} if none. *//** JavaMail support for Spring's mail infrastructure. ... *//** Spring's generic mail infrastructure. ... */import Timerimport TimerListener/** Simple TimerListener adapter that delegates to a given Runnable. ... *//** Create a new DelegatingTimerListener. ... *//** Delegates execution to the underlying Runnable. */import Work/** Simple Work adapter that delegates to a given Runnable. ... *//** Create a new DelegatingWork. ... *//** Return the wrapped Runnable implementation. *//** This implementation delegates to ... *//** This implementation is empty, since we expect the Runnable ... *//** JavaBean that describes a scheduled TimerListener, consisting of ... */TimerListener timerListener, ...;/** Create a new ScheduledTimerListener, ... *//** Create a new ScheduledTimerListener, with default ... */this.timerListener/** Create a new ScheduledTimerListener. ... */setRunnable(...)/** Set the Runnable to schedule as TimerListener. ... */new DelegatingTimerListener(...)/** Set the TimerListener to schedule. *//** Return the TimerListener to schedule. */import TimerManager/** Base class for classes that are accessing a CommonJ {@link commonj.timers.TimerManager} ... */TimerManager timerManager, ...;String timerManagerName, ...;/** Specify the CommonJ TimerManager to delegate to. ... */this.timerManager/** Set the JNDI name of the CommonJ TimerManager. ... */this.timerManagerName/** Specify whether the TimerManager obtained by this FactoryBean ... */TimerManager.class/** Return the configured TimerManager, if any. ... *//** Obtain the TimerManager for actual use. ... *//** Resumes the underlying TimerManager (if not shared). ... */resume(...)obtainTimerManager(...)/** Suspends the underlying TimerManager (if not shared). ... */suspend(...)/** Considers the underlying TimerManager as running if it is ... */TimerManager tmisSuspending(...)isStopping(...)/** Stops the underlying TimerManager (if not shared). ... */// Implementation of DisposableBean interface// Stop the entire TimerManager, if necessary.// May return early, but at least we already cancelled all known Timers./** {@link org.springframework.beans.factory.FactoryBean} that retrieves a ... */...[] scheduledTimerListeners, ...;List<Timer> timers, ...;/** Register a list of ScheduledTimerListener objects with the TimerManager ... */this.scheduledTimerListeners// Implementation of InitializingBean interfaceTimerManager timerManagerthis.timersnew ArrayList<Timer>(...)this.scheduledTimerListeners.lengthScheduledTimerListener scheduledTaskTimer timergetTimerListener(...)// Implementation of FactoryBean interfacegetTimerManager(...)/** Cancels all statically registered Timers on shutdown, ... */// Cancel all registered timers.// Stop the TimerManager itself.new ReschedulingTimerListener(...)TimerScheduledFuture futureTasknew TimerScheduledFuture(...)setTimer(...)/** ScheduledFuture adapter that wraps a CommonJ Timer. */Timer timer, ...;boolean cancelled, ...;this.timerrunAndReset(...)this.cancelledgetScheduledExecutionTime(...)/** ScheduledFuture adapter for trigger-based rescheduling. */timerExpired(...)import WorkExceptionimport WorkItemimport WorkListenerimport WorkManagerimport WorkRejectedExceptionimport SchedulingException/** TaskExecutor implementation that delegates to a CommonJ WorkManager, ... */WorkManager workManager, ...;String workManagerName, ...;WorkListener workListener, ...;/** Specify the CommonJ WorkManager to delegate to. ... */this.workManager/** Set the JNDI name of the CommonJ WorkManager. ... */this.workManagerName/** Specify a CommonJ WorkListener to apply, if any. ... */this.workListenerWorkManager.class// Implementation of the Spring SchedulingTaskExecutor interfaceWork worknew DelegatingWork(...)obtainWorkManager(...)WorkRejectedException exWorkException exnew SchedulingException(...)FutureTask<Object> futurenew FutureTask<Object>(...)FutureTask<T> futurenew FutureTask<T>(...)// Implementation of the CommonJ WorkManager interfacewaitForAll(...)waitForAny(...)/** Convenience classes for scheduling based on the CommonJ WorkManager/TimerManager ... */import Jobimport Schedulerimport SchedulerExceptionimport JobFactoryimport TriggerFiredBundle/** {@link JobFactory} implementation that supports {@link java.lang.Runnable} ... */Object jobObjectcreateJobInstance(...)adaptJob(...)new SchedulerException(...)/** Create an instance of the specified job class. ... */Class<?> jobClassgetJobClass(...)getJobDetail(...)/** Adapt the given job object to the Quartz Job interface. ... */new DelegatingJob(...)import JobDataMapimport JobDetailimport CronTriggerImpl/** A Spring {@link FactoryBean} for creating a Quartz {@link org.quartz.CronTrigger} ... */new JobDataMap(...)CronTrigger.class/** Constants for the CronTrigger class. */String group, ...;JobDetail jobDetail, ...;JobDataMap jobDataMap, ...;Date startTime, ...;long startDelay, ...;String cronExpression, ...;String calendarName, ...;int priority, ...;int misfireInstruction, ...;CronTrigger cronTrigger, ...;/** Specify the trigger's name. *//** Specify the trigger's group. *//** Set the JobDetail that this trigger should be associated with. */this.jobDetail/** Set the trigger's JobDataMap. ... */this.jobDataMap/** Return the trigger's JobDataMap. *//** Register objects in the JobDataMap via a given Map. ... *//** Set a specific start time for the trigger. ... */this.startTime/** Set the start delay in milliseconds. ... */this.startDelay/** Specify the cron expression for this trigger. */this.cronExpression/** Specify the time zone for this trigger's cron expression. *//** Associate a specific calendar with this cron trigger. */this.calendarName/** Specify the priority of this trigger. */this.priority/** Specify a misfire instruction for this trigger. */this.misfireInstruction/** Set the misfire instruction via the name of the corresponding ... *//** Associate a textual description with this trigger. */CronTriggerImpl ctinew CronTriggerImpl(...)Scheduler.DEFAULT_GROUPsetGroup(...)setJobKey(...)setJobDataMap(...)setStartTime(...)setCronExpression(...)setCalendarName(...)setPriority(...)setMisfireInstruction(...)this.cronTriggerimport JobExecutionContextimport JobExecutionException/** Simple Quartz {@link org.quartz.Job} adapter that delegates to a ... *//** Create a new DelegatingJob. ... */import JobDetailImpl/** A Spring {@link FactoryBean} for creating a Quartz {@link org.quartz.JobDetail} ... */Class<? extends Job> jobClass, ...;boolean durability, ...;boolean requestsRecovery, ...;String applicationContextJobDataKey, ...;/** Specify the job's name. *//** Specify the job's group. *//** Specify the job's implementation class. */this.jobClass/** Set the job's JobDataMap. ... *//** Return the job's JobDataMap. */getJobDataMap(...)/** Specify the job's durability, i.e. whether it should remain stored ... */this.durability/** Set the recovery flag for this job, i.e. whether or not the job should ... */this.requestsRecovery/** Set a textual description for this job. *//** Set the key of an ApplicationContext reference to expose in the JobDataMap, ... */this.applicationContextJobDataKeyJobDetailImpl jdinew JobDetailImpl(...)setJobClass(...)setDurability(...)setRequestsRecovery(...)JobDetail.class/** Unchecked exception that wraps an exception thrown from a target method. ... *//** Constructor for JobMethodInvocationFailedException. ... */import DatabaseMetaDataimport SchedulerConfigExceptionimport JobStoreCMTimport SimpleSemaphoreimport ClassLoadHelperimport SchedulerSignalerimport ConnectionProviderimport DBConnectionManagerimport DataSourceUtilsimport JdbcUtilsimport MetaDataAccessException/** Subclass of Quartz's {@link JobStoreCMT} class that delegates to a Spring-managed ... */String TX_DATA_SOURCE_PREFIX, ...;/** Name used for the transactional ConnectionProvider for Quartz. ... */String NON_TX_DATA_SOURCE_PREFIX, ...;/** Name used for the non-transactional ConnectionProvider for Quartz. ... */DataSource dataSource, ...;DataSource nonTxDataSourcegetConfigTimeNonTransactionalDataSource(...)DataSource nonTxDataSourceToUsethis.dataSourcegetConfigTimeDataSource(...)new SchedulerConfigException(...)getInstanceName(...)setDontSetAutoCommitFalse(...)addConnectionProvider(...)new ConnectionProvider(...) { ... }doGetConnection(...)setNonManagedTXDataSource(...)getConnection(...)String productNameextractDatabaseMetaData(...)new DatabaseMetaDataCallback<String>(...) { ... }getDatabaseProductName(...)commonDatabaseName(...)setUseDBLocks(...)setLockHandler(...)new SimpleSemaphore(...)MetaDataAccessException exlogWarnIfNonZero(...)releaseConnection(...)// due to a warning in Quartz 2.2's JobStoreCMT// Absolutely needs thread-bound DataSource to initialize.// Configure transactional connection settings for Quartz.// Register transactional ConnectionProvider for Quartz.// Return a transactional Connection, if any.// Do nothing - a Spring-managed DataSource has its own lifecycle.// Non-transactional DataSource is optional: fall back to default// DataSource if not explicitly specified.// Configure non-transactional connection settings for Quartz.// Register non-transactional ConnectionProvider for Quartz.// Always return a non-transactional Connection.// No, if HSQL is the platform, we really don't want to use locks...// Will work for transactional and non-transactional connections.import ThreadPool/** Quartz {@link ThreadPool} adapter that delegates to a Spring-managed ... */getConfigTimeTaskExecutor(...)// Absolutely needs thread-bound Executor to initialize.// The present implementation always returns 1, making Quartz// always schedule any tasks that it feels like scheduling.// This could be made smarter for specific TaskExecutors,// for example calling {@code getMaximumPoolSize() - getActiveCount()}// on a {@code java.util.concurrent.ThreadPoolExecutor}.import DisallowConcurrentExecutionimport PersistJobDataAfterExecution/** {@link org.springframework.beans.factory.FactoryBean} that exposes a ... */boolean concurrent, ...;/** Set the name of the job. ... *//** Set the group of the job. ... *//** Specify whether or not multiple jobs should be run in a concurrent fashion. ... */this.concurrent/** Set the name of the target bean in the Spring BeanFactory. ... */Class<? extends Job> jobClassMethodInvokingJob.classStatefulMethodInvokingJob.classpostProcessJobDetail(...)/** Callback for post-processing the JobDetail to be exposed by this FactoryBean. ... *//** Overridden to support the {@link #setTargetBeanName "targetBeanName"} feature. *//** Quartz Job implementation that invokes a specified method. ... */MethodInvoker methodInvoker, ...;/** Set the MethodInvoker to use. */this.methodInvoker/** Invoke the method via the MethodInvoker. */setResult(...)new JobMethodInvocationFailedException(...)/** Extension of the MethodInvokingJob, implementing the StatefulJob interface. ... */// Use specific name if given, else fall back to bean name.// Consider the concurrent flag to choose between stateful and stateless job.// Build JobDetail instance.// -> JobExecutionException, to be logged at info level by Quartz// -> "unhandled exception", to be logged at error level by Quartz// No implementation, just an addition of the tag interface StatefulJob// in order to allow stateful method invoking jobs./** Simple implementation of the Quartz Job interface, applying the ... *//** This implementation applies the passed-in job data map as bean property ... */getMergedJobDataMap(...)SchedulerException exnew JobExecutionException(...)executeInternal(...)/** Execute the actual job. The job data map will already have been ... *//** Wrapper that adapts from the Quartz {@link ClassLoadHelper} interface ... */ResourceLoaderClassLoadHelper.class/** Create a new ResourceLoaderClassLoadHelper for the default ... *//** Create a new ResourceLoaderClassLoadHelper for the given ResourceLoader. ... */getConfigTimeResourceLoader(...)import JobListenerimport ListenerManagerimport ObjectAlreadyExistsExceptionimport SchedulerListenerimport TriggerListenerimport XMLSchedulingDataProcessorimport TransactionDefinitionimport TransactionExceptionimport TransactionStatus/** Common base class for accessing a Quartz Scheduler, i.e. for registering jobs, ... */boolean overwriteExistingJobs, ...;...[] jobSchedulingDataLocations, ...;List<JobDetail> jobDetails, ...;Map<String,Calendar> calendars, ...;List<Trigger> triggers, ...;...[] schedulerListeners, ...;...[] globalJobListeners, ...;...[] globalTriggerListeners, ...;PlatformTransactionManager transactionManager, ...;/** Set whether any jobs defined on this SchedulerFactoryBean should overwrite ... */this.overwriteExistingJobs/** Set the location of a Quartz job definition XML file that follows the ... */this.jobSchedulingDataLocations/** Set the locations of Quartz job definition XML files that follow the ... *//** Register a list of JobDetail objects with the Scheduler that ... */this.jobDetailsnew ArrayList<JobDetail>(...)/** Register a list of Quartz Calendar objects with the Scheduler ... */this.calendars/** Register a list of Trigger objects with the Scheduler that ... */this.triggers/** Specify Quartz SchedulerListeners to be registered with the Scheduler. */this.schedulerListeners/** Specify global Quartz JobListeners to be registered with the Scheduler. ... */this.globalJobListeners/** Specify global Quartz TriggerListeners to be registered with the Scheduler. ... */this.globalTriggerListeners/** Set the transaction manager to be used for registering jobs and triggers ... */this.transactionManager/** Register jobs and triggers (within a transaction, if possible). */TransactionStatus transactionStatusgetTransaction(...)withDefaults(...)ClassLoadHelper clhnew ResourceLoaderClassLoadHelper(...)XMLSchedulingDataProcessor dataProcessornew XMLSchedulingDataProcessor(...)processFileAndScheduleJobs(...)JobDetail jobDetailaddJobToScheduler(...)String calendarNameaddCalendar(...)addTriggerToScheduler(...)rollback(...)TransactionException texcommit(...)/** Add the given job to the Scheduler, if it doesn't already exist. ... */addJob(...)/** Add the given trigger to the Scheduler, if it doesn't already exist. ... */boolean triggerExistsrescheduleJob(...)ObjectAlreadyExistsException exscheduleJob(...)/** Register all specified listeners with the Scheduler. */ListenerManager listenerManagergetListenerManager(...)SchedulerListener listeneraddSchedulerListener(...)JobListener listeneraddJobListener(...)TriggerListener listeneraddTriggerListener(...)/** Template method that determines the Scheduler to operate on. ... */// Use modifiable ArrayList here, to allow for further adding of// JobDetail objects during autodetection of JobDetail-aware Triggers.// Register JobDetails.// Create empty list for easier checks when registering triggers.// Register Calendars.// Register Triggers.// Check if the Trigger is aware of an associated JobDetail.import SchedulerRepository/** Spring bean-style class for accessing a Quartz Scheduler, i.e. for registering jobs, ... */String schedulerName, ...;Scheduler scheduler, ...;/** Specify the Quartz {@link Scheduler} to operate on via its scheduler name in the Spring ... */this.schedulerName/** Specify the Quartz {@link Scheduler} instance to operate on. ... *//** Return the Quartz Scheduler instance that this accessor operates on. */findScheduler(...)findDefaultScheduler(...)registerJobsAndTriggers(...)Scheduler schedulerInRepoScheduler.classScheduler schedulerBeangetSchedulerName(...)import SchedulerContext/** Callback interface to be implemented by Spring-managed ... *//** Set the SchedulerContext of the current Quartz Scheduler. ... */import SchedulerFactoryimport RemoteSchedulerimport StdSchedulerFactoryimport SimpleThreadPool/** {@link FactoryBean} that creates and configures a Quartz {@link org.quartz.Scheduler}, ... */StdSchedulerFactory.classnew ThreadLocal<ResourceLoader>(...)new ThreadLocal<Executor>(...)new ThreadLocal<DataSource>(...)String PROP_THREAD_COUNT, ...;/** The thread count property. */int DEFAULT_THREAD_COUNT, ...;/** The default thread count. */ThreadLocal<ResourceLoader> configTimeResourceLoaderHolder, ...;ThreadLocal<Executor> configTimeTaskExecutorHolder, ...;ThreadLocal<DataSource> configTimeDataSourceHolder, ...;ThreadLocal<DataSource> configTimeNonTransactionalDataSourceHolder, ...;/** Return the {@link ResourceLoader} for the currently configured Quartz Scheduler, ... *//** Return the {@link Executor} for the currently configured Quartz Scheduler, ... *//** Return the {@link DataSource} for the currently configured Quartz Scheduler, ... *//** Return the non-transactional {@link DataSource} for the currently configured ... */SchedulerFactory schedulerFactory, ...;Class<? extends SchedulerFactory> schedulerFactoryClass, ...;Properties quartzProperties, ...;DataSource nonTransactionalDataSource, ...;Map<String,?> schedulerContextMap, ...;String applicationContextSchedulerContextKey, ...;JobFactory jobFactory, ...;boolean jobFactorySet, ...;int startupDelay, ...;boolean exposeSchedulerInRepository, ...;boolean waitForJobsToCompleteOnShutdown, ...;/** Set an external Quartz {@link SchedulerFactory} instance to use. ... */this.schedulerFactory/** Set the Quartz {@link SchedulerFactory} implementation to use. ... */this.schedulerFactoryClass/** Set the name of the Scheduler to create via the SchedulerFactory, as an ... *//** Set the location of the Quartz properties config file, for example ... *//** Set Quartz properties, like "org.quartz.threadPool.class". ... */this.quartzProperties/** Set a Spring-managed {@link Executor} to use as Quartz backend. ... *//** Set the default {@link DataSource} to be used by the Scheduler. ... *//** Set the {@link DataSource} to be used <i>for non-transactional access</i>. ... */this.nonTransactionalDataSource/** Register objects in the Scheduler context via a given Map. ... */this.schedulerContextMap/** Set the key of an {@link ApplicationContext} reference to expose in the ... */this.applicationContextSchedulerContextKey/** Set the Quartz {@link JobFactory} to use for this Scheduler. ... */this.jobFactorythis.jobFactorySet/** Set whether to automatically start the scheduler after initialization. ... *//** Return whether this scheduler is configured for auto-startup. If "true", ... *//** Specify the phase in which this scheduler should be started and stopped. ... *//** Return the phase in which this scheduler will be started and stopped. *//** Set the number of seconds to wait after initialization before ... */this.startupDelay/** Set whether to expose the Spring-managed {@link Scheduler} instance in the ... */this.exposeSchedulerInRepository/** Set whether to wait for running jobs to complete on shutdown. ... */this.waitForJobsToCompleteOnShutdownprepareScheduler(...)prepareSchedulerFactory(...)Exception ex2/** Create a SchedulerFactory if necessary and apply locally defined Quartz properties to it. ... */SchedulerFactory schedulerFactoryinitSchedulerFactory(...)/** Initialize the given SchedulerFactory, applying locally defined Quartz properties to it. ... */StdSchedulerFactory.PROP_SCHED_CLASS_LOAD_HELPER_CLASSStdSchedulerFactory.PROP_THREAD_POOL_CLASSLocalTaskExecutorThreadPool.classSimpleThreadPool.classStdSchedulerFactory.PROP_JOB_STORE_CLASSLocalDataSourceJobStore.classStdSchedulerFactory.PROP_SCHED_INSTANCE_NAMEString namePropScheduler schedulercreateScheduler(...)populateSchedulerContext(...)new AdaptableJobFactory(...)setSchedulerContext(...)setJobFactory(...)/** Create the Scheduler instance for the given factory and scheduler name. ... */Thread currentThreadClassLoader threadContextClassLoaderboolean overrideClassLoaderSchedulerRepository repositoryScheduler existingSchedulerScheduler newScheduler/** Expose the specified context attributes and/or the current ... *//** Start the Quartz Scheduler, respecting the "startupDelay" setting. ... */Thread schedulerThread// Implementation of SmartLifecycle interfacestartScheduler(...)standby(...)isInStandbyMode(...)/** Shut down the Quartz scheduler on bean factory shutdown, ... */// Initialize the Scheduler instance...// Create local SchedulerFactory instance (typically a StdSchedulerFactory)// Otherwise, no local settings to be applied via StdSchedulerFactory.initialize(Properties)// Otherwise, assume that externally provided factory has been initialized with appropriate settings// Set necessary default properties here, as Quartz will not apply// its default configuration when explicitly given properties.// Determine scheduler name across local settings and Quartz properties...// Make given ResourceLoader available for SchedulerFactory configuration.// Make given TaskExecutor available for SchedulerFactory configuration.// Make given DataSource available for SchedulerFactory configuration.// Make given non-transactional DataSource available for SchedulerFactory configuration.// Get Scheduler instance from SchedulerFactory.// Use AdaptableJobFactory as default for a local Scheduler, unless when// explicitly given a null value through the "jobFactory" bean property.// Override thread context ClassLoader to work around naive Quartz ClassLoadHelper loading.// Need to remove it in this case, since Quartz shares the Scheduler instance by default!// Reset original thread context ClassLoader.// Put specified objects into Scheduler context.// Register ApplicationContext in Scheduler context.// Not using the Quartz startDelayed method since we explicitly want a daemon// thread here, not keeping the JVM alive in case of all other threads ending.// simply proceed/** Subclass of Quartz's SimpleThreadPool that implements Spring's ... */runInThread(...)import SimpleTriggerimport SimpleTriggerImpl/** A Spring {@link FactoryBean} for creating a Quartz {@link org.quartz.SimpleTrigger} ... */SimpleTrigger.class/** Constants for the SimpleTrigger class. */long repeatInterval, ...;int repeatCount, ...;SimpleTrigger simpleTrigger, ...;/** Specify the interval between execution times of this trigger. */this.repeatInterval/** Specify the number of times this trigger is supposed to fire. ... */this.repeatCountSimpleTriggerImpl stinew SimpleTriggerImpl(...)setRepeatInterval(...)setRepeatCount(...)this.simpleTrigger/** Subclass of {@link AdaptableJobFactory} that also supports Spring-style ... */...[] ignoredUnknownProperties, ...;SchedulerContext schedulerContext, ...;/** Specify the unknown properties (not found in the bean) that should be ignored. ... */this.ignoredUnknownPropertiesthis.schedulerContext/** Create the job instance, populating it with property values taken ... */Object jobisEligibleForPropertyPopulation(...)/** Return whether the given job object is eligible for having ... *//** Support classes for the open source scheduler ... */import FileTemplateLoaderimport MultiTemplateLoaderimport TemplateLoaderimport SimpleHashimport TemplateException/** Factory that configures a FreeMarker Configuration. Can be used standalone, but ... */new ArrayList<TemplateLoader>(...)Properties freemarkerSettings, ...;Map<String,Object> freemarkerVariables, ...;List<TemplateLoader> templateLoaders, ...;List<TemplateLoader> preTemplateLoaders, ...;List<TemplateLoader> postTemplateLoaders, ...;...[] templateLoaderPaths, ...;boolean preferFileSystemAccess, ...;/** Set the location of the FreeMarker config file. ... *//** Set properties that contain well-known FreeMarker keys which will be ... */this.freemarkerSettings/** Set a Map that contains well-known FreeMarker objects which will be passed ... */this.freemarkerVariables/** Set the default encoding for the FreeMarker configuration. ... *//** Set a List of {@code TemplateLoader}s that will be used to search ... */this.preTemplateLoadersthis.postTemplateLoaders/** Set the Freemarker template loader path via a Spring resource location. ... */this.templateLoaderPaths/** Set multiple Freemarker template loader paths via Spring resource locations. ... *//** Set the Spring ResourceLoader to use for loading FreeMarker template files. ... *//** Return the Spring ResourceLoader to use for loading FreeMarker template files. *//** Set whether to prefer file system access for template loading. ... */this.preferFileSystemAccess/** Return whether to prefer file system access for template loading. *//** Prepare the FreeMarker Configuration and return it. ... */Configuration confignewConfiguration(...)List<TemplateLoader> templateLoadersthis.templateLoadersTemplateLoader loadergetAggregateTemplateLoader(...)setSettings(...)setAllSharedVariables(...)new SimpleHash(...)getObjectWrapper(...)getTemplateLoaderForPath(...)postProcessTemplateLoaders(...)setTemplateLoader(...)/** Return a new Configuration object. Subclasses can override this for custom ... */new Configuration(...)Configuration.DEFAULT_INCOMPATIBLE_IMPROVEMENTS/** Determine a FreeMarker TemplateLoader for the given path. ... */isPreferFileSystemAccess(...)Resource pathnew FileTemplateLoader(...)new SpringTemplateLoader(...)/** To be overridden by subclasses that want to register custom ... *//** Return a TemplateLoader based on the given TemplateLoader list. ... */TemplateLoader[] loadersnew TemplateLoader[]new MultiTemplateLoader(...)/** To be overridden by subclasses that want to perform custom ... */// Load config file if specified.// Merge local properties if specified.// FreeMarker will only accept known keys in its setSettings and// setAllSharedVariables methods.// Register template loaders that are supposed to kick in early.// Register default template loaders.// Register template loaders that are supposed to kick in late.// Try to load via the file system, fall back to SpringTemplateLoader// (for hot detection of template changes, if possible).// will fail if not resolvable in the file system// Always load via SpringTemplateLoader (without hot detection of template changes)./** Factory bean that creates a FreeMarker Configuration and provides it as ... */Configuration configuration, ...;this.configurationcreateConfiguration(...)import Template/** Utility class for working with FreeMarker. ... *//** Process the specified FreeMarker template with the given model and write ... */StringWriter result/** FreeMarker {@link TemplateLoader} adapter that loads via a Spring {@link ResourceLoader}. ... */String templateLoaderPath, ...;/** Create a new SpringTemplateLoader. ... */this.templateLoaderPath/** Support classes for setting up ... */new CaffeineCacheManager(...)CaffeineCacheManager cmCaffeine<Object,Object> caffeinemaximumSize(...)Cache cache1xxsetCaffeine(...)setCaffeineSpec(...)setCacheSpecification(...)CacheLoader<Object,Object> loaderCacheLoader<>.classsetCacheLoader(...)ValueWrapper valuenew CacheLoader<Object,Object>(...) { ... }Cache<Object,Object> ncregisterCustomCache(...)// Set same instance/** Tests for {@link CaffeineCache}. ... */Cache<Object,Object> nativeCache, ...;CaffeineCache cache, ...;CaffeineCache cacheNoNull, ...;Cache<Object,Object> nativeCacheNoNullCaffeineCache loadingCacheValueWrapper valueWrapperString valueWrapperCaffeineCache cache// A value is set but is 'null'import AbstractTransactionSupportingCacheManagerTestsCacheManager nativeCacheManager, ...;EhCacheCacheManager cacheManager, ...;EhCacheCacheManager transactionalCacheManager, ...;defaultCache(...)new CacheConfiguration(...)addNativeCache(...)new EhCacheCacheManager(...)setTransactionAware(...)EhCacheCache.classremoveCache(...)import AbstractCacheTestsEhcache nativeCache, ...;EhCacheCache cache, ...;Element brancusisetTimeToLive(...)// ttl = 10s// wait for the entry to expireEhCacheManagerFactoryBean cacheManagerFbnew EhCacheManagerFactoryBean(...)setCacheManagerName(...)Cache myCache1getCacheNames(...).lengthEhCacheManagerFactoryBean cacheManagerFb2CacheException.classCacheManager cm2setAcceptExisting(...)isEternal(...)getCacheConfiguration(...)getMaxEntriesLocalHeap(...)doTestEhCacheFactoryBean(...)boolean cacheManagerFbInitializedEhCacheFactoryBean cacheFbnew EhCacheFactoryBean(...)Class<? extends Ehcache> objectTypeClass<? extends Ehcache> objectType2CacheConfiguration configEhcache.classgetTimeToLiveSeconds(...)getTimeToIdleSeconds(...)getDiskExpiryThreadIntervalSeconds(...)setTimeToIdle(...)setDiskExpiryThreadIntervalSeconds(...)Ehcache myCache1setBlocking(...)setCacheEntryFactory(...)new CacheEntryFactory(...) { ... }new UpdatingCacheEntryFactory(...) { ... }// Cache region is not defined. Should create one with default properties.// overriding the default propertiesimport SimpleExceptionCacheResolverCacheResolver defaultCacheResolver, ...;CacheResolver defaultExceptionCacheResolver, ...;KeyGenerator defaultKeyGenerator, ...;CacheManagerMock cacheManagerMock, ...;JCacheCacheManager cacheManager, ...;JCacheCacheManager transactionalCacheManager, ...;new CacheManagerMock(...)new JCacheCacheManager(...)JCacheCache.classList<String> cacheNames, ...;Cache<> cacheCache<>.classimport CachingProvider/** Just here to be run against EHCache 3, whereas the original JCacheEhCacheAnnotationTests ... */import MutableConfigurationimport TransactionTemplatenew TransactionTemplate(...)TransactionTemplate txTemplate, ...;CacheManager jCacheManager, ...;executeWithoutResult(...)new Consumer<TransactionStatus>(...) { ... }CachingProvider cachingProvider, ...;JCacheCacheManager cmjCacheManager(...)this.cachingProviderMutableConfiguration<Object,Object> mutableConfigurationnew MutableConfiguration<Object,Object>(...)// otherwise value has to be SerializableJCacheCache cache, ...;JCacheCache cacheNoNull, ...;new MutableConfiguration<K,V>(...)import AnnotatedJCacheableServiceimport JCacheableServiceJCacheableService<?> cs, ...;Cache exceptionCache, ...;JCacheableService<>.classMap<String,JCacheInterceptor> interceptorsJCacheInterceptor.classcacheWithException(...)cacheWithCheckedException(...)SimpleCacheManager cmexceptionCache(...)new AnnotatedJCacheableService(...)JCacheInterceptor cacheInterceptor/** A test {@link org.springframework.cache.interceptor.CacheInterceptor} that handles special exception ... */import AbstractJCacheAnnotationTestsDefaultJCacheOperationSource cosDefaultJCacheOperationSource.classFullCachingConfigSupport.classNoExceptionCacheResolverConfig.classJCacheableService<?> service// This call requires the cache manager to be setDefaultJCacheOperationSource ciJCacheInterceptor ciimport AbstractJCacheTestsnew SampleObject(...)SampleObject sampleInstance, ...;O operationcreateSimpleOperation(...)A cacheAnnotationObject cacheNameimport TestableCacheKeyGeneratorimport TestableCacheResolverFactory/** Repository sample with a @CacheDefaults annotation ... */AtomicLong exceptionCounter, ...;Cache defaultCache, ...;this.defaultCacheNullPointerException.classthrowException(...)throwCheckedException(...)TestableCacheResolverFactory.classTestableCacheKeyGenerator.classConcurrentHashMap<?,?> nativeCachelong count// Never reached// instance check on purposeimport TestableCacheResolverDefaultJCacheOperationSource source, ...;setExceptionCacheResolver(...)CacheResultOperation opgetDefaultCacheOperation(...)CacheResultOperation.classassertDefaults(...)CacheRemoveOperation opCacheRemoveOperation.classCacheRemoveAllOperation opCacheRemoveAllOperation.classAnnotatedJCacheableService.classInvalidCases.classCacheDefaults mockComparator<>.classCustomService.classassertJCacheResolver(...)TestableCacheResolver.classKeyGeneratorAdapter.classassertCacheKeyGenerator(...)TestableCacheKeyGenerator beannew TestableCacheKeyGenerator(...)KeyGeneratorAdapter adapterCustomServiceWithDefaults.classJCacheOperation<?> resultCacheResolverAdapter adapterCacheResolverAdapter.class// take bean from contextSampleObject.classcreateDefaultOperation(...)CacheInvocationParameter[] allParametersCacheInvocationParameter valueParameterallParameters.lengthassertCacheInvocationParameter(...)DefaultCacheInvocationContext<?> dummyContextcreateDummyContext(...)Sample.classCacheResult cacheAnnotationnew DefaultCacheMethodDetails<CacheResult>(...)new DefaultCacheInvocationContext<CacheResult>(...)new Sample(...)CacheInvocationParameter[] keyParameterskeyParameters.lengthCacheInvocationParameter[] parametersSet<Annotation> firstParameterAnnotationsSet<Annotation> secondParameterAnnotations// missing one argumentimport JCacheConfigurerSupportCache errorCache, ...;this.errorCacheUnsupportedOperationException exceptionOnPutSimpleService.TEST_EXCEPTIONgetFail(...)mockErrorCache(...)IllegalStateException TEST_EXCEPTION, ...;new DummyInvoker(...)CacheOperationInvoker dummyInvoker, ...;createOperationSource(...)AnnotatedJCacheableService serviceCacheOperationInvoker invokerObject executeDefaultJCacheOperationSource sourceObject result, ...;// Returns empty listimport SimpleKeyTestKeyGenerator keyGenerator, ...;TestKeyGenerator.classexpect(...)getFiltered(...)new TestKeyGenerator(...)...[] expectedParams, ...;this.expectedParams// Simple// @CacheKey// @CacheValue// Parameter annotation// Full config/** Shared tests for {@link CacheManager} that inherit from ... *//** Returns the {@link CacheManager} to use. ... *//** Returns the expected concrete type of the cache. *//** Adds a cache with the specified name to the native manager. *//** Removes the cache with the specified name from the native manager. */getCacheType(...)T cacheManagerremoveNativeCache(...)TransactionAwareCacheDecorator.classCache targetTransactionAwareCacheDecorator cachegetTargetCache(...)// unchanged// no transactional support for putIfAbsent// no transactional support for evictIfPresent// no transactional support for invalidateSimpleMailMessage messagenew SimpleMailMessage(...)SimpleMailMessage messageCopyDate sentDateList<String> ccsList<String> bccsSimpleMailMessage originalSimpleMailMessage copy/** Tests that two equal SimpleMailMessages have equal hash codes. */SimpleMailMessage message1SimpleMailMessage message2// Copy the message// Same object is equal// Null object is not equal// Different class is not equal// Equal values are equalConfigurableMimeFileTypeMap ftmnew InternetAddressEditor(...)String EMPTY, ...;String SIMPLE, ...;String BAD, ...;InternetAddressEditor editor, ...;import URLNameMockJavaMailSender sendernew MockJavaMailSender(...)MimeMessage sentMessagegetSentMessage(...)sender.transportList<Address> fromsList<Address> replyTosList<Address> tosgetRecipients(...)List<Address> ccsList<Address> bccssetHost(...)setPort(...)setUsername(...)getConnectedHost(...)getConnectedPort(...)getConnectedUsername(...)getConnectedPassword(...)isCloseCalled(...)getSentMessages(...)getContent(...)SimpleMailMessage simpleMessage1SimpleMailMessage simpleMessage2MimeMessage sentMessage1List<Address> tos1MimeMessage sentMessage2List<Address> tos2MimeMessage mimeMessage1MimeMessage mimeMessage2List<Message> messagesnew ArrayList<Message>(...)new MimeMessagePreparator(...) { ... }MimeMessagePreparator preparator1MimeMessagePreparator preparator2MimeMessageHelper messagesetDefaultFileTypeMap(...)MailParseException exSession sessionnew MockJavaMailSender(...) { ... }setJavaMailProperties(...)MailSendException.classnew Consumer<MailSendException>(...) { ... }getFailedMessages(...)MailSendException exObject subExtestConnection(...)MessagingException.classMockTransport transport, ...;this.transportnew MockTransport(...)String connectedHost, ...;int connectedPort, ...;String connectedUsername, ...;String connectedPassword, ...;boolean closeCalled, ...;List<Message> sentMessages, ...;this.sentMessagesthis.connectedHostthis.connectedPortthis.connectedUsernamethis.connectedPasswordsetConnected(...)this.closeCalledaddresses.lengthCronTriggerFactoryBean factorynew CronTriggerFactoryBean(...)getCronExpression(...)// SPR-6354import JdbcTemplateSchedulerContext schedulerContextnew SchedulerContext(...)SchedulerFactoryBean schedulerFactoryBeannew SchedulerFactoryBean(...) { ... }Map<String,Object> schedulerContextMapsetSchedulerContextAsMap(...)setApplicationContextSchedulerContextKey(...)Scheduler returnedSchedulerCountingTaskExecutor taskExecutornew CountingTaskExecutor(...)JobDetailImpl jobDetailSimpleTriggerFactoryBean triggernew SimpleTriggerFactoryBean(...)SchedulerFactoryBean beannew SchedulerFactoryBean(...)DummyJob.countDummyJob.classsetJobDetail(...)setStartDelay(...)setTriggers(...)setJobDetails(...)taskExecutor.countDummyJob.paramDummyJobBean.classDummyJobBean.paramDummyJobBean.countnew SpringBeanJobFactory(...)SpringBeanJobFactory jobFactorysetIgnoredUnknownProperties(...)setJobSchedulingDataLocation(...)Scheduler scheduler1Scheduler scheduler2QuartzTestBean exportServiceQuartzTestBean importServicegetImportCount(...)getExportCount(...)Scheduler beanSchedulerFactoryBean.classisStarted(...)/** SPR-6038: detect HSQL and stop illegal locks being taken. ... */JdbcTemplate jdbcTemplatenew JdbcTemplate(...)DataSource.classqueryForList(...)int param, ...;// SPR-772// SPR-16884/* Thread.sleep(3000); ... */int importCount, ...;int exportCount, ...;SimpleTriggerFactoryBean factorySimpleTrigger triggergetRepeatCount(...)getRepeatInterval(...)new FreeMarkerConfigurationFactoryBean(...)FreeMarkerConfigurationFactoryBean fcfb, ...;setFreemarkerSettings(...)Configuration cfgsetTemplateLoaderPath(...)SpringTemplateLoader.classgetTemplateLoader(...)Properties settingsConfiguration fcTemplate ftgetTemplate(...)new ResourceLoader(...) { ... }processTemplateIntoString(...)RootBeanDefinition loaderDefRootBeanDefinition configDef// SPR-12448import BeanValidationPostProcessorimport CustomValidatorBeanimport MethodValidationInterceptorimport SpringValidatorAdapterBeanWithListElementConstraint beannew BeanWithListElementConstraint(...)Map<String,String> propertyBeanWithMapEntryConstraint beannew BeanWithMapEntryConstraint(...)List<String> property, ...;Map<String,String> property, ...;// SPR-15839import LocalValidatorFactoryBeanimport GeneratedCacheKey/** A simple test key generator that only takes the first key arguments into ... */new SimpleGeneratedCacheKey(...)Cache<K,V> mocknew TestableCacheResolver(...)String DEFAULT_CACHE, ...;String EXCEPTION_CACHE, ...;String keyItem, ...;JCacheableService<?> service, ...;this.keyItemlong refexceptionInvocations(...)new Consumer<UnsupportedOperationException>(...) { ... }UnsupportedOperationException secondmethodInCallStack(...)hasCause(...)hasMessage(...)contain(...)AbstractJCacheAnnotationTests.classcacheAlwaysInvoke(...)cacheWithPartialKey(...)cacheWithCustomCacheResolver(...)cacheWithCustomKeyGenerator(...)putWithException(...)earlyPut(...)earlyPutWithException(...)removeWithException(...)earlyRemove(...)earlyRemoveWithException(...)removeAllWithException(...)earlyRemoveAll(...)earlyRemoveAllWithException(...)/** The only purpose of this method is to invoke a particular method on the ... */UnsupportedOperationException e// Sanity check, this particular call has called the service// First call should not have been cached// Sanity check, this particular call has *not* called the service// Second call should have been cached// Original stack must not contain any reference to methodInCallStack// second argument not used, see config// Cache in mock cache// This will be cached anyway as the earlyPut has updated the cache before// This will be remove anyway as the earlyRemove has removed the cache before/** A visitor to visit a Java annotation. The methods of this class must be called in the following ... */int api, ...;/** The ASM API version implemented by this visitor. The value of this field must be one of {@link ... */AnnotationVisitor av, ...;/** The annotation visitor to which this visitor must delegate method calls. May be {@literal ... *//** Constructs a new {@link AnnotationVisitor}. ... */Opcodes.ASM9Opcodes.ASM8Opcodes.ASM7Opcodes.ASM6Opcodes.ASM5Opcodes.ASM4Opcodes.ASM10_EXPERIMENTALthis.apithis.av/** Visits a primitive value of the annotation. ... */visit(...)/** Visits an enumeration value of the annotation. ... */visitEnum(...)/** Visits a nested annotation value of the annotation. ... */visitAnnotation(...)/** Visits an array value of the annotation. Note that arrays of primitive values (such as byte, ... *//** Visits the end of the annotation. */visitEnd(...)// ASM: a very small and fast Java bytecode manipulation framework// Copyright (c) 2000-2011 INRIA, France Telecom// All rights reserved.// Redistribution and use in source and binary forms, with or without// modification, are permitted provided that the following conditions// are met:// 1. Redistributions of source code must retain the above copyright//    notice, this list of conditions and the following disclaimer.// 2. Redistributions in binary form must reproduce the above copyright//    notice, this list of conditions and the following disclaimer in the//    documentation and/or other materials provided with the distribution.// 3. Neither the name of the copyright holders nor the names of its//    contributors may be used to endorse or promote products derived from//    this software without specific prior written permission.// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF// THE POSSIBILITY OF SUCH DAMAGE.// SPRING PATCH: no preview mode check for ASM 9 experimental/** An {@link AnnotationVisitor} that generates a corresponding 'annotation' or 'type_annotation' ... */SymbolTable symbolTable, ...;/** Where the constants used in this AnnotationWriter must be stored. */boolean useNamedValues, ...;/** Whether values are named or not. AnnotationWriter instances used for annotation default and ... */ByteVector annotation, ...;/** The 'annotation' or 'type_annotation' JVMS structure corresponding to the annotation values ... */int numElementValuePairsOffset, ...;/** The offset in {@link #annotation} where {@link #numElementValuePairs} must be stored (or -1 for ... */int numElementValuePairs, ...;/** The number of element value pairs visited so far. */AnnotationWriter previousAnnotation, ...;/** The previous AnnotationWriter. This field is used to store the list of annotations of a ... */AnnotationWriter nextAnnotation, ...;/** The next AnnotationWriter. This field is used to store the list of annotations of a ... *//** Constructs a new {@link AnnotationWriter}. ... */// -----------------------------------------------------------------------------------------------// Constructors and factoriesthis.symbolTablethis.useNamedValuesthis.numElementValuePairsOffsetannotation.lengththis.previousAnnotationpreviousAnnotation.nextAnnotation/** Creates a new {@link AnnotationWriter} using named values. ... */ByteVector annotationnew ByteVector(...)putShort(...)addConstantUtf8(...)new AnnotationWriter(...)ByteVector typeAnnotationputTarget(...)// Implementation of the AnnotationVisitor abstract classput12(...)addConstantInteger(...).indexaddConstantInteger(...)int booleanValuecharValue(...)byte[] byteArraybyteArray.lengthbyte byteValueboolean[] booleanArraybooleanArray.lengthboolean booleanValueshort[] shortArrayshortArray.lengthshort shortValuechar[] charArraycharArray.lengthchar charValueint[] intArrayintArray.lengthint intValuelong[] longArraylongArray.lengthlong longValueaddConstantLong(...).indexaddConstantLong(...)float[] floatArrayfloatArray.lengthfloat floatValueaddConstantFloat(...).indexaddConstantFloat(...)double[] doubleArraydoubleArray.lengthdouble doubleValueaddConstantDouble(...).indexaddConstantDouble(...)Symbol symboladdConstant(...)symbol.indexsymbol.tagbyte[] dataannotation.data/** Returns the size of a Runtime[In]Visible[Type]Annotations attribute containing this annotation ... */// Utility methodsint attributeSizeAnnotationWriter annotationWriterannotationWriter.annotation.lengthannotationWriter.annotationannotationWriter.previousAnnotation/** Returns the size of the Runtime[In]Visible[Type]Annotations attributes containing the given ... */computeAnnotationsSize(...)Constants.RUNTIME_VISIBLE_ANNOTATIONSConstants.RUNTIME_INVISIBLE_ANNOTATIONSConstants.RUNTIME_VISIBLE_TYPE_ANNOTATIONSConstants.RUNTIME_INVISIBLE_TYPE_ANNOTATIONS/** Puts a Runtime[In]Visible[Type]Annotations attribute containing this annotations and all its ... */int attributeLengthint numAnnotationsAnnotationWriter firstAnnotationputInt(...)putByteArray(...)annotationWriter.annotation.dataannotationWriter.nextAnnotation/** Puts the Runtime[In]Visible[Type]Annotations attributes containing the given annotations and ... */putAnnotations(...)/** Returns the size of a Runtime[In]VisibleParameterAnnotations attribute containing all the ... *//** Puts a Runtime[In]VisibleParameterAnnotations attribute containing all the annotation lists ... */putByte(...)/* latest api = */// By hypothesis, num_element_value_pairs is stored in the last unsigned short of 'annotation'.// Create a ByteVector to hold an 'annotation' JVMS structure.// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.16.// Write type_index and reserve space for num_element_value_pairs./* useNamedValues = */// Create a ByteVector to hold a 'type_annotation' JVMS structure.// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.20.// Write target_type, target_info, and target_path.// Case of an element_value with a const_value_index, class_info_index or array_index field.// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.16.1.// Case of an element_value with an enum_const_value field.// Case of an element_value with an annotation_value field.// Write tag and type_index, and reserve 2 bytes for num_element_value_pairs.// Case of an element_value with an array_value field.// https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.16.1// Write tag, and reserve 2 bytes for num_values. Here we take advantage of the fact that the// end of an element_value of array type is similar to the end of an 'annotation' structure: an// unsigned short num_values followed by num_values element_value, versus an unsigned short// num_element_value_pairs, followed by num_element_value_pairs { element_name_index,// element_value } tuples. This allows us to use an AnnotationWriter with unnamed values to// visit the array elements. Its num_element_value_pairs will correspond to the number of array// elements and will be stored in what is in fact num_values.// The attribute_name_index, attribute_length and num_annotations fields use 8 bytes.// For num_annotations.// In case the user forgot to call visitEnd().// Note: attributeName is added to the constant pool by the call to computeAnnotationsSize// below. This assumes that there is at least one non-null element in the annotationWriters// sub-array (which is ensured by the lazy instantiation of this array in MethodWriter).// The attribute_name_index, attribute_length and num_parameters fields use 7 bytes, and each// element of the parameter_annotations array uses 2 bytes for its num_annotations field.// The num_parameters field uses 1 byte, and each element of the parameter_annotations array// uses 2 bytes for its num_annotations field.// In case user the forgot to call visitEnd()./** A non standard class, field, method or Code attribute, as defined in the Java Virtual Machine ... *//** The type of this attribute, also called its name in the JVMS. */...[] content, ...;/** The raw content of this attribute, only used for unknown attributes (see {@link #isUnknown()}). ... */Attribute nextAttribute, ...;/** The next attribute in this attribute list (Attribute instances can be linked via this field to ... *//** Constructs a new empty attribute. ... *//** Returns {@literal true} if this type of attribute is unknown. This means that the attribute ... *//** Returns {@literal true} if this type of attribute is a Code attribute. ... *//** Returns the labels corresponding to this attribute. ... */new Label[]/** Reads a {@link #type} attribute. This method must return a <i>new</i> {@link Attribute} object, ... */Attribute attributeattribute.contentclassReader.classFileBuffer/** Returns the byte array form of the content of this attribute. The 6 header bytes ... *//** Returns the number of attributes of the attribute list that begins with this attribute. ... */attribute.nextAttribute/** Returns the total size in bytes of all the attributes in the attribute list that begins with ... */byte[] codeint codeLengthint maxStackint maxLocalscomputeAttributesSize(...)ClassWriter classWritersymbolTable.classWriterattribute.typewrite(...).length/** Returns the total size in bytes of all the attributes that correspond to the given field, ... */Opcodes.ACC_SYNTHETICgetMajorVersion(...)Opcodes.V1_5Constants.SYNTHETICConstants.SIGNATUREOpcodes.ACC_DEPRECATEDConstants.DEPRECATED/** Puts all the attributes of the attribute list that begins with this attribute, in the given ... */putAttributes(...)ByteVector attributeContentattributeContent.lengthattributeContent.data/** Puts all the attributes that correspond to the given field, method or class access flags and ... *//** A set of attribute prototypes (attributes with the same type are considered equal). */new Attribute[]int SIZE_INCREMENT, ...;int size, ...;...[] data, ...;Attribute[] result...[...].typedata.lengthAttribute[] newData// Before Java 1.5, synthetic fields are represented with a Synthetic attribute.// Synthetic attributes always use 6 bytes.// Signature attributes always use 8 bytes.// ACC_DEPRECATED is ASM specific, the ClassFile format uses a Deprecated attribute instead.// Deprecated attributes always use 6 bytes.// Put attribute_name_index and attribute_length./** A dynamically extensible vector of bytes. This class is roughly equivalent to a DataOutputStream ... *//** The content of this vector. Only the first {@link #length} bytes contain real data. */int length, ...;/** The actual number of bytes in this vector. *//** Constructs a new {@link ByteVector} with a default initial capacity. *//** Constructs a new {@link ByteVector} with the given initial capacity. ... *//** Constructs a new {@link ByteVector} from the given initial data. ... */this.length/** Puts a byte into this byte vector. The byte vector is automatically enlarged if necessary. ... */int currentLengthenlarge(...)/** Puts two bytes into this byte vector. The byte vector is automatically enlarged if necessary. ... */byte[] currentData/** Puts a short into this byte vector. The byte vector is automatically enlarged if necessary. ... *//** Puts a byte and a short into this byte vector. The byte vector is automatically enlarged if ... *//** Puts two bytes and a short into this byte vector. The byte vector is automatically enlarged if ... *//** Puts an int into this byte vector. The byte vector is automatically enlarged if necessary. ... *//** Puts one byte and two shorts into this byte vector. The byte vector is automatically enlarged ... *//** Puts a long into this byte vector. The byte vector is automatically enlarged if necessary. ... */// DontCheck(AbbreviationAsWordInName): can't be renamed (for backward binary compatibility)./** Puts an UTF8 string into this byte vector. The byte vector is automatically enlarged if ... */int charLengthencodeUtf8(...)int byteLengthint byteLengthOffset... >> .../** Puts an array of bytes into this byte vector. The byte vector is automatically enlarged if ... *//** Enlarges this byte vector so that it can receive 'size' more bytes. ... */int doubleCapacityint minimalCapacitybyte[] newData// Optimistic algorithm: instead of computing the byte length and then serializing the string// (which requires two loops), we assume the byte length is equal to char length (which is the// most frequent case), and we start serializing the string right away. During the// serialization, if we find that this assumption is wrong, we continue with the general method.// Compute where 'byteLength' must be stored in 'data', and store it at this location./** A parser to make a {@link ClassVisitor} visit a ClassFile structure, as defined in the Java ... */int SKIP_CODE, ...;/** A flag to skip the Code attributes. If this flag is set the Code attributes are neither parsed ... */int SKIP_DEBUG, ...;/** A flag to skip the SourceFile, SourceDebugExtension, LocalVariableTable, ... */int SKIP_FRAMES, ...;/** A flag to skip the StackMap and StackMapTable attributes. If this flag is set these attributes ... */int EXPAND_FRAMES, ...;/** A flag to expand the stack map frames. By default stack map frames are visited in their ... */int EXPAND_ASM_INSNS, ...;/** A flag to expand the ASM specific instructions into an equivalent sequence of standard bytecode ... */int INPUT_STREAM_DATA_CHUNK_SIZE, ...;/** The size of the temporary byte array used to read class input streams chunk by chunk. */...[] b, ...;/** A byte array containing the JVMS ClassFile structure to be parsed. ... */int header, ...;/** The offset in bytes of the ClassFile's access_flags field. */...[] classFileBuffer, ...;/** A byte array containing the JVMS ClassFile structure to be parsed. <i>The content of this array ... */...[] cpInfoOffsets, ...;/** The offset in bytes, in {@link #classFileBuffer}, of each cp_info entry of the ClassFile's ... */...[] constantUtf8Values, ...;/** The String objects corresponding to the CONSTANT_Utf8 constant pool items. This cache avoids ... */...[] constantDynamicValues, ...;/** The ConstantDynamic objects corresponding to the CONSTANT_Dynamic constant pool items. This ... */...[] bootstrapMethodOffsets, ...;/** The start offsets in {@link #classFileBuffer} of each element of the bootstrap_methods array ... */int maxStringLength, ...;/** A conservative estimate of the maximum length of the strings contained in the constant pool of ... *//** Constructs a new {@link ClassReader} object. ... */// ConstructorsclassFile.length/** Constructs a new {@link ClassReader} object. <i>This internal constructor must not be exposed ... */int constantPoolCountreadUnsignedShort(...)int currentCpInfoIndexint currentCpInfoOffsetint currentMaxStringLengthboolean hasBootstrapMethodsboolean hasConstantDynamicthis.classFileBufferreadShort(...)Opcodes.V17int cpInfoSizeSymbol.CONSTANT_FIELDREF_TAGSymbol.CONSTANT_METHODREF_TAGSymbol.CONSTANT_INTERFACE_METHODREF_TAGSymbol.CONSTANT_INTEGER_TAGSymbol.CONSTANT_FLOAT_TAGSymbol.CONSTANT_NAME_AND_TYPE_TAGSymbol.CONSTANT_DYNAMIC_TAGSymbol.CONSTANT_INVOKE_DYNAMIC_TAGSymbol.CONSTANT_LONG_TAGSymbol.CONSTANT_DOUBLE_TAGSymbol.CONSTANT_UTF8_TAGSymbol.CONSTANT_METHOD_HANDLE_TAGSymbol.CONSTANT_CLASS_TAGSymbol.CONSTANT_STRING_TAGSymbol.CONSTANT_METHOD_TYPE_TAGSymbol.CONSTANT_PACKAGE_TAGSymbol.CONSTANT_MODULE_TAGnew ConstantDynamic[]readBootstrapMethodsAttribute(...)readStream(...)getSystemResourceAsStream(...)/** Reads the given input stream and returns its content as a byte array. ... */int bytesReadflush(...)/** Returns the class's access flags (see {@link Opcodes}). This value may not reflect Deprecated ... */// Accessors/** Returns the internal name of the class (see {@link Type#getInternalName()}). ... */readClass(...)new char[]/** Returns the internal of name of the super class (see {@link Type#getInternalName()}). For ... *//** Returns the internal names of the implemented interfaces (see {@link Type#getInternalName()}). ... */int currentOffsetint interfacesCountString[] interfaceschar[] charBuffer/** Makes the given visitor visit the JVMS ClassFile structure passed to the constructor of this ... */// Public methodsnew Context(...)context.charBufferint accessFlagsString thisClassString superClassint innerClassesOffsetint enclosingMethodOffsetString signatureString sourceFileString sourceDebugExtensionint runtimeVisibleAnnotationsOffsetint runtimeInvisibleAnnotationsOffsetint runtimeVisibleTypeAnnotationsOffsetint runtimeInvisibleTypeAnnotationsOffsetint moduleOffsetint modulePackagesOffsetString moduleMainClassString nestHostClassint nestMembersOffsetint permittedSubclassesOffsetint recordOffsetAttribute attributesint currentAttributeOffsetgetFirstAttributeOffset(...)int fieldsCountint methodsCountcontext.attributePrototypescontext.parsingOptions--...readUTF8(...)readInt(...)Constants.SOURCE_FILEConstants.INNER_CLASSESConstants.ENCLOSING_METHODConstants.NEST_HOSTConstants.NEST_MEMBERSConstants.PERMITTED_SUBCLASSESConstants.SOURCE_DEBUG_EXTENSIONclassFileBuffer.lengthreadUtf(...)Constants.RECORDOpcodes.ACC_RECORDConstants.MODULEConstants.MODULE_MAIN_CLASSConstants.MODULE_PACKAGESConstants.BOOTSTRAP_METHODSreadAttribute(...)visitSource(...)readModuleAttributes(...)visitNestHost(...)int methodIndexvisitOuterClass(...)int currentAnnotationOffsetString annotationDescriptorreadElementValues(...)readTypeAnnotationTarget(...)visitTypeAnnotation(...)context.currentTypeAnnotationTargetcontext.currentTypeAnnotationTargetPathAttribute nextAttributeattributes.nextAttributevisitAttribute(...)int numberOfNestMembersint currentNestMemberOffsetvisitNestMember(...)int numberOfPermittedSubclassesint currentPermittedSubclassesOffsetvisitPermittedSubclass(...)int numberOfClassesint currentClassesOffsetvisitInnerClass(...)int recordComponentsCountreadRecordComponent(...)readField(...)readMethod(...)/** Reads the Module, ModulePackages and ModuleMainClass attributes and visit them. ... */// ----------------------------------------------------------------------------------------------// Methods to parse modules, fields and methodschar[] bufferString moduleNamereadModule(...)int moduleFlagsString moduleVersionModuleVisitor moduleVisitorvisitModule(...)int requiresCountint exportsCountint opensCountint usesCountint providesCountvisitMainClass(...)int packageCountint currentPackageOffsetvisitPackage(...)readPackage(...)String requiresint requiresFlagsString requiresVersionvisitRequire(...)String exportsint exportsFlagsint exportsToCountString[] exportsTovisitExport(...)String opensint opensFlagsint opensToCountString[] opensTovisitOpen(...)visitUse(...)String providesint providesWithCountString[] providesWithvisitProvide(...)/** Reads a record component and visit it. ... */int attributesCountRecordComponentVisitor recordComponentVisitorvisitRecordComponent(...)/** Reads a JVMS field_info structure and makes the given visitor visit it. ... */Object constantValueFieldVisitor fieldVisitorvisitField(...)Constants.CONSTANT_VALUEint constantvalueIndexreadConst(...)/** Reads a JVMS method_info structure and makes the given visitor visit it. ... */int codeOffsetint exceptionsOffsetString[] exceptionsint signatureIndexint runtimeVisibleParameterAnnotationsOffsetint runtimeInvisibleParameterAnnotationsOffsetint annotationDefaultOffsetint methodParametersOffsetMethodVisitor methodVisitorvisitMethod(...)context.currentMethodAccessFlagscontext.currentMethodNamecontext.currentMethodDescriptorConstants.CODEConstants.EXCEPTIONSint currentExceptionOffsetexceptions.lengthConstants.ANNOTATION_DEFAULTConstants.RUNTIME_VISIBLE_PARAMETER_ANNOTATIONSConstants.RUNTIME_INVISIBLE_PARAMETER_ANNOTATIONSConstants.METHOD_PARAMETERSMethodWriter methodWritercanCopyMethodAttributes(...)setMethodAttributesSource(...)int parametersCountreadByte(...)int currentParameterOffsetvisitParameter(...)AnnotationVisitor annotationVisitorvisitAnnotationDefault(...)readElementValue(...)readParameterAnnotations(...)visitCode(...)readCode(...)/** Reads a JVMS 'Code' attribute and makes the given visitor visit it. ... */// Methods to parse a Code attributebyte[] classBufferint bytecodeStartOffsetint bytecodeEndOffsetLabel[] labelscontext.currentMethodLabelsint exceptionTableLengthint stackMapFrameOffsetint stackMapTableEndOffsetboolean compressedFramesint localVariableTableOffsetint localVariableTypeTableOffsetint[] visibleTypeAnnotationOffsetsint[] invisibleTypeAnnotationOffsetsboolean expandFramesint currentVisibleTypeAnnotationIndexint currentVisibleTypeAnnotationBytecodeOffsetgetTypeAnnotationBytecodeOffset(...)int currentInvisibleTypeAnnotationIndexint currentInvisibleTypeAnnotationBytecodeOffsetboolean insertFrameint wideJumpOpcodeDeltaConstants.WIDE_JUMP_OPCODE_DELTAint bytecodeOffsetint opcodeint numTableEntriesint numSwitchCasesOpcodes.NOPOpcodes.ACONST_NULLOpcodes.ICONST_M1Opcodes.ICONST_0Opcodes.ICONST_1Opcodes.ICONST_2Opcodes.ICONST_3Opcodes.ICONST_4Opcodes.ICONST_5Opcodes.LCONST_0Opcodes.LCONST_1Opcodes.FCONST_0Opcodes.FCONST_1Opcodes.FCONST_2Opcodes.DCONST_0Opcodes.DCONST_1Opcodes.IALOADOpcodes.LALOADOpcodes.FALOADOpcodes.DALOADOpcodes.AALOADOpcodes.BALOADOpcodes.CALOADOpcodes.SALOADOpcodes.IASTOREOpcodes.LASTOREOpcodes.FASTOREOpcodes.DASTOREOpcodes.AASTOREOpcodes.BASTOREOpcodes.CASTOREOpcodes.SASTOREOpcodes.POPOpcodes.POP2Opcodes.DUPOpcodes.DUP_X1Opcodes.DUP_X2Opcodes.DUP2Opcodes.DUP2_X1Opcodes.DUP2_X2Opcodes.SWAPOpcodes.IADDOpcodes.LADDOpcodes.FADDOpcodes.DADDOpcodes.ISUBOpcodes.LSUBOpcodes.FSUBOpcodes.DSUBOpcodes.IMULOpcodes.LMULOpcodes.FMULOpcodes.DMULOpcodes.IDIVOpcodes.LDIVOpcodes.FDIVOpcodes.DDIVOpcodes.IREMOpcodes.LREMOpcodes.FREMOpcodes.DREMOpcodes.INEGOpcodes.LNEGOpcodes.FNEGOpcodes.DNEGOpcodes.ISHLOpcodes.LSHLOpcodes.ISHROpcodes.LSHROpcodes.IUSHROpcodes.LUSHROpcodes.IANDOpcodes.LANDOpcodes.IOROpcodes.LOROpcodes.IXOROpcodes.LXOROpcodes.I2LOpcodes.I2FOpcodes.I2DOpcodes.L2IOpcodes.L2FOpcodes.L2DOpcodes.F2IOpcodes.F2LOpcodes.F2DOpcodes.D2IOpcodes.D2LOpcodes.D2FOpcodes.I2BOpcodes.I2COpcodes.I2SOpcodes.LCMPOpcodes.FCMPLOpcodes.FCMPGOpcodes.DCMPLOpcodes.DCMPGOpcodes.IRETURNOpcodes.LRETURNOpcodes.FRETURNOpcodes.DRETURNOpcodes.ARETURNOpcodes.RETURNOpcodes.ARRAYLENGTHOpcodes.ATHROWOpcodes.MONITORENTEROpcodes.MONITOREXITConstants.ILOAD_0Constants.ILOAD_1Constants.ILOAD_2Constants.ILOAD_3Constants.LLOAD_0Constants.LLOAD_1Constants.LLOAD_2Constants.LLOAD_3Constants.FLOAD_0Constants.FLOAD_1Constants.FLOAD_2Constants.FLOAD_3Constants.DLOAD_0Constants.DLOAD_1Constants.DLOAD_2Constants.DLOAD_3Constants.ALOAD_0Constants.ALOAD_1Constants.ALOAD_2Constants.ALOAD_3Constants.ISTORE_0Constants.ISTORE_1Constants.ISTORE_2Constants.ISTORE_3Constants.LSTORE_0Constants.LSTORE_1Constants.LSTORE_2Constants.LSTORE_3Constants.FSTORE_0Constants.FSTORE_1Constants.FSTORE_2Constants.FSTORE_3Constants.DSTORE_0Constants.DSTORE_1Constants.DSTORE_2Constants.DSTORE_3Constants.ASTORE_0Constants.ASTORE_1Constants.ASTORE_2Constants.ASTORE_3Opcodes.IFEQOpcodes.IFNEOpcodes.IFLTOpcodes.IFGEOpcodes.IFGTOpcodes.IFLEOpcodes.IF_ICMPEQOpcodes.IF_ICMPNEOpcodes.IF_ICMPLTOpcodes.IF_ICMPGEOpcodes.IF_ICMPGTOpcodes.IF_ICMPLEOpcodes.IF_ACMPEQOpcodes.IF_ACMPNEOpcodes.GOTOOpcodes.JSROpcodes.IFNULLOpcodes.IFNONNULLcreateLabel(...)Constants.ASM_IFEQConstants.ASM_IFNEConstants.ASM_IFLTConstants.ASM_IFGEConstants.ASM_IFGTConstants.ASM_IFLEConstants.ASM_IF_ICMPEQConstants.ASM_IF_ICMPNEConstants.ASM_IF_ICMPLTConstants.ASM_IF_ICMPGEConstants.ASM_IF_ICMPGTConstants.ASM_IF_ICMPLEConstants.ASM_IF_ACMPEQConstants.ASM_IF_ACMPNEConstants.ASM_GOTOConstants.ASM_JSRConstants.ASM_IFNULLConstants.ASM_IFNONNULLConstants.GOTO_WConstants.JSR_WConstants.ASM_GOTO_WConstants.WIDEOpcodes.ILOADOpcodes.FLOADOpcodes.ALOADOpcodes.LLOADOpcodes.DLOADOpcodes.ISTOREOpcodes.FSTOREOpcodes.ASTOREOpcodes.LSTOREOpcodes.DSTOREOpcodes.RETOpcodes.IINCOpcodes.TABLESWITCHOpcodes.LOOKUPSWITCHOpcodes.BIPUSHOpcodes.NEWARRAYOpcodes.LDCOpcodes.SIPUSHConstants.LDC_WConstants.LDC2_WOpcodes.GETSTATICOpcodes.PUTSTATICOpcodes.GETFIELDOpcodes.PUTFIELDOpcodes.INVOKEVIRTUALOpcodes.INVOKESPECIALOpcodes.INVOKESTATICOpcodes.NEWOpcodes.ANEWARRAYOpcodes.CHECKCASTOpcodes.INSTANCEOFOpcodes.INVOKEINTERFACEOpcodes.INVOKEDYNAMICOpcodes.MULTIANEWARRAYLabel startLabel endLabel handlerString catchTypevisitTryCatchBlock(...)Constants.LOCAL_VARIABLE_TABLEint currentLocalVariableTableOffsetint localVariableTableLengthint startPccreateDebugLabel(...)Constants.LOCAL_VARIABLE_TYPE_TABLEConstants.LINE_NUMBER_TABLEint currentLineNumberTableOffsetint lineNumberTableLengthint lineNumberaddLineNumber(...)readTypeAnnotations(...)Constants.STACK_MAP_TABLEcontext.currentFrameOffsetcontext.currentFrameTypecontext.currentFrameLocalCountcontext.currentFrameLocalCountDeltacontext.currentFrameLocalTypescontext.currentFrameStackCountcontext.currentFrameStackTypescomputeImplicitFrame(...)Frame.ITEM_UNINITIALIZEDint potentialBytecodeOffsetvisitFrame(...)Opcodes.F_NEWint currentBytecodeOffsetLabel currentLabelreadStackMapFrame(...)Constants.F_INSERTvisitInsn(...)...-=...visitVarInsn(...)visitJumpInsn(...)Label targetConstants.ASM_OPCODE_DELTAConstants.ASM_IFNULL_OPCODE_DELTALabel endifvisitIincInsn(...)Label defaultLabelint lowint highLabel[] tabletable.lengthvisitTableSwitchInsn(...)int numPairsint[] keysLabel[] valuesvisitLookupSwitchInsn(...)visitIntInsn(...)int cpInfoOffsetint nameAndTypeCpInfoOffsetString ownervisitFieldInsn(...)boolean isInterfaceint bootstrapMethodOffsetHandle handleObject[] bootstrapMethodArgumentsbootstrapMethodArguments.lengthvisitInvokeDynamicInsn(...)visitTypeInsn(...)visitMultiANewArrayInsn(...)visibleTypeAnnotationOffsets.lengthvisitInsnAnnotation(...)invisibleTypeAnnotationOffsets.lengthvisitLabel(...)int[] typeTableint typeTableIndextypeTable.lengthvisitLocalVariable(...)int typeAnnotationOffsetint targetTypeTypeReference.LOCAL_VARIABLETypeReference.RESOURCE_VARIABLEvisitLocalVariableAnnotation(...)context.currentLocalVariableAnnotationRangeStartscontext.currentLocalVariableAnnotationRangeEndscontext.currentLocalVariableAnnotationRangeIndicesvisitMaxs(...)/** Returns the label corresponding to the given bytecode offset. The default implementation of ... */labels.lengthnew Label(...)/** Creates a label without the {@link Label#FLAG_DEBUG_ONLY} flag set, for the given bytecode ... */Label labelreadLabel(...)label.flagsLabel.FLAG_DEBUG_ONLY/** Creates a label with the {@link Label#FLAG_DEBUG_ONLY} flag set, if there is no already ... */readLabel(...).flags/** Parses a Runtime[In]VisibleTypeAnnotations attribute to find the offset of each type_annotation ... */// Methods to parse annotations, type annotations and parameter annotationsint[] typeAnnotationsOffsetstypeAnnotationsOffsets.lengthint pathLengthint tableLengthTypeReference.CASTTypeReference.CONSTRUCTOR_INVOCATION_TYPE_ARGUMENTTypeReference.METHOD_INVOCATION_TYPE_ARGUMENTTypeReference.CONSTRUCTOR_REFERENCE_TYPE_ARGUMENTTypeReference.METHOD_REFERENCE_TYPE_ARGUMENTTypeReference.CLASS_EXTENDSTypeReference.CLASS_TYPE_PARAMETER_BOUNDTypeReference.METHOD_TYPE_PARAMETER_BOUNDTypeReference.THROWSTypeReference.EXCEPTION_PARAMETERTypeReference.INSTANCEOFTypeReference.NEWTypeReference.CONSTRUCTOR_REFERENCETypeReference.METHOD_REFERENCETypeReference.CLASS_TYPE_PARAMETERTypeReference.METHOD_TYPE_PARAMETERTypeReference.METHOD_FORMAL_PARAMETERTypeReference.FIELDTypeReference.METHOD_RETURNTypeReference.METHOD_RECEIVERTypePath pathnew TypePath(...)visitTryCatchAnnotation(...)/** Returns the bytecode offset corresponding to the specified JVMS 'type_annotation' structure, or ... */typeAnnotationOffsets.length/** Parses the header of a JVMS type_annotation structure to extract its target_type, target_info ... *//** Reads a Runtime[In]VisibleParameterAnnotations attribute and makes the given visitor visit it. ... */int numParametersvisitAnnotableParameterCount(...)visitParameterAnnotation(...)/** Reads the element values of a JVMS 'annotation' structure and makes the given visitor visit ... */int numElementValuePairs/** Reads a JVMS 'element_value' structure and makes the given visitor visit it. ... */int numValuesbyte[] byteValuesboolean[] booleanValuesnew boolean[]short[] shortValuesnew short[]char[] charValuesint[] intValueslong[] longValuesnew long[]float[] floatValuesnew float[]double[] doubleValuesnew double[]readLong(...)intBitsToFloat(...)longBitsToDouble(...)/** Computes the implicit frame of the method currently being parsed (as defined in the given ... */// Methods to parse stack map framesString methodDescriptorObject[] localsint numLocalint currentMethodDescritorOffsetOpcodes.ACC_STATICOpcodes.UNINITIALIZED_THISint currentArgumentDescriptorStartOffsetOpcodes.INTEGEROpcodes.FLOATOpcodes.LONGOpcodes.DOUBLE/** Reads a JVMS 'stack_map_frame' structure and stores the result in the given {@link Context} ... */int frameTypeint offsetDeltaFrame.FULL_FRAMEFrame.SAME_LOCALS_1_STACK_ITEM_FRAMEOpcodes.F_SAMEFrame.RESERVEDreadVerificationTypeInfo(...)Opcodes.F_SAME1Frame.SAME_LOCALS_1_STACK_ITEM_FRAME_EXTENDEDFrame.CHOP_FRAMEFrame.SAME_FRAME_EXTENDEDOpcodes.F_CHOPint localint kOpcodes.F_APPENDint numberOfLocalsint numberOfStackItemsOpcodes.F_FULLint stack/** Reads a JVMS 'verification_type_info' structure and stores it at the given index in the given ... */int tagFrame.ITEM_TOPOpcodes.TOPFrame.ITEM_INTEGERFrame.ITEM_FLOATFrame.ITEM_DOUBLEFrame.ITEM_LONGFrame.ITEM_NULLOpcodes.NULLFrame.ITEM_UNINITIALIZED_THISFrame.ITEM_OBJECT/** Returns the offset in {@link #classFileBuffer} of the first ClassFile's 'attributes' array ... */// Methods to parse attributes/** Reads the BootstrapMethods attribute to compute the offset of each bootstrap method. ... */int[] currentBootstrapMethodOffsetsint currentBootstrapMethodOffsetcurrentBootstrapMethodOffsets.length/** Reads a non standard JVMS 'attribute' structure in {@link #classFileBuffer}. ... */Attribute attributePrototypeattributePrototype.type/** Returns the number of entries in the class's constant pool table. ... */// Utility methods: low level parsingcpInfoOffsets.length/** Returns the start offset in this {@link ClassReader} of a JVMS 'cp_info' structure (i.e. a ... *//** Returns a conservative estimate of the maximum length of the strings contained in the class's ... *//** Reads a byte value in this {@link ClassReader}. <i>This method is intended for {@link ... *//** Reads an unsigned short value in this {@link ClassReader}. <i>This method is intended for ... *//** Reads a signed short value in this {@link ClassReader}. <i>This method is intended for {@link ... *//** Reads a signed int value in this {@link ClassReader}. <i>This method is intended for {@link ... *//** Reads a signed long value in this {@link ClassReader}. <i>This method is intended for {@link ... */long l1long l0/** Reads a CONSTANT_Utf8 constant pool entry in this {@link ClassReader}. <i>This method is ... */int constantPoolEntryIndex/** Reads a CONSTANT_Utf8 constant pool entry in {@link #classFileBuffer}. ... *//** Reads an UTF8 string in {@link #classFileBuffer}. ... */int endOffsetint strLengthint currentByte/** Reads a CONSTANT_Class, CONSTANT_String, CONSTANT_MethodType, CONSTANT_Module or ... *//** Reads a CONSTANT_Class constant pool entry in this {@link ClassReader}. <i>This method is ... */readStringish(...)/** Reads a CONSTANT_Module constant pool entry in this {@link ClassReader}. <i>This method is ... *//** Reads a CONSTANT_Package constant pool entry in this {@link ClassReader}. <i>This method is ... *//** Reads a CONSTANT_Dynamic constant pool entry in {@link #classFileBuffer}. ... */ConstantDynamic constantDynamicnew ConstantDynamic(...)/** Reads a numeric or string constant pool entry in this {@link ClassReader}. <i>This method is ... */int referenceKindint referenceCpInfoOffsetgetMethodType(...)new Handle(...)readConstantDynamic(...)// DontCheck(MemberName): can't be renamed (for backward binary compatibility).// NOPMD(UnusedFormalParameter) used for backward compatibility./* checkClassVersion = */// Check the class' major_version. This field is after the magic and minor_version fields, which// use 4 and 2 bytes respectively.// Create the constant pool arrays. The constant_pool_count field is after the magic,// minor_version and major_version fields, which use 4, 2 and 2 bytes respectively.// Compute the offset of each constant pool entry, as well as a conservative estimate of the// maximum length of the constant pool strings. The first constant pool entry is after the// magic, minor_version, major_version and constant_pool_count fields, which use 4, 2, 2 and 2// bytes respectively.// The offset of the other entries depend on the total size of all the previous entries.// The size in bytes of this CONSTANT_Utf8 structure provides a conservative estimate// of the length in characters of the corresponding string, and is much cheaper to// compute than this exact length.// The Classfile's access_flags field is just after the last constant pool entry.// Allocate the cache of ConstantDynamic values, if there is at least one.// Read the BootstrapMethods attribute, if any (only get the offset of each method).// this_class is just after the access_flags field (using 2 bytes).// super_class is after the access_flags and this_class fields (2 bytes each).// interfaces_count is after the access_flags, this_class and super_class fields (2 bytes each).// Read the access_flags, this_class, super_class, interface_count and interfaces fields.// Read the class attributes (the variables are ordered as in Section 4.7 of the JVMS).// Attribute offsets exclude the attribute_name_index and attribute_length fields.// - The offset of the InnerClasses attribute, or 0.// - The offset of the EnclosingMethod attribute, or 0.// - The string corresponding to the Signature attribute, or null.// - The string corresponding to the SourceFile attribute, or null.// - The string corresponding to the SourceDebugExtension attribute, or null.// - The offset of the RuntimeVisibleAnnotations attribute, or 0.// - The offset of the RuntimeInvisibleAnnotations attribute, or 0.// - The offset of the RuntimeVisibleTypeAnnotations attribute, or 0.// - The offset of the RuntimeInvisibleTypeAnnotations attribute, or 0.// - The offset of the Module attribute, or 0.// - The offset of the ModulePackages attribute, or 0.// - The string corresponding to the ModuleMainClass attribute, or null.// - The string corresponding to the NestHost attribute, or null.// - The offset of the NestMembers attribute, or 0.// - The offset of the PermittedSubclasses attribute, or 0// - The offset of the Record attribute, or 0.// - The non standard attributes (linked with their {@link Attribute#nextAttribute} field).//   This list in the <i>reverse order</i> or their order in the ClassFile structure.// Read the attribute_info's attribute_name and attribute_length fields.// The tests are sorted in decreasing frequency order (based on frequencies observed on// typical classes).// The BootstrapMethods attribute is read in the constructor.// Visit the class declaration. The minor_version and major_version fields start 6 bytes before// the first constant pool entry, which itself starts at cpInfoOffsets[1] - 1 (by definition).// Visit the SourceFile and SourceDebugExtenstion attributes.// Visit the Module, ModulePackages and ModuleMainClass attributes.// Visit the NestHost attribute.// Visit the EnclosingMethod attribute.// Visit the RuntimeVisibleAnnotations attribute.// Parse the type_index field.// Parse num_element_value_pairs and element_value_pairs and visit these values./* visible = *//* named = */// Visit the RuntimeInvisibleAnnotations attribute.// Visit the RuntimeVisibleTypeAnnotations attribute.// Parse the target_type, target_info and target_path fields.// Visit the RuntimeInvisibleTypeAnnotations attribute.// Visit the non standard attributes.// Copy and reset the nextAttribute field so that it can also be used in ClassWriter.// Visit the NestedMembers attribute.// Visit the PermittedSubclasses attribute.// Visit the InnerClasses attribute.// Visit Record components.// Visit the fields and methods.// Visit the end of the class.// Read the module_name_index, module_flags and module_version_index fields and visit them.// Visit the ModuleMainClass attribute.// Visit the ModulePackages attribute.// Read the 'requires_count' and 'requires' fields.// Read the requires_index, requires_flags and requires_version fields and visit them.// Read the 'exports_count' and 'exports' fields.// Read the exports_index, exports_flags, exports_to_count and exports_to_index fields// and visit them.// Reads the 'opens_count' and 'opens' fields.// Read the opens_index, opens_flags, opens_to_count and opens_to_index fields and visit them.// Read the 'uses_count' and 'uses' fields.// Read the  'provides_count' and 'provides' fields.// Read the provides_index, provides_with_count and provides_with_index fields and visit them.// Visit the end of the module attributes.// Read the record component attributes (the variables are ordered as in Section 4.7 of the// JVMS).// Copy and reset the nextAttribute field so that it can also be used in FieldWriter.// Visit the end of the field.// Read the access_flags, name_index and descriptor_index fields.// Read the field attributes (the variables are ordered as in Section 4.7 of the JVMS).// - The value corresponding to the ConstantValue attribute, or null.// Visit the field declaration.// Read the method attributes (the variables are ordered as in Section 4.7 of the JVMS).// - The offset of the Code attribute, or 0.// - The offset of the Exceptions attribute, or 0.// - The strings corresponding to the Exceptions attribute, or null.// - Whether the method has a Synthetic attribute.// - The constant pool index contained in the Signature attribute, or 0.// - The offset of the RuntimeVisibleParameterAnnotations attribute, or 0.// - The offset of the RuntimeInvisibleParameterAnnotations attribute, or 0.// - The offset of the AnnotationDefault attribute, or 0.// - The offset of the MethodParameters attribute, or 0.// Visit the method declaration.// If the returned MethodVisitor is in fact a MethodWriter, it means there is no method// adapter between the reader and the writer. In this case, it might be possible to copy// the method attributes directly into the writer. If so, return early without visiting// the content of these attributes.// Visit the MethodParameters attribute.// Read the name_index and access_flags fields and visit them.// Visit the AnnotationDefault attribute.// Visit the RuntimeVisibleParameterAnnotations attribute.// Visit the RuntimeInvisibleParameterAnnotations attribute.// Copy and reset the nextAttribute field so that it can also be used in MethodWriter.// Visit the Code attribute.// Visit the end of the method.// Read the max_stack, max_locals and code_length fields.// Read the bytecode 'code' array to create a label for each referenced instruction.// Skip 0 to 3 padding bytes.// Read the default label and the number of table entries.// Read the table labels.// Read the default label and the number of switch cases.// Read the switch labels.// Read the 'exception_table_length' and 'exception_table' field to create a label for each// referenced instruction, and to make methodVisitor visit the corresponding try catch blocks.// Read the Code attributes to create a label for each referenced instruction (the variables// are ordered as in Section 4.7 of the JVMS). Attribute offsets exclude the// attribute_name_index and attribute_length fields.// - The offset of the current 'stack_map_frame' in the StackMap[Table] attribute, or 0.// Initially, this is the offset of the first 'stack_map_frame' entry. Then this offset is// updated after each stack_map_frame is read.// - The end offset of the StackMap[Table] attribute, or 0.// - Whether the stack map frames are compressed (i.e. in a StackMapTable) or not.// - The offset of the LocalVariableTable attribute, or 0.// - The offset of the LocalVariableTypeTable attribute, or 0.// - The offset of each 'type_annotation' entry in the RuntimeVisibleTypeAnnotations// attribute, or null.// - The offset of each 'type_annotation' entry in the RuntimeInvisibleTypeAnnotations// Parse the attribute to find the corresponding (debug only) labels.// Skip the name_index, descriptor_index and index fields (2 bytes each).// Here we do not extract the labels corresponding to the attribute content. We assume they// are the same or a subset of those of the LocalVariableTable attribute.// Here we do not extract the labels corresponding to the attribute content. This would// require a full parsing of the attribute, which would need to be repeated when parsing// the bytecode instructions (see below). Instead, the content of the attribute is read one// type annotation at a time (i.e. after a type annotation has been visited, the next type// annotation is read), and the labels it contains are also extracted one annotation at a// time. This assumes that type annotations are ordered by increasing bytecode offset.// Same comment as above for the RuntimeVisibleTypeAnnotations attribute.// frame at a time (i.e. after a frame has been visited, the next frame is read), and the// labels it contains are also extracted one frame at a time. Thanks to the ordering of// frames, having only a "one frame lookahead" is not a problem, i.e. it is not possible to// see an offset smaller than the offset of the current instruction and for which no Label// exist. Except for UNINITIALIZED type offsets. We solve this by parsing the stack map// table without a full decoding (see below).// IMPORTANT! Here we assume that the frames are ordered, as in the StackMapTable attribute,// although this is not guaranteed by the attribute format. This allows an incremental// extraction of the labels corresponding to this attribute (see the comment above for the// StackMapTable attribute).// Initialize the context fields related to stack map frames, and generate the first// (implicit) stack map frame, if needed.// The bytecode offset of the first explicit frame is not offset_delta + 1 but only// offset_delta. Setting the implicit frame offset to -1 allows us to use of the// "offset_delta + 1" rule in all cases.// Find the labels for UNINITIALIZED frame types. Instead of decoding each element of the// stack map table, we look for 3 consecutive bytes that "look like" an UNINITIALIZED type// (tag ITEM_Uninitialized, offset within bytecode bounds, NEW instruction at this offset).// We may find false positives (i.e. not real UNINITIALIZED types), but this should be rare,// and the only consequence will be the creation of an unneeded label. This is better than// creating a label for each NEW instruction, and faster than fully decoding the whole stack// map table.// Expanding the ASM specific instructions can introduce F_INSERT frames, even if the method// does not currently have any frame. These inserted frames must be computed by simulating the// effect of the bytecode instructions, one by one, starting from the implicit first frame.// For this, MethodWriter needs to know maxLocals before the first instruction is visited. To// ensure this, we visit the implicit first frame here (passing only maxLocals - the rest is// computed in MethodWriter).// Visit the bytecode instructions. First, introduce state variables for the incremental parsing// of the type annotations.// Index of the next runtime visible type annotation to read (in the// visibleTypeAnnotationOffsets array).// The bytecode offset of the next runtime visible type annotation to read, or -1.// Index of the next runtime invisible type annotation to read (in the// invisibleTypeAnnotationOffsets array).// The bytecode offset of the next runtime invisible type annotation to read, or -1.// Whether a F_INSERT stack map frame must be inserted before the current instruction.// The delta to subtract from a goto_w or jsr_w opcode to get the corresponding goto or jsr// opcode, or 0 if goto_w and jsr_w must be left unchanged (i.e. when expanding ASM specific// instructions).// Visit the label and the line number(s) for this bytecode offset, if any.// Visit the stack map frame for this bytecode offset, if any.// If there is a stack map frame for this offset, make methodVisitor visit it, and read the// next stack map frame if there is one.// Since there is already a stack map frame for this bytecode offset, there is no need to// insert a new one.// Insert a stack map frame for this bytecode offset, if requested by setting insertFrame to// true during the previous iteration. The actual frame content is computed in MethodWriter.// Visit the instruction at this bytecode offset.// A forward jump with an offset > 32767. In this case we automatically replace ASM_GOTO// with GOTO_W, ASM_JSR with JSR_W and ASM_IFxxx <l> with IFNOTxxx <L> GOTO_W <l> L:...,// where IFNOTxxx is the "opposite" opcode of ASMS_IFxxx (e.g. IFNE for ASM_IFEQ) and// where <L> designates the instruction just after the GOTO_W.// First, change the ASM specific opcodes ASM_IFEQ ... ASM_JSR, ASM_IFNULL and// ASM_IFNONNULL to IFEQ ... JSR, IFNULL and IFNONNULL.// Replace GOTO with GOTO_W and JSR with JSR_W.// Compute the "opposite" of opcode. This can be done by flipping the least// significant bit for IFNULL and IFNONNULL, and similarly for IFEQ ... IF_ACMPEQ// (with a pre and post offset by 1).// endif designates the instruction just after GOTO_W, and is visited as part of the// next instruction. Since it is a jump target, we need to insert a frame here.// Replace ASM_GOTO_W with GOTO_W.// The instruction just after is a jump target (because ASM_GOTO_W is used in patterns// IFNOTxxx <L> ASM_GOTO_W <l> L:..., see MethodWriter), so we need to insert a frame// here.// Read the instruction.// Visit the runtime visible instruction annotations, if any.// Visit the runtime invisible instruction annotations, if any.// Visit LocalVariableTable and LocalVariableTypeTable attributes.// The (start_pc, index, signature_index) fields of each entry of the LocalVariableTypeTable.// Store the offset of 'signature_index', and the value of 'index' and 'start_pc'.// Visit the local variable type annotations of the RuntimeVisibleTypeAnnotations attribute.// Visit the local variable type annotations of the RuntimeInvisibleTypeAnnotations attribute.// Visit the max stack and max locals values.// SPRING PATCH: leniently handle offset mismatch// END OF PATCH// Read the num_annotations field and create an array to store the type_annotation offsets.// Parse the 'annotations' array field.// Parse the type_annotation's target_type and the target_info fields. The size of the// target_info field depends on the value of target_type.// A localvar_target has a variable size, which depends on the value of their table_length// field. It also references bytecode offsets, for which we need labels.// Skip the index field (2 bytes).// TypeReference type which can't be used in Code attribute, or which is unknown.// Parse the rest of the type_annotation structure, starting with the target_path structure// (whose size depends on its path_length field).// Parse the target_path structure and create a corresponding TypePath.// We don't want to visit the other target_type annotations, so we just skip them (which// requires some parsing because the element_value_pairs array has a variable size). First,// skip the target_path structure:// Then skip the num_element_value_pairs and element_value_pairs fields (by reading them// with a null AnnotationVisitor)./* annotationVisitor = */// Parse and store the target_type structure.// Parse and store the target_path structure.// Return the start offset of the rest of the type_annotation structure.// Read the num_element_value_pairs field (or num_values field for an array_value).// Parse the element_value_pairs array.// Parse the array_value array./* elementName= */// enum_const_value// annotation_value// array_value// const_value_index, CONSTANT_Integer// const_value_index, CONSTANT_Double// const_value_index, CONSTANT_Float// const_value_index, CONSTANT_Long// const_value_index, CONSTANT_Utf8// class_info// Parse the method descriptor, one argument type descriptor at each iteration. Start by// skipping the first method descriptor character, which is always '('.// Read the frame_type field.// Skip the access_flags, this_class, super_class, and interfaces_count fields (using 2 bytes// each), as well as the interfaces array field (2 bytes per interface).// Read the fields_count field.// Skip the 'fields' array field.// Invariant: currentOffset is the offset of a field_info structure.// Skip the access_flags, name_index and descriptor_index fields (2 bytes each), and read the// attributes_count field.// Skip the 'attributes' array field.// Invariant: currentOffset is the offset of an attribute_info structure.// Read the attribute_length field (2 bytes after the start of the attribute_info) and skip// this many bytes, plus 6 for the attribute_name_index and attribute_length fields// (yielding the total size of the attribute_info structure).// Skip the methods_count and 'methods' fields, using the same method as above.// Skip the ClassFile's attributes_count field.// Read the num_bootstrap_methods field and create an array of this size.// Compute and store the offset of each 'bootstrap_methods' array field entry.// Skip the bootstrap_method_ref and num_bootstrap_arguments fields (2 bytes each),// as well as the bootstrap_arguments array field (of size num_bootstrap_arguments * 2).// Get the start offset of the cp_info structure (plus one), and read the CONSTANT_Utf8 entry// designated by the first two bytes of this cp_info./** Exception thrown when the constant pool of a class produced by a {@link ClassWriter} is too ... */int constantPoolCount, ...;/** Constructs a new {@link ClassTooLargeException}. ... */this.constantPoolCount/** Returns the internal name of the class. ... *//** Returns the number of constant pool items of the class. ... *//** A visitor to visit a Java class. The methods of this class must be called in the following order: ... */ClassVisitor cv, ...;/** The class visitor to which this visitor must delegate method calls. May be {@literal null}. *//** Constructs a new {@link ClassVisitor}. ... */this.cv/** Visits the header of the class. ... *//** Visits the source of the class. ... *//** Visit the module corresponding to the class. ... *//** Visits the nest host class of the class. A nest is a set of classes of the same package that ... *//** Visits the enclosing class of the class. This method must be called only if the class has an ... *//** Visits an annotation of the class. ... *//** Visits an annotation on a type in the class signature. ... *//** Visits a non standard attribute of the class. ... *//** Visits a member of the nest. A nest is a set of classes of the same package that share access ... *//** Visits a permitted subclasses. A permitted subclass is one of the allowed subclasses of the ... *//** Visits information about an inner class. This inner class is not necessarily a member of the ... *//** Visits a record component of the class. ... *//** Visits a field of the class. ... *//** Visits a method of the class. This method <i>must</i> return a new {@link MethodVisitor} ... *//** Visits the end of the class. This method, which is the last one to be called, is used to inform ... *//** A {@link ClassVisitor} that generates a corresponding ClassFile structure, as defined in the Java ... */int COMPUTE_MAXS, ...;/** A flag to automatically compute the maximum stack size and the maximum number of local ... */int COMPUTE_FRAMES, ...;/** A flag to automatically compute the stack map frames of methods from scratch. If this flag is ... */int version, ...;/** The minor_version and major_version fields of the JVMS ClassFile structure. minor_version is ... */// ordered as in Section 4.7 of the JVMS.// Note: fields are ordered as in the ClassFile structure, and those related to attributes are/** The symbol table for this class (contains the constant_pool and the BootstrapMethods). */int accessFlags, ...;/** The access_flags field of the JVMS ClassFile structure. This field can contain ASM specific ... */int thisClass, ...;/** The this_class field of the JVMS ClassFile structure. */int superClass, ...;/** The super_class field of the JVMS ClassFile structure. */int interfaceCount, ...;/** The interface_count field of the JVMS ClassFile structure. */...[] interfaces, ...;/** The 'interfaces' array of the JVMS ClassFile structure. */FieldWriter firstField, ...;/** The fields of this class, stored in a linked list of {@link FieldWriter} linked via their ... */FieldWriter lastField, ...;MethodWriter firstMethod, ...;/** The methods of this class, stored in a linked list of {@link MethodWriter} linked via their ... */MethodWriter lastMethod, ...;int numberOfInnerClasses, ...;/** The number_of_classes field of the InnerClasses attribute, or 0. */ByteVector innerClasses, ...;/** The 'classes' array of the InnerClasses attribute, or {@literal null}. */int enclosingClassIndex, ...;/** The class_index field of the EnclosingMethod attribute, or 0. */int enclosingMethodIndex, ...;/** The method_index field of the EnclosingMethod attribute. */int signatureIndex, ...;/** The signature_index field of the Signature attribute, or 0. */int sourceFileIndex, ...;/** The source_file_index field of the SourceFile attribute, or 0. */ByteVector debugExtension, ...;/** The debug_extension field of the SourceDebugExtension attribute, or {@literal null}. */AnnotationWriter lastRuntimeVisibleAnnotation, ...;/** The last runtime visible annotation of this class. The previous ones can be accessed with the ... */AnnotationWriter lastRuntimeInvisibleAnnotation, ...;/** The last runtime invisible annotation of this class. The previous ones can be accessed with the ... */AnnotationWriter lastRuntimeVisibleTypeAnnotation, ...;/** The last runtime visible type annotation of this class. The previous ones can be accessed with ... */AnnotationWriter lastRuntimeInvisibleTypeAnnotation, ...;/** The last runtime invisible type annotation of this class. The previous ones can be accessed ... */ModuleWriter moduleWriter, ...;/** The Module attribute of this class, or {@literal null}. */int nestHostClassIndex, ...;/** The host_class_index field of the NestHost attribute, or 0. */int numberOfNestMemberClasses, ...;/** The number_of_classes field of the NestMembers attribute, or 0. */ByteVector nestMemberClasses, ...;/** The 'classes' array of the NestMembers attribute, or {@literal null}. */int numberOfPermittedSubclasses, ...;/** The number_of_classes field of the PermittedSubclasses attribute, or 0. */ByteVector permittedSubclasses, ...;/** The 'classes' array of the PermittedSubclasses attribute, or {@literal null}. */RecordComponentWriter firstRecordComponent, ...;/** The record components of this class, stored in a linked list of {@link RecordComponentWriter} ... */RecordComponentWriter lastRecordComponent, ...;Attribute firstAttribute, ...;/** The first non standard attribute of this class. The next ones can be accessed with the {@link ... */int compute, ...;/** Indicates what must be automatically computed in {@link MethodWriter}. Must be one of {@link ... *//** Constructs a new {@link ClassWriter} object. ... */// Constructor/** Constructs a new {@link ClassWriter} object and enables optimizations for "mostly add" bytecode ... */new SymbolTable(...)this.computeMethodWriter.COMPUTE_ALL_FRAMESMethodWriter.COMPUTE_MAX_STACK_AND_LOCALMethodWriter.COMPUTE_NOTHING// Implementation of the ClassVisitor abstract classthis.accessFlagsthis.thisClasssetMajorVersionAndClassName(...)this.signatureIndexthis.superClassaddConstantClass(...).indexaddConstantClass(...)Opcodes.V1_7MethodWriter.COMPUTE_MAX_STACK_AND_LOCAL_FROM_FRAMESnew ModuleWriter(...)addConstantModule(...).indexaddConstantModule(...)addConstantNameAndType(...)Symbol nameSymbolnameSymbol.infonameSymbol.indexRecordComponentWriter recordComponentWriternew RecordComponentWriter(...)lastRecordComponent.delegateFieldWriter fieldWriternew FieldWriter(...)lastField.fvnew MethodWriter(...)lastMethod.mv/** Returns the content of the class file that was built by this ClassWriter. ... */// Other public methodsint recordComponentCountint recordSizegetConstantPoolCount(...)ByteVector resultint maskboolean hasFramesboolean hasAsmInstructionscomputeFieldInfoSize(...)fieldWriter.fvcomputeMethodInfoSize(...)methodWriter.mvinnerClasses.lengthdebugExtension.lengthcomputeBootstrapMethodsSize(...)getAttributeCount(...)nestMemberClasses.lengthpermittedSubclasses.lengthcomputeRecordComponentInfoSize(...)recordComponentWriter.delegategetConstantPoolLength(...)new ClassTooLargeException(...)putConstantPool(...)putFieldInfo(...)hasFrames(...)hasAsmInstructions(...)putMethodInfo(...)innerClasses.datadebugExtension.dataputBootstrapMethods(...)nestMemberClasses.datapermittedSubclasses.dataputRecordComponentInfo(...)replaceAsmInstructions(...)result.data/** Returns the equivalent of the given class file, with the ASM specific instructions replaced ... */Attribute[] attributesgetAttributePrototypes(...)MethodWriter.COMPUTE_INSERTED_FRAMESnew ClassReader(...)ClassReader.EXPAND_ASM_INSNSClassReader.EXPAND_FRAMES/** Returns the prototypes of the attributes used by this class, its fields and its methods. ... */Attribute.SetSet attributePrototypesnew Set(...)addAttributes(...)collectAttributePrototypes(...)/** Adds a number or string constant to the constant pool of the class being build. Does nothing if ... */// Utility methods: constant pool management for Attribute sub classesaddConstant(...).index/** Adds an UTF8 string to the constant pool of the class being build. Does nothing if the constant ... *//** Adds a class reference to the constant pool of the class being build. Does nothing if the ... *//** Adds a method type reference to the constant pool of the class being build. Does nothing if the ... */addConstantMethodType(...).indexaddConstantMethodType(...)/** Adds a module reference to the constant pool of the class being build. Does nothing if the ... *//** Adds a package reference to the constant pool of the class being build. Does nothing if the ... */addConstantPackage(...).indexaddConstantPackage(...)/** Adds a handle to the constant pool of the class being build. Does nothing if the constant pool ... */newHandle(...)Opcodes.H_INVOKEINTERFACEaddConstantMethodHandle(...).indexaddConstantMethodHandle(...)/** Adds a dynamic constant reference to the constant pool of the class being build. Does nothing ... */addConstantDynamic(...).indexaddConstantDynamic(...)/** Adds an invokedynamic reference to the constant pool of the class being build. Does nothing if ... */addConstantInvokeDynamic(...).indexaddConstantInvokeDynamic(...)/** Adds a field reference to the constant pool of the class being build. Does nothing if the ... */addConstantFieldref(...).indexaddConstantFieldref(...)/** Adds a method reference to the constant pool of the class being build. Does nothing if the ... */addConstantMethodref(...).indexaddConstantMethodref(...)/** Adds a name and type to the constant pool of the class being build. Does nothing if the ... *//** Returns the common super type of the two given types. The default implementation of this method ... */// Default method to compute common super classes when computing stack map framesClassNotFoundException enew TypeNotPresentException(...)/** Returns the {@link ClassLoader} to be used by the default implementation of {@link ... */// Store the attributes in the <i>reverse</i> order of their visit by this method.// Section 4.7.6 of the JVMS states "Every CONSTANT_Class_info entry in the constant_pool table// which represents a class or interface C that is not a package member must have exactly one// corresponding entry in the classes array". To avoid duplicates we keep track in the info// field of the Symbol of each CONSTANT_Class_info entry C whether an inner class entry has// already been added for C. If so, we store the index of this inner class entry (plus one) in// the info field. This trick allows duplicate detection in O(1) time.// Else, compare the inner classes entry nameSymbol.info - 1 with the arguments of this method// and throw an exception if there is a difference?// Nothing to do.// First step: compute the size in bytes of the ClassFile structure.// The magic field uses 4 bytes, 10 mandatory fields (minor_version, major_version,// constant_pool_count, access_flags, this_class, super_class, interfaces_count, fields_count,// methods_count and attributes_count) use 2 bytes each, and each interface uses 2 bytes too.// For ease of reference, we use here the same attribute order as in Section 4.7 of the JVMS.// IMPORTANT: this must be the last part of the ClassFile size computation, because the previous// statements can add attribute names to the constant pool, thereby changing its size!// Second step: allocate a ByteVector of the correct size (in order to avoid any array copy in// dynamic resizes) and fill it with the ClassFile content.// Third step: replace the ASM specific instructions, if any.// SPRING PATCH: prefer thread context ClassLoader for application classes// Cannot access thread context ClassLoader - falling back.../** A constant whose value is computed at runtime, with a bootstrap method. ... *//** The constant name (can be arbitrary). */String descriptor, ...;/** The constant type (must be a field descriptor). */Handle bootstrapMethod, ...;/** The bootstrap method to use to compute the constant value at runtime. */...[] bootstrapMethodArguments, ...;/** The arguments to pass to the bootstrap method, in order to compute the constant value at ... *//** Constructs a new {@link ConstantDynamic}. ... */this.bootstrapMethodthis.bootstrapMethodArguments/** Returns the name of this constant. ... *//** Returns the type of this constant. ... *//** Returns the bootstrap method used to compute the value of this constant. ... *//** Returns the number of arguments passed to the bootstrap method, in order to compute the value ... *//** Returns an argument passed to the bootstrap method, in order to compute the value of this ... *//** Returns the arguments to pass to the bootstrap method, in order to compute the value of this ... *//** Returns the size of this constant. ... */char firstCharOfDescriptorconstantDynamic.nameconstantDynamic.descriptorconstantDynamic.bootstrapMethodconstantDynamic.bootstrapMethodArgumentsrotateLeft(...)/** Defines additional JVM opcodes, access flags and constants which are not part of the ASM public ... */String CONSTANT_VALUE, ...;// https://docs.oracle.com/javase/specs/jvms/se11/html/jvms-4.html#jvms-4.7-300.// The ClassFile attribute names, in the order they are defined inString CODE, ...;String STACK_MAP_TABLE, ...;String EXCEPTIONS, ...;String INNER_CLASSES, ...;String ENCLOSING_METHOD, ...;String SYNTHETIC, ...;String SIGNATURE, ...;String SOURCE_FILE, ...;String SOURCE_DEBUG_EXTENSION, ...;String LINE_NUMBER_TABLE, ...;String LOCAL_VARIABLE_TABLE, ...;String LOCAL_VARIABLE_TYPE_TABLE, ...;String DEPRECATED, ...;String RUNTIME_VISIBLE_ANNOTATIONS, ...;String RUNTIME_INVISIBLE_ANNOTATIONS, ...;String RUNTIME_VISIBLE_PARAMETER_ANNOTATIONS, ...;String RUNTIME_INVISIBLE_PARAMETER_ANNOTATIONS, ...;String RUNTIME_VISIBLE_TYPE_ANNOTATIONS, ...;String RUNTIME_INVISIBLE_TYPE_ANNOTATIONS, ...;String ANNOTATION_DEFAULT, ...;String BOOTSTRAP_METHODS, ...;String METHOD_PARAMETERS, ...;String MODULE, ...;String MODULE_PACKAGES, ...;String MODULE_MAIN_CLASS, ...;String NEST_HOST, ...;String NEST_MEMBERS, ...;String PERMITTED_SUBCLASSES, ...;String RECORD, ...;int ACC_CONSTRUCTOR, ...;// written in class files (because access flags are stored using 16 bits only).// access flags, and also to make sure that these flags are automatically filtered out when// WARNING: the 16 least significant bits must NOT be used, to avoid conflicts with standard// ASM specific access flags.int F_INSERT, ...;/** A frame inserted between already existing frames. This internal stack map frame type (in ... */// ASM specific stack map frame types, used in {@link ClassVisitor#visitFrame}.// method access flag.int LDC_W, ...;// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-6.html.// The JVM opcode values which are not part of the ASM public API.int LDC2_W, ...;int ILOAD_0, ...;int ILOAD_1, ...;int ILOAD_2, ...;int ILOAD_3, ...;int LLOAD_0, ...;int LLOAD_1, ...;int LLOAD_2, ...;int LLOAD_3, ...;int FLOAD_0, ...;int FLOAD_1, ...;int FLOAD_2, ...;int FLOAD_3, ...;int DLOAD_0, ...;int DLOAD_1, ...;int DLOAD_2, ...;int DLOAD_3, ...;int ALOAD_0, ...;int ALOAD_1, ...;int ALOAD_2, ...;int ALOAD_3, ...;int ISTORE_0, ...;int ISTORE_1, ...;int ISTORE_2, ...;int ISTORE_3, ...;int LSTORE_0, ...;int LSTORE_1, ...;int LSTORE_2, ...;int LSTORE_3, ...;int FSTORE_0, ...;int FSTORE_1, ...;int FSTORE_2, ...;int FSTORE_3, ...;int DSTORE_0, ...;int DSTORE_1, ...;int DSTORE_2, ...;int DSTORE_3, ...;int ASTORE_0, ...;int ASTORE_1, ...;int ASTORE_2, ...;int ASTORE_3, ...;int WIDE, ...;int GOTO_W, ...;int JSR_W, ...;int WIDE_JUMP_OPCODE_DELTA, ...;// The delta between the GOTO_W and JSR_W opcodes and GOTO and JUMP.// Constants to convert between normal and wide jump instructions.int ASM_OPCODE_DELTA, ...;// and IFEQ, ..., IF_ACMPNE, GOTO and JSR.// The delta between the ASM_IFEQ, ..., ASM_IF_ACMPNE, ASM_GOTO and ASM_JSR opcodes// Constants to convert JVM opcodes to the equivalent ASM specific opcodes, and vice versa.int ASM_IFNULL_OPCODE_DELTA, ...;// The delta between the ASM_IFNULL and ASM_IFNONNULL opcodes and IFNULL and IFNONNULL.int ASM_IFEQ, ...;// ASM specific opcodes, used for long forward jump instructions.int ASM_IFNE, ...;int ASM_IFLT, ...;int ASM_IFGE, ...;int ASM_IFGT, ...;int ASM_IFLE, ...;int ASM_IF_ICMPEQ, ...;int ASM_IF_ICMPNE, ...;int ASM_IF_ICMPLT, ...;int ASM_IF_ICMPGE, ...;int ASM_IF_ICMPGT, ...;int ASM_IF_ICMPLE, ...;int ASM_IF_ACMPEQ, ...;int ASM_IF_ACMPNE, ...;int ASM_GOTO, ...;int ASM_JSR, ...;int ASM_IFNULL, ...;int ASM_IFNONNULL, ...;int ASM_GOTO_W, ...;/** Information about a class being parsed in a {@link ClassReader}. ... */...[] attributePrototypes, ...;/** The prototypes of the attributes that must be parsed in this class. */int parsingOptions, ...;/** The options used to parse this class. One or more of {@link ClassReader#SKIP_CODE}, {@link ... */...[] charBuffer, ...;/** The buffer used to read strings in the constant pool. */int currentMethodAccessFlags, ...;/** The access flags of the current method. */// to {@link ClassReader#readMethod()}.// Information about the current method, i.e. the one read in the current (or latest) callString currentMethodName, ...;/** The name of the current method. */String currentMethodDescriptor, ...;/** The descriptor of the current method. */...[] currentMethodLabels, ...;/** The labels of the current method, indexed by bytecode offset (only bytecode offsets for which a ... */int currentTypeAnnotationTarget, ...;/** The target_type and target_info of the current type annotation target, encoded as described in ... */// (or latest) call to {@link ClassReader#readAnnotationTarget()}.// Information about the current type annotation target, i.e. the one read in the currentTypePath currentTypeAnnotationTargetPath, ...;/** The target_path of the current type annotation target. */...[] currentLocalVariableAnnotationRangeStarts, ...;/** The start of each local variable range in the current local variable annotation. */...[] currentLocalVariableAnnotationRangeEnds, ...;/** The end of each local variable range in the current local variable annotation. */...[] currentLocalVariableAnnotationRangeIndices, ...;/** The local variable index of each local variable range in the current local variable annotation. */int currentFrameOffset, ...;/** The bytecode offset of the current stack map frame. */// call to {@link ClassReader#readFrame()}.// Information about the current stack map frame, i.e. the one read in the current (or latest)int currentFrameType, ...;/** The type of the current stack map frame. One of {@link Opcodes#F_FULL}, {@link ... */int currentFrameLocalCount, ...;/** The number of local variable types in the current stack map frame. Each type is represented ... */int currentFrameLocalCountDelta, ...;/** The delta number of local variable types in the current stack map frame (each type is ... */...[] currentFrameLocalTypes, ...;/** The types of the local variables in the current stack map frame. Each type is represented with ... */int currentFrameStackCount, ...;/** The number stack element types in the current stack map frame. Each type is represented with a ... */...[] currentFrameStackTypes, ...;/** The types of the stack elements in the current stack map frame. Each type is represented with a ... *//** Information about the input stack map frame at the "current" instruction of a method. This is ... *//** Sets this CurrentFrame to the input stack map frame of the next "current" instruction, i.e. the ... */Frame successornew Frame(...)/** An edge in the control flow graph of a method. Each node of this graph is a basic block, ... */int JUMP, ...;/** A control flow graph edge corresponding to a jump or ret instruction. Only used with {@link ... */int EXCEPTION, ...;/** A control flow graph edge corresponding to an exception handler. Only used with {@link ... */int info, ...;/** Information about this control flow graph edge. ... */Label successor, ...;/** The successor block of this control flow graph edge. */Edge nextEdge, ...;/** The next edge in the list of outgoing edges of a basic block. See {@link Label#outgoingEdges}. *//** Constructs a new Edge. ... */this.infothis.successorthis.nextEdge/** A visitor to visit a Java field. The methods of this class must be called in the following order: ... */FieldVisitor fv, ...;/** The field visitor to which this visitor must delegate method calls. May be {@literal null}. *//** Constructs a new {@link FieldVisitor}. ... */this.fv/** Visits an annotation of the field. ... *//** Visits an annotation on the type of the field. ... *//** Visits a non standard attribute of the field. ... *//** Visits the end of the field. This method, which is the last one to be called, is used to inform ... *//** A {@link FieldVisitor} that generates a corresponding 'field_info' structure, as defined in the ... *//** Where the constants used in this FieldWriter must be stored. *//** The access_flags field of the field_info JVMS structure. This field can contain ASM specific ... */// Note: fields are ordered as in the field_info structure, and those related to attributes areint nameIndex, ...;/** The name_index field of the field_info JVMS structure. */int descriptorIndex, ...;/** The descriptor_index field of the field_info JVMS structure. *//** The signature_index field of the Signature attribute of this field_info, or 0 if there is no ... */int constantValueIndex, ...;/** The constantvalue_index field of the ConstantValue attribute of this field_info, or 0 if there ... *//** The last runtime visible annotation of this field. The previous ones can be accessed with the ... *//** The last runtime invisible annotation of this field. The previous ones can be accessed with the ... *//** The last runtime visible type annotation of this field. The previous ones can be accessed with ... *//** The last runtime invisible type annotation of this field. The previous ones can be accessed ... *//** The first non standard attribute of this field. The next ones can be accessed with the {@link ... *//** Constructs a new {@link FieldWriter}. ... */this.nameIndexthis.descriptorIndexthis.constantValueIndex// Implementation of the FieldVisitor abstract class/** Returns the size of the field_info JVMS structure generated by this FieldWriter. Also adds the ... *//** Puts the content of the field_info JVMS structure generated by this FieldWriter into the given ... */boolean useSyntheticAttribute/** Collects the attributes of this field into the given set of attribute prototypes. ... */// The access_flags, name_index, descriptor_index and attributes_count fields use 8 bytes.// ConstantValue attributes always use 8 bytes.// Put the access_flags, name_index and descriptor_index fields.// Compute and put the attributes_count field.// Put the field_info attributes./** The input and output stack map frames of a basic block. ... */+...int SAME_FRAME, ...;// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.4.// Constants used in the StackMapTable attribute.int SAME_LOCALS_1_STACK_ITEM_FRAME, ...;int RESERVED, ...;int SAME_LOCALS_1_STACK_ITEM_FRAME_EXTENDED, ...;int CHOP_FRAME, ...;int SAME_FRAME_EXTENDED, ...;int APPEND_FRAME, ...;int FULL_FRAME, ...;int ITEM_TOP, ...;int ITEM_INTEGER, ...;int ITEM_FLOAT, ...;int ITEM_DOUBLE, ...;int ITEM_LONG, ...;int ITEM_NULL, ...;int ITEM_UNINITIALIZED_THIS, ...;int ITEM_OBJECT, ...;int ITEM_UNINITIALIZED, ...;int ITEM_ASM_BOOLEAN, ...;// Additional, ASM specific constants used in abstract types below.int ITEM_ASM_BYTE, ...;int ITEM_ASM_CHAR, ...;int ITEM_ASM_SHORT, ...;int DIM_SIZE, ...;// The size and offset in bits of each field of an abstract type.int KIND_SIZE, ...;int FLAGS_SIZE, ...;int VALUE_SIZE, ...;int DIM_SHIFT, ...;int KIND_SHIFT, ...;int FLAGS_SHIFT, ...;int DIM_MASK, ...;// Bitmasks to get each field of an abstract type.int KIND_MASK, ...;int VALUE_MASK, ...;int ARRAY_OF, ...;/** The constant to be added to an abstract type to get one with one more array dimension. */// Constants to manipulate the DIM field of an abstract type.int ELEMENT_OF, ...;/** The constant to be added to an abstract type to get one with one less array dimension. */int CONSTANT_KIND, ...;// Possible values for the KIND field of an abstract type.int REFERENCE_KIND, ...;int UNINITIALIZED_KIND, ...;int LOCAL_KIND, ...;int STACK_KIND, ...;int TOP_IF_LONG_OR_DOUBLE_FLAG, ...;/** A flag used for LOCAL_KIND and STACK_KIND abstract types, indicating that if the resolved, ... */// Possible flags for the FLAGS field of an abstract type.int TOP, ...;// Useful predefined abstract types (all the possible CONSTANT_KIND types).int BOOLEAN, ...;int BYTE, ...;int CHAR, ...;int SHORT, ...;int INTEGER, ...;int FLOAT, ...;int LONG, ...;int DOUBLE, ...;int NULL, ...;int UNINITIALIZED_THIS, ...;Label owner, ...;/** The basic block to which these input and output stack map frames correspond. */// Instance fields...[] inputLocals, ...;/** The input stack map frame locals. This is an array of abstract types. */...[] inputStack, ...;/** The input stack map frame stack. This is an array of abstract types. */...[] outputLocals, ...;/** The output stack map frame locals. This is an array of abstract types. */...[] outputStack, ...;/** The output stack map frame stack. This is an array of abstract types. */short outputStackStart, ...;/** The start of the output stack, relatively to the input stack. This offset is always negative or ... */short outputStackTop, ...;/** The index of the top stack element in {@link #outputStack}. */int initializationCount, ...;/** The number of types that are initialized in the basic block. See {@link #initializations}. */...[] initializations, ...;/** The abstract types that are initialized in the basic block. A constructor invocation on an ... *//** Constructs a new Frame. ... *//** Sets this frame to the value of the given frame. ... */frame.inputLocalsframe.inputStackframe.outputLocalsframe.outputStackframe.outputStackTopframe.initializationCountframe.initializations/** Returns the abstract type corresponding to the given public API frame element type. ... */// Static methods to get abstract types from other type formatsgetAbstractTypeFromDescriptor(...)addUninitializedType(...)(...).bytecodeOffset/** Returns the abstract type corresponding to the internal name of a class. ... */addType(...)/** Returns the abstract type corresponding to the given type descriptor. ... */int elementDescriptorOffsetint typeValue/** Sets the input frame from the given method description. This method is used to initialize the ... */// Methods related to the input frameint inputLocalIndexConstants.ACC_CONSTRUCTORType argumentTypegetArgumentTypes(...)int abstractType/** Sets the input frame from the given public API frame description. ... */int numStackTopint inputStackIndexgetAbstractTypeFromApiFormat(...)inputLocals.lengthinputStack.length/** Returns the abstract type stored at the given local variable index in the output frame. ... */// Methods related to the output frameoutputLocals.length/** Replaces the abstract type stored at the given local variable index in the output frame. ... */int outputLocalsLengthint[] newOutputLocals/** Pushes the given abstract type on the output frame stack. ... */int outputStackLengthoutputStack.lengthshort outputStackSizeint[] newOutputStackowner.outputStackMax/** Pushes the abstract type corresponding to the given descriptor on the output frame stack. ... */int typeDescriptorOffsetgetReturnTypeOffset(...)/** Pops an abstract type from the output frame stack and returns its value. ... *//** Pops the given number of abstract types from the output frame stack. ... *//** Pops as many abstract types from the output frame stack as described by the given descriptor. ... */char firstDescriptorChargetArgumentsAndReturnSizes(...)/** Adds an abstract type to the list of types on which a constructor is invoked in the basic ... */// Methods to handle uninitialized typesint initializationsLengthinitializations.lengthint[] newInitializations/** Returns the "initialized" abstract type corresponding to the given abstract type. ... */int initializedTypeint dimint kindgetType(...).value/** Simulates the action of the given instruction on the output stack frame. ... */// Main method, to simulate the execution of each instruction on the output frameint abstractType1int abstractType2int abstractType3int abstractType4String arrayElementTypeargSymbol.valueString castTypeargSymbol.taggetLocal(...)setLocal(...)int previousLocalTypeargSymbol.nameaddInitializedType(...)Opcodes.T_BOOLEANOpcodes.T_CHAROpcodes.T_BYTEOpcodes.T_SHORTOpcodes.T_INTOpcodes.T_FLOATOpcodes.T_DOUBLEOpcodes.T_LONG/** Computes the concrete output type corresponding to a given abstract output type. ... */// Frame merging methods, used in the second step of the stack map frame computation algorithmint concreteOutputType/** Merges the input frame of the given {@link Frame} with the input and output frames of this ... */boolean frameChangedint numStackint numInputStackdstFrame.inputLocalsint abstractOutputTypegetConcreteOutputType(...)getInitializedType(...)dstFrame.inputStack/** Merges the type at the given index in the given abstract type array with the given type. ... */int dstTypeint srcTypeint mergedTypeaddMergedType(...)int mergedDimint srcDimint dstDim/** Makes the given {@link MethodWriter} visit the input frame of this {@link Frame}. The visit is ... */// Frame output methods, to generate StackMapFrame attributesint[] localTypesint numTrailingTopint[] stackTypesint frameIndexvisitFrameStart(...)owner.bytecodeOffsetlocalTypes.lengthint localTypestackTypes.lengthint stackTypevisitAbstractType(...)visitFrameEnd(...)/** Put the given abstract type in the given ByteVector, using the JVMS verification_type_info ... */int arrayDimensionsFrame.DIM_MASKgetType(...).dataStringBuilder typeDescriptorFrame.ITEM_ASM_BOOLEANFrame.ITEM_ASM_BYTEFrame.ITEM_ASM_CHARFrame.ITEM_ASM_SHORT// If this local has never been assigned in this basic block, it is still equal to its value// in the input frame.// If this local has never been assigned in this basic block, so it is still equal to its// value in the input frame.// Create and/or resize the output local variables array if necessary.// Set the local variable.// Create and/or resize the output stack array if necessary.// Pushes the abstract type on the output stack.// Updates the maximum size reached by the output stack, if needed (note that this size is// relative to the input stack size, which is not known yet).// If the output frame stack is empty, pop from the input stack.// If the number of elements to be popped is greater than the number of elements in the output// stack, clear it, and pop the remaining elements from the input stack.// Create and/or resize the initializations array if necessary.// Store the abstract type.// Abstract types popped from the stack or read from local variables.// The type of the previous local variable is not known yet, but if it later appears// to be LONG or DOUBLE, we should then use TOP instead.// By definition, a LOCAL_KIND type designates the concrete type of a local variable at// the beginning of the basic block corresponding to this frame (which is known when// this method is called, but was not when the abstract type was computed).// By definition, a STACK_KIND type designates the concrete type of a local variable at// Compute the concrete types of the local variables at the end of the basic block corresponding// to this frame, by resolving its abstract output types, and merge these concrete types with// those of the local variables in the input frame of dstFrame.// If the local variable has never been assigned in this basic block, it is equal to its// value at the beginning of the block.// concreteOutputType might be an uninitialized type from the input locals or from the input// stack. However, if a constructor has been called for this class type in the basic block,// then this type is no longer uninitialized at the end of basic block.// If dstFrame is an exception handler block, it can be reached from any instruction of the// basic block corresponding to this frame, in particular from the first one. Therefore, the// input locals of dstFrame should be compatible (i.e. merged) with the input locals of this// frame (and the input stack of dstFrame should be compatible, i.e. merged, with a one// element stack containing the caught exception type).// Compute the concrete types of the stack operands at the end of the basic block corresponding// those of the stack operands in the input frame of dstFrame.// First, do this for the stack operands that have not been popped in the basic block// corresponding to this frame, and which are therefore equal to their value in the input// frame (except for uninitialized types, which may have been initialized).// Then, do this for the stack operands that have pushed in the basic block (this code is the// same as the one above for local variables).// If the types are equal, merge(sourceType, dstType) = dstType, so there is no change.// If dstTypes[dstIndex] has never been assigned, merge(srcType, dstType) = srcType.// If dstType is a reference type of any array dimension.// If srcType is the NULL type, merge(srcType, dstType) = dstType, so there is no change.// If srcType has the same array dimension and the same kind as dstType.// If srcType and dstType are reference types with the same array dimension,// merge(srcType, dstType) = dim(srcType) | common super class of srcType and dstType.// If srcType and dstType are array types of equal dimension but different element types,// merge(srcType, dstType) = dim(srcType) - 1 | java/lang/Object.// If srcType is any other reference or array type,// merge(srcType, dstType) = min(srcDdim, dstDim) | java/lang/Object// where srcDim is the array dimension of srcType, minus 1 if srcType is an array type// with a non reference element type (and similarly for dstDim).// If srcType is any other type, merge(srcType, dstType) = TOP.// If dstType is the NULL type, merge(srcType, dstType) = srcType, or TOP if srcType is not a// an array type or a reference type.// If dstType is any other type, merge(srcType, dstType) = TOP whatever srcType.// Compute the number of locals, ignoring TOP types that are just after a LONG or a DOUBLE, and// all trailing TOP types.// Compute the stack size, ignoring TOP types that are just after a LONG or a DOUBLE.// Visit the frame and its content.// Case of an array type, we need to build its descriptor first.// SPRING PATCH: larger initial size/** A reference to a field or a method. ... */int tag, ...;/** The kind of field or method designated by this Handle. Should be {@link Opcodes#H_GETFIELD}, ... */String owner, ...;/** The internal name of the class that owns the field or method designated by this handle. *//** The name of the field or method designated by this handle. *//** The descriptor of the field or method designated by this handle. */boolean isInterface, ...;/** Whether the owner is an interface or not. *//** Constructs a new field or method handle. ... */this.tagthis.isInterface/** Returns the kind of field or method designated by this handle. ... *//** Returns the internal name of the class that owns the field or method designated by this handle. ... *//** Returns the name of the field or method designated by this handle. ... *//** Returns the descriptor of the field or method designated by this handle. ... *//** Returns true if the owner of the field or method designated by this handle is an interface. ... */handle.taghandle.isInterfacehandle.ownerhandle.namehandle.descriptor/** Returns the textual representation of this handle. The textual representation is: ... *//** Information about an exception handler. Corresponds to an element of the exception_table array of ... */Label startPc, ...;/** The start_pc field of this JVMS exception_table entry. Corresponds to the beginning of the ... */Label endPc, ...;/** The end_pc field of this JVMS exception_table entry. Corresponds to the end of the exception ... */Label handlerPc, ...;/** The handler_pc field of this JVMS exception_table entry. Corresponding to the beginning of the ... */int catchType, ...;/** The catch_type field of this JVMS exception_table entry. This is the constant pool index of the ... */String catchTypeDescriptor, ...;/** The internal name of the type of exceptions handled by this handler, or {@literal null} to ... */Handler nextHandler, ...;/** The next exception handler. *//** Constructs a new Handler. ... */this.startPcthis.endPcthis.handlerPcthis.catchTypethis.catchTypeDescriptor/** Constructs a new Handler from the given one, with a different scope. ... */handler.handlerPchandler.catchTypehandler.catchTypeDescriptorthis.nextHandlerhandler.nextHandler/** Removes the range between start and end from the Handler list that begins with the given ... */int handlerStartfirstHandler.startPc.bytecodeOffsetfirstHandler.startPcint handlerEndfirstHandler.endPc.bytecodeOffsetfirstHandler.endPcint rangeStartstart.bytecodeOffsetint rangeEndend.bytecodeOffsetfirstHandler.nextHandlerremoveRange(...)new Handler(...)/** Returns the number of elements of the Handler list that begins with the given element. ... */Handler handler/** Returns the size in bytes of the JVMS exception_table corresponding to the Handler list that ... */getExceptionTableLength(...)/** Puts the JVMS exception_table corresponding to the Handler list that begins with the given ... */handler.handlerPc.bytecodeOffsethandler.endPc.bytecodeOffsethandler.startPc.bytecodeOffsethandler.startPchandler.endPc// Return early if [handlerStart,handlerEnd[ and [rangeStart,rangeEnd[ don't intersect.// If [handlerStart,handlerEnd[ is included in [rangeStart,rangeEnd[, remove firstHandler.// [handlerStart,handlerEnd[ - [rangeStart,rangeEnd[ = [rangeEnd,handlerEnd[// [handlerStart,handlerEnd[ - [rangeStart,rangeEnd[ = [handlerStart,rangeStart[// [handlerStart,handlerEnd[ - [rangeStart,rangeEnd[ =//     [handlerStart,rangeStart[ + [rangeEnd,handerEnd[/** A position in the bytecode of a method. Labels are used for jump, goto, and switch instructions, ... */int FLAG_DEBUG_ONLY, ...;/** A flag indicating that a label is only used for debug attributes. Such a label is not the start ... */int FLAG_JUMP_TARGET, ...;/** A flag indicating that a label is the target of a jump instruction, or the start of an ... */int FLAG_RESOLVED, ...;/** A flag indicating that the bytecode offset of a label is known. */int FLAG_REACHABLE, ...;/** A flag indicating that a label corresponds to a reachable basic block. */int FLAG_SUBROUTINE_CALLER, ...;/** A flag indicating that the basic block corresponding to a label ends with a subroutine call. By ... */int FLAG_SUBROUTINE_START, ...;/** A flag indicating that the basic block corresponding to a label is the start of a subroutine. */int FLAG_SUBROUTINE_END, ...;/** A flag indicating that the basic block corresponding to a label is the end of a subroutine. */int LINE_NUMBERS_CAPACITY_INCREMENT, ...;/** The number of elements to add to the {@link #otherLineNumbers} array when it needs to be ... */int FORWARD_REFERENCES_CAPACITY_INCREMENT, ...;/** The number of elements to add to the {@link #forwardReferences} array when it needs to be ... */int FORWARD_REFERENCE_TYPE_MASK, ...;/** The bit mask to extract the type of a forward reference to this label. The extracted type is ... */int FORWARD_REFERENCE_TYPE_SHORT, ...;/** The type of forward references stored with two bytes in the bytecode. This is the case, for ... */int FORWARD_REFERENCE_TYPE_WIDE, ...;/** The type of forward references stored in four bytes in the bytecode. This is the case, for ... */int FORWARD_REFERENCE_HANDLE_MASK, ...;/** The bit mask to extract the 'handle' of a forward reference to this label. The extracted handle ... */Label EMPTY_LIST, ...;/** A sentinel element used to indicate the end of a list of labels. ... */Object info, ...;/** A user managed state associated with this label. Warning: this field is used by the ASM tree ... */short flags, ...;/** The type and status of this label or its corresponding basic block. Must be zero or more of ... */short lineNumber, ...;/** The source line number corresponding to this label, or 0. If there are several source line ... */...[] otherLineNumbers, ...;/** The source line numbers corresponding to this label, in addition to {@link #lineNumber}, or ... */int bytecodeOffset, ...;/** The offset of this label in the bytecode of its method, in bytes. This value is set if and only ... */...[] forwardReferences, ...;/** The forward references to this label. The first element is the number of forward references, ... */short inputStackSize, ...;/** The number of elements in the input stack of the basic block corresponding to this label. This ... */// relative output frames and absolute input frames.// absolute input stack heights, while the algorithm used to compute stack map frames computes// The algorithm used to compute the maximum stack size only computes the relative output and// computed relative output frames.// the first basic block (known from the method signature), and by the using the previously// that computes information about the input frame of each basic block, from the input state of// MethodWriter#computeMaxStackAndLocal}, is a fix point algorithm// during this step. The second step, in {@link MethodWriter#computeAllFrames} and {@link// beginning of the basic block, which is called the "input frame", and which is <i>unknown</i>// each basic block, called the "output frame", <i>relatively</i> to the frame state at the// builds information about the state of the local variables and the operand stack at the end of// frames are similar and use two steps. The first step, during the visit of each instruction,// The control flow analysis algorithms used to compute the maximum stack size or the stack map// Edge objects.// basic block. Each node also stores the list of its successors in the graph, as a linked list of// block) is represented with the Label object that corresponds to the first instruction of this// block", and one edge per "jump" from one basic block to another. Each node (i.e., each basic// maximum stack size or the stack map frames). A control flow graph contains one node per "basic// Fields for the control flow and data flow graph analysis algorithms (used to compute theshort outputStackSize, ...;/** The number of elements in the output stack, at the end of the basic block corresponding to this ... */short outputStackMax, ...;/** The maximum height reached by the output stack, relatively to the top of the input stack, in ... */short subroutineId, ...;/** The id of the subroutine to which this basic block belongs, or 0. If the basic block belongs to ... */Frame frame, ...;/** The input and output stack map frames of the basic block corresponding to this label. This ... */Label nextBasicBlock, ...;/** The successor of this label, in the order they are visited in {@link MethodVisitor#visitLabel}. ... */Edge outgoingEdges, ...;/** The outgoing edges of the basic block corresponding to this label, in the control flow graph of ... */Label nextListElement, ...;/** The next element in the list of labels to which this label belongs, or {@literal null} if it ... *//** Constructs a new label. */// Constructor and accessors/** Returns the bytecode offset corresponding to this label. This offset is computed from the start ... *//** Returns the "canonical" {@link Label} instance corresponding to this label's bytecode offset, ... */frame.owner/** Adds a source line number corresponding to this label. ... */// Methods to manage line numbersthis.lineNumberint otherLineNumberIndexotherLineNumbers.lengthint[] newLineNumbers/** Makes the given visitor visit this label and its source line numbers, if applicable. ... */visitLineNumber(...)/** Puts a reference to this label in the bytecode of a method. If the bytecode offset of the label ... */// Methods to compute offsets and to manage forward referencesaddForwardReference(...)code.length/** Adds a forward reference to this label. This method must be called only for a true forward ... */int lastElementIndexforwardReferences.lengthint[] newValues/** Sets the bytecode offset of this label to the given value and resolves the forward references ... */this.bytecodeOffsetint sourceInsnBytecodeOffsetint referenceint relativeOffsetint handleShort.MIN_VALUE/** Finds the basic blocks that belong to the subroutine starting with the basic block ... */// Methods related to subroutinesLabel listOfBlocksToProcesslistOfBlocksToProcess.nextListElementLabel basicBlockbasicBlock.nextListElementbasicBlock.subroutineIdpushSuccessors(...)/** Finds the basic blocks that end a subroutine starting with the basic block corresponding to ... */Label listOfProcessedBlocksbasicBlock.flagssubroutineCaller.subroutineIdbasicBlock.outgoingEdgesnew Edge(...)basicBlock.outputStackSizesubroutineCaller.outgoingEdges.successorsubroutineCaller.outgoingEdgesLabel newListOfProcessedBlockslistOfProcessedBlocks.nextListElement/** Adds the successors of this label in the method's control flow graph (except those ... */Label newListOfLabelsToProcessEdge outgoingEdgeboolean isJsrTargetLabel.FLAG_SUBROUTINE_CALLERoutgoingEdges.nextEdgeoutgoingEdge.successor.nextListElementoutgoingEdge.successoroutgoingEdge.nextEdge/** Returns a string representation of this label. ... */// Overridden Object methods// Change the opcode of the jump instruction, in order to be able to find it later in// ClassReader. These ASM specific opcodes are similar to jump instruction opcodes, except// that the 2 bytes offset is unsigned (and can therefore represent values from 0 to// 65535, which is sufficient since the size of a method is limited to 65535 bytes).// Change IFEQ ... JSR to ASM_IFEQ ... ASM_JSR.// Change IFNULL and IFNONNULL to ASM_IFNULL and ASM_IFNONNULL.// Data flow algorithm: put this basic block in a list of blocks to process (which are blocks// belonging to subroutine subroutineId) and, while there are blocks to process, remove one from// the list, mark it as belonging to the subroutine, and add its successor basic blocks in the// control flow graph to the list of blocks to process (if not already done).// Remove a basic block from the list of blocks to process.// If it is not already marked as belonging to a subroutine, mark it as belonging to// subroutineId and add its successors to the list of blocks to process (unless already done).// Data flow algorithm: put this basic block in a list blocks to process (which are blocks// belonging to a subroutine starting with this label) and, while there are blocks to process,// remove one from the list, put it in a list of blocks that have been processed, add a return// edge to the successor of subroutineCaller if applicable, and add its successor basic blocks// in the control flow graph to the list of blocks to process (if not already done).// Move a basic block from the list of blocks to process to the list of processed blocks.// Add an edge from this block to the successor of the caller basic block, if this block is// the end of a subroutine and if this block and subroutineCaller do not belong to the same// subroutine.// By construction, the first outgoing edge of a basic block that ends with a jsr// instruction leads to the jsr continuation block, i.e. where execution continues// when ret is called (see {@link #FLAG_SUBROUTINE_CALLER}).// Add its successors to the list of blocks to process. Note that {@link #pushSuccessors} does// not push basic blocks which are already in a list. Here this means either in the list of// blocks to process, or in the list of already processed blocks. This second list is// important to make sure we don't reprocess an already processed block.// Reset the {@link #nextListElement} of all the basic blocks that have been processed to null,// so that this method can be called again with a different subroutine or subroutine caller.// By construction, the second outgoing edge of a basic block that ends with a jsr instruction// leads to the jsr target (see {@link #FLAG_SUBROUTINE_CALLER}).// Add this successor to the list of blocks to process, if it does not already belong to a// list of labels./** Exception thrown when the Code attribute of a method produced by a {@link ClassWriter} is too ... */int codeSize, ...;/** Constructs a new {@link MethodTooLargeException}. ... */this.codeSize/** Returns the internal name of the owner class. ... *//** Returns the name of the method. ... *//** Returns the descriptor of the method. ... *//** Returns the size of the method's Code attribute, in bytes. ... *//** A visitor to visit a Java method. The methods of this class must be called in the following ... */String REQUIRES_ASM5, ...;MethodVisitor mv, ...;/** The method visitor to which this visitor must delegate method calls. May be {@literal null}. *//** Constructs a new {@link MethodVisitor}. ... */this.mv/** Visits a parameter of this method. ... */// Parameters, annotations and non standard attributes/** Visits the default value of this annotation interface method. ... *//** Visits an annotation of this method. ... *//** Visits an annotation on a type in the method signature. ... *//** Visits the number of method parameters that can have annotations. By default (i.e. when this ... *//** Visits an annotation of a parameter this method. ... *//** Visits a non standard attribute of this method. ... *//** Starts the visit of the method's code, if any (i.e. non abstract method). *//** Visits the current state of the local variables and operand stack elements. This method must(*) ... *//** Visits a zero operand instruction. ... */// Normal instructions/** Visits an instruction with a single int operand. ... *//** Visits a local variable instruction. A local variable instruction is an instruction that loads ... *//** Visits a type instruction. A type instruction is an instruction that takes the internal name of ... *//** Visits a field instruction. A field instruction is an instruction that loads or stores the ... *//** Visits a method instruction. A method instruction is an instruction that invokes a method. ... */int opcodeAndSourceOpcodes.SOURCE_DEPRECATEDOpcodes.SOURCE_MASK/** Visits an invokedynamic instruction. ... *//** Visits a jump instruction. A jump instruction is an instruction that may jump to another ... *//** Visits a label. A label designates the instruction that will be visited just after it. ... *//** Visits a LDC instruction. Note that new constant types may be added in future versions of the ... */// Special instructionsType.METHOD/** Visits an IINC instruction. ... *//** Visits a TABLESWITCH instruction. ... *//** Visits a LOOKUPSWITCH instruction. ... *//** Visits a MULTIANEWARRAY instruction. ... *//** Visits an annotation on an instruction. This method must be called just <i>after</i> the ... *//** Visits a try catch block. ... */// Exceptions table entries, debug information, max stack and max locals/** Visits an annotation on an exception handler type. This method must be called <i>after</i> the ... *//** Visits a local variable declaration. ... *//** Visits an annotation on a local variable type. ... *//** Visits a line number declaration. ... *//** Visits the maximum stack size and the maximum number of local variables of the method. ... *//** Visits the end of the method. This method, which is the last one to be called, is used to ... *//** A {@link MethodVisitor} that generates a corresponding 'method_info' structure, as defined in the ... */int COMPUTE_NOTHING, ...;/** Indicates that nothing must be computed. */int COMPUTE_MAX_STACK_AND_LOCAL, ...;/** Indicates that the maximum stack size and the maximum number of local variables must be ... */int COMPUTE_MAX_STACK_AND_LOCAL_FROM_FRAMES, ...;int COMPUTE_INSERTED_FRAMES, ...;/** Indicates that the stack map frames of type F_INSERT must be computed. The other frames are not ... */int COMPUTE_ALL_FRAMES, ...;/** Indicates that all the stack map frames must be computed. In this case the maximum stack size ... */int NA, ...;/** Indicates that {@link #STACK_SIZE_DELTA} is not applicable (not constant or never used). */...[] STACK_SIZE_DELTA, ...;/** The stack size variation corresponding to each JVM opcode. The stack size variation for opcode ... *//** Where the constants used in this MethodWriter must be stored. *//** The access_flags field of the method_info JVMS structure. This field can contain ASM specific ... */// Note: fields are ordered as in the method_info structure, and those related to attributes are/** The name_index field of the method_info JVMS structure. *//** The name of this method. *//** The descriptor_index field of the method_info JVMS structure. *//** The descriptor of this method. */int maxStack, ...;/** The max_stack field of the Code attribute. */// Code attribute fields and sub attributes:int maxLocals, ...;/** The max_locals field of the Code attribute. */ByteVector code, ...;/** The 'code' field of the Code attribute. */Handler firstHandler, ...;/** The first element in the exception handler list (used to generate the exception_table of the ... */Handler lastHandler, ...;/** The last element in the exception handler list (used to generate the exception_table of the ... */int lineNumberTableLength, ...;/** The line_number_table_length field of the LineNumberTable code attribute. */ByteVector lineNumberTable, ...;/** The line_number_table array of the LineNumberTable code attribute, or {@literal null}. */int localVariableTableLength, ...;/** The local_variable_table_length field of the LocalVariableTable code attribute. */ByteVector localVariableTable, ...;/** The local_variable_table array of the LocalVariableTable code attribute, or {@literal null}. */int localVariableTypeTableLength, ...;/** The local_variable_type_table_length field of the LocalVariableTypeTable code attribute. */ByteVector localVariableTypeTable, ...;/** The local_variable_type_table array of the LocalVariableTypeTable code attribute, or {@literal ... */int stackMapTableNumberOfEntries, ...;/** The number_of_entries field of the StackMapTable code attribute. */ByteVector stackMapTableEntries, ...;/** The 'entries' array of the StackMapTable code attribute. */AnnotationWriter lastCodeRuntimeVisibleTypeAnnotation, ...;/** The last runtime visible type annotation of the Code attribute. The previous ones can be ... */AnnotationWriter lastCodeRuntimeInvisibleTypeAnnotation, ...;/** The last runtime invisible type annotation of the Code attribute. The previous ones can be ... */Attribute firstCodeAttribute, ...;/** The first non standard attribute of the Code attribute. The next ones can be accessed with the ... */int numberOfExceptions, ...;/** The number_of_exceptions field of the Exceptions attribute. */// Other method_info attributes:...[] exceptionIndexTable, ...;/** The exception_index_table array of the Exceptions attribute, or {@literal null}. *//** The signature_index field of the Signature attribute. *//** The last runtime visible annotation of this method. The previous ones can be accessed with the ... *//** The last runtime invisible annotation of this method. The previous ones can be accessed with ... */int visibleAnnotableParameterCount, ...;/** The number of method parameters that can have runtime visible annotations, or 0. */...[] lastRuntimeVisibleParameterAnnotations, ...;/** The runtime visible parameter annotations of this method. Each array element contains the last ... */int invisibleAnnotableParameterCount, ...;...[] lastRuntimeInvisibleParameterAnnotations, ...;/** The runtime invisible parameter annotations of this method. Each array element contains the ... *//** The last runtime visible type annotation of this method. The previous ones can be accessed with ... *//** The last runtime invisible type annotation of this method. The previous ones can be accessed ... */ByteVector defaultValue, ...;/** The default_value field of the AnnotationDefault attribute, or {@literal null}. */int parametersCount, ...;/** The parameters_count field of the MethodParameters attribute. */ByteVector parameters, ...;/** The 'parameters' array of the MethodParameters attribute, or {@literal null}. *//** The first non standard attribute of this method. The next ones can be accessed with the {@link ... *//** Indicates what must be computed. Must be one of {@link #COMPUTE_ALL_FRAMES}, {@link ... */// Fields used to compute the maximum stack size and number of locals, and the stack map framesLabel firstBasicBlock, ...;/** The first basic block of the method. The next ones (in bytecode offset order) can be accessed ... */Label lastBasicBlock, ...;/** The last basic block of the method (in bytecode offset order). This field is updated each time ... */Label currentBasicBlock, ...;/** The current basic block, i.e. the basic block of the last visited instruction. When {@link ... */int relativeStackSize, ...;/** The relative stack size after the last visited instruction. This size is relative to the ... */int maxRelativeStackSize, ...;/** The maximum relative stack size after the last visited instruction. This size is relative to ... */int currentLocals, ...;/** The number of local variables in the last visited stack map frame. */int previousFrameOffset, ...;/** The bytecode offset of the last frame that was written in {@link #stackMapTableEntries}. */...[] previousFrame, ...;/** The last frame that was written in {@link #stackMapTableEntries}. This field has the same ... */...[] currentFrame, ...;/** The current stack map frame. The first element contains the bytecode offset of the instruction ... */boolean hasSubroutines, ...;/** Whether this method contains subroutines. */boolean hasAsmInstructions, ...;/** Whether the bytecode of this method contains ASM specific instructions. */// Other miscellaneous status fieldsint lastBytecodeOffset, ...;/** The start offset of the last visited instruction. Used to set the offset field of type ... */int sourceOffset, ...;/** The offset in bytes in {@link SymbolTable#getSource} from which the method_info for this method ... */int sourceLength, ...;/** The length in bytes in {@link SymbolTable#getSource} which must be copied to get the ... *//** Constructs a new {@link MethodWriter}. ... */this.exceptionIndexTableint argumentsSize// Implementation of the MethodVisitor abstract classnew AnnotationWriter[]getArgumentTypes(...).lengthisCodeAttribute(...)currentBasicBlock.framenew CurrentFrame(...)setInputFrameFromDescriptor(...)setInputFrameFromApiFormat(...)Frame implicitFirstFrameOpcodes.V1_6putFrameType(...)endCurrentBasicBlockWithNoSuccessor(...)put11(...)int optimizedOpcodecurrentBasicBlock.flagsLabel.FLAG_SUBROUTINE_ENDcurrentBasicBlock.outputStackSizeint currentMaxLocalsSymbol typeSymboltypeSymbol.indexSymbol fieldrefSymbolfieldrefSymbol.indexchar firstDescCharSymbol methodrefSymbolmethodrefSymbol.indexint argumentsAndReturnSizeint stackSizeDeltaSymbol invokeDynamicSymbolinvokeDynamicSymbol.indexint baseOpcodeboolean nextInsnIsJumpTargetLabel.FLAG_RESOLVEDlabel.bytecodeOffsetLabel nextBasicBlockgetCanonicalInstance(...).flagsLabel.FLAG_JUMP_TARGETgetCanonicalInstance(...)addSuccessorToCurrentBasicBlock(...)Edge.JUMPLabel.FLAG_SUBROUTINE_STARTnextBasicBlock.flagscode.datacurrentBasicBlock.bytecodeOffsetlabel.framelastBasicBlock.bytecodeOffsetlastBasicBlock.flagslastBasicBlock.framelastBasicBlock.nextBasicBlockcurrentBasicBlock.frame.ownercurrentBasicBlock.outputStackMaxSymbol constantSymbolint constantIndexconstantSymbol.indexboolean isLongOrDoubleconstantSymbol.tagconstantSymbol.valuevisitSwitchInsn(...)Symbol descSymboldescSymbol.indexHandler newHandlerlastHandler.nextHandlerstart.length...[...].bytecodeOffsetcomputeAllFrames(...)computeMaxStackAndLocal(...)this.maxStackthis.maxLocals/** Computes all the stack map frames of the method, from scratch. */Frame firstFramefirstBasicBlock.frameint maxStackSizeString catchTypeDescriptorint catchTypegetAbstractTypeFromInternalName(...)Label handlerBlockLabel handlerRangeBlockLabel handlerRangeEndhandlerBlock.flagshandlerRangeBlock.outgoingEdgeshandlerRangeBlock.nextBasicBlockLabel.EMPTY_LISTint maxBlockStackSizegetInputStackSize(...)basicBlock.outputStackMaxbasicBlock.frameLabel.FLAG_REACHABLELabel successorBlockboolean successorBlockChangedsuccessorBlock.frameoutgoingEdge.infosuccessorBlock.nextListElementbasicBlock.nextBasicBlockint startOffsetbasicBlock.bytecodeOffsetnextBasicBlock.bytecodeOffset/** Computes the maximum stack size of the method. */handlerRangeBlock.flagsEdge.EXCEPTIONhandlerRangeBlock.outgoingEdges.nextEdge.nextEdgehandlerRangeBlock.outgoingEdges.nextEdgeshort numSubroutinesmarkSubroutine(...)short currentSubroutineLabel jsrTargetbasicBlock.outgoingEdges.nextEdge.successorbasicBlock.outgoingEdges.nextEdgejsrTarget.subroutineIdLabel subroutineaddSubroutineRetSuccessors(...)int inputStackTopbasicBlock.inputStackSizesuccessorBlock.inputStackSize/** Adds a successor to {@link #currentBasicBlock} in the control flow graph. ... */// Utility methods: control flow analysis algorithmcurrentBasicBlock.outgoingEdges/** Ends the current basic block. This method must be used in the case where the current basic ... */nextBasicBlock.frame/** Starts the visit of a new stack map frame, stored in {@link #currentFrame}. ... */// Utility methods: stack map framesint frameLengthcurrentFrame.length/** Sets an abstract type in {@link #currentFrame}. ... *//** Ends the visit of {@link #currentFrame} by writing it in the StackMapTable entries and by ... */putFrame(...)/** Compresses and writes {@link #currentFrame} in a new StackMapTable entry. */int previousNumlocalint numLocalDeltaint typeputAbstractTypes(...)Frame.SAME_FRAMEFrame.APPEND_FRAME/** Puts some abstract types of {@link #currentFrame} in {@link #stackMapTableEntries} , using the ... */putAbstractType(...)/** Puts the given public API frame element type in {@link #stackMapTableEntries} , using the JVMS ... *//** Returns whether the attributes of this method can be copied from the attributes of the given ... */boolean needSyntheticAttribute/** Sets the source from which the attributes of this method will be copied. ... */this.sourceOffsetthis.sourceLength/** Returns the size of the method_info JVMS structure generated by this MethodWriter. Also add the ... */new MethodTooLargeException(...)getExceptionTableSize(...)boolean useStackMapTablestackMapTableEntries.lengthlineNumberTable.lengthlocalVariableTable.lengthlocalVariableTypeTable.lengthcomputeParameterAnnotationsSize(...)lastRuntimeVisibleParameterAnnotations.lengthlastRuntimeInvisibleParameterAnnotations.lengthdefaultValue.length/** Puts the content of the method_info JVMS structure generated by this MethodWriter into the ... */int attributeCountgetSource(...).classFileBufferint codeAttributeCountputExceptionTable(...)stackMapTableEntries.datalineNumberTable.datalocalVariableTable.datalocalVariableTypeTable.dataint exceptionIndexputParameterAnnotations(...)defaultValue.dataparameters.data/** Collects the attributes of this method into the given set of attribute prototypes. ... */// nop = 0 (0x0)// aconst_null = 1 (0x1)// iconst_m1 = 2 (0x2)// iconst_0 = 3 (0x3)// iconst_1 = 4 (0x4)// iconst_2 = 5 (0x5)// iconst_3 = 6 (0x6)// iconst_4 = 7 (0x7)// iconst_5 = 8 (0x8)// lconst_0 = 9 (0x9)// lconst_1 = 10 (0xa)// fconst_0 = 11 (0xb)// fconst_1 = 12 (0xc)// fconst_2 = 13 (0xd)// dconst_0 = 14 (0xe)// dconst_1 = 15 (0xf)// bipush = 16 (0x10)// sipush = 17 (0x11)// ldc = 18 (0x12)// ldc_w = 19 (0x13)// ldc2_w = 20 (0x14)// iload = 21 (0x15)// lload = 22 (0x16)// fload = 23 (0x17)// dload = 24 (0x18)// aload = 25 (0x19)// iload_0 = 26 (0x1a)// iload_1 = 27 (0x1b)// iload_2 = 28 (0x1c)// iload_3 = 29 (0x1d)// lload_0 = 30 (0x1e)// lload_1 = 31 (0x1f)// lload_2 = 32 (0x20)// lload_3 = 33 (0x21)// fload_0 = 34 (0x22)// fload_1 = 35 (0x23)// fload_2 = 36 (0x24)// fload_3 = 37 (0x25)// dload_0 = 38 (0x26)// dload_1 = 39 (0x27)// dload_2 = 40 (0x28)// dload_3 = 41 (0x29)// aload_0 = 42 (0x2a)// aload_1 = 43 (0x2b)// aload_2 = 44 (0x2c)// aload_3 = 45 (0x2d)// iaload = 46 (0x2e)// laload = 47 (0x2f)// faload = 48 (0x30)// daload = 49 (0x31)// aaload = 50 (0x32)// baload = 51 (0x33)// caload = 52 (0x34)// saload = 53 (0x35)// istore = 54 (0x36)// lstore = 55 (0x37)// fstore = 56 (0x38)// dstore = 57 (0x39)// astore = 58 (0x3a)// istore_0 = 59 (0x3b)// istore_1 = 60 (0x3c)// istore_2 = 61 (0x3d)// istore_3 = 62 (0x3e)// lstore_0 = 63 (0x3f)// lstore_1 = 64 (0x40)// lstore_2 = 65 (0x41)// lstore_3 = 66 (0x42)// fstore_0 = 67 (0x43)// fstore_1 = 68 (0x44)// fstore_2 = 69 (0x45)// fstore_3 = 70 (0x46)// dstore_0 = 71 (0x47)// dstore_1 = 72 (0x48)// dstore_2 = 73 (0x49)// dstore_3 = 74 (0x4a)// astore_0 = 75 (0x4b)// astore_1 = 76 (0x4c)// astore_2 = 77 (0x4d)// astore_3 = 78 (0x4e)// iastore = 79 (0x4f)// lastore = 80 (0x50)// fastore = 81 (0x51)// dastore = 82 (0x52)// aastore = 83 (0x53)// bastore = 84 (0x54)// castore = 85 (0x55)// sastore = 86 (0x56)// pop = 87 (0x57)// pop2 = 88 (0x58)// dup = 89 (0x59)// dup_x1 = 90 (0x5a)// dup_x2 = 91 (0x5b)// dup2 = 92 (0x5c)// dup2_x1 = 93 (0x5d)// dup2_x2 = 94 (0x5e)// swap = 95 (0x5f)// iadd = 96 (0x60)// ladd = 97 (0x61)// fadd = 98 (0x62)// dadd = 99 (0x63)// isub = 100 (0x64)// lsub = 101 (0x65)// fsub = 102 (0x66)// dsub = 103 (0x67)// imul = 104 (0x68)// lmul = 105 (0x69)// fmul = 106 (0x6a)// dmul = 107 (0x6b)// idiv = 108 (0x6c)// ldiv = 109 (0x6d)// fdiv = 110 (0x6e)// ddiv = 111 (0x6f)// irem = 112 (0x70)// lrem = 113 (0x71)// frem = 114 (0x72)// drem = 115 (0x73)// ineg = 116 (0x74)// lneg = 117 (0x75)// fneg = 118 (0x76)// dneg = 119 (0x77)// ishl = 120 (0x78)// lshl = 121 (0x79)// ishr = 122 (0x7a)// lshr = 123 (0x7b)// iushr = 124 (0x7c)// lushr = 125 (0x7d)// iand = 126 (0x7e)// land = 127 (0x7f)// ior = 128 (0x80)// lor = 129 (0x81)// ixor = 130 (0x82)// lxor = 131 (0x83)// iinc = 132 (0x84)// i2l = 133 (0x85)// i2f = 134 (0x86)// i2d = 135 (0x87)// l2i = 136 (0x88)// l2f = 137 (0x89)// l2d = 138 (0x8a)// f2i = 139 (0x8b)// f2l = 140 (0x8c)// f2d = 141 (0x8d)// d2i = 142 (0x8e)// d2l = 143 (0x8f)// d2f = 144 (0x90)// i2b = 145 (0x91)// i2c = 146 (0x92)// i2s = 147 (0x93)// lcmp = 148 (0x94)// fcmpl = 149 (0x95)// fcmpg = 150 (0x96)// dcmpl = 151 (0x97)// dcmpg = 152 (0x98)// ifeq = 153 (0x99)// ifne = 154 (0x9a)// iflt = 155 (0x9b)// ifge = 156 (0x9c)// ifgt = 157 (0x9d)// ifle = 158 (0x9e)// if_icmpeq = 159 (0x9f)// if_icmpne = 160 (0xa0)// if_icmplt = 161 (0xa1)// if_icmpge = 162 (0xa2)// if_icmpgt = 163 (0xa3)// if_icmple = 164 (0xa4)// if_acmpeq = 165 (0xa5)// if_acmpne = 166 (0xa6)// goto = 167 (0xa7)// jsr = 168 (0xa8)// ret = 169 (0xa9)// tableswitch = 170 (0xaa)// lookupswitch = 171 (0xab)// ireturn = 172 (0xac)// lreturn = 173 (0xad)// freturn = 174 (0xae)// dreturn = 175 (0xaf)// areturn = 176 (0xb0)// return = 177 (0xb1)// getstatic = 178 (0xb2)// putstatic = 179 (0xb3)// getfield = 180 (0xb4)// putfield = 181 (0xb5)// invokevirtual = 182 (0xb6)// invokespecial = 183 (0xb7)// invokestatic = 184 (0xb8)// invokeinterface = 185 (0xb9)// invokedynamic = 186 (0xba)// new = 187 (0xbb)// newarray = 188 (0xbc)// anewarray = 189 (0xbd)// arraylength = 190 (0xbe)// athrow = 191 (0xbf)// checkcast = 192 (0xc0)// instanceof = 193 (0xc1)// monitorenter = 194 (0xc2)// monitorexit = 195 (0xc3)// wide = 196 (0xc4)// multianewarray = 197 (0xc5)// ifnull = 198 (0xc6)// ifnonnull = 199 (0xc7)// goto_w = 200 (0xc8)// jsr_w = 201 (0xc9)// Update maxLocals and currentLocals.// Create and visit the label for the first basic block.// This should happen only once, for the implicit first frame (which is explicitly visited// in ClassReader if the EXPAND_ASM_INSNS option is used - and COMPUTE_INSERTED_FRAMES// can't be set if EXPAND_ASM_INSNS is not used).// If type is not F_NEW then it is F_INSERT by hypothesis, and currentBlock.frame contains// the stack map frame at the current instruction, computed from the last F_NEW frame and// the bytecode instructions in between (via calls to CurrentFrame#execute).// Add the instruction to the bytecode of the method.// If needed, update the maximum stack size and number of locals, and stack map frames.// BIPUSH or NEWARRAY// The stack size delta is 1 for BIPUSH or SIPUSH, and 0 for NEWARRAY.// No stack size delta.// xLOAD or xSTORE// If there are exception handler blocks, each instruction within a handler range is, in// theory, a basic block (since execution can jump from this instruction to the exception// handler). As a consequence, the local variable types at the beginning of the handler// block should be the merge of the local variable types at all the instructions within the// handler range. However, instead of creating a basic block for each instruction, we can// get the same result in a more efficient way. Namely, by starting a new basic block after// each xSTORE instruction, which is what we do here.// The stack size delta is 1 for NEW, and 0 for ANEWARRAY, CHECKCAST, or INSTANCEOF.// Compute the 'base' opcode, i.e. GOTO or JSR if opcode is GOTO_W or JSR_W, otherwise opcode.// Case of a backward jump with an offset < -32768. In this case we automatically replace GOTO// with GOTO_W, JSR with JSR_W and IFxxx <l> with IFNOTxxx <L> GOTO_W <l> L:..., where// IFNOTxxx is the "opposite" opcode of IFxxx (e.g. IFNE for IFEQ) and where <L> designates// the instruction just after the GOTO_W.// Put the "opposite" opcode of baseOpcode. This can be done by flipping the least// significant bit for IFNULL and IFNONNULL, and similarly for IFEQ ... IF_ACMPEQ (with a// pre and post offset by 1). The jump offset is 8 bytes (3 for IFNOTxxx, 5 for GOTO_W).// Here we could put a GOTO_W in theory, but if ASM specific instructions are used in this// method or another one, and if the class has frames, we will need to insert a frame after// this GOTO_W during the additional ClassReader -> ClassWriter round trip to remove the ASM// specific instructions. To not miss this additional frame, we need to use an ASM_GOTO_W// here, which has the unfortunate effect of forcing this additional round trip (which in// some case would not have been really necessary, but we can't know this at this point).// The instruction after the GOTO_W becomes the target of the IFNOT instruction.// Case of a GOTO_W or JSR_W specified by the user (normally ClassReader when used to remove// ASM specific instructions). In this case we keep the original instruction.// Case of a jump with an offset >= -32768, or of a jump with an unknown offset. In these// cases we store the offset in 2 bytes (which will be increased via a ClassReader ->// ClassWriter round trip if it turns out that 2 bytes are not sufficient).// Record the fact that 'label' is the target of a jump instruction.// Add 'label' as a successor of the current basic block.// The next instruction starts a new basic block (except for GOTO: by default the code// following a goto is unreachable - unless there is an explicit label for it - and we// should not compute stack frame types for its instructions).// No need to update maxRelativeStackSize (the stack size delta is always negative).// Record the fact that 'label' designates a subroutine, if not already done.// Note that, by construction in this method, a block which calls a subroutine has at// least two successors in the control flow graph: the first one (added below) leads to// the instruction after the JSR, while the second one (added here) leads to the JSR// target. Note that the first successor is virtual (it does not correspond to a possible// execution path): it is only used to compute the successors of the basic blocks ending// with a ret, in {@link Label#addSubroutineRetSuccessors}.// The instruction after the JSR starts a new basic block.// If the next instruction starts a new basic block, call visitLabel to add the label of this// instruction as a successor of the current block, and to start a new basic block.// Resolve the forward references to this label, if any.// visitLabel starts a new basic block (except for debug only labels), so we need to update the// previous and current block references and list of successors.// We use {@link Label#getCanonicalInstance} to store the state of a basic block in only// one place, but this does not work for labels which have not been visited yet.// Therefore, when we detect here two labels having the same bytecode offset, we need to// - consolidate the state scattered in these two instances into the canonical instance:// - make sure the two instances share the same Frame instance (the implementation of// {@link Label#getCanonicalInstance} relies on this property; here label.frame should be// null):// - and make sure to NOT assign 'label' into 'currentBasicBlock' or 'lastBasicBlock', so// that they still refer to the canonical instance for this bytecode offset.// End the current basic block (with one new successor).// Append 'label' at the end of the basic block list.// Same comment as above.// Here label.frame should be null.// Make it the new current basic block.// This case should happen only once, for the visitLabel call in the constructor. Indeed, if// compute is equal to COMPUTE_INSERTED_FRAMES, currentBasicBlock stays unchanged.// Update the frame owner so that a correct frame offset is computed in Frame.accept().// Start a new current basic block, and reset the current and maximum relative stack sizes.// Append the new basic block at the end of the basic block list.// compute is equal to COMPUTE_MAX_STACK_AND_LOCAL_FROM_FRAMES, currentBasicBlock stays// unchanged.// Add all the labels as successors of the current basic block.// End the current basic block.// Complete the control flow graph with exception handler blocks.// Mark handlerBlock as an exception handler.// Add handlerBlock as a successor of all the basic blocks in the exception handler range.// Create and visit the first (implicit) frame.// Fix point algorithm: add the first basic block to a list of blocks to process (i.e. blocks// whose stack map frame has changed) and, while there are blocks to process, remove one from// the list and update the stack map frames of its successor blocks in the control flow graph// (which might change them, in which case these blocks must be processed too, and are thus// added to the list of blocks to process). Also compute the maximum stack size of the method,// as a by-product.// By definition, basicBlock is reachable.// Update the (absolute) maximum stack size.// Update the successor blocks of basicBlock in the control flow graph.// If successorBlock has changed it must be processed. Thus, if it is not already in the// list of blocks to process, add it to this list.// Loop over all the basic blocks and visit the stack map frames that must be stored in the// StackMapTable attribute. Also replace unreachable code with NOP* ATHROW, and remove it from// exception handler ranges.// Find the start and end bytecode offsets of this unreachable block.// Replace its instructions with NOP ... NOP ATHROW.// Emit a frame for this unreachable block, with no local and a Throwable on the stack// (so that the ATHROW could consume this Throwable if it were reachable)./* numLocal = *//* numStack = */// Remove this unreachable basic block from the exception handler ranges.// The maximum stack size is now at least one, because of the Throwable declared above.// If handlerRangeBlock is a JSR block, add handlerBlock after the first two outgoing// edges to preserve the hypothesis about JSR block successors order (see// {@link #visitJumpInsn}).// Complete the control flow graph with the successor blocks of subroutines, if needed.// First step: find the subroutines. This step determines, for each basic block, to which// subroutine(s) it belongs. Start with the main "subroutine":// Then, mark the subroutines called by the main subroutine, then the subroutines called by// those called by the main subroutine, etc.// If this subroutine has not been marked yet, find its basic blocks.// Second step: find the successors in the control flow graph of each subroutine basic block// 'r' ending with a RET instruction. These successors are the virtual successors of the basic// blocks ending with JSR instructions (see {@link #visitJumpInsn)} that can reach 'r'.// By construction, jsr targets are stored in the second outgoing edge of basic blocks// that ends with a jsr instruction (see {@link #FLAG_SUBROUTINE_CALLER}).// Data flow algorithm: put the first basic block in a list of blocks to process (i.e. blocks// whose input stack size has changed) and, while there are blocks to process, remove one// from the list, update the input stack size of its successor blocks in the control flow// graph, and add these blocks to the list of blocks to process (if not already done).// Remove a basic block from the list of blocks to process. Note that we don't reset// basicBlock.nextListElement to null on purpose, to make sure we don't reprocess already// processed basic blocks.// Compute the (absolute) input stack size and maximum stack size of this block.// Update the absolute maximum stack size of the method.// Update the input stack size of the successor blocks of basicBlock in the control flow// graph, and add these blocks to the list of blocks to process, if not already done.// Ignore the first outgoing edge of the basic blocks ending with a jsr: these are virtual// edges which lead to the instruction just after the jsr, and do not correspond to a// possible execution path (see {@link #visitJumpInsn} and// {@link Label#FLAG_SUBROUTINE_CALLER}).// Generate a StackMap attribute entry, which are always uncompressed.// Keep the FULL_FRAME type.// Verify if locals are the same as in the previous frame.// If the method descriptor has changed, with more locals than the max_locals field of the// original Code attribute, if any, then the original method attributes can't be copied. A// conservative check on the descriptor changes alone ensures this (being more precise is not// worth the additional complexity, because these cases should be rare -- if a transform changes// a method descriptor, most of the time it needs to change the method's code too).// Don't copy the attributes yet, instead store their location in the source class reader so// they can be copied later, in {@link #putMethodInfo}. Note that we skip the 6 header bytes// of the method_info JVMS structure.// If this method_info must be copied from an existing one, the size computation is trivial.// sourceLength excludes the first 6 bytes for access_flags, name_index and descriptor_index.// 2 bytes each for access_flags, name_index, descriptor_index and attributes_count.// The Code attribute has 6 header bytes, plus 2, 2, 4 and 2 bytes respectively for max_stack,// max_locals, code_length and attributes_count, plus the bytecode and the exception table.// 6 header bytes and 2 bytes for number_of_entries.// 6 header bytes and 2 bytes for line_number_table_length.// 6 header bytes and 2 bytes for local_variable_table_length.// 6 header bytes and 2 bytes for local_variable_type_table_length.// 6 header bytes and 1 byte for parameters_count.// If this method_info must be copied from an existing one, copy it now and return early.// 2, 2, 4 and 2 bytes respectively for max_stack, max_locals, code_length and// attributes_count, plus the bytecode and the exception table./** A visitor to visit a Java module. The methods of this class must be called in the following ... */ModuleVisitor mv, ...;/** The module visitor to which this visitor must delegate method calls. May be {@literal null}. *//** Constructs a new {@link ModuleVisitor}. ... *//** Visit the main class of the current module. ... *//** Visit a package of the current module. ... *//** Visits a dependence of the current module. ... *//** Visit an exported package of the current module. ... *//** Visit an open package of the current module. ... *//** Visit a service used by the current module. The name must be the internal name of an interface ... *//** Visit an implementation of a service. ... *//** Visits the end of the module. This method, which is the last one to be called, is used to ... *//** A {@link ModuleVisitor} that generates the corresponding Module, ModulePackages and ... */int moduleNameIndex, ...;/** The module_name_index field of the JVMS Module attribute. */int moduleFlags, ...;/** The module_flags field of the JVMS Module attribute. */int moduleVersionIndex, ...;/** The module_version_index field of the JVMS Module attribute. */int requiresCount, ...;/** The requires_count field of the JVMS Module attribute. */ByteVector requires, ...;/** The binary content of the 'requires' array of the JVMS Module attribute. */int exportsCount, ...;/** The exports_count field of the JVMS Module attribute. */ByteVector exports, ...;/** The binary content of the 'exports' array of the JVMS Module attribute. */int opensCount, ...;/** The opens_count field of the JVMS Module attribute. */ByteVector opens, ...;/** The binary content of the 'opens' array of the JVMS Module attribute. */int usesCount, ...;/** The uses_count field of the JVMS Module attribute. */ByteVector usesIndex, ...;/** The binary content of the 'uses_index' array of the JVMS Module attribute. */int providesCount, ...;/** The provides_count field of the JVMS Module attribute. */ByteVector provides, ...;/** The binary content of the 'provides' array of the JVMS Module attribute. */int packageCount, ...;/** The provides_count field of the JVMS ModulePackages attribute. */ByteVector packageIndex, ...;/** The binary content of the 'package_index' array of the JVMS ModulePackages attribute. */int mainClassIndex, ...;/** The main_class_index field of the JVMS ModuleMainClass attribute, or 0. */this.moduleNameIndexthis.moduleFlagsthis.moduleVersionIndexthis.requiresthis.exportsthis.opensthis.usesIndexthis.providesthis.packageIndexthis.mainClassIndexmodules.lengthString moduleproviders.lengthString provider/** Returns the number of Module, ModulePackages and ModuleMainClass attributes generated by this ... *//** Returns the size of the Module, ModulePackages and ModuleMainClass attributes generated by this ... */provides.lengthusesIndex.lengthopens.lengthexports.lengthrequires.lengthpackageIndex.length/** Puts the Module, ModulePackages and ModuleMainClass attributes generated by this ModuleWriter ... */int moduleAttributeLengthprovides.datausesIndex.dataopens.dataexports.datarequires.datapackageIndex.data// 6 attribute header bytes, 6 bytes for name, flags and version, and 5 * 2 bytes for counts.// 6 attribute header bytes, and 2 bytes for package_count.// 6 attribute header bytes, and 2 bytes for main_class_index.// 6 bytes for name, flags and version, and 5 * 2 bytes for counts.// DontCheck(InterfaceIsType): can't be fixed (for backward binary compatibility)./** The JVM opcodes, access flags and array type codes. This interface does not define all the JVM ... */int ASM4, ...;// ASM API versions.int ASM5, ...;int ASM6, ...;int ASM7, ...;int ASM8, ...;int ASM9, ...;int ASM10_EXPERIMENTAL, ...;/** <i>Experimental, use at your own risk. This field will be renamed when it becomes stable, this ... */int SOURCE_DEPRECATED, ...;/* Internal flags used to redirect calls to deprecated methods. For instance, if a visitOldStuff ... */int SOURCE_MASK, ...;int V1_1, ...;// major version in the 16 least significant bits).// Java ClassFile versions (the minor version is stored in the 16 most significant bits, and theint V1_2, ...;int V1_3, ...;int V1_4, ...;int V1_5, ...;int V1_6, ...;int V1_7, ...;int V1_8, ...;int V9, ...;int V10, ...;int V11, ...;int V12, ...;int V13, ...;int V14, ...;int V15, ...;int V16, ...;int V17, ...;int V_PREVIEW, ...;/** Version flag indicating that the class is using 'preview' features. ... */int ACC_PUBLIC, ...;// - https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.7.25// - https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.6-200-A.1// - https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.5-200-A.1// - https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.1-200-E.1// Access flags values, defined inint ACC_PRIVATE, ...;// class, field, methodint ACC_PROTECTED, ...;int ACC_STATIC, ...;int ACC_FINAL, ...;// field, methodint ACC_SUPER, ...;// class, field, method, parameterint ACC_SYNCHRONIZED, ...;// classint ACC_OPEN, ...;// methodint ACC_TRANSITIVE, ...;// moduleint ACC_VOLATILE, ...;// module requiresint ACC_BRIDGE, ...;// fieldint ACC_STATIC_PHASE, ...;int ACC_VARARGS, ...;int ACC_TRANSIENT, ...;int ACC_NATIVE, ...;int ACC_INTERFACE, ...;int ACC_ABSTRACT, ...;int ACC_STRICT, ...;// class, methodint ACC_SYNTHETIC, ...;int ACC_ANNOTATION, ...;// class, field, method, parameter, module *int ACC_ENUM, ...;int ACC_MANDATED, ...;// class(?) field innerint ACC_MODULE, ...;// field, method, parameter, module, module *int ACC_RECORD, ...;int ACC_DEPRECATED, ...;int T_BOOLEAN, ...;// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-6.html#jvms-6.5.newarray.// Possible values for the type operand of the NEWARRAY instruction.int T_CHAR, ...;int T_FLOAT, ...;int T_DOUBLE, ...;int T_BYTE, ...;int T_SHORT, ...;int T_INT, ...;int T_LONG, ...;int H_GETFIELD, ...;// See https://docs.oracle.com/javase/specs/jvms/se9/html/jvms-4.html#jvms-4.4.8.// Possible values for the reference_kind field of CONSTANT_MethodHandle_info structures.int H_GETSTATIC, ...;int H_PUTFIELD, ...;int H_PUTSTATIC, ...;int H_INVOKEVIRTUAL, ...;int H_INVOKESTATIC, ...;int H_INVOKESPECIAL, ...;int H_NEWINVOKESPECIAL, ...;int H_INVOKEINTERFACE, ...;int F_NEW, ...;/** An expanded frame. See {@link ClassReader#EXPAND_FRAMES}. */int F_FULL, ...;/** A compressed frame with complete frame data. */int F_APPEND, ...;/** A compressed frame where locals are the same as the locals in the previous frame, except that ... */int F_CHOP, ...;int F_SAME, ...;/** A compressed frame with exactly the same locals as the previous frame and with an empty stack. */int F_SAME1, ...;/** A compressed frame with exactly the same locals as the previous frame and with a single value ... */Integer TOP, ...;// Standard stack map frame element types, used in {@link ClassVisitor#visitFrame}.Integer INTEGER, ...;Integer FLOAT, ...;Integer DOUBLE, ...;Integer LONG, ...;Integer NULL, ...;Integer UNINITIALIZED_THIS, ...;int NOP, ...;// where '-' means 'same method name as on the previous line').// The JVM opcode values (with the MethodVisitor method name used to visit them in comment, andint ACONST_NULL, ...;// visitInsnint ICONST_M1, ...;// -int ICONST_0, ...;int ICONST_1, ...;int ICONST_2, ...;int ICONST_3, ...;int ICONST_4, ...;int ICONST_5, ...;int LCONST_0, ...;int LCONST_1, ...;int FCONST_0, ...;int FCONST_1, ...;int FCONST_2, ...;int DCONST_0, ...;int DCONST_1, ...;int BIPUSH, ...;int SIPUSH, ...;// visitIntInsnint LDC, ...;int ILOAD, ...;// visitLdcInsnint LLOAD, ...;// visitVarInsnint FLOAD, ...;int DLOAD, ...;int ALOAD, ...;int IALOAD, ...;int LALOAD, ...;int FALOAD, ...;int DALOAD, ...;int AALOAD, ...;int BALOAD, ...;int CALOAD, ...;int SALOAD, ...;int ISTORE, ...;int LSTORE, ...;int FSTORE, ...;int DSTORE, ...;int ASTORE, ...;int IASTORE, ...;int LASTORE, ...;int FASTORE, ...;int DASTORE, ...;int AASTORE, ...;int BASTORE, ...;int CASTORE, ...;int SASTORE, ...;int POP, ...;int POP2, ...;int DUP, ...;int DUP_X1, ...;int DUP_X2, ...;int DUP2, ...;int DUP2_X1, ...;int DUP2_X2, ...;int SWAP, ...;int IADD, ...;int LADD, ...;int FADD, ...;int DADD, ...;int ISUB, ...;int LSUB, ...;int FSUB, ...;int DSUB, ...;int IMUL, ...;int LMUL, ...;int FMUL, ...;int DMUL, ...;int IDIV, ...;int LDIV, ...;int FDIV, ...;int DDIV, ...;int IREM, ...;int LREM, ...;int FREM, ...;int DREM, ...;int INEG, ...;int LNEG, ...;int FNEG, ...;int DNEG, ...;int ISHL, ...;int LSHL, ...;int ISHR, ...;int LSHR, ...;int IUSHR, ...;int LUSHR, ...;int IAND, ...;int LAND, ...;int IOR, ...;int LOR, ...;int IXOR, ...;int LXOR, ...;int IINC, ...;int I2L, ...;// visitIincInsnint I2F, ...;int I2D, ...;int L2I, ...;int L2F, ...;int L2D, ...;int F2I, ...;int F2L, ...;int F2D, ...;int D2I, ...;int D2L, ...;int D2F, ...;int I2B, ...;int I2C, ...;int I2S, ...;int LCMP, ...;int FCMPL, ...;int FCMPG, ...;int DCMPL, ...;int DCMPG, ...;int IFEQ, ...;int IFNE, ...;// visitJumpInsnint IFLT, ...;int IFGE, ...;int IFGT, ...;int IFLE, ...;int IF_ICMPEQ, ...;int IF_ICMPNE, ...;int IF_ICMPLT, ...;int IF_ICMPGE, ...;int IF_ICMPGT, ...;int IF_ICMPLE, ...;int IF_ACMPEQ, ...;int IF_ACMPNE, ...;int GOTO, ...;int JSR, ...;int RET, ...;int TABLESWITCH, ...;int LOOKUPSWITCH, ...;// visiTableSwitchInsnint IRETURN, ...;// visitLookupSwitchint LRETURN, ...;int FRETURN, ...;int DRETURN, ...;int ARETURN, ...;int RETURN, ...;int GETSTATIC, ...;int PUTSTATIC, ...;// visitFieldInsnint GETFIELD, ...;int PUTFIELD, ...;int INVOKEVIRTUAL, ...;int INVOKESPECIAL, ...;// visitMethodInsnint INVOKESTATIC, ...;int INVOKEINTERFACE, ...;int INVOKEDYNAMIC, ...;int NEW, ...;// visitInvokeDynamicInsnint NEWARRAY, ...;// visitTypeInsnint ANEWARRAY, ...;int ARRAYLENGTH, ...;int ATHROW, ...;int CHECKCAST, ...;int INSTANCEOF, ...;int MONITORENTER, ...;int MONITOREXIT, ...;int MULTIANEWARRAY, ...;int IFNULL, ...;// visitMultiANewArrayInsnint IFNONNULL, ...;/** A visitor to visit a record component. The methods of this class must be called in the following ... */RecordComponentVisitor delegate, ...;/* package-private *//** The record visitor to which this visitor must delegate method calls. May be {@literal null}. *//** Constructs a new {@link RecordComponentVisitor}. ... *//** The record visitor to which this visitor must delegate method calls. May be {@literal null}. ... *//** Visits an annotation of the record component. ... *//** Visits an annotation on a type in the record component signature. ... *//** Visits a non standard attribute of the record component. ... *//** Visits the end of the record component. This method, which is the last one to be called, is ... *//** Where the constants used in this RecordComponentWriter must be stored. *//** The name_index field of the Record attribute. */// attributes are ordered as in Section 4.7 of the JVMS.// Note: fields are ordered as in the record_component_info structure, and those related to/** The descriptor_index field of the the Record attribute. *//** The signature_index field of the Signature attribute of this record component, or 0 if there is ... *//** The last runtime visible annotation of this record component. The previous ones can be accessed ... *//** The last runtime invisible annotation of this record component. The previous ones can be ... *//** The last runtime visible type annotation of this record component. The previous ones can be ... *//** The last runtime invisible type annotation of this record component. The previous ones can be ... *//** The first non standard attribute of this record component. The next ones can be accessed with ... *//** Constructs a new {@link RecordComponentWriter}. ... *//** Returns the size of the record component JVMS structure generated by this ... *//** Puts the content of the record component generated by this RecordComponentWriter into the given ... *//** Collects the attributes of this record component into the given set of attribute prototypes. ... */// name_index, descriptor_index and attributes_count fields use 6 bytes./** Utility class exposing constants related to Spring's internal repackaging ... */int ASM_VERSION, ...;/** The ASM compatibility version for Spring's ASM visitor implementations: ... *//** An entry of the constant pool, of the BootstrapMethods attribute, or of the (ASM specific) type ... */int CONSTANT_CLASS_TAG, ...;/** The tag value of CONSTANT_Class_info JVMS structures. */// Tag values for the constant pool entries (using the same order as in the JVMS).int CONSTANT_FIELDREF_TAG, ...;/** The tag value of CONSTANT_Fieldref_info JVMS structures. */int CONSTANT_METHODREF_TAG, ...;/** The tag value of CONSTANT_Methodref_info JVMS structures. */int CONSTANT_INTERFACE_METHODREF_TAG, ...;/** The tag value of CONSTANT_InterfaceMethodref_info JVMS structures. */int CONSTANT_STRING_TAG, ...;/** The tag value of CONSTANT_String_info JVMS structures. */int CONSTANT_INTEGER_TAG, ...;/** The tag value of CONSTANT_Integer_info JVMS structures. */int CONSTANT_FLOAT_TAG, ...;/** The tag value of CONSTANT_Float_info JVMS structures. */int CONSTANT_LONG_TAG, ...;/** The tag value of CONSTANT_Long_info JVMS structures. */int CONSTANT_DOUBLE_TAG, ...;/** The tag value of CONSTANT_Double_info JVMS structures. */int CONSTANT_NAME_AND_TYPE_TAG, ...;/** The tag value of CONSTANT_NameAndType_info JVMS structures. */int CONSTANT_UTF8_TAG, ...;/** The tag value of CONSTANT_Utf8_info JVMS structures. */int CONSTANT_METHOD_HANDLE_TAG, ...;/** The tag value of CONSTANT_MethodHandle_info JVMS structures. */int CONSTANT_METHOD_TYPE_TAG, ...;/** The tag value of CONSTANT_MethodType_info JVMS structures. */int CONSTANT_DYNAMIC_TAG, ...;/** The tag value of CONSTANT_Dynamic_info JVMS structures. */int CONSTANT_INVOKE_DYNAMIC_TAG, ...;/** The tag value of CONSTANT_InvokeDynamic_info JVMS structures. */int CONSTANT_MODULE_TAG, ...;/** The tag value of CONSTANT_Module_info JVMS structures. */int CONSTANT_PACKAGE_TAG, ...;/** The tag value of CONSTANT_Package_info JVMS structures. */int BOOTSTRAP_METHOD_TAG, ...;/** The tag value of the BootstrapMethods attribute entries. */// Tag values for the BootstrapMethods attribute entries (ASM specific tag).int TYPE_TAG, ...;/** The tag value of a normal type entry in the (ASM specific) type table of a class. */// Tag values for the type table entries (ASM specific tags).int UNINITIALIZED_TYPE_TAG, ...;/** The tag value of an {@link Frame#ITEM_UNINITIALIZED} type entry in the type table of a class. */int MERGED_TYPE_TAG, ...;/** The tag value of a merged type entry in the (ASM specific) type table of a class. *//** The index of this symbol in the constant pool, in the BootstrapMethods attribute, or in the ... */// Instance fields./** A tag indicating the type of this symbol. Must be one of the static tag values defined in this ... *//** The internal name of the owner class of this symbol. Only used for {@link ... *//** The name of the class field or method corresponding to this symbol. Only used for {@link ... *//** The string value of this symbol. This is: ... */long data, ...;/** The numeric value of this symbol. This is: ... *//** Additional information about this symbol, generally computed lazily. <i>Warning: the value of ... *//** Constructs a new Symbol. This constructor can't be used directly because the Symbol class is ... *//** Returns the result {@link Type#getArgumentsAndReturnSizes} on {@link #value}. ... *//** The constant pool entries, the BootstrapMethods attribute entries and the (ASM specific) type ... */ClassWriter classWriter, ...;/** The ClassWriter to which this SymbolTable belongs. This is only used to get access to {@link ... */ClassReader sourceClassReader, ...;/** The ClassReader from which this SymbolTable was constructed, or {@literal null} if it was ... */int majorVersion, ...;/** The major version number of the class to which this symbol table belongs. *//** The internal name of the class to which this symbol table belongs. */int entryCount, ...;/** The total number of {@link Entry} instances in {@link #entries}. This includes entries that are ... */...[] entries, ...;/** A hash set of all the entries in this SymbolTable (this includes the constant pool entries, the ... *//** The number of constant pool items in {@link #constantPool}, plus 1. The first constant pool ... */ByteVector constantPool, ...;/** The content of the ClassFile's constant_pool JVMS structure corresponding to this SymbolTable. ... */int bootstrapMethodCount, ...;/** The number of bootstrap methods in {@link #bootstrapMethods}. Corresponds to the ... */ByteVector bootstrapMethods, ...;/** The content of the BootstrapMethods attribute 'bootstrap_methods' array corresponding to this ... */int typeCount, ...;/** The actual number of elements in {@link #typeTable}. These elements are stored from index 0 to ... */...[] typeTable, ...;/** An ASM specific type table used to temporarily store internal names that will not necessarily ... *//** Constructs a new, empty SymbolTable for the given ClassWriter. ... */this.classWriterthis.sourceClassReaderthis.entriesnew Entry[]this.constantPool/** Constructs a new SymbolTable for the given ClassWriter, initialized with the constant pool and ... */byte[] inputBytesint constantPoolOffsetgetItem(...)int constantPoolLengthclassReader.headergetMaxStringLength(...)int itemIndexgetItemCount(...)int itemOffsetint itemTagint nameAndTypeItemOffsetint memberRefItemOffsetaddConstantMemberReference(...)addConstantIntegerOrFloat(...)addConstantLongOrDouble(...)addConstantDynamicOrInvokeDynamicReference(...)addConstantUtf8Reference(...)copyBootstrapMethods(...)/** Read the BootstrapMethods 'bootstrap_methods' array binary content and add them as entries of ... */int bootstrapMethodsOffsetint bootstrapMethodsLengthint bootstrapMethodRefint numBootstrapArgumentsint bootstrapArgument...^=...Symbol.BOOTSTRAP_METHOD_TAG/** Returns the ClassReader from which this SymbolTable was constructed. ... *//** Returns the major version of the class to which this symbol table belongs. ... *//** Returns the internal name of the class to which this symbol table belongs. ... *//** Sets the major version and the name of the class to which this symbol table belongs. Also adds ... */this.majorVersion/** Returns the number of items in this symbol table's constant_pool array (plus 1). ... *//** Returns the length in bytes of this symbol table's constant_pool array. ... */constantPool.length/** Puts this symbol table's constant_pool array in the given ByteVector, preceded by the ... */constantPool.data/** Returns the size in bytes of this symbol table's BootstrapMethods attribute. Also adds the ... */bootstrapMethods.length/** Puts this symbol table's BootstrapMethods attribute in the given ByteVector. This includes the ... */bootstrapMethods.data/** Returns the list of entries which can potentially have the given hash code. ... */// Generic symbol table entries management.entries.length/** Puts the given entry in the {@link #entries} hash set. This method does <i>not</i> check ... */entry.hashCodeint currentCapacityint newCapacityEntry[] newEntriesEntry currentEntryint newCurrentEntryIndexcurrentEntry.hashCodeEntry nextEntrycurrentEntry.nextentry.next/** Adds the given entry in the {@link #entries} hash set. This method does <i>not</i> check ... *//** Adds a number or string constant to the constant pool of this symbol table. Does nothing if the ... */// Constant pool entries management.addConstantString(...)int typeSortType.OBJECTgetInternalName(...)getTag(...)getOwner(...)getDesc(...)getBootstrapMethod(...)getBootstrapMethodArgumentsUnsafe(...)/** Adds a CONSTANT_Class_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Fieldref_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Methodref_info or CONSTANT_InterfaceMethodref_info to the constant pool of this ... *//** Adds a CONSTANT_Fieldref_info, CONSTANT_Methodref_info or CONSTANT_InterfaceMethodref_info to ... */entry.tagentry.ownerentry.nameentry.valueput122(...)/** Adds a new CONSTANT_Fieldref_info, CONSTANT_Methodref_info or CONSTANT_InterfaceMethodref_info ... *//** Adds a CONSTANT_String_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Integer_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Float_info to the constant pool of this symbol table. Does nothing if the ... */floatToRawIntBits(...)/** Adds a CONSTANT_Integer_info or CONSTANT_Float_info to the constant pool of this symbol table. ... */entry.data/** Adds a new CONSTANT_Integer_info or CONSTANT_Float_info to the constant pool of this symbol ... *//** Adds a CONSTANT_Long_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Double_info to the constant pool of this symbol table. Does nothing if the ... */doubleToRawLongBits(...)/** Adds a CONSTANT_Long_info or CONSTANT_Double_info to the constant pool of this symbol table. ... */putLong(...)/** Adds a new CONSTANT_Long_info or CONSTANT_Double_info to the constant pool of this symbol ... *//** Adds a CONSTANT_NameAndType_info to the constant pool of this symbol table. Does nothing if the ... */entry.indexput(...).index/** Adds a new CONSTANT_NameAndType_info to the constant pool of this symbol table. ... *//** Adds a CONSTANT_Utf8_info to the constant pool of this symbol table. Does nothing if the ... */putUTF8(...)/** Adds a new CONSTANT_String_info to the constant pool of this symbol table. ... *//** Adds a CONSTANT_MethodHandle_info to the constant pool of this symbol table. Does nothing if ... */Opcodes.H_PUTSTATICput112(...)/** Adds a new CONSTANT_MethodHandle_info to the constant pool of this symbol table. ... *//** Adds a CONSTANT_MethodType_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Dynamic_info to the constant pool of this symbol table. Also adds the related ... */Symbol bootstrapMethodaddBootstrapMethod(...)bootstrapMethod.index/** Adds a CONSTANT_InvokeDynamic_info to the constant pool of this symbol table. Also adds the ... *//** Adds a CONSTANT_Dynamic or a CONSTANT_InvokeDynamic_info to the constant pool of this symbol ... *//** Adds a new CONSTANT_Dynamic_info or CONSTANT_InvokeDynamic_info to the constant pool of this ... *//** Adds a CONSTANT_Module_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Package_info to the constant pool of this symbol table. Does nothing if the ... *//** Adds a CONSTANT_Class_info, CONSTANT_String_info, CONSTANT_MethodType_info, ... *//** Adds a new CONSTANT_Class_info, CONSTANT_String_info, CONSTANT_MethodType_info, ... *//** Adds a bootstrap method to the BootstrapMethods attribute of this symbol table. Does nothing if ... */// Bootstrap method entries management.ByteVector bootstrapMethodsAttributeint[] bootstrapMethodArgumentIndexesbootstrapMethodsAttribute.lengthint bootstrapMethodlengthObject bootstrapMethodArgumentbyte[] bootstrapMethodsDataint otherOffsetboolean isSameBootstrapMethod/** Returns the type table element whose index is given. ... */// Type table entries management./** Adds a type in the type table of this symbol table. Does nothing if the type table already ... */Symbol.TYPE_TAGaddTypeInternal(...)/** Adds an {@link Frame#ITEM_UNINITIALIZED} type in the type table of this symbol table. Does ... */Symbol.UNINITIALIZED_TYPE_TAG/** Adds a merged type in the type table of this symbol table. Does nothing if the type table ... */long dataSymbol.MERGED_TYPE_TAGString type1...[...].valueString type2int commonSuperTypeIndexgetCommonSuperClass(...)entry.infoput(...).info/** Adds the given type Symbol to {@link #typeTable}. ... */Entry[] newTypeTable// Static helper methods to compute hash codes./** An entry of a SymbolTable. This concrete and private subclass of {@link Symbol} adds two fields ... *//** The hash code of this entry. */Entry next, ...;/** Another entry (and so on recursively) having the same hash code (modulo the size of {@link ... */// Copy the constant pool binary content.// Add the constant pool items in the symbol table entries. Reserve enough space in 'entries' to// avoid too many hash set collisions (entries is not dynamically resized by the addConstant*// method calls below), and to account for bootstrap method entries.// Copy the BootstrapMethods, if any.// Find attributOffset of the 'bootstrap_methods' array.// Compute the offset and the length of the BootstrapMethods 'bootstrap_methods' array.// Add each bootstrap method in the symbol table entries.// type is a primitive or array type.// Note that we don't need to include isInterface in the hash computation, because it is// redundant with owner (we can't have the same owner with different isInterface values).// The bootstrap method arguments can be Constant_Dynamic values, which reference other// bootstrap methods. We must therefore add the bootstrap method arguments to the constant pool// and BootstrapMethods attribute first, so that the BootstrapMethods attribute is not modified// while adding the given bootstrap method to it, in the rest of this method.// Write the bootstrap method in the BootstrapMethods table. This is necessary to be able to// compare it with existing ones, and will be reverted below if there is already a similar// bootstrap method.// Compute the length and the hash code of the bootstrap method.// Add the bootstrap method to the symbol table or revert the above changes.// Revert to old position./* owner = *//* name = *//* data = *//* value = *//** A Java field or method type. This class can be used to make it easier to manipulate type and ... */int VOID, ...;/** The sort of the {@code void} type. See {@link #getSort}. *//** The sort of the {@code boolean} type. See {@link #getSort}. *//** The sort of the {@code char} type. See {@link #getSort}. *//** The sort of the {@code byte} type. See {@link #getSort}. *//** The sort of the {@code short} type. See {@link #getSort}. */int INT, ...;/** The sort of the {@code int} type. See {@link #getSort}. *//** The sort of the {@code float} type. See {@link #getSort}. *//** The sort of the {@code long} type. See {@link #getSort}. *//** The sort of the {@code double} type. See {@link #getSort}. */int ARRAY, ...;/** The sort of array reference types. See {@link #getSort}. */int OBJECT, ...;/** The sort of object reference types. See {@link #getSort}. */int METHOD, ...;/** The sort of method types. See {@link #getSort}. */int INTERNAL, ...;/** The (private) sort of object reference types represented with an internal name. */String PRIMITIVE_DESCRIPTORS, ...;/** The descriptors of the primitive types. */Type VOID_TYPE, ...;/** The {@code void} type. */Type BOOLEAN_TYPE, ...;/** The {@code boolean} type. */Type CHAR_TYPE, ...;/** The {@code char} type. */Type BYTE_TYPE, ...;/** The {@code byte} type. */Type SHORT_TYPE, ...;/** The {@code short} type. */Type INT_TYPE, ...;/** The {@code int} type. */Type FLOAT_TYPE, ...;/** The {@code float} type. */Type LONG_TYPE, ...;/** The {@code long} type. */Type DOUBLE_TYPE, ...;/** The {@code double} type. */int sort, ...;/** The sort of this type. Either {@link #VOID}, {@link #BOOLEAN}, {@link #CHAR}, {@link #BYTE}, ... */// FieldsString valueBuffer, ...;/** A buffer containing the value of this field or method type. This value is an internal name for ... */int valueBegin, ...;/** The beginning index, inclusive, of the value of this Java field or method type in {@link ... */int valueEnd, ...;/** The end index, exclusive, of the value of this Java field or method type in {@link ... *//** Constructs a reference type. ... */this.valueBufferthis.valueBeginthis.valueEnd/** Returns the {@link Type} corresponding to the given type descriptor. ... */// Methods to get Type(s) from a descriptor, a reflected Method or Constructor, other types, etc.getTypeInternal(...)/** Returns the {@link Type} corresponding to the given class. ... */Boolean.TYPEByte.TYPECharacter.TYPEShort.TYPEDouble.TYPEFloat.TYPELong.TYPE/** Returns the method {@link Type} corresponding to the given constructor. ... */getConstructorDescriptor(...)/** Returns the method {@link Type} corresponding to the given method. ... */getMethodDescriptor(...)/** Returns the type of the elements of this array type. This method should only be used for an ... */int numDimensionsgetDimensions(...)/** Returns the {@link Type} corresponding to the given internal name. ... *//** Returns the {@link Type} corresponding to the given method descriptor. Equivalent to <code> ... *//** Returns the method {@link Type} corresponding to the given argument and return types. ... *//** Returns the argument types of methods of this type. This method should only be used for method ... *//** Returns the {@link Type} values corresponding to the argument types of the given method ... */int numArgumentTypesType[] argumentTypesint currentArgumentTypeIndexint semiColumnOffsetint currentArgumentTypeOffset/** Returns the {@link Type} values corresponding to the argument types of the given method. ... */Type[] types/** Returns the return type of methods of this type. This method should only be used for method ... *//** Returns the {@link Type} corresponding to the return type of the given method descriptor. ... *//** Returns the {@link Type} corresponding to the return type of the given method. ... *//** Returns the start index of the return type of the given method descriptor. ... *//** Returns the {@link Type} corresponding to the given field or method descriptor. ... *//** Returns the binary name of the class corresponding to this type. This method must not be used ... */// Methods to get class names, internal names or descriptors.StringBuilder stringBuildergetElementType(...)/** Returns the internal name of the class corresponding to this object or array type. The internal ... *//** Returns the internal name of the given class. The internal name of a class is its fully ... *//** Returns the descriptor corresponding to this type. ... *//** Returns the descriptor corresponding to the given class. ... */appendDescriptor(...)/** Returns the descriptor corresponding to the given constructor. ... */Class<?>[] parametersClass<?> parameter/** Returns the descriptor corresponding to the given argument and return types. ... *//** Returns the descriptor corresponding to the given method. ... *//** Appends the descriptor corresponding to this type to the given string buffer. ... *//** Appends the descriptor of the given class to the given string builder. ... */char descriptor/** Returns the sort of this type. ... */// Methods to get the sort, dimension, size, and opcodes corresponding to a Type or descriptor./** Returns the number of dimensions of this array type. This method should only be used for an ... *//** Returns the size of values of this type. This method must not be used for method types. ... *//** Returns the size of the arguments and of the return value of methods of this type. This method ... *//** Computes the size of the arguments and of the return value of a method. ... */int currentCharint returnSize/** Returns a JVM instruction opcode adapted to this {@link Type}. This method must not be used for ... *//** Tests if the given object is equal to this type. ... */// Equals, hashCode and toString.Type otherint beginint endint otherBeginother.valueBeginint otherEndother.valueEndother.sortother.valueBuffer/** Returns a hash code value for this type. ... *//** Returns a string representation of this type. ... */// First step: compute the number of argument types in methodDescriptor.// Skip the first character, which is always a '('.// Parse the argument types, one at a each loop iteration.// Skip the argument descriptor content.// Second step: create a Type instance for each argument type.// Parse and create the argument types, one at each loop iteration.// Skip the argument types, one at a each loop iteration.// Parse the argument types and compute their size, one at a each loop iteration.// Compare the values./** The path to a type argument, wildcard bound, array element type, or static inner type within an ... */int ARRAY_ELEMENT, ...;/** A type path step that steps into the element type of an array type. See {@link #getStep}. */int INNER_TYPE, ...;/** A type path step that steps into the nested type of a class type. See {@link #getStep}. */int WILDCARD_BOUND, ...;/** A type path step that steps into the bound of a wildcard type. See {@link #getStep}. */int TYPE_ARGUMENT, ...;/** A type path step that steps into a type argument of a generic type. See {@link #getStep}. */...[] typePathContainer, ...;/** The byte array where the 'type_path' structure - as defined in the Java Virtual Machine ... */int typePathOffset, ...;/** The offset of the first byte of the type_path JVMS structure in {@link #typePathContainer}. *//** Constructs a new TypePath. ... */this.typePathContainerthis.typePathOffset/** Returns the length of this path, i.e. its number of steps. ... *//** Returns the value of the given step of this path. ... *//** Returns the index of the type argument that the given step is stepping into. This method should ... *//** Converts a type path in string form, in the format used by {@link #toString()}, into a TypePath ... */int typePathLengthByteVector outputint typePathIndexchar cint typeArgoutput.dataoutput.length/** Returns a string representation of this type path. {@link #ARRAY_ELEMENT} steps are represented ... */getStep(...)getStepArgument(...)/** Puts the type_path JVMS structure corresponding to the given TypePath into the given ... */typePath.typePathContainertypePath.typePathOffset// path_length is stored in the first byte of a type_path.// Returns the type_path_kind of the path element of the given index.// Returns the type_argument_index of the path element of the given index./** A reference to a type appearing in a class, field or method declaration, or on an instruction. ... */int CLASS_TYPE_PARAMETER, ...;/** The sort of type references that target a type parameter of a generic class. See {@link ... */int METHOD_TYPE_PARAMETER, ...;/** The sort of type references that target a type parameter of a generic method. See {@link ... */int CLASS_EXTENDS, ...;/** The sort of type references that target the super class of a class or one of the interfaces it ... */int CLASS_TYPE_PARAMETER_BOUND, ...;/** The sort of type references that target a bound of a type parameter of a generic class. See ... */int METHOD_TYPE_PARAMETER_BOUND, ...;/** The sort of type references that target a bound of a type parameter of a generic method. See ... */int FIELD, ...;/** The sort of type references that target the type of a field. See {@link #getSort}. */int METHOD_RETURN, ...;/** The sort of type references that target the return type of a method. See {@link #getSort}. */int METHOD_RECEIVER, ...;/** The sort of type references that target the receiver type of a method. See {@link #getSort}. */int METHOD_FORMAL_PARAMETER, ...;/** The sort of type references that target the type of a formal parameter of a method. See {@link ... */int THROWS, ...;/** The sort of type references that target the type of an exception declared in the throws clause ... */int LOCAL_VARIABLE, ...;/** The sort of type references that target the type of a local variable in a method. See {@link ... */int RESOURCE_VARIABLE, ...;/** The sort of type references that target the type of a resource variable in a method. See {@link ... */int EXCEPTION_PARAMETER, ...;/** The sort of type references that target the type of the exception of a 'catch' clause in a ... *//** The sort of type references that target the type declared in an 'instanceof' instruction. See ... *//** The sort of type references that target the type of the object created by a 'new' instruction. ... */int CONSTRUCTOR_REFERENCE, ...;/** The sort of type references that target the receiver type of a constructor reference. See ... */int METHOD_REFERENCE, ...;/** The sort of type references that target the receiver type of a method reference. See {@link ... */int CAST, ...;/** The sort of type references that target the type declared in an explicit or implicit cast ... */int CONSTRUCTOR_INVOCATION_TYPE_ARGUMENT, ...;/** The sort of type references that target a type parameter of a generic constructor in a ... */int METHOD_INVOCATION_TYPE_ARGUMENT, ...;/** The sort of type references that target a type parameter of a generic method in a method call. ... */int CONSTRUCTOR_REFERENCE_TYPE_ARGUMENT, ...;int METHOD_REFERENCE_TYPE_ARGUMENT, ...;/** The sort of type references that target a type parameter of a generic method in a method ... */int targetTypeAndInfo, ...;/** The target_type and target_info structures - as defined in the Java Virtual Machine ... *//** Constructs a new TypeReference. ... */this.targetTypeAndInfo/** Returns a type reference of the given sort. ... */new TypeReference(...)/** Returns a reference to a type parameter of a generic class or method. ... *//** Returns a reference to a type parameter bound of a generic class or method. ... *//** Returns a reference to the super class or to an interface of the 'implements' clause of a ... *//** Returns a reference to the type of a formal parameter of a method. ... *//** Returns a reference to the type of an exception, in a 'throws' clause of a method. ... *//** Returns a reference to the type of the exception declared in a 'catch' clause of a method. ... *//** Returns a reference to the type of a type argument in a constructor or method call or ... *//** Returns the sort of this type reference. ... *//** Returns the index of the type parameter referenced by this type reference. This method must ... *//** Returns the index of the type parameter bound, within the type parameter {@link ... *//** Returns the index of the "super type" of a class that is referenced by this type reference. ... *//** Returns the index of the formal parameter whose type is referenced by this type reference. This ... *//** Returns the index of the exception, in a 'throws' clause of a method, whose type is referenced ... *//** Returns the index of the try catch block (using the order in which they are visited with ... *//** Returns the index of the type argument referenced by this type reference. This method must only ... *//** Returns the int encoded value of this type reference, suitable for use in visit methods related ... *//** Puts the given target_type and target_info JVMS structures into the given ByteVector. ... *//** Empty class used to ensure that the {@code org.springframework.cglib} ... */import ClassReader/** Abstract class for all code-generating CGLIB utilities. ... */DefaultGeneratorStrategy.INSTANCEDefaultNamingPolicy.INSTANCEnew ThreadLocal<>(...)new WeakHashMap<ClassLoader,ClassLoaderData>(...)ThreadLocal<> CURRENT, ...;Map<ClassLoader,ClassLoaderData> CACHE, ...;boolean DEFAULT_USE_CACHE, ...;GeneratorStrategy strategy, ...;NamingPolicy namingPolicy, ...;Source source, ...;Class<> contextClass, ...;String namePrefix, ...;boolean useCache, ...;boolean attemptLoad, ...;new Predicate(...) { ... }new Function<AbstractClassGenerator<>,Object>(...) { ... }gen.keySet<String> reservedClassNames, ...;LoadingCache<AbstractClassGenerator<>,Object,Object> generatedClasses, ...;/** {@link AbstractClassGenerator} here holds "cache key" (e.g. {@link org.springframework.cglib.proxy.Enhancer} ... */WeakReference<ClassLoader> classLoader, ...;/** Note: ClassLoaderData object is stored as a value of {@code WeakHashMap<ClassLoader, ...>} thus ... */Predicate uniqueNamePredicate, ...;Function<AbstractClassGenerator<>,Object> GET_KEY, ...;Function<AbstractClassGenerator<>,Object> loadClass<> klassClassLoaderData.thiswrapCachedClass(...)new WeakReference<ClassLoader>(...)new LoadingCache<AbstractClassGenerator<>,Object,Object>(...)Object cachedValueunwrapCachedValue(...)new WeakReference<>(...)this.namePrefixsource.name/** Set the <code>ClassLoader</code> in which the class will be generated. ... */// SPRING PATCH BEGINthis.contextClass/** Override the default naming policy. ... */// SPRING PATCH ENDthis.namingPolicy/** Whether use and update the static cache of generated classes ... */this.useCache/** If set, CGLIB will attempt to load classes from the specified ... */this.attemptLoad/** Set the strategy to use to create the bytecode from this generator. ... */this.strategy/** Used internally by CGLIB. Returns the <code>AbstractClassGenerator</code> ... */ClassLoader t/** Returns the protection domain to use when defining the class. ... */Map<ClassLoader,ClassLoaderData> cacheClassLoaderData dataAbstractClassGenerator<>.classMap<ClassLoader,ClassLoaderData> newCachenew ClassLoaderData(...)firstInstance(...)nextInstance(...)new CodeGenerationException(...)Class<> genObject savebyte[] bProtectionDomain protectionDomaingetProtectionDomain(...)generateClassName(...)getUniqueNamePredicate(...)reserveName(...)setClassName(...)/* Copyright 2003,2004 The Apache Software Foundation ... */// just in caseimport Opcodes/** SPRING PATCH: always returns ASM9. *//** CGLIB GeneratorStrategy variant which exposes the application ClassLoader ... */import ClassVisitorimport Labelimport CustomizerRegistry/** Generates classes to handle multi-valued keys, for use in things such as Maps and Sets. ... */parseSignature(...)parseType(...)new Customizer(...) { ... }Constants.TYPE_CLASSinvoke_virtual(...)new FieldTypeCustomizer(...) { ... }Constants.TYPE_STRINGnew HashCodeCustomizer(...) { ... }Constants.TYPE_TYPEConstants.TYPE_OBJECTSignature GET_NAME, ...;Signature GET_CLASS, ...;Signature HASH_CODE, ...;Signature EQUALS, ...;Signature TO_STRING, ...;Signature APPEND_STRING, ...;Type KEY_FACTORY, ...;Signature GET_SORT, ...;...[] PRIMES, ...;//generated numbers:Customizer CLASS_BY_NAME, ...;FieldTypeCustomizer STORE_CLASS_AS_STRING, ...;HashCodeCustomizer HASH_ASM_TYPE, ...;/** {@link Type#hashCode()} is very expensive as it traverses full descriptor to calculate hash code. ... */Customizer OBJECT_BY_CLASS, ...;/** @deprecated ... */Generator gennew Generator(...)setInterface(...)setContextClass(...)addCustomizer(...)KeyFactoryCustomizer keyFactoryCustomizernew CustomizerRegistry(...)new Source(...)KeyFactory.classCustomizer.classFieldTypeCustomizer.classSource SOURCE, ...;...[] KNOWN_CUSTOMIZER_TYPES, ...;Class<> keyInterface, ...;CustomizerRegistry customizers, ...;// TODO: Make me final when deprecated methods are removedint constant, ...;int multiplier, ...;/** @deprecated */this.keyInterfacesetNamePrefix(...)this.constantthis.multiplierClassEmitter cenew ClassEmitter(...)Method newInstancefindNewInstance(...)Type[] parameterTypesgetTypes(...)int seedCodeEmitter ebegin_method(...)parseConstructor(...)List<FieldTypeCustomizer> fieldTypeCustomizersgetCustomizers(...)int hcPRIMES.lengthint hmLabel failmake_label(...)begin_class(...)Constants.V1_8null_constructor(...)factory_method(...)load_this(...)super_invoke_constructor(...)Type parameterTypeType fieldTypeFieldTypeCustomizer customizergetOutType(...)getFieldName(...)Constants.ACC_PRIVATEConstants.ACC_FINALdup(...)load_arg(...)putfield(...)return_value(...)end_method(...)getfield(...)hash_code(...)instance_of_this(...)if_jump(...)CodeEmitter.EQcheckcast_this(...)not_equals(...)mark(...)new_instance(...)Constants.TYPE_STRING_BUFFERinvoke_constructor(...)append_string(...)EmitUtils.DEFAULT_DELIMITERS// hash code// equals// toStringimport MethodHandles/** @version */ReflectUtils.classMethod privateLookupInMethod lookupDefineClassMethod classLoaderDefineClassThrowable throwablenew PrivilegedExceptionAction<>(...) { ... }MethodHandles.classMethodHandles.Lookup.classMethodHandles.LookupProtectionDomain.classModifier.FINALMap<> primitives, ...;Map<> transforms, ...;ClassLoader defaultLoader, ...;Method privateLookupInMethod, ...;Method lookupDefineClassMethod, ...;Method classLoaderDefineClassMethod, ...;ProtectionDomain PROTECTION_DOMAIN, ...;Throwable THROWABLE, ...;List<Method> OBJECT_METHODS, ...;...[] CGLIB_PACKAGES, ...;Constants.CONSTRUCTOR_NAMEfindConstructor(...)int lparenparseTypes(...)ReflectiveOperationException exint dotint rparenList<> paramsint startClass<>[] typesint commaString saveint dimensionsStringBuilder bracketsClassNotFoundException ignorepackages.lengthClass<> cString transformConstants.EMPTY_CLASS_ARRAYboolean flagisAccessible(...)InstantiationException eIllegalAccessException eInvocationTargetException eConstructor<> constructorNoSuchMethodException eClass<>[] classesobjects.lengthfindInterfaceMethod(...)Set<> methodsproperties.lengthnew Method[]getPropertiesHelper(...)PropertyDescriptor[] allList<> propertiesall.lengthIntrospectionException eClass<> clnew NoSuchMethodException(...)Class<> superclassClass<>[] interfacesaddAllMethods(...)addAllInterfaces(...)Throwable targetLinkageError.classMethod publicDefineClassSignature signew MethodInfo(...) { ... }ClassInfo ci, ...;getClassInfo(...)getMethodInfo(...)Type scnew ClassInfo(...) { ... }// used by MethodInterceptorGenerated generated codeMethod[] resultnamesAndDescriptors.length// on JDK 9// Preferred option: JDK 9+ Lookup.defineClass API if ClassLoader matches// in case of plain LinkageError (class already defined)// or IllegalArgumentException (class in different package):// fall through to traditional ClassLoader.defineClass below// Direct defineClass attempt on the target Classloader// Look for publicDefineClass(String name, byte[] b, ProtectionDomain protectionDomain)// in case of UnsupportedOperationException, fall through// publicDefineClass method not available -> fall through// Classic option: protected ClassLoader.defineClass method// Fall through if setAccessible fails with InaccessibleObjectException on JDK 9+// (on the module path and/or with a JVM bootstrapped with --illegal-access=deny)// Fallback option: JDK 9+ Lookup.defineClass API even if ClassLoader does not match// No defineClass variant available at all?// Force static initializers to run.// TODO: error?/** Custom extension of CGLIB's {@link DefaultNamingPolicy}, modifying ... */new SpringNamingPolicy(...)SpringNamingPolicy INSTANCE, ...;import AbstractClassGeneratorimport ClassEmitterimport CodeEmitterimport DuplicatesPredicateimport EmitUtilsimport KeyFactoryimport Localimport MethodInfoimport MethodInfoTransformerimport MethodWrapperimport ObjectSwitchCallbackimport ProcessSwitchCallbackimport ReflectUtilsimport RejectModifierPredicateimport Transformerimport VisibilityPredicateimport WeakCacheKey/** Generates dynamic subclasses to enable method interception. This ... */new CallbackFilter(...) { ... }Enhancer.classEnhancerKey.classKeyFactory.HASH_ASM_TYPEConstants.TYPE_CLASS_ARRAYConstants.TYPE_OBJECT_ARRAYType.INT_TYPECallbackFilter ALL_ZERO, ...;EnhancerKey KEY_FACTORY, ...;String BOUND_FIELD, ...;String FACTORY_DATA_FIELD, ...;String THREAD_CALLBACKS_FIELD, ...;String STATIC_CALLBACKS_FIELD, ...;String SET_THREAD_CALLBACKS_NAME, ...;String SET_STATIC_CALLBACKS_NAME, ...;String CONSTRUCTED_FIELD, ...;String CALLBACK_FILTER_FIELD, ...;/** {@link org.springframework.cglib.core.AbstractClassGenerator.ClassLoaderData#generatedClasses} requires to keep cache key ... */Type OBJECT_TYPE, ...;Type FACTORY, ...;Type ILLEGAL_STATE_EXCEPTION, ...;Type ILLEGAL_ARGUMENT_EXCEPTION, ...;Type THREAD_LOCAL, ...;Type CALLBACK, ...;Type CALLBACK_ARRAY, ...;Signature CSTRUCT_NULL, ...;Signature SET_THREAD_CALLBACKS, ...;Signature SET_STATIC_CALLBACKS, ...;Signature NEW_INSTANCE, ...;Signature MULTIARG_NEW_INSTANCE, ...;Signature SINGLE_NEW_INSTANCE, ...;Signature SET_CALLBACK, ...;Signature GET_CALLBACK, ...;Signature SET_CALLBACKS, ...;Signature GET_CALLBACKS, ...;Signature THREAD_LOCAL_GET, ...;Signature THREAD_LOCAL_SET, ...;Signature BIND_CALLBACKS, ...;EnhancerFactoryData currentData, ...;Object currentKey, ...;/** Internal interface, only public due to ClassLoader issues. */CallbackFilter filter, ...;boolean validateCallbackTypes, ...;boolean classOnly, ...;Class<> superclass, ...;boolean useFactory, ...;Long serialVersionUID, ...;boolean interceptDuringConstruction, ...;/** Create a new <code>Enhancer</code>. A new <code>Enhancer</code> ... *//** Set the class which the generated class will extend. As a convenience, ... */this.superclass/** Set the interfaces to implement. The <code>Factory</code> interface will ... *//** Set the {@link CallbackFilter} used to map the generated class' methods ... */this.filter/** Set the single {@link Callback} to use. ... *//** Set the array of callbacks to use. ... *//** Set whether the enhanced object instances should implement ... */this.useFactory/** Set whether methods called from within the proxy's constructer ... */this.interceptDuringConstruction/** Set the single type of {@link Callback} to use. ... *//** Set the array of callback types to use. ... */callbackTypes.lengthdetermineTypes(...)/** Generate a new class if necessary and uses the specified ... */createHelper(...)/** Generate a new class if necessary and return it without creating a new instance. ... *//** Insert a static serialVersionUID field into the generated class. ... */Type[] checkcheck.length/** The idea of the class is to cache relevant java.lang.reflect instances so ... */Class<> generatedClass, ...;Method setThreadCallbacks, ...;...[] primaryConstructorArgTypes, ...;Constructor<> primaryConstructor, ...;this.generatedClassgetCallbacksSetter(...)this.primaryConstructorArgTypesthis.primaryConstructor/** Creates proxy instance for given argument types, and assigns the callbacks. ... */setThreadCallbacks(...)new WeakCacheKey<CallbackFilter>(...)preValidate(...)this.currentKeyfindPackageProtected(...)/** Finds all of the methods that will be extended by an ... */List<> targetFactory.classcreateSet(...)new RejectModifierPredicate(...)Constants.ACC_STATICnew VisibilityPredicate(...)new DuplicatesPredicate(...)Class<> scList<> constructorsList<> actualMethodsList<> interfaceMethodsSet<> forcePublicList<> methodsnew Transformer(...) { ... }int modifiersConstants.ACC_ABSTRACTConstants.ACC_NATIVEConstants.ACC_SYNCHRONIZEDConstants.ACC_PROTECTEDClassEmitter eList<> constructorInfofilterConstructors(...)Type.BOOLEAN_TYPEConstants.PRIVATE_FINAL_STATICConstants.SUID_FIELD_NAMEType.LONG_TYPEgetCallbackField(...)emitMethods(...)emitConstructors(...)emitDefaultConstructor(...)emitSetThreadCallbacks(...)emitSetStaticCallbacks(...)emitBindCallbacks(...)getCallbackKeys(...)emitNewInstanceCallbacks(...)emitNewInstanceCallback(...)emitNewInstanceMultiarg(...)emitGetCallback(...)emitSetCallback(...)emitGetCallbacks(...)emitSetCallbacks(...)/** Filter the list of constructors from the superclass. The ... *//** This method should not be called in regular flow. ... */createUsingReflection(...)EnhancerFactoryData dataClass<>[] argumentTypesdata.generatedClassEnhancerFactoryData factoryDatanew EnhancerFactoryData(...)Field factoryDataFieldField callbackFilterFieldNoSuchFieldException enew WeakReference<EnhancerFactoryData>(...)/** Call this method to register the {@link Callback} array to use before ... *//** Similar to {@link #registerCallbacks}, but suitable for use ... */setCallbacksHelper(...)/** Determine if a class was generated using <code>Enhancer</code>. ... *//** Instantiates a proxy instance and assigns callback values. ... *//** Helper method to create an intercepted object. ... */Enhancer eConstructor<Object> declaredConstructorMethodInfo constructorboolean seenNullload_args(...)invoke_static_this(...)process_switch(...)new ProcessSwitchCallback(...) { ... }goTo(...)aconst_null(...)checkcast(...)dup2(...)aaload(...)newarray(...)aastore(...)Type thisTypegetThisType(...)invoke_static(...)emitCommonNewInstance(...)getClassType(...)getClassEmitter(...)currentData.generatedClassthrow_exception(...)constructor_switch(...)new ObjectSwitchCallback(...) { ... }unbox(...)CallbackGenerator[] generatorsgetGenerators(...)Map<> groupsMap<> indexesMap<> originalModifiersMap<> positionsgetIndexMap(...)Map<> declToBridgeIterator<> it1Iterator<> it2Map<> bridgeToTargetresolveAll(...)new BridgeMethodResolver(...)Set<> seenGenCodeEmitter segetStaticHook(...)Object[] stateCallbackGenerator.Contextnew CallbackGenerator.Context(...) { ... }Enhancer.thisemitCurrentCallback(...)rename(...)Signature bridgeTargetType retTypeType targetinvoke_virtual_this(...)super_invoke(...)Label constructedCodeEmitter.NEMethodInfo methodMethod actualMethodList<> groupSet<> bridgesCallbackGenerator genList<> fmethodsgenerateStatic(...)RuntimeException xException xifnonnull(...)Local memake_local(...)Label found_callbackstore_local(...)load_local(...)/* Copyright 2002,2003,2004 The Apache Software Foundation ... */// affects choice of ClassLoader// Explicit reference equality is added here just in case Arrays.equals does not have one// If we have relevant Constructor instance at hand, just call it// This skips "get constructors" machinery// Take a slow path if observing unexpected argument types// clear thread callbacks to allow them to be gc'd// Order is very important: must add superclass, then// its superclass chain, then each interface and// its superinterfaces.// This is declared private to avoid "public field" pollution// The subsequent dance is performed just once for each class,// so it does not matter much how fast it goes// TODO: optimize// stack height// TODO: make sure Callback is null// for now just make a new array; TODO: optimize// Optimization: build up a map of Class -> bridge methods in class// so that we can look up all the bridge methods in one pass for a class.// If this is a bridge and we know the target was called from invokespecial,// then we need to invoke_virtual w/ the bridge target instead of doing// a super, because super may itself be using super, which would bypass// any proxies on the target.// checkcast each argument against the target's argument types// Not necessary to cast if the target & bridge have// the same return type.// (This conveniently includes void and primitive types,// which would fail if casted.  It's not possible to// covariant from boxed to unbox (or vice versa), so no having// to box/unbox for bridges).// TODO: It also isn't necessary to checkcast if the return is// assignable from the target.  (This would happen if a subclass// used covariant returns to narrow the return type within a bridge// method.)import GeneratorStrategyimport NamingPolicyimport FastClass/** Classes generated by {@link Enhancer} pass this object to the ... */Signature sig1, ...;Signature sig2, ...;CreateInfo createInfo, ...;Object initLock, ...;FastClassInfo fastClassInfo, ...;/** For internal use by {@link Enhancer} only; see the {@link org.springframework.cglib.reflect.FastMethod} class ... */MethodProxy proxynew MethodProxy(...)proxy.sig1proxy.sig2proxy.createInfonew CreateInfo(...)CreateInfo ciFastClassInfo fcinew FastClassInfo(...)fci.f1helper(...)ci.c1fci.f2ci.c2fci.i1fci.i2FastClass f1, ...;FastClass f2, ...;int i1, ...;int i2, ...;Class<> c1, ...;Class<> c2, ...;AbstractClassGenerator<> fromEnhancergetCurrent(...)this.c1this.c2getNamingPolicy(...)getAttemptLoad(...)FastClass.GeneratorGenerator gci.namingPolicyci.strategysetAttemptLoad(...)ci.attemptLoad/** Return the signature of the proxied method. *//** Return the name of the synthetic method created by CGLIB which is ... *//** Return the {@link org.springframework.cglib.reflect.FastClass} method index ... */fastClassInfo.i2// For testingfastClassInfo.f1fastClassInfo.f2/** Return the <code>MethodProxy</code> used when intercepting the method ... */MethodInterceptorGenerator.FIND_PROXY_NAMEMethodInterceptorGenerator.FIND_PROXY_TYPES/** Invoke the original method, on a different object of the same type. ... */fastClassInfo.i1/** Invoke the original (super) method on the specified object. ... *//* Using a volatile invariant allows us to initialize the FastClass and ... *//** Common interface for managing aliases. Serves as a super-interface for ... *//** Given a name, register an alias for it. ... *//** Remove the specified alias from this registry. ... *//** Determine whether the given name is defined as an alias ... *//** Return the aliases for the given name, if defined. ... *//** Interface defining a generic contract for attaching and accessing metadata ... *//** Set the attribute defined by {@code name} to the supplied {@code value}. ... *//** Get the value of the attribute identified by {@code name}. ... *//** Compute a new value for the attribute identified by {@code name} if ... *//** Remove the attribute identified by {@code name} and return its value. ... *//** Return {@code true} if the attribute identified by {@code name} exists. ... *//** Return the names of all attributes. *//** Support class for {@link AttributeAccessor AttributeAccessors}, providing ... */Map<String,Object> attributes, ...;/** Map with String keys and Object values. *//** Copy the attributes from the supplied AttributeAccessor to this accessor. ... */String[] attributeNames(...).attributes/** Helper for resolving synthetic {@link Method#isBridge bridge Methods} to the ... */new ConcurrentReferenceHashMap<Method,Method>(...)Map<Method,Method> cache, ...;/** Find the original method for the supplied {@link Method bridge Method}. ... */List<Method> candidateMethodsMethodFilter filterisBridgedCandidateFor(...)searchCandidates(...)/** Returns {@code true} if the supplied '{@code candidateMethod}' can be ... *//** Searches for the bridged method in the given candidates. ... */Method previousMethodboolean sameSigMethod candidateMethodisBridgeMethodFor(...)/** Determines whether or not the bridge {@link Method} is the bridge for the ... */findGenericDeclaration(...)isResolvedTypeMatch(...)/** Returns {@code true} if the {@link Type} signature of both the supplied ... */Type[] genericParametersClass<?>[] candidateParametersgenericParameters.lengthcandidateParameters.lengthResolvableType genericParameterClass<?> candidateParameter/** Searches for the generic {@link Method} declaration whose erased signature ... */searchForMatch(...)searchInterfaces(...)/** If the supplied {@link Class} has a declared {@link Method} whose signature matches ... *//** Compare the signatures of the bridge method and the method which it bridges. If ... */// Gather all methods with matching name and parameter size.// A bridge method was passed in but we couldn't find the bridged method.// Let's proceed with the passed-in method and hope for the best...// An array type: compare the component type.// A non-array type: compare the type itself.// Search parent types for method that has same signature as bridge.import NavigableMapimport NavigableSet/** Factory for collections that is aware of common Java and Spring collection types. ... */NavigableSet<>.classNavigableMap<>.classLinkedList<>.classHashSet<>.classLinkedHashSet<>.classEnumSet<>.classTreeMap<>.classEnumMap<>.classSet<Class<?>> approximableCollectionTypes, ...;Set<Class<?>> approximableMapTypes, ...;/** Determine whether the given collection type is an <em>approximable</em> type, ... *//** Create the most approximate collection for the given collection. ... */new LinkedList<E>(...)Collection<E> enumSetnew TreeSet<E>(...)comparator(...)/** Create the most appropriate collection for the given collection type. ... */noneOf(...)asEnumType(...)/** Determine whether the given map type is an <em>approximable</em> type, ... *//** Create the most approximate map for the given map. ... */EnumMap<> enumMapnew EnumMap<>(...)new TreeMap<K,V>(...)new LinkedHashMap<K,V>(...)/** Create the most appropriate map for the given map type. ... */MultiValueMap<>.classnew LinkedMultiValueMap<>(...)/** Create a variant of {@link java.util.Properties} that automatically adapts ... */new SortedProperties(...) { ... }/** Create a variant of {@link java.util.Properties} that sorts properties ... *//** Cast the given type to a subtype of {@link Enum}. ... */asSubclass(...)// Standard collection interfaces// Common concrete collection classes// Cast is necessary for compilation in Eclipse 4.4.1.import ObjectStreamClass/** Special ObjectInputStream subclass that resolves class names ... *//** Create a new ConfigurableObjectInputStream for the given InputStream and ClassLoader. ... */resolveClass(...)resolveFallbackIfPossible(...)Class<?>[] resolvedInterfacesresolveProxyClass(...)getFallbackClassLoader(...)/** Resolve the given class name against a fallback class loader. ... *//** Return the fallback ClassLoader to use when no ClassLoader was specified ... */// Use the specified ClassLoader to resolve local classes.// Use the default ClassLoader...// Use the specified ClassLoader to resolve local proxy classes.// Use ObjectInputStream's default ClassLoader.../** This class can be used to parse other classes containing constant definitions ... *//** The name of the introspected class. */Map<String,Object> fieldCache, ...;/** Map from String field name to object value. *//** Create a new Constants converter class wrapping the given class. ... */Field[] fieldsgetFields(...)isPublicStaticFinal(...)this.fieldCache/** Return the name of the analyzed class. *//** Return the number of constants exposed. *//** Exposes the field cache to subclasses: ... *//** Return a constant value cast to a Number. ... */asObject(...)new ConstantException(...)/** Return a constant value as a String. ... *//** Parse the given String (upper or lower case accepted) and return ... */String codeToUse/** Return all names of the given group of constants. ... */String prefixToUse/** Return all names of the group of constants for the ... */propertyToConstantNamePrefix(...)String suffixToUse/** Return all values of the given group of constants. ... */Set<Object> values/** Return all values of the group of constants for the ... *//** Look up the given value within the given group of constants. ... *//** Look up the given value within the group of constants for ... */toCode(...)/** Convert the given bean property name to a constant name prefix. ... */StringBuilder parsedPrefixisUpperCase(...)/** Exception thrown when the {@link Constants} class is asked for ... *//** Thrown when an invalid constant name is requested. ... *//** Thrown when an invalid constant value is looked up. ... */// just leave this field and continue/** Provides methods to support various naming and other conventions used ... */String PLURAL_SUFFIX, ...;/** Suffix added to names when using arrays. *//** Determine the conventional variable name for the supplied {@code Object} ... */Class<?> valueClassboolean pluralizegetShortNameAsProperty(...)Collection<?> collectionObject valueToCheckpeekAhead(...)getClassForValue(...)pluralize(...)/** Determine the conventional variable name for the given parameter taking ... */String reactiveSuffixisNoValue(...)/** Determine the conventional variable name for the return type of the ... */getVariableNameForReturnType(...)/** Determine the conventional variable name for the return type of the given ... *//** Convert {@code String}s in attribute name format (e.g. lowercase, hyphens ... */char[] resultint currPosboolean upperCaseNext/** Return an attribute name qualified by the given enclosing {@link Class}. ... *//** Determine the class to use for naming a variable containing the given value. ... *//** Pluralize the given name. *//** Retrieve the {@code Class} of an element in the {@code Collection}. ... */Iterator<E> itE value// not completely accurate but good guess// '$' in the class name but no inner class -// assuming it's a special subclass (e.g. by OpenJPA)/** Base class for decorating ClassLoaders such as {@link OverridingClassLoader} ... */Set<String> excludedPackages, ...;Set<String> excludedClasses, ...;/** Create a new DecoratingClassLoader with no parent ClassLoader. *//** Create a new DecoratingClassLoader using the given parent ClassLoader ... *//** Add a package name to exclude from decoration (e.g. overriding). ... */this.excludedPackages/** Add a class name to exclude from decoration (e.g. overriding). ... */this.excludedClasses/** Determine whether the specified class is excluded from decoration ... *//** Interface to be implemented by decorating proxies, in particular Spring AOP ... *//** Return the (ultimate) decorated class behind this proxy. ... *//** Default implementation of the {@link ParameterNameDiscoverer} strategy interface, ... */new KotlinReflectionParameterNameDiscoverer(...)new StandardReflectionParameterNameDiscoverer(...)/** Comparator capable of sorting exceptions based on their depth from the thrown exception type. ... */Class<? extends Throwable> targetException, ...;/** Create a new ExceptionDepthComparator for the given exception. ... */this.targetException/** Create a new ExceptionDepthComparator for the given exception type. ... */int depth1getDepth(...)int depth2/** Obtain the closest match from the given exception types for the given target exception. ... */List<Class<? extends Throwable>> handledExceptionsnew ArrayList<Class<? extends Throwable>>(...)new ExceptionDepthComparator(...)// Found it!// If we've gone as far as we can go and haven't found it...import WildcardType/** Helper class for resolving generic types against type variables. ... */new ConcurrentReferenceHashMap<Class<?>,Map<TypeVariable<>,Type>>(...)Map<Class<?>,Map<TypeVariable<>,Type>> typeVariableCache, ...;/** Cache from Class to TypeVariable Map. *//** Determine the target type for the given generic parameter type. ... *//** Determine the target type for the generic return type of the given method, ... *//** Resolve the single type argument of the given generic interface against the given ... */getSingleGeneric(...)/** Resolve the single type argument of the given generic interface against ... */getGenerics(...).lengthgetGenerics(...)/** Resolve the type arguments of the given generic interface against the given ... */isEntirelyUnresolvable(...)resolveGenerics(...)/** Resolve the given generic type against the given context class, ... */ResolvableType resolvedTypeVariableresolveVariable(...)ResolvableType resolvedTypeClass<?>[] genericsgetActualTypeArguments(...).lengthType[] typeArgumentsResolvableType contextTypeClass<?> rawClassgetRawClass(...)typeArguments.lengthType typeArgumentResolvableType resolvedTypeArgumentResolvableType superTypegetSuperType(...)ResolvableType ifc/** Resolve the specified generic type against the given TypeVariable map. ... */new TypeVariableMapVariableResolver(...)/** Build a mapping of {@link TypeVariable#getName TypeVariable names} to ... */Map<TypeVariable<>,Type> typeVariableMapnew HashMap<TypeVariable<>,Type>(...)buildTypeVariableMap(...)TypeVariable<?>[] variablesvariables.lengthResolvableType genericresolveType(...)ResolvableType interfaceTypeisMemberClass(...)getEnclosingClass(...)ResolvableType.VariableResolverMap<TypeVariable<>,Type> typeVariableMap, ...;this.typeVariableMap/** Interface to be implemented by transparent resource proxies that need to be ... *//** Return the underlying resource (never {@code null}). *//** A common delegate for detecting Kotlin's presence and for identifying Kotlin types. ... */Class<?> metadataKotlinDetector.classClass<? extends Annotation> kotlinMetadata, ...;boolean kotlinReflectPresent, ...;/** Determine whether Kotlin is present in general. *//** Determine whether Kotlin reflection is present. ... *//** Determine whether the given {@code Class} is a Kotlin type ... */getDeclaredAnnotation(...)/** Return {@code true} if the method is a suspending function. ... */// Kotlin API not available - no Kotlin support/** {@link ParameterNameDiscoverer} implementation which uses Kotlin's reflection facilities ... */KFunction<?> functionList<KParameter> filteredParametersnew Predicate<KParameter>(...) { ... }KParameter.Kind.VALUEKParameter.KindKParameter.Kind.EXTENSION_RECEIVERKParameter parameter// Extension receivers of extension methods must be included as they appear as normal method parameters in Java// extension receivers are not explicitly named, but require a name for Java interoperability// $receiver is not a valid Kotlin identifier, but valid in Java, so it can be used hereimport SpringAsmInfo/** Implementation of {@link ParameterNameDiscoverer} that uses the LocalVariableTable ... */new ConcurrentHashMap<Class<?>,Map<Executable,String[]>>(...)LocalVariableTableParameterNameDiscoverer.classMap<Executable,String[]> NO_DEBUG_INFO_MAP, ...;// marker object for classes that do not have any debug infoMap<Class<?>,Map<Executable,String[]>> parameterNamesCache, ...;// the cache uses a nested index (value is a map) to keep the top level cache relatively small in sizeMethod originalMethoddoGetParameterNames(...)Map<Executable,String[]> mapthis.parameterNamesCachenew Function<Class<?>,Map<Executable,String[]>>(...) { ... }inspectClass(...)/** Inspects the target class. ... */getClassFileName(...)ClassReader classReadernew ConcurrentHashMap<Executable,String[]>(...)new ParameterNameDiscoveringVisitor(...)/** Helper class that inspects all methods and constructors and then ... */String STATIC_CLASS_INIT, ...;Map<Executable,String[]> executableMap, ...;SpringAsmInfo.ASM_VERSIONthis.executableMapisSyntheticOrBridged(...)new LocalVariableTableVisitor(...)Opcodes.ACC_BRIDGEString CONSTRUCTOR, ...;boolean hasLvtInfo, ...;...[] lvtSlotIndex, ...;/* The nth entry contains the slot index of the LVT table entry holding the ... */this.args.lengththis.lvtSlotIndexcomputeLvtSlotIndices(...)this.hasLvtInfothis.lvtSlotIndex.lengththis.parameterNames.lengthresolveExecutable(...)Class<?>[] argTypesint[] lvtIndexint nextIndexisWideType(...)Type.DOUBLE_TYPE// We couldn't load the class file, which is not fatal as it// simply means this method of discovering parameter names won't work.// exclude synthetic + bridged && static class initialization// visitLocalVariable will never be called for static no args methods// which doesn't use any local variables.// This means that hasLvtInfo could be false for that kind of methods// even if the class has local variable info.// float is not a wide type/** A common key class for a method against a specific target class, ... *//** Create a key object for the given method and target class. ... */MethodClassKey otherKeyotherKey.method/** Defines the algorithm for searching for metadata-associated methods exhaustively ... *//** Select methods on the given target type based on the lookup of associated metadata. ... */Map<Method,T> methodMapnew LinkedHashMap<Method,T>(...)Set<Class<?>> handlerTypesClass<?> specificHandlerTypeClass<?> currentHandlerTypeinspect(...)/** Select methods on the given target type based on a filter. ... */ReflectionUtils.MethodFilternew MetadataLookup<Boolean>(...) { ... }/** A callback interface for metadata lookup on a given method. ... *//** Perform a lookup on the given method and return associated metadata, if any. ... */// Alright, not on this interface then...// A final desperate attempt on the proxy class itself...import Unit/** Helper class that encapsulates the specification of a method parameter, i.e. a {@link Method} ... */...[] EMPTY_ANNOTATION_ARRAY, ...;Executable executable, ...;Parameter parameter, ...;Map<Integer,Integer> typeIndexesPerLevel, ...;/** Map from Integer level to Integer type index. *//** The containing class. Could also be supplied by overriding {@link #getContainingClass()} */Class<?> parameterType, ...;Type genericParameterType, ...;...[] parameterAnnotations, ...;String parameterName, ...;MethodParameter nestedMethodParameter, ...;/** Create a new {@code MethodParameter} for the given method, with nesting level 1. ... *//** Create a new {@code MethodParameter} for the given method. ... */this.executablevalidateIndex(...)/** Create a new MethodParameter for the given constructor, with nesting level 1. ... *//** Create a new MethodParameter for the given constructor. ... *//** Internal constructor used to create a {@link MethodParameter} with a ... *//** Copy constructor, resulting in an independent MethodParameter object ... */original.executableoriginal.parameterthis.typeIndexesPerLeveloriginal.typeIndexesPerLevelthis.parameterTypeoriginal.parameterTypethis.genericParameterTypeoriginal.genericParameterTypethis.parameterAnnotationsoriginal.parameterAnnotationsoriginal.parameterNameDiscovererthis.parameterNameoriginal.parameterName/** Return the wrapped Method, if any. ... *//** Return the wrapped Constructor, if any. ... *//** Return the class that declares the underlying Method or Constructor. *//** Return the wrapped member. ... *//** Return the wrapped executable. ... *//** Return the {@link Parameter} descriptor for method/constructor parameter. ... *//** Return the index of the method/constructor parameter. ... *//** Increase this parameter's nesting level. ... *//** Decrease this parameter's nesting level. ... */getTypeIndexesPerLevel(...)/** Return the nesting level of the target type ... *//** Return a variant of this {@code MethodParameter} with the type ... *//** Set the type index for the current nesting level. ... *//** Return the type index for the current nesting level. ... */getTypeIndexForLevel(...)/** Return the type index for the specified nesting level. ... *//** Obtain the (lazily constructed) type-indexes-per-level Map. */new HashMap<Integer,Integer>(...)/** Return a variant of this {@code MethodParameter} which points to the ... */MethodParameter nestedParamthis.nestedMethodParameterMethodParameter copycopy.nestingLevelcopy.typeIndexesPerLevelcopy.parameterTypecopy.genericParameterType/** Return whether this method indicates a parameter which is not required: ... *//** Check whether this method parameter is annotated with any variant of a ... *//** Return a variant of this {@code MethodParameter} which points to ... *//** Return a variant of this {@code MethodParameter} which refers to the ... */MethodParameter resultresult.containingClassresult.parameterType/** Set a containing class to resolve the parameter type against. *//** Return the containing class for this method parameter. ... */Class<?> containingClass/** Set a resolved (generic) parameter type. *//** Return the type of the method/constructor parameter. ... */computeParameterType(...)/** Return the generic type of the method/constructor parameter. ... */Type paramTypeType[] genericParameterTypesgenericParameterTypes.length/** Return the nested type of the method/constructor parameter. ... */getGenericParameterType(...)/** Return the nested generic type of the method/constructor parameter. ... *//** Return the annotations associated with the target method/constructor itself. */adaptAnnotationArray(...)/** Return the method/constructor annotation of the given type, if available. ... */A annotationadaptAnnotation(...)/** Return whether the method/constructor is annotated with the given type. ... *//** Return the annotations associated with the specific method/constructor parameter. */Annotation[] paramAnnsAnnotation[][] annotationArrayannotationArray.length/** Return {@code true} if the parameter has at least one annotation, ... *//** Return the parameter annotation of the given type, if available. ... */Annotation[] anns/** Return whether the parameter is declared with the given annotation type. ... *//** Initialize parameter name discovery for this method parameter. ... *//** Return the name of the method/constructor parameter. ... */ParameterNameDiscoverer discoverer/** A template method to post-process a given annotation instance before ... *//** A template method to post-process a given annotation array before ... */MethodParameter otherParamotherParam.typeIndexesPerLevelotherParam.nestingLevelotherParam.parameterIndexotherParam.executable/** Create a new MethodParameter for the given method or constructor. ... *//** Create a new MethodParameter for the given parameter descriptor. ... */findParameterIndex(...)Parameter[] allParamsallParams.length/** Check whether the specified {@link MethodParameter} represents a nullable Kotlin type, ... */Predicate<KParameter> predicateKParameter.Kind.INSTANCEKParameter kParameter/** Return the generic return type of the method, with support of suspending ... */isSuspend(...)getJavaType(...)/** Return the return type of the method, with support of suspending ... */Unit.class// Bug in javac: type array excludes enclosing instance parameter// for inner classes with at least one generic constructor parameter,// so access it with the actual parameter index lowered by 1// TODO: Object.class if unresolvable// Try first with identity checks for greater performance.// Potentially try again with object equality checks in order to avoid race// conditions while invoking java.lang.reflect.Executable.getParameters().// probably a synthetic class - let's use java reflection instead/** {@link InheritableThreadLocal} subclass that exposes a specified name ... *//** Create a new NamedInheritableThreadLocal with the given name. ... *//** {@link ThreadLocal} subclass that exposes a specified name ... *//** Create a new NamedThreadLocal with the given name. ... *//** Handy class for wrapping checked {@code Exceptions} with a root cause. ... */NestedExceptionUtils.class/** Construct a {@code NestedCheckedException} with the specified detail message. ... *//** Construct a {@code NestedCheckedException} with the specified detail message ... *//** Return the detail message, including the message from the nested exception ... */buildMessage(...)/** Retrieve the innermost cause of this exception, if any. ... *//** Retrieve the most specific cause of this exception, that is, ... *//** Check whether this exception contains an exception of the given type: ... */// Eagerly load the NestedExceptionUtils class to avoid classloader deadlock// issues on OSGi when calling getMessage(). Reported by Don Brown; SPR-5607./** Helper class for implementing exception classes which are capable of ... *//** Build a message for the given base message and root cause. ... *//** Retrieve the innermost cause of the given exception, if any. ... *//** Retrieve the most specific cause of the given exception, that is, ... *//** Subclass of {@link IOException} that properly handles a root cause, ... *//** Construct a {@code NestedIOException} with the specified detail message. ... *//** Construct a {@code NestedIOException} with the specified detail message ... *//** Handy class for wrapping runtime {@code Exceptions} with a root cause. ... *//** Construct a {@code NestedRuntimeException} with the specified detail message. ... *//** Construct a {@code NestedRuntimeException} with the specified detail message ... *//** {@link Comparator} implementation for {@link Ordered} objects, sorting ... */new OrderComparator(...)OrderComparator INSTANCE, ...;/** Shared default instance of {@code OrderComparator}. *//** Build an adapted order comparator with the given source provider. ... */new Comparator<Object>(...) { ... }doCompare(...)boolean p1boolean p2/** Determine the order value for the given object. ... */Object orderSourcegetOrderSource(...)findOrder(...)/** Find an order value indicated by the given object. ... *//** Determine a priority value for the given object, if any. ... *//** Sort the given List with a default OrderComparator. ... *//** Sort the given array with a default OrderComparator. ... *//** Sort the given array or List with a default OrderComparator, ... *//** Strategy interface to provide an order source for a given object. ... *//** Return an order source for the specified object, i.e. an object that ... *//** {@code Ordered} is an interface that can be implemented by objects that ... */int HIGHEST_PRECEDENCE, ...;/** Useful constant for the highest precedence value. ... */int LOWEST_PRECEDENCE, ...;/** Useful constant for the lowest precedence value. ... *//** Get the order value of this object. ... *//** {@code ClassLoader} that does <i>not</i> always delegate to the parent loader ... */String CLASS_FILE_SUFFIX, ...;ClassLoader overrideDelegate, ...;/** Create a new OverridingClassLoader for the given ClassLoader. ... */this.overrideDelegateisEligibleForOverriding(...)loadClassForOverriding(...)/** Determine whether the specified class is eligible for overriding ... *//** Load the specified class for overriding purposes in this ClassLoader. ... */findLoadedClass(...)/** Load the defining bytes for the given class, ... */openStreamForClass(...)/** Open an InputStream for the specified class. ... *//** Transformation hook to be implemented by subclasses. ... */// Load the raw bytes.// Transform if necessary and use the potentially transformed bytes./** Interface to discover parameter names for methods and constructors. ... *//** Return parameter names for a method, or {@code null} if they cannot be determined. ... *//** Return parameter names for a constructor, or {@code null} if they cannot be determined. ... *//** The purpose of this class is to enable capturing and passing a generic ... */Class<?> parameterizedTypeReferenceSubclassfindParameterizedTypeReferenceSubclass(...)getGenericSuperclass(...)ParameterizedType.classactualTypeArguments.length(...).type/** Build a {@code ParameterizedTypeReference} wrapping the given type. ... */new ParameterizedTypeReference<T>(...) { ... }Class<?> parentParameterizedTypeReference<>.class/** {@link ParameterNameDiscoverer} implementation that tries several discoverer ... */new ArrayList<ParameterNameDiscoverer>(...)List<ParameterNameDiscoverer> parameterNameDiscoverers, ...;/** Add a further {@link ParameterNameDiscoverer} delegate to the list of ... */this.parameterNameDiscoverers/** Extension of the {@link Ordered} interface, expressing a <em>priority</em> ... */import Publisher/** Adapter for a Reactive Streams {@link Publisher} to and from an async/reactive ... */ReactiveTypeDescriptor descriptor, ...;Function<Object,Publisher<?>> toPublisherFunction, ...;Function<Publisher<?>,Object> fromPublisherFunction, ...;/** Constructor for an adapter with functions to convert the target reactive ... */this.toPublisherFunctionthis.fromPublisherFunction/** Return the descriptor of the reactive type for the adapter. *//** Shortcut for {@code getDescriptor().getReactiveType()}. */getReactiveType(...)/** Shortcut for {@code getDescriptor().isMultiValue()}. */isMultiValue(...)/** Shortcut for {@code getDescriptor().isNoValue()}. *//** Shortcut for {@code getDescriptor().supportsEmpty()}. */supportsEmpty(...)/** Adapt the given instance to a Reactive Streams {@code Publisher}. ... */getEmptyValue(...)/** Adapt from the given Reactive Streams Publisher. ... */import CompletableDeferredKtimport Deferredimport BlockHoundimport BlockHoundIntegrationimport RxReactiveStreams/** A registry of adapters to adapt Reactive Streams {@link Publisher} to/from ... */new ArrayList<ReactiveAdapter>(...)ReactiveAdapterRegistry.classReactiveAdapterRegistry sharedInstance, ...;boolean reactorPresent, ...;boolean rxjava1Present, ...;boolean rxjava2Present, ...;boolean rxjava3Present, ...;boolean flowPublisherPresent, ...;boolean kotlinCoroutinesPresent, ...;List<ReactiveAdapter> adapters, ...;/** Create a registry and auto-register default adapters. ... */registerAdapters(...)new ReactorRegistrar(...)new RxJava1Registrar(...)new RxJava2Registrar(...)new RxJava3Registrar(...)registerAdapter(...)new ReactorJdkFlowAdapterRegistrar(...)new CoroutinesRegistrar(...)/** Whether the registry has any adapters. *//** Register a reactive type along with functions to adapt to and from a ... */new ReactorAdapter(...)new ReactiveAdapter(...)/** Get the adapter for the given reactive type. ... *//** Get the adapter for the given reactive type. Or if a "source" object is ... */Object sourceToUse/** Return a shared default {@code ReactiveAdapterRegistry} instance, ... */ReactiveAdapterRegistry registrynew ReactiveAdapterRegistry(...)registerReactiveType(...)singleOptionalValue(...)Mono<>.classnew Function<Object,Publisher<?>>(...) { ... }new Function<Publisher<?>,Object>(...) { ... }multiValue(...)Flux<>.classPublisher<>.classnonDeferredAsyncValue(...)CompletionStage<>.classnew EmptyCompletableFuture<>(...)fromCompletionStage(...)toFuture(...)Observable<>.classtoObservable(...)singleRequiredValue(...)Single<>.classtoSingle(...)noValue(...)Completable.classcomplete(...)toCompletable(...)Flowable<>.classfromPublisher(...)toFlowable(...)BackpressureStrategy.BUFFERMaybe<>.classsingleElement(...)String publisherNameClass<?> publisherClassString adapterNameClass<?> flowAdapterClassMethod toFluxMethodMethod toFlowMethodObject emptyFlow/** ReactiveAdapter variant that wraps adapted Publishers as {@link Flux} or ... */Publisher<T> publisherDeferred<>.classCompletableDeferred(...)deferredToMono(...)monoToDeferred(...)Flow<>.classemptyFlow(...)asFlux(...)asFlow(...)/** {@code BlockHoundIntegration} for spring-core classes. ... */BlockHound.BuilderallowBlockingCallsInside(...)// Reactor// RxJava1 (deprecated)// RxJava2// RxJava3// Java 9+ Flow.Publisher// If not present, do nothing for the time being...// We can fall back on "reactive-streams-flow-bridge" (once released)// Kotlin Coroutines// Register Flux and Mono before Publisher...// TODO: remove reflection when build requires JDK 9+// Avoid hard references potentially anywhere in spring-core (no need for structural dependency)/** Describes the semantics of a reactive type including boolean checks for ... */Class<?> reactiveType, ...;boolean multiValue, ...;boolean noValue, ...;Supplier<?> emptyValueSupplier, ...;boolean deferred, ...;this.reactiveTypethis.multiValuethis.noValuethis.emptyValueSupplierthis.deferred/** Return the reactive type for this descriptor. *//** Return {@code true} if the reactive type can produce more than 1 value ... *//** Return {@code true} if the reactive type does not produce any values and ... *//** Return {@code true} if the reactive type can complete with no values. *//** Return an empty-value instance for the underlying reactive or async type. ... *//** Whether the underlying operation is deferred and needs to be started ... */(...).reactiveType/** Descriptor for a reactive type that can produce 0..N values. ... */new ReactiveTypeDescriptor(...)/** Descriptor for a reactive type that can produce 0..1 values. ... *//** Descriptor for a reactive type that must produce 1 value to complete. ... *//** Descriptor for a reactive type that does not produce any values. ... *//** The same as {@link #singleOptionalValue(Class, Supplier)} but for a ... */import GenericArrayTypeimport FieldTypeProviderimport MethodParameterTypeProviderimport TypeProvider/** Encapsulates a Java {@link java.lang.reflect.Type}, providing access to ... */new ResolvableType(...)EmptyType.INSTANCEnew ResolvableType[]new ConcurrentReferenceHashMap<ResolvableType,ResolvableType>(...)ResolvableType NONE, ...;/** {@code ResolvableType} returned when no value is available. {@code NONE} is used ... */...[] EMPTY_TYPES_ARRAY, ...;ConcurrentReferenceHashMap<ResolvableType,ResolvableType> cache, ...;/** The underlying Java type being managed. */TypeProvider typeProvider, ...;/** Optional provider for the type. */VariableResolver variableResolver, ...;/** The {@code VariableResolver} to use or {@code null} if no resolver is available. */ResolvableType componentType, ...;/** The component type for an array or {@code null} if the type should be deduced. */Integer hash, ...;Class<?> resolved, ...;ResolvableType superType, ...;...[] generics, ...;/** Private constructor used to create a new {@link ResolvableType} for cache key purposes, ... */this.typeProviderthis.variableResolverthis.componentTypethis.hashcalculateHashCode(...)this.resolved/** Private constructor used to create a new {@link ResolvableType} for cache value purposes, ... *//** Private constructor used to create a new {@link ResolvableType} for uncached purposes, ... *//** Private constructor used to create a new {@link ResolvableType} on a {@link Class} basis. ... *//** Return the underling Java {@link Type} being managed. *//** Return the underlying Java {@link Class} being managed, if available; ... */Type rawType/** Return the underlying source of the resolvable type. Will return a {@link Field}, ... *//** Return this type as a resolved {@code Class}, falling back to ... *//** Determine whether the given object is an instance of this {@code ResolvableType}. ... *//** Determine whether this {@code ResolvableType} is assignable from the ... */WildcardBounds ourBoundsWildcardBounds typeBoundsboolean exactMatchboolean checkGenericsClass<?> ourResolvedClass<?> otherResolvedisSameKind(...)getBounds(...)TypeVariable<?> variableResolvableType resolvedother.variableResolverResolvableType[] ourGenericsResolvableType[] typeGenericsourGenerics.lengthtypeGenerics.lengthnew IdentityHashMap<Type,Type>(...)/** Return {@code true} if this type resolves to a Class that represents an array. ... *//** Return the ResolvableType representing the component type of the array or ... */getGenericComponentType(...)/** Convenience method to return this type as a resolvable {@link Collection} type. ... *//** Convenience method to return this type as a resolvable {@link Map} type. ... *//** Return this type as a {@link ResolvableType} of the specified class. Searches ... */ResolvableType interfaceAsType/** Return a {@link ResolvableType} representing the direct supertype of this type. ... */Type superclassthis.superTypeTypeNotPresentException ex/** Return a {@link ResolvableType} array representing the direct interfaces ... */ResolvableType[] interfacesType[] genericIfcsgetGenericInterfaces(...)genericIfcs.length/** Return {@code true} if this type contains generic parameters. ... *//** Return {@code true} if this type contains unresolvable generics only, ... */ResolvableType[] genericsisUnresolvableTypeVariable(...)isWildcardWithoutBounds(...)/** Determine whether the underlying type has any unresolvable generics: ... */Type genericInterface/** Determine whether the underlying type is a type variable that ... *//** Determine whether the underlying type represents a wildcard ... */WildcardType wtgetLowerBounds(...).lengthgetLowerBounds(...)Type[] upperBoundsgetUpperBounds(...)upperBounds.length/** Return a {@link ResolvableType} for the specified nesting level. ... *//** Return a {@link ResolvableType} representing the generic parameter for the ... */indexes.lengthgenerics.length/** Return an array of {@link ResolvableType ResolvableTypes} representing the generic parameters of ... */this.genericsType[] typeParamstypeParams.length/** Convenience method that will {@link #getGenerics() get} and ... */Class<?>[] resolvedGenerics/** Convenience method that will {@link #getGenerics() get} and {@link #resolve() ... *//** Convenience method that will {@link #getGeneric(int...) get} and ... *//** Resolve this type to a {@link java.lang.Class}, returning {@code null} ... *//** Resolve this type to a {@link java.lang.Class}, returning the specified ... */Class<?> resolvedComponent/** Resolve this type by a single level, returning the resolved value or {@link #NONE}. ... */Type resolvedresolveBounds(...)bounds.lengthType ownerTypegetOwnerType(...)Type actualTypeResolvableType otherTypeotherType.typeotherType.typeProviderotherType.variableResolverotherType.componentType/** Adapts this {@link ResolvableType} to a {@link VariableResolver}. */new DefaultVariableResolver(...)/** Custom serialization support for {@link #NONE}. *//** Return a String representation of this type in its fully resolved form ... *//** Return a {@link ResolvableType} for the specified {@link Class}, ... */// Factory methodsnew ResolvableType(...) { ... }Class<?> otherClass/** Return a {@link ResolvableType} for the specified base type ... */ResolvableType asType/** Return a {@link ResolvableType} for the specified {@link Class} with pre-declared generics. ... */ResolvableType[] resolvableGenericsType[] argumentsParameterizedType syntheticTypenew SyntheticParameterizedType(...)Type argumentnew TypeVariablesVariableResolver(...)/** Return a {@link ResolvableType} for the specified instance. The instance does not ... *//** Return a {@link ResolvableType} for the specified {@link Field}. ... */new FieldTypeProvider(...)/** Return a {@link ResolvableType} for the specified {@link Field} with a given ... */ResolvableType ownerasVariableResolver(...)/** Return a {@link ResolvableType} for the specified {@link Field} with the ... *//** Return a {@link ResolvableType} for the specified {@link Constructor} parameter. ... *//** Return a {@link ResolvableType} for the specified {@link Constructor} parameter ... *//** Return a {@link ResolvableType} for the specified {@link Method} return type. ... *//** Return a {@link ResolvableType} for the specified {@link Method} parameter. ... *//** Return a {@link ResolvableType} for the specified {@link Method} parameter with a ... *//** Return a {@link ResolvableType} for the specified {@link MethodParameter}. ... *//** Return a {@link ResolvableType} for the specified {@link MethodParameter} with a ... */getNestingLevel(...)methodParameter.typeIndexesPerLevelnew MethodParameterTypeProvider(...)/** Return a {@link ResolvableType} for the specified {@link MethodParameter}, ... *//** Return a {@link ResolvableType} for the specified {@link MethodParameter} at ... *//** Return a {@link ResolvableType} as a array of the specified {@code componentType}. ... */Class<?> arrayClass/** Return a {@link ResolvableType} for the specified {@link Type}. ... *//** Return a {@link ResolvableType} for the specified {@link Type} backed by the given ... */VariableResolver variableResolver/** Return a {@link ResolvableType} for the specified {@link ParameterizedTypeReference}. ... *//** Return a {@link ResolvableType} for the specified {@link Type} backed by a given ... */ResolvableType resultTypeResolvableType cachedTypeforTypeProvider(...)purgeUnreferencedEntries(...)resultType.hashresultType.resolvedcachedType.resolved/** Clear the internal {@code ResolvableType}/{@code SerializableTypeWrapper} cache. ... */SerializableTypeWrapper.cache/** Strategy interface used to resolve {@link TypeVariable TypeVariables}. *//** Return the source of the resolver (used for hashCode and equals). *//** Resolve the specified variable. ... */ResolvableType source, ...;...[] variables, ...;this.variablesTypeVariable<?> variableToComparethis.variables.lengthTypeVariable<?> resolvedVariableType rawType, ...;...[] typeArguments, ...;this.typeArgumentsthis.typeArguments.lengthParameterizedType otherType/** Internal helper to handle bounds from {@link WildcardType WildcardTypes}. */Kind kind, ...;...[] bounds, ...;/** Internal constructor to create a new {@link WildcardBounds} instance. ... */this.bounds/** Return {@code true} if this bounds is the same kind as the specified bounds. */bounds.kind/** Return {@code true} if this bounds is assignable to all the specified types. ... */ResolvableType boundKind.UPPER/** Return the underlying bounds. *//** Get a {@link WildcardBounds} instance for the specified type, returning ... */ResolvableType resolveToWildcardWildcardType wildcardTyperesolveToWildcard.typeKind boundsTypeKind.LOWERType[] boundsResolvableType[] resolvableBoundstype.variableResolvernew WildcardBounds(...)/** The various kinds of bounds. */new Kind(...)Kind UPPER, ...;Kind LOWER, ...;/** Internal {@link Type} used to represent an empty value. */new EmptyType(...)Type INSTANCE, ...;// If we cannot resolve types, we are not assignable// Deal with array by delegating to the component type// Deal with wildcard bounds// In the form X is assignable to <? extends Number>// In the form <? extends Number> is assignable to X...// Main assignability check about to follow// We're checking nested generic variables now...// Try default variable resolution// Try variable resolution against target type// Unresolved type variable, potentially nested -> never insist on exact match// We need an exact type match for generics// List<CharSequence> is not assignable from List<String>// Recursively check each generic// Ignore non-present types in generic signature// Handle derived types// Fallback to bounds// Don't bother with variable boundaries for toString()...// Can cause infinite recursions in case of self-references// For simple Class references, build the wrapper right away -// no expensive resolution necessary, so not worth caching...// Purge empty entries on access since we don't have a clean-up thread or the like.// Check the cache - we may have a ResolvableType which has been resolved before.../** Any object can implement this interface to provide its actual {@link ResolvableType}. ... *//** Return the {@link ResolvableType} describing this instance ... *//** Internal utility class that can be used to obtain wrapped {@link Serializable} ... */GenericArrayType.classTypeVariable<>.classWildcardType.classnew ConcurrentReferenceHashMap<Type,Type>(...)...[] SUPPORTED_SERIALIZABLE_TYPES, ...;ConcurrentReferenceHashMap<Type,Type> cache, ...;/** Return a {@link Serializable} variant of {@link Field#getGenericType()}. *//** Return a {@link Serializable} variant of ... *//** Unwrap the given type, effectively returning the original non-serializable type. ... */Type unwrappedgetTypeProvider(...)/** Return a {@link Serializable} {@link Type} backed by a {@link TypeProvider} . ... */Type providedTypeType cachedSerializableTypeProxy.classInvocationHandler handlernew TypeProxyInvocationHandler(...)/** Additional interface implemented by the type proxy. *//** Return the underlying type provider. *//** A {@link Serializable} interface providing access to a {@link Type}. *//** Return the (possibly non {@link Serializable}) {@link Type}. *//** Return the source of the type, or {@code null} if not known. ... *//** {@link Serializable} {@link InvocationHandler} used by the proxied {@link Type}. ... */TypeProvider provider, ...;new MethodInvokeTypeProvider(...)Type[] result/** {@link TypeProvider} for {@link Type Types} obtained from a {@link Field}. *//** {@link TypeProvider} for {@link Type Types} obtained from a {@link MethodParameter}. *//** {@link TypeProvider} for {@link Type Types} obtained by invoking a no-arg method. */// No serializable type wrapping necessary (e.g. for java.lang.Class)// Let's skip any wrapping attempts if types are generally not serializable in// the current runtime environment (even java.lang.Class itself, e.g. on GraalVM native images)// Obtain a serializable type proxy for the given provider...// Unwrap proxies for speed// Lazy invocation of the target method on the provided type// Cache the result for further calls to getType()/** Simple implementation of the {@link AliasRegistry} interface. ... */Map<String,String> aliasMap, ...;/** Map from alias to canonical name. */String registeredNameallowAliasOverriding(...)/** Determine whether alias overriding is allowed. ... *//** Determine whether the given name has the given alias registered. ... */hasAlias(...)retrieveAliases(...)/** Transitively retrieve all aliases for the given name. ... */Map<String,String> aliasCopyString resolvedAliasString existingName/** Check whether the given name points back to the given alias as an alias ... *//** Determine the raw name, resolving aliases to canonical names. ... */// An existing alias - no need to re-register// Pointing to existing alias - just remove placeholder// Handle aliasing.../** Interface to be implemented by a reloading-aware ClassLoader ... *//** Determine whether the given class is reloadable (in this ClassLoader). ... *//** Define a custom class (typically a CGLIB proxy class) in this class loader. ... *//** Static holder for local Spring properties, i.e. defined at the Spring library level. ... */SpringProperties.classgetSystemResource(...)String PROPERTIES_RESOURCE_LOCATION, ...;Properties localProperties, ...;/** Programmatically set a local property, overriding an entry in the ... *//** Retrieve the property value for the given key, checking local Spring ... *//** Programmatically set a local flag to "true", overriding an ... *//** Retrieve the flag for the given property key. ... *//** Class that exposes the Spring version. Fetches the ... *//** Return the full version string of the present Spring codebase, ... */Package pkggetImplementationVersion(...)/** {@link ParameterNameDiscoverer} implementation which uses JDK 8's reflection facilities ... */Parameter paramisNamePresent(...)/** Abstract base class for {@link MergedAnnotation} implementations. ... */A synthesizedAnnotation, ...;getDistance(...)hasDefaultValue(...)getRequiredAttributeValue(...)Class<?> arrayTypefilterAttributes(...)hasNonDefaultValue(...)A synthesizedthis.synthesizedAnnotationnew NoSuchElementException(...)createSynthesized(...)/** Get the underlying attribute value. ... *//** Factory method used to create the synthesized annotation. *//** {@code @AliasFor} is an annotation that is used to declare aliases for ... *//** Alias for {@link #attribute}. ... *//** The name of the attribute that <em>this</em> attribute is an alias for. ... *//** The type of annotation in which the aliased {@link #attribute} is declared. ... */import Adapt/** General utility methods for finding annotations, meta-annotations, and ... *//** Build an adapted {@link AnnotatedElement} for the given annotations, ... */new AnnotatedElementForAnnotations(...)/** Get the fully qualified class names of all meta-annotation types ... *//** Get the fully qualified class names of all meta-annotation ... */toCollection(...)new Function<MergedAnnotation<Annotation>,String>(...) { ... }new Supplier<LinkedHashSet<String>>(...) { ... }/** Determine if the supplied {@link AnnotatedElement} is annotated with ... */new Predicate<MergedAnnotation<? extends Annotation>>(...) { ... }isMetaPresent(...)/** Determine if the supplied {@link AnnotatedElement} is annotated with a ... */new Predicate<MergedAnnotation<Annotation>>(...) { ... }/** Determine if an annotation of the specified {@code annotationType} ... */hasPlainJavaAnnotationsOnly(...)AnnotationFilter.PLAIN/** Determine if an annotation of the specified {@code annotationName} is ... *//** Get the first annotation of the specified {@code annotationType} within ... */MergedAnnotation<?> mergedAnnotationfirstDirectlyDeclared(...)/** Get the first annotation of the specified {@code annotationName} within ... *//** Get <strong>all</strong> annotations of the specified {@code annotationType} ... */toAnnotationSet(...)/** Get <strong>all</strong> annotations of the specified {@code annotationTypes} ... */typeIn(...)/** Get all <em>repeatable annotations</em> of the specified {@code annotationType} ... *//** Get the annotation attributes of <strong>all</strong> annotations of the specified ... *//** Get the annotation attributes of <strong>all</strong> annotations of ... */Adapt[] adaptationstoMultiValueMap(...)unique(...)new Function<MergedAnnotation<Annotation>,List<Class<? extends Annotation>>>(...) { ... }getMetaTypes(...)new Function<MergedAnnotation<Annotation>,MergedAnnotation<Annotation>>(...) { ... }new Function<MultiValueMap<String,Object>,MultiValueMap<String,Object>>(...) { ... }nullIfEmpty(...)findAnnotations(...)/** Find the first annotation of the specified {@code annotationType} within ... *//** Find the first annotation of the specified {@code annotationName} within ... *//** Find <strong>all</strong> annotations of the specified {@code annotationType} ... */highAggregateIndexesFirst(...)/** Find <strong>all</strong> annotations of the specified {@code annotationTypes} ... *//** Find all <em>repeatable annotations</em> of the specified {@code annotationType} ... */findMergedRepeatableAnnotations(...)findRepeatableAnnotations(...)SearchStrategy.INHERITED_ANNOTATIONSnone(...)RepeatableContainers repeatableContainerscomparingInt(...)new ToIntFunction<MergedAnnotation<A>>(...) { ... }asAnnotationAttributes(...)/** Adapted {@link AnnotatedElement} that hold specific annotations. */...[] annotations, ...;// Shortcut: directly present on the element, with no merging needed?// Exhaustive retrieval of merged annotations.../** {@link LinkedHashMap} subclass representing annotation attribute ... */String UNKNOWN, ...;boolean validated, ...;/** Create a new, empty {@link AnnotationAttributes} instance. *//** Create a new, empty {@link AnnotationAttributes} instance with the ... *//** Create a new {@link AnnotationAttributes} instance, wrapping the provided ... */other.annotationTypeother.displayNamethis.validatedother.validated/** Create a new, empty {@link AnnotationAttributes} instance for the ... *//** Create a possibly already validated new, empty ... *//** Get the type of annotation represented by this {@code AnnotationAttributes}. ... *//** Get the value stored under the specified {@code attributeName} as a string. ... */getRequiredAttribute(...)/** Get the value stored under the specified {@code attributeName} as an ... *//** Get the value stored under the specified {@code attributeName} as a boolean. ... *//** Get the value stored under the specified {@code attributeName} as a number. ... *//** Get the value stored under the specified {@code attributeName} as an enum. ... *//** Get the value stored under the specified {@code attributeName} as a class. ... *//** Get the {@link AnnotationAttributes} stored under the specified ... */AnnotationAttributes.class/** Get the annotation of type {@code annotationType} stored under the ... *//** Get the array of {@link AnnotationAttributes} stored under the specified ... *//** Get the array of type {@code annotationType} stored under the specified ... *//** Get the value stored under the specified {@code attributeName}, ... */assertAttributePresence(...)assertNotException(...)assertAttributeType(...)Iterator<Entry<String,Object>> entriesvalueToString(...)/** Return an {@link AnnotationAttributes} instance based on the given map. ... */// Annotation Class not resolvable/** {@code AnnotationAwareOrderComparator} is an extension of ... */new AnnotationAwareOrderComparator(...)AnnotationAwareOrderComparator INSTANCE, ...;/** Shared default instance of {@code AnnotationAwareOrderComparator}. *//** This implementation checks for {@link Order @Order} or ... */findOrderFromAnnotation(...)AnnotatedElement elementgetOrderFromAnnotations(...)/** This implementation retrieves an @{@link javax.annotation.Priority} ... */Integer priority/** Sort the given list with a default {@link AnnotationAwareOrderComparator}. ... *//** Sort the given array with a default AnnotationAwareOrderComparator. ... *//** Sort the given array or List with a default AnnotationAwareOrderComparator, ... *//** Thrown by {@link AnnotationUtils} and <em>synthesized annotations</em> ... *//** Construct a new {@code AnnotationConfigurationException} with the ... *//** Callback interface that can be used to filter specific annotation types. ... */packages(...)new AnnotationFilter(...) { ... }AnnotationFilter PLAIN, ...;/** {@link AnnotationFilter} that matches annotations in the ... */AnnotationFilter JAVA, ...;AnnotationFilter ALL, ...;/** {@link AnnotationFilter} that always matches and can be used when no ... */AnnotationFilter NONE, ...;/** {@link AnnotationFilter} that never matches and can be used when no ... *//** Test if the given annotation matches the filter. ... *//** Test if the given type matches the filter. ... *//** Test if the given type name matches the filter. ... *//** Create a new {@link AnnotationFilter} that matches annotations in the ... */new PackagesAnnotationFilter(...)import MirrorSet/** Provides mapping information for a single annotation (or meta-annotation) in ... */new MirrorSet[]...[] EMPTY_MIRROR_SETS, ...;AnnotationTypeMapping source, ...;AnnotationTypeMapping root, ...;int distance, ...;List<Class<? extends Annotation>> metaTypes, ...;AttributeMethods attributes, ...;MirrorSets mirrorSets, ...;...[] aliasMappings, ...;...[] conventionMappings, ...;...[] annotationValueMappings, ...;...[] annotationValueSource, ...;Map<Method,List<Method>> aliasedBy, ...;boolean synthesizable, ...;Set<Method> claimedAliases, ...;getRoot(...)this.distancethis.metaTypesforAnnotationType(...)this.mirrorSetsnew MirrorSets(...)this.aliasMappingsfilledIntArray(...)this.conventionMappingsthis.annotationValueMappingsthis.annotationValueSourcenew AnnotationTypeMapping[]this.aliasedByresolveAliasedForTargets(...)processAliases(...)addConventionMappings(...)addConventionAnnotationValues(...)this.synthesizablecomputeSynthesizableFlag(...)List<T> mergednew ArrayList<T>(...)Map<Method,List<Method>> aliasedBynew HashMap<Method,List<Method>>(...)Method attributeAliasFor aliasForAliasFor.classMethod targetresolveAliasTarget(...)new Function<Method,List<Method>>(...) { ... }Class<? extends Annotation> targetAnnotationannotation(...)String targetAttributeNameattribute(...)new AnnotationConfigurationException(...)describe(...)isCompatibleReturnType(...)isAliasPair(...)AliasFor targetAliasForMethod mirrorList<Method> aliasescollectAliases(...)AnnotationTypeMapping mappingList<Method> additionalmapping.aliasedBymapping.sourceint rootAttributeIndexgetFirstRootAttributeIndex(...)mapping.attributesmapping.aliasMappingsupdateFrom(...)mapping.mirrorSetsmapping.claimedAliasesmapping.annotationint[] resolvedMirrorsnew ValueExtractor(...) { ... }AttributeMethods rootAttributesint[] mappingsmappings.lengthMirrorSet mirrorsgetAssigned(...)getMirrorSets(...)int mappedMergedAnnotation<>.VALUEgetAttributeIndex(...)boolean isValueAttributemapping.distanceisBetterConventionAnnotationValue(...)int existingDistance...[...].distancehasNestedAnnotation(...)AttributeMethods attributeMethodsisAnnotation(...)isSynthesizable(...)/** Method called after all mappings have been set. At this point no further ... */validateAllAliasesClaimed(...)validateMirrorSet(...)this.claimedAliasesMethod firstAttributeObject firstDefaultValueMethod mirrorAttributeObject mirrorDefaultValue/** Get the root mapping. ... *//** Get the source of the mapping or {@code null}. ... *//** Get the distance of this mapping. ... *//** Get the type of the mapped annotation. ... *//** Get the source annotation for this mapping. This will be the ... *//** Get the annotation attributes for the mapping annotation type. ... *//** Get the related index of an alias mapped attribute, or {@code -1} if ... *//** Get the related index of a convention mapped attribute, or {@code -1} ... *//** Get a mapped attribute value from the most suitable ... */int mappedIndexAnnotationTypeMapping sourcesource.annotationsource.attributes/** Determine if the specified value is equivalent to the default value of the ... */isEquivalentToDefaultValue(...)/** Get the mirror sets for this type mapping. ... *//** Determine if the mapped annotation is <em>synthesizable</em>. ... */int[] arrayfill(...)areEquivalent(...)value.lengthextractedValue.lengthAttributeMethods attributesextract(...)/** A collection of {@link MirrorSet} instances that provides details of all ... */...[] mirrorSets, ...;...[] assigned, ...;this.assignedMirrorSet mirrorSetint lastnew MirrorSet(...)Set<MirrorSet> uniquenew LinkedHashSet<MirrorSet>(...)this.mirrorSets.lengthint resolvedmirrorSet.sizemirrorSet.indexes/** A single set of mirror attributes. */...[] indexes, ...;this.sizethis.indexesMirrorSets.this.assigned.lengthMirrorSets.this.assignedMirrorSets.thisObject lastValueboolean isDefaultValueString onint attributeIndex// Uses @AliasFor for local aliases?// Uses @AliasFor for attribute overrides in meta-annotations?// Uses convention-based attribute overrides in meta-annotations?// Has nested annotations or arrays of annotations that are synthesizable?/** Provides {@link AnnotationTypeMapping} information for a single source ... */IntrospectionFailureLogger.DEBUGnew ConcurrentReferenceHashMap<AnnotationFilter,Cache>(...)IntrospectionFailureLogger failureLogger, ...;Map<AnnotationFilter,Cache> standardRepeatablesCache, ...;Map<AnnotationFilter,Cache> noRepeatablesCache, ...;RepeatableContainers repeatableContainers, ...;AnnotationFilter filter, ...;List<AnnotationTypeMapping> mappings, ...;this.repeatableContainersnew ArrayList<AnnotationTypeMapping>(...)addAllMappings(...)new Consumer<AnnotationTypeMapping>(...) { ... }afterAllMappingsSet(...)Deque<AnnotationTypeMapping> queuenew ArrayDeque<AnnotationTypeMapping>(...)addIfPossible(...)removeFirst(...)addMetaAnnotationsToQueue(...)Annotation[] metaAnnotationsAnnotation metaAnnotationAnnotation[] repeatedAnnotationsfindRepeatedAnnotations(...)isMappable(...)Annotation repeatedAnnotationnew AnnotationTypeMapping(...)rethrowAnnotationConfigurationException(...)isEnabled(...)log(...)isAlreadyMapped(...)/** Get the total number of contained mappings. ... *//** Get an individual mapping from this instance. ... *//** Create {@link AnnotationTypeMappings} for the specified annotation type. ... */standardRepeatables(...)new Function<AnnotationFilter,Cache>(...) { ... }new AnnotationTypeMappings(...)/** Cache created per {@link AnnotationFilter}. */Map<Class<? extends Annotation>,AnnotationTypeMappings> mappings, ...;/** Create a cache instance with the specified filter. ... */new ConcurrentReferenceHashMap<Class<? extends Annotation>,AnnotationTypeMappings>(...)/** Get or create {@link AnnotationTypeMappings} for the specified annotation type. ... */new Function<Class<? extends Annotation>,AnnotationTypeMappings>(...) { ... }createMappings(...)/** General utility methods for working with annotations, handling meta-annotations, ... */new ConcurrentReferenceHashMap<Class<? extends Annotation>,Map<String,DefaultValueHolder>>(...)/** The attribute name for annotations with a single element. */AnnotationFilter JAVA_LANG_ANNOTATION_FILTER, ...;Map<Class<? extends Annotation>,Map<String,DefaultValueHolder>> defaultValuesCache, ...;/** Determine whether the given class is a candidate for carrying one of the specified ... *//** Determine whether the given class is a candidate for carrying the specified annotation ... *//** Get a single {@link Annotation} of {@code annotationType} from the supplied ... */synthesizeAnnotation(...)isSingleLevelPresent(...)int distance/** Get a single {@link Annotation} of {@code annotationType} from the ... *//** Get all {@link Annotation Annotations} that are <em>present</em> on the ... */synthesizeAnnotationArray(...)handleIntrospectionFailure(...)/** Get the <em>repeatable</em> {@linkplain Annotation annotations} of ... */SearchStrategy.SUPERCLASSnew Function<MergedAnnotation<A>,Object>(...) { ... }new Function<MergedAnnotation<A>,MergedAnnotation<A>>(...) { ... }/** Get the declared <em>repeatable</em> {@linkplain Annotation annotations} ... */getDeclaredRepeatableAnnotations(...)SearchStrategy.DIRECT/** Find a single {@link Annotation} of {@code annotationType} on the ... *//** Find a single {@link Annotation} of {@code annotationType} on the supplied ... *//** Find the first {@link Class} in the inheritance hierarchy of the ... */isDirectlyPresent(...)new Function<MergedAnnotation<Annotation>,Object>(...) { ... }/** Determine whether an annotation of the specified {@code annotationType} ... */orElseGet(...)new Supplier<MergedAnnotation<? extends Annotation>>(...) { ... }/** Determine if an annotation of type {@code metaAnnotationType} is ... *//** Determine if the supplied {@link Annotation} is defined in the core JDK ... *//** Determine if the {@link Annotation} with the supplied name is defined ... *//** Check the declared attributes of the given annotation, in particular covering ... *//** Retrieve the given annotation's attributes as a {@link Map}, preserving all ... *//** Retrieve the given annotation's attributes as a {@link Map}. ... *//** Retrieve the given annotation's attributes as an {@link AnnotationAttributes} map. ... *//** Register the annotation-declared default values for the given attributes, ... */Map<String,DefaultValueHolder> defaultValuesgetDefaultValues(...)new BiConsumer<String,DefaultValueHolder>(...) { ... }new Function<Class<? extends Annotation>,Map<String,DefaultValueHolder>>(...) { ... }computeDefaultValues(...)AttributeMethods methodsMap<String,DefaultValueHolder> resulthasDefaultValueMethod(...)new DefaultValueHolder(...)Adapt.ANNOTATION_TO_MAPEntry<String,Object> element/** Post-process the supplied {@link AnnotationAttributes}, preserving nested ... */attributes.validatedattributes.displayNamegetAttributeValueForMirrorResolution(...)adaptValue(...)Entry<String,Object> attributeEntry(...).defaultValueAnnotation[] annotationsAnnotation[] synthesizedannotations.length/** Retrieve the <em>value</em> of the {@code value} attribute of a ... *//** Retrieve the <em>value</em> of a named attribute, given an annotation instance. ... *//** If the supplied throwable is an {@link AnnotationConfigurationException}, ... *//** Handle the supplied annotation introspection exception. ... */IntrospectionFailureLogger loggerIntrospectionFailureLogger.INFOboolean meta/** Retrieve the <em>default value</em> of the {@code value} attribute ... *//** Retrieve the <em>default value</em> of a named attribute, given an annotation instance. ... *//** Retrieve the <em>default value</em> of a named attribute, given the ... *//** <em>Synthesize</em> an annotation from the supplied {@code annotation} ... *//** <em>Synthesize</em> an annotation from its default attributes values. ... *//** <em>Synthesize</em> an annotation from the supplied map of annotation ... *//** <em>Synthesize</em> an array of annotations from the supplied array ... *//** Clear the internal annotation metadata cache. ... *//** Internal holder used to wrap default values. */// Shortcut: no searchable annotations to be found on plain Java classes and core Spring types...// For backwards compatibility, perform a superclass search with plain annotations// even if not marked as @Inherited: e.g. a findAnnotation search for @Deprecated// Use simpler method if there are no nested annotations// If we have nested annotations, we need them as nested maps// Meta-annotation or (default) value lookup on an annotation type/** Callback interface used to process annotations. ... *//** Called when an aggregate is about to be processed. This method may return ... *//** Called when an array of annotations can be processed. This method may ... *//** Get the final result to be returned. By default this method returns ... *//** Scanner to search for relevant annotations in the annotation hierarchy of an ... */new ConcurrentReferenceHashMap<AnnotatedElement,Annotation[]>(...)new ConcurrentReferenceHashMap<Class<?>,Method[]>(...)...[] NO_ANNOTATIONS, ...;...[] NO_METHODS, ...;Map<AnnotatedElement,Annotation[]> declaredAnnotationCache, ...;Map<Class<?>,Method[]> baseTypeMethodsCache, ...;/** Scan the hierarchy of the specified element for relevant annotations and ... */R resultfinish(...)processClass(...)processMethod(...)processClassInheritedAnnotations(...)processClassHierarchy(...)Annotation[] relevantint remainingint aggregateIndexClass<?> rootisWithoutHierarchy(...)doWithAggregate(...)Annotation[] declaredAnnotationsdeclaredAnnotations.lengthrelevant.lengthboolean isRelevantint relevantIndexdoWithAnnotations(...)Class<?> interfaceTypeR interfacesResultR superclassResultClass<?> enclosingClassR enclosingResultprocessMethodInheritedAnnotations(...)processMethodHierarchy(...)processMethodAnnotations(...)boolean calledProcessorgetBaseTypeMethods(...)isOverride(...)int clearedgetDeclaredAnnotations(...).lengthhasSameParameterTypes(...)Class<?>[] rootParameterTypesClass<?>[] candidateParameterTypeshasSameGenericTypeParameters(...)Class<?> sourceDeclaringClassClass<?> candidateDeclaringClassrootParameterTypes.lengthClass<?> resolvedParameterTypeAnnotation[] bridgedAnnotationsbridgedAnnotations.lengthboolean cachedboolean allIgnoredisIgnorable(...)isValid(...)boolean noSuperTypesgetInterfaces(...).lengthSearchStrategy.TYPE_HIERARCHY_AND_ENCLOSING_CLASSESMethod sourceMethod// Since merely attempting to load the enclosing class may result in// automatic loading of sibling nested classes that in turn results// in an exception such as NoClassDefFoundError, we wrap the following// in its own dedicated try-catch block in order not to preemptively// halt the annotation scanning process./** Provides a quick way to access the attribute methods of an {@link Annotation} ... */new AttributeMethods(...)new ConcurrentReferenceHashMap<Class<? extends Annotation>,AttributeMethods>(...)AttributeMethods NONE, ...;Map<Class<? extends Annotation>,AttributeMethods> cache, ...;Comparator<Method> methodComparator, ...;...[] attributeMethods, ...;...[] canThrowTypeNotPresentException, ...;boolean hasDefaultValueMethod, ...;boolean hasNestedAnnotation, ...;boolean foundDefaultValueMethodboolean foundNestedAnnotationthis.attributeMethodsthis.canThrowTypeNotPresentExceptionattributeMethods.lengththis.hasDefaultValueMethodthis.hasNestedAnnotation/** Determine if this instance only contains a single attribute named ... */this.attributeMethods.length/** Determine if values from the given annotation can be safely accessed without ... */assertAnnotation(...)canThrowTypeNotPresentException(...)/** Check if values from the given annotation can be safely accessed without causing ... *//** Get the attribute with the specified name or {@code null} if no ... *//** Get the attribute at the specified index. ... *//** Determine if the attribute at the specified index could throw a ... *//** Get the index of the attribute with the specified name, or {@code -1} ... *//** Get the index of the specified attribute, or {@code -1} if the ... *//** Get the number of attributes in this collection. ... *//** Determine if at least one of the attribute methods has a default value. ... *//** Determine if at least one of the attribute methods is a nested annotation. ... *//** Get the attribute methods for the given annotation type. ... */new Function<Class<? extends Annotation>,AttributeMethods>(...) { ... }compute(...)Method[] attributeMethodsisAttributeMethod(...)/** Create a description for the given attribute method suitable to use in ... */String in/** Log facade used to handle annotation introspection failures (in particular ... */new IntrospectionFailureLogger(...) { ... }IntrospectionFailureLogger DEBUG, ...;IntrospectionFailureLogger INFO, ...;IntrospectionFailureLogger.loggerMergedAnnotation<>.class/** A single merged annotation returned from a {@link MergedAnnotations} ... *//** Get the {@code Class} reference for the actual annotation type. ... *//** Determine if the annotation is present on the source. Considers ... *//** Determine if the annotation is directly present on the source. ... *//** Determine if the annotation is meta-present on the source. ... *//** Get the distance of this annotation related to its use as a ... *//** Get the index of the aggregate collection containing this annotation. ... *//** Get the source that ultimately declared the root annotation, or ... *//** Get the source of the meta-annotation, or {@code null} if the ... *//** Get the root annotation, i.e. the {@link #getDistance() distance} {@code 0} ... *//** Get the complete list of annotation types within the annotation hierarchy ... *//** Determine if the specified attribute name has a non-default value when ... *//** Determine if the specified attribute name has a default value when compared ... *//** Get a required byte attribute value from the annotation. ... *//** Get a required byte array attribute value from the annotation. ... *//** Get a required boolean attribute value from the annotation. ... *//** Get a required boolean array attribute value from the annotation. ... *//** Get a required char attribute value from the annotation. ... *//** Get a required char array attribute value from the annotation. ... *//** Get a required short attribute value from the annotation. ... *//** Get a required short array attribute value from the annotation. ... *//** Get a required int attribute value from the annotation. ... *//** Get a required int array attribute value from the annotation. ... *//** Get a required long attribute value from the annotation. ... *//** Get a required long array attribute value from the annotation. ... *//** Get a required double attribute value from the annotation. ... *//** Get a required double array attribute value from the annotation. ... *//** Get a required float attribute value from the annotation. ... *//** Get a required float array attribute value from the annotation. ... *//** Get a required string attribute value from the annotation. ... *//** Get a required string array attribute value from the annotation. ... *//** Get a required class attribute value from the annotation. ... *//** Get a required class array attribute value from the annotation. ... *//** Get a required enum attribute value from the annotation. ... *//** Get a required enum array attribute value from the annotation. ... *//** Get a required annotation attribute value from the annotation. ... *//** Get a required annotation array attribute value from the annotation. ... *//** Get an optional attribute value from the annotation. ... *//** Get the default attribute value from the annotation as specified in ... *//** Create a new view of the annotation with all attributes that have default ... *//** Create a new view of the annotation with only attributes that match the ... *//** Create a new view of the annotation that exposes non-merged attribute values. ... *//** Create a new mutable {@link AnnotationAttributes} instance from this ... *//** Get an immutable {@link Map} that contains all the annotation attributes. ... *//** Create a new {@link Map} instance of the given type that contains all the annotation ... *//** Create a type-safe synthesized version of this merged annotation that can ... *//** Optionally create a type-safe synthesized version of this annotation based ... *//** Create a {@link MergedAnnotation} that represents a missing annotation ... *//** Create a new {@link MergedAnnotation} instance from the specified ... *//** Create a new {@link MergedAnnotation} instance of the specified ... *//** Adaptations that can be applied to attribute values when creating ... */new Adapt(...)Adapt CLASS_TO_STRING, ...;/** Adapt class or class array attributes to strings. */Adapt ANNOTATION_TO_MAP, ...;/** Adapt nested annotation or annotation arrays to maps rather ... */Adapt candidate/** Factory method to create an {@link Adapt} array from a set of boolean flags. ... */EnumSet<Adapt> resultAdapt.classaddIfTrue(...)Adapt.CLASS_TO_STRINGnew Adapt[]import IntFunctionimport Collectorimport Characteristics/** {@link Collector} implementations that provide various reduction operations for ... */new Characteristics[]Characteristics.IDENTITY_FINISH...[] NO_CHARACTERISTICS, ...;...[] IDENTITY_FINISH_CHARACTERISTICS, ...;/** Create a new {@link Collector} that accumulates merged annotations to a ... */new Supplier<Set<A>>(...) { ... }new BiConsumer<Set<A>,MergedAnnotation<A>>(...) { ... }new BinaryOperator<Set<A>>(...) { ... }combiner(...)/** Create a new {@link Collector} that accumulates merged annotations to an ... */toAnnotationArray(...)new IntFunction<Annotation[]>(...) { ... }new Supplier<ArrayList<Object>>(...) { ... }new BiConsumer<ArrayList<Object>,MergedAnnotation<A>>(...) { ... }new BinaryOperator<ArrayList<Object>>(...) { ... }new Function<ArrayList<Object>,R[]>(...) { ... }identity(...)Characteristics[] characteristicsisSameInstance(...)new Supplier<MultiValueMap<String,Object>>(...) { ... }new BiConsumer<MultiValueMap<String,Object>,MergedAnnotation<A>>(...) { ... }new BinaryOperator<MultiValueMap<String,Object>>(...) { ... }/** {@link Collector#combiner() Combiner} for collections. ... *//** {@link Collector#combiner() Combiner} for multi-value maps. ... *//** Predicate implementations that provide various test operations for ... *//** Create a new {@link Predicate} that evaluates to {@code true} if the name of the ... */new Predicate<MergedAnnotation<? extends A>>(...) { ... }/** Create a new {@link Predicate} that evaluates to {@code true} if the ... */new Function<?,String>(...) { ... }/** Create a new stateful, single use {@link Predicate} that matches only ... */new FirstRunOfPredicate<A>(...)/** Create a new stateful, single use {@link Predicate} that matches ... */new UniquePredicate<A,K>(...)/** {@link Predicate} implementation used for ... */Function<? super MergedAnnotation<A>,?> valueExtractor, ...;boolean hasLastValue, ...;Object lastValue, ...;this.valueExtractorthis.hasLastValuethis.lastValuenew HashSet<K>(...)Function<? super MergedAnnotation<A>,K> keyExtractor, ...;Set<K> seen, ...;this.keyExtractorK keythis.seen/** Strategy interface used to select between two {@link MergedAnnotation} ... *//** Determine if the existing annotation is known to be the best ... *//** Select the annotation that should be used. ... *//** {@link MergedAnnotationSelector} implementations that provide various options ... */new Nearest(...)new FirstDirectlyDeclared(...)MergedAnnotationSelector<?> NEAREST, ...;MergedAnnotationSelector<?> FIRST_DIRECTLY_DECLARED, ...;/** Select the nearest annotation, i.e. the one with the lowest distance. ... *//** Select the first directly declared annotation when possible. If no direct ... *//** {@link MergedAnnotationSelector} to select the nearest annotation. *//** {@link MergedAnnotationSelector} to select the first directly declared ... *//** Provides access to a collection of merged annotations, usually obtained ... *//** Determine if the specified annotation is either directly present or ... *//** Determine if the specified annotation is directly present. ... *//** Get the {@linkplain MergedAnnotationSelectors#nearest() nearest} matching ... *//** Get a matching annotation or meta-annotation of the specified type, or ... *//** Stream all annotations and meta-annotations that match the specified ... *//** Stream all annotations and meta-annotations contained in this collection. ... *//** Create a new {@link MergedAnnotations} instance containing all ... *//** Create a new {@link MergedAnnotations} instance from the specified ... *//** Search strategies supported by ... */new SearchStrategy(...)SearchStrategy DIRECT, ...;/** Find only directly declared annotations, without considering ... */SearchStrategy INHERITED_ANNOTATIONS, ...;/** Find all directly declared annotations as well as any ... */SearchStrategy SUPERCLASS, ...;/** Find all directly declared and superclass annotations. This strategy ... */SearchStrategy TYPE_HIERARCHY, ...;/** Perform a full search of the entire type hierarchy, including ... */SearchStrategy TYPE_HIERARCHY_AND_ENCLOSING_CLASSES, ...;/** Perform a full search of the entire type hierarchy on the source ... *//** {@link MergedAnnotations} implementation backed by a {@link Collection} of ... */new MergedAnnotation<?>[]new AnnotationTypeMappings[]this.annotations.lengthnew AnnotationsSpliterator<A>(...)AnnotationTypeMappings mappingsisMappingForType(...)MergedAnnotation<A> resultnearest(...)MergedAnnotation<?> rootint mappingIndexMergedAnnotation<A> candidatecreateIfPossible(...)isBestCandidate(...)select(...)Class<? extends Annotation> actualTypeTypeMappedAnnotations.NONEnew MergedAnnotationsCollection(...)Object requiredType, ...;...[] mappingCursors, ...;this.mappingCursorsint lowestDistanceint annotationResultint annotationIndexgetNextSuitableMapping(...)MergedAnnotation<A> mergedAnnotationcreateMergedAnnotationIfPossible(...)tryAdvance(...)getMapping(...)MergedAnnotationsCollection.this.mappingsMergedAnnotationsCollection.thisint numberOfMappings/** An {@link AbstractMergedAnnotation} used as the implementation of ... */new MissingMergedAnnotation<Annotation>(...)MissingMergedAnnotation<?> INSTANCE, ...;/** {@code @Order} defines the sort order for an annotated component. ... *//** The order value. ... *//** General utility for determining the order of an object based on its type declaration. ... */new ConcurrentReferenceHashMap<AnnotatedElement,Object>(...)Object NOT_ANNOTATED, ...;/** Cache marker for a non-annotated Class. */String JAVAX_PRIORITY_ANNOTATION, ...;Map<AnnotatedElement,Object> orderCache, ...;/** Cache for @Order value (or NOT_ANNOTATED marker) per Class. *//** Return the order on the specified {@code type}, or the specified ... *//** Return the order on the specified {@code type}. ... *//** Return the order declared on the specified {@code element}. ... *//** Return the order from the specified annotations collection. ... */Integer resultMergedAnnotation<Order> orderAnnotationMergedAnnotation<?> priorityAnnotationgetInt(...)/** Return the value of the {@code javax.annotation.Priority} annotation ... *//** {@link AnnotationFilter} implementation used for ... */...[] prefixes, ...;this.prefixes(...).prefixes/** Strategy used to determine annotations that act as containers for other ... */RepeatableContainers parent, ...;/** Add an additional explicit relationship between a contained and ... */new ExplicitRepeatableContainer(...)(...).parent/** Create a {@link RepeatableContainers} instance that searches using Java's ... */StandardRepeatableContainers.INSTANCE/** Create a {@link RepeatableContainers} instance that uses a defined ... *//** Create a {@link RepeatableContainers} instance that does not expand any ... */NoRepeatableContainers.INSTANCE/** Standard {@link RepeatableContainers} implementation that searches using ... */new ConcurrentReferenceHashMap<Class<? extends Annotation>,Object>(...)new StandardRepeatableContainers(...)Map<Class<? extends Annotation>,Object> cache, ...;Object NONE, ...;StandardRepeatableContainers INSTANCE, ...;getRepeatedAnnotationsMethod(...)new Function<Class<? extends Annotation>,Object>(...) { ... }computeRepeatedAnnotationsMethod(...)hasOnlyValueAttribute(...)Repeatable.class/** A single explicit mapping. */Class<? extends Annotation> repeatable, ...;Class<? extends Annotation> container, ...;Method valueMethod, ...;Method valueMethoddeduceContainer(...)AnnotationConfigurationException exthis.repeatablethis.containerthis.valueMethodRepeatable annotationExplicitRepeatableContainer otherErcotherErc.containerotherErc.repeatable/** No repeatable containers. */new NoRepeatableContainers(...)NoRepeatableContainers INSTANCE, ...;/** Marker interface implemented by synthesized annotation proxies. ... *//** {@link InvocationHandler} for an {@link Annotation} that Spring has ... */MergedAnnotation<?> annotation, ...;Class<A> type, ...;Map<String,Object> valueCache, ...;Integer hashCode, ...;annotationEquals(...)annotationHashCode(...)annotationToString(...)isAnnotationTypeMethod(...)/** See {@link Annotation#equals(Object)} for a definition of the required algorithm. ... */Object thisValueObject otherValue/** See {@link Annotation#hashCode()} for a definition of the required algorithm. */Integer hashCodecomputeHashCode(...)getValueHashCode(...)this.valueCacheresolvePrimitiveIfNecessary(...)orElseThrow(...)new Supplier<NoSuchElementException>(...) { ... }cloneArray(...)/** Clone the provided array, ensuring that the original component type is retained. ... */new SynthesizedMergedAnnotationInvocationHandler<A>(...)isVisible(...)SynthesizedAnnotation.class// Use Arrays.hashCode(...) since Spring's ObjectUtils doesn't comply// with the requirements specified in Annotation#hashCode().// Clone non-empty arrays so that users cannot alter the contents of values in our cache.// else/** A {@link MethodParameter} variant which synthesizes annotations that ... *//** Create a new {@code SynthesizingMethodParameter} for the given method, ... *//** Create a new {@code SynthesizingMethodParameter} for the given method. ... *//** Create a new {@code SynthesizingMethodParameter} for the given constructor, ... *//** Create a new {@code SynthesizingMethodParameter} for the given constructor. ... *//** Copy constructor, resulting in an independent {@code SynthesizingMethodParameter} ... */new SynthesizingMethodParameter(...)/** Create a new SynthesizingMethodParameter for the given method or constructor. ... *//** Create a new SynthesizingMethodParameter for the given parameter descriptor. ... *//** {@link MergedAnnotation} that adapts attributes from a root annotation by ... */Map<Class<?>,Object> emptyArraysMap<Class<?>,Object> EMPTY_ARRAYS, ...;AnnotationTypeMapping mapping, ...;Object rootAttributes, ...;ValueExtractor valueExtractor, ...;int aggregateIndex, ...;boolean useMergedValues, ...;Predicate<String> attributeFilter, ...;...[] resolvedRootMirrors, ...;...[] resolvedMirrors, ...;this.mappingthis.rootAttributesthis.aggregateIndexthis.useMergedValuesthis.attributeFilterthis.resolvedRootMirrorsthis.resolvedMirrorsgetValueForMirrorResolution(...)AnnotationTypeMapping metaSourceMappingnew TypeMappedAnnotation<Annotation>(...)AnnotationTypeMapping rootMappinggetRequiredValue(...)adapt(...)new TypeMappedAnnotation(...)new Function<MergedAnnotation<?>,LinkedHashMap<String,Object>>(...) { ... }T mapisFiltered(...)getTypeForMapOptions(...)adaptValueForMapOptions(...)Class<?> attributeTypeisIn(...)MergedAnnotation<?>[] annotationsgetAliasMapping(...)getConventionMapping(...)getValueFromMetaAnnotation(...)getMappedAnnotationValue(...)boolean valueAttributeadaptForAttribute(...)getAdaptType(...)adaptToMergedAnnotation(...)MergedAnnotation<?>[] resultisEmptyObjectArray(...)emptyArray(...)getValueExtractor(...)extractFromMap(...)new TypeMappedAnnotation<A>(...)TypeMappedAnnotation<?> typeMappedAnnotationtypeMappedAnnotation.sourcetypeMappedAnnotation.rootAttributestypeMappedAnnotation.valueExtractortypeMappedAnnotation.aggregateIndex// Already synthesized?/** {@link MergedAnnotations} implementation that searches for and adapts ... */new TypeMappedAnnotations(...)AnnotationFilter.ALLMergedAnnotations NONE, ...;/** Shared instance that can be used when there are no annotations. */SearchStrategy searchStrategy, ...;AnnotationFilter annotationFilter, ...;List<Aggregate> aggregates, ...;this.searchStrategythis.annotationFilternew MergedAnnotationFinder<A>(...)emptyIterator(...)emptySpliterator(...)new AggregatesSpliterator<A>(...)getAggregates(...)List<Aggregate> aggregatesthis.aggregatesnew AggregatesCollector(...)isKnownEmpty(...)/** {@link AnnotationsProcessor} used to detect if an annotation is directly ... */new IsPresent[]new IsPresent(...)...[] SHARED, ...;/** Shared instances that save us needing to create a new processor for ... */boolean directOnly, ...;this.directOnly/** {@link AnnotationsProcessor} that finds a single {@link MergedAnnotation}. */Predicate<? super MergedAnnotation<A>> predicate, ...;MergedAnnotationSelector<A> selector, ...;MergedAnnotation<A> result, ...;this.predicatethis.selectorupdateLastResult(...)MergedAnnotation<A> lastResult/** {@link AnnotationsProcessor} that collects {@link Aggregate} instances. */new ArrayList<Aggregate>(...)createAggregate(...)List<Annotation> aggregateAnnotationsgetAggregateAnnotations(...)new Aggregate(...)List<Annotation> resultnew ArrayList<Annotation>(...)addAggregateAnnotations(...)List<Annotation> annotations, ...;getMappings(...)/** {@link Spliterator} used to consume merged annotations from the ... */int aggregateCursor, ...;this.aggregateCursorAggregate aggregateint[] cursors// Use a single shared instance for common combinations/** Strategy API for extracting a value for an annotation attribute from a given ... *//** Extract the annotation attribute represented by the supplied {@link Method} ... *//** Core support package for annotations, meta-annotations, and merged ... */import DataBufferimport DataBufferUtilsimport MimeType/** Abstract base class for {@code Decoder} implementations that can decode ... */int maxInMemorySize, ...;/** Configure a limit on the number of bytes that can be buffered whenever ... */this.maxInMemorySize/** Return the {@link #setMaxInMemorySize configured} byte count limit. ... */new Function<DataBuffer,T>(...) { ... }decodeDataBuffer(...)/** How to decode a {@code DataBuffer} to the target element type. ... *//** Abstract base class for {@link Decoder} implementations. ... */List<MimeType> decodableMimeTypes, ...;this.decodableMimeTypes/** Set an alternative logger to use than the one based on the class name. ... *//** Return the currently configured Logger. ... */MimeType candidateisCompatibleWith(...)List<MimeType> encodableMimeTypes, ...;this.encodableMimeTypesimport DataBufferFactoryimport PooledDataBuffer/** Abstract base class for {@link org.springframework.core.codec.Encoder} ... */doOnDiscard(...)concatMap(...)PooledDataBuffer.classtake(...)new Function<? extends T,Publisher<? extends DataBuffer>>(...) { ... }encode(...)new Consumer<PooledDataBuffer>(...) { ... }release(...)/** Encode {@code T} to an output {@link DataBuffer} stream. ... */import MimeTypeUtils/** Decoder for {@code byte} arrays. ... */MimeTypeUtils.ALLcanDecode(...)readableByteCount(...)getLogPrefix(...)/** Encoder for {@code byte} arrays. ... */canEncode(...)new Function<byte[],DataBuffer>(...) { ... }encodeValue(...)DataBuffer dataBufferisLoggingSuppressed(...)String logPrefix// Use (byte[] bytes) for Eclipseimport ByteBuffer/** Decoder for {@link ByteBuffer ByteBuffers}. ... */ByteBuffer.classint byteCountByteBuffer copyallocate(...)asByteBuffer(...)flip(...)/** Encoder for {@link ByteBuffer ByteBuffers}. ... */new Function<? extends ByteBuffer,DataBuffer>(...) { ... }import CoderMalfunctionErrorimport LogFormatUtils/** Encode from a {@code CharSequence} stream to a bytes stream. ... */new ConcurrentHashMap<Charset,Float>(...)StandardCharsets.UTF_8Charset DEFAULT_CHARSET, ...;/** The default charset used by the encoder. */ConcurrentMap<Charset,Float> charsetToMaxBytesPerChar, ...;new Function<? extends CharSequence,DataBuffer>(...) { ... }boolean releasegetCharset(...)int capacitycalculateCapacity(...)allocateBuffer(...)traceDebug(...)new Function<Boolean,String>(...) { ... }formatValue(...)CoderMalfunctionError exnew EncodingException(...)float maxBytesPerCharthis.charsetToMaxBytesPerCharnew Function<Charset,Float>(...) { ... }maxBytesPerChar(...)newEncoder(...)float maxBytesForSequenceceil(...)/** Create a {@code CharSequenceEncoder} that supports only "text/plain". */new CharSequenceEncoder(...)new MimeType(...)/** Create a {@code CharSequenceEncoder} that supports all MIME types. *//** General error that indicates a problem while encoding and decoding to and ... *//** Create a new CodecException. ... *//** Simple pass-through decoder for {@link DataBuffer DataBuffers}. ... */DataBuffer.class/** Simple pass-through encoder for {@link DataBuffer DataBuffers}. ... */Flux<DataBuffer> fluxdoOnNext(...)new Consumer<DataBuffer>(...) { ... }logValue(...)/** Strategy for decoding a {@link DataBuffer} input stream into an output stream ... *//** Whether the decoder supports the given target element type and the MIME ... *//** Decode a {@link DataBuffer} input stream into a Flux of {@code T}. ... *//** Decode a {@link DataBuffer} input stream into a Mono of {@code T}. ... *//** Decode a data buffer to an Object of type T. This is useful for scenarios, ... */CompletableFuture<T> futuredecodeToMono(...)Throwable failurenew DecodingException(...)/** Return the list of MIME types supported by this Decoder. The list may not ... *//** Return the list of MIME types supported by this Decoder for the given type ... */getDecodableMimeTypes(...)/** Indicates an issue with decoding the input stream with a focus on content ... *//** Create a new DecodingException. ... *//** Strategy to encode a stream of Objects of type {@code <T>} into an output ... *//** Whether the encoder supports the given source element type and the MIME ... *//** Encode a stream of Objects of type {@code T} into a {@link DataBuffer} ... *//** Encode an Object of type T to a data buffer. This is useful for scenarios, ... *//** Return the list of MIME types supported by this Encoder. The list may not ... *//** Return the list of MIME types supported by this Encoder for the given type ... */getEncodableMimeTypes(...)// It may not be possible to produce a single DataBuffer synchronously/** Indicates an issue with encoding the input Object stream with a focus on ... *//** Create a new EncodingException. ... *//** Constants and convenience methods for working with hints. ... */String LOG_PREFIX_HINT, ...;/** Name of hint exposing a prefix to use for correlating log messages. */String SUPPRESS_LOGGING_HINT, ...;/** Name of boolean hint whether to avoid logging data either because it's ... *//** Create a map wit a single hint via {@link Collections#singletonMap}. ... *//** Return an empty map of hints via {@link Collections#emptyMap()}. ... *//** Obtain the value for a required hint. ... */T hint/** Obtain the hint {@link #LOG_PREFIX_HINT}, if present, or an empty String. ... *//** Whether to suppress logging based on the hint {@link #SUPPRESS_LOGGING_HINT}. ... *//** Merge two maps of hints, creating and copying into a new map if both have ... *//** Merge a single hint into a map of hints, possibly creating and copying ... *//** If the hints contain a {@link #LOG_PREFIX_HINT} and the given logger has ... */Object logPrefixtouch(...)import ByteBufimport Unpooledimport NettyDataBuffer/** Decoder for {@link ByteBuf ByteBufs}. ... */ByteBuf.classByteBuf byteBufgetNativeBuffer(...)wrappedBuffer(...)import NettyDataBufferFactory/** Encoder for {@link ByteBuf ByteBufs}. ... */new Function<? extends ByteBuf,DataBuffer>(...) { ... }readableBytes(...)readBytes(...)/** Decoder for {@link Resource Resources}. ... */ResourceDecoder.classString FILENAME_HINT, ...;/** Name of hint with a filename for the resource(e.g. from "Content-Disposition" HTTP header). */InputStreamResource.classnew InputStreamResource(...) { ... }new ByteArrayResource(...) { ... }/** Encoder for {@link Resource Resources}. ... */StreamUtils.BUFFER_SIZEint DEFAULT_BUFFER_SIZE, ...;/** The default buffer size used by the encoder. */int bufferSize, ...;MimeTypeUtils.APPLICATION_OCTET_STREAMthis.bufferSizeimport OptionalLongimport ResourceRegion/** Encoder for {@link ResourceRegion ResourceRegions}. ... */ResourceRegionEncoder.classString BOUNDARY_STRING_HINT, ...;/** The hint key that contains the boundary string. */ResourceRegion.classflatMapMany(...)new Function<? extends ResourceRegion,Publisher<? extends DataBuffer>>(...) { ... }writeResourceRegion(...)String boundaryStringgetRequiredHint(...)byte[] startBoundarytoAsciiBytes(...)byte[] contentTypeconcatWithValues(...)getRegionSuffix(...)Flux<DataBuffer> prefixgetContentRangeHeader(...)concatWith(...)long positiongetPosition(...)Flux<DataBuffer> intouchDataBuffer(...)takeUntilByteCount(...)byte[] endBoundaryStandardCharsets.US_ASCIIlong startlong endOptionalLong contentLengthlong lengthgetAsLong(...)/** Determine, if possible, the contentLength of the given resource without reading it. ... */IOException ignored// only wrapping, no allocation// No doOnDiscard (no caching after DataBufferUtils#read)// Don't try to determine contentLength on InputStreamResource - cannot be read afterwards...// Note: custom InputStreamResource subclasses could provide a pre-calculated content length!import CharBufferimport LimitedDataBufferList/** Decode from a data buffer stream to a {@code String} stream, either splitting ... */new ConcurrentHashMap<Charset,byte[][]>(...)/** The default charset to use, i.e. "UTF-8". */List<String> DEFAULT_DELIMITERS, ...;/** The default delimiter strings to use, i.e. {@code \r\n} and {@code \n}. */List<String> delimiters, ...;boolean stripDelimiter, ...;Charset defaultCharset, ...;ConcurrentMap<Charset,byte[][]> delimitersCache, ...;this.delimitersthis.stripDelimiter/** Set the default character set to fall back on if the MimeType does not specify any. ... */this.defaultCharset/** Return the configured {@link #setDefaultCharset(Charset) defaultCharset}. ... */byte[][] delimiterBytesgetDelimiterBytes(...)LimitedDataBufferList chunksnew LimitedDataBufferList(...)getMaxInMemorySize(...)DataBufferUtils.MatcherdoOnTerminate(...)concatMapIterable(...)defer(...)new Function<DataBuffer,Iterable<? extends DataBuffer>>(...) { ... }processDataBuffer(...)new Supplier<Mono<? extends DataBuffer>>(...) { ... }DataBuffer lastBufferfactory(...)releaseAndClear(...)new Function<DataBuffer,String>(...) { ... }this.delimitersCachenew Function<Charset,byte[][]>(...) { ... }byte[][] resultnew byte[][]List<DataBuffer> resultreadPosition(...)DataBuffer sliceretainedSlice(...)retain(...)new ArrayList<DataBuffer>(...)writePosition(...)delimiter(...).lengthdelimiter(...)DataBuffer joinedCharBuffer charBuffergetDefaultCharset(...)/** Create a {@code StringDecoder} for {@code "text/plain"}. ... */textPlainOnly(...)/** Create a {@code StringDecoder} for {@code "text/plain"}. */new StringDecoder(...)/** Create a {@code StringDecoder} that supports all MIME types. ... */allMimeTypes(...)/** Create a {@code StringDecoder} that supports all MIME types. */// retain after add (may raise DataBufferLimitException)/** {@link org.springframework.core.codec.Encoder} and ... *//** Base class for exceptions thrown by the conversion system. ... *//** Construct a new conversion exception. ... *//** Exception to be thrown when an actual type conversion attempt fails. ... */TypeDescriptor sourceType, ...;TypeDescriptor targetType, ...;/** Create a new conversion exception. ... *//** Return the source type we tried to convert the value from. *//** Return the target type we tried to convert the value to. *//** Return the offending value. *//** A service interface for type conversion. This is the entry point into the convert system. ... *//** Return {@code true} if objects of {@code sourceType} can be converted to the {@code targetType}. ... *//** Convert the given {@code source} to the specified {@code targetType}. ... *//** Exception to be thrown when a suitable converter could not be found ... *//** Create a new conversion executor not found exception. ... *//** Return the source type that was requested to convert from. *//** Return the target type that was requested to convert to. *//** A description of a JavaBeans Property that allows us to avoid a dependency on ... */new ConcurrentReferenceHashMap<Property,Annotation[]>(...)Map<Property,Annotation[]> annotationCache, ...;Class<?> objectType, ...;this.objectTyperesolveMethodParameter(...)resolveName(...)/** The object declaring this property, either directly or in a superclass the object extends. *//** The name of the property: e.g. 'foo' *//** The property type: e.g. {@code java.lang.String} *//** The property getter method: e.g. {@code getFoo()} *//** The property setter method: e.g. {@code setFoo(String)} */// Package privateresolveAnnotations(...)MethodParameter readresolveReadMethodParameter(...)MethodParameter writeresolveWriteMethodParameter(...)Class<?> readTypeClass<?> writeTypeMap<Class<? extends Annotation>,Annotation> annotationMapnew LinkedHashMap<Class<? extends Annotation>,Annotation>(...)addAnnotationsToMap(...)declaringClass(...)Property otherPropertyotherProperty.objectTypeotherProperty.nameotherProperty.readMethodotherProperty.writeMethod// Record-style plain accessor method, e.g. name()// Same lenient fallback checking as in CachedIntrospectionResults.../** Contextual descriptor about a type to convert from or to. ... */new HashMap<Class<?>,TypeDescriptor>(...)Class<?> preCachedClassMap<Class<?>,TypeDescriptor> commonTypesCache, ...;...[] CACHED_COMMON_TYPES, ...;Class<?> type, ...;AnnotatedElementAdapter annotatedElement, ...;/** Create a new type descriptor from a {@link MethodParameter}. ... */this.annotatedElementnew AnnotatedElementAdapter(...)/** Create a new type descriptor from a {@link Field}. ... *//** Create a new type descriptor from a {@link Property}. ... *//** Create a new type descriptor from a {@link ResolvableType}. ... *//** Variation of {@link #getType()} that accounts for a primitive type by ... *//** The type of the backing class, method parameter, field, or property ... *//** Return the underlying {@link ResolvableType}. ... *//** Return the underlying source of the descriptor. Will return a {@link Field}, ... *//** Narrows this {@link TypeDescriptor} by setting its type to the class of the ... */ResolvableType narrowed/** Cast this {@link TypeDescriptor} to a superclass or implemented interface ... *//** Return the name of this type: the fully qualified class name. *//** Is this type a primitive type? *//** Return the annotations associated with this type descriptor, if any. ... *//** Determine if this type descriptor has the specified annotation. ... *//** Obtain the annotation of the specified {@code annotationType} that is on this type descriptor. ... */getMergedAnnotation(...)/** Returns true if an object of this type descriptor can be assigned to the location ... */boolean typesAssignableisNestedAssignable(...)isCollection(...)isMap(...)/** Is this type a {@link Collection} type? *//** Is this type an array type? *//** If this type is an array, returns the array's component type. ... */Stream<>.classgetRelatedIfResolvable(...)/** If this type is a {@link Collection} or an array, creates a element TypeDescriptor ... */narrow(...)/** Is this type a {@link Map} type? *//** If this type is a {@link Map} and its key type is parameterized, ... *//** If this type is a {@link Map}, creates a mapKey {@link TypeDescriptor} ... *//** If this type is a {@link Map} and its value type is parameterized, ... *//** If this type is a {@link Map}, creates a mapValue {@link TypeDescriptor} ... */TypeDescriptor otherDescannotationsMatch(...)Annotation[] otherAnnsanns.lengthotherAnns.length/** Create a new type descriptor for an object. ... *//** Create a new type descriptor from the given type. ... *//** Create a new type descriptor from a {@link java.util.Collection} type. ... */ResolvableType elementelementTypeDescriptor.resolvableType/** Create a new type descriptor from a {@link java.util.Map} type. ... */ResolvableType keykeyTypeDescriptor.resolvableTypeResolvableType valuevalueTypeDescriptor.resolvableType/** Create a new type descriptor as an array of the specified type. ... */forArrayComponent(...)/** Create a type descriptor for a nested type declared within the method parameter. ... *//** Create a type descriptor for a nested type declared within the field. ... *//** Create a type descriptor for a nested type declared within the property. ... */ResolvableType nestedtypeDescriptor.resolvableType/** Adapter class for exposing a {@code TypeDescriptor}'s annotations as an ... */(...).annotationsTypeDescriptor.this// Shortcut: AnnotatedElementUtils would have to expect AnnotatedElement.getAnnotations()// to return a copy of the array, whereas we can do it more efficiently here.// Annotation.equals is reflective and pretty slow, so let's check identity and proxy type first.// Could be a collection type but we don't know about its element type,// so let's just assume there is an element type of type Object.../** Allows a {@link Converter}, {@link GenericConverter} or {@link ConverterFactory} to ... *//** Should the conversion from {@code sourceType} to {@code targetType} currently under ... *//** A {@link GenericConverter} that may conditionally execute based on attributes ... *//** A converter converts a source object of type {@code S} to a target of type {@code T}. ... *//** Convert the source object of type {@code S} to target type {@code T}. ... *//** Construct a composed {@link Converter} that first applies this {@link Converter} ... */new Converter<S,U>(...) { ... }T initialResult/** A factory for "ranged" converters that can convert objects from S to subtypes of R. ... *//** Get the converter to convert from S to target type T, where T is also an instance of R. ... *//** For registering converters with a type conversion system. ... *//** Add a plain converter to this registry. ... *//** Add a generic converter to this registry. *//** Add a ranged converter factory to this registry. ... *//** Remove any converters from {@code sourceType} to {@code targetType}. ... */import Comparators/** A {@link Comparator} that converts values before they are compared. ... */Comparator<T> comparator, ...;Converter<S,T> converter, ...;/** Create a new {@link ConvertingComparator} instance. ... */comparable(...)this.converter/** Create a new {@code ConvertingComparator} instance. ... */new ConversionServiceConverter<S,T>(...)T c1T c2/** Create a new {@link ConvertingComparator} that compares {@linkplain java.util.Map.Entry ... */new ConvertingComparator<Entry<K,V>,K>(...)new Converter<Entry<K,V>,K>(...) { ... }new ConvertingComparator<Entry<K,V>,V>(...)new Converter<Entry<K,V>,V>(...) { ... }/** Adapts a {@link ConversionService} and <tt>targetType</tt> to a {@link Converter}. */Class<? extends T> targetType, ...;/** Generic converter interface for converting between two or more types. ... *//** Return the source and target types that this converter can convert between. ... *//** Convert the source object to the targetType described by the {@code TypeDescriptor}. ... *//** Holder for a source-to-target class pair. */Class<?> targetType, ...;/** Create a new source-to-target pair. ... */ConvertiblePair otherPairConvertiblePair.classotherPair.sourceTypeotherPair.targetType/** SPI to implement Converters for the type conversion system. *//** Type conversion system API. */import ConditionalConverter/** A {@link ConditionalConverter} base implementation for enum-based converters. ... *//** Converts an array to another array. First adapts the source array to a List, ... */CollectionToArrayConverter helperConverter, ...;this.helperConverternew CollectionToArrayConverter(...)List<Object> sourceListTypeDescriptor targetElementcanBypassConvert(...)/** Converts an array to a Collection. ... */canConvertElements(...)Object sourceElementObject targetElementelementTypeDescriptor(...)/** Converts an array to an Object by returning the first array element ... */Object firstElement/** Converts an array to a comma-delimited String. First adapts the source array ... */CollectionToStringConverter helperConverter, ...;new CollectionToStringConverter(...)import Buffer/** Converts a {@link ByteBuffer} directly to and from {@code byte[] ByteBuffer} directly to and from {@code byte[]s} and indirectly ... */Set<ConvertiblePair> convertiblePairsnew HashSet<ConvertiblePair>(...)TypeDescriptor BYTE_BUFFER_TYPE, ...;TypeDescriptor BYTE_ARRAY_TYPE, ...;Set<ConvertiblePair> CONVERTIBLE_PAIRS, ...;boolean byteBufferTargetmatchesFromByteBuffer(...)matchesToByteBuffer(...)ByteBuffer bufferduplicate(...)convertFromByteBuffer(...)convertToByteBuffer(...)remaining(...)ByteBuffer byteBufferrewind(...)// Should not happen// Extra cast necessary for compiling on JDK 9 plus running on JDK 8, since// otherwise the overridden ByteBuffer-returning rewind method would be chosen// which isn't available on JDK 8./** Converts from a Character to any JDK-standard Number implementation. ... */new CharacterToNumber<T>(...)Class<T> targetType, ...;/** Converts a Collection to an array. ... */Collection<?> sourceCollectionTypeDescriptor targetElementType/** Converts from a Collection to another Collection. ... */boolean copyRequired// Shortcut if possible...// At this point, we need a collection copy in any case, even if just for finding out about element copies.../** Converts a Collection to an Object by returning the first collection element after converting it to the desired targetType. ... *//** Converts a Collection to a comma-delimited String. ... */String DELIMITER, ...;/** Configuration interface to be implemented by most if not all {@link ConversionService} ... *//** A factory for common {@link org.springframework.core.convert.ConversionService} ... *//** Register the given Converter objects with the given target ConverterRegistry. ... */Object converter/** Internal utilities for the conversion package. ... */Class<?> enumType// yes// maybe// no/** Adapter that exposes a {@link java.beans.PropertyEditor} for any given ... */TypeDescriptor targetDescriptor, ...;boolean canConvertToString, ...;/** Create a new ConvertingPropertyEditorAdapter for a given ... */this.targetDescriptorthis.canConvertToString/** A specialization of {@link GenericConversionService} configured by default ... */DefaultConversionService sharedInstance, ...;/** Create a new {@code DefaultConversionService} with the set of ... *//** Return a shared default {@code ConversionService} instance, ... */DefaultConversionService csDefaultConversionService.class/** Add converters appropriate for most environments. ... */addScalarConverters(...)addCollectionConverters(...)new ByteBufferConverter(...)new StringToTimeZoneConverter(...)new ZoneIdToTimeZoneConverter(...)new ZonedDateTimeToCalendarConverter(...)new ObjectToObjectConverter(...)new IdToEntityConverter(...)new FallbackObjectToStringConverter(...)new ObjectToOptionalConverter(...)/** Add common collection converters. ... */new ArrayToCollectionConverter(...)new ArrayToArrayConverter(...)new CollectionToCollectionConverter(...)new MapToMapConverter(...)new ArrayToStringConverter(...)new StringToArrayConverter(...)new ArrayToObjectConverter(...)new ObjectToArrayConverter(...)new StringToCollectionConverter(...)new CollectionToObjectConverter(...)new ObjectToCollectionConverter(...)new StreamConverter(...)new NumberToNumberConverterFactory(...)new StringToNumberConverterFactory(...)new ObjectToStringConverter(...)new StringToCharacterConverter(...)new NumberToCharacterConverter(...)new CharacterToNumberFactory(...)new StringToBooleanConverter(...)new StringToEnumConverterFactory(...)new EnumToStringConverter(...)new IntegerToEnumConverterFactory(...)new EnumToIntegerConverter(...)new StringToLocaleConverter(...)new StringToCharsetConverter(...)new StringToCurrencyConverter(...)new StringToPropertiesConverter(...)new PropertiesToStringConverter(...)new StringToUUIDConverter(...)/** Calls {@link Enum#ordinal()} to convert a source Enum to a Integer. ... *//** Calls {@link Enum#name()} to convert a source Enum to a String. ... *//** Simply calls {@link Object#toString()} to convert any supported object ... */hasConversionMethodOrConstructor(...)StringWriter.class// no conversion requiredimport ConcurrentLinkedDequeimport ConvertiblePair/** Base {@link ConversionService} implementation suitable for use in most environments. ... */new Converters(...)new ConcurrentReferenceHashMap<ConverterCacheKey,GenericConverter>(...)new NoOpConverter(...)GenericConverter NO_OP_CONVERTER, ...;/** General NO-OP converter used when conversion is not required. */GenericConverter NO_MATCH, ...;/** Used as a cache entry when no converter is available. ... */Converters converters, ...;Map<ConverterCacheKey,GenericConverter> converterCache, ...;// ConverterRegistry implementationResolvableType[] typeInfogetRequiredTypeInfo(...)Converter<>.classnew ConverterAdapter(...)invalidateCache(...)ConverterFactory<>.classnew ConverterFactoryAdapter(...)// ConversionService implementationgetConverter(...)/** Return whether conversion between the source type and the target type can be bypassed. ... */convertNullSource(...)invokeConverter(...)handleConverterNotFound(...)/** Convenience operation for converting a source object to the specified targetType, ... *//** Template method to convert a {@code null} source. ... */// Protected template methods/** Hook method to lookup the converter for a given sourceType/targetType pair. ... */ConverterCacheKey keynew ConverterCacheKey(...)this.converterCachegetDefaultConverter(...)/** Return the default converter if no converter is found for the given sourceType/targetType pair. ... */assertNotPrimitiveTargetType(...)new ConverterNotFoundException(...)/** Adapts a {@link Converter} to a {@link GenericConverter}. */Converter<Object,Object> converter, ...;ConvertiblePair typeInfo, ...;this.typeInfoResolvableType rt/** Adapts a {@link ConverterFactory} to a {@link GenericConverter}. */ConverterFactory<Object,Object> converterFactory, ...;this.converterFactoryboolean matches/** Key for use with the converter cache. */ConverterCacheKey otherKeyotherKey.targetTypeother.targetType/** Manages all converters registered with the service. */new CopyOnWriteArraySet<GenericConverter>(...)new ConcurrentHashMap<ConvertiblePair,ConvertersForPair>(...)Set<GenericConverter> globalConverters, ...;Map<ConvertiblePair,ConvertersForPair> converters, ...;Set<ConvertiblePair> convertibleTypesgetConvertibleTypes(...)this.globalConvertersConvertiblePair convertiblePairgetMatchableConverters(...)new Function<ConvertiblePair,ConvertersForPair>(...) { ... }new ConvertersForPair(...)/** Find a {@link GenericConverter} given a source and target type. ... */List<Class<?>> sourceCandidatesgetClassHierarchy(...)List<Class<?>> targetCandidatesClass<?> sourceCandidateClass<?> targetCandidategetRegisteredConverter(...)ConvertersForPair convertersForPairGenericConverter globalConverter/** Returns an ordered class hierarchy for the given type. ... */List<Class<?>> hierarchySet<Class<?>> visitedboolean arrayaddToClassHierarchy(...)Class<?> candidateaddInterfacesToClassHierarchy(...)Class<?> implementedInterfaceString converterStringgetConverterStrings(...)List<String> converterStrings/** Manages converters registered with a specific {@link ConvertiblePair}. */new ConcurrentLinkedDeque<GenericConverter>(...)Deque<GenericConverter> converters, ...;/** Internal converter that performs no operation. */// Check raw type first...// Full check for complex generic type match required?// Search the full type hierarchy// Check specifically registered converters// Check ConditionalConverters for a dynamic match/** Converts an entity identifier to a entity reference by calling a static finder method ... */Method findergetFinder(...)Object idString finderMethodgetEntityName(...)boolean localOnlyFilteredint lastDot// Not allowed to access non-public methods...// Fallback: check locally declared public methods only./** Converts from a Integer to a {@link java.lang.Enum} by calling {@link Class#getEnumConstants()}. ... */new IntegerToEnum<>(...)getEnumType(...)Class<T> enumType, ...;this.enumTypegetEnumConstants(...)/** Converts a Map to another Map. ... */canConvertKey(...)canConvertValue(...)Map<Object,Object> sourceMapTypeDescriptor valueDescList<MapEntry> targetEntriesnew ArrayList<MapEntry>(...)Map<Object,Object> targetMapEntry<Object,Object> entryMap<>.Entry<Object,Object>Object sourceKeyObject targetKeyObject targetValuenew MapEntry(...)MapEntry entryaddToMap(...)// internal helpers/** Converts from any JDK-standard Number implementation to a Character. ... *//** Converts from any JDK-standard Number implementation to any other JDK-standard Number implementation. ... */new NumberToNumber<T>(...)/** Converts an Object to a single-element array containing the Object. ... *//** Converts an Object to a single-element Collection containing the Object. ... */Object singleElement/** Generic converter that uses conventions to convert a source object to a ... */new ConcurrentReferenceHashMap<Class<?>,Member>(...)Map<Class<?>,Member> conversionMemberCache, ...;// Cache for the latest to-method resolved on a given ClassgetValidatedMember(...)isApplicable(...)determineToMethod(...)determineFactoryMethod(...)determineFactoryConstructor(...)getStaticMethod(...)getConstructorIfAvailable(...)// If sourceClass is Number and targetClass is Integer, the following message should expand to:// No toInteger() method exists on java.lang.Number, and no static valueOf/of/from(java.lang.Number)// method or Integer(java.lang.Number) constructor exists on java.lang.Integer.// Do not accept a toString() method or any to methods on String itself// Do not accept the String.valueOf(Object) method/** Convert an Object to {@code java.util.Optional<T>} if necessary using the ... */new LinkedHashSet<ConvertiblePair>(...)new GenericTypeDescriptor(...)/** Simply calls {@link Object#toString()} to convert a source Object to a String. ... *//** Converts from a Properties to a String by calling {@link Properties#store(java.io.OutputStream, String)}. ... */ByteArrayOutputStream os/** Converts a {@link Stream} to and from a collection or array, converting the ... */createConvertibleTypes(...)TypeDescriptor STREAM_TYPE, ...;Set<ConvertiblePair> CONVERTIBLE_TYPES, ...;matchesFromStream(...)matchesToStream(...)/** Validate that a {@link Collection} of the elements held within the stream can be ... */TypeDescriptor collectionOfElementcollection(...)/** Validate that the specified {@code sourceType} can be converted to a {@link Collection} of ... */convertFromStream(...)convertToStream(...)List<Object> contentTypeDescriptor listTypeTypeDescriptor targetCollectionList<?> target/** Converts a comma-delimited String to an Array. ... */String sourceElement/** Converts String to a Boolean. ... */Set<String> trueValues, ...;Set<String> falseValues, ...;/** Converts a String to a Character. ... *//** Convert a String to a {@link Charset}. ... *//** Converts a comma-delimited String to a Collection. ... *//** Convert a String to a {@link Currency}. ... *//** Converts from a String to a {@link java.lang.Enum} by calling {@link Enum#valueOf(Class, String)}. ... */new StringToEnum<>(...)/** Converts from a String to a {@link java.util.Locale}. ... */parseLocale(...)/** Converts from a String any JDK-standard Number implementation. ... */new StringToNumber<T>(...)/** Converts a String to a Properties by calling Properties#load(java.io.InputStream). ... *//** Convert a String to a {@link TimeZone}. ... *//** Converts from a String to a {@link java.util.UUID}. ... *//** Simple converter from Java 8's {@link java.time.ZoneId} to {@link java.util.TimeZone}. ... *//** Simple converter from Java 8's {@link java.time.ZonedDateTime} to {@link java.util.Calendar}. ... *//** Default implementation of the type conversion system. */import ConfigurableConversionService/** Abstract base class for {@link Environment} implementations. Supports the notion of ... */getReservedDefaultProfiles(...)String IGNORE_GETENV_PROPERTY_NAME, ...;/** System property that instructs Spring to ignore system environment variables, ... */String ACTIVE_PROFILES_PROPERTY_NAME, ...;/** Name of property to set to specify active profiles: {@value}. Value may be comma ... */String DEFAULT_PROFILES_PROPERTY_NAME, ...;/** Name of property to set to specify profiles active by default: {@value}. Value may ... */String RESERVED_DEFAULT_PROFILE_NAME, ...;/** Name of reserved default profile name: {@value}. If no default profile names are ... */Set<String> activeProfiles, ...;Set<String> defaultProfiles, ...;ConfigurablePropertyResolver propertyResolver, ...;/** Create a new {@code Environment} instance, calling back to ... */customizePropertySources(...)/** Customize the set of {@link PropertySource} objects to be searched by this ... *//** Return the set of reserved default profile names. This implementation returns ... */// Implementation of ConfigurableEnvironment interfacedoGetActiveProfiles(...)/** Return the set of active profiles as explicitly set through ... */this.activeProfilesString profilesString profilevalidateProfile(...)doGetDefaultProfiles(...)/** Return the set of default profiles explicitly set via ... */this.defaultProfiles/** Specify the set of profiles to be made active by default if no other profiles ... */isProfileActive(...)/** Return whether the given profile is active, or if active profiles are empty ... */Set<String> currentActiveProfiles/** Validate the given profile, called internally prior to adding to the set of ... */AccessControlException exnew ReadOnlySystemAttributesMap(...) { ... }suppressGetenvAccess(...)/** Determine whether to suppress {@link System#getenv()}/{@link System#getenv(String)} ... */String[] parentActiveProfilesgetActiveProfiles(...)String[] parentDefaultProfilesgetDefaultProfiles(...)// Implementation of ConfigurablePropertyResolver interfacesetIgnoreUnresolvableNestedPlaceholders(...)// Implementation of PropertyResolver interfacegetRequiredProperty(...)import SystemPropertyUtils/** Abstract base class for resolving properties against any underlying source. ... */SystemPropertyUtils.PLACEHOLDER_PREFIXSystemPropertyUtils.PLACEHOLDER_SUFFIXSystemPropertyUtils.VALUE_SEPARATORConfigurableConversionService conversionService, ...;PropertyPlaceholderHelper nonStrictHelper, ...;PropertyPlaceholderHelper strictHelper, ...;boolean ignoreUnresolvableNestedPlaceholders, ...;Set<String> requiredProperties, ...;ConfigurableConversionService cs/** Set the prefix that placeholders replaced by this resolver must begin with. ... *//** Set the suffix that placeholders replaced by this resolver must end with. ... *//** Specify the separating character between the placeholders replaced by this ... *//** Set whether to throw an exception when encountering an unresolvable placeholder ... */this.ignoreUnresolvableNestedPlaceholdersthis.requiredPropertiesMissingRequiredPropertiesException exnew MissingRequiredPropertiesException(...)addMissingRequiredProperty(...)getMissingRequiredProperties(...)this.nonStrictHelpercreatePlaceholderHelper(...)doResolvePlaceholders(...)this.strictHelper/** Resolve placeholders within the given string, deferring to the value of ... */new PlaceholderResolver(...) { ... }getPropertyAsRawString(...)/** Convert the given value to the specified target type, if necessary. ... */ConversionService conversionServiceToUse/** Retrieve the specified property as a raw String, ... */// Need to provide an independent DefaultConversionService, not the// shared DefaultConversionService used by PropertySourcesPropertyResolver.// Avoid initialization of shared DefaultConversionService if// no standard type conversion is needed in the first place.../** A simple representation of command line arguments, broken into "option arguments" and ... */Map<String,List<String>> optionArgs, ...;List<String> nonOptionArgs, ...;/** Add an option argument for the given option name and add the given value to the ... */this.optionArgs/** Return the set of all option arguments present on the command line. *//** Return whether the option with the given name was present on the command line. *//** Return the list of values associated with the given option. {@code null} signifies ... *//** Add the given value to the list of non-option arguments. */this.nonOptionArgs/** Return the list of non-option arguments specified on the command line. *//** Abstract base class for {@link PropertySource} implementations backed by command line ... */String COMMAND_LINE_PROPERTY_SOURCE_NAME, ...;/** The default name given to {@link CommandLinePropertySource} instances: {@value}. */String DEFAULT_NON_OPTION_ARGS_PROPERTY_NAME, ...;/** The default name of the property representing non-option arguments: {@value}. */String nonOptionArgsPropertyName, ...;/** Create a new {@code CommandLinePropertySource} having the default name ... *//** Create a new {@link CommandLinePropertySource} having the given name ... *//** Specify the name of the special "non-option arguments" property. ... */this.nonOptionArgsPropertyName/** This implementation first checks to see if the name specified is the special ... */getNonOptionArgs(...)containsOption(...)Collection<String> optionValuesgetOptionValues(...)Collection<String> nonOptionArguments/** Return whether the set of option arguments parsed from the command line contains ... *//** Return the collection of values associated with the command line option having the ... *//** Return the collection of non-option arguments parsed from the command line. ... *//** Composite {@link PropertySource} implementation that iterates over a set of ... */new LinkedHashSet<PropertySource<?>>(...)Set<PropertySource<?>> propertySources, ...;/** Create a new {@code CompositePropertySource}. ... */Object candidategetPropertyNames(...)/** Add the given {@link PropertySource} to the end of the chain. ... *//** Add the given {@link PropertySource} to the start of the chain. ... */List<PropertySource<?>> existingnew ArrayList<PropertySource<?>>(...)/** Return all property sources that this composite source holds. ... *//** Configuration interface to be implemented by most if not all {@link Environment} types. ... *//** Specify the set of profiles active for this {@code Environment}. Profiles are ... *//** Add a profile to the current set of active profiles. ... *//** Return the {@link PropertySources} for this {@code Environment} in mutable form, ... *//** Return the value of {@link System#getProperties()} if allowed by the current ... *//** Return the value of {@link System#getenv()} if allowed by the current ... *//** Append the given parent environment's active profiles, default profiles and ... *//** Configuration interface to be implemented by most if not all {@link PropertyResolver} ... *//** Return the {@link ConfigurableConversionService} used when performing type ... *//** Set the {@link ConfigurableConversionService} to be used when performing type ... *//** Set the prefix that placeholders replaced by this resolver must begin with. *//** Set the suffix that placeholders replaced by this resolver must end with. *//** Specify which properties must be present, to be verified by ... *//** Validate that each of the properties specified by ... *//** A {@link PropertySource} implementation capable of interrogating its ... *//** Create a new {@code EnumerablePropertySource} with the given name and source object. ... *//** Create a new {@code EnumerablePropertySource} with the given name and with a new ... *//** Return whether this {@code PropertySource} contains a property with the given name. ... *//** Return the names of all properties contained by the ... *//** Interface representing the environment in which the current application is running. ... *//** Return the set of profiles explicitly made active for this environment. Profiles ... *//** Return the set of profiles to be active by default when no active profiles have ... *//** Return whether one or more of the given profiles is active or, in the case of no ... *//** Return whether the {@linkplain #getActiveProfiles() active profiles} ... *//** Interface indicating a component that contains and exposes an {@link Environment} reference. ... *//** Return the {@link Environment} associated with this component. */import OptionSetimport OptionSpec/** {@link CommandLinePropertySource} implementation backed by a JOpt {@link OptionSet}. ... *//** Create a new {@code JOptCommandLinePropertySource} having the default name ... *//** Create a new {@code JOptCommandLinePropertySource} having the given name ... */OptionSpec<?> specspecs(...)String lastOptionoptions(...)List<?> argValuesvaluesOf(...)List<String> stringArgValuesnonOptionArguments(...)// Only the longest name is used for enumerating/** {@link PropertySource} that reads keys and values from a {@code Map} object. ... *//** Create a new {@code MapPropertySource} with the given name and {@code Map}. ... *//** Exception thrown when required properties are not found. ... */Set<String> missingRequiredProperties, ...;this.missingRequiredProperties/** Return the set of properties marked as required but not present ... *//** The default implementation of the {@link PropertySources} interface. ... */new CopyOnWriteArrayList<PropertySource<?>>(...)List<PropertySource<?>> propertySourceList, ...;/** Create a new {@link MutablePropertySources} object. *//** Create a new {@code MutablePropertySources} from the given propertySources ... */this.propertySourceList/** Add the given property source object with highest precedence. */removeIfPresent(...)/** Add the given property source object with lowest precedence. *//** Add the given property source object with precedence immediately higher ... */assertLegalRelativeAddition(...)assertPresentAndGetIndex(...)addAtIndex(...)/** Add the given property source object with precedence immediately lower ... *//** Return the precedence of the given property source, {@code -1} if not found. *//** Remove and return the property source with the given name, {@code null} if not found. ... *//** Replace the property source with the given name with the given property source object. ... *//** Return the number of {@link PropertySource} objects contained. *//** Ensure that the given property source is not being added relative to itself. */String newPropertySourceName/** Remove the given property source if it is present. *//** Add the given property source at a particular index in the list. *//** Assert that the named property source is present and return its index. ... *//** Profile predicate that may be {@linkplain Environment#acceptsProfiles(Profiles) ... *//** Test if this {@code Profiles} instance <em>matches</em> against the given ... *//** Create a new {@link Profiles} instance that checks for matches against ... *//** Internal parser used by {@link Profiles#of}. ... */Profiles[] parsednew Profiles[]expressions.lengthnew ParsedProfiles(...)StringTokenizer tokensparseTokens(...)Context.NONEList<Profiles> elementsnew ArrayList<Profiles>(...)Operator operatorhasMoreTokens(...)String tokenProfiles contentsContext.BRACKETProfiles mergedProfiles valueContext.INVERTassertWellFormed(...)Operator.ANDOperator.ORnot(...)Profiles[] profilesnew Profiles(...) { ... }allMatch(...)new Predicate<Profiles>(...) { ... }new Operator(...)Operator AND, ...;Operator OR, ...;Context NONE, ...;Context INVERT, ...;Context BRACKET, ...;Set<String> expressions, ...;...[] parsed, ...;this.expressionsthis.parsedProfiles candidateParsedProfiles thatthat.expressions/** {@link PropertySource} implementation that extracts properties from a ... *//** Interface for resolving properties against any underlying source. ... *//** Return whether the given property key is available for resolution, ... *//** Return the property value associated with the given key, ... *//** Return the property value associated with the given key, or ... *//** Return the property value associated with the given key (never {@code null}). ... *//** Return the property value associated with the given key, converted to the given ... *//** Resolve ${...} placeholders in the given text, replacing them with corresponding ... *//** Abstract base class representing a source of name/value property pairs. The underlying ... */T source, ...;/** Create a new {@code PropertySource} with the given name and source object. ... *//** Create a new {@code PropertySource} with the given name and with a new ... *//** Return the name of this {@code PropertySource}. *//** Return the underlying source object for this {@code PropertySource}. *//** Return whether this {@code PropertySource} contains the given name. ... *//** Return the value associated with the given name, ... *//** This {@code PropertySource} object is equal to the given object if: ... *//** Return a hash code derived from the {@code name} property ... *//** Produce concise output (type and name) if the current log level does not include ... *//** Return a {@code PropertySource} implementation intended for collection comparison purposes only. ... */new ComparisonPropertySource(...)/** {@code PropertySource} to be used as a placeholder in cases where an actual ... *//** A {@code PropertySource} implementation intended for collection comparison ... */String USAGE_ERROR, ...;/** Holder containing one or more {@link PropertySource} objects. ... *//** Return a sequential {@link Stream} containing the property sources. ... *//** Return whether a property source with the given name is contained. ... *//** Return the property source with the given name, {@code null} if not found. ... *//** {@link PropertyResolver} implementation that resolves property values against ... */PropertySources propertySources, ...;/** Create a new resolver against the given property sources. ... */resolveNestedPlaceholders(...)logKeyFound(...)convertValueIfNecessary(...)/** Log the given key as found in the given {@link PropertySource}, resulting in ... *//** Read-only {@code Map<String, String>} implementation that is backed by system ... *//** Returns the value to which the specified key is mapped, or {@code null} if this map ... */getSystemAttribute(...)/** Template method that returns the underlying system attribute. ... */// Unsupported/** Parses a {@code String[]} of command line arguments in order to populate a ... *//** Parse the given {@code String} array based on the rules described {@linkplain ... */CommandLineArgs commandLineArgsnew CommandLineArgs(...)String optionTextString optionNameString optionValueint indexOfEqualsSignaddOptionArg(...)addNonOptionArg(...)/** {@link CommandLinePropertySource} implementation backed by a simple String array. ... *//** Create a new {@code SimpleCommandLinePropertySource} having the default name ... */new SimpleCommandLineArgsParser(...)/** Create a new {@code SimpleCommandLinePropertySource} having the given name ... *//** Get the property names for the option arguments. */getOptionNames(...)/** {@link Environment} implementation suitable for use in 'standard' (i.e. non-web) ... */String SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAME, ...;/** System environment property source name: {@value}. */String SYSTEM_PROPERTIES_PROPERTY_SOURCE_NAME, ...;/** JVM system properties property source name: {@value}. *//** Customize the set of property sources with those appropriate for any standard ... */new SystemEnvironmentPropertySource(...)/** Specialization of {@link MapPropertySource} designed for use with ... *//** Create a new {@code SystemEnvironmentPropertySource} with the given name and ... *//** Return {@code true} if a property with the given name or any underscore/uppercase variant ... *//** This implementation returns {@code true} if a property with the given name or ... */resolvePropertyName(...)/** Check to see if this property source contains a property with the given name, or ... */checkPropertyName(...)String uppercasedNameString noDotNameString noHyphenNameString noDotNoHyphenNameisSecurityManagerPresent(...)// Check name as-is// Check name with just dots replaced// Check name with just hyphens replaced// Check name with dots and hyphens replaced// Give up/** Spring's environment abstraction consisting of bean definition ... */import HttpURLConnectionimport FileChannelimport ReadableByteChannelimport NoSuchFileExceptionimport StandardOpenOption/** Abstract base class for resources which resolve URLs into File references, ... */isFileURL(...)URLConnection conHttpURLConnection httpConcustomizeConnection(...)getResponseCode(...)HttpURLConnection.HTTP_OKHttpURLConnection.HTTP_NOT_FOUNDgetContentLengthLong(...)disconnect(...)canRead(...)isDirectory(...)long contentLengthResourceUtils.URL_PROTOCOL_VFSResourceUtils.URL_PROTOCOL_FILE/** This implementation returns a File reference for the underlying class path ... *//** This implementation determines the underlying File ... */isJarURL(...)URL actualUrlextractArchiveURL(...)/** This implementation returns a File reference for the given URI-identified ... *//** This implementation returns a FileChannel for the given URI-identified ... */open(...)StandardOpenOption.READreadableChannel(...)boolean fileCheckgetLastModified(...)File fileToCheckgetFileForLastModifiedCheck(...)/** Customize the given {@link URLConnection}, obtained in the course of an ... */useCachesIfNecessary(...)/** Customize the given {@link HttpURLConnection}, obtained in the course of an ... */setRequestMethod(...)/** Inner delegate class, avoiding a hard JBoss VFS API dependency at runtime. */new VfsResource(...)// Proceed with file system resolution// Try a URL connection content-length header// No HTTP OK status, and no content-length header: give up// Fall back to stream existence: can we open the stream?// Try InputStream resolution for jar resources// Empty file or directory -> not considered readable...// Try file system channel// Fall back to InputStream adaptation in superclass// Defensively fall back to URL connection check instead// Try a URL connection last-modified headerimport Channels/** Convenience base class for {@link Resource} implementations, ... *//** This implementation checks whether a File can be opened, ... *//** This implementation always returns {@code true} for a resource ... *//** This implementation always returns {@code false}. *//** This implementation throws a FileNotFoundException, assuming ... *//** This implementation builds a URI based on the URL returned ... *//** This implementation returns {@link Channels#newChannel(InputStream)} ... */newChannel(...)/** This method reads the entire InputStream to determine the content length. ... */long sizebyte[] bufint read/** This implementation checks the timestamp of the underlying File, ... *//** Determine the File to use for timestamp checking. ... *//** This implementation always returns {@code null}, ... *//** This implementation compares description strings. ... *//** This implementation returns the description's hash code. ... *//** This implementation returns the description of this resource. ... */// Try file existence: can we find the file in the file system?/** {@link Resource} implementation for a given byte array. ... *//** Create a new {@code ByteArrayResource}. ... *//** Create a new {@code ByteArrayResource} with a description. ... *//** Return the underlying byte array. *//** This implementation always returns {@code true}. *//** This implementation returns the length of the underlying byte array. */this.byteArray.length/** This implementation returns a ByteArrayInputStream for the ... *//** This implementation returns a description that includes the passed-in ... *//** This implementation compares the underlying byte array. ... */(...).byteArray/** This implementation returns the hash code based on the ... *//** {@link Resource} implementation for class path resources. Uses either a ... */String path, ...;/** Create a new {@code ClassPathResource} for {@code ClassLoader} usage. ... */String pathToUsethis.path/** Create a new {@code ClassPathResource} for {@code Class} usage. ... *//** Create a new {@code ClassPathResource} with optional {@code ClassLoader} ... *//** Return the path for this resource (as resource path within the class path). *//** Return the ClassLoader that this resource will be obtained from. *//** This implementation checks for the resolution of a resource URL. ... */resolveURL(...)/** Resolves a URL for the underlying class path resource. ... *//** This implementation opens an InputStream for the given class path resource. ... *//** This implementation returns a URL for the underlying class path resource, ... *//** This implementation creates a ClassPathResource, applying the given path ... *//** This implementation returns the name of the file that this class path ... *//** This implementation returns a description that includes the class path location. *//** This implementation compares the underlying class path locations. */ClassPathResource otherResotherRes.pathotherRes.classLoaderotherRes.clazz/** This implementation returns the hash code of the underlying ... *//** {@link ResourceLoader} implementation that interprets plain resource paths ... *//** Create a new ClassRelativeResourceLoader for the given class. ... */new ClassRelativeContextResource(...)/** ClassPathResource that explicitly expresses a context-relative path ... *//** Extended interface for a resource that is loaded from an enclosing ... *//** Return the path within the enclosing 'context'. ... *//** Default implementation of the {@link ResourceLoader} interface. ... */new LinkedHashSet<ProtocolResolver>(...)new ConcurrentHashMap<Class<?>,Map<Resource,?>>(...)Set<ProtocolResolver> protocolResolvers, ...;Map<Class<?>,Map<Resource,?>> resourceCaches, ...;/** Create a new DefaultResourceLoader. ... *//** Specify the ClassLoader to load class path resources with, or {@code null} ... *//** Return the ClassLoader to load class path resources with. ... *//** Register the given resolver with this resource loader, allowing for ... */this.protocolResolvers/** Return the collection of currently registered protocol resolvers, ... *//** Obtain a cache for the given value type, keyed by {@link Resource}. ... */this.resourceCachesnew Function<Class<?>,Map<Resource,?>>(...) { ... }new ConcurrentHashMap<Resource,Object>(...)/** Clear all resource caches in this resource loader. ... */ProtocolResolver protocolResolvergetProtocolResolvers(...)getResourceByPath(...)new FileUrlResource(...)/** Return a Resource handle for the resource at the given path. ... */new ClassPathContextResource(...)// Try to parse the location as a URL...// No URL -> resolve as resource path./** Simple {@link Resource} implementation that holds a resource description ... *//** Create a new DescriptiveResource. ... *//** This implementation compares the underlying description String. */(...).description/** This implementation returns the hash code of the underlying description String. */import WritableByteChannelimport FileSystemimport Files/** {@link Resource} implementation for {@code java.io.File} and ... */Path filePath, ...;/** Create a new {@code FileSystemResource} from a file path. ... */this.filethis.filePath/** Create a new {@code FileSystemResource} from a {@link File} handle. ... *//** Create a new {@code FileSystemResource} from a {@link Path} handle, ... *//** Create a new {@code FileSystemResource} from a {@link FileSystem} handle, ... *//** Return the file path for this resource. *//** This implementation returns whether the underlying file exists. ... *//** This implementation checks whether the underlying file is marked as readable ... *//** This implementation opens a NIO file stream for the underlying file. ... */newInputStream(...)NoSuchFileException ex/** This implementation checks whether the underlying file is marked as writable ... */canWrite(...)/** This implementation opens a FileOutputStream for the underlying file. ... */newOutputStream(...)/** This implementation returns a URL for the underlying file. ... */toUri(...)/** This implementation returns a URI for the underlying file. ... *//** This implementation always indicates a file. *//** This implementation returns the underlying File reference. *//** This implementation opens a FileChannel for the underlying file. ... */StandardOpenOption.WRITE/** This implementation returns the underlying File/Path length. *//** This implementation returns the underlying File/Path last-modified time. */getLastModifiedTime(...)/** This implementation creates a FileSystemResource, applying the given path ... */getFileSystem(...)/** This implementation returns the name of the file. ... *//** This implementation returns a description that includes the absolute ... */toAbsolutePath(...)/** This implementation compares the underlying File references. */(...).path/** This implementation returns the hash code of the underlying File reference. *//** {@link ResourceLoader} implementation that resolves plain paths as ... */new FileSystemContextResource(...)/** FileSystemResource that explicitly expresses a context-relative path ... *//** Subclass of {@link UrlResource} which assumes file resolution, to the degree ... *//** Create a new {@code FileUrlResource} based on the given URL object. ... *//** Create a new {@code FileUrlResource} based on the given file location, ... */createRelativeURL(...)/** {@link Resource} implementation for a given {@link InputStream}. ... */boolean read, ...;/** Create a new InputStreamResource. ... *//** This implementation throws IllegalStateException if attempting to ... */this.read/** This implementation compares the underlying InputStream. */(...).inputStream/** This implementation returns the hash code of the underlying InputStream. *//** Simple interface for objects that are sources for an {@link InputStream}. ... *//** Return an {@link InputStream} for the content of an underlying resource. ... */import OpenOption/** {@link Resource} implementation for {@link java.nio.file.Path} handles, ... */Path path, ...;/** Create a new PathResource from a Path handle. ... *//** This implementation opens a InputStream for the underlying file. ... *//** This implementation opens a OutputStream for the underlying file. ... *//** This implementation opens a Channel for the underlying file. ... */newByteChannel(...)/** This implementation returns the underlying file's length. *//** This implementation returns the underlying File's timestamp. ... *//** This implementation creates a PathResource, applying the given path ... */new PathResource(...)/** This implementation compares the underlying Path references. *//** This implementation returns the hash code of the underlying Path reference. */// Only paths on the default file system can be converted to a File:// Do exception translation for cases where conversion is not possible.// We can not use the superclass method since it uses conversion to a File and// only a Path on the default file system can be converted to a File.../** A resolution strategy for protocol-specific resource handles. ... *//** Resolve the given location against the given resource loader ... *//** Interface for a resource descriptor that abstracts from the actual ... *//** Determine whether this resource actually exists in physical form. ... *//** Indicate whether non-empty contents of this resource can be read via ... *//** Indicate whether this resource represents a handle with an open stream. ... *//** Determine whether this resource represents a file in a file system. ... *//** Return a URL handle for this resource. ... *//** Return a URI handle for this resource. ... *//** Return a File handle for this resource. ... *//** Return a {@link ReadableByteChannel}. ... *//** Determine the content length for this resource. ... *//** Determine the last-modified timestamp for this resource. ... *//** Create a resource relative to this resource. ... *//** Determine a filename for this resource, i.e. typically the last ... *//** Return a description for this resource, ... *//** {@link java.beans.PropertyEditor Editor} for {@link Resource} ... *//** Create a new instance of the {@link ResourceEditor} class ... */String locationToUseResource value// Try to determine URL for resource.// Couldn't determine resource URL - return null to indicate// that there is no appropriate text representation./** Strategy interface for loading resources (e.g., class path or file system ... */String CLASSPATH_URL_PREFIX, ...;/** Pseudo URL prefix for loading from the class path: "classpath:". *//** Return a {@code Resource} handle for the specified resource location. ... *//** Expose the {@link ClassLoader} used by this {@code ResourceLoader}. ... *//** {@link Resource} implementation for {@code java.net.URL} locators. ... *//** Original URI, if available; used for URI and File access. *//** Original URL, used for actual access. */URL cleanedUrl, ...;/** Cleaned URL (with normalized path), used for comparisons. *//** Create a new {@code UrlResource} based on the given URI object. ... */this.urithis.url/** Create a new {@code UrlResource} based on the given URL object. ... *//** Create a new {@code UrlResource} based on a URL path. ... */this.cleanedUrlgetCleanedUrl(...)/** Create a new {@code UrlResource} based on a URI specification. ... */MalformedURLException exToThrow/** Determine a cleaned URL for the given original URL. ... */String cleanedPath/** Lazily determine a cleaned URL for the given original URL. ... */URL cleanedUrl/** This implementation opens an InputStream for the given URL. ... *//** This implementation returns the underlying URL reference. *//** This implementation returns the underlying URI directly, ... *//** This implementation returns a File reference for the underlying URL/URI, ... *//** This implementation creates a {@code UrlResource}, delegating to ... *//** This delegate creates a {@code java.net.URL}, applying the given path ... *//** This implementation returns the name of the file that this URL refers to. ... *//** This implementation returns a description that includes the URL. *//** This implementation compares the underlying URL references. *//** This implementation returns the hash code of the underlying URL reference. */// Cleaned URL path cannot be converted to URL -> take original URL.// Close the HTTP connection (if applicable).// # can appear in filenames, java.net.URL should not treat it as a fragment// Use the URL constructor for applying the relative path as a URL spec/** JBoss VFS based {@link Resource} implementation. ... */Object resource, ...;/** Create a new {@code VfsResource} wrapping the given resource handle. ... */getRelative(...)(...).resource// fall back to getRelative/** Utility for detecting and accessing JBoss VFS in the classpath. ... */VfsUtils.classClass<?> vfsClassClass<?> virtualFileClass<?> visitorAttributesClassString VFS3_PKG, ...;String VFS_NAME, ...;Method VFS_METHOD_GET_ROOT_URL, ...;Method VFS_METHOD_GET_ROOT_URI, ...;Method VIRTUAL_FILE_METHOD_EXISTS, ...;Method VIRTUAL_FILE_METHOD_GET_INPUT_STREAM, ...;Method VIRTUAL_FILE_METHOD_GET_SIZE, ...;Method VIRTUAL_FILE_METHOD_GET_LAST_MODIFIED, ...;Method VIRTUAL_FILE_METHOD_TO_URL, ...;Method VIRTUAL_FILE_METHOD_TO_URI, ...;Method VIRTUAL_FILE_METHOD_GET_NAME, ...;Method VIRTUAL_FILE_METHOD_GET_PATH_NAME, ...;Method VIRTUAL_FILE_METHOD_GET_PHYSICAL_FILE, ...;Method VIRTUAL_FILE_METHOD_GET_CHILD, ...;Class<?> VIRTUAL_FILE_VISITOR_INTERFACE, ...;Method VIRTUAL_FILE_METHOD_VISIT, ...;Field VISITOR_ATTRIBUTES_FIELD_RECURSE, ...;handleInvocationTargetException(...)handleReflectionException(...)invokeVfsMethod(...)// protected methods used by the support sub-package/** Extended interface for a resource that supports writing to it. ... *//** Indicate whether the contents of this resource can be written ... *//** Return an {@link OutputStream} for the underlying resource, ... *//** Return a {@link WritableByteChannel}. ... */getOutputStream(...)import CharsetEncoderimport CoderResultimport CodingErrorActionimport IntPredicate/** Basic abstraction over byte buffers. ... *//** Return the {@link DataBufferFactory} that created this buffer. ... *//** Return the index of the first byte in this buffer that matches ... *//** Return the index of the last byte in this buffer that matches ... *//** Return the number of bytes that can be read from this data buffer. ... *//** Return the number of bytes that can be written to this data buffer. ... *//** Return the number of bytes that this buffer can contain. ... *//** Set the number of bytes that this buffer can contain. ... *//** Ensure that the current buffer has enough {@link #writableByteCount()} ... *//** Return the position from which this buffer will read. ... *//** Set the position from which this buffer will read. ... *//** Return the position to which this buffer will write. ... *//** Set the position to which this buffer will write. ... *//** Read a single byte at the given index from this data buffer. ... *//** Read a single byte from the current reading position from this data buffer. ... *//** Read this buffer's data into the specified destination, starting at the current ... *//** Read at most {@code length} bytes of this buffer into the specified destination, ... *//** Write a single byte into this buffer at the current writing position. ... *//** Write the given source into this buffer, starting at the current writing position ... *//** Write at most {@code length} bytes of the given source into this buffer, starting ... *//** Write one or more {@code DataBuffer}s to this buffer, starting at the current ... *//** Write one or more {@link ByteBuffer} to this buffer, starting at the current ... *//** Write the given {@code CharSequence} using the given {@code Charset}, ... */CharsetEncoder charsetEncoderonUnmappableCharacter(...)onMalformedInput(...)CodingErrorAction.REPLACECharBuffer inBufferint estimatedSizeaverageBytesPerChar(...)ByteBuffer outBufferensureCapacity(...)writableByteCount(...)CoderResult crhasRemaining(...)CoderResult.UNDERFLOWisUnderflow(...)isOverflow(...)int maximumSizeposition(...)/** Create a new {@code DataBuffer} whose contents is a shared subsequence of this ... *//** Create a new {@code DataBuffer} whose contents is a shared, retained subsequence of this ... */slice(...)/** Expose this buffer's bytes as a {@link ByteBuffer}. Data between this ... *//** Expose a subsequence of this buffer's bytes as a {@link ByteBuffer}. Data between ... *//** Expose this buffer's data as an {@link InputStream}. Both data and read position are ... *//** Expose this buffer's data as an {@link OutputStream}. Both data and write position are ... *//** Return this buffer's data a String using the specified charset. Default implementation ... *//** Return a part of this buffer's data as a String using the specified charset. ... *//** A factory for {@link DataBuffer DataBuffers}, allowing for allocation and ... *//** Allocate a data buffer of a default initial capacity. Depending on the ... *//** Allocate a data buffer of the given initial capacity. Depending on the ... *//** Wrap the given {@link ByteBuffer} in a {@code DataBuffer}. Unlike ... *//** Wrap the given {@code byte} array in a {@code DataBuffer}. Unlike ... *//** Return a new {@code DataBuffer} composed of the {@code dataBuffers} elements joined together. ... *//** Exception that indicates the cumulative number of bytes consumed from a ... */import AsynchronousFileChannelimport Channelimport CompletionHandlerimport BaseSubscriberimport FluxSinkimport SynchronousSink/** Utility class for working with {@link DataBuffer DataBuffers}. ... */DataBufferUtils.classConsumer<DataBuffer> RELEASE_CONSUMER, ...;/** Obtain a {@link InputStream} from the given supplier, and read it into a ... */// ReadingreadByteChannel(...)new Callable<ReadableByteChannel>(...) { ... }/** Obtain a {@link ReadableByteChannel} from the given supplier, and read ... */using(...)new Function<ReadableByteChannel,Publisher<? extends DataBuffer>>(...) { ... }new ReadableByteChannelGenerator(...)new Consumer<ReadableByteChannel>(...) { ... }closeChannel(...)/** Obtain a {@code AsynchronousFileChannel} from the given supplier, and read ... */readAsynchronousFileChannel(...)/** Obtain a {@code AsynchronousFileChannel} from the given supplier, and ... */new Function<AsynchronousFileChannel,Publisher<? extends DataBuffer>>(...) { ... }new Consumer<FluxSink<DataBuffer>>(...) { ... }ReadCompletionHandler handlernew ReadCompletionHandler(...)onCancel(...)new Disposable(...) { ... }onRequest(...)new LongConsumer(...) { ... }new Consumer<AsynchronousFileChannel>(...) { ... }/** Read bytes from the given file {@code Path} into a {@code Flux} of {@code DataBuffer}s. ... */options.lengthOpenOption optionStandardOpenOption.APPENDnew Callable<AsynchronousFileChannel>(...) { ... }/** Read the given {@code Resource} into a {@code Flux} of {@code DataBuffer}s. ... *//** Read the given {@code Resource} into a {@code Flux} of {@code DataBuffer}s ... */Flux<DataBuffer> resultIOException ignoreskipUntilByteCount(...)/** Write the given stream of {@link DataBuffer DataBuffers} to the given ... */// WritingWritableByteChannel channelWritableByteChannelSubscriber subscribernew WritableByteChannelSubscriber(...)onDispose(...)WriteCompletionHandler handlernew WriteCompletionHandler(...)Set<OpenOption> optionSetcheckWriteOptions(...)new Consumer<MonoSink<Void>>(...) { ... }AsynchronousFileChannel channelsuccess(...)Set<OpenOption> resultnew HashSet<OpenOption>(...)StandardOpenOption.CREATEStandardOpenOption.TRUNCATE_EXISTINGOpenOption opt/** Relay buffers from the given {@link Publisher} until the total ... */// Variousnew Supplier<Publisher<DataBuffer>>(...) { ... }AtomicLong countDowntakeUntil(...)new Function<? extends DataBuffer,DataBuffer>(...) { ... }long remainderaddAndGet(...)new Predicate<DataBuffer>(...) { ... }/** Skip buffers from the given {@link Publisher} until the total ... */skipUntil(...)new Predicate<? extends DataBuffer>(...) { ... }/** Retain the given data buffer, if it is a {@link PooledDataBuffer}. ... *//** Associate the given hint with the data buffer if it is a pooled buffer ... *//** Release the given data buffer, if it is a {@link PooledDataBuffer} and ... */PooledDataBuffer pooledDataBufferisAllocated(...)/** Return a consumer that calls {@link #release(DataBuffer)} on all ... *//** Return a new {@code DataBuffer} composed from joining together the given ... *//** Variant of {@link #join(Publisher)} that behaves the same way up until ... */new Supplier<LimitedDataBufferList>(...) { ... }new BiConsumer<LimitedDataBufferList,? extends DataBuffer>(...) { ... }new Predicate<LimitedDataBufferList>(...) { ... }new Function<LimitedDataBufferList,DataBuffer>(...) { ... }/** Return a {@link Matcher} for the given delimiter. ... */createMatcher(...)/** Return a {@link Matcher} for the given delimiters. ... */delimiters.lengthnew CompositeMatcher(...)delimiter.lengthSingleByteMatcher.NEWLINE_MATCHERnew SingleByteMatcher(...)new TwoByteMatcher(...)new KnuthMorrisPrattMatcher(...)/** Contract to find delimiter(s) against one or more data buffers that can ... *//** Find the first matching delimiter and return the index of the last ... *//** Return the delimiter from the last invocation of {@link #match(DataBuffer)}. *//** Reset the state of this matcher. *//** Matcher that supports searching for multiple delimiters. */...[] NO_DELIMITER, ...;...[] matchers, ...;...[] longestDelimiter, ...;this.matchersinitMatchers(...)NestedMatcher[] matchersnew NestedMatcher[]this.longestDelimiterbyte bgetByte(...)NestedMatcher matcherthis.longestDelimiter.length/** Matcher that can be nested within {@link CompositeMatcher} where multiple ... *//** Perform a match against the next byte of the stream and return true ... *//** Matcher for a single byte delimiter. */SingleByteMatcher NEWLINE_MATCHER, ...;...[] delimiter, ...;this.delimiter/** Base class for a {@link NestedMatcher}. */int matches, ...;/** Matcher with a 2 byte delimiter that does not benefit from a ... *//** Implementation of {@link Matcher} that uses the Knuth-Morris-Pratt algorithm. ... */...[] table, ...;this.tablelongestSuffixPrefixTable(...)getMatches(...)setMatches(...)ReadableByteChannel channel, ...;DataBufferFactory dataBufferFactory, ...;this.channelthis.dataBufferFactorycapacity(...)new AtomicReference<State>(...)State.IDLEAsynchronousFileChannel channel, ...;FluxSink<DataBuffer> sink, ...;AtomicLong position, ...;AtomicReference<State> state, ...;this.sinkthis.position/** Invoked when Reactive Streams consumer signals demand. */tryRead(...)/** Invoked when Reactive Streams consumer cancels. */State.DISPOSEDrequestedFromDownstream(...)State.READINGnew State(...)State IDLE, ...;State READING, ...;State DISPOSED, ...;WritableByteChannel channel, ...;new AtomicReference<Throwable>(...)new AtomicReference<DataBuffer>(...)AtomicBoolean completed, ...;AtomicReference<Throwable> error, ...;AtomicReference<DataBuffer> dataBuffer, ...;this.dataBufferthis.errorthis.completedlong possinkDataBuffer(...)// No doOnDiscard as operators used do not cache// Do not close channel from here, rather wait for the current read callback// and then complete after releasing the DataBuffer.// fallback to resource.readableChannel(), below// No doOnDiscard as operators used do not cache (and drop) buffers// Avoid dependency on Netty: IllegalReferenceCountException// According java.nio.channels.AsynchronousChannel "if an I/O operation is outstanding// on the channel and the channel's close method is invoked, then the I/O operation// fails with the exception AsynchronousCloseException". That should invoke the failed// callback below and the current DataBuffer should be released.// Stay in READING mode if there is demand// Release READING mode and then try again in case of concurrent "request"/** Provides a convenient implementation of the {@link DataBuffer} interface ... */DataBuffer delegate, ...;/** Create a new {@code DataBufferWrapper} that wraps the given buffer. ... *//** Return the wrapped delegate. */asInputStream(...)asOutputStream(...)/** Default implementation of the {@link DataBuffer} interface that uses a ... */int MAX_CAPACITY, ...;int CAPACITY_THRESHOLD, ...;DefaultDataBufferFactory dataBufferFactory, ...;ByteBuffer byteBuffer, ...;int capacity, ...;int readPosition, ...;int writePosition, ...;ByteBuffer slicethis.byteBufferthis.capacityDefaultDataBuffer dataBuffernew DefaultDataBuffer(...)/** Directly exposes the native {@code ByteBuffer} that this buffer is based ... */this.readPositionthis.writePositionassertIndex(...)int readPositionint writePositionint oldCapacityByteBuffer oldBufferByteBuffer newBufferisDirect(...)setNativeBuffer(...)allocateDirect(...)destination.lengthByteBuffer tmpint limitnew Function<DataBuffer,ByteBuffer>(...) { ... }new IntFunction<ByteBuffer[]>(...) { ... }new ByteBuffer[]new ToIntFunction<ByteBuffer>(...) { ... }new Consumer<ByteBuffer>(...) { ... }int oldPositionBuffer buffercheckIndex(...)new SlicedDefaultDataBuffer(...)ByteBuffer duplicatenew DefaultDataBufferInputStream(...)new DefaultDataBufferOutputStream(...)hasArray(...)array(...)arrayOffset(...)/** Calculate the capacity of the buffer. ... */...<<=...DefaultDataBuffer otherBufferotherBuffer.readPositionotherBuffer.writePositionotherBuffer.byteBuffernew IndexOutOfBoundsException(...)DefaultDataBuffer.thisint available// Explicit access via Buffer base type for compatibility// with covariant return type on JDK 9's ByteBuffer...// Explicit cast for compatibility with covariant return type on JDK 9's ByteBuffer/** Default implementation of the {@code DataBufferFactory} interface. Allows for ... */new DefaultDataBufferFactory(...)int DEFAULT_INITIAL_CAPACITY, ...;/** The default capacity when none is specified. ... */DefaultDataBufferFactory sharedInstance, ...;/** Shared instance based on the default constructor. ... */boolean preferDirect, ...;int defaultInitialCapacity, ...;/** Creates a new {@code DefaultDataBufferFactory} with default settings. ... *//** Creates a new {@code DefaultDataBufferFactory}, indicating whether direct ... */this.preferDirectthis.defaultInitialCapacityfromEmptyByteBuffer(...)fromFilledByteBuffer(...)/** {@inheritDoc} ... */new ToIntFunction<? extends DataBuffer>(...) { ... }DefaultDataBuffer resultnew Consumer<? extends DataBuffer>(...) { ... }/** Custom {@link List} to collect data buffers with and enforce a ... */int maxByteCount, ...;int byteCount, ...;this.maxByteCountupdateCount(...)this.byteCountraiseLimitException(...)new DataBufferLimitException(...)/** Shortcut to {@link DataBufferUtils#release release} all data buffers and ... */// Do not release here, it's likely down via doOnDiscard..// Keep going..import ByteBufInputStreamimport ByteBufOutputStreamimport ByteBufUtil/** Implementation of the {@code DataBuffer} interface that wraps a Netty ... */ByteBuf byteBuf, ...;NettyDataBufferFactory dataBufferFactory, ...;/** Create a new {@code NettyDataBuffer} based on the given {@code ByteBuff}. ... */this.byteBuf/** Directly exposes the native {@code ByteBuf} that this buffer is based on. ... */writerIndex(...)forEachByte(...)new ByteProcessor(...) { ... }negate(...)forEachByteDesc(...)writableBytes(...)readerIndex(...)ensureWritable(...)writeByte(...)writeBytes(...)hasNettyDataBuffers(...)ByteBuf[] nativeBuffersnew ByteBuf[]buffers.lengthByteBuffer[] byteBuffersDataBuffer buffer/** Writes one or more Netty {@link ByteBuf ByteBufs} to this buffer, ... */writeUtf8(...)writeAscii(...)PooledDataBuffer.superByteBuf slicenew NettyDataBuffer(...)nioBuffer(...)new ByteBufInputStream(...)new ByteBufOutputStream(...)refCnt(...)(...).byteBufimport ByteBufAllocatorimport CompositeByteBuf/** Implementation of the {@code DataBufferFactory} interface based on a ... */ByteBufAllocator byteBufAllocator, ...;/** Create a new {@code NettyDataBufferFactory} based on the given factory. ... */this.byteBufAllocator/** Return the {@code ByteBufAllocator} used by this factory. */buffer(...)/** Wrap the given Netty {@link ByteBuf} in a {@code NettyDataBuffer}. ... */int bufferCountCompositeByteBuf compositecompositeBuffer(...)NettyDataBuffer.class/** Return the given Netty {@link DataBuffer} as a {@link ByteBuf}. ... *//** Extension of {@link DataBuffer} that allows for buffer that share ... *//** Return {@code true} if this buffer is allocated; ... *//** Increase the reference count for this buffer by one. ... *//** Associate the given hint with the data buffer for debugging purposes. ... *//** Decrease the reference count for this buffer by one, ... *//** Generic abstraction for working with byte buffer implementations. *//** Generic abstraction for (file-based) resources, used throughout the framework. *//** The default implementation for {@link PropertySourceFactory}, ... */new ResourcePropertySource(...)/** Holder that combines a {@link Resource} descriptor with a specific encoding ... */Charset charset, ...;/** Create a new {@code EncodedResource} for the given {@code Resource}, ... */this.charset/** Return the {@code Resource} held by this {@code EncodedResource}. *//** Return the encoding to use for reading from the {@linkplain #getResource() resource}, ... *//** Return the {@code Charset} to use for reading from the {@linkplain #getResource() resource}, ... *//** Determine whether a {@link Reader} is required as opposed to an {@link InputStream}, ... *//** Open a {@code java.io.Reader} for the specified resource, using the specified ... *//** Open an {@code InputStream} for the specified resource, ignoring any specified ... */EncodedResource otherResourceotherResource.resourceotherResource.charsetotherResource.encoding/** Helper class for loading a localized resource, ... *//** The default separator to use in-between file name parts: an underscore. *//** Create a new LocalizedResourceHelper with a DefaultResourceLoader. ... *//** Create a new LocalizedResourceHelper with the given ResourceLoader. ... *//** Set the separator to use in-between file name parts. ... *//** Find the most specific localized resource for the given name, ... */String lang// Check for file with language, country and variant localization.// Check for file with language and country localization.// Check for document with language localization.// Check for document without localization.import JarURLConnectionimport URLClassLoaderimport JarEntryimport JarFileimport ZipExceptionimport VfsResourceimport PathMatcher/** A {@link ResourcePatternResolver} implementation that is able to resolve a ... */Class<?> fileLocatorClassMethod equinoxResolveMethod, ...;PathMatcher pathMatcher, ...;/** Create a new PathMatchingResourcePatternResolver with a DefaultResourceLoader. ... *//** Create a new PathMatchingResourcePatternResolver. ... *//** Return the ResourceLoader that this pattern resolver works with. *//** Set the PathMatcher implementation to use for this ... */this.pathMatcher/** Return the PathMatcher that this resource pattern resolver uses. */getPathMatcher(...)findPathMatchingResources(...)findAllClassPathResources(...)int prefixEnd/** Find all class location resources with the given location via the ClassLoader. ... */Set<Resource> resultdoFindAllClassPathResources(...)/** Find all class location resources with the given path via the ClassLoader. ... */Enumeration<URL> resourceUrlsgetSystemResources(...)convertClassLoaderURL(...)addAllClassLoaderJarRoots(...)/** Convert the given URL as returned from the ClassLoader into a {@link Resource}. ... *//** Search all {@link URLClassLoader} URLs for jar file references and add them to the ... */getURLs(...)UrlResource jarResourceResourceUtils.URL_PROTOCOL_JARResourceUtils.JAR_URL_SEPARATORResourceUtils.JAR_URL_PREFIXaddClassPathManifestEntries(...)/** Determine jar file references from the "java.class.path." manifest property and add them ... */String javaClassPathPropertyString filePathint prefixIndexResourceUtils.FILE_URL_PREFIXhasDuplicate(...)/** Check whether the given file path has a duplicate but differently structured entry ... */String duplicatePath/** Find all resources that match the given location pattern via the ... */String rootDirPathdetermineRootDir(...)String subPatternResource[] rootDirResourcesResource rootDirResourceURL rootDirUrlresolveRootDirResource(...)URL resolvedUrlfindMatchingResources(...)isJarResource(...)doFindPathMatchingJarResources(...)doFindPathMatchingFileResources(...)/** Determine the root directory for the given location. ... */int rootDirEnd/** Resolve the specified resource for path matching. ... *//** Return whether the given resource handle indicates a jar resource ... *//** Find all resources in jar files that match the given location pattern ... */JarFile jarFileString jarFileUrlString rootEntryPathboolean closeJarFileJarURLConnection jarConJarEntry jarEntrygetJarEntry(...)getJarFile(...)getJarFileURL(...)getUseCaches(...)String urlFileResourceUtils.WAR_URL_SEPARATORnew JarFile(...)ZipException exEnumeration<JarEntry> entriesentries(...)JarEntry entryString entryPathString relativePath/** Resolve the given jar file URL into a JarFile object. */getSchemeSpecificPart(...)/** Find all resources in the file system that match the given location pattern ... */File rootDirgetAbsoluteFile(...)doFindMatchingFileSystemResources(...)Set<File> matchingFilesretrieveMatchingFiles(...)/** Retrieve files that match the given path pattern, ... */String fullPatternSet<File> resultnew LinkedHashSet<File>(...)doRetrieveMatchingFiles(...)/** Recursively retrieve files that match the given pattern, ... */File contentlistDirectory(...)String currPathmatchStart(...)/** Determine a sorted list of files in the given directory. ... */listFiles(...)new Function<File,String>(...) { ... }Object rootfindRoot(...)PatternVirtualFileVisitor visitornew PatternVirtualFileVisitor(...)/** VFS visitor for path matching purposes. */String subPattern, ...;String rootPath, ...;Set<Resource> resources, ...;this.subPatternthis.rootPathgetVisitorAttributes(...)// Detect Equinox OSGi (e.g. on WebSphere 6.1)// a class path resource (multiple resources for same name possible)// a class path resource pattern// all class path resources with the given name// Generally only look for a pattern after a prefix here,// and on Tomcat only after the "*/" separator for its "war:" protocol.// a file pattern// a single resource with the given name// The above result is likely to be incomplete, i.e. only containing file system references.// We need to have pointers to each of the jar files on the classpath as well...// "java.class.path" manifest evaluation...// Hierarchy traversal...// Possibly "c:" drive prefix on Windows, to be upper-cased for proper duplicate detection// # can appear in directories/filenames, java.net.URL should not treat it as a fragment// Build URL that points to the root of the jar file// Potentially overlapping with URLClassLoader.getURLs() result above!// Ignore: just for testing against duplicate.// Should usually be the case for traditional JAR files.// No JarURLConnection -> need to resort to URL file parsing.// We'll assume URLs of the format "jar:path!/entry", with the protocol// being arbitrary as long as following the entry format.// We'll also handle paths with and without leading "file:" prefix.// both separators are 2 chars// Root entry path must end with slash to allow for proper matching.// The Sun JRE does not return a slash here, but BEA JRockit does.// Fallback for URLs that are not valid URIs (should hardly ever happen).// Silently skip non-existing directories.// Complain louder if it exists but is no directory./** Base class for JavaBean-style components that need to load properties ... */...[] localProperties, ...;boolean localOverride, ...;...[] locations, ...;boolean ignoreResourceNotFound, ...;String fileEncoding, ...;/** Set local properties, e.g. via the "props" tag in XML bean definitions. ... */this.localProperties/** Set local properties, e.g. via the "props" tag in XML bean definitions, ... *//** Set a location of a properties file to be loaded. ... */this.locations/** Set locations of properties files to be loaded. ... *//** Set whether local properties override properties from files. ... *//** Set if failure to find the property resource should be ignored. ... */this.ignoreResourceNotFound/** Set the encoding to use for parsing properties files. ... */this.fileEncoding/** Return a merged Properties instance containing both the ... */Properties localProp/** Load properties into the given instance. ... */// Load properties from file upfront, to let local properties override.// Load properties from file afterwards, to let those properties override./** Convenient utility methods for loading of {@code java.util.Properties}, ... */String XML_FILE_EXTENSION, ...;/** Load properties from the given EncodedResource, ... *//** Fill the given properties from the given EncodedResource, ... *//** Actually load properties from the given EncodedResource into the given Properties instance. ... */requiresReader(...)/** Load properties from the given resource (in ISO-8859-1 encoding). ... *//** Fill the given properties from the given resource (in ISO-8859-1 encoding). ... */loadFromXML(...)/** Load all properties from the specified class path resource ... *//** Strategy interface for creating resource-based {@link PropertySource} wrappers. ... *//** Create a {@link PropertySource} that wraps the given resource. ... *//** Editor for {@link org.springframework.core.io.Resource} arrays, to ... *//** Create a new ResourceArrayPropertyEditor with a default ... *//** Create a new ResourceArrayPropertyEditor with the given {@link ResourcePatternResolver} ... *//** Treat the given text as a location pattern and convert it to a Resource array. *//** Treat the given value as a collection or array and convert it to a Resource array. ... */Collection<?> inputSet<Resource> merged/** Resolve the given path, replacing placeholders with ... */// A location pattern: resolve it into a Resource array.// Might point to a single resource or to multiple resources.// ignore - might be an unresolved placeholder or non-existing base directory// A Resource object: add it to the result.// An arbitrary value: probably a String or a Resource array.// setAsText will be called for a String; a Resource array will be used as-is./** Strategy interface for resolving a location pattern (for example, ... */String CLASSPATH_ALL_URL_PREFIX, ...;/** Pseudo URL prefix for all matching resources from the class path: "classpath*:" ... *//** Resolve the given location pattern into {@code Resource} objects. ... *//** Utility class for determining whether a given URL is a resource ... *//** Return whether the given resource location is a URL: either a ... *//** Return a default {@link ResourcePatternResolver} for the given {@link ResourceLoader}. ... */import DefaultPropertiesPersister/** Spring-aware subclass of the plain {@link DefaultPropertiesPersister}, ... */new ResourcePropertiesPersister(...)ResourcePropertiesPersister INSTANCE, ...;/** A convenient constant for a default {@code ResourcePropertiesPersister} instance, ... */storeToXml(...)/** Subclass of {@link PropertiesPropertySource} that loads a {@link Properties} object ... */String resourceName, ...;/** The original resource name, if different from the given name. *//** Create a PropertySource having the given name based on Properties ... */this.resourceNamegetNameForResource(...)/** Create a PropertySource based on Properties loaded from the given resource. ... *//** Create a PropertySource having the given name based on Properties loaded from ... *//** Create a PropertySource based on Properties loaded from the given resource ... *//** Return a potentially adapted variant of this {@link ResourcePropertySource}, ... *//** Return the description for the given Resource; if the description is ... */// Store the original resource name if necessary...// Current name is resource name -> preserve it in the extra field.../** Region of a {@link Resource} implementation, materialized by a {@code position} ... */long position, ...;/** Create a new {@code ResourceRegion} from a given {@link Resource}. ... *//** Return the underlying {@link Resource} for this {@code ResourceRegion}. *//** Return the start position of this region in the underlying {@link Resource}. *//** Return the byte count of this region in the underlying {@link Resource}. *//** General purpose factory loading mechanism for internal use within the framework. ... */SpringFactoriesLoader.classnew ConcurrentReferenceHashMap<ClassLoader,Map<String,List<String>>>(...)String FACTORIES_RESOURCE_LOCATION, ...;/** The location to look for factories. ... */Map<ClassLoader,Map<String,List<String>>> cache, ...;/** Load and instantiate the factory implementations of the given type from ... */List<String> factoryImplementationNamesloadFactoryNames(...)List<T> resultString factoryImplementationNameinstantiateFactory(...)/** Load the fully qualified class names of factory implementations of the ... */String factoryTypeNameloadSpringFactories(...)Map<String,List<String>> resultUrlResource resourceString[] factoryImplementationNamesnew Function<String,List<String>>(...) { ... }new BiFunction<String,List<String>,List<String>>(...) { ... }distinct(...)new Function<List<String>,List<String>>(...) { ... }Class<?> factoryImplementationClass// Replace all lists with unmodifiable lists containing unique elementsimport VfsUtils/** Artificial class used for accessing the {@link VfsUtils} methods ... */doGetVisitorAttributes(...)doGetPath(...)Object visitorProxy/** Support classes for Spring's resource abstraction. ... */import NoOpLog/** Implementation of {@link Log} that wraps a list of loggers and delegates ... */new NoOpLog(...)Log NO_OP_LOG, ...;Log fatalLogger, ...;Log errorLogger, ...;Log warnLogger, ...;Log infoLogger, ...;Log debugLogger, ...;Log traceLogger, ...;/** Constructor with list of loggers. For optimal performance, the constructor ... */this.fatalLoggerinitLogger(...)new Predicate<Log>(...) { ... }this.errorLoggerthis.warnLoggerthis.infoLoggerthis.debugLoggerthis.traceLogger/** A convenient accessor for Commons Logging, providing not only ... *//** Create a new accessor for the given Commons Log. ... *//** Create a new accessor for the specified Commons Log category. ... *//** Return the target Commons Log. *//** Is fatal logging currently enabled? */// Log level checks/** Is error logging currently enabled? *//** Is warn logging currently enabled? *//** Is info logging currently enabled? *//** Is debug logging currently enabled? *//** Is trace logging currently enabled? *//** Log a message with fatal log level. ... */// Plain log methods/** Log an error with fatal log level. ... *//** Log a message with error log level. ... *//** Log an error with error log level. ... *//** Log a message with warn log level. ... *//** Log an error with warn log level. ... *//** Log a message with info log level. ... *//** Log an error with info log level. ... *//** Log a message with debug log level. ... *//** Log an error with debug log level. ... *//** Log a message with trace log level. ... *//** Log an error with trace log level. ... */// Supplier-based log methods/** Factory for common {@link Log} delegates with Spring's logging conventions. ... *//** Create a composite logger that delegates to a primary or falls back on a ... */List<Log> loggersnew ArrayList<Log>(...)tertiaryLoggers.lengthnew CompositeLog(...)/** Create a "hidden" logger whose name is intentionally prefixed with "_" ... *//** Utility methods for formatting and logging messages. ... *//** Format the given value via {@code toString()}, quoting it if it is a ... *//** Use this to log a message with different levels of detail (or different ... */String logMessage/** A simple log message type for use with Commons Logging, allowing ... */String result, ...;subSequence(...)/** This will be called by the logging provider, potentially once ... */buildString(...)/** Build a lazily resolving message from the given supplier. ... */new SupplierMessage(...)/** Build a lazily formatted message from the given format string and argument. ... */new FormatMessage1(...)/** Build a lazily formatted message from the given format string and arguments. ... */new FormatMessage2(...)new FormatMessage3(...)new FormatMessage4(...)/** Build a lazily formatted message from the given format string and varargs. ... */new FormatMessageX(...)Supplier<? extends CharSequence> supplier, ...;this.supplierString format, ...;this.formatObject arg1, ...;this.arg1Object arg2, ...;this.arg2Object arg3, ...;this.arg3Object arg4, ...;this.arg4/** Useful delegates for Spring's logging conventions. *//** Instruments the application startup phase using {@link StartupStep steps}. ... */new DefaultApplicationStartup(...)ApplicationStartup DEFAULT, ...;/** Default "no op" {@code ApplicationStartup} implementation. ... *//** Create a new step and marks its beginning. ... */new DefaultStartupStep(...)new DefaultTags(...)boolean recorded, ...;DefaultTags TAGS, ...;this.TAGSthis.recordedStartupStep.TagsStartupStep.Tag/** Step recording metrics about a particular phase or action happening during the {@link ApplicationStartup}. ... *//** Return the name of the startup step. ... *//** Return the unique id for this step within the application startup. *//** Return, if available, the id of the parent step. ... *//** Add a {@link Tag} to the step. ... *//** Return the {@link Tag} collection for this step. *//** Record the state of the step and possibly other metrics like execution time. ... *//** Immutable collection of {@link Tag}. *//** Simple key/value association for storing step metadata. *//** Return the {@code Tag} name. *//** Return the {@code Tag} value. *//** {@link ApplicationStartup} implementation for the Java Flight Recorder. ... */long currentSequenceId, ...;Deque<Long> currentSteps, ...;this.currentSequenceIdthis.currentStepsnew ArrayDeque<Long>(...)offerFirst(...)FlightRecorderStartupStep stepnew FlightRecorderStartupStep(...)getFirst(...)new Consumer<FlightRecorderStartupStep>(...) { ... }import Categoryimport Event/** {@link Event} extension for recording {@link FlightRecorderStartupStep} ... */long eventId, ...;long parentId, ...;String tags, ...;this.eventIdthis.parentIdthis.tags/** {@link StartupStep} implementation for the Java Flight Recorder. ... */new FlightRecorderTags(...)FlightRecorderStartupEvent event, ...;FlightRecorderTags tags, ...;Consumer<FlightRecorderStartupStep> recordingCallback, ...;new FlightRecorderStartupEvent(...)begin(...)this.recordingCallbackthis.event.namethis.event.eventIdthis.event.parentIdshouldCommit(...)new Consumer<Tag>(...) { ... }setTags(...)new Tag[]...[] tags, ...;Tag[] newTagsthis.tags.lengthnew FlightRecorderTag(...)newTags.lengthnew TagsIterator(...)int idx, ...;this.idxtags.length/* Copyright 2012-2020 the original author or authors. ... *//** Support package for recording startup metrics using Java Flight Recorder. *//** Support package for recording metrics during application startup. *//** Provides basic classes for exception handling and version detection, ... *//** A default {@link Deserializer} implementation that reads an input stream ... *//** Create a {@code DefaultDeserializer} with default {@link ObjectInputStream} ... *//** Create a {@code DefaultDeserializer} for using an {@link ObjectInputStream} ... *//** Read from the supplied {@code InputStream} and deserialize the contents ... */ObjectInputStream objectInputStreamnew ConfigurableObjectInputStream(...)/** A {@link Serializer} implementation that writes an object to an output stream ... *//** Writes the source object to an output stream using Java serialization. ... */ObjectOutputStream objectOutputStream/** A strategy interface for converting from data in an InputStream to an Object. ... *//** Read (assemble) an object of type T from the given InputStream. ... *//** Read (assemble) an object of type T from the given byte array. ... *//** A strategy interface for streaming an object to an OutputStream. ... *//** Write an object of type T to the given OutputStream. ... *//** Turn an object of type T into a serialized byte array. ... */ByteArrayOutputStream out/** Root package for Spring's serializer interfaces and implementations. ... */import DefaultDeserializerimport Deserializer/** A {@link Converter} that delegates to a ... */Deserializer<Object> deserializer, ...;/** Create a {@code DeserializingConverter} with default {@link java.io.ObjectInputStream} ... */this.deserializernew DefaultDeserializer(...)/** Create a {@code DeserializingConverter} for using an {@link java.io.ObjectInputStream} ... *//** Create a {@code DeserializingConverter} that delegates to the provided {@link Deserializer}. */ByteArrayInputStream byteStreamnew SerializationFailedException(...)import DefaultSerializerimport Serializer/** A convenient delegate with pre-arranged configuration state for common ... */Serializer<Object> serializer, ...;/** Create a {@code SerializationDelegate} with a default serializer/deserializer ... */this.serializernew DefaultSerializer(...)/** Create a {@code SerializationDelegate} with the given serializer/deserializer. ... *//** Wrapper for the native IOException (or similar) when a ... *//** Construct a {@code SerializationException} with the specified detail message. ... *//** Construct a {@code SerializationException} with the specified detail message ... *//** Create a default {@code SerializingConverter} that uses standard Java serialization. *//** Create a {@code SerializingConverter} that delegates to the provided {@link Serializer}. *//** Serializes the source object and returns the byte array result. *//** Support classes for Spring's serializer abstraction. ... *//** Spring's default {@code toString()} styler. ... */ValueStyler valueStyler, ...;/** Create a new DefaultToStringStyler. ... */this.valueStyler/** Return the ValueStyler used by this ToStringStyler. */styleIdentityHashCode(...)styleValue(...)styleFieldStart(...)styleFieldEnd(...)/** Converts objects to String form, generally for debugging purposes, ... */String NULL, ...;String COLLECTION, ...;String SET, ...;String LIST, ...;String MAP, ...;String EMPTY_MAP, ...;String ARRAY, ...;styleArray(...)StringJoiner resultEntry<K,V> entryString collectionTypegetCollectionTypeString(...)/** Simple utility class to allow for convenient access to value ... */new DefaultValueStyler(...)ValueStyler DEFAULT_VALUE_STYLER, ...;/** Default ValueStyler instance used by the {@code style} method. ... *//** Style the specified value according to default conventions. ... *//** Utility class that builds pretty-printing {@code toString()} methods ... */new DefaultToStringStyler(...)StylerUtils.DEFAULT_VALUE_STYLERToStringStyler DEFAULT_TO_STRING_STYLER, ...;/** Default ToStringStyler instance used by this ToStringCreator. */StringBuilder buffer, ...;ToStringStyler styler, ...;boolean styledFirstField, ...;/** Create a ToStringCreator for the given object. ... *//** Create a ToStringCreator for the given object, using the provided style. ... */this.stylerstyleStart(...)this.buffer/** Append a byte field value. ... *//** Append a short field value. ... *//** Append a integer field value. ... *//** Append a long field value. ... *//** Append a float field value. ... *//** Append a double field value. ... *//** Append a boolean field value. ... *//** Append a field value. ... */printFieldSeparatorIfNecessary(...)styleField(...)this.styledFirstFieldstyleFieldSeparator(...)/** Append the provided value. ... *//** Return the String representation that this ToStringCreator built. */styleEnd(...)/** A strategy interface for pretty-printing {@code toString()} methods. ... *//** Style a {@code toString()}'ed object before its fields are styled. ... *//** Style a {@code toString()}'ed object after it's fields are styled. ... *//** Style a field value as a string. ... *//** Style the given value. ... *//** Style the field separator. ... *//** Strategy that encapsulates value String styling algorithms ... *//** Style the given value, returning a String representation. ... *//** Support for styling values as Strings, with ToStringCreator as central class. *//** Extension of the {@link AsyncTaskExecutor} interface, adding the capability to submit ... *//** Submit a {@code Runnable} task for execution, receiving a {@code ListenableFuture} ... *//** Submit a {@code Callable} task for execution, receiving a {@code ListenableFuture} ... *//** Extended interface for asynchronous {@link TaskExecutor} implementations, ... */long TIMEOUT_IMMEDIATE, ...;/** Constant that indicates immediate execution. */long TIMEOUT_INDEFINITE, ...;/** Constant that indicates no time limit. *//** Execute the given {@code task}. ... *//** Submit a Runnable task for execution, receiving a Future representing that task. ... *//** Submit a Callable task for execution, receiving a Future representing that task. ... *//** {@link TaskExecutor} implementation that fires up a new Thread for each task, ... */new ConcurrencyThrottleAdapter(...)ConcurrencyThrottleSupport.UNBOUNDED_CONCURRENCYConcurrencyThrottleSupport.NO_CONCURRENCYint UNBOUNDED_CONCURRENCY, ...;/** Permit any number of concurrent invocations: that is, don't throttle concurrency. ... */int NO_CONCURRENCY, ...;/** Switch concurrency 'off': that is, don't allow any concurrent invocations. ... */ConcurrencyThrottleAdapter concurrencyThrottle, ...;/** Internal concurrency throttle used by this executor. *//** Create a new SimpleAsyncTaskExecutor with default thread name prefix. *//** Create a new SimpleAsyncTaskExecutor with the given thread name prefix. ... *//** Create a new SimpleAsyncTaskExecutor with the given external thread factory. ... *//** Specify an external factory to use for creating new Threads, ... *//** Return the external factory to use for creating new Threads, if any. *//** Set the maximum number of parallel accesses allowed. ... */this.concurrencyThrottle/** Return the maximum number of parallel accesses allowed. *//** Return whether this throttle is currently active. ... */isThrottleActive(...)/** Executes the given task, within a concurrency throttle ... */Runnable taskToUsedoExecute(...)new ConcurrencyThrottlingRunnable(...)/** Template method for the actual execution of a task. ... *//** Subclass of the general ConcurrencyThrottleSupport class, ... *//** This Runnable calls {@code afterAccess()} after the ... */Runnable target, ...;/** {@link TaskExecutor} implementation that executes each task <i>synchronously</i> ... *//** Executes the given {@code task} synchronously, through direct ... *//** A callback interface for a decorator to be applied to any {@link Runnable} ... *//** Decorate the given {@code Runnable}, returning a potentially wrapped ... *//** Simple task executor interface that abstracts the execution ... *//** Exception thrown when a {@link TaskExecutor} rejects to accept ... *//** Create a new {@code TaskRejectedException} ... *//** Exception thrown when a {@link AsyncTaskExecutor} rejects to accept ... *//** Create a new {@code TaskTimeoutException} ... *//** This package defines Spring's core TaskExecutor abstraction, ... *//** Adapter that exposes the {@link java.util.concurrent.Executor} interface ... */TaskExecutor taskExecutor, ...;/** Create a new ConcurrentExecutorAdapter for the given Spring TaskExecutor. ... */import AbstractExecutorService/** Adapter that takes a Spring {@link org.springframework.core.task.TaskExecutor} ... *//** Create a new ExecutorServiceAdapter, using the given target executor. ... *//** Adapter that takes a JDK {@code java.util.concurrent.Executor} and ... *//** Create a new TaskExecutorAdapter, ... *//** Delegates to the specified JDK concurrent executor. ... *//** Actually execute the given {@code Runnable} (which may be a user-supplied task ... *//** Support classes for Spring's TaskExecutor abstraction. ... */import MergedAnnotationCollectorsimport MergedAnnotationSelectors/** Defines access to the annotations of a specific type ({@link AnnotationMetadata class} ... *//** Return annotation details based on the direct annotations of the ... *//** Determine whether the underlying element has an annotation or meta-annotation ... *//** Retrieve the attributes of the annotation of the given type, if any (i.e. if ... */MergedAnnotation<Annotation> annotation/** Retrieve all attributes of all annotations of the given type, if any (i.e. if ... *//** Interface that defines abstract access to the annotations of a specific ... *//** Get the fully qualified class names of all annotation types that ... *//** Get the fully qualified class names of all meta-annotation types that ... *//** Determine whether an annotation of the given type is <em>present</em> on ... *//** Determine whether the underlying class has an annotation that is itself ... *//** Determine whether the underlying class has any methods that are ... *//** Retrieve the method metadata for all methods that are annotated ... *//** Factory method to create a new {@link AnnotationMetadata} instance ... *//** Interface that defines abstract metadata of a specific class, ... *//** Return the name of the underlying class. *//** Return whether the underlying class represents an interface. *//** Return whether the underlying class represents an annotation. ... *//** Return whether the underlying class is marked as abstract. *//** Return whether the underlying class represents a concrete class, ... *//** Return whether the underlying class is marked as 'final'. *//** Determine whether the underlying class is independent, i.e. whether ... *//** Return whether the underlying class is declared within an enclosing ... */getEnclosingClassName(...)/** Return the name of the enclosing class of the underlying class, ... *//** Return whether the underlying class has a super class. *//** Return the name of the super class of the underlying class, ... *//** Return the names of all interfaces that the underlying class ... *//** Return the names of all classes declared as members of the class represented by ... *//** Return the name of the method. *//** Return the fully-qualified name of the class that declares this method. *//** Return the fully-qualified name of this method's declared return type. ... *//** Return whether the underlying method is effectively abstract: ... *//** Return whether the underlying method is declared as 'static'. *//** Return whether the underlying method is marked as 'final'. *//** Return whether the underlying method is overridable, ... *//** {@link AnnotationMetadata} implementation that uses standard reflection ... */MergedAnnotations mergedAnnotations, ...;boolean nestedAnnotationsAsMap, ...;Set<String> annotationTypes, ...;/** Create a new {@code StandardAnnotationMetadata} wrapper for the given Class. ... *//** Create a new {@link StandardAnnotationMetadata} wrapper for the given Class, ... */this.mergedAnnotationsthis.nestedAnnotationsAsMapSet<String> annotationTypesthis.annotationTypesAnnotationMetadata.superisAnnotatedMethod(...)Set<MethodMetadata> annotatedMethodsnew StandardMethodMetadata(...)getAnnotations(...).lengthnew StandardAnnotationMetadata(...)/** {@link ClassMetadata} implementation that uses standard reflection ... */Class<?> introspectedClass, ...;/** Create a new StandardClassMetadata wrapper for the given Class. ... */this.introspectedClass/** Return the underlying Class. */hasEnclosingClass(...)Class<?> superClassString[] ifcNamesLinkedHashSet<String> memberClassNamesClass<?> nestedClass/** {@link MethodMetadata} implementation that uses standard reflection ... */Method introspectedMethod, ...;/** Create a new StandardMethodMetadata wrapper for the given Method. ... *//** Create a new StandardMethodMetadata wrapper for the given Method, ... */this.introspectedMethod/** Return the underlying Method. */MethodMetadata.superimport AnnotationVisitor/** {@link AnnotationVisitor} to recursively visit annotations. ... */AnnotationAttributes attributes, ...;String annotationTypeAnnotationAttributes nestedAttributesnew RecursiveAnnotationAttributesVisitor(...)new RecursiveAnnotationArrayVisitor(...)Object newValueObject valueToUseField enumConstant/** ASM visitor which looks for annotations defined on a class or method, ... */MultiValueMap<String,AnnotationAttributes> attributesMap, ...;Map<String,Set<String>> metaAnnotationMap, ...;this.attributesMapthis.metaAnnotationMapClass<? extends Annotation> annotationClassList<AnnotationAttributes> attributeListisInJavaLangAnnotationPackage(...)Set<Annotation> visitedrecursivelyCollectMetaAnnotations(...)Set<String> metaAnnotationTypeNamesString annotationNameAnnotation metaMetaAnnotation// Only do attribute scanning for public annotations; we'd run into// IllegalAccessExceptions otherwise, and we don't want to mess with// accessibility in a SecurityManager environment./** ASM class visitor which looks for the class name and implemented types as ... */new LinkedHashMap<String,Set<String>>(...)new LinkedMultiValueMap<String,AnnotationAttributes>(...)Set<String> annotationSet, ...;LinkedMultiValueMap<String,AnnotationAttributes> attributesMap, ...;/** Declared as a {@link LinkedMultiValueMap} instead of a {@link MultiValueMap} ... */Set<MethodMetadata> methodMetadataSet, ...;new MethodMetadataReadingVisitor(...)this.methodMetadataSetthis.annotationSetnew AnnotationAttributesReadingVisitor(...)Set<String> metaAnnotationTypesCollection<Set<String>> allMetaTypesAnnotationAttributes rawconvertClassValues(...)MultiValueMap<String,Object> allAttributesList<AnnotationAttributes> attributesString annotatedElement// Skip bridge methods - we're only interested in original annotation-defining user methods.// On JDK 8, we'd otherwise run into double detection of the same annotated method.../** Internal utility class used when reading annotations via ASM. ... */AnnotationAttributes resultpostProcessAnnotationAttributes(...)AnnotationAttributes[] valuesType[] arrayObject[] convArrayClass<?>[] clazzArrayString[] newValueclazzArray.length/** Retrieve the merged attributes of the annotation of the given type, ... */List<AnnotationAttributes> attributesListSet<String> overridableAttributeNamesList<String> annotationTypesString currentAnnotationTypeList<AnnotationAttributes> currentAttributesListAnnotationAttributes currentAttributesString overridableAttributeName// Class not found - can't resolve class reference in annotation attribute.// Get the unmerged list of attributes for the target annotation.// To start with, we populate the result with a copy of all attribute values// from the target annotation. A copy is necessary so that we do not// inadvertently mutate the state of the metadata passed to this method.// Since the map is a LinkedMultiValueMap, we depend on the ordering of// elements in the map and reverse the order of the keys in order to traverse// "down" the annotation hierarchy.// No need to revisit the target annotation type:// Store the value, potentially overriding a value from an attribute// of the same name found higher in the annotation hierarchy./** Caching implementation of the {@link MetadataReaderFactory} interface, ... */int DEFAULT_CACHE_LIMIT, ...;/** Default maximum number of entries for a local MetadataReader cache: 256. */Map<Resource,MetadataReader> metadataReaderCache, ...;/** MetadataReader cache: either local or shared at the ResourceLoader level. *//** Create a new CachingMetadataReaderFactory for the default class loader, ... */setCacheLimit(...)/** Create a new CachingMetadataReaderFactory for the given {@link ClassLoader}, ... *//** Create a new CachingMetadataReaderFactory for the given {@link ResourceLoader}, ... */this.metadataReaderCachegetResourceCache(...)MetadataReader.class/** Specify the maximum number of entries for the MetadataReader cache. ... */new LocalResourceCache(...)/** Return the maximum number of entries for the MetadataReader cache. */getCacheLimit(...)/** Clear the local MetadataReader cache, if any, removing all cached class metadata. */int cacheLimit, ...;this.cacheLimitMap<>.Entry<Resource,MetadataReader>// No synchronization necessary...// Shared resource cache -> reset to local cache.import FieldVisitorimport ClassMetadata/** ASM class visitor which looks only for the class name and implemented types, ... */boolean isAnnotation, ...;boolean isAbstract, ...;boolean isFinal, ...;String enclosingClassName, ...;boolean independentInnerClass, ...;String superClassName, ...;Set<String> memberClassNames, ...;convertResourcePathToClassName(...)Opcodes.ACC_INTERFACEthis.isAnnotationOpcodes.ACC_ANNOTATIONthis.isAbstractOpcodes.ACC_ABSTRACTthis.isFinalOpcodes.ACC_FINALthis.superClassNamethis.enclosingClassNameString fqNameString fqOuterNamethis.independentInnerClassthis.memberClassNamesnew EmptyAnnotationVisitor(...)new EmptyFieldVisitor(...)new EmptyMethodVisitor(...)import AnnotationFilter/** {@link AnnotationVisitor} that can be used to construct a ... */Class<A> annotationType, ...;Consumer<MergedAnnotation<A>> consumer, ...;this.consumernew Consumer<MergedAnnotation<Annotation>>(...) { ... }new ArrayVisitor(...)new Consumer<Object[]>(...) { ... }Class<E> typeClass<T> typenew MergedAnnotationReadingVisitor<T>(...)Class<A> annotationTypenew MergedAnnotationReadingVisitor<A>(...)/** {@link AnnotationVisitor} to deal with array attributes. */List<Object> elements, ...;Consumer<Object[]> consumer, ...;this.elementsMergedAnnotationReadingVisitor<>.this/** Simple facade for accessing class metadata, ... *//** Return the resource reference for the class file. *//** Read basic class metadata for the underlying class. *//** Read full annotation metadata for the underlying class, ... *//** Factory interface for {@link MetadataReader} instances. ... *//** Obtain a MetadataReader for the given class name. ... *//** Obtain a MetadataReader for the given resource. ... *//** ASM method visitor which looks for the annotations defined on a method, ... */int access, ...;String declaringClassName, ...;String returnTypeName, ...;this.accessthis.declaringClassNamethis.returnTypeNameOpcodes.ACC_PRIVATEAnnotationAttributes annotationAttributesAnnotationAttributes convertedAttributes/** {@link AnnotationVisitor} to recursively visit annotation arrays. ... */new ArrayList<AnnotationAttributes>(...)String attributeName, ...;List<AnnotationAttributes> allNestedAttributes, ...;this.attributeNameObject existingValueObject[] newArraythis.allNestedAttributesnew AnnotationAttributes[]// Corresponding attribute method not found: cannot expose empty array./** {@link AnnotationVisitor} to recursively visit annotation attributes. ... */String annotationType, ...;registerDefaultValues(...)/** {@link AnnotationMetadata} created from a ... */...[] interfaceNames, ...;...[] memberClassNames, ...;...[] annotatedMethods, ...;MergedAnnotations annotations, ...;this.interfaceNamesthis.annotatedMethodsMethodMetadata annotatedMethod/** ASM class visitor that creates {@link SimpleAnnotationMetadata}. ... */new ArrayList<MergedAnnotation<?>>(...)new ArrayList<SimpleMethodMetadata>(...)List<MergedAnnotation<?>> annotations, ...;List<SimpleMethodMetadata> annotatedMethods, ...;SimpleAnnotationMetadata metadata, ...;toClassName(...)String outerClassNamenew SimpleMethodMetadataReadingVisitor(...)new Consumer<SimpleMethodMetadata>(...) { ... }MethodMetadata[] annotatedMethodsnew MethodMetadata[]new SimpleAnnotationMetadata(...)Source source/** {@link MergedAnnotation} source. */(...).className// Skip bridge methods - we're only interested in original// annotation-defining user methods. On JDK 8, we'd otherwise run into// double detection of the same annotated method.../** {@link MetadataReader} implementation based on an ASM ... */ClassReader.SKIP_FRAMESClassReader.SKIP_DEBUGClassReader.SKIP_CODEint PARSING_OPTIONS, ...;SimpleAnnotationMetadataReadingVisitor visitornew SimpleAnnotationMetadataReadingVisitor(...)getClassReader(...)/** Simple implementation of the {@link MetadataReaderFactory} interface, ... *//** Create a new SimpleMetadataReaderFactory for the default class loader. *//** Create a new SimpleMetadataReaderFactory for the given resource loader. ... *//** Create a new SimpleMetadataReaderFactory for the given class loader. ... *//** Return the ResourceLoader that this MetadataReaderFactory has been ... */ClassUtils.CLASS_FILE_SUFFIXString innerClassNameString innerClassResourcePathResource innerClassResourcenew SimpleMetadataReader(...)// Maybe an inner class name using the dot name syntax? Need to use the dollar syntax here...// ClassUtils.forName has an equivalent check for resolution into Class references later on./** {@link MethodMetadata} created from a ... *//** ASM method visitor that creates {@link SimpleMethodMetadata}. ... */Consumer<SimpleMethodMetadata> consumer, ...;String returnTypeNameSimpleMethodMetadata metadatanew SimpleMethodMetadata(...)String toStringValue, ...;Source otherSourceotherSource.declaringClassNameotherSource.nameotherSource.descriptorthis.toStringValue/** Support classes for reading annotation and class-level metadata. *//** Type filter that exposes a ... *//** Determine a match based on the given ClassMetadata object. ... *//** Type filter that is aware of traversing over hierarchy. ... */boolean considerInherited, ...;boolean considerInterfaces, ...;this.considerInheritedthis.considerInterfacesClassMetadata metadatamatchSelf(...)matchClassName(...)String superClassNameBoolean superClassMatchmatchSuperClass(...)String ifcBoolean interfaceMatchmatchInterface(...)/** Override this to match self characteristics alone. Typically, ... *//** Override this to match on type name. *//** Override this to match on super type name. *//** Override this to match on interface type name. */// This method optimizes avoiding unnecessary creation of ClassReaders// as well as visiting over those readers.// Optimization to avoid creating ClassReader for super class.// Need to read super class to determine a match...// Optimization to avoid creating ClassReader for super class// Need to read interface to determine a match.../** A simple {@link TypeFilter} which matches classes with a given annotation, ... */boolean considerMetaAnnotations, ...;/** Create a new {@code AnnotationTypeFilter} for the given annotation type. ... */Inherited.classthis.considerMetaAnnotations/** Return the {@link Annotation} that this instance is using to filter ... */hasMetaAnnotation(...)// Standard Java types do not have non-standard annotations on them ->// skip any load attempt, in particular for Java language interfaces.// Class not regularly loadable - can't determine a match that way.import Worldimport BcelWorldimport FormalBindingimport IScopeimport PatternParserimport SimpleScopeimport TypePattern/** Type filter that uses AspectJ type pattern for matching. ... */World world, ...;TypePattern typePattern, ...;PatternParser patternParsernew PatternParser(...)TypePattern typePatternIScope scopenew SimpleScope(...)this.worldnew FormalBinding[]new BcelWorld(...)IMessageHandler.THROWsetBehaveInJava5Way(...)resolveBindings(...)Bindings.NONEResolvedType resolvedTypematchesStatically(...)/** A simple filter which matches classes that are assignable to a given type. ... *//** Create a new AssignableTypeFilter for the given type. ... *//** Return the {@code type} that this instance is using to filter candidates. ... */matchTargetType(...)/** A simple filter for matching a fully-qualified class name with a regex {@link Pattern}. ... */Pattern pattern, ...;/** Base interface for type filters using a ... *//** Determine whether this filter matches for the class described by ... *//** Core support package for type filtering (e.g. for classpath scanning). *//** Core support package for type introspection. */import TypeQualifierNickname/** A common Spring annotation to declare that annotated elements cannot be {@code null}. ... */import TypeQualifierDefault/** A common Spring annotation to declare that parameters and return values ... */ElementType.PACKAGE/** A common Spring annotation to declare that fields are to be considered as ... */import When/** A common Spring annotation to declare that annotated elements can be {@code null} under ... */When.MAYBE/** Indicates that the annotated element uses Java 7 specific API constructs, ... */RetentionPolicy.CLASS/** Indicates that the annotated element uses Java 8 specific API constructs, ... *//** Indicates that the annotated element uses the Http Server available in ... *//** Indicates that the annotated element uses an API from the {@code sun.misc} ... */import ObjectInstantiatorimport InstantiatorStrategyimport StdInstantiatorStrategy/** Spring-specific variant of {@link ObjenesisStd} / {@link ObjenesisBase}, ... */new ConcurrentReferenceHashMap<Class<?>,ObjectInstantiator<?>>(...)String IGNORE_OBJENESIS_PROPERTY_NAME, ...;/** System property that instructs Spring to ignore Objenesis, not even attempting ... */InstantiatorStrategy strategy, ...;ConcurrentReferenceHashMap<Class<?>,ObjectInstantiator<?>> cache, ...;Boolean worthTrying, ...;/** Create a new {@code SpringObjenesis} instance with the ... */new StdInstantiatorStrategy(...)SpringObjenesis.IGNORE_OBJENESIS_PROPERTY_NAMEthis.worthTrying/** Return whether this Objenesis instance is worth trying for instance creation, ... *//** Create a new instance of the given class via Objenesis. ... */newInstantiatorOf(...)getInstantiatorOf(...)ObjectInstantiator<?> instantiatorObjectInstantiator<T> newInstantiatorBoolean currentWorthTryingObjectInstantiator<T> instantiatornew ObjenesisException(...)// Evaluate the "spring.objenesis.ignore" property upfront...// Indicates that the chosen instantiation strategy does not work on the given JVM.// Typically a failure to initialize the default SunReflectionFactoryInstantiator.// Let's assume that any subsequent attempts to use Objenesis will fail as well...// Happening on the production version of Google App Engine, coming out of the// restricted "sun.reflect.ReflectionFactory" class...import SecureRandom/** An {@link IdGenerator} that uses {@link SecureRandom} for the initial seed and ... */SecureRandom secureRandomnew SecureRandom(...)byte[] seednextBytes(...)this.randombyte[] randomByteslong mostSigBitslong leastSigBitsnew UUID(...)/** {@link PathMatcher} implementation for Ant-style path patterns. ... */new ConcurrentHashMap<String,String[]>(...)new ConcurrentHashMap<String,AntPathStringMatcher>(...)String DEFAULT_PATH_SEPARATOR, ...;/** Default path separator: "/". */int CACHE_TURNOFF_THRESHOLD, ...;Pattern VARIABLE_PATTERN, ...;...[] WILDCARD_CHARS, ...;String pathSeparator, ...;PathSeparatorPatternCache pathSeparatorPatternCache, ...;boolean caseSensitive, ...;boolean trimTokens, ...;Boolean cachePatterns, ...;Map<String,String[]> tokenizedPatternCache, ...;Map<String,AntPathStringMatcher> stringMatcherCache, ...;/** Create a new instance with the {@link #DEFAULT_PATH_SEPARATOR}. */this.pathSeparatorthis.pathSeparatorPatternCachenew PathSeparatorPatternCache(...)/** A convenient, alternative constructor to use with a custom path separator. ... *//** Set the path separator to use for pattern parsing. ... *//** Specify whether to perform pattern matching in a case-sensitive fashion. ... */this.caseSensitive/** Specify whether to trim tokenized paths and patterns. ... */this.trimTokens/** Specify whether to cache parsed pattern metadata for patterns passed ... */this.cachePatternsthis.tokenizedPatternCachethis.stringMatcherCacheboolean uriVardoMatch(...)/** Actually match the given {@code path} against the given {@code pattern}. ... */String[] pattDirstokenizePattern(...)String[] pathDirstokenizePath(...)int pattIdxStartint pattIdxEndpattDirs.lengthint pathIdxStartint pathIdxEndpathDirs.lengthisPotentialMatch(...)String pattDirmatchStrings(...)int patIdxTmpint patLengthint foundIdxString subPatString subStrint skippedskipSeparator(...)skipSegment(...)isWildcardChar(...)char candidate/** Tokenize the given path pattern into parts, based on this matcher's settings. ... */Boolean cachePatternsdeactivatePatternCache(...)/** Tokenize the given path into parts, based on this matcher's settings. ... *//** Test whether or not a string matches against a pattern. ... */getStringMatcher(...)/** Build or retrieve an {@link AntPathStringMatcher} for the given pattern. ... */AntPathStringMatcher matchernew AntPathStringMatcher(...)/** Given a pattern and a full path, determine the pattern-mapped part. <p>For example: <ul> ... */String[] patternPartsString[] pathPartsboolean pathStartedint segmentpatternParts.lengthString patternPartpathParts.lengthMap<String,String> variablesnew LinkedHashMap<String,String>(...)/** Combine two patterns into a new pattern. ... */boolean pattern1ContainsUriVarint starDotPos1String ext1int dotPos2String file2String ext2boolean ext1Allboolean ext2AllString extgetEndsOnWildCard(...)getEndsOnDoubleWildCard(...)boolean path1EndsWithSeparatorboolean path2StartsWithSeparator/** Given a full path, returns a {@link Comparator} suitable for sorting patterns in order of ... */new AntPatternComparator(...)/** Tests whether or not a string matches against a pattern via a {@link Pattern}. ... */Pattern GLOB_PATTERN, ...;String DEFAULT_VARIABLE_PATTERN, ...;String rawPattern, ...;boolean exactMatch, ...;List<String> variableNames, ...;StringBuilder patternBuilderthis.rawPatternquote(...)int colonIdxthis.variableNamesString variablePatternString variableNamethis.exactMatchPattern.CASE_INSENSITIVE/** Main entry point. ... */groupCount(...)/** The default {@link Comparator} implementation returned by ... *//** Compare two patterns to determine which should match first, i.e. which ... */PatternInfo info1new PatternInfo(...)PatternInfo info2boolean pattern1EqualsPathboolean pattern2EqualsPathisLeastSpecific(...)isPrefixPattern(...)getDoubleWildcards(...)getTotalCount(...)getSingleWildcards(...)getUriVars(...)/** Value class that holds information about the pattern, e.g. number of ... */int uriVars, ...;int singleWildcards, ...;int doubleWildcards, ...;boolean catchAllPattern, ...;boolean prefixPattern, ...;Integer length, ...;initCounters(...)this.catchAllPatternthis.prefixPatternthis.uriVarsthis.doubleWildcardsthis.singleWildcards/** Returns the length of the given pattern, where template variables are considered to be 1 long. *//** A simple cache for patterns that depend on the configured path separator. */String endsOnWildCard, ...;String endsOnDoubleWildCard, ...;this.endsOnWildCardthis.endsOnDoubleWildCard// Match all elements up to the first **// Path is exhausted, only match if rest of pattern is * or **'s// String not exhausted, but pattern is. Failure.// Path start definitely matches due to "**" part in pattern.// up to last '**'// String is exhausted// '**/**' situation, so skip one// Find the pattern between padIdxStart & padIdxTmp in str between// strIdxStart & strIdxEnd// Try to adapt to the runtime situation that we're encountering:// There are obviously too many different patterns coming in here...// So let's turn off the cache since the patterns are unlikely to be reoccurring.// /* + /hotel -> /hotel ; "/*.*" + "/*.html" -> /*.html// However /user + /user -> /usr/user ; /{foo} + /bar -> /{foo}/bar// /hotels/* + /booking -> /hotels/booking// /hotels/* + booking -> /hotels/booking// /hotels/** + /booking -> /hotels/**/booking// /hotels/** + booking -> /hotels/**/booking// simply concatenate the two patterns// No glob pattern was found, this is an exact String match/** Assertion utility class that assists in validating arguments. ... *//** Assert a boolean expression, throwing an {@code IllegalStateException} ... */nullSafeGet(...)/** Assert a boolean expression, throwing an {@code IllegalArgumentException} ... *//** Assert that an object is {@code null}. ... *//** Assert that an object is not {@code null}. ... *//** Assert that the given String is not empty; that is, ... *//** Assert that the given String contains valid text content; that is, it must not ... *//** Assert that the given text does not contain the given substring. ... *//** Assert that an array contains elements; that is, it must not be ... *//** Assert that an array contains no {@code null} elements. ... *//** Assert that a collection contains elements; that is, it must not be ... *//** Assert that a collection contains no {@code null} elements. ... *//** Assert that a Map contains entries; that is, it must not be {@code null} ... *//** Assert that the provided object is an instance of the provided class. ... */instanceCheckFailed(...)/** Assert that {@code superType.isAssignableFrom(subType)} is {@code true}. ... */assignableCheckFailed(...)boolean defaultMessageendsWithSeparator(...)messageWithTypeName(...)/** Simple {@link List} wrapper class that allows for elements to be ... */List<E> backingList, ...;/** The {@link List} that all operations are eventually delegated to. */ElementFactory<E> elementFactory, ...;/** The {@link ElementFactory} to use to create new {@link List} elements ... *//** Creates a new {@code AutoPopulatingList} that is backed by a standard ... *//** Creates a new {@code AutoPopulatingList} that is backed by the supplied {@link List} ... */new ReflectiveElementFactory<E>(...)this.backingListthis.elementFactory/** Get the element at the supplied index, creating it if there is ... */int backingListSizeE elementcreateElement(...)/** Factory interface for creating elements for an index-based access ... *//** Create the element for the supplied index. ... *//** Exception to be thrown from ElementFactory. *//** Reflective implementation of the ElementFactory interface, using ... */Class<? extends E> elementClass, ...;this.elementClassnew ElementInstantiationException(...)import Base64/** A simple utility class for Base64 encoding and decoding. ... *//** Base64-encode the given byte array. ... */src.lengthgetEncoder(...)/** Base64-decode the given byte array. ... */getDecoder(...)/** Base64-encode the given byte array using the RFC 4648 ... */getUrlEncoder(...)/** Base64-decode the given byte array using the RFC 4648 ... */getUrlDecoder(...)/** Base64-encode the given byte array to a String. ... *//** Base64-decode the given byte array from an UTF-8 String. ... *//** Base64-encode the given byte array to a String using the RFC 4648 ... */encodeUrlSafe(...)/** Base64-decode the given byte array from an UTF-8 String using the RFC 4648 ... */decodeUrlSafe(...)import Externalizable/** Miscellaneous {@code java.lang.Class} utility methods. ... */new IdentityHashMap<Class<?>,Class<?>>(...)Set<Class<?>> primitiveTypesClass<?>[] javaLanguageInterfaceArrayExternalizable.classEntry<Class<?>,Class<?>> entryMap<>.Entry<Class<?>,Class<?>>registerCommonClasses(...)Class<?> primitiveTypeStackTraceElement.classIterable<>.classIterator<>.classEnumeration<>.classMap<>.Entry<>.classString ARRAY_SUFFIX, ...;/** Suffix for array class names: {@code "[]"}. */String INTERNAL_ARRAY_PREFIX, ...;/** Prefix for internal array class names: {@code "["}. */String NON_PRIMITIVE_ARRAY_PREFIX, ...;/** Prefix for internal non-primitive array class names: {@code "[L"}. */...[] EMPTY_CLASS_ARRAY, ...;/** A reusable empty class array constant. */char PACKAGE_SEPARATOR, ...;/** The package separator character: {@code '.'}. */char PATH_SEPARATOR, ...;/** The path separator character: {@code '/'}. */char NESTED_CLASS_SEPARATOR, ...;/** The nested class separator character: {@code '$'}. */String CGLIB_CLASS_SEPARATOR, ...;/** The CGLIB class separator: {@code "$$"}. *//** The ".class" file suffix. */Map<Class<?>,Class<?>> primitiveWrapperTypeMap, ...;/** Map with primitive wrapper type as key and corresponding primitive ... */Map<Class<?>,Class<?>> primitiveTypeToWrapperMap, ...;/** Map with primitive type as key and corresponding wrapper ... */Map<String,Class<?>> primitiveTypeNameMap, ...;/** Map with primitive type name as key and corresponding primitive ... */Map<String,Class<?>> commonClassCache, ...;/** Map with common Java language class name as key and corresponding Class as value. ... */Set<Class<?>> javaLanguageInterfaces, ...;/** Common Java language interfaces which are supposed to be ignored ... */Map<Method,Method> interfaceMethodCache, ...;/** Cache for equivalent methods on an interface implemented by the declaring class. *//** Register the given common classes with the ClassUtils cache. *//** Return the default ClassLoader to use: typically the thread context ... */ClassUtils.class/** Replacement for {@code Class.forName()} that also returns Class instances ... */resolvePrimitiveClassName(...)ClassLoader clToUseString elementClassNameClass<?> elementClassString nestedClassNameClassNotFoundException ex2/** Resolve the given class name into a Class instance. Supports ... */IllegalAccessError err/** Determine whether the {@link Class} identified by the supplied name is present ... *//** Check whether the given class is visible in the given ClassLoader. ... */isLoadable(...)/** Check whether the given class is cache-safe in the given context, ... */ClassLoader current/** Check whether the given class is loadable in the given ClassLoader. ... *//** Resolve the given class name as primitive class, if appropriate, ... *//** Check if the given class represents a primitive wrapper, ... *//** Check if the given class represents a primitive (i.e. boolean, byte, ... */isPrimitiveWrapper(...)/** Check if the given class represents an array of primitives, ... *//** Check if the given class represents an array of primitive wrappers, ... *//** Resolve the given class if it is a primitive class, ... *//** Check if the right-hand side type may be assigned to the left-hand side ... */Class<?> resolvedPrimitiveClass<?> resolvedWrapper/** Determine if the given type is assignable from the given value, ... *//** Convert a "/"-based resource path to a "."-based fully qualified class name. ... *//** Convert a "."-based fully qualified class name to a "/"-based resource path. ... *//** Return a path suitable for use with {@code ClassLoader.getResource} ... *//** Given an input class object, return a string which consists of the ... */int packageEndIndex/** Build a String that consists of the names of the classes/interfaces ... *//** Copy the given {@code Collection} into a {@code Class} array. ... *//** Return all interfaces that the given instance implements as an array, ... *//** Return all interfaces that the given class implements as an array, ... *//** Return all interfaces that the given instance implements as a Set, ... *//** Return all interfaces that the given class implements as a Set, ... */Set<Class<?>> interfacesClass<?> currentgetProxyClass(...)/** Determine the common ancestor of the given classes, if any. ... */Class<?> ancestor/** Determine whether the given interface is a common Java language interface: ... *//** Determine if the supplied class is an <em>inner class</em>, ... *//** Check whether the specified class is a CGLIB-generated class. ... */isCglibProxyClassName(...)/** Check whether the specified class name is a CGLIB-generated class. ... *//** Return the user-defined class for the given instance: usually simply ... *//** Return the user-defined class for the given class: usually simply the given ... *//** Return a descriptive name for the given object's type: usually simply ... *//** Check whether the given class matches the user-specified type name. ... *//** Get the class name without the qualified package name. ... */int nameEndIndex/** Return the short string name of a Java class in uncapitalized JavaBeans ... *//** Determine the name of the class file, relative to the containing ... *//** Determine the name of the package of the given class, ... *//** Determine the name of the package of the given fully-qualified class name, ... *//** Return the qualified name of the given class: usually simply ... *//** Return the qualified name of the given method, consisting of ... *//** Determine whether the given class has a public constructor with the given signature. ... *//** Determine whether the given class has a public constructor with the given signature, ... *//** Determine whether the given class has a public method with the given signature. ... */getMethodOrNull(...)/** Determine whether the given class has a public method with the given signature, ... */Set<Method> candidatesfindMethodCandidatesByName(...)/** Return the number of methods with a given name (with any argument types), ... */Method[] declaredMethods/** Does the given class or one of its superclasses at least have one or more ... */hasAtLeastOneMethodWithName(...)/** Determine a corresponding interface method for the given method handle, if possible. ... */new Function<Method,Method>(...) { ... }/** Determine whether the given method is declared by the user or at least pointing to ... */isGroovyObjectMethod(...)/** Determine whether the given method is overridable in the given target class. ... *//** Return a public static method of a class. ... */// Map entry iteration is less expensive to initialize than forEach with lambdas// No thread context class loader -> use class loader of this class.// getClassLoader() returning null indicates the bootstrap ClassLoader// Cannot access system ClassLoader - oh well, maybe the caller can live with null...// "java.lang.String[]" style arrays// "[Ljava.lang.String;" style arrays// "[[I" or "[[Ljava.lang.String;" style arrays// Swallow - let original exception get through// Typically ClassNotFoundException or NoClassDefFoundError...// Fall through to loadable check below// Visible if same Class can be loaded from given ClassLoader// Common cases// Check for match in ancestors -> positive// Check for match in children -> negative// Fallback for ClassLoaders without parent/child relationship:// safe if same Class can be loaded from given ClassLoader// Else: different class with same name found// No corresponding class found at all// Most class names will be quite long, considering that they// SHOULD sit in a package, so a length check is worthwhile.// Could be a primitive - likely.// Security settings are disallowing reflective access; fall back to 'method' below./** Miscellaneous collection utility methods. ... */float DEFAULT_LOAD_FACTOR, ...;/** Default load factor for {@link HashMap}/{@link LinkedHashMap} variants. ... *//** Return {@code true} if the supplied Collection is {@code null} or empty. ... *//** Return {@code true} if the supplied Map is {@code null} or empty. ... *//** Instantiate a new {@link HashMap} with an initial capacity ... */new HashMap<K,V>(...)/** Instantiate a new {@link LinkedHashMap} with an initial capacity ... *//** Convert the supplied array into a List. A primitive array gets converted ... *//** Merge the given array into the given Collection. ... */Object[] arr/** Merge the given Properties instance into the given Map, ... *//** Check whether the given Iterator contains the given element. ... *//** Check whether the given Enumeration contains the given element. ... *//** Check whether the given Collection contains the given element instance. ... *//** Return {@code true} if any element in '{@code candidates}' is ... *//** Return the first element in '{@code candidates}' that is contained in ... *//** Find a single value of the given type in the given Collection. ... *//** Find a single value of one of the given types in the given Collection: ... */findValueOfType(...)/** Determine whether the given Collection only contains a single unique object. ... */boolean hasCandidate/** Find the common element type of the given Collection, if any. ... *//** Retrieve the first element of the given Set, using {@link SortedSet#first()} ... */Iterator<T> itT firstfirst(...)/** Retrieve the first element of the given List, accessing the zero index. ... *//** Retrieve the last element of the given Set, using {@link SortedSet#last()} ... */T lastlast(...)/** Retrieve the last element of the given List, accessing the highest index. ... *//** Marshal the elements from the given enumeration into an array of the given type. ... */ArrayList<A> elementsnew ArrayList<A>(...)/** Adapt an {@link Enumeration} to an {@link Iterator}. ... */new EnumerationIterator<E>(...)/** Adapt a {@code Map<K, List<V>>} to an {@code MultiValueMap<K, V>}. ... */new MultiValueMapAdapter<K,V>(...)/** Return an unmodifiable view of the specified multi-value map. ... */Map<K,List<V>> resultMap<K,List<V>> unmodifiableMapnew BiConsumer<? extends K,List<? extends V>>(...) { ... }List<? extends V> values/** Iterator wrapping an Enumeration. */Enumeration<E> enumeration, ...;this.enumeration// Allow for defaults fallback or potentially overridden accessor...// More than one value found... no clear single value.// Full iteration necessary.../** {@code java.io.Writer} adapter for a Commons Logging {@code Log}. ... *//** Create a new CommonsLogWriter for the given Commons Logging logger. ... */setLength(...)/** Composite iterator that combines multiple other iterators, ... */new LinkedHashSet<Iterator<E>>(...)Set<Iterator<E>> iterators, ...;boolean inUse, ...;/** Add given iterator to this composite. */this.inUsethis.iteratorsIterator<E> iterator/** Support class for throttling concurrent access to a specific resource. ... *//** Permit any number of concurrent invocations: that is, don't throttle concurrency. *//** Switch concurrency 'off': that is, don't allow any concurrent invocations. *//** Transient to optimize serialization. */Object monitor, ...;int concurrencyLimit, ...;int concurrencyCount, ...;/** Set the maximum number of concurrent access attempts allowed. ... */this.concurrencyLimit/** Return the maximum number of concurrent access attempts allowed. *//** To be invoked before the main execution logic of concrete subclasses. ... */boolean debugthis.monitorboolean interruptedthis.concurrencyCount/** To be invoked after the main execution logic of concrete subclasses. ... */notify(...)// Re-interrupt current thread, to allow other threads to react.import ReadWriteLockimport ReentrantReadWriteLock/** Simple LRU (Least Recently Used) cache, bounded by a specified cache limit. ... */new ConcurrentLinkedDeque<K>(...)new ReentrantReadWriteLock(...)int sizeLimit, ...;Function<K,V> generator, ...;ConcurrentHashMap<K,V> cache, ...;ConcurrentLinkedDeque<K> queue, ...;ReadWriteLock lock, ...;/** Create a new cache instance with the given limit and generator function. ... */this.sizeLimit/** Retrieve an entry from the cache, potentially triggering generation ... */V cachedreadLock(...)this.lockremoveLastOccurrence(...)this.queueoffer(...)writeLock(...)V valueK leastUsedpoll(...)/** Determine whether the given key is present in this cache. ... *//** Immediately remove the given key and any associated value. ... */boolean wasPresent/** Immediately remove all entries from this cache. *//** Return the current size of the cache. ... *//** Return the the maximum number of entries in the cache ... */// Retrying in case of concurrent reads on the same key// Generate value first, to prevent size inconsistencyimport ReferenceQueueimport SoftReferenceimport AbstractMapimport AbstractSet/** A {@link ConcurrentHashMap} that uses {@link ReferenceType#SOFT soft} or ... */ReferenceType.SOFTint DEFAULT_CONCURRENCY_LEVEL, ...;ReferenceType DEFAULT_REFERENCE_TYPE, ...;int MAXIMUM_CONCURRENCY_LEVEL, ...;int MAXIMUM_SEGMENT_SIZE, ...;...[] segments, ...;/** Array of segments indexed using the high order bits from the hash. */float loadFactor, ...;/** When the average number of references per table exceeds this value resize will be attempted. */ReferenceType referenceType, ...;/** The reference type: SOFT or WEAK. */int shift, ...;/** The shift value used to calculate the size of the segments array and an index from the hash. */Set<Entry<K,V>> entrySet, ...;/** Late binding entry set. *//** Create a new {@code ConcurrentReferenceHashMap} instance. *//** Create a new {@code ConcurrentReferenceHashMap} instance. ... */this.shiftint roundedUpSegmentCapacityint initialSizecalculateShift(...)Segment[] segmentsSegment.classint resizeThresholdgetLoadFactor(...)this.loadFactorthis.referenceTypesegments.lengthnew Segment(...)this.segmentsthis.segments.length/** Factory method that returns the {@link ReferenceManager}. ... */new ReferenceManager(...)/** Get the hash for a given object, apply an additional hash function to reduce ... */int hashReference<K,V> refgetReference(...)Restructure.WHEN_NECESSARY/** Return a {@link Reference} to the {@link Entry} for the specified {@code key}, ... */getHash(...)getSegmentForHash(...)doTask(...)new Task<V>(...) { ... }TaskOption.RESTRUCTURE_BEFORETaskOption.RESIZEConcurrentReferenceHashMap<>.TaskOptionV oldValueTaskOption.RESTRUCTURE_AFTERTaskOption.SKIP_IF_EMPTYnew Task<Boolean>(...) { ... }Segment segment/** Remove any entries that have been garbage collected and are no longer referenced. ... */restructureIfNecessary(...)Set<Entry<K,V>> entrySetthis.entrySetnew EntrySet(...)/** Calculate a shift value that can be used to create a power-of-two value between ... */int shift/** Various reference types supported by this map. */new ReferenceType(...)ReferenceType SOFT, ...;/** Use {@link SoftReference SoftReferences}. */ReferenceType WEAK, ...;/** Use {@link WeakReference WeakReferences}. *//** A single segment used to divide the map to allow better concurrent performance. */ReferenceManager referenceManager, ...;int initialSize, ...;...[] references, ...;/** Array of references indexed using the low order bits from the hash. ... *//** The total number of references contained in this segment. This includes chained ... */int resizeThreshold, ...;/** The threshold when resizing of the references should occur. When {@code count} ... */this.referenceManagercreateReferenceManager(...)this.initialSizethis.referencescreateReferenceArray(...)this.resizeThresholdReference<K,V>[] referencesReference<K,V> headfindInChain(...)/** Apply an update operation to this segment. ... */boolean resizehasOption(...)Entries<V> entriesnew Entries<V>(...) { ... }Entry<K,V> newEntrynew Entry<K,V>(...)Reference<K,V> newReferencecreateReference(...)Segment.this.referenceManagerSegment.thisSegment.this.referencesSegment.this.count/** Clear all items from this segment. */this.references.length/** Restructure the underlying data structure when it becomes necessary. This ... */int currCountboolean needsResizepollForPurge(...)restructure(...)int countAfterRestructureSet<Reference<K,V>> toPurgeboolean resizingint restructureSizeReference<K,V>[] restructurednew HashSet<Reference<K,V>>(...)getNext(...)Reference<K,V> currRefK entryKeynew Reference<>[]references.length/** Return the size of the current references array. *//** Return the total number of references in this segment. *//** A reference to an {@link Entry} contained in the map. Implementations are usually ... *//** Return the referenced entry, or {@code null} if the entry is no longer available. *//** Return the hash for the reference. *//** Return the next reference in the chain, or {@code null} if none. *//** Release this entry and ensure that it will be returned from ... *//** A single map entry. ... */K key, ...;V previousEntry<> otherEntry/** A task that can be {@link Segment#doTask run} against a {@link Segment}. */EnumSet<TaskOption> options, ...;this.optionsTaskOption.class/** Execute the task. ... *//** Convenience method that can be used for tasks that do not need access to {@link Entries}. ... *//** Various options supported by a {@code Task}. */new TaskOption(...)TaskOption RESTRUCTURE_BEFORE, ...;TaskOption RESTRUCTURE_AFTER, ...;TaskOption SKIP_IF_EMPTY, ...;TaskOption RESIZE, ...;/** Allows a task access to {@link ConcurrentReferenceHashMap.Segment} entries. *//** Add a new entry with the specified value. ... *//** Internal entry-set implementation. */new EntryIterator(...)ConcurrentReferenceHashMap<>.thisRestructure.NEVEREntry<K,V> otherEntry/** Internal entry iterator implementation. */int segmentIndex, ...;int referenceIndex, ...;Reference<K,V> reference, ...;Entry<K,V> next, ...;Entry<K,V> last, ...;moveToNextSegment(...)getNextIfNecessary(...)this.nextthis.lastmoveToNextReference(...)this.referencethis.referenceIndexthis.segmentIndexConcurrentReferenceHashMap<>.this.segments.lengthConcurrentReferenceHashMap<>.this.segments...[...].references/** The types of restructuring that can be performed. */new Restructure(...)Restructure WHEN_NECESSARY, ...;Restructure NEVER, ...;/** Strategy class used to manage {@link Reference References}. ... */new ReferenceQueue<Entry<K,V>>(...)ReferenceQueue<Entry<K,V>> queue, ...;/** Factory method used to create a new {@link Reference}. ... */ConcurrentReferenceHashMap<>.this.referenceTypeReferenceType.WEAKnew WeakEntryReference<K,V>(...)new SoftEntryReference<K,V>(...)/** Return any reference that has been garbage collected and can be purged from the ... *//** Internal {@link Reference} implementation for {@link SoftReference SoftReferences}. */int hash, ...;Reference<K,V> nextReference, ...;this.nextReferenceenqueue(...)/** Internal {@link Reference} implementation for {@link WeakReference WeakReferences}. */// Use a local copy to protect against other threads writing// Recalculate taking into account count inside lock and items that// will be purged// Either create a new table or reuse the existing one// Restructure// Replace volatile members/** Simple customizable helper class for creating new {@link Thread} instances. ... */Thread.NORM_PRIORITYint threadPriority, ...;ThreadGroup threadGroup, ...;AtomicInteger threadCount, ...;/** Create a new CustomizableThreadCreator with default thread name prefix. */getDefaultThreadNamePrefix(...)/** Create a new CustomizableThreadCreator with the given thread name prefix. ... *//** Specify the prefix to use for the names of newly created threads. ... *//** Return the thread name prefix to use for the names of newly ... *//** Set the priority of the threads that this factory creates. ... */this.threadPriority/** Return the priority of the threads that this factory creates. *//** Set whether this factory is supposed to create daemon threads, ... *//** Return whether this factory should create daemon threads. *//** Specify the name of the thread group that threads should be created in. ... */this.threadGroupnew ThreadGroup(...)/** Specify the thread group that threads should be created in. ... *//** Return the thread group that threads should be created in ... *//** Template method for the creation of a new {@link Thread}. ... */getThreadGroup(...)nextThreadName(...)getThreadPriority(...)isDaemon(...)/** Return the thread name to use for a newly created {@link Thread}. ... */this.threadCount/** Build the default thread name prefix for this factory. ... *//** Default implementation of the {@link PropertiesPersister} interface. ... */import MessageDigestimport NoSuchAlgorithmException/** Miscellaneous methods for calculating digests. ... */String MD5_ALGORITHM_NAME, ...;...[] HEX_CHARS, ...;/** Calculate the MD5 digest of the given bytes. ... */digest(...)/** Calculate the MD5 digest of the given stream. ... *//** Return a hexadecimal string representation of the MD5 digest of the given bytes. ... */digestAsHexString(...)/** Return a hexadecimal string representation of the MD5 digest of the given stream. ... *//** Append a hexadecimal string representation of the MD5 digest of the given ... */appendDigestAsHex(...)/** Create a new {@link MessageDigest} with the given algorithm. ... */NoSuchAlgorithmException exgetDigest(...)MessageDigest messageDigestupdateMessageDigest(...)byte[] bufferchar[] hexDigestdigestAsHexChars(...)byte[] digestencodeHex(...)chars.length/** A strategy for handling errors. This is especially useful for handling ... *//** Handle the given error, possibly rethrowing it as a fatal exception. *//** An {@link InstanceFilter} implementation that handles exception types. A type ... *//** A speedy alternative to {@link java.io.ByteArrayOutputStream}. Note that ... */new ArrayDeque<byte[]>(...)int DEFAULT_BLOCK_SIZE, ...;Deque<byte[]> buffers, ...;// The buffers used to store the content bytesint initialBlockSize, ...;// The size, in bytes, to use when allocating the first byte[]int nextBlockSize, ...;// The size, in bytes, to use when allocating the next byte[]int alreadyBufferedSize, ...;// (The number of bytes in the current buffer is in 'index'.)// The number of bytes in previous buffers.// The index in the byte[] found at buffers.getLast() to be written next// Is the stream closed?/** Create a new <code>FastByteArrayOutputStream</code> ... */this.initialBlockSizethis.nextBlockSize// Overridden methodspeekLast(...)this.buffersgetLast(...).lengthgetLast(...)addBuffer(...)int copyLength/** Convert the buffer's contents into a string decoding bytes using the ... */toByteArrayUnsafe(...)/** Return the number of bytes stored in this <code>FastByteArrayOutputStream</code>. */// Custom methodsthis.alreadyBufferedSize/** Convert the stream's data to a byte array and return the byte array. ... */int totalSizeresize(...)/** Creates a newly allocated byte array. ... */byte[] bytesUnsafe/** Reset the contents of this <code>FastByteArrayOutputStream</code>. ... *//** Get an {@link InputStream} to retrieve the data in this OutputStream. ... */new FastByteArrayInputStream(...)/** Write the buffers content to the given OutputStream. ... */Iterator<byte[]> it/** Resize the internal buffer size to a specified capacity. ... */peekFirst(...)getFirst(...).length/** Create a new buffer and store it in the ArrayDeque. ... */nextPowerOf2(...)/** Get the next power of 2 of a number (ex, the next power of 2 of 119 is 128). *//** An implementation of {@link java.io.InputStream} that reads from a given ... */FastByteArrayOutputStream fastByteArrayOutputStream, ...;Iterator<byte[]> buffersIterator, ...;...[] currentBuffer, ...;int currentBufferLength, ...;int nextIndexInCurrentBuffer, ...;int totalBytesRead, ...;/** Create a new <code>FastByteArrayOutputStreamInputStream</code> backed ... */this.fastByteArrayOutputStreamthis.buffersIteratorfastByteArrayOutputStream.buffersthis.currentBufferthis.currentBufferLengthfastByteArrayOutputStream.indexthis.currentBuffer.lengththis.nextIndexInCurrentBufferthis.totalBytesReadupdateCurrentBufferLength(...)int bytesToCopyint lenint bytesToSkipskip(...)/** Update the message digest with the remaining bytes in this stream. ... *//** Update the message digest with the next len bytes in this stream. ... */this.fastByteArrayOutputStream.buffersthis.fastByteArrayOutputStream.index// store the byte// copy in the sub-array// do nothing - already at the targetCapacity// block size doubles each time// This stream doesn't have any data in it.../** Simple utility methods for file and stream copying. All copy methods use a block size ... */int BUFFER_SIZE, ...;/** The default buffer size used when copying bytes. *//** Copy the contents of the given input File to the given output File. ... */// Copy methods for java.io.File/** Copy the contents of the given byte array to the given output File. ... *//** Copy the contents of the given input File into a new byte array. ... *//** Copy the contents of the given InputStream to the given OutputStream. ... */// Copy methods for java.io.InputStream / java.io.OutputStream/** Copy the contents of the given byte array to the given OutputStream. ... *//** Copy the contents of the given InputStream into a new byte array. ... *//** Copy the contents of the given Reader to the given Writer. ... */// Copy methods for java.io.Reader / java.io.Writerint charCountint charsRead/** Copy the contents of the given String to the given Writer. ... *//** Copy the contents of the given Reader into a String. ... */StringWriter out/** Attempt to close the supplied {@link Closeable}, silently swallowing any ... */import FileVisitResultimport SimpleFileVisitorimport StandardCopyOptionimport BasicFileAttributesimport static FileVisitOption.FOLLOW_LINKS/** Utility methods for working with the file system. ... *//** Delete the supplied {@link File} - for directories, ... */deleteRecursively(...)/** Delete the supplied {@link File} &mdash; for directories, ... */walkFileTree(...)new SimpleFileVisitor<Path>(...) { ... }FileVisitResult.CONTINUE/** Recursively copy the contents of the {@code src} file/directory ... */copyRecursively(...)BasicFileAttributes srcAttrreadAttributes(...)BasicFileAttributes.classcreateDirectories(...)relativize(...)StandardCopyOption.REPLACE_EXISTINGisRegularFile(...)/** Contract for generating universally unique identifiers ({@link UUID UUIDs}). ... *//** Generate a new identifier. ... *//** A simple instance filter that checks if a given instance match based on ... */Collection<? extends T> includes, ...;Collection<? extends T> excludes, ...;boolean matchIfEmpty, ...;/** Create a new instance based on includes/excludes collections. ... */this.includesthis.excludesthis.matchIfEmpty/** Determine if the specified {code instance} matches this filter. */boolean includesSetboolean excludesSetboolean matchIncludesboolean matchExcludes/** Determine if the specified {@code instance} is equal to the ... *//** Determine if the specified {@code instance} matches one of the candidates. ... *//** Exception thrown from {@link MimeTypeUtils#parseMimeType(String)} in case of ... */String mimeType, ...;/** Create a new InvalidContentTypeException for the given content type. ... */this.mimeType/** Return the offending content type. *//** An {@link IdGenerator} that calls {@link java.util.UUID#randomUUID()}. ... *//** {@link LinkedHashMap} variant that stores String keys in a case-insensitive ... */LinkedHashMap<String,V> targetMap, ...;HashMap<String,String> caseInsensitiveKeys, ...;Set<String> keySet, ...;Collection<V> values, ...;Set<Entry<String,V>> entrySet, ...;/** Create a new LinkedCaseInsensitiveMap that stores case-insensitive keys ... *//** Create a new LinkedCaseInsensitiveMap that wraps a {@link LinkedHashMap} ... */this.targetMapnew LinkedHashMap<String,V>(...) { ... }CollectionUtils.DEFAULT_LOAD_FACTORLinkedCaseInsensitiveMap<>.thisMap<>.Entry<String,V>boolean doRemoveremoveEldestEntry(...)removeCaseInsensitiveKey(...)this.caseInsensitiveKeys/** Copy constructor. */other.targetMapother.caseInsensitiveKeysother.locale// Implementation of java.util.MapString caseInsensitiveKeyString oldKeyV oldKeyValuenew BiConsumer<? extends String,? extends V>(...) { ... }Set<String> keySetthis.keySetnew KeySet(...)Collection<V> valuesthis.valuesnew Values(...)Set<Entry<String,V>> entrySetnew LinkedCaseInsensitiveMap(...)/** Return the locale used by this {@code LinkedCaseInsensitiveMap}. ... */// Specific to LinkedCaseInsensitiveMap/** Convert the given key to a case-insensitive key. ... *//** Determine whether this map should remove the given eldest entry. ... */Set<String> delegate, ...;new KeySetIterator(...)Collection<V> delegate, ...;new ValuesIterator(...)Set<Entry<String,V>> delegate, ...;new EntrySetIterator(...)Iterator<Entry<String,V>> delegate, ...;Entry<String,V> last, ...;Entry<String,V> entrynextEntry(...)// equivalent to LinkedHashMap's initial capacity of 16/** Simple implementation of {@link MultiValueMap} that wraps a {@link LinkedHashMap}, ... *//** Create a new LinkedMultiValueMap that wraps a {@link LinkedHashMap}. */new LinkedHashMap<K,List<V>>(...)/** Create a new LinkedMultiValueMap that wraps a {@link LinkedHashMap} ... *//** Copy constructor: Create a new LinkedMultiValueMap with the same mappings as ... *//** Create a deep copy of this Map. ... */LinkedMultiValueMap copynew LinkedMultiValueMap(...)new BiConsumer<K,List<V>>(...) { ... }new ArrayList<V>(...)/** Create a regular copy of this Map. ... */// new public base class in 5.3/** Helper class that allows for specifying a method to invoke in a declarative ... */...[] EMPTY_ARGUMENTS, ...;String targetMethod, ...;String staticMethod, ...;Method methodObject, ...;/** The method we will call. *//** Set the target class on which to call the target method. ... *//** Return the target class on which to call the target method. *//** Set the target object on which to call the target method. ... *//** Return the target object on which to call the target method. *//** Set the name of the method to be invoked. ... *//** Return the name of the method to be invoked. *//** Set a fully qualified static method name to invoke, ... */this.staticMethod/** Set arguments for the method invocation. If this property is not set, ... *//** Return the arguments for the method invocation. *//** Prepare the specified method. ... */this.methodObject/** Resolve the given class name into a Class. ... *//** Find a matching method with the specified name for the specified arguments. ... *//** Return the prepared Method object that will be invoked. ... *//** Return whether this invoker has been prepared already, ... *//** Invoke the specified method. ... */Method preparedMethod/** Algorithm that judges the match between the declared parameter types of a candidate method ... */// Just rethrow exception if we can't get any match.// In the static case, target will simply be {@code null}./** Represents a MIME Type, as originally defined in RFC 2046 and subsequently ... */BitSet ctlBitSet separatorsandNot(...)String WILDCARD_TYPE, ...;String PARAM_CHARSET, ...;BitSet TOKEN, ...;String subtype, ...;Map<String,String> parameters, ...;Charset resolvedCharset, ...;/** Create a new {@code MimeType} for the given primary type. ... *//** Create a new {@code MimeType} for the given primary type and subtype. ... *//** Create a new {@code MimeType} for the given type, subtype, and character set. ... */this.resolvedCharset/** Copy-constructor that copies the type, subtype, parameters of the given {@code MimeType}, ... */getSubtype(...)addCharsetParameter(...)/** Copy-constructor that copies the type and subtype of the given {@code MimeType}, ... *//** Create a new {@code MimeType} for the given type, subtype, and parameters. ... */checkToken(...)this.subtypenew LinkedCaseInsensitiveMap<String>(...)checkParameters(...)this.parameters/** Copy-constructor that copies the type, subtype and parameters of the given {@code MimeType}, ... */other.subtypeother.parametersother.resolvedCharsetother.toStringValue/** Checks the given token string for illegal characters, as defined in RFC 2616, ... */unquote(...)isQuotedString(...)/** Indicates whether the {@linkplain #getType() type} is the wildcard character ... *//** Indicates whether the {@linkplain #getSubtype() subtype} is the wildcard ... *//** Indicates whether this MIME Type is concrete, i.e. whether neither the type ... */isWildcardType(...)isWildcardSubtype(...)/** Return the primary type. *//** Return the subtype. *//** Return the subtype suffix as defined in RFC 6839. ... */int suffixIndex/** Return the character set, as indicated by a {@code charset} parameter, if any. ... *//** Return a generic parameter value, given a parameter name. ... *//** Return all generic parameter values. ... *//** Indicate whether this MIME Type includes the given MIME Type. ... */int thisPlusIdxint otherPlusIdxString thisSubtypeNoSuffixString thisSubtypeSuffixString otherSubtypeSuffix/** Indicate whether this MIME Type is compatible with the given MIME Type. ... */String thisSuffixgetSubtypeSuffix(...)String otherSuffix/** Similar to {@link #equals(Object)} but based on the type and subtype ... *//** Unlike {@link Collection#contains(Object)} which relies on ... */MimeType mimeTypeequalsTypeAndSubtype(...)MimeType otherTypeparametersAreEqual(...)otherType.subtype/** Determine if the parameters in this {@code MimeType} and the supplied ... */appendTo(...)/** Compares this MIME Type to another alphabetically. ... */int compcompareToIgnoreCase(...)TreeSet<String> thisAttributesString.CASE_INSENSITIVE_ORDERTreeSet<String> otherAttributesIterator<String> thisAttributesIteratorIterator<String> otherAttributesIteratorString thisAttributeString otherAttributeCharset thisCharsetCharset otherCharsetString thisValueString otherValueString charsetName/** Parse the given String value into a {@code MimeType} object, ... */parseMimeType(...)/** Comparator to sort {@link MimeType MimeTypes} in order of specificity. ... */compareParameters(...)int paramsSize1int paramsSize2// variable names refer to RFC 2616, section 2.2// */* includes anything// Wildcard with suffix, e.g. application/*+xml// application/*+xml includes application/soap+xml// */* < audio/*// audio/* > */*// audio/basic == text/html// mediaType1.getType().equals(mediaType2.getType())// audio/* < audio/basic// audio/basic > audio/*// audio/basic == audio/wave// mediaType2.getSubtype().equals(mediaType2.getSubtype())// audio/basic;level=1 < audio/basicimport UnsupportedCharsetException/** Miscellaneous {@link MimeType} utility methods. ... */new SpecificityComparator<MimeType>(...)MimeType.SpecificityComparator<MimeType>new ConcurrentLruCache<String,MimeType>(...)new Function<String,MimeType>(...) { ... }parseMimeTypeInternal(...)...[] BOUNDARY_CHARS, ...;Comparator<MimeType> SPECIFICITY_COMPARATOR, ...;/** Comparator used by {@link #sortBySpecificity(List)}. */MimeType ALL, ...;/** Public constant mime type that includes all media ranges (i.e. "&#42;/&#42;"). */String ALL_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#ALL}. */MimeType APPLICATION_JSON, ...;/** Public constant mime type for {@code application/json}. */String APPLICATION_JSON_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#APPLICATION_JSON}. */MimeType APPLICATION_OCTET_STREAM, ...;/** Public constant mime type for {@code application/octet-stream}. */String APPLICATION_OCTET_STREAM_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#APPLICATION_OCTET_STREAM}. */MimeType APPLICATION_XML, ...;/** Public constant mime type for {@code application/xml}. */String APPLICATION_XML_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#APPLICATION_XML}. */MimeType IMAGE_GIF, ...;/** Public constant mime type for {@code image/gif}. */String IMAGE_GIF_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#IMAGE_GIF}. */MimeType IMAGE_JPEG, ...;/** Public constant mime type for {@code image/jpeg}. */String IMAGE_JPEG_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#IMAGE_JPEG}. */MimeType IMAGE_PNG, ...;/** Public constant mime type for {@code image/png}. */String IMAGE_PNG_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#IMAGE_PNG}. */MimeType TEXT_HTML, ...;/** Public constant mime type for {@code text/html}. */String TEXT_HTML_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#TEXT_HTML}. */MimeType TEXT_PLAIN, ...;/** Public constant mime type for {@code text/plain}. */String TEXT_PLAIN_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#TEXT_PLAIN}. */MimeType TEXT_XML, ...;/** Public constant mime type for {@code text/xml}. */String TEXT_XML_VALUE, ...;/** A String equivalent of {@link MimeTypeUtils#TEXT_XML}. */ConcurrentLruCache<String,MimeType> cachedMimeTypes, ...;/** Parse the given String into a single {@code MimeType}. ... */new InvalidMimeTypeException(...)String fullTypeint subIndexString subtypeMap<String,String> parametersMimeType.WILDCARD_TYPEboolean quotedString parameterint eqIndexUnsupportedCharsetException exgetCharsetName(...)/** Parse the comma-separated string into a list of {@code MimeType} objects. ... */tokenize(...)/** Tokenize the given comma-separated string of {@code MimeType} objects ... */List<String> tokensboolean inQuotes/** Return a string representation of the given list of {@code MimeType} objects. ... */Iterator<? extends MimeType> iterator/** Sorts the given list of {@code MimeType} objects by specificity. ... *//** Lazily initialize the {@link SecureRandom} for {@link #generateMultipartBoundary()}. */Random randomToUseMimeTypeUtils.class/** Generate a random MIME boundary as bytes, often used in multipart mime types. */initRandom(...)byte[] boundarynextInt(...)boundary.lengthBOUNDARY_CHARS.length/** Generate a random MIME boundary as String, often used in multipart mime types. */generateMultipartBoundary(...)// Not using "parseMimeType" to avoid static init cost// do not cache multipart mime types with random boundaries// java.net.HttpURLConnection returns a *; q=.2 Accept header/** Extension of the {@code Map} interface that stores multiple values. ... *//** Return the first value for the given key. ... *//** Add the given single value to the current list of values for the given key. ... *//** Add all the values of the given list to the current list of values for the given key. ... *//** Add all the values of the given {@code MultiValueMap} to the current values. ... *//** {@link #add(Object, Object) Add} the given value, only when the map does not ... *//** Set the given single value under the given key. ... *//** Set the given values under. ... *//** Return a {@code Map} with the first values contained in this {@code MultiValueMap}. ... *//** Adapts a given {@link Map} to the {@link MultiValueMap} contract. ... */Map<K,List<V>> targetMap, ...;/** Wrap the given target {@link Map} as a {@link MultiValueMap} adapter. ... */// MultiValueMap implementationList<V> valuesnew Function<K,List<V>>(...) { ... }List<V> currentValuesEntry<K,List<V>> entrynew BiConsumer<K,V>(...) { ... }Map<K,V> singleValueMap// Map implementation/** Miscellaneous utility methods for number conversion and parsing. ... */Set<Class<?>> numberTypesBigInteger LONG_MIN, ...;BigInteger LONG_MAX, ...;Set<Class<?>> STANDARD_NUMBER_TYPES, ...;/** Standard number types (all immutable): ... *//** Convert the given number into an instance of the given target class. ... */long valuecheckedLongValue(...)Byte.MIN_VALUEraiseOverflowException(...)toBigInteger(...)/** Check for a {@code BigInteger}/{@code BigDecimal} long overflow ... */BigInteger bigInt/** Raise an <em>overflow</em> exception for the given number and target class. ... *//** Parse the given {@code text} into a {@link Number} instance of the given ... */String trimmedisHexNumber(...)decodeBigInteger(...)/** Parse the given {@code text} into a {@link Number} instance of the ... */boolean resetBigDecimalisParseBigDecimal(...)/** Determine whether the given {@code value} String indicates a hex number, ... *//** Decode a {@link java.math.BigInteger} from the supplied {@link String} value. ... */int radixboolean negativeBigInteger result// do not lose precision - use BigDecimal's own conversion// original value is not a Big* number - use standard long conversion// always use BigDecimal(String) here to avoid unpredictability of BigDecimal(double)// (see BigDecimal javadoc for details)// Effectively analogous to JDK 8's BigInteger.longValueExact()// Handle minus sign, if present.// Handle radix specifier, if present./** Miscellaneous object utility methods. ... */int INITIAL_HASH, ...;int MULTIPLIER, ...;String EMPTY_STRING, ...;String NULL_STRING, ...;String ARRAY_START, ...;String ARRAY_END, ...;String EMPTY_ARRAY, ...;String ARRAY_ELEMENT_SEPARATOR, ...;...[] EMPTY_OBJECT_ARRAY, ...;/** Return whether the given throwable is a checked exception: ... *//** Check whether the given exception is compatible with the specified ... */isCheckedException(...)Class<?> declaredException/** Determine whether the given object is an array: ... *//** Determine whether the given array is empty: ... *//** Determine whether the given object is empty. ... *//** Unwrap the given object which is potentially a {@link java.util.Optional}. ... */Optional<?> optional/** Check whether the given array contains the given element. ... */Object arrayEle/** Check whether the given array of enum constants contains a constant with the given name, ... */containsConstant(...)/** Check whether the given array of enum constants contains a constant with the given name. ... */Enum<?> candidate/** Case insensitive alternative to {@link Enum#valueOf(Class, String)}. ... */E candidate/** Append the given object to the given array, returning a new array ... */Class<?> compTypeint newArrLengthA[] newArrnewArr.length/** Convert the given array (which may be a primitive array) to an ... */Class<?> wrapperType/** Determine if the given objects are equal, returning {@code true} if ... */// Convenience methods for content-based equality/hash-code handlingarrayEquals(...)/** Compare the given arrays with {@code Arrays.equals}, performing an equality ... *//** Return as hash code for the given object; typically the value of ... *//** Return a hash code based on the contents of the specified array. ... */boolean elementbyte elementchar elementdouble elementfloat elementint elementlong elementshort element/** Return the same value as {@link Boolean#hashCode(boolean)}}. ... *//** Return the same value as {@link Double#hashCode(double)}}. ... *//** Return the same value as {@link Float#hashCode(float)}}. ... *//** Return the same value as {@link Long#hashCode(long)}}. ... *//** Return a String representation of an object's overall identity. ... */// Convenience methods for toString output/** Return a hex String form of an object's identity hash code. ... *//** Return a content-based String representation if {@code obj} is ... *//** Determine the class name for the given object. ... *//** Return a String representation of the specified Object. ... *//** Return a String representation of the contents of the specified array. ... */double dfloat flong lshort s/** Strategy interface for {@code String}-based path matching. ... *//** Does the given {@code path} represent a pattern that can be matched ... *//** Match the given {@code path} against the given {@code pattern}, ... *//** Match the given {@code path} against the corresponding part of the given ... *//** Given a pattern and a full path, determine the pattern-mapped part. ... *//** Given a pattern and a full path, extract the URI template variables. URI template ... *//** Given a full path, returns a {@link Comparator} suitable for sorting patterns ... *//** Combines two patterns into a new pattern that is returned. ... *//** Utility methods for simple pattern matching, in particular for ... *//** Match a String against the given pattern, supporting the following simple ... */int firstIndexString partint partIndex/** Match a String against the given patterns, supporting the following simple ... *//** Strategy interface for persisting {@code java.util.Properties}, ... *//** Load properties from the given InputStream into the given ... *//** Load properties from the given Reader into the given ... *//** Write the contents of the given Properties object to the ... *//** Load properties from the given XML InputStream into the ... *//** Utility class for working with Strings that have placeholder values in them. A placeholder takes the form ... */PropertyPlaceholderHelper.classMap<String,String> wellKnownSimplePrefixes, ...;String simplePrefix, ...;/** Creates a new {@code PropertyPlaceholderHelper} that uses the supplied prefix and suffix. ... */String simplePrefixForSuffixthis.simplePrefix/** Replaces all placeholders of format {@code ${name}} with the corresponding ... *//** Replaces all placeholders of format {@code ${name}} with the value returned ... */parseStringValue(...)findPlaceholderEndIndex(...)String placeholderString originalPlaceholderString actualPlaceholderint withinNestedPlaceholdersubstringMatch(...)/** Strategy interface used to resolve replacement values for placeholders contained in Strings. *//** Resolve the supplied placeholder name to the replacement value. ... */// Recursive invocation, parsing placeholders contained in the placeholder key.// Now obtain the value for the fully resolved key...// Recursive invocation, parsing placeholders contained in the// previously resolved placeholder value.// Proceed with unprocessed value./** Simple utility class for working with the reflection API and handling ... */new FieldFilter(...) { ... }new Field[]new ConcurrentReferenceHashMap<Class<?>,Field[]>(...)MethodFilter USER_DECLARED_METHODS, ...;/** Pre-built MethodFilter that matches all non-bridge non-synthetic methods ... */FieldFilter COPYABLE_FIELDS, ...;/** Pre-built FieldFilter that matches all non-static, non-final fields. */String CGLIB_RENAMED_METHOD_PREFIX, ...;/** Naming prefix for CGLIB-renamed methods. ... */...[] EMPTY_METHOD_ARRAY, ...;...[] EMPTY_FIELD_ARRAY, ...;Map<Class<?>,Method[]> declaredMethodsCache, ...;/** Cache for {@link Class#getDeclaredMethods()} plus equivalent default methods ... */Map<Class<?>,Field[]> declaredFieldsCache, ...;/** Cache for {@link Class#getDeclaredFields()}, allowing for fast iteration. *//** Handle the given reflection exception. ... */// Exception handling/** Handle the given invocation target exception. Should only be called if no ... *//** Rethrow the given {@link Throwable exception}, which is presumably the ... *//** Obtain an accessible constructor for the given class and parameters. ... */// Constructor handling/** Make the given constructor accessible, explicitly setting it accessible ... *//** Attempt to find a {@link Method} on the supplied class with the supplied name ... */// Method handlingClass<?> searchTypehasSameParams(...)/** Invoke the specified {@link Method} against the supplied target object with no arguments. ... *//** Invoke the specified {@link Method} against the supplied target object with the ... *//** Determine whether the given method explicitly declares the given ... */Class<?>[] declaredExceptions/** Perform the given callback operation on all matching methods of the given ... */doWith(...)Class<?> superIfc/** Get all declared methods on the leaf class and all superclasses. ... *//** Get the unique set of declared methods on the leaf class and all superclasses. ... */boolean knownSignatureMethod methodBeingOverriddenWithCovariantReturnTypeMethod existingMethodisCglibRenamedMethod(...)/** Variant of {@link Class#getDeclaredMethods()} that uses a local cache in ... */List<Method> defaultMethodsfindConcreteMethodsOnInterfaces(...)declaredMethods.lengthMethod defaultMethodList<Method> result/** Determine whether the given method is originally declared by {@link java.lang.Object}. *//** Determine whether the given method is a CGLIB 'renamed' method, ... */isDigit(...)/** Make the given method accessible, explicitly setting it accessible if ... *//** Attempt to find a {@link Field field} on the supplied {@link Class} with the ... */// Field handling/** Set the field represented by the supplied {@linkplain Field field object} on ... *//** Get the field represented by the supplied {@link Field field object} on the ... *//** Invoke the given callback on all locally declared fields in the given class. ... *//** Invoke the given callback on all fields in the target class, going up the ... *//** This variant retrieves {@link Class#getDeclaredFields()} from a local cache ... */Field[] result/** Given the source object and the destination, which must be the same class ... */Object srcValue/** Determine whether the given field is a "public static final" constant. ... *//** Make the given field accessible, explicitly setting it accessible if ... *//** Clear the internal method/field cache. ... */// Cache handling/** Action to take on each method. *//** Perform an operation using the given method. ... *//** Callback optionally used to filter methods to be operated on by a method callback. *//** Determine whether the given method matches. ... *//** Create a composite filter based on this filter <em>and</em> the provided filter. ... *//** Callback interface invoked on each field in the hierarchy. *//** Perform an operation using the given field. ... *//** Callback optionally used to filter fields to be operated on by a field callback. *//** Determine whether the given field matches. ... */// Keep backing up the inheritance hierarchy.// Is this a covariant return type situation?/** An extension of {@link java.io.ByteArrayOutputStream} that: ... *//** Create a new <code>ResizableByteArrayOutputStream</code> ... */byte[] resizedBufferthis.buf/** Grow the internal buffer size. ... */this.buf.length/** Return the current size of this stream's internal buffer. *//** Utility methods for resolving resource locations to files in the ... */String FILE_URL_PREFIX, ...;/** URL prefix for loading from the file system: "file:". */String JAR_URL_PREFIX, ...;/** URL prefix for loading from a jar file: "jar:". */String WAR_URL_PREFIX, ...;/** URL prefix for loading from a war file on Tomcat: "war:". */String URL_PROTOCOL_FILE, ...;/** URL protocol for a file in the file system: "file". */String URL_PROTOCOL_JAR, ...;/** URL protocol for an entry from a jar file: "jar". */String URL_PROTOCOL_WAR, ...;/** URL protocol for an entry from a war file: "war". */String URL_PROTOCOL_ZIP, ...;/** URL protocol for an entry from a zip file: "zip". */String URL_PROTOCOL_WSJAR, ...;/** URL protocol for an entry from a WebSphere jar file: "wsjar". */String URL_PROTOCOL_VFSZIP, ...;/** URL protocol for an entry from a JBoss jar file: "vfszip". */String URL_PROTOCOL_VFSFILE, ...;/** URL protocol for a JBoss file system resource: "vfsfile". */String URL_PROTOCOL_VFS, ...;/** URL protocol for a general JBoss VFS resource: "vfs". */String JAR_FILE_EXTENSION, ...;/** File extension for a regular jar file: ".jar". */String JAR_URL_SEPARATOR, ...;/** Separator between JAR URL and file path within the JAR: "!/". */String WAR_URL_SEPARATOR, ...;/** Special separator between WAR URL and jar part on Tomcat. *//** Return whether the given resource location is a URL: ... *//** Resolve the given resource location to a {@code java.net.URL}. ... */MalformedURLException ex2/** Resolve the given resource location to a {@code java.io.File}, ... *//** Resolve the given resource URL to a {@code java.io.File}, ... *//** Resolve the given resource URI to a {@code java.io.File}, ... *//** Determine whether the given URL points to a resource in the file system, ... *//** Determine whether the given URL points to a resource in a jar file. ... *//** Determine whether the given URL points to a jar file itself, ... *//** Extract the URL for the actual jar file from the given URL ... */String jarFile/** Extract the URL for the outermost archive from the given jar/war URL ... */String warFileextractJarFileURL(...)/** Create a URI instance for the given URL, ... *//** Create a URI instance for the given location String, ... *//** Set the {@link URLConnection#setUseCaches "useCaches"} flag on the ... */// try URL// no URL -> treat as file path// Probably no protocol in original jar URL, like "jar:C:/mypath/myjar.jar".// This usually indicates that the jar file resides in the file system.// Tomcat's "war:file:...mywar.war*/WEB-INF/lib/myjar.jar!/myentry.txt"// Regular "jar:file:...myjar.jar!/myentry.txt"/** Contract for matching routes to patterns. ... *//** Return a parsed representation of the given route. ... *//** Whether the given {@code route} contains pattern syntax which requires ... *//** Combines two patterns into a single pattern. ... *//** Match the given route against the given pattern. ... *//** Match the pattern to the route and extract template variables. ... *//** Given a route, return a {@link Comparator} suitable for sorting patterns ... *//** A parsed representation of a route. *//** The original route value. *//** Static utilities for serialization and deserialization. ... *//** Serialize the given object to a byte array. ... *//** Deserialize the byte array into an object. ... *//** A simple {@link IdGenerator} that starts at 1, increments up to ... */AtomicLong leastSigBits, ...;this.leastSigBits/** {@code RouteMatcher} that delegates to a {@link PathMatcher}. ... *//** Create a new {@code SimpleRouteMatcher} for the given ... *//** Return the underlying {@link PathMatcher} delegate. */new DefaultRoute(...)combine(...)extractUriTemplateVariables(...)getPatternComparator(...)import DatagramSocketimport InetAddressimport ServerSocketimport ServerSocketFactory/** Simple utility methods for working with network sockets &mdash; for example, ... */nanoTime(...)int PORT_RANGE_MIN, ...;/** The default minimum value for port ranges used when finding an available ... */int PORT_RANGE_MAX, ...;/** The default maximum value for port ranges used when finding an available ... *//** Although {@code SocketUtils} consists solely of static utility methods, ... *//** Find an available TCP port randomly selected from the range ... */findAvailablePort(...)SocketType.TCP/** Find the requested number of available TCP ports, each randomly selected ... */findAvailableTcpPorts(...)findAvailablePorts(...)/** Find an available UDP port randomly selected from the range ... */findAvailableUdpPort(...)SocketType.UDP/** Find the requested number of available UDP ports, each randomly selected ... */findAvailableUdpPorts(...)new SocketType(...) { ... }ServerSocket serverSocketcreateServerSocket(...)getByName(...)DatagramSocket socketnew DatagramSocket(...)SocketType TCP, ...;SocketType UDP, ...;/** Determine if the specified port for this {@code SocketType} is ... *//** Find a pseudo-random port number within the range ... */int portRange/** Find an available port for this {@code SocketType}, randomly selected ... */int candidatePortint searchCounterfindRandomPort(...)isPortAvailable(...)/** Find the requested number of available ports for this {@code SocketType}, ... */SortedSet<Integer> availablePortsnew TreeSet<Integer>(...)int attemptCount/** Simple stop watch, allowing for timing of a number of tasks, exposing total ... */new ArrayList<TaskInfo>(...)/** Identifier of this {@code StopWatch}. ... */boolean keepTaskList, ...;List<TaskInfo> taskList, ...;long startTimeNanos, ...;/** Start time of the current task. */String currentTaskName, ...;/** Name of the current task. */TaskInfo lastTaskInfo, ...;int taskCount, ...;long totalTimeNanos, ...;/** Total running time. *//** Construct a new {@code StopWatch}. ... *//** Construct a new {@code StopWatch} with the given ID. ... *//** Get the ID of this {@code StopWatch}, as specified on construction. ... *//** Configure whether the {@link TaskInfo} array is built over time. ... */this.keepTaskList/** Start an unnamed task. ... *//** Start a named task. ... */this.currentTaskNamethis.startTimeNanos/** Stop the current task. ... */long lastTimethis.totalTimeNanosthis.lastTaskInfonew TaskInfo(...)this.taskListthis.taskCount/** Determine whether this {@code StopWatch} is currently running. ... *//** Get the name of the currently running task, if any. ... *//** Get the time taken by the last task in nanoseconds. ... */getTimeNanos(...)/** Get the time taken by the last task in milliseconds. ... */getTimeMillis(...)/** Get the name of the last task. */getTaskName(...)/** Get the last task as a {@link TaskInfo} object. *//** Get the total time in nanoseconds for all tasks. ... *//** Get the total time in milliseconds for all tasks. ... */nanosToMillis(...)/** Get the total time in seconds for all tasks. ... */nanosToSeconds(...)/** Get the number of tasks timed. *//** Get an array of the data for tasks performed. */new TaskInfo[]/** Get a short description of the total running time. */getTotalTimeNanos(...)/** Generate a string with a table describing all tasks performed. ... */NumberFormat pfsetMinimumIntegerDigits(...)setGroupingUsed(...)TaskInfo taskgetTaskInfo(...)/** Generate an informative string describing all tasks performed ... */long percentround(...)TimeUnit.NANOSECONDS/** Nested class to hold data about one task executed within the {@code StopWatch}. */String taskName, ...;long timeNanos, ...;this.taskNamethis.timeNanos/** Get the name of this task. *//** Get the time in nanoseconds this task took. ... *//** Get the time in milliseconds this task took. ... *//** Get the time in seconds this task took. ... */import FilterInputStreamimport FilterOutputStreamimport OutputStreamWriter/** Simple utility methods for dealing with streams. The copy methods of this class are ... */...[] EMPTY_CONTENT, ...;/** Copy the contents of the given InputStream into a String. ... */StringBuilder outInputStreamReader reader/** Copy the contents of the given {@link ByteArrayOutputStream} into a {@link String}. ... *//** Copy the contents of the given String to the given OutputStream. ... */Writer writernew OutputStreamWriter(...)/** Copy a range of content of the given InputStream to the given OutputStream. ... */long skippedlong bytesToCopy/** Drain the remaining content of the given InputStream. ... *//** Return an efficient empty {@link InputStream}. ... *//** Return a variant of the given {@link InputStream} where calling ... */new NonClosingInputStream(...)/** Return a variant of the given {@link OutputStream} where calling ... */new NonClosingOutputStream(...)this.out// Can be replaced with toString(Charset) call in Java 10+// Should never happen// It is critical that we override this method for performance/** Miscellaneous {@link String} utility methods. ... */...[] EMPTY_STRING_ARRAY, ...;String FOLDER_SEPARATOR, ...;String WINDOWS_FOLDER_SEPARATOR, ...;String TOP_PATH, ...;String CURRENT_PATH, ...;char EXTENSION_SEPARATOR, ...;/** Check whether the given object (possibly a {@code String}) is empty. ... */// General convenience methods for working with Strings/** Check that the given {@code CharSequence} is neither {@code null} nor ... *//** Check that the given {@code String} is neither {@code null} nor of length 0. ... *//** Check whether the given {@code CharSequence} contains actual <em>text</em>. ... */containsText(...)/** Check whether the given {@code String} contains actual <em>text</em>. ... */int strLenisWhitespace(...)/** Check whether the given {@code CharSequence} contains any whitespace characters. ... *//** Check whether the given {@code String} contains any whitespace characters. ... */containsWhitespace(...)/** Trim leading and trailing whitespace from the given {@code String}. ... *//** Trim <i>all</i> whitespace from the given {@code String}: ... *//** Trim leading whitespace from the given {@code String}. ... */int beginIdx/** Trim trailing whitespace from the given {@code String}. ... */int endIdx/** Trim all occurrences of the supplied leading character from the given {@code String}. ... *//** Trim all occurrences of the supplied trailing character from the given {@code String}. ... *//** Test if the given {@code String} matches the given single character. ... *//** Test if the given {@code String} starts with the specified prefix, ... *//** Test if the given {@code String} ends with the specified suffix, ... *//** Test whether the given string matches the given substring ... *//** Count the occurrences of the substring {@code sub} in string {@code str}. ... *//** Replace all occurrences of a substring within a string with another string. ... */int patLen/** Delete all occurrences of the given substring. ... *//** Delete any character in a given {@code String}. ... */int lastCharIndex/** Quote the given {@code String} with single quotes. ... */// Convenience methods for working with formatted Strings/** Turn the given Object into a {@code String} with single quotes ... *//** Unqualify a string qualified by a '.' dot character. For example, ... */unqualify(...)/** Unqualify a string qualified by a separator character. For example, ... *//** Capitalize a {@code String}, changing the first letter to ... */changeFirstCharacterCase(...)/** Uncapitalize a {@code String}, changing the first letter to ... */char baseCharchar updatedChar/** Extract the filename from the given Java resource path, ... *//** Extract the filename extension from the given Java resource path, ... */int extIndexint folderIndex/** Strip the filename extension from the given Java resource path, ... *//** Apply the given relative path to the given Java resource path, ... */String newPath/** Normalize the path by suppressing sequences like "path/.." and ... */String[] pathArrayDeque<String> pathElementsint topspathArray.length/** Compare two paths after normalization of them. ... *//** Decode the given encoded URI component value. Based on the following rules: ... */boolean changedint chchar hex1char hex2int udigit(...)int l/** Parse the given {@code String} value into a {@link Locale}, accepting ... */tokenizeLocaleSource(...)Locale resolvedforLanguageTag(...)validateLocalePart(...)parseLocaleTokens(...)/** Parse the given {@code String} representation into a {@link Locale}. ... */int endIndexOfCountryCodetrimLeadingWhitespace(...)trimLeadingCharacter(...)isLetterOrDigit(...)/** Determine the RFC 3066 compliant language tag, ... *//** Parse the given {@code timeZoneString} value into a {@link TimeZone}. ... *//** Copy the given {@link Collection} into a {@code String} array. ... */// Convenience methods for working with String arrays/** Copy the given {@link Enumeration} into a {@code String} array. ... *//** Append the given {@code String} to the given {@code String} array, ... */String[] newArr/** Concatenate the given {@code String} arrays into one, ... */array1.lengtharray2.length/** Merge the given {@code String} arrays into one, with overlapping ... *//** Sort the given {@code String} array if necessary. ... *//** Trim the elements of the given {@code String} array, calling ... *//** Remove duplicate strings from the given array. ... *//** Split a {@code String} at the first occurrence of the delimiter. ... */String beforeDelimiterString afterDelimiter/** Take an array of strings and split each element based on the given delimiter. ... */splitArrayElementsIntoProperties(...)String[] splittedElement/** Tokenize the given {@code String} into a {@code String} array via a ... *//** Take a {@code String} that is a delimited list and convert it into a ... *//** Take a {@code String} that is a delimited list and convert it into ... */int delPos/** Convert a comma delimited list (e.g., a row from a CSV file) into an ... *//** Convert a comma delimited list (e.g., a row from a CSV file) into a set. ... *//** Convert a {@link Collection} to a delimited {@code String} (e.g. CSV). ... *//** Convert a {@code Collection} into a delimited {@code String} (e.g. CSV). ... *//** Convert a {@code Collection} into a delimited {@code String} (e.g., CSV). ... *//** Convert a {@code String} array into a delimited {@code String} (e.g. CSV). ... *//** Convert a {@code String} array into a comma delimited {@code String} ... */// no occurrence -> can return input as-is// our position in the old string// append any characters to the right of a match// Shortcut if there is no work to do// Strip prefix from path to analyze, to not treat it as part of the// first path element. This is necessary to correctly parse paths like// "file:core/../core/io/Resource.class", where the ".." should just// strip the first "core" directory while keeping the "file:" prefix.// Points to current directory - drop it.// Registering top path found.// Merging path element with element corresponding to top path.// Normal path element found.// All path elements stayed the same - shortcut// Remaining top paths need to be retained.// If nothing else left, at least explicitly point to current path.// There is definitely a variant, and it is everything after the country// code sans the separator between the country code and the variant.// Strip off any leading '_' and whitespace, what's left is the variant.// We don't want that GMT fallback...// Add rest of String, but not in case of empty input./** Simple strategy interface for resolving a String value. ... *//** Helper class for resolving placeholders in texts. Usually applied to file paths. ... */String PLACEHOLDER_PREFIX, ...;/** Prefix for system property placeholders: "${". */String PLACEHOLDER_SUFFIX, ...;/** Suffix for system property placeholders: "}". */String VALUE_SEPARATOR, ...;/** Value separator for system property placeholders: ":". *//** Resolve {@code ${...}} placeholders in the given text, replacing them with ... */PropertyPlaceholderHelper helpernew SystemPropertyPlaceholderResolver(...)/** PlaceholderResolver implementation that resolves against system properties ... */PropertyPlaceholderHelper.PlaceholderResolver// Fall back to searching the system environment./** Utility to work with Java 5 generic type parameters. ... */Class<?> lhsClassType rhsRawType rhsComponentType lhsRawType lhsComponentClass<?> rhsClassType[] lhsTypeArgumentsType[] rhsTypeArgumentslhsTypeArguments.lengthrhsTypeArguments.lengthType lhsArgType rhsArgType[] lUpperBoundsType[] lLowerBoundslUpperBounds.lengthlLowerBounds.lengthWildcardType rhsWcTypeType[] rUpperBoundsType[] rLowerBoundsrUpperBounds.lengthrLowerBounds.lengthType lBoundType rBoundisAssignableBound(...)// all types are assignable to themselves and to class Object// just comparing two classes// a parameterized type is always assignable to its raw class type// parameterized types are only assignable to other parameterized types and class types// supply the implicit upper bound if none are specified// supply the implicit lower bound if none are specified// both the upper and lower bounds of the right-hand side must be// completely enclosed in the upper and lower bounds of the left-// hand side./** Extension of {@link java.io.InputStream} that allows for optimized ... *//** Update the message digest with the rest of the bytes in this stream. ... */int data/** Provide a {@link BackOffExecution} that indicates the rate at which ... *//** Start a new back off execution. ... *//** Represent a particular back-off execution. ... */long STOP, ...;/** Return value of {@link #nextBackOff()} that indicates that the operation ... *//** Return the number of milliseconds to wait before retrying the operation ... *//** Implementation of {@link BackOff} that increases the back off period for each ... */long DEFAULT_INITIAL_INTERVAL, ...;/** The default initial interval. */double DEFAULT_MULTIPLIER, ...;/** The default multiplier (increases the interval by 50%). */long DEFAULT_MAX_INTERVAL, ...;/** The default maximum back off time. */long DEFAULT_MAX_ELAPSED_TIME, ...;/** The default maximum elapsed time. */long initialInterval, ...;double multiplier, ...;long maxInterval, ...;long maxElapsedTime, ...;/** Create an instance with the default settings. ... *//** Create an instance with the supplied settings. ... */checkMultiplier(...)this.initialInterval/** The initial interval in milliseconds. *//** Return the initial interval in milliseconds. *//** The value to multiply the current interval by for each retry attempt. *//** Return the value to multiply the current interval by for each retry attempt. *//** The maximum back off time. */this.maxInterval/** Return the maximum back off time. *//** The maximum elapsed time in milliseconds after which a call to ... */this.maxElapsedTime/** Return the maximum elapsed time in milliseconds after which a call to ... */new ExponentialBackOffExecution(...)long currentInterval, ...;long currentElapsedTime, ...;long nextIntervalcomputeNextInterval(...)this.currentElapsedTimelong maxIntervalgetMaxInterval(...)this.currentIntervallong initialIntervalgetInitialInterval(...)multiplyInterval(...)long igetMultiplier(...)/** A simple {@link BackOff} implementation that provides a fixed interval ... */long DEFAULT_INTERVAL, ...;/** The default recovery interval: 5000 ms = 5 seconds. */long UNLIMITED_ATTEMPTS, ...;/** Constant value indicating an unlimited number of attempts. */long maxAttempts, ...;/** Create an instance with an interval of {@value #DEFAULT_INTERVAL} ... *//** Create an instance. ... */this.maxAttempts/** Set the interval between two attempts in milliseconds. *//** Return the interval between two attempts in milliseconds. *//** Set the maximum number of attempts in milliseconds. *//** Return the maximum number of attempts in milliseconds. */new FixedBackOffExecution(...)long currentAttempts, ...;this.currentAttemptsgetMaxAttempts(...)String attemptValueFixedBackOff.this.maxAttemptsFixedBackOff.thisFixedBackOff.this.interval/** A generic back-off abstraction. *//** A {@link Comparator} for {@link Boolean} objects that can sort either ... */new BooleanComparator(...)BooleanComparator TRUE_LOW, ...;/** A shared default instance of this comparator, ... */BooleanComparator TRUE_HIGH, ...;boolean trueLow, ...;/** Create a BooleanComparator that sorts boolean values based on ... */this.trueLow(...).trueLow/** Comparator that adapts Comparables to the Comparator interface. ... */new ComparableComparator<>(...)ComparableComparator<> INSTANCE, ...;/** A shared instance of this default comparator. ... *//** Convenient entry point with generically typed factory methods ... *//** Return a {@link Comparable} adapter. ... */ComparableComparator<>.INSTANCE/** Return a {@link Comparable} adapter which accepts ... */NullSafeComparator<>.NULLS_LOW/** Return a decorator for the given comparator which accepts ... */new NullSafeComparator<T>(...)NullSafeComparator<>.NULLS_HIGH/** A comparator that chains a sequence of one or more Comparators. ... */List<InvertibleComparator<>> comparators, ...;/** Construct a CompoundComparator with initially no Comparators. Clients ... */this.comparatorsnew ArrayList<InvertibleComparator<>>(...)/** Construct a CompoundComparator from the Comparators in the provided array. ... */comparators.lengthComparator<> comparatoraddComparator(...)/** Add a Comparator to the end of the chain. ... */new InvertibleComparator<>(...)/** Add a Comparator to the end of the chain using the provided sort order. ... *//** Replace the Comparator at the given index. ... *//** Replace the Comparator at the given index using the given sort order. ... */new InvertibleComparator<T>(...)/** Invert the sort order of each sort definition contained by this compound ... */InvertibleComparator<> comparatorinvertOrder(...)/** Invert the sort order of the sort definition at the specified index. ... *//** Change the sort order at the given index to ascending. ... */setAscending(...)/** Change the sort order at the given index to descending sort. ... *//** Returns the number of aggregated comparators. */(...).comparators/** Compares objects based on an arbitrary class order. Allows objects to be sorted based ... */...[] instanceOrder, ...;/** Create a new {@link InstanceComparator} instance. ... */this.instanceOrderthis.instanceOrder.length/** A decorator for a comparator, with an "ascending" flag denoting ... *//** Create an InvertibleComparator that sorts ascending by default. ... *//** Create an InvertibleComparator that sorts based on the provided order. ... *//** Specify the sort order: ascending (true) or descending (false). *//** Return the sort order: ascending (true) or descending (false). *//** Invert the sort order: ascending -> descending or ... */InvertibleComparator otherCompotherComp.comparatorotherComp.ascending// Invert the order if it is a reverse sort./** A Comparator that will safely compare nulls to be lower or higher than ... */new NullSafeComparator<Object>(...)NullSafeComparator<> NULLS_LOW, ...;/** A shared default instance of this comparator, treating nulls lower ... */NullSafeComparator<> NULLS_HIGH, ...;/** A shared default instance of this comparator, treating nulls higher ... */Comparator<T> nonNullComparator, ...;boolean nullsLow, ...;/** Create a NullSafeComparator that sorts {@code null} based on ... */this.nonNullComparatorthis.nullsLow/** Create a NullSafeComparator that sorts {@code null} based on the ... */NullSafeComparator otherCompotherComp.nonNullComparatorotherComp.nullsLow/** Useful generic {@code java.util.Comparator} implementations, ... *//** Adapts a {@link CompletableFuture} or {@link CompletionStage} into a ... */new ListenableFutureCallbackRegistry<T>(...)CompletableFuture<T> completableFuture, ...;ListenableFutureCallbackRegistry<T> callbacks, ...;/** Create a new adapter for the given {@link CompletionStage}. ... */toCompletableFuture(...)/** Create a new adapter for the given {@link CompletableFuture}. */this.completableFuturenew BiConsumer<T,Throwable>(...) { ... }failure(...)addSuccessCallback(...)addFailureCallback(...)/** Extension of {@link CompletableFuture} which allows for cancelling ... */Future<T> delegate, ...;/** Failure callback for a {@link ListenableFuture}. ... *//** Called when the {@link ListenableFuture} completes with failure. ... *//** Abstract class that adapts a {@link Future} parameterized over S into a {@code Future} ... */State.NEWFuture<S> adaptee, ...;Object mutex, ...;/** Constructs a new {@code FutureAdapter} with the given adaptee. ... */this.adaptee/** Returns the adaptee. */adaptInternal(...)this.mutexT adaptedState.SUCCESSState.FAILUREExecutionException execEx/** Adapts the given adaptee's result into T. ... */State NEW, ...;State SUCCESS, ...;State FAILURE, ...;/** Extend {@link Future} with the capability to accept completion callbacks. ... *//** Register the given {@code ListenableFutureCallback}. ... *//** Java 8 lambda-friendly alternative with success and failure callbacks. ... *//** Expose this {@link ListenableFuture} as a JDK {@link CompletableFuture}. ... */CompletableFuture<T> completablenew DelegatingCompletableFuture<T>(...)new SuccessCallback<T>(...) { ... }/** Abstract class that adapts a {@link ListenableFuture} parameterized over S into a ... *//** Construct a new {@code ListenableFutureAdapter} with the given adaptee. ... */ListenableFuture<S> listenableAdapteegetAdaptee(...)new ListenableFutureCallback<S>(...) { ... }/** Callback mechanism for the outcome, success or failure, from a ... */import Queue/** Helper class for {@link ListenableFuture} implementations that maintains a ... */new ArrayDeque<SuccessCallback<? super T>>(...)new ArrayDeque<FailureCallback>(...)Queue<SuccessCallback<? super T>> successCallbacks, ...;Queue<FailureCallback> failureCallbacks, ...;/** Add the given callback to this registry. ... */this.successCallbacksthis.failureCallbacksnotifySuccess(...)notifyFailure(...)/** Add the given success callback to this registry. ... *//** Add the given failure callback to this registry. ... *//** Trigger a {@link ListenableFutureCallback#onSuccess(Object)} call on all ... */SuccessCallback<? super T> callback/** Trigger a {@link ListenableFutureCallback#onFailure(Throwable)} call on all ... */FailureCallback callback/** Extension of {@link FutureTask} that implements {@link ListenableFuture}. ... *//** Create a new {@code ListenableFutureTask} that will, upon running, ... *//** Create a {@code ListenableFutureTask} that will, upon running, ... *//** Adapts a {@link Mono} into a {@link ListenableFuture} by obtaining a ... *//** A {@link ListenableFuture} whose value can be set via {@link #set(Object)} ... */new SettableTask<T>(...)Callable<Object> DUMMY_CALLABLE, ...;SettableTask<T> settableTask, ...;/** Set the value of this future. This method will return {@code true} if the ... */setResultValue(...)this.settableTask/** Set the exception of this future. This method will return {@code true} if the ... */setExceptionResult(...)boolean cancelledinterruptTask(...)/** Retrieve the value. ... *//** Subclasses can override this method to implement interruption of the future's ... */Thread completingThread, ...;checkCompletingThread(...)setException(...)this.completingThreaddone(...)boolean check// Implicitly invoked by set/setException: store current thread for// determining whether the given result has actually triggered completion// (since FutureTask.set/setException unfortunately don't expose that)// only first match actually counts/** Success callback for a {@link ListenableFuture}. ... *//** Called when the {@link ListenableFuture} completes with success. ... *//** Useful generic {@code java.util.concurrent.Future} extensions. *//** A {@link java.util.function.Supplier} decorator that caches a singleton result and ... */Supplier<? extends T> instanceSupplier, ...;Supplier<? extends T> defaultSupplier, ...;/** Build a {@code SingletonSupplier} with the given singleton instance ... */this.defaultSupplier/** Build a {@code SingletonSupplier} with the given instance supplier ... *//** Get the shared singleton instance for this supplier. ... *//** Obtain the shared singleton instance for this supplier. ... *//** Build a {@code SingletonSupplier} with the given singleton instance. ... */new SingletonSupplier<T>(...)/** Build a {@code SingletonSupplier} with the given supplier. ... *//** Convenience utilities for {@link java.util.function.Supplier} handling. ... *//** Resolve the given {@code Supplier}, getting its result or immediately ... *//** Useful generic {@code java.util.function} helper classes. *//** Miscellaneous utility classes, such as String manipulation utilities, ... *//** A data size, such as '12MB'. ... *//** The pattern for parsing. */long BYTES_PER_KB, ...;/** Bytes per Kilobyte. */long BYTES_PER_MB, ...;/** Bytes per Megabyte. */long BYTES_PER_GB, ...;/** Bytes per Gigabyte. */long BYTES_PER_TB, ...;/** Bytes per Terabyte. */long bytes, ...;this.bytes/** Obtain a {@link DataSize} representing the specified number of bytes. ... */new DataSize(...)/** Obtain a {@link DataSize} representing the specified number of kilobytes. ... */multiplyExact(...)/** Obtain a {@link DataSize} representing the specified number of megabytes. ... *//** Obtain a {@link DataSize} representing the specified number of gigabytes. ... *//** Obtain a {@link DataSize} representing the specified number of terabytes. ... *//** Obtain a {@link DataSize} representing an amount in the specified {@link DataUnit}. ... */toBytes(...)/** Obtain a {@link DataSize} from a text string such as {@code 12MB} using ... */DataUnit unitdetermineDataUnit(...)DataUnit defaultUnitToUseDataUnit.BYTESfromSuffix(...)/** Checks if this size is negative, excluding zero. ... *//** Return the number of bytes in this instance. ... *//** Return the number of kilobytes in this instance. ... *//** Return the number of megabytes in this instance. ... *//** Return the number of gigabytes in this instance. ... *//** Return the number of terabytes in this instance. ... */other.bytesDataSize otherSizeotherSize.bytes/** A standard set of {@link DataSize} units. ... */new DataUnit(...)ofBytes(...)ofKilobytes(...)ofMegabytes(...)ofGigabytes(...)ofTerabytes(...)DataUnit BYTES, ...;/** Bytes, represented by suffix {@code B}. */DataUnit KILOBYTES, ...;/** Kilobytes, represented by suffix {@code KB}. */DataUnit MEGABYTES, ...;/** Megabytes, represented by suffix {@code MB}. */DataUnit GIGABYTES, ...;/** Gigabytes, represented by suffix {@code GB}. */DataUnit TERABYTES, ...;/** Terabytes, represented by suffix {@code TB}. */DataSize size, ...;/** Return the {@link DataUnit} matching the specified {@code suffix}. ... */DataUnit candidatecandidate.suffix/** Useful unit data types. */import XMLConstantsimport XMLStreamExceptionimport Attributesimport ContentHandlerimport LexicalHandler/** Abstract base class for SAX {@code ContentHandler} and {@code LexicalHandler} ... */List<Map<String,String>> namespaceMappings, ...;boolean inCData, ...;removeAllNamespaceMappings(...)newNamespaceMapping(...)startDocumentInternal(...)XMLStreamException exnew SAXException(...)endDocumentInternal(...)currentNamespaceMapping(...)startElementInternal(...)toQName(...)endElementInternal(...)removeNamespaceMapping(...)String datathis.inCDatacharactersInternal(...)cDataInternal(...)ignorableWhitespaceInternal(...)processingInstructionInternal(...)skippedEntityInternal(...)dtdInternal(...)commentInternal(...)/** Convert a namespace URI and DOM or SAX qualified name to a {@code QName}. The ... */String localPartgetLocalPart(...)XMLConstants.XMLNS_ATTRIBUTEthis.namespaceMappingsimport Locatorimport SAXNotRecognizedExceptionimport SAXNotSupportedException/** Abstract base class for SAX {@code XMLReader} implementations that use StAX as a basis. ... */String NAMESPACES_FEATURE_NAME, ...;String NAMESPACE_PREFIXES_FEATURE_NAME, ...;String IS_STANDALONE_FEATURE_NAME, ...;boolean namespacesFeature, ...;boolean namespacePrefixesFeature, ...;Boolean isStandalone, ...;this.namespacesFeaturethis.namespacePrefixesFeaturethis.isStandalonenew SAXNotSupportedException(...)getFeature(...)setFeature(...)/** Indicates whether the SAX feature {@code http://xml.org/sax/features/namespaces} is turned on. *//** Indicates whether the SAX feature {@code http://xml.org/sax/features/namespaces-prefixes} is turned on. *//** Convert a {@code QName} to a qualified name, as used by DOM and SAX. ... *//** Parse the StAX XML reader passed at construction-time. ... */Locator locatorSAXParseException saxExceptionnew SAXParseException(...)new StaxLocator(...)fatalError(...)/** Template method that parses the StAX reader passed at construction-time. *//** Start the prefix mapping for the given prefix. ... */getContentHandler(...)startPrefixMapping(...)/** End the prefix mapping for the given prefix. ... */endPrefixMapping(...)/** Implementation of the {@code Locator} interface based on a given StAX {@code Location}. ... */getPublicId(...)getColumnNumber(...)import XMLEventReader/** Abstract base class for {@code XMLEventReader}s. ... */nextEvent(...)/** This implementation throws an {@code IllegalArgumentException} for any property. ... *//** Check if the reader is closed, and throws a {@code XMLStreamException} if so. ... */new XMLStreamException(...)import DTDHandlerimport XMLReader/** Abstract base class for SAX {@code XMLReader} implementations. ... */DTDHandler dtdHandler, ...;ContentHandler contentHandler, ...;LexicalHandler lexicalHandler, ...;this.contentHandlerthis.dtdHandlerthis.lexicalHandler/** This implementation throws a {@code SAXNotRecognizedException} exception ... */new SAXNotRecognizedException(...)/** Throws a {@code SAXNotRecognizedException} exception when the given property does not signify a lexical ... */import XMLStreamConstantsimport XMLStreamReader/** Abstract base class for {@code XMLStreamReader}s. ... */int eventTypegetEventType(...)XMLStreamConstants.START_ELEMENTXMLStreamConstants.END_ELEMENTXMLStreamConstants.CHARACTERSXMLStreamConstants.CDATAXMLStreamConstants.SPACEXMLStreamConstants.ENTITY_REFERENCEXMLStreamConstants.PROCESSING_INSTRUCTIONXMLStreamConstants.COMMENTXMLStreamConstants.END_DOCUMENTgetNamespaceContext(...)isWhiteSpace(...)QName namechar[] sourcegetTextCharacters(...)// skippingimport ProcessingInstructionimport Text/** SAX {@code ContentHandler} that transforms callback calls to DOM {@code Node}s. ... */Document document, ...;List<Element> elements, ...;Node node, ...;/** Create a new instance of the {@code DomContentHandler} with the given node. ... */this.nodethis.documentgetOwnerDocument(...)Node parentcreateElementNS(...)String attrUriString attrQnamegetQName(...)setAttributeNS(...)appendChild(...)Node lastChildgetLastChild(...)Node.TEXT_NODEappendData(...)Text textcreateTextNode(...)ProcessingInstruction picreateProcessingInstruction(...)import CharacterDataimport Commentimport EntityReference/** Convenience methods for working with the DOM API, ... *//** Retrieves all child elements of the given DOM element that match any of the given element names. ... */List<String> childEleNameListList<Element> childElesnodeNameMatch(...)/** Retrieves all child elements of the given DOM element that match the given element name. ... *//** Utility method that returns the first child element identified by its name. ... *//** Utility method that returns the first child element value identified by its name. ... */Element childgetChildElementByTagName(...)/** Retrieves all child elements of the given DOM element. ... *//** Extracts the text value from the given DOM element, ignoring XML comments. ... */Node itemgetNodeValue(...)/** Namespace-aware equals comparison. Returns {@code true} if either ... *//** Returns a SAX {@code ContentHandler} that transforms callback calls to DOM {@code Node}s. ... */new DomContentHandler(...)/** Matches the given node's name and local name against the given desired name. *//** Matches the given node's name and local name against the given desired names. */import Charactersimport XMLEvent/** Implementation of {@code XMLEventReader} based on a {@link List} ... */List<XMLEvent> events, ...;XMLEvent currentEvent, ...;int cursor, ...;this.eventsnew ArrayList<XMLEvent>(...)this.cursorthis.currentEventcheckIfClosed(...)isStartElement(...)XMLEvent eventCharacters charactersasCharacters(...)isEndElement(...)isCharacters(...)isIgnorableWhiteSpace(...)getData(...)import NamespaceContext/** Simple {@code javax.xml.namespace.NamespaceContext} implementation. ... */Map<String,String> prefixToNamespaceUri, ...;Map<String,Set<String>> namespaceUriToPrefixes, ...;String defaultNamespaceUri, ...;XMLConstants.XML_NS_PREFIXXMLConstants.XML_NS_URIXMLConstants.XMLNS_ATTRIBUTE_NS_URIXMLConstants.DEFAULT_NS_PREFIXthis.defaultNamespaceUrithis.prefixToNamespaceUriSet<String> prefixesgetPrefixesSet(...)this.namespaceUriToPrefixes/** Set the bindings for this namespace context. ... */bindNamespaceUri(...)/** Bind the given namespace as default namespace. ... *//** Bind the given prefix to the given namespace. ... *//** Remove the given prefix from this context. ... *//** Remove all declared prefixes. *//** Return all declared prefixes. *//** Simple {@code org.xml.sax.ErrorHandler} implementation: ... *//** Create a new SimpleSaxErrorHandler for the given ... */import ErrorListenerimport TransformerException/** Simple {@code javax.xml.transform.ErrorListener} implementation: ... *//** Create a new SimpleTransformErrorListener for the given ... */import XMLEventFactoryimport XMLEventWriterimport Namespace/** SAX {@link org.xml.sax.ContentHandler} and {@link LexicalHandler} ... */XMLEventFactory eventFactory, ...;XMLEventWriter eventWriter, ...;/** Construct a new instance of the {@code StaxEventContentHandler} that writes to the ... */this.eventFactorythis.eventWriter/** Construct a new instance of the {@code StaxEventContentHandler} that uses the given ... */new LocatorLocationAdapter(...)createStartDocument(...)createEndDocument(...)List<Attribute> attributesList<Namespace> namespacesgetNamespaces(...)createStartElement(...)List<Namespace> resultnew ArrayList<Namespace>(...)createNamespace(...)int attrLengthList<Attribute> resultnew ArrayList<Attribute>(...)QName attrNameisNamespaceDeclaration(...)createAttribute(...)createEndElement(...)createCharacters(...)createCData(...)createIgnorableSpace(...)createDTD(...)createComment(...)// IgnoredLocator locator, ...;this.locatorimport DTDimport EndElementimport EntityDeclarationimport NotationDeclarationimport StartDocumentimport StartElementimport Locator2import AttributesImpl/** SAX {@code XMLReader} that reads from a StAX {@code XMLEventReader}. Consumes {@code XMLEvents} from ... */String DEFAULT_XML_VERSION, ...;XMLEventReader reader, ...;String xmlVersion, ...;/** Constructs a new instance of the {@code StaxEventXmlReader} that reads from ... */isStartDocument(...)boolean documentStartedboolean documentEndedint elementDepthisEndDocument(...)handleStartDocument(...)XMLStreamConstants.START_DOCUMENThandleStartElement(...)asStartElement(...)handleEndElement(...)asEndElement(...)handleProcessingInstruction(...)handleCharacters(...)handleEndDocument(...)XMLStreamConstants.NOTATION_DECLARATIONhandleNotationDeclaration(...)XMLStreamConstants.ENTITY_DECLARATIONhandleEntityDeclaration(...)handleComment(...)XMLStreamConstants.DTDhandleDtd(...)handleEntityReference(...)ContentHandler contentHandlerStartDocument startDocumentString xmlVersionthis.xmlVersionencodingSet(...)getCharacterEncodingScheme(...)setDocumentLocator(...)new Locator2(...) { ... }startDocument(...)QName qNamehasNamespacesFeature(...)Iterator<> iNamespace namespaceQName attributeNamestartElement(...)toQualifiedName(...)char[] dataignorableWhitespace(...)isCData(...)getLexicalHandler(...)startCDATA(...)characters(...)endCDATA(...)endElement(...)endDocument(...)getDTDHandler(...)notationDecl(...)unparsedEntityDecl(...)getNotationName(...)processingInstruction(...)char[] chcomment(...)ch.lengthstartDTD(...)endDTD(...)startEntity(...)endEntity(...)AttributesImpl attributesnew AttributesImpl(...)getDTDType(...)hasNamespacePrefixesFeature(...)String qNameimport XMLStreamWriterimport SAXResult/** Implementation of the {@code Result} tagging interface for StAX writers. Can be constructed with ... */XMLStreamWriter streamWriter, ...;/** Construct a new instance of the {@code StaxResult} with the specified {@code XMLEventWriter}. ... */StaxEventHandler handlernew StaxEventHandler(...)setHandler(...)setLexicalHandler(...)/** Construct a new instance of the {@code StaxResult} with the specified {@code XMLStreamWriter}. ... */StaxStreamHandler handlernew StaxStreamHandler(...)this.streamWriter/** Return the {@code XMLEventWriter} used by this {@code StaxResult}. ... *//** Return the {@code XMLStreamWriter} used by this {@code StaxResult}. ... *//** Throws an {@code UnsupportedOperationException}. ... */import SAXSource/** Implementation of the {@code Source} tagging interface for StAX readers. Can be constructed with ... */XMLEventReader eventReader, ...;XMLStreamReader streamReader, ...;/** Construct a new instance of the {@code StaxSource} with the specified {@code XMLEventReader}. ... */new StaxEventXMLReader(...)this.eventReader/** Construct a new instance of the {@code StaxSource} with the specified {@code XMLStreamReader}. ... */new StaxStreamXMLReader(...)this.streamReader/** Return the {@code XMLEventReader} used by this {@code StaxSource}. ... *//** Return the {@code XMLStreamReader} used by this {@code StaxSource}. ... */writeStartDocument(...)writeEndDocument(...)writeStartElement(...)writeNamespace(...)setDefaultNamespace(...)writeAttribute(...)writeEndElement(...)writeCharacters(...)writeCData(...)writeProcessingInstruction(...)writeDTD(...)writeComment(...)/** SAX {@code XMLReader} that reads from a StAX {@code XMLStreamReader}. Reads from an ... */XMLStreamReader reader, ...;/** Construct a new instance of the {@code StaxStreamXmlReader} that reads from the given ... */int eventstandaloneSet(...)setStandalone(...)isStandalone(...)getNamespaceCount(...)getNamespacePrefix(...)getAttributePrefix(...)getAttributeNamespace(...)getTextStart(...)getTextLength(...)getPITarget(...)getPIData(...)getAttributeType(...)getAttributeLocalName(...)import XMLInputFactoryimport XMLResolverimport Resultimport Sourceimport StAXResultimport StAXSource/** Convenience methods for working with the StAX API. Partly historic due to JAXP 1.3 ... */new XMLResolver(...) { ... }XMLResolver NO_OP_XML_RESOLVER, ...;/** Create an {@link XMLInputFactory} with Spring's defensive setup, ... */createDefensiveInputFactory(...)new Supplier<XMLInputFactory>(...) { ... }/** Variant of {@link #createDefensiveInputFactory()} with a custom instance. ... */T inputFactoryXMLInputFactory.SUPPORT_DTDXMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIESsetXMLResolver(...)/** Create a JAXP 1.4 {@link StAXSource} for the given {@link XMLStreamReader}. ... */new StAXSource(...)/** Create a JAXP 1.4 {@link StAXSource} for the given {@link XMLEventReader}. ... *//** Create a custom, non-JAXP 1.4 StAX {@link Source} for the given {@link XMLStreamReader}. ... */new StaxSource(...)/** Create a custom, non-JAXP 1.4 StAX {@link Source} for the given {@link XMLEventReader}. ... *//** Indicate whether the given {@link Source} is a JAXP 1.4 StAX Source or ... *//** Return the {@link XMLStreamReader} for the given StAX Source. ... */getXMLStreamReader(...)/** Return the {@link XMLEventReader} for the given StAX Source. ... */getXMLEventReader(...)/** Create a JAXP 1.4 {@link StAXResult} for the given {@link XMLStreamWriter}. ... */new StAXResult(...)/** Create a JAXP 1.4 {@link StAXResult} for the given {@link XMLEventWriter}. ... *//** Create a custom, non-JAXP 1.4 StAX {@link Result} for the given {@link XMLStreamWriter}. ... */new StaxResult(...)/** Create a custom, non-JAXP 1.4 StAX {@link Result} for the given {@link XMLEventWriter}. ... *//** Indicate whether the given {@link Result} is a JAXP 1.4 StAX Result or ... *//** Return the {@link XMLStreamWriter} for the given StAX Result. ... */getXMLStreamWriter(...)/** Return the {@link XMLEventWriter} for the given StAX Result. ... */getXMLEventWriter(...)/** Create a {@link XMLEventReader} from the given list of {@link XMLEvent}. ... */new ListBasedXMLEventReader(...)/** Create a SAX {@link ContentHandler} that writes to the given StAX {@link XMLStreamWriter}. ... *//** Create a SAX {@link ContentHandler} that writes events to the given StAX {@link XMLEventWriter}. ... *//** Create a SAX {@link XMLReader} that reads from the given StAX {@link XMLStreamReader}. ... *//** Create a SAX {@link XMLReader} that reads from the given StAX {@link XMLEventReader}. ... *//** Return a {@link XMLStreamReader} that reads from a {@link XMLEventReader}. ... */new XMLEventStreamReader(...)/** Return a {@link XMLStreamWriter} that writes to a {@link XMLEventWriter}. ... */new XMLEventStreamWriter(...)newFactory(...)import OutputKeys/** Contains common behavior relating to {@link javax.xml.transform.Transformer Transformers} ... */int DEFAULT_INDENT_AMOUNT, ...;/** The indent amount of characters if {@link #enableIndenting indenting is enabled}. ... *//** Enable indenting for the supplied {@link javax.xml.transform.Transformer}. ... */enableIndenting(...)setOutputProperty(...)OutputKeys.INDENTIllegalArgumentException ignored/** Disable indenting for the supplied {@link javax.xml.transform.Transformer}. ... */// Xalan-specific, but this is the most common XSLT engine in any case/** Implementation of the {@link javax.xml.stream.XMLStreamReader} interface that wraps a ... */XMLEvent event, ...;isProcessingInstruction(...)XMLEvent.COMMENTIterator<> attributescountIterator(...)isSpecified(...)Iterator<> namespacesgetNamespace(...)/** Implementation of the {@link javax.xml.stream.XMLStreamWriter} interface ... */new ArrayList<EndElement>(...)String DEFAULT_ENCODING, ...;List<EndElement> endElements, ...;boolean emptyElement, ...;setNamespaceContext(...)closeEmptyElementIfNecessary(...)doWriteStartElement(...)this.endElementsthis.emptyElementEndElement lastEndElementdoWriteNamespace(...)EndElement oldEndElementIterator<> oldNamespacesList<Namespace> newNamespacesEndElement newEndElementNamespace oldNamespacecreateEntityReference(...)import BufferedReaderimport CharConversionException/** Detects whether an XML stream is using DTD- or XSD-based validation. ... *//** Indicates that the validation mode should be auto-guessed, since we cannot find ... *//** Indicates that DTD validation should be used (we found a "DOCTYPE" declaration). *//** Indicates that XSD validation should be used (found no "DOCTYPE" declaration). */String DOCTYPE, ...;/** The token in a XML document that declares the DTD to use for validation ... */String START_COMMENT, ...;/** The token that indicates the start of an XML comment. */String END_COMMENT, ...;/** The token that indicates the end of an XML comment. */boolean inComment, ...;/** Indicates whether or not the current parse position is inside an XML comment. *//** Detect the validation mode for the XML document in the supplied {@link InputStream}. ... */BufferedReader readernew BufferedReader(...)boolean isDtdValidatedString contentreadLine(...)consumeCommentTokens(...)this.inCommenthasDoctype(...)hasOpeningTag(...)CharConversionException ex/** Does the content contain the DTD DOCTYPE declaration? *//** Does the supplied content contain an XML opening tag. If the parse state is currently ... */int openTagIndexisLetter(...)/** Consume all leading and trailing comments in the given String and return ... */int indexOfStartCommentString currLineconsume(...)/** Consume the next comment token, update the "inComment" flag ... */endComment(...)startComment(...)/** Try to consume the {@link #START_COMMENT} token. ... */commentToken(...)/** Try to consume the supplied token against the supplied content and update the ... */// Peek into the file to look for DOCTYPE.// End of meaningful data...// Choked on some character encoding...// Leave the decision up to the caller./** Miscellaneous utility classes for XML parsing and transformation, ... *//** We must use a standalone set of types to ensure that no one else is loading ... *//** Unit tests for {@link AttributeAccessorSupport}. ... */new SimpleAttributeAccessorSupport(...)String NAME, ...;AttributeAccessor attributeAccessor, ...;this.attributeAccessorAtomicInteger atomicIntegerFunction<String,String> computeFunctioncomputeAttribute(...)binarySearch(...)import DelayQueueMethod unbridgedMyFoo.classMethod bridgedMethod bridgeMethodDateAdder.classMyBar.classMethod otherMethod bridgeMethod objectBridgeMyBoo.classMethod serializableBridgeMethod stringFooMethod integerFooMethod loadWithObjectReturnfindMethodWithReturnType(...)SettingsDaoImpl.classMethod loadWithSettingsReturnSettings.classMethod loadFromParentBridgeMethod loadFromParentAbstractDaoImpl<>.classDelayQueue<>.classDelayed.classSerializableBounded<>.classStringGenericParameter.classStringList.classMessageBroadcasterImpl.classMessageEvent.classEvent.classMethod otherMethodNewMessageEvent.classYourHomer<>.classBounded<>.classMethod abstractBoundedFooAbstractBounded<>.classGenericSqlMapIntegerDao<>.classAbstractDao<>.classUserDaoImpl.classUser.classBusinessDao.classBusiness<>.classMegaMessageProducerImpl.classMegaMessageEvent.classMegaEvent.classExtendsAbstractImplementsInterface.classDomainObjectExtendsSuper.classDomainObjectSuper.classDomainObject.classParameterType.classTestEmailProvider.classdoTestHierarchyResolution(...)FooClass.classMethod expectedFooEntity.classT object, ...;S otherObject, ...;this.otherObject// @Transactional(readOnly = true)super.object/** Constructor that takes an event priority *//** Default Constructor */...[] subscribingEvents, ...;Channel<T> channel, ...;/** Abstract method to retrieve instance of subclass ... *///-----------------------------// SPR-2454 Test Classes// constructor arguments to Spring AOP proxies is quite cumbersome).// Not set in a constructor to enable easy CGLIB-proxying (passing// actual type as parameter, too.// parameter (!), we resort to requiring the caller to provide the// Since it is impossible to determine the actual type of a type//-------------------// SPR-2603 classes// @Transactional// SPR-3304 classes// SPR-3357 classes// SPR-3485 classesmethod1(...)method2(...)// SPR-3534 classes// SPR-16103 classes// SPR-16103// implement an unrelated interface first (SPR-16288)import Assertionsimport static CollectionFactory.createApproximateCollectionimport static CollectionFactory.createApproximateMapimport static CollectionFactory.createCollectionimport static CollectionFactory.createMap/** Unit tests for {@link CollectionFactory}. ... *//** The test demonstrates that the generics-based API for ... */Collection<Integer> intsColor.BLUEColor.classEnumMap<Color,Integer> enumMapnew EnumMap<Color,Integer>(...)Color.REDCollection<String> setHashSet<String> hashSetCollection<Color> colorsMap<String,String> hashMapMap<Color,String> colorsnew EnumMap<Color,String>(...)EnumMap<Color,String> enumMapEnumSet<Color> enumSetLinkedMultiValueMap<>.classnew Color(...)Color RED, ...;Color BLUE, ...;// Use a try-catch block to ensure that the exception is thrown as a result of the// next line and not as a result of the previous line.// Note that ints is of type Collection<Integer>, but the collection returned// by createApproximateCollection() is of type Collection<Color>. Thus, 42// cannot be cast to a Color.// by createCollection() is of type Collection<Color>. Thus, 42 cannot be cast// to a Color.// Note that the 'map' key must be of type String, but the keys in the map// returned by createApproximateMap() are of type Color. Thus "foo" cannot be// cast to a Color.// returned by createMap() are of type Color. Thus "foo" cannot be cast to a// Color.// Note: 'map' values must be of type Integer, but the values in the map// returned by createMap() are of type java.util.List. Thus 1 cannot be// cast to a List.// interfaces// concrete types// SPR-17619Constants cA.DOGA.CATConstants.ConstantException.classConstants.ConstantExceptionasString(...)A.S1Set<?> namesSet<?> valuesgetValuesForProperty(...)Locale oldLocalegetNamesForSuffix(...)getValuesForSuffix(...)toCodeForProperty(...)toCodeForSuffix(...)NoConstants.classint DOG, ...;int CAT, ...;String S1, ...;int PREFIX_NO, ...;int PREFIX_YES, ...;int MY_PROPERTY_NO, ...;int MY_PROPERTY_YES, ...;int NO_PROPERTY, ...;int YES_PROPERTY, ...;int P, ...;/** ignore these */boolean f, ...;Object o, ...;import Observableimport Singleimport TestObject/** Unit tests for {@link Conventions}. ... */new TestObject(...)getVariableNameForParameter(...)TestObject.classgetMethodForReturnType(...)new TestObject[]Class<String> clsString desiredResultnew Predicate<Method>(...) { ... }new Supplier<IllegalArgumentException>(...) { ... }Class<? extends Throwable> foundClassfindClosestMatch(...)TargetException.classSameDepthException.classLowestDepthException.classNoDepthException.classHighestDepthException.classnew TargetException(...)import static GenericTypeResolver.getTypeVariableMapimport static GenericTypeResolver.resolveReturnTypeArgumentimport static GenericTypeResolver.resolveTypeimport static GenericTypeResolver.resolveTypeArgumentimport static ReflectionUtils.findMethodMySimpleInterfaceType.classMyCollectionInterfaceType.classMySimpleSuperclassType.classMySuperclassType<>.classMyCollectionSuperclassType.classGenericClass<String> objnew GenericClass<String>(...)GenericClass<>.classresolveReturnTypeArgument(...)Method intMessageMethodMethodParameter intMessageMethodParamMethod intArrMessageMethodMethodParameter intArrMessageMethodParamMethod genericArrMessageMethodMySimpleTypeWithMethods.classMethodParameter genericArrMessageMethodParamMap<TypeVariable<>,Type> varMapgetTypeVariableMap(...)B<>.classTestImpl<>.classTestIfc<>.classMap<TypeVariable<>,Type> mapType tType xTopLevelClass<>.classTypedTopLevelClass.classTypedTopLevelClass.TypedNested.classTypedTopLevelClass.TypedNestedEntry<TypeVariable<>,Type> entryMap<>.Entry<TypeVariable<>,Type>Class<?>[] resolvedresolveTypeArguments(...)WithArrayBase<>.classresolveParameterType(...)WithArray<>.classIdFixingRepository<>.classresolved.length// SPR-11030// SPR-11052// SPR-11044// SPR-11763LocalVariableTableParameterNameDiscoverer discoverer, ...;Method getNameMethod setNameConstructor<TestObject> noArgsConsConstructor<TestObject> twoArgConsClass<? extends LocalVariableTableParameterNameDiscovererTests> clazzMethod m1Method m2Class<InnerClass> clazzInnerClass.classGenerifiedClass<>.classClass<Component> clazzPrintStream.classlong udouble uint waz, ...;long fooshort barthis.wazlong date, ...;// JDK classes don't have debug information (usually)// some custom static bloc or <clinit>// nothing/** Tests for {@link MethodParameter}. ... */MethodParameter stringParameter, ...;MethodParameter longParameter, ...;MethodParameter intReturnType, ...;forMethodOrConstructor(...)forParameter(...)NestedClass.classParam.classIntegerList.classMethodParameter m1MethodParameter m2MethodParameter m3MethodParameter m4withTypeIndex(...)getTypeIndexForCurrentLevel(...)setTypeIndexForCurrentLevel(...)decreaseNestingLevel(...)// SPR-16652String mesgNestedRuntimeException nexnew NestedRuntimeException(...) { ... }PrintWriter pwnew PrintWriter(...)String myMessageString rootCauseMsgException rootCauseNestedCheckedException nexnew NestedCheckedException(...) { ... }// Making a class abstract doesn't _really_ prevent instantiation :-)// Check printStackTrace// check PrintStackTrace/** Unit tests for the {@link OrderComparator} class. ... */OrderComparator comparator, ...;new StubOrdered(...)new StubPriorityOrdered(...)assertThatPriorityOrderedAlwaysWins(...)Comparator<Object> customComparatornew TestSourceProvider(...)Object orderSource, ...;this.orderSource/** Test fixture for {@link ParameterizedTypeReference}. ... */ParameterizedTypeReference<String> typeReferencenew ParameterizedTypeReference<String>(...) { ... }Type mapTypeParameterizedTypeReference<Map<Object,String>> typeReferencenew ParameterizedTypeReference<Map<Object,String>>(...) { ... }Type listTypeParameterizedTypeReference<List<String>> typeReferencenew ParameterizedTypeReference<List<String>>(...) { ... }ParameterizedTypeReference<?> typeReferencenew ParameterNameDiscoverer(...) { ... }...[] FOO_BAR, ...;...[] SOMETHING_ELSE, ...;ParameterNameDiscoverer returnsFooBar, ...;ParameterNameDiscoverer returnsSomethingElse, ...;Method anyMethod, ...;new PrioritizedParameterNameDiscoverer(...)PrioritizedParameterNameDiscoverer pndimport CoreSubscriber/** Unit tests for {@link ReactiveAdapterRegistry}. ... */ReactiveAdapterRegistry registry, ...;ReactiveAdapter adapter1ReactiveAdapter adapter2ExtendedFlux<>.classReactiveAdapter adapter3List<Integer> sequencePublisher<Integer> sourcefromIterable(...)block(...)collectList(...)ofMillis(...)fromArray(...)CompletableFuture<Integer> futurenew CompletableFuture<Integer>(...)toBlocking(...)blockingGet(...)blockingAwait(...)isDeferred(...)// Publisher// Completable// RxJava 2// RxJava 3// Coroutinesimport AbstractAssertimport ArgumentCaptorimport Captorimport MockitoExtensionimport VariableResolverimport static Mockito.atLeastOnce/** Tests for {@link ResolvableType}. ... */MockitoExtension.classArgumentCaptor<TypeVariable<?>> typeVariableCaptor, ...;ResolvableType noneResolvableType.EmptyType.INSTANCEResolvableType.EmptyTyperesolveGenerics(...).lengthExtendsList.classResolvableType typeVariableResolvableType rawnew MyGenericInterfaceType<String>(...)MyGenericInterfaceType<>.classFields<>.classField field2ResolvableType type2Constructor<Constructors<>> constructorConstructors<>.classforConstructorParameter(...)Methods<>.classListOfGenericArray.classExtendsMap.classAbstractList<>.classAbstractCollection<>.classSortedSet<String> interfacesTypedFields.classResolvableType implementationTypeTypedConstructors.classTypedMethods.classType sourceTypeVariableResolver.classResolvableType longTypeResolvableType variableResolvableType parameterizedcapture(...)atLeastOnce(...)this.typeVariableCaptorResolvableType reflectiveTypeResolvableType declaredTypenew ParameterizedTypeReference<List<CharSequence>>(...) { ... }hasToString(...)VariableNameSwitch<>.classforTypedField(...)Class<?> classTypeField basicFieldEnclosedInParameterizedType<>.InnerTyped<>.classEnclosedInParameterizedType<>.InnerTyped<>TypedEnclosedInParameterizedType.TypedInnerTyped.classTypedEnclosedInParameterizedType.TypedInnerTypedResolvableType objectTypeResolvableType charSequenceTypeResolvableType stringTypeassertThatResolvableType(...)isNotAssignableFrom(...)ResolvableType unresolvableVariableAssignmentBase<>.classResolvableType objectVariableAssignment.classResolvableType charSequenceVariableResolvableType stringVariableResolvableType objectListResolvableType stringListResolvableType charSequenceListResolvableType extendsObjectListResolvableType extendsCharSequenceListResolvableType extendsStringListResolvableType extendsCharSequenceCollectionResolvableType charSequenceCollectionResolvableType objectResolvableType objectArrayResolvableType charSequenceArrayResolvableType stringArrayResolvableType charSequenceResolvableType stringResolvableType extendsAnonResolvableType extendsObjectResolvableType extendsCharSequenceResolvableType extendsStringResolvableType superObjectResolvableType superCharSequenceResolvableType superStringResolvableType complex1ResolvableType complex2ResolvableType complex3ResolvableType complex4ResolvableType forClassResolvableType forFieldDirectResolvableType forFieldViaTypeResolvableType forFieldWithImplementationResolvableType tResolvableType elementTypeResolvableType listTypeResolvableType deserializedNonetestSerialization(...)ResolvableType narrowMySimpleInterfaceTypeWithImplementsRaw.classExtendsMySimpleInterfaceTypeWithImplementsRaw.classBaseProvider<>.classBaseImplementation.classResolvableType collectionClassResolvableType setClassResolvableType fromReturnTypeResolvableType genericTypeUnresolvedWithGenerics.classResolvableType readnew ResolvableTypeAssert(...)HashMap<Integer,List<String>> myMap, ...;List<> classType, ...;T typeVariableType, ...;List<T> parameterizedType, ...;...[] arrayClassType, ...;...[] genericArrayType, ...;...[] genericMultiArrayType, ...;List<? extends Number> wildcardType, ...;List<? super Number> wildcardSuperType, ...;List<CharSequence> charSequenceList, ...;List<List<String>> stringListList, ...;List<String[]> stringArrayList, ...;MultiValueMap<String,Integer> stringIntegerMultiValueMap, ...;VariableNameSwitch<Integer,String> stringIntegerMultiValueMapSwitched, ...;List<List<>> listOfListOfUnknown, ...;List<String> privateField, ...;List<String> otherPrivateField, ...;Map<Map<String,Integer>,Map<Byte,Long>> nested, ...;...[] variableTypeGenericArray, ...;O o, ...;C c, ...;S s, ...;List<O> listo, ...;List<C> listc, ...;List<S> lists, ...;List<?> listAnon, ...;List<? extends O> listxo, ...;List<? extends C> listxc, ...;List<? extends S> listxs, ...;List<? super O> listso, ...;List<? super C> listsc, ...;List<? super S> listss, ...;...[] oarray, ...;...[] carray, ...;...[] sarray, ...;Collection<C> collectionc, ...;Collection<? extends C> collectionxc, ...;Map<? super Integer,List<String>> complexWildcard1, ...;MultiValueMap<Number,String> complexWildcard2, ...;Collection<? extends Collection<? extends CharSequence>> complexWildcard3, ...;List<List<String>> complexWildcard4, ...;T field, ...;Collection<IBase<BT>> stuff, ...;Set<Integer> set, ...;ResolvableTypeAssert.class// gh-23321// SPR-16210// Generic assignment can be a little confusing, given:// List<CharSequence> c1, List<? extends CharSequence> c2, List<String> s;// c2 = s; is allowed and is often used for argument input, for example// see List.addAll(). You can get items from c2 but you cannot add items without// getting a generic type 'is not applicable for the arguments' error. This makes// sense since if you added a StringBuffer to c2 it would break the rules on s.// c1 = s; not allowed. Since there is no '? extends' to cause the generic// 'is not applicable for the arguments' error when adding (which would pollute// s).// Language Spec 4.5.1. Type Arguments and Wildcards// ? extends T <= ? extends S if T <: S// ? super T <= ? super S if S <: T// [Implied] super / extends cannot be mixed// T <= T// T <= ? extends T// T <= ? super T/** Tests for {@link SerializableTypeWrapper}. ... */assertSerializable(...)Methods.classConstructors.classGenericArrayType typeParameterizedType typeTypeVariable<?> typeParameterizedType typeSourceWildcardType typeString classType, ...;List<String> parameterizedType, ...;List<? extends CharSequence> wildcardType, ...;SimpleAliasRegistry registrynew SimpleAliasRegistry(...)// SPR-17191import static Arrays.stream/** Unit tests for {@link SortedProperties}. ... */assertKeys(...)createSortedProps(...)createSortedPropsFromPrototype(...)assertKeySet(...)assertEntrySet(...)SortedProperties sortedPropertiesString[] lineslines(...)assertPropsAreSorted(...)String regexisNotEmpty(...)filteredOn(...)populateProperties(...)SortedProperties.EOL// Leniently match first line due to differences between JDK 8 and JDK 9+.import ReactorBlockHoundIntegrationimport Schedulersimport static Assertions.assertThatThrownByimport static JRE.JAVA_14/** Tests to verify the spring-core BlockHound integration rules. ... */install(...)new SpringCoreBlockHoundIntegration(...)builder(...)new ReactorBlockHoundIntegration(...)ReactiveAdapterRegistry.SpringCoreBlockHoundIntegrationhasMessageContaining(...)assertThatThrownBy(...)testNonBlockingTask(...)new NonBlockingTask(...) { ... }new ConcurrentReferenceHashMap<String,String>(...)CompletableFuture<Object> future1new CompletableFuture<Object>(...)CompletableFuture<Object> future2allOf(...)CompletableFuture<Object> future// Reactor non-blocking thread predicate/** Tests for StandardReflectionParameterNameDiscoverer ... */MessageService.classString[] actualParamsimport ParametersAreNonnullByDefaultimport ExtendsBaseClassWithGenericAnnotatedMethodimport ImplementsInterfaceWithGenericAnnotatedMethodimport WebControllerimport WebMappingimport static Arrays.asListimport static Collectors.toListimport static Collectors.toSetimport static AnnotatedElementUtils.findAllMergedAnnotationsimport static AnnotatedElementUtils.findMergedAnnotationimport static AnnotatedElementUtils.getAllAnnotationAttributesimport static AnnotatedElementUtils.getAllMergedAnnotationsimport static AnnotatedElementUtils.getMergedAnnotationimport static AnnotatedElementUtils.getMergedAnnotationAttributesimport static AnnotatedElementUtils.getMetaAnnotationTypesimport static AnnotatedElementUtils.hasAnnotationimport static AnnotatedElementUtils.hasMetaAnnotationTypesimport static AnnotatedElementUtils.isAnnotatedimport static AnnotationUtilsTests.asArray/** Unit tests for {@link AnnotatedElementUtils}. ... */String TX_NAME, ...;NonAnnotatedClass.classTransactionalComponent.classTransactionalComponentClass.classnames(...)ComposedTransactionalComponentClass.classComposedTransactionalComponent.classhasMetaAnnotationTypes(...)SubTransactionalComponentClass.classDocumented.classNonnull.classParametersAreNonnullByDefault.classTxConfig.classSubClassWithInheritedAnnotation.classSubSubClassWithInheritedAnnotation.classSubSubClassWithInheritedComposedAnnotation.class/** If the "value" entry contains both "DerivedTxConfig" AND "TxConfig", then ... */DerivedTxConfig.class/** Note: this functionality is required by {@code org.springframework.context.annotation.ProfileCondition}. */TxFromMultipleComposedAnnotations.classWhen.ALWAYSClass<?> elementMetaCycleAnnotatedClass.classConcreteClassWithInheritedAnnotation.classInheritedAnnotationInterface.classNonInheritedAnnotationInterface.classConventionBasedComposedContextConfigClass.classContextConfig.classasArray(...)/** This test should never pass, simply because Spring does not support a hybrid ... */HalfConventionBasedAndHalfAliasedComposedContextConfigClassV1.classHalfConventionBasedAndHalfAliasedComposedContextConfigClassV2.classgetMergedAnnotationAttributesWithHalfConventionBasedAndHalfAliasedComposedAnnotation(...)String[] expectedString simpleNameAliasedComposedContextConfigClass.classAliasedValueComposedContextConfigClass.classComposedImplicitAliasesContextConfigClass.classImplicitAliasesContextConfig.classassertGetMergedAnnotation(...)ImplicitAliasesContextConfigClass1.classImplicitAliasesContextConfigClass2.classImplicitAliasesContextConfigClass3.classTransitiveImplicitAliasesContextConfigClass.classSingleLocationTransitiveImplicitAliasesContextConfigClass.classTransitiveImplicitAliasesWithSkippedLevelContextConfigClass.classSingleLocationTransitiveImplicitAliasesWithSkippedLevelContextConfigClass.classContextConfig contextConfigObject[] expectedslocations(...)ImplicitAliasesContextConfig configgroovyScripts(...)xmlFiles(...)ImplicitAliasesWithDefaultsClass.classAliasesWithDefaults.classAliasesWithDefaults annotationa1(...)a2(...)InvalidConventionBasedComposedContextConfigClass.classAnnotationConfigurationException.classShadowedAliasComposedContextConfigClass.classSubInheritedAnnotationInterface.classSubSubInheritedAnnotationInterface.classSubNonInheritedAnnotationInterface.classSubSubNonInheritedAnnotationInterface.class/** Bridge/bridged method setup code copied from ... */MetaAndLocalTxConfigClass.classAliasedTransactionalComponentClass.classAliasedTransactional.classAliasedTransactional annotationqualifier(...)assertComponentScanAttributes(...)TestComponentScanClass.classFilter[] excludeFiltersFilter.classList<String> patternsnew Function<Filter,String>(...) { ... }/** This test ensures that {@link AnnotationUtils#postProcessAnnotationAttributes} ... */ComponentScanWithBasePackagesAndValueAliasClass.classComposedTransactionalClass.classConventionBasedSinglePackageComponentScanClass.classAliasForBasedSinglePackageComponentScanClass.classString[] xmlLocationsString[] propFilesAliasedComposedContextConfigAndTestPropSourceClass.classTestPropSource testPropSourceTestPropSource.classString[] EMPTYSpringAppConfigClass.classassertWebMapping(...)WebController.classWebMapping webMappingWebMapping.classpath(...)Constructor<?> deprecatedCtorResourceHolder.classTransactionalServiceImpl.classSet<Transactional> allMergedAnnotationsImplementsInterfaceWithGenericAnnotatedMethod.classOrder orderExtendsBaseClassWithGenericAnnotatedMethod.classForAnnotationsClass.classValueAttribute annotationValueAttributeMetaMetaClass.classValueAttribute.class/** Mock of {@code org.springframework.test.context.TestPropertySource}. *//** Mock of {@code org.springframework.test.context.ContextConfiguration}. *//** This hybrid approach for annotation attribute overrides with transitive implicit ... */// intentionally omitted: attribute = "locations"// intentionally omitted: attribute = "locations" (SPR-14069)/** Although the configuration declares an explicit value for 'value' and ... *//** Mock of {@code org.springframework.boot.test.SpringApplicationConfiguration}. *//** Mock of {@code org.springframework.context.annotation.ComponentScan} */// Intentionally no alias declaration for "value"// See org.springframework.core.env.EnvironmentSystemIntegrationTests#mostSpecificDerivedClassDrivesEnvironment_withDevEnvAndDerivedDevConfigClass// See org.springframework.core.env.EnvironmentSystemIntegrationTests// Verify contracts between utility methods:// 1) Find and merge AnnotationAttributes from the annotation hierarchy// 2) Synthesize the AnnotationAttributes back into the target annotation// 3) Verify that the AnnotationAttributes and synthesized annotation are equivalent// Synthesized annotation// Merged annotation// 'value' in @SpringAppConfig should not override 'value' in @ContextConfig// SPR-16060// SPR-17146// gh-22655// Trigger the NPE as originally reported in the bug// Also specifically test we get different instances// gh-22703// Override default "txMgr" from @TxComposedWithOverride with "localTxMgr"import ImplicitAliasesContextConfig/** Unit tests for {@link AnnotationAttributes}. ... */new LinkageError(...)Filter filterFilteredClass.classAnnotationAttributes[] arrayFilter[] filtersfilters.lengthFilter retrievedFilterFilter[] retrievedFiltersnew Filter[]retrievedFilters.lengthString[] valueColor WHITE, ...;// Store single elements// Get back arrays of single elementsAnnotationAwareOrderComparator.classnew B2(...)new A2(...)/** Tests to ensure back-compatibility with Spring Framework 5.1. ... */Class<WithMetaMetaTestAnnotation1AndMetaTestAnnotation2> sourceWithMetaMetaTestAnnotation1AndMetaTestAnnotation2.classMergedAnnotation<TestAnnotation> mergedAnnotationTestAnnotation previousVersionDefaultValueAnnotation synthesizedDefaultValueAnnotation.classWithDefaultValue.classTestEnum.ONETestEnum ONE, ...;TestEnum TWO, ...;// Merged annotation chooses lowest depth// AnnotatedElementUtils finds first/** Example class used to test {@link AnnotationsScanner} with enclosing classes. ... *//** Tests for {@link AnnotationFilter}. ... */AnnotationFilter FILTER, ...;TestAnnotation annotationWithTestAnnotation.classOtherAnnotation annotationWithOtherAnnotation.classOtherAnnotation.classClass<TestAnnotation> annotationTypeClass<OtherAnnotation> annotationTypeRetention.classAnnotationFilter.JAVAAnnotationFilter.NONE/** Tests that trigger annotation introspection failures and ensure that they are ... */FilteringClassLoader classLoadernew FilteringClassLoader(...)Class<?> withExampleAnnotationWithExampleAnnotation.classTypeNotPresentException.classClass<?> withExampleMetaAnnotationWithExampleMetaAnnotation.classClass<Annotation> exampleAnnotationClassExampleAnnotation.classClass<Annotation> exampleMetaAnnotationClassExampleMetaAnnotation.classAnnotationIntrospectionFailureTests.classFilteredType.classimport MirrorSetsimport UsesSunMisc/** Tests for {@link AnnotationTypeMappings} and {@link AnnotationTypeMapping}. ... */SimpleAnnotation.classflatExtracting(...)getAll(...)new ThrowingExtractor<AnnotationTypeMapping,Object,RuntimeException>(...) { ... }WithSpringLangAnnotation.classMetaAnnotated.classAA.classAB.classABC.classWithRepeatedMetaAnnotations.classRepeating.classSelfAnnotated.classLoopA.classLoopB.classAliasForWithBothValueAndAttribute.classAliasForToSelfNonExistingAttribute.classAliasForToOtherNonExistingAttribute.classAliasForToOtherNonExistingAttributeTarget.classAliasForToSelf.classAliasForWithArrayCompatibleReturnTypes.classAliasForWithArrayCompatibleReturnTypesTarget.classAliasForWithIncompatibleReturnTypes.classAliasForWithIncompatibleReturnTypesTarget.classAliasForToSelfAnnotatedToOtherAttribute.classassertMixedImplicitAndExplicitAliases(...)AliasForWithMixedImplicitAndExplicitAliasesV1.classAliasForWithMixedImplicitAndExplicitAliasesV2.classString metaAnnotationNameAliasPair.classAliasForNonMetaAnnotated.classAliasForNonMetaAnnotatedTarget.classAliasForSelfWithDifferentDefaults.classAliasForSelfWithMissingDefault.classAliasWithExplicitMirrorAndDifferentDefaults.classMapped.classMappedTarget.classThreeDeepA.classAnnotationTypeMapping mappingCThreeDeepB.classThreeDeepC.classMirrorSets mirrorSetsImplicitMirrors.classAnnotationTypeMapping mappingAMirrorSets mirrorSetsAAnnotationTypeMapping mappingBMirrorSets mirrorSetsBMirrorSets mirrorSetsCDefinedAttributes.classMethod[] resolvedAresolveMirrorSets(...)WithAliasPairA.classMethod[] resolvedBWithAliasPairB.classMethod[] resolvedWithSameValueAliasPair.classWithDefaultValueAliasPair.classWithDifferentValueAliasPair.classMultipleRoutesToAliasA.classAnnotationTypeMapping mappingsAAnnotationTypeMapping mappingsBMultipleRoutesToAliasB.classAnnotationTypeMapping mappingsCMultipleRoutesToAliasC.classConventionToExplicitAliases.classConventionToExplicitAliasesTarget.classClassValue.classClassValueWithDefault.classClassArrayValueWithDefault.classNestedValue.classMap<String,Object> valueMap<String,String> attributesMergedAnnotation<ClassValue> valueOutputStream.classint[] resolvedAnnotationTypeMapping candidatenew IntFunction<AnnotationTypeMapping>(...) { ... }Repeatings.class// attempted implicit alias via attribute override// explicit local aliasAliasWithExplicitMirrorAndDifferentDefaultsTarget.classImplicitMirrorsTarget.classDefinedAttributesTarget.class// gh-24375// AnnotationTypeMappings does not implement Iterable so we don't create// too many garbage Iteratorsimport NonPublicAnnotatedClassimport static AnnotationUtils.VALUEimport static AnnotationUtils.findAnnotationimport static AnnotationUtils.findAnnotationDeclaringClassimport static AnnotationUtils.findAnnotationDeclaringClassForTypesimport static AnnotationUtils.getAnnotationimport static AnnotationUtils.getAnnotationAttributesimport static AnnotationUtils.getDeclaredRepeatableAnnotationsimport static AnnotationUtils.getDefaultValueimport static AnnotationUtils.getRepeatableAnnotationsimport static AnnotationUtils.getValueimport static AnnotationUtils.isAnnotationDeclaredLocallyimport static AnnotationUtils.isAnnotationInheritedimport static AnnotationUtils.isAnnotationMetaPresentimport static AnnotationUtils.synthesizeAnnotation/** Unit tests for {@link AnnotationUtils}. ... */// @since 4.2SimpleFoo.classboolean runningInEclipsenew Predicate<StackTraceElement>(...) { ... }ImplementsInterfaceWithAnnotatedMethod.classSubOfImplementsInterfaceWithAnnotatedMethod.classSubOfAbstractImplementsInterfaceWithAnnotatedMethod.class// @since 4.1.2Component componentClassWithLocalMetaAnnotationAndMetaAnnotatedInterface.class// @since 4.0.3Transactional transactionalreadOnly(...)SubSubClassWithInheritedMetaAnnotation.classMetaMetaAnnotatedClass.classMetaMetaMetaAnnotatedClass.classTransactionalClass.classTransactional txfindAnnotationDeclaringClass(...)NonAnnotatedInterface.classInheritedAnnotationClass.classSubInheritedAnnotationClass.classNonInheritedAnnotationClass.classSubNonInheritedAnnotationClass.classList<Class<? extends Annotation>> transactionalCandidateListList<Class<? extends Annotation>> orderCandidateListfindAnnotationDeclaringClassForTypes(...)List<Class<? extends Annotation>> candidatesTransactionalAndOrderedClass.classSubTransactionalAndOrderedClass.classisAnnotationInherited(...)isAnnotationMetaPresent(...)ComponentScan componentScanComponentScanClass.classNonPublicAnnotatedClass.classRepeatable repeatableMyRepeatable.classMyRepeatableContainer.classInterfaceWithRepeated.classSet<MyRepeatable> annotationsnew Function<MyRepeatable,String>(...) { ... }List<String> expectedLocationsSet<ContextConfig> annotationsConfigHierarchyTestCase.classList<String> locationsnew Function<ContextConfig,String>(...) { ... }location(...)Hierarchy.classList<String> expectedValuesJavaList<String> expectedValuesSpringMyRepeatable[] arraygetAnnotationsByType(...)MyRepeatableClass.classSet<MyRepeatable> setSubMyRepeatableClass.classSubMyRepeatableWithAdditionalLocalDeclarationsClass.classSubSubMyRepeatableWithAdditionalLocalDeclarationsClass.classgetDeclaredAnnotationsByType(...)ImplicitAliasesWithMissingDefaultValuesContextConfigClass.classClass<ImplicitAliasesWithMissingDefaultValuesContextConfig> annotationTypeImplicitAliasesWithMissingDefaultValuesContextConfig.classImplicitAliasesWithMissingDefaultValuesContextConfig configwithMessageStartingWith(...)ImplicitAliasesWithDifferentDefaultValuesContextConfigClass.classClass<ImplicitAliasesWithDifferentDefaultValuesContextConfig> annotationTypeImplicitAliasesWithDifferentDefaultValuesContextConfig.classImplicitAliasesWithDifferentDefaultValuesContextConfig configImplicitAliasesWithDuplicateValuesContextConfigClass.classClass<ImplicitAliasesWithDuplicateValuesContextConfig> annotationTypeImplicitAliasesWithDuplicateValuesContextConfig.classImplicitAliasesWithDuplicateValuesContextConfig configlocation1(...)Component synthesizedComponentComponentScanSingleFilter componentScanComponentScanSingleFilterClass.classComponentScanSingleFilter.classMap<String,Object> filterMapComponentScanSingleFilter synthesizedComponentScanMap<String,Object>[] filtersnew Function<Map<String,Object>,String>(...) { ... }ComponentScan synthesizedComponentScanexcludeFilters(...)AnnotationWithDefaults annotationWithDefaultsAnnotationWithDefaults.classtext(...)predicate(...)Get getGet.classassertAnnotationSynthesisFromMapWithImplicitAliases(...)location2(...)location3(...)xmlFile(...)groovyScript(...)assertMissingTextAttribute(...)AnnotationWithoutDefaults.classTestRepeatablesClass.classTestRepeatable.classTestRepeatableContainer.classMyRepeatableContainer annotationMyRepeatableMeta1And2.classextracting(...)new ThrowingExtractor<MyRepeatable,String,RuntimeException>(...) { ... }DeprecatedClass.classSubclassOfDeprecatedClass.classnew RequestMethod(...)RequestMethod GET, ...;RequestMethod POST, ...;/** Mock of {@code org.springframework.web.bind.annotation.RequestMapping}. *//** Mock of {@code org.springframework.web.bind.annotation.GetMapping}, except ... */RequestMethod.GET/** Mock of {@code org.springframework.web.bind.annotation.PostMapping}, except ... */RequestMethod.POST/** mapping is logically "equal" to handleMappedWithPathAttribute(). *//** Mock of {@code org.springframework.test.context.ContextHierarchy}. */// @ContextConfig --> Intentionally NOT meta-present// Attribute value intentionally matches attribute name:// intentionally omitted: attribute = "value"ImplicitAliasesWithImpliedAliasNamesOmittedContextConfig.classImplicitAliasesForAliasPairContextConfig.class/** Mock of {@code org.springframework.context.annotation.ComponentScan}. */// @Order is not @Inherited// getAnnotation() does not search on interfaces// findAnnotation() does search on interfaces// As of JDK 8, invoking getAnnotation() on a bridge method actually finds an// annotation on its 'bridged' method [1]; however, the Eclipse compiler will not// support this until Eclipse 4.9 [2]. Thus, we effectively ignore the following// assertion if the test is currently executing within the Eclipse IDE.// [1] https://bugs.openjdk.java.net/browse/JDK-6695379// [2] https://bugs.eclipse.org/bugs/show_bug.cgi?id=495396// TransactionalClass is NOT annotated or meta-annotated with @Component// no class-level annotation// inherited class-level annotation; note: @Transactional is inherited// non-inherited class-level annotation; note: @Order is not inherited,// but findAnnotationDeclaringClass() should still find it on classes.// but findAnnotationDeclaringClassForTypes() should still find it on classes.// class hierarchy mixed with @Transactional and @Order declarations// non-inherited class-level annotation; note: @Order is not inherited// isAnnotationInherited() does not currently traverse interface hierarchies.// Thus the following, though perhaps counter intuitive, must be false:// Java 8// Spring// When container type is omitted and therefore inferred from @Repeatable// Modify nested map// Modify nested maps// 1) Get an annotation// 2) Convert the annotation into AnnotationAttributes// 3) Synthesize the AnnotationAttributes back into an annotation// 4) Verify that the original and synthesized annotations are equivalent// gh-22702// gh-23856// gh-23929/** Tests for {@link AnnotationsScanner}. ... */Class<?> sourceWithNoAnnotations.classWithSingleAnnotation.classWithMultipleAnnotations.classWithSingleSuperclass.classWithSingleInterface.classWithHierarchy.classWithSingleSuperclassAndDoubleInherited.classnew Function<Annotation,Class<? extends Annotation>>(...) { ... }new Function<Class<? extends Annotation>,String>(...) { ... }TestInheritedAnnotation2.classMethod sourcemethodFrom(...)BridgedMethod.classIgnorable.classMultipleMethods.classGenericOverride.classGenericNonOverride.classAnnotationEnclosingClassSample.EnclosedStatic.EnclosedStaticStatic.classAnnotationEnclosingClassSample.EnclosedStatic.EnclosedStaticStaticAnnotationEnclosingClassSample.EnclosedStaticAnnotationEnclosingClassSample.EnclosedInner.EnclosedInnerInner.classAnnotationEnclosingClassSample.EnclosedInner.EnclosedInnerInnerAnnotationEnclosingClassSample.EnclosedInnernew AnnotationsProcessor<Object,String>(...) { ... }List<Integer> indexesnew AnnotationsProcessor<AnnotationsScannerTests,String>(...) { ... }new AnnotationsProcessor<AnnotationsScannerTests,Object>(...) { ... }trackIndexedAnnotations(...)new Predicate<Annotation>(...) { ... }nonNull(...)new Function<Annotation,String>(...) { ... }indexedName(...)// continue searching/** Tests for {@link AttributeMethods}. ... */AttributeMethods.NONENoAttributes.classMultipleAttributes.classnew ThrowingExtractor<Method,Object,RuntimeException>(...) { ... }ValueOnly.classNonValueOnly.classClassArrayValue.classDefaultValueAttribute.classClassValue annotationmockAnnotation(...)import ThrowingCallableimport static AnnotatedElementUtils.findMergedRepeatableAnnotationsimport static AnnotatedElementUtils.getMergedRepeatableAnnotations/** Unit tests that verify support for getting and finding all composed, repeatable ... */expectNonRepeatableAnnotation(...)NonRepeatable.classexpectContainerMissingValueAttribute(...)InvalidRepeatable.classContainerMissingValueAttribute.classexpectContainerWithNonArrayValueAttribute(...)ContainerWithNonArrayValueAttribute.classexpectContainerWithArrayValueAttributeButWrongComponentType(...)ContainerWithArrayValueAttributeButWrongComponentType.classassertGetRepeatableAnnotations(...)RepeatableClass.classSubRepeatableClass.classComposedRepeatableClass.classComposedRepeatableMixedWithContainerClass.classComposedContainerClass.classNoninheritedRepeatableClass.classSet<Noninherited> annotationsNoninherited.classassertNoninheritedRepeatableAnnotations(...)SubNoninheritedRepeatableClass.classassertFindRepeatableAnnotations(...)Set<PeteRepeat> peteRepeatsPeteRepeat.classIterator<PeteRepeat> iteratorIterator<Noninherited> iteratorPeteRepeats.classNoninheriteds.class// InvalidRepeatable[] value();/** Tests for {@link MergedAnnotation} to ensure the correct class loader is ... */TestMetaAnnotation.classTestReference.classString TEST_ANNOTATION, ...;String TEST_META_ANNOTATION, ...;String WITH_TEST_ANNOTATION, ...;String TEST_REFERENCE, ...;TestClassLoader childnew TestClassLoader(...)MergedAnnotations mergedAnnotationsAnnotation synthesizedAnnotation synthesizedMetaAnnotation utilsMetagetEnumAttribute(...)getClassAttribute(...)Method classValueMethodTestEnum.TWOTestEnum THREE, ...;// We should have loaded the source and initial annotation from child// The meta-annotation should have been loaded by the parent// MergedAnnotation should follow the same class loader logic// Also check utils version/** Tests for {@link MergedAnnotationCollectors}. ... */Set<TestAnnotation> setnew ThrowingExtractor<TestAnnotation,Object,RuntimeException>(...) { ... }new Predicate<TestAnnotation>(...) { ... }Annotation[] arrayTestAnnotation[] arraynew IntFunction<TestAnnotation[]>(...) { ... }new TestAnnotation[]new Function<TestAnnotation,String>(...) { ... }MultiValueMap<String,Object> mapnew Function<MergedAnnotation<TestAnnotation>,MergedAnnotation<TestAnnotation>>(...) { ... }filterDefaultValues(...)WithTestAnnotations.classTestAnnotations.class/** Tests for {@link MergedAnnotationPredicates}. ... */MergedAnnotation<TestAnnotation> annotationaccepts(...)rejects(...)MissingAnnotation.classList<MergedAnnotation<TestAnnotation>> filteredWithMultipleTestAnnotation.classnew Function<MergedAnnotation<TestAnnotation>,Object>(...) { ... }firstCharOfValue(...)new Function<MergedAnnotation<TestAnnotation>,String>(...) { ... }new Function<MergedAnnotation<TestAnnotation>,Character>(...) { ... }/** Tests for {@link MergedAnnotationsCollection}. ... */getDirectAndSimple(...)List<Class<?>> typesDirect.classMeta1.classMeta2.classMeta11.classSpliterator<MergedAnnotation<Annotation>> spliteratorforEachRemaining(...)estimateSize(...)Missing.classgetMultiRoute1(...)MultiRouteTarget.classnew Predicate<MergedAnnotation<MultiRouteTarget>>(...) { ... }MergedAnnotationSelector<MultiRouteTarget> deepestnew MergedAnnotationSelector<MultiRouteTarget>(...) { ... }new Consumer<MergedAnnotation<MultiRouteTarget>>(...) { ... }MergedAnnotation<Aliased> rootAliased.classMergedAnnotation<AliasTarget> metaAnnotationAliasTarget.classList<MergedAnnotation<?>> listMultiRoute1.class/** Unit tests that verify support for finding multiple composed annotations on a single ... */// See SPR-13486assertInheritedStrategyBehavior(...)MultipleComposedCachesClass.classSubMultipleComposedCachesClass.classMultipleNoninheritedComposedCachesClass.classSubMultipleNoninheritedComposedCachesClass.classComposedPlusLocalCachesClass.classMultipleComposedCachesOnInterfaceClass.classassertTypeHierarchyStrategyBehavior(...)ComposedCacheOnInterfaceAndLocalCacheClass.classgetBridgeMethod(...)new Function<MergedAnnotation<Cacheable>,String>(...) { ... }// @formatter:off// @formatter:onimport ThrowableTypeAssert/** Tests for {@link MergedAnnotations} and {@link RepeatableContainers} that ... */// See SPR-13973new Consumer<IllegalArgumentException>(...) { ... }nonRepeatableRequirements(...)assertThatAnnotationConfigurationException(...)new Consumer<AnnotationConfigurationException>(...) { ... }missingValueAttributeRequirements(...)nonArrayValueAttributeRequirements(...)wrongComponentTypeRequirements(...)Set<PeteRepeat> annotationsnew Function<PeteRepeat,String>(...) { ... }new Function<Noninherited,String>(...) { ... }Class<WithRepeatedMetaAnnotationsClass> elementWithRepeatedMetaAnnotationsClass.classSearchStrategy searchStrategyAnnotationFilter annotationFilterStream<Class<? extends Annotation>> annotationTypesnew Function<MergedAnnotation<Annotation>,Annotation>(...) { ... }RepeatableContainers containershasCauseInstanceOf(...)import static RetentionPolicy.RUNTIME/** Tests for {@link MergedAnnotations} and {@link MergedAnnotation}. These tests ... */SearchStrategy strategyStream<Class<?>> classesnew Function<MergedAnnotation<Annotation>,Class<?>>(...) { ... }getMetaSource(...)/** Note: this functionality is required by ... */ContextConfiguration.classConventionBasedComposedContextConfigurationClass.classHalfConventionBasedAndHalfAliasedComposedContextConfigurationClass1.classHalfConventionBasedAndHalfAliasedComposedContextConfigurationClass2.classAliasedComposedContextConfigurationClass.classAliasedValueComposedContextConfigurationClass.classImplicitAliasesContextConfiguration.classComposedImplicitAliasesContextConfigurationClass.classtestGetWithInherited(...)ImplicitAliasesContextConfigurationClass1.classImplicitAliasesContextConfigurationClass2.classImplicitAliasesContextConfigurationClass3.classTransitiveImplicitAliasesContextConfigurationClass.classSingleLocationTransitiveImplicitAliasesContextConfigurationClass.classTransitiveImplicitAliasesWithSkippedLevelContextConfigurationClass.classSingleLocationTransitiveImplicitAliasesWithSkippedLevelContextConfigurationClass.classInvalidConventionBasedComposedContextConfigurationClass.classShadowedAliasComposedContextConfigurationClass.classMergedAnnotation<AliasedTransactional> mergedAnnotationAliasedTransactional synthesizedAnnotationMetaMetaAliasedTransactionalClass.classtestGetWithTypeHierarchy(...)MergedAnnotation<Filter>[] excludeFiltersnew Function<MergedAnnotation<Filter>,String>(...) { ... }AliasedComposedContextConfigurationAndTestPropertySourceClass.classMergedAnnotation<?> contextConfigMergedAnnotation<?> testPropSourceTestPropertySource.classSpringApplicationConfigurationClass.classtestGetWithTypeHierarchyWebMapping(...)RequestMapping.classAnnotatedClass.NonAnnotatedInnerClass.classAnnotatedClass.NonAnnotatedInnerClassAnnotatedClass.NonAnnotatedStaticNestedClass.classAnnotatedClass.NonAnnotatedStaticNestedClassTransactionalStringGeneric.classgetSuperClassSourceWithTypeIn(...)MergedAnnotation<Filter>[] filtersMergedAnnotation<Annotation> mergedAnnotationMergedAnnotation<Order> annotationAnnotation declaredAnnotationStream<MergedAnnotation<MyRepeatable>> annotationsStream<String> valuesnew Function<MergedAnnotation<MyRepeatable>,String>(...) { ... }HierarchyClass.classnew Function<MergedAnnotation<TestConfiguration>,String>(...) { ... }String[] expectedValuesJavaString[] expectedValuesSpringtestRepeatables(...)testJavaRepeatables(...)testExplicitRepeatables(...)testStandardRepeatables(...)MyRepeatable[] annotationsnew Function<MergedAnnotation<MyRepeatable>,Object>(...) { ... }RequestMapping webMappingRequestMapping synthesizedWebMappingRequestMapping synthesizedAgainWebMappingId idId.classId synthesizedIdGeneratedValue generatedValueGeneratedValue.classGeneratedValue synthesizedGeneratedValue/** If an attempt is made to synthesize an annotation from an annotation instance ... */MergedAnnotation<RequestMapping> mergedAnnotation1RequestMapping synthesizedWebMapping1RequestMapping synthesizedWebMapping2AliasForWithMissingAttributeDeclaration annotationAliasForWithMissingAttributeDeclarationClass.classAliasForWithMissingAttributeDeclaration.classAliasForWithDuplicateAttributeDeclaration annotationAliasForWithDuplicateAttributeDeclarationClass.classAliasForWithDuplicateAttributeDeclaration.classAliasForNonexistentAttribute annotationAliasForNonexistentAttributeClass.classAliasForNonexistentAttribute.classAliasForWithMirroredAliasForWrongAttribute annotationAliasForWithMirroredAliasForWrongAttributeClass.classAliasForWithMirroredAliasForWrongAttribute.classAliasForAttributeOfDifferentType annotationAliasForAttributeOfDifferentTypeClass.classAliasForAttributeOfDifferentType.classAliasForWithMissingDefaultValues annotationAliasForWithMissingDefaultValuesClass.classAliasForWithMissingDefaultValues.classAliasForAttributeWithDifferentDefaultValue annotationAliasForAttributeWithDifferentDefaultValueClass.classAliasForAttributeWithDifferentDefaultValue.classAliasedComposedTestConfigurationNotMetaPresent annotationAliasedComposedTestConfigurationNotMetaPresentClass.classAliasedComposedTestConfigurationNotMetaPresent.classtestSynthesisWithImplicitAliases(...)ValueImplicitAliasesTestConfigurationClass.classLocation1ImplicitAliasesTestConfigurationClass.classXmlImplicitAliasesTestConfigurationClass.classGroovyImplicitAliasesSimpleTestConfigurationClass.classImplicitAliasesTestConfiguration configImplicitAliasesTestConfiguration.classImplicitAliasesTestConfiguration synthesizedtestSynthesisWithImplicitAliasesWithImpliedAliasNamesOmitted(...)ValueImplicitAliasesWithImpliedAliasNamesOmittedTestConfigurationClass.classLocationsImplicitAliasesWithImpliedAliasNamesOmittedTestConfigurationClass.classXmlFilesImplicitAliasesWithImpliedAliasNamesOmittedTestConfigurationClass.classImplicitAliasesWithImpliedAliasNamesOmittedTestConfiguration configImplicitAliasesWithImpliedAliasNamesOmittedTestConfiguration.classImplicitAliasesWithImpliedAliasNamesOmittedTestConfiguration synthesizedImplicitAliasesForAliasPairTestConfiguration configImplicitAliasesForAliasPairTestConfigurationClass.classImplicitAliasesForAliasPairTestConfiguration.classImplicitAliasesForAliasPairTestConfiguration synthesizedTransitiveImplicitAliasesTestConfiguration configTransitiveImplicitAliasesTestConfigurationClass.classTransitiveImplicitAliasesTestConfiguration.classTransitiveImplicitAliasesTestConfiguration synthesizedxml(...)groovy(...)TransitiveImplicitAliasesForAliasPairTestConfiguration configTransitiveImplicitAliasesForAliasPairTestConfigurationClass.classTransitiveImplicitAliasesForAliasPairTestConfiguration.classTransitiveImplicitAliasesForAliasPairTestConfiguration synthesizedImplicitAliasesWithMissingDefaultValuesTestConfigurationClass.classClass<ImplicitAliasesWithMissingDefaultValuesTestConfiguration> annotationTypeImplicitAliasesWithMissingDefaultValuesTestConfiguration.classImplicitAliasesWithMissingDefaultValuesTestConfiguration configImplicitAliasesWithDifferentDefaultValuesTestConfigurationClass.classClass<ImplicitAliasesWithDifferentDefaultValuesTestConfiguration> annotationTypeImplicitAliasesWithDifferentDefaultValuesTestConfiguration.classImplicitAliasesWithDifferentDefaultValuesTestConfiguration configImplicitAliasesWithDuplicateValuesTestConfigurationClass.classClass<ImplicitAliasesWithDuplicateValuesTestConfiguration> annotationTypeImplicitAliasesWithDuplicateValuesTestConfiguration.classImplicitAliasesWithDuplicateValuesTestConfiguration configMergedAnnotation<Component> annotationMergedAnnotation<ComponentScanSingleFilter> annotationMergedAnnotation<ComponentScan> annotationMergedAnnotation<AnnotationWithDefaults> annotationAnnotationWithDefaults synthesizedMergedAnnotation<TestConfiguration> annotationTestConfiguration synthesizedTestConfigurationMismatch.classsynthesizeFromMapWithAttributeAliasesThatOverrideArraysWithSingleElements(...)MergedAnnotation<GetMapping> annotationGetMapping.classGetMapping synthesizedtestSynthesisFromMapWithImplicitAliases(...)MergedAnnotation<ImplicitAliasesTestConfiguration> annotationtestMissingTextAttribute(...)Component synthesizedMethod methodWithPathRequestMapping webMappingWithAliasesMethod methodWithPathAndValueRequestMapping webMappingWithPathAndValueassertToStringForWebMappingWithPathAndValue(...)/** Fully reflection-based test that verifies support for synthesizing ... */Annotation synthesizedAnnotationHierarchy hierarchyHierarchy synthesizedHierarchyTestConfiguration[] configsTestConfiguration contextConfigTestConfigurationClass.classnew Predicate<TestConfiguration>(...) { ... }new ThrowingExtractor<TestConfiguration,String,RuntimeException>(...) { ... }CharsContainer charsContainerGroupOfCharsClass.classCharsContainer.classCharsContainer synthesizedCharsContainerchars(...)DefaultOverrideRoot.classDefaultOverrideClass.classMergedAnnotation<?> annotation1DefaultOverrideImplicitAliasMetaClass1.classMergedAnnotation<?> annotation2DefaultOverrideImplicitAliasMetaClass2.classDefaultOverrideExplicitAliasRoot.classDefaultOverrideExplicitAliasRootMetaMetaClass.classSpringApplicationConfiguration.classcontainsEntry(...)/** Although the configuration declares an explicit value for 'value' and requires a ... *//** Mimics javax.persistence.Id *//** Mimics javax.persistence.GeneratedValue */// SPR-13554: convention mapping mixed with AliasFor annotations// xmlConfigFiles can be used because it has an AliasFor annotation// locations doesn't apply because it has no AliasFor annotation// gh-23767// annotation on its 'bridged' method [1]; however, the Eclipse compiler// will not support this until Eclipse 4.9 [2]. Thus, we effectively ignore the// following assertion if the test is currently executing within the Eclipse IDE.// but we should still find it on classes.// but should still find it on classes.// but findAnnotationDeclaringClassForTypes() should still find it on// classes.// Since we're not traversing interface hierarchies the following,// though perhaps counter intuitive, must be false:// It doesn't make sense to synthesize @Id since it declares zero attributes.// It doesn't make sense to synthesize @GeneratedValue since it declares zero attributes with aliases.// Synthesizing an annotation from a different MergedAnnotation results in a different synthesized annotation instance.// Synthesizing an annotation from the same MergedAnnotation results in the same synthesized annotation instance.// Synthesizing an already synthesized annotation results in the original synthesized annotation instance.// Equality amongst standard annotations// Inequality amongst standard annotations// Equality amongst synthesized annotations// Equality between standard and synthesized annotations// Inequality between standard and synthesized annotations// Alter array returned from synthesized annotation// Re-retrieve the array from the synthesized annotation// gh-22654/** Tests for {@link MissingMergedAnnotation}. ... */MergedAnnotation<?> missing, ...;assertThatNoSuchElementException(...)this.missinggetBooleanArray(...)getChar(...)getShort(...)getShortArray(...)getIntArray(...)getLong(...)getLongArray(...)getDouble(...)getDoubleArray(...)getFloat(...)getFloatArray(...)getEnumArray(...)new Predicate<MergedAnnotation<?>>(...) { ... }Collections.EMPTY_MAPnew Function<MergedAnnotation<?>,ConcurrentReferenceHashMap<String,Object>>(...) { ... }ConcurrentReferenceHashMap<>.class/** Unit tests that verify support for finding multiple composed annotations on ... */assertGetAllMergedAnnotationsBehavior(...)Set<Cacheable> cacheablesIterator<Cacheable> iteratorCacheable cacheable1Cacheable cacheable2Class<MultipleComposedCachesOnInterfaceClass> elementassertFindAllMergedAnnotationsBehavior(...)Cacheable fooCacheableCacheable barCacheable/** Mock of {@code org.springframework.cache.annotation.Cacheable}. */AnnotationAwareOrderComparator comparator, ...;List<Object> itemsC c2assertOrder(...)A aB bList<?> itemsnew OrderSourceProvider(...) { ... }Object[] itemsexpected.lengthSimpleOrder.classSimplePriority.classOrderAndPriority.classNoOrder.class/** Tests for {@link PackagesAnnotationFilter}. ... */PackagesAnnotationFilter filterPackagesAnnotationFilter filter1PackagesAnnotationFilter filter2PackagesAnnotationFilter filter3/** Tests for {@link RepeatableContainers}. ... */Object[] valuesfindRepeatedAnnotationValues(...)WithNonRepeatable.classWithSingleStandardRepeatable.classStandardRepeatable.classWithStandardRepeatables.classStandardContainer.classWithExplicitRepeatables.classExplicitContainer.classExplicitRepeatable.classInvalidNoValue.classInvalidNotArray.classInvalidWrongArrayType.classRepeatableContainers c1RepeatableContainers c2RepeatableContainers c3RepeatableContainers c4extractValues(...)SynthesizingMethodParameter stringParameter, ...;SynthesizingMethodParameter longParameter, ...;SynthesizingMethodParameter intReturnType, ...;SynthesizingMethodParameter methodParameter/** Tests for {@link TypeMappedAnnotation}. See also ... */testExplicitMirror(...)WithExplicitMirrorA.classWithExplicitMirrorB.classTypeMappedAnnotation<ExplicitMirror> annotationgetTypeMappedAnnotation(...)ExplicitMirror.classTypeMappedAnnotation<?> annotationWithExplicitAliasToMetaAnnotation.classExplicitAliasToMetaAnnotation.classExplicitAliasMetaAnnotationTarget.classWithConventionAliasToMetaAnnotation.classConventionAliasToMetaAnnotation.classConventionAliasMetaAnnotationTarget.classArrayTypes.classMergedAnnotation<ArrayTypes> annotationnew ExampleEnum[]MergedAnnotation<Nested> nestedNested.classNestedContainer.classClassAttributes.classAnnotation rootAnnotationnew ExampleEnum(...)ExampleEnum ONE, ...;ExampleEnum TWO, ...;ExampleEnum THREE, ...;/** Class annotated with a non-public (i.e., package private) custom annotation ... *//** Non-public mock of {@code org.springframework.web.bind.annotation.RequestMapping}. ... *//** Class annotated with a non-public (i.e., package private) custom annotation. ... *//** Non-public (i.e., package private) custom annotation. ... */import AbstractDecoderTests...[] fooBytes, ...;...[] barBytes, ...;new ByteArrayDecoder(...)this.decoderMimeTypeUtils.TEXT_PLAINMimeTypeUtils.APPLICATION_JSONFlux<DataBuffer> inputdataBuffer(...)this.fooBytesthis.barBytestestDecodeAll(...)new Consumer<FirstStep<byte[]>>(...) { ... }verifyComplete(...)consumeNextWith(...)expectBytes(...)byte[] expectedthis.fooBytes.lengththis.barBytes.lengthtestDecodeToMonoAll(...)new Consumer<byte[]>(...) { ... }import AbstractEncoderTestsnew ByteArrayEncoder(...)this.encoderFlux<byte[]> inputtestEncodeAll(...)new Consumer<FirstStep<DataBuffer>>(...) { ... }// SPR-15464new ByteBufferDecoder(...)new Consumer<FirstStep<ByteBuffer>>(...) { ... }expectByteBuffer(...)ByteBuffer expectednew ByteBufferEncoder(...)Flux<ByteBuffer> inputnew Function<byte[],ByteBuffer>(...) { ... }import static StandardCharsets.ISO_8859_1import static StandardCharsets.US_ASCIIimport static StandardCharsets.UTF_16import static StandardCharsets.UTF_8StringBuffer.classFlux<CharSequence> inputexpectString(...)String sequencenew Consumer<Charset>(...) { ... }new DataBufferDecoder(...)this.bufferFactoryexpectDataBuffer(...)byte[] actualBytesnew DataBufferEncoder(...)flatMap(...)new Function<byte[],Publisher<? extends DataBuffer>>(...) { ... }new NettyByteBufDecoder(...)new Consumer<FirstStep<ByteBuf>>(...) { ... }copiedBuffer(...)ByteBuf expectednew Consumer<ByteBuf>(...) { ... }new NettyByteBufEncoder(...)Flux<ByteBuf> inputnew Function<byte[],ByteBuf>(...) { ... }// gh-20024import static ResolvableType.forClassnew ResourceDecoder(...)ByteArrayResource.classnew Consumer<FirstStep<Resource>>(...) { ... }expectComplete(...)new Consumer<Resource>(...) { ... }new Consumer<FirstStep<Object>>(...) { ... }ResourceDecoder.FILENAME_HINTnew Consumer<FirstStep<InputStreamResource>>(...) { ... }new Consumer<InputStreamResource>(...) { ... }fooBytes.lengthbarBytes.lengthimport StepVerifier...[] bytes, ...;new ResourceEncoder(...)Flux<Resource> inputFlux<Resource> inew InputException(...)expectError(...)InputException.classimport AbstractLeakCheckingTests/** Test cases for {@link ResourceRegionEncoder} class. ... */new ResourceRegionEncoder(...)ResourceRegionEncoder encoder, ...;ResolvableType resourceRegionMimeType allMimeTypeResourceRegion regionnew ResourceRegion(...)stringConsumer(...)Flux<ResourceRegion> regionsString boundarygenerateMultipartBoundaryString(...)ResourceRegionEncoder.BOUNDARY_STRING_HINTZeroDemandSubscriber subscribernew ZeroDemandSubscriber(...)Mono<ResourceRegion> regionsResource nonExistingEncodingException.class// gh-22107// Just subscribe without requestingimport DataBufferLimitExceptionimport static StandardCharsets.UTF_16BE/** Unit tests for {@link StringDecoder}. ... */ResolvableType TYPE, ...;MimeTypeUtils.TEXT_HTMLString uString eString otoDataBuffers(...)expectNext(...)Flux<DataBuffer> sourcetestDecode(...)List<byte[]> chunksnew ArrayList<byte[]>(...)chunk.lengthstringBuffer(...)new Consumer<FirstStep<String>>(...) { ... }setMaxInMemorySize(...)verifyError(...)DataBufferLimitException.classtestDecodeCancel(...)StringDecoder.DEFAULT_DELIMITERSFlux<String> outputtestDecodeToMono(...)// TODO: temporarily replace testDecodeAll with explicit decode/cancel/empty// see https://github.com/reactor/reactor-core/issues/2041//		testDecode(input, TYPE, step -> step.expectNext(u, e, o).verifyComplete(), null, null);//		testDecodeCancel(input, TYPE, null, null);//		testDecodeEmpty(TYPE, null, null);// gh-24339/** Tests for {@link TypeDescriptor}. ... */new ArrayList<List<String>>(...)new ArrayList<List<>>(...)new HashMap<String,List<Integer>>(...)new LinkedMultiValueMap<String,Integer>(...)new PassDownGeneric<Integer>(...)TypeDescriptor t1ParameterAnnotation.classTypeDescriptor tProperty propertyGenericType<Integer> genericBeannew IntegerType(...)GenericType<Number> genericBeannew NumberType(...)IntegerClass genericBeannew IntegerClass(...)MethodAnnotation1.classMethodAnnotation2.classMethodAnnotation3.classassertAnnotationFoundOnMethod(...)TypeDescriptorTests.classFieldAnnotation.classTypeDescriptor t2List<Integer> valueTypeDescriptor t3TypeDescriptor t4TypeDescriptor t5TypeDescriptor t6TypeDescriptor t7TypeDescriptor t8TypeDescriptor t9TypeDescriptor t10TypeDescriptor t11TypeDescriptor t12MethodParameter testAnnotatedMethodTypeDescriptor t13TypeDescriptor t14TypeDescriptor t15TypeDescriptor t16TypeDescriptor t17TypeDescriptor t18TypeDescriptor upCastupcast(...)CustomSet.classnew CustomSet(...)CustomMap.classnew CustomMap(...)TypeDescriptor mapTypeTypeDescriptor arrayTypeObjectOutputStream outputStreamObjectInputStream inputStreamTypeDescriptor readObject// Methods designed for test introspectionInteger fieldScalar, ...;// Fields designed for test introspectionList<String> listOfString, ...;List<List<String>> listOfListOfString, ...;...[] arrayOfListOfString, ...;List<Integer> listField, ...;Map<String,Integer> mapField, ...;Map<String,List<Integer>> nestedMapField, ...;Map<List<Integer>,List<Long>> fieldMap, ...;List<Map<Integer,String>> test4, ...;List<String> fieldAnnotated, ...;List<List<Integer>> listPreserveContext, ...;Map<List<Integer>,List<Integer>> mapPreserveContext, ...;Map<List<Integer>,List<Long>> property, ...;List<> notGenericList, ...;List<Number> isAssignableElementTypes, ...;Map<> notGenericMap, ...;Map<CharSequence,Number> isAssignableMapKeyValueTypes, ...;MultiValueMap<String,Integer> multiValueMap, ...;PassDownGeneric<Integer> passDownGeneric, ...;// Classes designed for test introspection// Annotations used on tested elements/** Tests for {@link Converter} ... */new Converter<Integer,Integer>(...) { ... }Converter<Integer,Integer> moduloTwo, ...;Converter<Integer,Integer> addOne, ...;andThen(...)this.moduloTwothis.addOneConverter<String,Integer> lengthnew Converter<String,Integer>(...) { ... }Converter<Integer,String> toStringnew Converter<Integer,String>(...) { ... }import ComparableComparator/** Tests for {@link ConvertingComparator}. ... */new StringToInteger(...)new TestComparator(...)StringToInteger converter, ...;TestComparator comparator, ...;new ConvertingComparator<String,Integer>(...)ConvertingComparator<String,Integer> convertingComparatortestConversion(...)assertCalled(...)ArrayList<Entry<String,Integer>> listcreateReverseOrderMapEntryList(...)Comparator<Entry<String,Integer>> comparatormapEntryKeys(...)new ComparableComparator<String>(...)Map<>.Entry<String,Integer>mapEntryValues(...)new ComparableComparator<Integer>(...)new ArrayList<Entry<String,Integer>>(...)import Color/** Unit tests for {@link DefaultConversionService}. ... */new HashMap<Integer,Foo>(...)DefaultConversionService conversionService, ...;short threeFoo.BARSubFoo.BAZSubFoo.BARUUID uuidString convertToStringUUID convertToUUIDCustomNumber.class// collection conversionList<?> resultString[] sourceStream<Integer> resultnew ToIntFunction<Integer>(...) { ... }ConverterRegistry registryList<Color> colorsnew ColorConverter(...)Color.WHITEColor.BLACKArrayList<?> resultInteger[] resultLong[] arraynew Long[]Long[] resultList<Integer> listCollection<?> resultList<Long> listLong resultCollection<String> sourceList<String> sourceListWrapper resultListWrapper.classnew Converter<List<>,ListWrapper>(...) { ... }new ListWrapper(...)Byte[] convertednew Byte[]TestEntity.classList<String> list1List<String> list2List<List<String>> listSet<String> fooList<Integer> barList<> barCollection<> valuesList<String> stringsList<Integer> integersMap<String,String> fooMap<Integer,Foo> mapFoo.BAZMap<String,Integer> hashMapList<?> convertedMap<String,String> stringsMap<Integer,Integer> integersProperties foo// generic object conversionnew ISBN(...)ISBN.constructorCountISBN.valueOfCountISBN.toStringCountISBN.classnew SSN(...)SSN.constructorCountSSN.toStringCountSSN.classConverterNotFoundException.classTestEntity eString convertedchar[] convertednew Converter<String,char[]>(...) { ... }String[][] gridList<String[]> convertedString[][] convertedBackbyte[] convertednew Converter<Byte,Byte>(...) { ... }MethodParameter parameterList<Integer> genericList, ...;// test fields and helpersStream<Integer> genericStream, ...;Map<Integer,Foo> genericMap, ...;EnumSet<Foo> enumSet, ...;Object assignableTarget, ...;Foo BAR, ...;Foo BAZ, ...;new SubFoo(...) { ... }SubFoo BAR, ...;SubFoo BAZ, ...;List<?> list, ...;int constructorCount, ...;int toStringCount, ...;SSN ssnssn.valueint valueOfCount, ...;ISBN isbnisbn.value// valueOf() invokes the constructor/** Tests for {@link ByteBufferConverter}. ... */new ByteArrayToOtherTypeConverter(...)new OtherTypeToByteArrayConverter(...)ByteBuffer convertbyte[] convertOtherType convertOtherType.classconvert.bytesOtherType otherTypenew OtherType(...)source.bytesTypeDescriptor sourceTypeTypeDescriptor targetTypeArrayList<Integer> resultList<String>[] arraynew List<>[]List<List<List<Integer>>> resultVector<String> vectornew Vector<String>(...)testCollectionConversionToArrayList(...)CollectionToCollectionConverter converterTypeDescriptor typeObject myConvertedList<?> inputnew TestResource(...)List<String> resourcesList<Object> resourcesMyEnum.CArrayList<Integer> scalarListTarget, ...;List<Integer> emptyListTarget, ...;ArrayList<Integer> emptyListDifferentTarget, ...;List<List<List<Integer>>> objectToCollection, ...;List<String> strings, ...;Collection<?> wildcardCollection, ...;List<Resource> resources, ...;EnumSet<MyEnum> enumSet, ...;MyEnum C, ...;import SystemColorimport static Comparator.naturalOrder/** Unit tests for {@link GenericConversionService}. ... */new UntypedConverter(...)new Converter<CharSequence,Integer>(...) { ... }// SPR-8718SystemColor.classBoolean bInteger threeList<Object> rawObject convertedMap<Object,Object> rawnew MyInterfaceImplementer(...)new MyBaseInterfaceToStringConverter(...)String[] convertednew MyInterface[]new MyInterfaceImplementer[]Resource[] convertedList<String> descriptionsnaturalOrder(...)new Function<Resource,String>(...) { ... }new MyStringArrayToResourceArrayConverter(...)Integer[] convertednew MyStringArrayToIntegerArrayConverter(...)new MyStringToIntegerArrayConverter(...)WithCopyConstructor valuenew WithCopyConstructor(...)WithCopyConstructor.classSet<ConvertiblePair> setGenericConverter.ConvertiblePairConvertiblePair pairConvertiblePair pairEqualConvertiblePair pairOppositeremoveConvertible(...)MyConditionalConverter converternew MyConditionalConverter(...)getMatchAttempts(...)MyConditionalConverterFactory converternew MyConditionalConverterFactory(...)getNestedMatchAttempts(...)new MyConditionalColorConverter(...)new NonConditionalGenericConverter(...)MyConditionalGenericConverter converternew MyConditionalGenericConverter(...)getSourceTypes(...)new Predicate<TypeDescriptor>(...) { ... }EnumWithSubclass.FIRSTnew MyEnumInterfaceToStringConverter<MyEnum>(...)new StringToMyEnumInterfaceConverterFactory(...)MyEnum.classnew StringToMyEnumBaseInterfaceConverterFactory(...)String sourcenew MyStringToRawCollectionConverter(...)new MyStringToGenericCollectionConverter(...)new MyStringToStringCollectionConverter(...)new MyStringToIntegerCollectionConverter(...)String annotatedString, ...;Color activeColor, ...;Color inactiveColor, ...;Map<String,?> wildcardMap, ...;Collection<> rawCollection, ...;Collection<?> genericCollection, ...;Collection<String> stringCollection, ...;Collection<Integer> integerCollection, ...;new Function<String,DescriptiveResource>(...) { ... }new IntFunction<Resource[]>(...) { ... }new Function<String,Integer>(...) { ... }new IntFunction<Integer[]>(...) { ... }String[] srcArrayint matchAttempts, ...;List<TypeDescriptor> sourceTypes, ...;MyConditionalConverter converter, ...;String code, ...;this.codenew EnumWithSubclass(...) { ... }EnumWithSubclass FIRST, ...;new StringToMyEnumInterfaceConverter<>(...)new StringToMyEnumBaseInterfaceConverter<>(...)getBaseCode(...)ExampleAnnotation annactive(...)// SPR-9566// SPR-9692// The following is unpleasant but a consequence of the generic collection converter above...// The following is unpleasant but a consequence of the raw collection converter above...Map<Integer,Integer> resultMap<Integer,List<Integer>> resultLinkedHashMap<String,String> resultNoDefaultConstructorMap<String,Integer> mapnew NoDefaultConstructorMap<String,Integer>(...)NoDefaultConstructorMap<>.classMap<String,Integer> resultMultiValueMap<String,Integer> sourceMultiValueMap<String,String> convertedMap<String,Integer> sourceEnumMap<MyEnum,Integer> resultnew EnumMap<MyEnum,Integer>(...)Map<Integer,Integer> scalarMapTarget, ...;Map<Integer,List<Integer>> collectionMapTarget, ...;Map<String,List<String>> sourceCollectionMapTarget, ...;Map<String,String> emptyMapTarget, ...;LinkedHashMap<String,String> emptyMapDifferentTarget, ...;MultiValueMap<String,String> multiValueMapTarget, ...;Map<> notGenericMapSource, ...;EnumMap<MyEnum,Integer> enumMap, ...;// SPR-9284/** Tests for {@link StreamConverter}. ... */StreamConverter streamConverter, ...;this.streamConverterStream<Integer> streamTypeDescriptor listOfStringsTypes.classTypeDescriptor arrayOfLongsLong[] contentcontent.lengthList<String> streamTypeDescriptor streamOfIntegerStream<Integer> contentInteger[] streamTypeDescriptor streamOfBooleanStream<Boolean> contentnew Converter<Integer,Boolean>(...) { ... }new Predicate<Boolean>(...) { ... }Stream<Object> contentList<String> listOfStrings, ...;...[] arrayOfLongs, ...;Stream<Integer> streamOfIntegers, ...;Stream<Boolean> streamOfBooleans, ...;Stream<> rawStream, ...;List<> rawList, ...;/** Tests for {@link CompositePropertySource}. ... */PropertySource<?> p1PropertySource<?> p2PropertySource<?> p3int i3/** Unit tests covering the extensibility of {@link AbstractEnvironment}. ... */// -- tests relating to customizing reserved default profiles ----------------------Environment envnew AbstractEnvironment(...) { ... }defaultProfile(...)new CustomEnvironment(...)new HashSet<String>(...) { ... }AbstractEnvironment.RESERVED_DEFAULT_PROFILE_NAME// finally, issue additional assertions to cover all combinations of calling these// methods, however unlikely.// -- tests relating to customizing property sources -------------------------------import OptionParser/** Unit tests for {@link JOptCommandLinePropertySource}. ... */OptionParser parsernew OptionParser(...)OptionSet optionsnew JOptCommandLinePropertySource(...)withRequiredArg(...)withOptionalArg(...)CommandLinePropertySource<?> pswithValuesSeparatedBy(...)OptionSet optionSetEnumerablePropertySource<?> psacceptsAll(...)String nonOptionArgssetNonOptionArgsPropertyName(...)ofType(...)OptionEnum.classnew OptionEnum(...)OptionEnum VAL_1, ...;// gh-24464// <-- no options whatsoeverString bogusPSaddAfter(...)Iterator<PropertySource<?>> itnew Predicate<PropertySource<?>>(...) { ... }/** Tests for {@link Profiles}. ... */Profiles profilesactiveProfiles(...)assertOrExpression(...)assertAndExpression(...)assertOfNotAndExpression(...)assertOfAndExpressionWithInvertedSingleElement(...)assertOfOrExpressionWithInvertedSingleElement(...)assertOfNotOrExpression(...)assertComplexExpression(...)assertMalformed(...)new Supplier<Profiles>(...) { ... }String expression1String expression2Profiles profiles1Profiles profiles2assertEqual(...)assertHashCode(...)hasSameHashCodeAs(...)new MockActiveProfiles(...)List<String> activeProfiles, ...;// Ensure order of individual expressions does not affect equals().// Ensure order of individual expressions does not affect hashCode().// The following if-condition (which basically mimics// AbstractEnvironment#validateProfile(String)) is necessary in order// to ensure that the Profiles implementation returned by Profiles.of()// never passes an invalid (parsed) profile name to the active profiles// predicate supplied to Profiles#matches(Predicate<String>)./** Unit tests for {@link PropertySource} implementations. ... */Map<String,Object> map1new HashMap<String,Object>(...) { ... }Map<String,Object> map2MapPropertySource mpsPropertySource<?> ps1List<PropertySource<?>> propertySourcesPropertySource<?> ps1replacementPropertySource<?> ps2// notice - different map// true because linkedlist allows duplicatesProperties testProperties, ...;PropertyResolver resolverMap<String,Object> nullablePropertiesTestType.classString value1String value2HashMap<String,Object> mapPropertyResolver propertyResolverMutablePropertySources psConfigurablePropertyResolver pr// java.util.Properties does not allow null values (because Hashtable does not)// before construction// after construction and first resolution// 'local' was added first so has precedence// replace 'local' with new property source// 'system' now has precedence// no properties have been marked as required -> validation should pass// mark which properties are required// neither foo nor bar properties are present -> validating should throw// add foo property -> validation should fail only on missing 'bar' property// add bar property -> validation should pass, even with an empty string value// nested placeholders// deeply nested placeholders// unresolvable placeholder// unresolvable w/ default// cyclic reference left// cyclic reference right// placeholders nested within the value of "p4" are unresolvable and cause an// exception by default// relax the treatment of unresolvable nested placeholders// and observe they now pass through unresolved// resolve[Nested]Placeholders methods behave as usual regardless the value of// ignoreUnresolvableNestedPlaceholders/** Unit tests for {@link SimpleCommandLineArgsParser}. ... */SimpleCommandLineArgsParser parser, ...;CommandLineArgs argsList<String> nonOptions/** Unit tests for {@link SimpleCommandLinePropertySource}. ... */new SimpleCommandLinePropertySource(...)CommandLinePropertySource<>.COMMAND_LINE_PROPERTY_SOURCE_NAMEString[] nonOptionArgsArrayList<String> nonOptionArgsListimport static AbstractEnvironment.ACTIVE_PROFILES_PROPERTY_NAMEimport static AbstractEnvironment.DEFAULT_PROFILES_PROPERTY_NAMEimport static AbstractEnvironment.RESERVED_DEFAULT_PROFILE_NAME/** Unit tests for {@link StandardEnvironment}. ... */String ALLOWED_PROPERTY_NAME, ...;String ALLOWED_PROPERTY_VALUE, ...;String DISALLOWED_PROPERTY_NAME, ...;String DISALLOWED_PROPERTY_VALUE, ...;String STRING_PROPERTY_NAME, ...;String STRING_PROPERTY_VALUE, ...;Object NON_STRING_PROPERTY_NAME, ...;Object NON_STRING_PROPERTY_VALUE, ...;ConfigurableEnvironment childConfigurableEnvironment parentStandardEnvironment.SYSTEM_ENVIRONMENT_PROPERTY_SOURCE_NAMESystemEnvironmentPropertySource.classgetActiveProfiles(...).lengthgetDefaultProfiles(...).lengthString[] activeProfilesactiveProfiles.lengthsetFlag(...)Map<?,?> systemPropertiesReadOnlySystemAttributesMap.classMap<String,Object> systemEnvironment// notice whitespace// succeeds// non-string keys and values work fine... until the security manager is introduced below// see https://download.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getProperties()// see https://download.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getProperty(java.lang.String)// nothing we can do here in terms of warning the user that there was// actually a (non-string) value available. By this point, we only// have access to calling System.getProperty(), which itself returns null// if the value is non-string.  So we're stuck with returning a potentially// misleading null.// in the case of a non-string *key*, however, we can do better.  Alert// the user that under these very special conditions (non-object key +// SecurityManager that disallows access to system properties), they// cannot do what they're attempting.//see https://download.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getenv()//see https://download.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#getenv(java.lang.String)/** Unit tests for {@link SystemEnvironmentPropertySource}. ... */Map<String,Object> envMap, ...;PropertySource<?> ps, ...;new SystemEnvironmentPropertySource(...) { ... }/** Unit tests that serve as regression tests for the bugs described in SPR-6888 ... */String PACKAGE_PATH, ...;String NONEXISTENT_RESOURCE_NAME, ...;String FQ_RESOURCE_PATH_WITH_LEADING_SLASH, ...;/** Absolute path version of {@link #FQ_RESOURCE_PATH}. */Pattern DESCRIPTION_PATTERN, ...;assertExceptionContainsFullyQualifiedPath(...)assertDescriptionContainsExpectedPath(...)Resource fileDirResource jarDirimport AccessDeniedException/** Unit tests for the {@link PathResource} class. ... */platformPath(...)String TEST_DIR, ...;String TEST_FILE, ...;String NON_EXISTING_FILE, ...;PathResource resourceReadableByteChannel channelAccessDeniedException exPath testPathcreateFile(...)writableChannel(...)// on Windows/** Unit tests for the {@link ResourceEditor} class. ... */Resource resolved/** Unit tests for various {@link Resource} implementations. ... */Resource resource2Resource resource3HashSet<Resource> resourcesnew HashSet<Resource>(...)doTestResource(...)Path filePathResource relative1Resource relative2Resource relative3Resource relative4Resource relativeurlIsReachable(...)HttpURLConnection connectionsetReadTimeout(...)AbstractResource resource// Check whether equal/hashCode works in a HashSet.// Abort if spring.io is not reachable.import AbstractDataBufferAllocatingTestscreateDataBuffer(...)super.bufferFactoryString springDataBuffer buffer1ByteBuffer buffer2createByteBuffer(...)ByteBuffer buffer3DataBuffer buffer2DataBuffer buffer3ByteBuffer resultbyte[] resultBytesnew IntPredicate(...) { ... }DataBuffer composite// AbstractDataBufferAllocatingTests.leakDetector will verify the buffer's release// make sure the write index is correctly set// skip aimport PooledByteBufAllocatorimport Answerimport static ArgumentMatchers.anyLongimport static BDDMockito.willAnswerPath tempFile, ...;this.tempFilereadInputStream(...)new Callable<InputStream>(...) { ... }verifyReadData(...)ReadableByteChannel.classofSeconds(...)thenCancel(...)AsynchronousFileChannel.classanyLong(...)CompletionHandler<Integer,DataBuffer> completionHandlercompleted(...)failed(...)BaseSubscriber<DataBuffer> subscriberDataBuffer fooDataBuffer barDataBuffer bazDataBuffer quxOutputStream osFlux<DataBuffer> writeResultverifyWrittenData(...)readAllLines(...)WritableByteChannel.classint writtenCompletionHandler<Integer,ByteBuffer> completionHandlerCompletionHandler<>.classMono<Void> resultList<String> writtenPath sourceDataBufferUtilsTests.classFlux<DataBuffer> sourceFluxPath destinationreleaseConsumer(...)deferStringBuffer(...)assertReleased(...)Flux<DataBuffer> readnew Answer<Integer>(...) { ... }Mono<DataBuffer> resultNettyDataBufferFactory bufferFactorynew NettyDataBufferFactory(...)PooledByteBufAllocator.DEFAULTNettyDataBuffer bufferbyte[] delims// gh-26060// should be at 2 nowimport LeakAwareDataBufferFactoryimport static DataBufferUtils.releasenew LeakAwareDataBufferFactory(...)LeakAwareDataBufferFactory bufferFactory, ...;AssertionError.classcheckForLeaks(...)/** Unit tests for {@link LimitedDataBufferList}. ... */LimitedDataBufferList listtoDataBuffer(...)DefaultDataBufferFactory.sharedInstanceimport UnpooledByteBufAllocatornew UnpooledByteBufAllocator(...)new PooledByteBufAllocator(...)createDataBufferFactory(...)PooledDataBuffer bufferimport DataBufferTestUtilsbyte[] sourcedumpBytes(...)/** Used by {@link SpringFactoriesLoaderTests} ... *//** Unit tests for {@link EncodedResource}. ... */String UTF8, ...;String UTF16, ...;Charset UTF8_CS, ...;Charset UTF16_CS, ...;EncodedResource er1EncodedResource er2/** If this test case fails, uncomment diagnostics in the ... */...[] CLASSES_IN_CORE_IO_SUPPORT, ...;...[] TEST_CLASSES_IN_CORE_IO_SUPPORT, ...;...[] CLASSES_IN_REACTOR_UTIL_ANNOTATIONS, ...;PathMatchingResourcePatternResolver resolver, ...;resources.lengthassertProtocolAndFilenames(...)List<Resource> noCloverResourcesconcatenateStringArrays(...)containsExactlyInAnyOrder(...)new ThrowingExtractor<Resource,File,IOException>(...) { ... }new ThrowingExtractor<File,String,RuntimeException>(...) { ... }filenames.lengthString actualProtocolassertFilenameIn(...)// Have to exclude Clover-generated class files here,// as we might be running as part of a Clover test run.// Uncomment the following if you encounter problems with matching against the file system// It shows file locations.//		String[] actualNames = new String[resources.length];//		for (int i = 0; i < resources.length; i++) {//			actualNames[i] = resources[i].getFilename();//		}//		List sortedActualNames = new LinkedList(Arrays.asList(actualNames));//		List expectedNames = new LinkedList(Arrays.asList(fileNames));//		Collections.sort(sortedActualNames);//		Collections.sort(expectedNames);//		System.out.println("-----------");//		System.out.println("Expected: " + StringUtils.collectionToCommaDelimitedString(expectedNames));//		System.out.println("Actual: " + StringUtils.collectionToCommaDelimitedString(sortedActualNames));//			System.out.println(resources[i]);// N.B. this will sometimes fail if you use classpath: instead of classpath*:.// The result depends on the classpath - if test-classes are segregated from classes// and they come first on the classpath (like in Maven) then it breaks, if classes// comes first (like in Spring Build) then it is OK./** Unit tests for {@link ResourcePropertySource}. ... */String PROPERTIES_PATH, ...;String PROPERTIES_LOCATION, ...;String PROPERTIES_RESOURCE_DESCRIPTION, ...;String XML_PROPERTIES_PATH, ...;String XML_PROPERTIES_LOCATION, ...;String XML_PROPERTIES_RESOURCE_DESCRIPTION, ...;/** Unit tests for the {@link ResourceRegion} class. ... *//** Tests for {@link SpringFactoriesLoader}. ... */SpringFactoriesLoader.cacheMyDummyFactory1.classMyDummyFactory2.classList<Integer> factoriesList<DummyFactory> factoriesList<DummyPackagePrivateFactory> factoriesDummyPackagePrivateFactory.classLogMessage msgnew Supplier<CharSequence>(...) { ... }import DeserializingConverterimport SerializationFailedExceptionimport SerializingConverterSerializingConverter toBytesnew SerializingConverter(...)DeserializingConverter fromBytesnew DeserializingConverter(...)SerializationFailedException.classNotSerializableException.classnew UnSerializable(...)/** Unit tests for {@link DefaultValueStyler}. ... */DefaultValueStyler styler, ...;Iterator<Entry<String,Integer>> entriesSomeObject s1, ...;new SomeObject(...) { ... }Object stringynew Object(...) { ... }new ToStringCreator(...)SomeObject[] arraynew SomeObject[]int[] integersList<SomeObject> listnew ArrayList<SomeObject>(...)Set<SomeObject> setnew LinkedHashSet<SomeObject>(...)SimpleAsyncTaskExecutor executorString customPrefixObject monitorThreadNameHarvester tasknew ThreadNameHarvester(...)executeAndWait(...)getThreadName(...)new ThreadFactory(...) { ... }doRun(...)this.threadName/** Tests for {@link TestGroup} parsing. ... */TestGroup.LONG_RUNNINGTestGroup.classSet<TestGroup> expectedimport static Collectors.joining/** Tests for {@link TestGroup}. ... */String TEST_GROUPS_SYSTEM_PROPERTY, ...;String originalTestGroups, ...;this.originalTestGroupssetTestGroups(...)TestAbortedException.classassumeGroup(...)assertBogusActiveTestGroupBehavior(...)joining(...)new Function<TestGroup,String>(...) { ... }/** Assume that a particular {@link TestGroup} is active. ... */Set<TestGroup> testGroupsloadTestGroups(...)// Should result in something similar to the following:// java.lang.IllegalStateException: Failed to parse 'testGroups' system property:// Unable to find test group 'bogus' when parsing testGroups value: 'all-bogus'.// Available groups include: [LONG_RUNNING,PERFORMANCE]import TestMemberClassInnerClassimport TestMemberClassInnerInterface/** Base class for {@link AnnotationMetadata} tests. ... */TestClass.classTestInterface.classTestFinalClass.classAbstractAnnotationMetadataTests.classTestNonStaticInnerClass.classTestSubclass.classTestSubInterface.classTestMemberClass.classTestMemberClassInnerClass.classTestMemberClassInnerInterface.classWithDirectAnnotations.classnew ThrowingExtractor<MergedAnnotation<Annotation>,String,RuntimeException>(...) { ... }DirectAnnotation1.classDirectAnnotation2.classWithMetaAnnotations.classMetaAnnotation2.classWithAnnotationAttributes.classWithMetaAnnotationAttributes.classMetaAnnotationRoot.classMetaAnnotation1.classWithAnnotatedMethod.classWithMetaAnnotatedMethod.classWithNonAnnotatedMethod.classWithDirectAndMetaAnnotatedMethods.classnew ThrowingExtractor<MethodMetadata,String,RuntimeException>(...) { ... }/** Abstract base class for testing implementations of ... */getClassMetadataFor(...)L0_a.classString[] nestedClassesL0_b.classL0_b.L1.classL0_b.L1L0_c.classL0_c.L1.classL0_c.L1import EnclosingAnnotation/** Base class for {@link MethodMetadata} tests. ... */getTagged(...)WithMethod.classgetReturnTypeName(...)WithAbstractMethod.classWithStaticMethod.classWithFinalMethod.classWithPrivateMethod.classWithDirectAnnotation.classTag.classDirectAnnotation.classWithMetaAnnotation.classAnnotationMetadata annotationMetadataEnclosingAnnotation.class/** Unit tests demonstrating that the reflection-based {@link StandardAnnotationMetadata} ... */doTestAnnotationInfo(...)doTestMethodAnnotationInfo(...)MetadataReaderFactory metadataReaderFactoryAnnotatedComponentSubClass.classdoTestSubClassAnnotationInfo(...)getInterfaceNames(...).lengthSpecialAttr.classNamedComposedAnnotation.classMetaAnnotation.classIsAnnotatedAnnotation.classdoTestMetadataForInterfaceClass(...)ClassMetadata.classAnnotatedTypeMetadata.classdoTestMetadataForAnnotationClass(...)/** In order to preserve backward-compatibility, {@link StandardAnnotationMetadata} ... */AnnotationAttributes specialAttrsAnnotation[] nestedAnnoArrayNestedAnno.classComposedConfigurationWithAttributeOverridesClass.classassertMetaAnnotationOverrides(...)TestComponentScan.classNamedAnnotationsClass.classassertMultipleAnnotationsWithIdenticalAttributeNames(...)NamedComposedAnnotationClass.classNamedComposedAnnotationExtended.classAnnotationAttributes attributes1NamedAnnotation1.classAnnotationAttributes attributes2NamedAnnotation2.classAnnotationAttributes attributes3NamedAnnotation3.classString name3AnnotationAttributes compAttrsAnnotationAttributes scopeAttrsSet<MethodMetadata> methodsMethodMetadata methodList<Object> allMetaMetaMetaAnnotation.classEnumSubclasses.classnew HashSet<E>(...)AnnotationAttributes nestedAnnoAnnotationAttributes[] nestedAnnoArrayAnnotationAttributes optionalAnnotationAttributes[] optionalArraySomeEnum.LABEL1nestedAnnoArray.lengthSomeEnum.DEFAULTSomeEnum.LABEL2optionalArray.lengthTestAutowired.classnew SomeEnum(...)SomeEnum LABEL1, ...;SomeEnum LABEL2, ...;SomeEnum DEFAULT, ...;// SPR-10914new SubclassEnum(...) { ... }SubclassEnum FOO, ...;SubclassEnum BAR, ...;SubclassEnum.FOOSubclassEnum.BAR// SPR-11649// perform tests with classValuesAsString = false (the default)// perform tests with classValuesAsString = true/* Do not delete! This subclassing is intentional. */import AnnotationTypeFilterTestsTypesimport InheritedAnnotationimport NonInheritedAnnotationString classUnderTestAnnotationTypeFilter filterInheritedAnnotation.classassertClassNotLoaded(...)NonInheritedAnnotation.class// Must fail as annotation on interfaces should not be considered a match// Must fail as annotation isn't inheritedimport AspectJTypeFilterTestsTypesassertNoMatch(...)AspectJTypeFilter filterAssignableTypeFilter matchingFilterAssignableTypeFilterTestsTypes.TestNonInheritingClass.classAssignableTypeFilterTestsTypes.TestNonInheritingClassAssignableTypeFilter notMatchingFilterAssignableTypeFilterTestsTypes.TestInterface.classAssignableTypeFilterTestsTypes.TestInterfaceAssignableTypeFilter filterAssignableTypeFilterTestsTypes.SimpleJdbcDaoSupport.classAssignableTypeFilterTestsTypes.SimpleJdbcDaoSupportAssignableTypeFilterTestsTypes.JdbcDaoSupport.classAssignableTypeFilterTestsTypes.JdbcDaoSupport/** Unit tests for checking the behaviour of {@link CachingMetadataReaderFactory} under ... */int ITEMS_TO_LOAD, ...;MetadataReaderFactory mrf, ...;new UrlResource(...) { ... }// the biggest public class in the JDK (>60k)// look at a LOT of items// useful for profiling to take snapshots// System.in.read();Method findLoadedClassMethodClass<?> loadedClassisClassLoaded(...)AnnotatedSubclass.classAnnotationMetadata standardMetadata, ...;AnnotationMetadata asmMetadata, ...;this.asmMetadataInheritedComposedAnnotation.classMultiValueMap<String,Object> annotationAttributes// true because @NamedAnnotation3 is also directly present/** Tests for {@link StandardAnnotationMetadata}. ... */new StandardClassMetadata(...)/** Tests for {@link StandardMethodMetadata}. ... */import BufferedInputStreamimport AbstractAnnotationMetadataTests/** Tests for {@link AnnotationMetadataReadingVisitor}. ... */new BufferedInputStream(...)AnnotationMetadataReadingVisitor metadatanew AnnotationMetadataReadingVisitor(...)getAnnotationsReturnsDirectAnnotations(...)import AbstractClassMetadataMemberClassTests/** Tests for {@link MergedAnnotationReadingVisitor}. ... */loadFrom(...)WithSimpleTypesAnnotation.classSimpleTypesAnnotation.classWithSimpleArrayTypesAnnotation.classSimpleArrayTypesAnnotation.classWithSimpleEmptyArrayTypesAnnotation.classWithEnumAnnotation.classEnumAnnotation.classExampleEnum.ONEExampleEnum.TWOMergedAnnotation<NestedAnnotation> valueNestedAnnotation.classMergedAnnotation<NestedAnnotation>[] arrayValueWithAnnotationAnnotation.classAnnotationAnnotation.classWithClassAnnotation.classClassAnnotation.classClassVisitor visitornew ClassVisitor(...) { ... }MergedAnnotationMetadataVisitorTests.this.annotationMergedAnnotationMetadataVisitorTests.thisimport AbstractMethodMetadataTests/** Tests for {@link MethodMetadataReadingVisitor}. ... *//** Tests for {@link SimpleAnnotationMetadata} and ... *//** Tests for {@link SimpleMethodMetadata} and ... */import InvocationContainerImplimport MockUtilimport Invocation/** General test utilities for use with {@link Mockito}. ... *//** Verify the same invocations have been applied to two mocks. This is generally not ... */List<Invocation> expectedInvocationsgetInvocations(...)getInvocationContainer(...)getMockHandler(...)List<Invocation> actualInvocationsverifySameInvocations(...)verifySameInvocation(...)Object[] expectedArgumentsgetInvocationArguments(...)Object[] actualArgumentsInvocationArgumentsAdapter adapteradaptArguments(...)/** Adapter strategy that can be used to change invocation arguments. *//** Change the arguments if required. ... */TestObject spouse, ...;/** Unit tests for {@link AntPathMatcher}. ... */// SPR-14247setTrimTokens(...)setPathSeparator(...)extractPathWithinPattern(...)Map<String,String> resultMap<String,String> expected/** SPR-7787 *//** SPR-8455 */Comparator<String> comparatorList<String> pathsshuffle(...)setCaseSensitive(...)pathMatcher.stringMatcherCachesetCachePatterns(...)// test exact matching// SPR-14141// test matching with ?'s// test matching with *'s// test matching with ?'s and /'s// test matching with **'s// test matching with ?'s and .'s// SPR-10515// SPR-8858// SPR-7970// SPR-10062// SPR-10554// SPR-12975// SPR-10550// SPR-6741// gh-23125// SPR-8683// longer is better// SPR-13139// SPR-8687// SPR-13286// Cache turned off because it went beyond the threshold// Cache keeps being alive due to the explicit cache setting// gh-22959// gh-23297import static Collections.emptyListimport static Collections.emptyMapimport static Collections.singletonListimport static Collections.singletonMap/** Unit tests for the {@link Assert} class. ... */doTestWithClass(...)new AutoPopulatingList<Object>(...)doTestWithElementFactory(...)new MockElementFactory(...)Object lastElementString helloWorldAutoPopulatingList<?> listAutoPopulatingList<>.ElementFactory<Object>TestObject beanimport DatatypeConverterencodeToString(...)printBase64Binary(...)decodeFromString(...)parseBase64Binary(...)encodeToUrlSafeString(...)decodeFromUrlSafeString(...)import CsvSourceimport DerivedTestObjectimport ITestInterfaceimport ITestObject/** Unit tests for {@link ClassUtils}. ... */ClassLoader childLoader1new ClassLoader(...) { ... }ClassLoader childLoader2ClassLoader childLoader3Class<?> compositeOverloadedMethodsClass.classSubOverloadedMethodsClass.classProxy.classaddResourcePathToPackagePath(...)DerivedTestObject testBeannew DerivedTestObject(...)List<Class<?>> ifcsITestObject.classITestInterface.classList<Class<?>> classesNestedClass.noArgCalledNestedClass.argCalledNestedClass.overloadedCalledboolean noArgCalled, ...;boolean argCalled, ...;boolean overloadedCalled, ...;// no args// matches although it takes an argList<Comparable<?>> listnew ArrayList<Comparable<?>>(...)mergeArrayIntoCollection(...)int[] arrProperties defaultsHashtable<String,String> htcontainsAny(...)List<Instance> listnew ArrayList<Instance>(...)new Instance(...)Instance instancehasUniqueObject(...)instance.name/** Test case for {@link CompositeIterator}. ... */CompositeIterator<String> itCompositeIterator<String> it2new ConcurrentLruCache<String,String>(...)ConcurrentLruCache<String,String> cache, ...;sizeLimit(...)import Restructureimport NullSafeComparator/** Tests for {@link ConcurrentReferenceHashMap}. ... */new TestWeakConcurrentCache<Integer,String>(...)new NullSafeComparator<String>(...)Comparator<? super String> NULL_SAFE_STRING_SORT, ...;TestWeakConcurrentCache<Integer,String> map, ...;ConcurrentReferenceHashMap<Integer,String> mapnew ConcurrentReferenceHashMap<Integer,String>(...)getSegmentsSize(...)getSegment(...)getSupplementalHash(...)queueForPurge(...)getMockReference(...)Map<Integer,String> mSet<Integer> expectedList<String> actualList<String> expectedHashMap<Integer,String> expectedIterator<Entry<Integer,String>> iteratorMap<>.Entry<Integer,String>Map<Integer,WeakReference<String>> synchronizedMapsynchronizedMap(...)new WeakHashMap<Integer,WeakReference<String>>(...)StopWatch mapTimetimeMultiThreaded(...)new ValueFactory<WeakReference<String>>(...) { ... }new WeakReference<T>(...)StopWatch cacheTimenew ValueFactory<String>(...) { ... }setDisableTestHooks(...)getTotalTimeSeconds(...)/** Time a multi-threaded access to a cache. ... */int threadIndexthreads.lengthisAlive(...)new LinkedList<MockReference<K,V>>(...)int supplementalHash, ...;LinkedList<MockReference<K,V>> queue, ...;boolean disableTestHooks, ...;this.disableTestHooksthis.supplementalHashnew ReferenceManager<>(...) { ... }TestWeakConcurrentCache<>.this.disableTestHooksTestWeakConcurrentCache<>.thisnew MockReference<K,V>(...)TestWeakConcurrentCache<>.this.queueEntry<K,V> entry, ...;Reference<K,V> next, ...;LinkedList<MockReference> queue, ...;this.entry// concurrencyLevel of 3 ends up as 4 (nearest power of 2)// initialCapacity is 5/4 (rounded up, to nearest power of 2)// NOTE we are using mock references so we don't need to worry about GC// Use loadFactor to disable resize// Putting again should not increase the count// We should be at least 4 time faster// GC could happen during restructure so we must be able to create a reference for a null entry// For testing we want more control of the hashmd5Digest(...)String hashmd5DigestAsHex(...)appendMd5DigestAsHex(...)ExceptionTypeFilter filterimport BackOffExecutionimport ExponentialBackOffExponentialBackOff backOffnew ExponentialBackOff(...)BackOffExecution executionnextBackOff(...)setMaxElapsedTime(...)BackOffExecution.STOPsetMaxInterval(...)BackOffExecution execution2setInitialInterval(...)setMultiplier(...)// max reached// > 4 sec wait in total/** Test suite for {@link FastByteArrayOutputStream}. ... */new FastByteArrayOutputStream(...)int INITIAL_CAPACITY, ...;FastByteArrayOutputStream os, ...;...[] helloBytes, ...;this.osthis.helloBytesthis.helloBytes.lengthint sizeBeforeassertByteArrayEqualsString(...)writeTo(...)byte[] actual// filling at least one 256 buffer/** Unit tests for the FileCopyUtils class. ... */byte[] contentByteArrayInputStream inStringReader inFile rootFile childFile grandchildFile barmkdirs(...)createNewFile(...)File srcFile destFile tmpimport FixedBackOffFixedBackOff backOffnew FixedBackOff(...)FixedBackOff.DEFAULT_INTERVALsetInterval(...)setMaxAttempts(...)InstanceFilter<String> filternew InstanceFilter<String>(...)doNotMatch(...)/** Tests for {@link LinkedCaseInsensitiveMap}. ... */LinkedCaseInsensitiveMap<String> map, ...;LinkedCaseInsensitiveMap<String> copynextAndRemove(...)new LinkedMultiValueMap<String,String>(...)LinkedMultiValueMap<String,String> map, ...;addIfAbsent(...)Map<String,String> singleValueMaptoSingleValueMap(...)MultiValueMap<String,String> o1Map<String,List<String>> o2MethodInvoker minew Greeter(...)String greetingnew Purchaser(...)new Shopper(...)new Salesman(...)new Customer(...)new Regular(...)new VIP(...)// should handle Salesman (only interface)getGreeting(...)// should handle Shopper (beats Greetable since it is a class)// should handle Customer (exact match)// should handle Regular (exact) and VIP (closest match)// sanity check: singleton, non-static should work// defensive check: singleton, non-static should work with null array// sanity check: check that argument count matching works// Sanity check: check that argument conversion doesn't work with plain MethodInvoker/** Unit tests for {@link MimeType}. ... */InvalidMimeTypeException.classMimeType.classMimeType textPlainMimeType allTextMimeType applicationSoapXmlMimeType applicationWildcardXmlMimeType suffixXmlincludes(...)List<MimeType> mimeTypesparseMimeTypes(...)testWithQuotedParameters(...)MimeType typeMimeType applicationStarMimeType applicationVndJsonList<MimeType> actualmimeTypes.lengthMimeType audioBasicMimeType audioMimeType audioWaveMimeType audioBasicLevelList<MimeType> expectednew ArrayList<MimeType>(...)List<MimeType> resultRandom rndMimeType m1MimeType m2MimeType originalMimeType deserialized// SPR-15795// SPR-8917// SPR-16630// gh-23241// SPR-17459// gh-25350// equal// shuffle & sort 10 times// SPR-13157// gh-26127String aByteString aShortString anIntegerString aLongString aFloatString aDoubleString aReallyBigIntassertByteEquals(...)assertShortEquals(...)assertIntegerEquals(...)assertLongEquals(...)assertNegativeByteEquals(...)assertNegativeShortEquals(...)assertNegativeIntegerEquals(...)assertNegativeLongEquals(...)Double decimalString numberString bigDecimalAsStringNumber bigDecimalNumberFormat numberFormatDouble.MIN_VALUEassertToNumberOverflow(...)BigInteger.ONEsubtract(...)withMessageEndingWith(...)import static ObjectUtils.isEmpty/** Unit tests for {@link ObjectUtils}. ... */new SQLException(...)Class<?>[] emptyClass<?>[] exceptionClass<?>[] sqlAndIOSQLException.classClass<?>[] throwableisCompatibleWithThrowsClause(...)int[] aInteger[] wrapperwrapper.lengthObject[] objectsString newElementnewArray.lengthString[] newArrayString existingElementint expecteddouble dblfloat fltlong lngisPrimitiveArray(...)boolean[] arraybyte[] arraychar[] arraylong bitsdoubleToLongBits(...)double[] arrayfloatToIntBits(...)float[] arraylong[] arrayassertEqualHashCodes(...)short[] arrayTropes.FOOcaseInsensitiveValueOf(...)Tropes.BARnew Tropes(...)Tropes FOO, ...;Tropes BAR, ...;Tropes baz, ...;// Any Throwable other than RuntimeException and Error// has to be considered checked according to the JLS.String propStringString propCopystoreProperties(...)DefaultPropertiesPersister persisternew DefaultPropertiesPersister(...)StringWriter propWriterByteArrayOutputStream propOutPlaceholderResolver resolverTestObjectSubclassWithPublicField.classTestObjectSubclassWithNewField.classTestObjectSubclassWithNewField testBeannew TestObjectSubclassWithNewField(...)String juergenMethod remoteExMethodMethod illegalExMethodTestObject srcString destshallowCopyFieldState(...)TestObject desttestValidCopy(...)TestObjectSubclassWithNewField srcTestObjectSubclassWithNewField destsrc.magicdest.magicsrc.protdest.protTestObjectSubclassWithFinalField srcnew TestObjectSubclassWithFinalField(...)TestObjectSubclassWithFinalField destListSavingMethodCallback mcnew ListSavingMethodCallback(...)getMethodNames(...)int absquatulateCountTestObjectSubclass.classint toStringMethodCountMethod[] m1Method[] m2ReflectionUtils.MethodCallbackList<Method> methods, ...;this.methodNamesthis.methodsint magic, ...;String prot, ...;int sum// Will check inherited fields are copied// Check subclass fields were copied// Should have left this one alone// Check that this doesn't fail due to attempt to assign finalResizableByteArrayOutputStream baos, ...;this.baosnew ResizableByteArrayOutputStream(...)grow(...)/** Unit tests for {@link SerializationUtils}. ... */BigInteger FOO, ...;import static SocketUtils.PORT_RANGE_MAXimport static SocketUtils.PORT_RANGE_MIN/** Unit tests for {@link SocketUtils}. ... */new SocketUtils(...)// TCPassertPortInRange(...)int minMaxPortServerSocket socketint minPortint maxPort// UDP// HelpersSortedSet<Integer> portsassertAvailablePorts(...)// Just making sure somebody doesn't try to make SocketUtils abstract,// since that would be a breaking change due to the intentional public// constructor.// will only look for the exact portimport TaskInfoimport static TimeUnit.MILLISECONDS/** Unit tests for {@link StopWatch}. ... */String name1, ...;long duration1, ...;long duration2, ...;long fudgeFactor, ...;StopWatch stopWatch, ...;currentTaskName(...)isLessThanOrEqualTo(...)millisToNanos(...)getLastTaskTimeNanos(...)getTaskCount(...)new ThrowingExtractor<TaskInfo,String,RuntimeException>(...) { ... }setKeepTaskList(...)toNanos(...)/** Tests for {@link StreamUtils}. ... */defaultCharset(...)byte[] rangecopyRange(...)InputStream sourceInputStream nonClosingnonClosing(...)OutputStream sourceOutputStream nonClosingString blanktrimTrailingWhitespace(...)trimTrailingCharacter(...)startsWithIgnoreCase(...)countOccurrencesOf(...)String inStringString oldPatternString newPatternString noTheString noheString nospString killEndString mismatchString nochangeString resString whitespaceString cleanedquoteIfString(...)String qualifiedString capitalizedpathEquals(...)String[] input1String[] input2mergeStringArrays(...)String[] inputaddStringToArray(...)sortStringArray(...)removeDuplicateStrings(...)String[] sasa.lengthdoTestCommaDelimitedListToStringArrayLegalMatch(...)doTestStringArrayReverseTransformationMatches(...)String[] reverse/** We expect to see the empty Strings in the output. */components.lengthLocale expectedLocalegetAvailableLocales(...)Locale parsedLocaletoLanguageTag(...)// Simple replace// Non match: no change// Null new pattern: should ignore// Null old pattern: should ignore// Could read these from files// Test same words// SPR-8637// SPR-3671// lots of whitespace// lots of underscores// SPR-7779// SPR-9420// SPR-11806// SPR-14718, SPR-7598// SPR-16651Map<String,String> env/** Unit tests for {@link TypeUtils}. ... */Integer number, ...;List<Object> objects, ...;List<? extends Object> openObjects, ...;List<? extends Number> openNumbers, ...;List<? super Object> storableObjectList, ...;...[] openArray, ...;Type objectsTypeType openObjectsTypeType stringsTypeParameterizedType openObjectsTypeParameterizedType openNumbersTypeType storableObjectListTypeType objectTypeType numberTypeType stringTypeType openWildcardType openNumbersWildcardType arrayTypeType openArrayType// '?'// '? extends number'/** Tests for {@link BooleanComparator}. ... */Comparator<Boolean> cBooleanComparator.TRUE_LOWBooleanComparator.TRUE_HIGH/** Tests for {@link ComparableComparator}. ... */Comparator<String> cComparator<> c/** Test for {@link CompoundComparator}. ... */new CompoundComparator<String>(...)/** Tests for {@link InstanceComparator}. ... */new C1(...)new C2(...)new C3(...)new C4(...)C1 c1, ...;C2 c2, ...;C3 c3, ...;C4 c4, ...;new InstanceComparator<Object>(...)C2.classI1.classI2.classC3.class/** Tests for {@link InvertibleComparator}. ... */Comparator<Integer> comparator, ...;new InvertibleComparator<Object>(...)InvertibleComparator<Integer> invertibleComparatornew InvertibleComparator<Integer>(...)/** Tests for {@link NullSafeComparator}. ... */FutureAdapter<String,Integer> adapter, ...;Future<Integer> adaptee, ...;new FutureAdapter<String,Integer>(...) { ... }import static Assertions.failCallable<String> callableListenableFutureTask<String> tasknew ListenableFutureTask<String>(...)SuccessCallback<String> successCallbackSuccessCallback<>.classFailureCallback failureCallbackFailureCallback.classnew Consumer<ExecutionException>(...) { ... }/** Unit tests for {@link MonoToListenableFutureAdapter}. ... */AtomicReference<Object> actualnew AtomicReference<Object>(...)new MonoToListenableFutureAdapter<String>(...)Throwable expectedMono<Long> monodelay(...)Future<Long> futurenew MonoToListenableFutureAdapter<Long>(...)Future<Void> futurenew MonoToListenableFutureAdapter<Void>(...)import static Mockito.verifyNoMoreInteractionsSettableListenableFuture<String> settableListenableFuture, ...;Future<String> completableThrowable exceptionString[] callbackHolderThrowable[] callbackHolderTimeoutException.classInterruptibleSettableListenableFuture interruptibleFuturenew InterruptibleSettableListenableFuture(...)calledInterruptTask(...)ListenableFutureCallback<> callbackListenableFutureCallback<>.classverifyNoMoreInteractions(...)boolean interrupted, ...;/** Tests for {@link DataSize}. ... */toKilobytes(...)toMegabytes(...)toGigabytes(...)toTerabytes(...)DataUnit.KILOBYTESDataUnit.MEGABYTESDataUnit.GIGABYTESDataUnit.TERABYTESisNegative(...)import DOMResultimport StreamResultimport XmlContentnew Predicate<Node>(...) { ... }Node.COMMENT_NODENode.DOCUMENT_TYPE_NODENode.PROCESSING_INSTRUCTION_NODEString COMPLEX_XML, ...;String SIMPLE_XML, ...;Predicate<Node> nodeFilter, ...;XMLReader xmlReader, ...;createXMLReader(...)new EntityResolver(...) { ... }AbstractStaxHandler handlercreateStaxHandler(...)new StreamResult(...)setContentHandler(...)isSimilarTo(...)DocumentBuilderFactory documentBuilderFactoryDocumentBuilder documentBuilderDocument expectedDocument resultnewDocument(...)new DOMResult(...)import TransformerFactoryimport InvocationOnMockimport MockitoUtilsimport InvocationArgumentsAdapterimport static ArgumentMatchers.anyIntXMLInputFactory inputFactory, ...;XMLReader standardReader, ...;ContentHandler standardContentHandler, ...;mockContentHandler(...)AbstractStaxXMLReader staxXmlReadercreateStaxXmlReader(...)createTestInputStream(...)verifyIdenticalInvocations(...)String xmlTransformer transformernewTransformer(...)SAXSource sourcenew SAXSource(...)DOMResult resultNode node1getFirstChild(...)getNode(...)getTextContent(...)getNextSibling(...)Resource testLexicalHandlerXmlLexicalHandler expectedLexicalHandlermockLexicalHandler(...)LexicalHandler actualLexicalHandlerLexicalHandler lexicalHandlerLexicalHandler.classanyInt(...)new CopyCharsAnswer(...)ContentHandler.classAttributes.classnew SkipLocatorArgumentsAdapter(...)new CharArrayToStringAdapter(...)new PartialAttributesAdapter(...)new PartialAttributes(...)char[] copyAttributes attributes, ...;Attributes other// TODO: broken comparison since Mockito 2.2 upgrade// verifyIdenticalInvocations(expectedLexicalHandler, actualLexicalHandler);/** Unit tests for {@link DomContentHandler}. */String XML_1, ...;String XML_2_EXPECTED, ...;String XML_2_SNIPPET, ...;Document expected, ...;DomContentHandler handler, ...;Document result, ...;DocumentBuilder documentBuilder, ...;Element rootElementimport XMLOutputFactoryimport static XMLStreamConstants.END_DOCUMENTimport static XMLStreamConstants.END_ELEMENTimport static XMLStreamConstants.START_DOCUMENTimport static XMLStreamConstants.START_ELEMENTXMLOutputFactory outputFactory, ...;List<XMLEvent> eventsreadEvents(...)ListBasedXMLEventReader readerStringWriter resultWriterXMLEventWriter writercreateXMLEventWriter(...)this.outputFactorygetElementText(...)XMLStreamException.classXMLEventReader readercreateXMLEventReader(...)this.inputFactorynew SimpleNamespaceContext(...)String unboundPrefix, ...;String namespaceUri, ...;String additionalNamespaceUri, ...;String unboundNamespaceUri, ...;SimpleNamespaceContext context, ...;XMLConstants.NULL_NS_URIbindDefaultNamespaceUri(...)getPrefixes(...)getItemSet(...)getBoundPrefixes(...)removeBinding(...)Set<String> itemSetXMLOutputFactory outputFactoryXMLEventWriter eventWriterString CONTENT, ...;XMLInputFactory inputFactoryXMLEventReader eventReaderStaxEventXMLReader xmlReadernextTag(...)// skip to rootimport StreamSourceString XML, ...;Transformer transformer, ...;XMLOutputFactory inputFactory, ...;TransformerFactory transformerFactoryXMLStreamWriter streamWritercreateXMLStreamWriter(...)new StreamSource(...)StaxResult resultXMLStreamReader streamReadercreateXMLStreamReader(...)StaxSource sourceStaxStreamXMLReader xmlReaderLocator.class// skip to childimport DOMSourceisStaxSource(...)new DOMSource(...)createCustomStaxSource(...)StAXSource sourceisStaxResult(...)new SAXResult(...)Result resultcreateCustomStaxResult(...)StAXResult resultimport URIResolver/** Unit tests for {@link TransformerUtils}. ... */new StubTransformer(...)String indentgetOutputProperty(...)String indentAmountTransformerUtils.DEFAULT_INDENT_AMOUNTString indentAmountPropertydisableIndenting(...)Properties outputProperties, ...;this.outputPropertiesXMLEventStreamReader streamReader, ...;Predicate<Node> nodeFilterXMLEventStreamWriter streamWriter, ...;StringWriter stringWriter, ...;writeDefaultNamespace(...)import static XmlValidationModeDetector.VALIDATION_DTD/** Unit tests for {@link XmlValidationModeDetector}. ... */XmlValidationModeDetector xmlValidationModeDetector, ...;import static Assumptions.assumeFalse/** Utility methods that allow JUnit tests to assume certain conditions hold ... *//** Assume that the specified log is not set to Trace or Debug. ... */assumeFalse(...)/** {@code @EnabledForTestGroups} is used to enable the annotated test class or ... */TestGroupsCondition.class/** One or more {@link TestGroup}s that must be active. */import LogManagerimport TestExecutionListenerimport TestPlan/** JUnit Platform {@link TestExecutionListener} that configures Java Util Logging ... */String JUL_TEST_PROPERTIES_FILE, ...;readConfiguration(...)getLogManager(...)/** A test group used to limit when certain tests are run. ... */new TestGroup(...)TestGroup LONG_RUNNING, ...;/** Tests that take a considerable amount of time to run. Any test lasting longer than ... *//** Determine if this {@link TestGroup} is active. ... *//** Load test groups dynamically instead of during static initialization in ... *//** Parse the specified comma separated string of groups. ... */Set<TestGroup> groupsparseGroups(...)new HashSet<TestGroup>(...)String groupimport ConditionEvaluationResultimport ExecutionConditionimport static ConditionEvaluationResult.disabledimport static ConditionEvaluationResult.enabledimport static AnnotationSupport.findAnnotation/** {@link ExecutionCondition} for Spring's {@link TestGroup} support. ... */enabled(...)ConditionEvaluationResult ENABLED_BY_DEFAULT, ...;Optional<EnabledForTestGroups> optionalgetElement(...)EnabledForTestGroups.classTestGroup[] testGroupstestGroups.lengthdisabled(...)new Predicate<TestGroup>(...) { ... }/** This interface can be implemented by cacheable objects or cache entries, ... *//** Return the timestamp for this object. ... */import Decoder/** Abstract base class for {@link Decoder} unit tests. Subclasses need to implement ... */D decoder, ...;/** The decoder to test. *//** Construct a new {@code AbstractDecoderTests} instance for the given decoder. ... *//** Subclasses should implement this method to test {@link Decoder#canDecode}. *//** Subclasses should implement this method to test {@link Decoder#decode}, possibly using ... *//** Subclasses should implement this method to test {@link Decoder#decodeToMono}, possibly using ... *//** Helper methods that tests for a variety of {@link Flux} decoding scenarios. This methods ... */// FluxStepVerifier.FirstStep<T>testDecodeError(...)testDecodeEmpty(...)/** Test a standard {@link Decoder#decode decode} scenario. For example: ... */Flux<T> resultFirstStep<T> step/** Test a {@link Decoder#decode decode} scenario where the input stream contains an error. ... */Flux<DataBuffer> bufferblockLast(...)/** Test a {@link Decoder#decode decode} scenario where the input stream is canceled. ... */Flux<?> resultexpectNextCount(...)/** Test a {@link Decoder#decode decode} scenario where the input stream is empty. ... *//** Helper methods that tests for a variety of {@link Mono} decoding scenarios. This methods ... */// MonotestDecodeToMonoError(...)testDecodeToMonoCancel(...)testDecodeToMonoEmpty(...)/** Test a standard {@link Decoder#decodeToMono decode} scenario. For example: ... */Mono<T> result/** Test a {@link Decoder#decodeToMono decode} scenario where the input stream contains an error. ... */Mono<?> result/** Test a {@link Decoder#decodeToMono decode} scenario where the input stream is canceled. ... *//** Test a {@link Decoder#decodeToMono decode} scenario where the input stream is empty. ... *//** Creates a deferred {@link DataBuffer} containing the given bytes. ... */fromCallable(...)new Callable<DataBuffer>(...) { ... }/** Exception used in {@link #testDecodeError} and {@link #testDecodeToMonoError} */import Encoder/** Abstract base class for {@link Encoder} unit tests. Subclasses need to implement ... */E encoder, ...;/** The encoder to test. *//** Construct a new {@code AbstractEncoderTestCase} for the given parameters. ... *//** Subclasses should implement this method to test {@link Encoder#canEncode}. *//** Subclasses should implement this method to test {@link Encoder#encode}, possibly using ... *//** Helper methods that tests for a variety of encoding scenarios. This methods ... */StepVerifier.FirstStep<DataBuffer>/** Helper methods that tests for a variety of decoding scenarios. This methods ... */testEncode(...)testEncodeError(...)testEncodeCancel(...)testEncodeEmpty(...)/** Test a standard {@link Encoder#encode encode} scenario. ... */encoder(...)FirstStep<DataBuffer> step/** Test a {@link Encoder#encode encode} scenario where the input stream contains an error. ... *//** Test a {@link Encoder#encode encode} scenario where the input stream is canceled. ... *//** Test a {@link Encoder#encode encode} scenario where the input stream is empty. ... */Flux<?> input/** Create a result consumer that expects the given bytes. ... *//** Create a result consumer that expects the given string, using the UTF-8 encoding. ... *//** Exception used in {@link #testEncodeError}. *//** Test utilities for {@link StandardEnvironment}. ... */Collections.classClass<?> processEnvironmentClassClass<?> clField theCaseInsensitiveEnvironmentFieldField theEnvironmentField// for os x / linux// for windows// do nothing/** Simple {@link PropertySource} implementation for use in testing. Accepts ... */String MOCK_PROPERTIES_PROPERTY_SOURCE_NAME, ...;/** {@value} is the default name for {@link MockPropertySource} instances not ... *//** Create a new {@code MockPropertySource} named {@value #MOCK_PROPERTIES_PROPERTY_SOURCE_NAME} ... *//** Create a new {@code MockPropertySource} with the given name that will ... *//** Create a new {@code MockPropertySource} with the given name and backed by the given ... *//** Set the given property on the underlying {@link Properties} object. *//** Convenience utilities for common operations with test resources. ... *//** Load a {@link ClassPathResource} qualified by the simple name of clazz, ... *//** Utilities for testing serializability of objects. ... */OutputStream baosNotSerializableException exByteArrayInputStream isimport PoolArenaMetricimport PooledByteBufAllocatorMetricimport AfterEachCallbackimport RegisterExtensionimport DefaultDataBufferFactory/** Base class for tests that read or write data buffers with an extension to check ... */new AfterEachCallback(...) { ... }waitForDataBufferRelease(...)AfterEachCallback leakDetector, ...;DataBufferFactory bufferFactory, ...;byteBuffer(...)/** Wait until allocations are at 0, or the given duration elapses. */Instant startverifyAllocations(...)AssertionError exisAfter(...)ByteBufAllocator allocatorgetByteBufAllocator(...)PooledByteBufAllocatorMetric metricmetric(...)long totalgetAllocations(...)directArenas(...)heapArenas(...)isBefore(...)mapToLong(...)new ToLongFunction<PoolArenaMetric>(...) { ... }numActiveAllocations(...)// PooledByteBufAllocator no longer supports tinyCacheSize.// 1) Disable caching for reliable leak detection, see https://github.com/netty/netty/issues/5275// 2) maxOrder is 4 (vs default 11) but can be increased if necessary/** Abstract base class for unit tests that allocate data buffers via a {@link DataBufferFactory}. ... *//** The data buffer factory. *//** Checks whether any of the data buffers created by {@link #bufferFactory} have not been ... *//** Utility class for working with {@link DataBuffer}s in tests. ... *//** Dump all the bytes in the given data buffer, and returns them as a byte array. ... */import DataBufferWrapper/** DataBuffer implementation created by {@link LeakAwareDataBufferFactory}. ... */AssertionError leakError, ...;LeakAwareDataBufferFactory dataBufferFactory, ...;this.leakErrorcreateLeakError(...)AssertionError resultStackTraceElement[] oldTraceStackTraceElement[] newTraceoldTrace.lengthDataBuffer delegate// remove first four irrelevant stack trace elements/** Implementation of the {@code DataBufferFactory} interface that keeps track of ... */new ArrayList<LeakAwareDataBuffer>(...)LeakAwareDataBufferFactory.classDataBufferFactory delegate, ...;List<LeakAwareDataBuffer> created, ...;AtomicBoolean trackCreated, ...;/** Creates a new {@code LeakAwareDataBufferFactory} by wrapping a ... *//** Creates a new {@code LeakAwareDataBufferFactory} by wrapping the given delegate. ... *//** Checks whether all of the data buffers allocated by this factory have also been released. ... */this.trackCreatedList<AssertionError> errorsnew Predicate<LeakAwareDataBuffer>(...) { ... }new Function<LeakAwareDataBuffer,AssertionError>(...) { ... }leakError(...)noneMatch(...)new Consumer<AssertionError>(...) { ... }createLeakAwareDataBuffer(...)LeakAwareDataBuffer dataBuffernew LeakAwareDataBuffer(...)// Remove LeakAwareDataBuffer wrapper so delegate can find native buffers/** An implementation of {@link Principal} for testing. ... */TestPrincipal p/** Copy of the standard {@code Component} annotation for testing purposes. ... *//** Copy of the standard {@code Indexed} annotation for testing purposes. ... */import AssertProviderimport XmlAssert/** {@link AssertProvider} to allow XML content assertions. Ultimately delegates ... */new XmlContentAssert(...)new XmlContent(...)import DifferenceEvaluatorimport NodeMatcher/** Assertions exposed by {@link XmlContent}. ... */XmlContentAssert.classareSimilar(...)super.actualwithNodeFilter(...)withDifferenceEvaluator(...)ignoreWhitespace(...)withNodeMatcher(...)/** An AccessException is thrown by an accessor if it has an unexpected problem. ... *//** Create an AccessException with a specific message. ... *//** Create an AccessException with a specific message and cause. ... *//** A bean resolver can be registered with the evaluation context and will kick in ... *//** Look up a bean by the given name and return a corresponding instance for it. ... *//** Executors are built by resolvers and can be cached by the infrastructure to repeat an ... */// TODO Is the resolver/executor model too pervasive in this package?/** Execute a constructor in the specified context using the specified arguments. ... *//** A constructor resolver attempts locate a constructor and returns a ConstructorExecutor ... *//** Within the supplied context determine a suitable constructor on the supplied type ... *//** Expressions are executed in an evaluation context. It is in this context that ... *//** Return the default root context object against which unqualified ... *//** Return a list of accessors that will be asked in turn to read/write a property. *//** Return a list of resolvers that will be asked in turn to locate a constructor. *//** Return a list of resolvers that will be asked in turn to locate a method. *//** Return a bean resolver that can look up beans by name. *//** Return a type locator that can be used to find types, either by short or ... *//** Return a type converter that can convert (or coerce) a value from one type to another. *//** Return a type comparator for comparing pairs of objects for equality. *//** Return an operator overloader that may support mathematical operations ... *//** Set a named variable within this evaluation context to a specified value. ... *//** Look up a named variable within this evaluation context. ... *//** Represent an exception that occurs during expression evaluation. ... *//** Create a new expression evaluation exception. ... *//** An expression capable of evaluating itself against context objects. ... *//** Return the original string used to create this expression (unmodified). ... *//** Evaluate this expression in the default standard context. ... *//** Evaluate the expression in the default context. If the result ... *//** Evaluate this expression against the specified root object. ... *//** Evaluate the expression in the default context against the specified root ... *//** Evaluate this expression in the provided context and return the result ... *//** Evaluate the expression in a specified context which can resolve references ... *//** Return the most general type that can be passed to a {@link #setValue} ... *//** Return the most general type that can be passed to the ... *//** Determine if an expression can be written to, i.e. setValue() can be called. ... *//** Set this expression in the provided context to the value provided. ... *//** Super class for exceptions that can occur whilst processing expressions. ... */String expressionString, ...;int position, ...;/** Construct a new expression exception. ... */// -1 if not known; should be known in all reasonable casesthis.expressionString/** Return the expression string. *//** Return the position in the expression string where the problem occurred. *//** Return the exception message. ... */toDetailedString(...)/** Return a detailed description of this exception, including the expression ... */StringBuilder outputgetSimpleMessage(...)/** Return the exception simple message without including the expression ... *//** This exception wraps (as cause) a checked exception thrown by some method that SpEL ... *//** Parses expression strings into compiled expressions that can be evaluated. ... *//** Parse the expression string and return an Expression object you can use for repeated evaluation. ... *//** MethodExecutors are built by the resolvers and can be cached by the infrastructure to ... *//** Execute a command using the specified arguments, and using the specified expression state. ... *//** MethodFilter instances allow SpEL users to fine tune the behaviour of the method ... *//** Called by the method resolver to allow the SpEL user to organize the list of ... *//** A method resolver attempts locate a method and returns a command executor that can be ... *//** Within the supplied context determine a suitable method on the supplied object that ... *//** Supported operations that an {@link OperatorOverloader} can implement for any pair of ... */new Operation(...)Operation ADD, ...;/** Add operation. */Operation SUBTRACT, ...;/** Subtract operation. */Operation DIVIDE, ...;/** Divide operation. */Operation MULTIPLY, ...;/** Multiply operation. */Operation MODULUS, ...;/** Modulus operation. */Operation POWER, ...;/** Power operation. *//** By default the mathematical operators {@link Operation} support simple types ... *//** Return true if the operator overloader supports the specified operation ... *//** Execute the specified operation on two operands, returning a result. ... *//** Represent an exception that occurs during expression parsing. ... *//** Create a new expression parsing exception. ... *//** Input provided to an expression parser that can influence an expression ... *//** Whether or not the expression being parsed is a template. A template expression ... *//** For template expressions, returns the prefix that identifies the start of an ... *//** For template expressions, return the prefix that identifies the end of an ... */ParserContext TEMPLATE_EXPRESSION, ...;/** The default ParserContext implementation that enables template expression ... *//** A property accessor is able to read from (and possibly write to) an object's properties. ... *//** Return an array of classes for which this resolver should be called. ... *//** Called to determine if a resolver instance is able to access a specified property ... *//** Called to read a property from a specified target object. ... *//** Called to determine if a resolver instance is able to write to a specified ... *//** Called to write to a property on a specified target object. ... *//** Instances of a type comparator should be able to compare pairs of objects for equality. ... *//** Return {@code true} if the comparator can compare these two objects. ... *//** Compare two given objects. ... *//** A type converter can convert values between different types encountered during ... *//** Return {@code true} if the type converter can convert the specified type ... *//** Convert (or coerce) a value from one type to another, for example from a ... *//** Implementers of this interface are expected to be able to locate types. ... *//** Find a type by name. The name may or may not be fully qualified ... *//** Encapsulates an object and a {@link TypeDescriptor} that describes it. ... */TypedValue NULL, ...;/** {@link TypedValue} for {@code null}. *//** Create a {@link TypedValue} for a simple object. The {@link TypeDescriptor} ... *//** Create a {@link TypedValue} for a particular value with a particular ... */TypedValue otherTvotherTv.valueotherTv.typeDescriptor// initialized when/if requested// Avoid TypeDescriptor initialization if not necessary/** Represents a template expression broken into pieces. Each piece will be an Expression ... */...[] expressions, ...;/** The array of expressions that make up the composite expression. */convertTypedValue(...)new EvaluationException(...)/** Common utility functions that may be used by any Expression Language provider. ... *//** Determines if there is a type converter available in the specified context and ... *//** Attempt to convert a typed value to an int using the supplied type converter. *//** Attempt to convert a typed value to a boolean using the supplied type converter. *//** Attempt to convert a typed value to a double using the supplied type converter. *//** Attempt to convert a typed value to a long using the supplied type converter. *//** Attempt to convert a typed value to a char using the supplied type converter. *//** Attempt to convert a typed value to a short using the supplied type converter. *//** Attempt to convert a typed value to a float using the supplied type converter. *//** Attempt to convert a typed value to a byte using the supplied type converter. *//** A very simple hardcoded implementation of the Expression interface that represents a ... */String literalValue, ...;/** Fixed literal value of this expression. */this.literalValue/** An expression parser that understands templates. It can be subclassed by expression ... */isTemplate(...)parseTemplate(...)doParseExpression(...)Expression[] expressionsparseExpressions(...)new LiteralExpression(...)new CompositeStringExpression(...)/** Helper that parses given expression string using the configured parser. The ... */List<Expression> expressionsnew ArrayList<Expression>(...)getExpressionPrefix(...)getExpressionSuffix(...)int startIdxint afterPrefixIndexskipToCorrectEndSuffix(...)String exprnew Expression[]/** Return true if the specified suffix can be found at the supplied position in the ... */int suffixPosition/** Copes with nesting, for example '${...${...}}' where the correct end for the first ... */int maxlenint nextSuffixDeque<Bracket> stacknew ArrayDeque<Bracket>(...)isSuffixHere(...)Bracket pint endLiteralnew Bracket(...)theOpenBracketFor(...)compatibleWithCloseBracket(...)p.posp.brackettheCloseBracketFor(...)/** Actually parse the expression string and return an Expression object. ... *//** This captures a type of bracket and the position in which it occurs in the ... */char bracket, ...;int pos, ...;this.bracketthis.pos// an inner expression was found - this is a composite// no more ${expressions} found in string, add rest as static text// the expressionString ran out before the suffix could entirely be found// Chew on the expression text - relying on the rules:// brackets must be in pairs: () [] {}// string literals are "..." or '...' and these may contain unmatched brackets// the suffix is missing// jump to the end of the literal/** Configurable {@link ParserContext} implementation for template parsing. Expects the ... *//** Create a new TemplateParserContext with the default "#{" prefix and "}" suffix. *//** Create a new TemplateParserContext for the given prefix and suffix. ... *//** Common utility classes behind the <em>Spring Expression Language</em>. *//** Core abstractions behind the <em>Spring Expression Language</em>. */import ClassWriter/** Manages the class being generated by the compilation process. ... *//** Name of the class being generated. Typically used when generating code ... *//** The current class being generated. */Deque<List<String>> compilationScopes, ...;/** Record the type of what is on top of the bytecode stack (i.e. the type of the ... */List<FieldAdder> fieldAdders, ...;/** As SpEL ast nodes are called to generate code for the main evaluation method ... */List<ClinitAdder> clinitAdders, ...;int nextFieldId, ...;/** When code generation requires holding a value in a class level field, this ... */int nextFreeVariableId, ...;/** When code generation requires an intermediate variable within a method, ... *//** Construct a new {@code CodeFlow} for the given class. ... */this.compilationScopesnew ArrayDeque<List<String>>(...)/** Push the byte code to load the target (i.e. what was passed as the first argument ... *//** Push the bytecode to load the EvaluationContext (the second parameter passed to ... *//** Record the descriptor for the most recently evaluated expression element. ... *//** Enter a new compilation scope, usually due to nested expression evaluation. For ... *//** Exit a compilation scope, usually after a nested expression has been evaluated. For ... *//** Return the descriptor for the item currently on top of the stack (in the current scope). *//** If the codeflow shows the last expression evaluated to java.lang.Boolean then ... *//** Called after the main expression evaluation method has been generated, this ... */this.fieldAddersFieldAdder fieldAddergenerateField(...)this.clinitAddersMethodVisitor mvthis.nextFreeVariableIdClinitAdder clinitAddergenerateCode(...)/** Register a FieldAdder which will add a new field to the generated ... */new ArrayList<FieldAdder>(...)/** Register a ClinitAdder which will add code to the static ... */new ArrayList<ClinitAdder>(...)this.nextFieldId/** Insert any necessary cast and value call to convert from a boxed type to a ... *//** For numbers, use the appropriate method on the number to convert it to the primitive type requested. ... *//** Insert any necessary numeric conversion bytecodes based upon what is on the stack and the desired target type. ... */char stackTop/** Create the JVM signature descriptor for a method. This consists of the descriptors ... */Class<?> paramtoJvmDescriptor(...)/** Create the JVM signature descriptor for a constructor. This consists of the ... *//** Determine the JVM descriptor for a specified class. Unlike the other descriptors ... *//** Determine the descriptor for an object instance (or {@code null}). ... */toDescriptor(...)/** Determine whether the descriptor is for a boolean primitive or boolean reference type. ... *//** Determine whether the descriptor is for a primitive type. ... *//** Determine whether the descriptor is for a primitive array (e.g. "[[I"). ... */boolean primitive/** Determine whether boxing/unboxing can get from one type to the other. ... *//** Determine if the supplied descriptor is for a supported number type or boolean. The ... */isPrimitiveOrUnboxableSupportedNumber(...)/** Determine if the supplied descriptor is for a supported number. The compilation ... *//** Determine whether the given number is to be considered as an integer ... *//** Convert a type descriptor to the single character primitive descriptor. ... *//** Insert the appropriate CHECKCAST instruction for the supplied descriptor. ... *//** Determine the appropriate boxing instruction for a specific type (if it needs ... */insertBoxIfNecessary(...)/** Deduce the descriptor for a type. Descriptors are like JVM type names but missing the ... *//** Create an array of descriptors representing the parameter types for the supplied ... */toDescriptors(...)/** Create an array of descriptors from an array of classes. ... */int typesCountString[] descriptorsint p/** Create the optimal instruction for loading a number on the stack. ... *//** Produce appropriate bytecode to store a stack item in an array. The ... *//** Determine the appropriate T tag to use for the NEWARRAY bytecode. ... *//** Return if the supplied array type has a core component reference type. *//** Produce the correct bytecode to build an array. The opcode to use and the ... */insertOptimalLoad(...)arrayCodeFor(...)isReferenceTypeArray(...)/** For use in mathematical operators, handles converting from a (possibly boxed) ... */insertUnboxNumberInsns(...)insertAnyNecessaryTypeConversionBytecodes(...)/** Interface used to generate fields. *//** Interface used to generate {@code clinit} static initializer blocks. */// to 0 because there is no 'this' in a clinit// not supplied due to COMPUTE_MAXS// does not handle Z, B, C, S// nop// This is chopping off the 'L' to leave us with "java/lang/String"// no box needed// array has primitive component type// Handling the nested array case here.// If vararg is [[I then we want [I and not [I;/** A compilable property accessor is able to generate bytecode that represents ... *//** Return {@code true} if this property accessor is currently suitable for compilation. *//** Return the type of the accessed property - may only be known once an access has occurred. *//** Generate the bytecode the performs the access operation into the specified MethodVisitor ... *//** Base superclass for compiled expressions. Each generated compiled expression class ... *//** Subclasses of CompiledExpression generated by SpelCompiler will provide an ... */import Operationimport OperatorOverloaderimport TypeComparator/** An ExpressionState is for maintaining per-expression-evaluation state, any changes to ... */EvaluationContext relatedContext, ...;TypedValue rootObject, ...;SpelParserConfiguration configuration, ...;Deque<TypedValue> contextObjects, ...;Deque<VariableScope> variableScopes, ...;ArrayDeque<TypedValue> scopeRootObjects, ...;// element from list1// On entering the selection we enter a new scope, and #this is now the// #list1.?[#list2.contains(#this)]// For example:// This ArrayDeque captures those objects at each nested scope level.// for '#this' references (or to act as a target for unqualified references).// When entering a new scope there is a new base object which should be usedgetRootObject(...)this.relatedContext/** The active context object is what unqualified references to properties/etc are resolved against. */this.contextObjectsnew ArrayDeque<TypedValue>(...)this.scopeRootObjectsTypedValue.NULLgetTypeComparator(...)findType(...)getTypeLocator(...)/* A new scope is entered when a function is invoked. */initVariableScopes(...)new VariableScope(...)initScopeRootObjects(...)getActiveContextObject(...)VariableScope scopedefinesVariable(...)this.variableScopesnew ArrayDeque<VariableScope>(...)OperatorOverloader overloadergetOperatorOverloader(...)overridesOperation(...)operate(...)String leftTypeString rightTypenew SpelEvaluationException(...)SpelMessage.OPERATOR_NOT_SUPPORTED_BETWEEN_TYPESgetPropertyAccessors(...)/** A new scope is entered when a function is called and it is used to hold the ... */Map<String,Object> vars, ...;this.vars// top-level empty variable scope/** Wraps a real parse exception. This exception flows to the top parse method and then ... *//** Captures the possible configuration settings for a compiler that can be ... */new SpelCompilerMode(...)SpelCompilerMode OFF, ...;/** The compiler is switched off; this is the default. */SpelCompilerMode IMMEDIATE, ...;/** In immediate mode, expressions are compiled as soon as possible (usually after 1 interpreted run). ... */SpelCompilerMode MIXED, ...;/** In mixed mode, expression evaluation silently switches between interpreted and compiled over time. ... *//** Root exception for Spring EL related exceptions. Rather than holding a hard coded ... */SpelMessage message, ...;...[] inserts, ...;this.inserts/** Set the position in the related expression which gave rise to this exception. *//** Return the message code. *//** Return the message inserts. *//** Contains all the messages that can be produced by the Spring Expression Language. ... */new SpelMessage(...)Kind.ERRORSpelMessage TYPE_CONVERSION_ERROR, ...;SpelMessage CONSTRUCTOR_NOT_FOUND, ...;SpelMessage CONSTRUCTOR_INVOCATION_PROBLEM, ...;SpelMessage METHOD_NOT_FOUND, ...;SpelMessage TYPE_NOT_FOUND, ...;SpelMessage FUNCTION_NOT_DEFINED, ...;SpelMessage PROPERTY_OR_FIELD_NOT_READABLE_ON_NULL, ...;SpelMessage PROPERTY_OR_FIELD_NOT_READABLE, ...;SpelMessage PROPERTY_OR_FIELD_NOT_WRITABLE_ON_NULL, ...;SpelMessage PROPERTY_OR_FIELD_NOT_WRITABLE, ...;SpelMessage METHOD_CALL_ON_NULL_OBJECT_NOT_ALLOWED, ...;SpelMessage CANNOT_INDEX_INTO_NULL_VALUE, ...;SpelMessage NOT_COMPARABLE, ...;SpelMessage INCORRECT_NUMBER_OF_ARGUMENTS_TO_FUNCTION, ...;SpelMessage INVALID_TYPE_FOR_SELECTION, ...;SpelMessage RESULT_OF_SELECTION_CRITERIA_IS_NOT_BOOLEAN, ...;SpelMessage BETWEEN_RIGHT_OPERAND_MUST_BE_TWO_ELEMENT_LIST, ...;SpelMessage INVALID_PATTERN, ...;SpelMessage PROJECTION_NOT_SUPPORTED_ON_TYPE, ...;SpelMessage ARGLIST_SHOULD_NOT_BE_EVALUATED, ...;SpelMessage EXCEPTION_DURING_PROPERTY_READ, ...;SpelMessage FUNCTION_REFERENCE_CANNOT_BE_INVOKED, ...;SpelMessage EXCEPTION_DURING_FUNCTION_CALL, ...;SpelMessage ARRAY_INDEX_OUT_OF_BOUNDS, ...;SpelMessage COLLECTION_INDEX_OUT_OF_BOUNDS, ...;SpelMessage STRING_INDEX_OUT_OF_BOUNDS, ...;SpelMessage INDEXING_NOT_SUPPORTED_FOR_TYPE, ...;SpelMessage INSTANCEOF_OPERATOR_NEEDS_CLASS_OPERAND, ...;SpelMessage EXCEPTION_DURING_METHOD_INVOCATION, ...;SpelMessage OPERATOR_NOT_SUPPORTED_BETWEEN_TYPES, ...;SpelMessage PROBLEM_LOCATING_METHOD, ...;SpelMessage SETVALUE_NOT_SUPPORTED, ...;SpelMessage MULTIPLE_POSSIBLE_METHODS, ...;SpelMessage EXCEPTION_DURING_PROPERTY_WRITE, ...;SpelMessage NOT_AN_INTEGER, ...;SpelMessage NOT_A_LONG, ...;SpelMessage INVALID_FIRST_OPERAND_FOR_MATCHES_OPERATOR, ...;SpelMessage INVALID_SECOND_OPERAND_FOR_MATCHES_OPERATOR, ...;SpelMessage FUNCTION_MUST_BE_STATIC, ...;SpelMessage NOT_A_REAL, ...;SpelMessage MORE_INPUT, ...;SpelMessage RIGHT_OPERAND_PROBLEM, ...;SpelMessage NOT_EXPECTED_TOKEN, ...;SpelMessage OOD, ...;SpelMessage NON_TERMINATING_DOUBLE_QUOTED_STRING, ...;SpelMessage NON_TERMINATING_QUOTED_STRING, ...;SpelMessage MISSING_LEADING_ZERO_FOR_NUMBER, ...;SpelMessage REAL_CANNOT_BE_LONG, ...;SpelMessage UNEXPECTED_DATA_AFTER_DOT, ...;SpelMessage MISSING_CONSTRUCTOR_ARGS, ...;SpelMessage RUN_OUT_OF_ARGUMENTS, ...;SpelMessage UNABLE_TO_GROW_COLLECTION, ...;SpelMessage UNABLE_TO_GROW_COLLECTION_UNKNOWN_ELEMENT_TYPE, ...;SpelMessage UNABLE_TO_CREATE_LIST_FOR_INDEXING, ...;SpelMessage UNABLE_TO_CREATE_MAP_FOR_INDEXING, ...;SpelMessage UNABLE_TO_DYNAMICALLY_CREATE_OBJECT, ...;SpelMessage NO_BEAN_RESOLVER_REGISTERED, ...;SpelMessage EXCEPTION_DURING_BEAN_RESOLUTION, ...;SpelMessage INVALID_BEAN_REFERENCE, ...;SpelMessage TYPE_NAME_EXPECTED_FOR_ARRAY_CONSTRUCTION, ...;SpelMessage INCORRECT_ELEMENT_TYPE_FOR_ARRAY, ...;SpelMessage MULTIDIM_ARRAY_INITIALIZER_NOT_SUPPORTED, ...;SpelMessage MISSING_ARRAY_DIMENSION, ...;SpelMessage INITIALIZER_LENGTH_INCORRECT, ...;SpelMessage UNEXPECTED_ESCAPE_CHAR, ...;SpelMessage OPERAND_NOT_INCREMENTABLE, ...;SpelMessage OPERAND_NOT_DECREMENTABLE, ...;SpelMessage NOT_ASSIGNABLE, ...;SpelMessage MISSING_CHARACTER, ...;SpelMessage LEFT_OPERAND_PROBLEM, ...;SpelMessage MISSING_SELECTION_EXPRESSION, ...;SpelMessage EXCEPTION_RUNNING_COMPILED_EXPRESSION, ...;/** @since */SpelMessage FLAWED_PATTERN, ...;int code, ...;/** Produce a complete message including the prefix and with the inserts ... */StringBuilder formattedMessage/** Message kinds. */Kind INFO, ...;Kind WARNING, ...;Kind ERROR, ...;/** Represents a node in the AST for a parsed expression. ... *//** Evaluate the expression node in the context of the supplied expression state ... *//** Determine if this expression node will support a setValue() call. ... *//** Evaluate the expression to a node and then set the new value on that node. ... *//** Return the string form the this AST node. ... *//** Return the number of children under this node. ... *//** Helper method that returns a SpelNode rather than an Antlr Tree node. ... *//** Determine the class of the object passed in, unless it is already a class object. ... *//** Return the start position of this AST node in the expression string. ... *//** Return the end position of this AST node in the expression string. ... *//** Configuration object for the SpEL expression parser. ... */String compilerModeSpelCompilerMode.OFFString SPRING_EXPRESSION_COMPILER_MODE_PROPERTY_NAME, ...;/** System property to configure the default compiler mode for SpEL expression parsers: {@value}. */SpelCompilerMode defaultCompilerMode, ...;SpelCompilerMode compilerMode, ...;ClassLoader compilerClassLoader, ...;boolean autoGrowNullReferences, ...;boolean autoGrowCollections, ...;int maximumAutoGrowSize, ...;/** Create a new {@code SpelParserConfiguration} instance with default settings. *//** Create a new {@code SpelParserConfiguration} instance. ... */this.compilerModethis.compilerClassLoaderthis.autoGrowNullReferencesthis.autoGrowCollectionsthis.maximumAutoGrowSize/** Return the compiler mode for parsers using this configuration object. *//** Return the ClassLoader to use as the basis for expression compilation. *//** Return {@code true} if {@code null} references should be automatically grown. *//** Return {@code true} if collections should be automatically grown. *//** Return the maximum size that a collection can auto grow. */import ExpressionState/** Represents assignment. An alternative to calling {@code setValue} ... */TypedValue newValuegetValueInternal(...)toStringAST(...)/** Utilities methods for use in the Ast classes. ... *//** Determines the set of property resolvers that should be used to try and access a ... */List<PropertyAccessor> specificAccessorsnew ArrayList<PropertyAccessor>(...)List<PropertyAccessor> generalAccessorsList<PropertyAccessor> resolversPropertyAccessor resolverClass<?>[] targetsgetSpecificTargetClasses(...)// generic resolver that says it can be used for any type// put exact matches on the front to be tried first?// put supertype matches at the end of the// specificAccessor listimport SpelEvaluationExceptionimport SpelMessage/** Represents a bean reference to a type, for example <tt>@foo</tt> or <tt>@'foo.bar'</tt>. ... */BeanResolver beanResolvergetBeanResolver(...)getEvaluationContext(...)getStartPosition(...)SpelMessage.NO_BEAN_RESOLVER_REGISTEREDAccessException exSpelMessage.EXCEPTION_DURING_BEAN_RESOLUTIONimport BooleanTypedValue/** Represents the literal values {@code TRUE} and {@code FALSE}. ... */BooleanTypedValue value, ...;this.exitTypeDescriptorBooleanTypedValue.TRUEpushDescriptor(...)/** Represents a DOT separated expression sequence, such as ... */expressionComponents.lengthSpelNodeImpl nextNodegetChildCount(...)getValueRef(...)TypedValue resultint ccpushActiveContextObject(...)popActiveContextObject(...)SpelEvaluationException exsetPosition(...)/** Evaluates a compound expression. This involves evaluating each piece in turn and the ... */ValueRef ref...[...].exitTypeDescriptorthis.children.lengthSpelNodeImpl childisCompilable(...)// Correct the position for the error before re-throwingimport ConstructorExecutorimport ConstructorResolverimport ExpressionUtilsimport SpelNodeimport ReflectiveConstructorExecutor/** Represents the invocation of a constructor. Either a constructor on a regular type or ... */boolean isArrayConstructor, ...;...[] dimensions, ...;ConstructorExecutor cachedExecutor, ...;/** The cached executor that may be reused on subsequent evaluations. */// TODO is this caching safe - passing the expression around will mean this executor is also being passed around/** Create a constructor reference. The first argument is the type, the rest are the parameters to the constructor ... */this.isArrayConstructorthis.dimensions/** Implements getValue() - delegating to the code for building an array or a simple type. */createArray(...)createNewInstance(...)/** Create a new ordinary object and return it. ... */ConstructorExecutor executorToUsethis.cachedExecutorTypedValue childValueSpelMessage.CONSTRUCTOR_INVOCATION_PROBLEMformatMethodForMessage(...)findExecutorForConstructor(...)/** Go through the list of registered constructor resolvers and see if any can find a ... */EvaluationContext evalContextList<ConstructorResolver> ctorResolversgetConstructorResolvers(...)ConstructorResolver ctorResolverConstructorExecutor ceSpelMessage.CONSTRUCTOR_NOT_FOUND/** Create an array and return it. ... */Object intendedArrayTypeTypeCode arrayTypeCodeSpelMessage.TYPE_NAME_EXPECTED_FOR_ARRAY_CONSTRUCTIONformatClassNameForMessage(...)TypeCode.OBJECThasInitializer(...)SpelNodeImpl dimensionSpelMessage.MISSING_ARRAY_DIMENSIONthis.dimensions.lengthTypedValue ogetTypedValue(...)int arraySizetoInt(...)int[] dimsint dInlineList initializerSpelMessage.MULTIDIM_ARRAY_INITIALIZER_NOT_SUPPORTEDTypedValue dValueSpelMessage.INITIALIZER_LENGTH_INCORRECTpopulateReferenceTypeArray(...)TypeCode.BOOLEANpopulateBooleanArray(...)TypeCode.BYTEpopulateByteArray(...)TypeCode.CHARpopulateCharArray(...)TypeCode.DOUBLEpopulateDoubleArray(...)TypeCode.FLOATpopulateFloatArray(...)TypeCode.INTpopulateIntArray(...)TypeCode.LONGpopulateLongArray(...)TypeCode.SHORTpopulateShortArray(...)TypeDescriptor toTypeDescriptorObject[] newObjectArraynewObjectArray.lengthSpelNode elementNodeObject arrayEntrybyte[] newByteArraynewByteArray.lengthTypedValue typedValuetoByte(...)float[] newFloatArraynewFloatArray.lengthtoFloat(...)double[] newDoubleArraynewDoubleArray.lengthtoDouble(...)short[] newShortArraynewShortArray.lengthtoShort(...)long[] newLongArraynewLongArray.lengthtoLong(...)char[] newCharArraynewCharArray.lengthtoChar(...)boolean[] newBooleanArraynewBooleanArray.lengthtoBoolean(...)int[] newIntArraynewIntArray.lengthReflectiveConstructorExecutor executorString classDescSpelNodeImpl[] argumentsnew SpelNodeImpl[]generateCodeForArguments(...)createSignatureDescriptor(...)// Two reasons this can occur:// 1. the method invoked actually threw a real exception// 2. the method invoked was not passed the arguments it expected and has become 'stale'// In the first case we should not retry, in the second case we should see if there is a// better suited method.// To determine which situation it is, the AccessException will contain a cause.// If the cause is an InvocationTargetException, a user exception was thrown inside the constructor.// Otherwise the constructor could not be invoked.// User exception was the root cause - exit now// At this point we know it wasn't a user problem so worth a retry if a better candidate can be found// Either there was no accessor or it no longer exists// First child gives us the array type which will either be a primitive or reference type// Confirm all dimensions were specified (for example [3][][5] is missing the 2nd dimension)// Shortcut for 1 dimensional// Multi-dimensional - hold onto your hat!// There is an initializer// There is an initializer but this is a multi-dimensional array (e.g. new int[][]{{1,2},{3,4}}) - this// is not currently supported// If a dimension was specified, check it matches the initializer length// Build the array and populate it// children[0] is the type of the constructor, don't want to include that in argument processing/** Represents the elvis operator ?:. For an expression "a?:b" if a is not null, the value ... *//** Evaluate the condition and if not null, return it. ... */TypedValue valuecomputeExitTypeDescriptor(...)SpelNodeImpl conditionSpelNodeImpl ifNullValuecondition.exitTypeDescriptorifNullValue.exitTypeDescriptorString lastDescLabel elseTargetLabel endOfIfenterCompilationScope(...)exitCompilationScope(...)String conditionDescriptorString ifNullValueDescriptor// If this check is changed, the generateCode method will need changing too// exit type descriptor can be null if both components are literal expressions// Also check if empty string, as per the code in the interpreted version// if not empty, drop through to elseTarget// Use the easiest to compute common super type/** Expression language AST node that represents a float literal. ... */TypedValue value, ...;/** Utility methods (formatters etc) used during parsing and evaluation. ... *//** Produce a readable representation for a given method name with specified arguments. ... *//** Determine a readable name for a given Class object. ... */import ReflectionHelper/** A function reference is of the form "#someFunction(a,b,c)". Functions may be defined ... */// can safely be used for compilation (i.e. no argument conversion is going on)// Captures the most recently used method for the function invocation *if* the methodSpelMessage.FUNCTION_NOT_DEFINEDSpelMessage.FUNCTION_REFERENCE_CANNOT_BE_INVOKEDexecuteFunctionJLRMethod(...)/** Execute a function represented as a {@code java.lang.reflect.Method}. ... */Object[] functionArgsboolean argumentConversionOccurredconvertAllArguments(...)boolean compilableint declaredParamCountfunctionArgs.lengthSpelMessage.INCORRECT_NUMBER_OF_ARGUMENTS_TO_FUNCTIONSpelMessage.FUNCTION_MUST_BE_STATICsetupArgumentsForVarargsInvocation(...)SpelMessage.EXCEPTION_DURING_FUNCTION_CALL/** Compute the arguments to the function, they are the children of this expression node. ... */int methodModifiers// Possibly a static Java method registered as a function// Convert arguments if necessary and remap them for varargs if required// Compute arguments to the function/** An 'identifier' {@link SpelNode}. ... */TypedValue id, ...;import ReflectivePropertyAccessor// TODO support correct syntax for multidimensional [][][] and not [,,,]// TODO support multidimensional arrays/** An Indexer can index into some proceeding structure to access a particular piece of it. ... */new IndexedType(...)IndexedType ARRAY, ...;IndexedType LIST, ...;IndexedType MAP, ...;IndexedType STRING, ...;IndexedType OBJECT, ...;String cachedReadName, ...;// discovered and then cached for later use.// is used to read the property. If they do not match, the correct accessor is// If the name and target type match these cached values then the cachedReadAccessor// These fields are used when the indexer is being used as a property read accessor.Class<?> cachedReadTargetType, ...;PropertyAccessor cachedReadAccessor, ...;String cachedWriteName, ...;// is used to write the property. If they do not match, the correct accessor is// If the name and target type match these cached values then the cachedWriteAccessor// These fields are used when the indexer is being used as a property write accessor.Class<?> cachedWriteTargetType, ...;PropertyAccessor cachedWriteAccessor, ...;IndexedType indexedType, ...;TypedValue contextTypeDescriptor targetDescriptorTypedValue indexValuePropertyOrFieldReference referencegetRootContextObject(...)SpelMessage.CANNOT_INDEX_INTO_NULL_VALUEthis.indexedTypeIndexedType.MAPnew MapIndexingValueRef(...)IndexedType.ARRAYnew ArrayIndexingValueRef(...)IndexedType.LISTnew CollectionIndexingValueRef(...)isAutoGrowCollections(...)getMaximumAutoGrowSize(...)getConfiguration(...)IndexedType.STRINGnew StringIndexingLValue(...)IndexedType.OBJECTnew PropertyIndexingValueRef(...)SpelMessage.INDEXING_NOT_SUPPORTED_FOR_TYPEthis.cachedReadAccessorReflectivePropertyAccessor.OptimalPropertyAccessorint insnSpelNodeImpl indexString mapKeyNameOptimalPropertyAccessor accessoraccessor.membercheckAccess(...)Class<?> arrayComponentTypeObject retValueSpelMessage.ARRAY_INDEX_OUT_OF_BOUNDSObject arrayElementaccessArrayElement(...)setArrayElement(...)TypeDescriptor mapEntryDescriptor, ...;this.mapEntryDescriptorEvaluationContext evaluationContext, ...;TypeDescriptor targetObjectTypeDescriptor, ...;this.evaluationContextthis.targetObjectTypeDescriptorClass<?> targetObjectRuntimeClassgetObjectClass(...)List<PropertyAccessor> accessorsToTrygetPropertyAccessorsToTry(...)Indexer.this.cachedReadNameIndexer.thisIndexer.this.cachedReadTargetTypePropertyAccessor accessorIndexer.this.cachedReadAccessorcreateOptimalAccessor(...)OptimalPropertyAccessor optimalAccessoroptimalAccessor.memberIndexer.this.exitTypeDescriptorClass<?> contextObjectClassIndexer.this.cachedWriteNameIndexer.this.cachedWriteTargetTypeIndexer.this.cachedWriteAccessorSpelMessage.EXCEPTION_DURING_PROPERTY_WRITECollection<> collection, ...;TypeDescriptor collectionEntryDescriptor, ...;boolean growCollection, ...;int maximumSize, ...;this.collectionEntryDescriptorthis.growCollectionthis.maximumSizeSpelMessage.COLLECTION_INDEX_OUT_OF_BOUNDSSpelMessage.UNABLE_TO_GROW_COLLECTIONSpelMessage.UNABLE_TO_GROW_COLLECTION_UNKNOWN_ELEMENT_TYPEgetDefaultConstructor(...)int newElementsString target, ...;SpelMessage.STRING_INDEX_OUT_OF_BOUNDS// This first part of the if clause prevents a 'double dereference' of the property (SPR-5847)// In case the map key is unqualified, we want it evaluated against the root object// so temporarily push that on whilst evaluating the key// Raise a proper exception in case of a null target// At this point, we need a TypeDescriptor for a non-null target object// Indexing into a Map// If the object is something that looks indexable by an integer,// attempt to treat the index value as a number// Try and treat the index value as a property of the context object// TODO: could call the conversion service to convert the value to a String// If the string name is changing the accessor is clearly going to change (so no compilation possible)// Stack is empty, should use context object//depthPlusOne(exitTypeDescriptor)+"Ljava/lang/Object;");// Special case when the key is an unquoted string literal that will be parsed as// a property/field reference// It is OK to use the cached accessor// Insert a null value if the element type does not have a default constructor./** Represent a list in an expression, e.g. '{1,2,3}' ... */TypedValue constant, ...;// If the list is purely literals, it is a constant value and can be computed and cached// TODO must be immutable listcheckIfConstant(...)/** If all the components of the list are constants, or lists that themselves contain constants, then a constant list ... */boolean isConstantSpelNode childInlineList inlineListisConstant(...)List<Object> constantListint childcountgetLiteralValue(...)getConstantValue(...)int childCountList<Object> returnValue/** Return whether this list is a constant value. */String constantFieldNamenextFieldId(...)registerNewField(...)new FieldAdder(...) { ... }registerNewClinit(...)new ClinitAdder(...) { ... }generateClinitCode(...)// String ast matches input string, not the 'toString()' of the resultant collection, which would use []// The children might be further lists if they are not constants. In this// situation do not call back into generateCode() because it will register another clinit adder.// Instead, directly build the list here:/** Represent a map in an expression, e.g. '{name:'foo',age:12}' ... */// If the map is purely literals, it is a constant value and can be computed and cached/** If all the components of the map are constants, or lists/maps that themselves ... */InlineMap inlineMapMap<Object,Object> constantMapSpelNode keyChildSpelNode valueChildMap<Object,Object> returnValue// TODO allow for key being PropertyOrFieldReference like Indexer on maps/** Expression language AST node that represents an integer literal. ... */Integer intValue// Not sure we can get here because -1 is OpMinusimport InternalParseExceptionimport SpelParseException/** Common superclass for nodes representing literals (boolean, string, number, etc). ... */String originalValue, ...;this.originalValue/** Process the string form of a number, using the specified base if supplied ... */new IntLiteral(...)new InternalParseException(...)new SpelParseException(...)SpelMessage.NOT_AN_INTEGERnew LongLiteral(...)SpelMessage.NOT_A_LONGfloat valueparseFloat(...)new FloatLiteral(...)double valueparseDouble(...)new RealLiteral(...)SpelMessage.NOT_A_REAL/** Expression language AST node that represents a long integer literal. ... */import ExpressionInvocationTargetExceptionimport MethodResolverimport ReflectiveMethodExecutorimport ReflectiveMethodResolver/** Expression language AST node that represents a method reference. ... */boolean nullSafe, ...;String originalPrimitiveExitTypeDescriptor, ...;CachedMethodExecutor cachedExecutor, ...;this.nullSafethrowIfNotNullSafe(...)ValueRef.NullValueRef.INSTANCEValueRef.NullValueRefnew MethodValueRef(...)updateExitTypeDescriptor(...)MethodExecutor executorToUsegetCachedExecutor(...)throwSimpleExceptionIfPossible(...)findAccessorForMethod(...)new CachedMethodExecutor(...)SpelMessage.EXCEPTION_DURING_METHOD_INVOCATIONSpelMessage.METHOD_CALL_ON_NULL_OBJECT_NOT_ALLOWEDgetScopeRootContextObject(...)List<TypeDescriptor> descriptorsObject argumentList<MethodResolver> methodResolversgetMethodResolvers(...)CachedMethodExecutor executorToCheckisSuitable(...)AccessException accessExceptionMethodResolver methodResolverMethodExecutor methodExecutorSpelMessage.PROBLEM_LOCATING_METHODSpelMessage.METHOD_NOT_FOUND/** Decode the AccessException, throwing a lightweight evaluation exception or, ... */new ExpressionInvocationTargetException(...)this.originalPrimitiveExitTypeDescriptortoBoxedDescriptor(...)/** A method reference is compilable if it has been resolved to a reflectively accessible method ... */ReflectiveMethodExecutor executorhasProxyTarget(...)didArgumentConversionOccur(...)getPublicDeclaringClass(...)ReflectiveMethodExecutor methodExecutorboolean isStaticMethodLabel skipIfNullLabel continueLabelClass<?> publicDeclaringClassisDefault(...)MethodReference.thisnew IllegalAccessError(...)MethodExecutor methodExecutor, ...;Class<?> staticClass, ...;TypeDescriptor target, ...;List<TypeDescriptor> argumentTypes, ...;this.methodExecutorthis.staticClass// 2. the method invoked was not passed the arguments it expected and//    has become 'stale'// In the first case we should not retry, in the second case we should see// if there is a better suited method.// To determine the situation, the AccessException will contain a cause.// If the cause is an InvocationTargetException, a user exception was// thrown inside the method. Otherwise the method could not be invoked.// At this point we know it wasn't a user problem so worth a retry if a// better candidate can be found.// either there was no accessor or it no longer existed// Same unwrapping exception handling as above in above catch block// Make the root object the active context again for evaluating the parameter expressions// Not a default ReflectiveMethodResolver - don't know whether caching is valid// Nothing on the stack but something is needed// Something on the stack when nothing is needed// The output of the accessor will be a primitive but from the block above it might be null,// so to have a 'common stack' element at skipIfNull target we need to box the primitive/** Expression language AST node that represents null. ... *//** Represents the boolean AND operation. ... */getBooleanValue(...)getLeftOperand(...)BooleanTypedValue.FALSEgetRightOperand(...)Boolean valueassertValueNotNull(...)SpelMessage.TYPE_CONVERSION_ERRORSpelNodeImpl leftSpelNodeImpl rightisBooleanCompatible(...)left.exitTypeDescriptorright.exitTypeDescriptorunboxBooleanIfNecessary(...)// no need to evaluate right operand// Pseudo: if (!leftOperandValue) { result=false; } else { result=rightOperandValue; }// FALSE/** Decrement operator.  Can be used in a prefix or postfix form. This will throw ... */boolean postfix, ...;// false means prefixthis.postfixSpelNodeImpl operandValueRef lvalueTypedValue operandTypedValueObject operandValueTypedValue returnValueNumber op1BigDecimal.ONEOperation.SUBTRACTgetMessageCode(...)SpelMessage.OPERAND_NOT_DECREMENTABLESpelEvaluationException seeSpelMessage.SETVALUE_NOT_SUPPORTED// The operand is going to be read and then assigned to, we don't want to evaluate it twice.//operand.getValueInternal(state);// Unknown Number subtype -> best guess is double decrement// This means the operand is not decrementable// set the new value// if unable to set the value the operand is not writable (e.g. 1-- )// the return value is the new value, not the original value/** Implements division operator. ... */Object leftOperandObject rightOperandNumber leftNumberNumber rightNumberBigDecimal leftBigDecimalBigDecimal rightBigDecimalint scalescale(...)divide(...)RoundingMode.HALF_EVENBigInteger leftBigIntegerBigInteger rightBigIntegerisIntegerForNumericOp(...)Operation.DIVIDEString leftDescgetLeftOperand(...).exitTypeDescriptorString exitDescchar targetDescinsertNumericUnboxOrPrimitiveTypeCoercion(...)String rightDescgetRightOperand(...).exitTypeDescriptor// Unknown Number subtypes -> best guess is double division/** Implements the equality operator. ... */Object leftObject rightthis.leftActualDescriptortoDescriptorFromObject(...)this.rightActualDescriptorequalityCheck(...)// because it allows for simple object comparison// This check is different to the one in the other numeric operators (OpLt/etc)DescriptorComparison dccheckNumericCompatibility(...)dc.areCompatibledc.areNumbersboolean leftPrimboolean rightPrimString operatorClassNameOperator.classString evaluationContextClassNameEvaluationContext.classloadEvaluationContext(...)/** Implements greater-than-or-equal operator. ... */isCompilableOperatorUsingNumerics(...)generateComparisonCode(...)// Unknown Number subtypes -> best guess is double comparison/** Implements the greater-than operator. ... *//** Increment operator. Can be used in a prefix or postfix form. This will throw ... */ValueRef valueRefOperation.ADDSpelMessage.OPERAND_NOT_INCREMENTABLE// Unknown Number subtype -> best guess is double increment// This means the operand is not incrementable// set the name value// If unable to set the value the operand is not writable (e.g. 1++ )// The return value is the new value, not the original value/** Implements the less-than-or-equal operator. ... *//** Implements the less-than operator. ... *//** The minus operator supports: ... */SpelNodeImpl leftOpObject operandString theStringInteger theInteger// if only one operand, then this is unary minus// Unknown Number subtypes -> best guess is double subtraction// Implements character - int (ie. b - 1 = a)// unary minus/** Implements the modulus operator. ... */remainder(...)Operation.MODULUS/** Implements the {@code multiply} operator. ... *//** Implements the {@code multiply} operator directly here for certain types ... */multiply(...)int repeatsOperation.MULTIPLY// Unknown Number subtypes -> best guess is double multiplication/** Implements the not-equal operator. ... */Object leftValueObject rightValue// because we allow simple object comparisonLabel notZero// Invert the boolean/** Represents the boolean OR operation. ... */SpelEvaluationException ee// pseudo: if (leftOperandValue) { result=true; } else { result=rightOperandValue; }// TRUE/** The plus operator will: ... */TypedValue operandOneValueTypedValue operandTwoValueObject operandOneconvertTypedValueToString(...)/** Convert operand value to string using registered converter or using ... *//** Walk through a possible tree of nodes that combine strings and append ... */OpPlus pluswalk(...)// if only one operand, then this is unary plus// Unknown Number subtypes -> best guess is double addition// unary plus/** Common supertype for operators that operate on either one or two operands. ... */String operatorName, ...;String leftActualDescriptor, ...;// indicate 'int')// whose accessors seem to only be returning 'Object' - the actual descriptors may// descriptors are not providing enough information (for example a generic type// The descriptors of the runtime operand values are used if the discovered declaredString rightActualDescriptor, ...;this.operatorName/** String format for all operators is the same ... */getOperatorName(...)/** Numeric comparison operators share very similar generated code, only differing in ... */boolean unboxLeftboolean unboxRightchar targetTypedc.compatibleTypeLabel rightIsNonNullLabel leftNotNullRightIsNullLabel neitherRightNorLeftAreNullinsertUnboxInsns(...)/** Perform an equality check for the given operand values. ... *//** A descriptor comparison encapsulates the result of comparing descriptor ... */new DescriptorComparison(...)DescriptorComparison NOT_NUMBERS, ...;DescriptorComparison INCOMPATIBLE_NUMBERS, ...;boolean areNumbers, ...;boolean areCompatible, ...;// Were the two compared descriptor both for numbers?char compatibleType, ...;// If they were numbers, were they compatible?// When compatible, what is the descriptor of the common typethis.areNumbersthis.areCompatiblethis.compatibleType/** Return an object that indicates whether the input descriptors are compatible. ... */String ldString rdboolean leftNumericisPrimitiveOrUnboxableSupportedNumberOrBoolean(...)boolean rightNumericareBoxingCompatible(...)toPrimitiveTargetDesc(...)DescriptorComparison.INCOMPATIBLE_NUMBERSDescriptorComparison.NOT_NUMBERS// Supported operand types for equals (at the moment)// CodeFlow.toPrimitiveTargetDesc(leftDesc);// This code block checks whether the left or right operand is null and handles// those cases before letting the original code (that only handled actual numbers) run// stack: left/right/right// stack: left/right// here: RIGHT==null LEFT==unknown// right/left// stack: right// here: RIGHT==null LEFT==null// stack: <nothing>// load 0 or 1 depending on comparison instruction// OpLT// OpGT// false - null is not < or > null// OpLE// OpGE// true - null is <= or >= null// RIGHT==null LEFT!=null// false - something is not < or <= null// true - something is > or >= null// here: RIGHT!=null LEFT==unknown// stack: right/left// stack: right/left/left// here: RIGHT!=null LEFT==null// true - null is < or <= something// false - null is not > or >= something// neither were null so unbox and proceed with numeric comparison// What we just unboxed might be a double slot item (long/double)// so can't just use SWAP// stack: right/left(1or2slots)// stack: left(1or2)/right// assert: SpelCompiler.boxingCompatible(leftDesc, rightDesc)// Other numbers are not yet supported (isCompilable will not have returned true)// If the declared descriptors aren't providing the information, try the actual descriptors/** Represents the between operator. The left operand to between must be a single value and ... *//** Returns a boolean based on whether a value is in the range expressed. The first ... */Object lowObject highTypeComparator compSpelMessage.BETWEEN_RIGHT_OPERAND_MUST_BE_TWO_ELEMENT_LIST/** The operator 'instanceof' checks if an object is of the class specified in the right ... *//** Compare the left operand to see it is an instance of the type specified as the ... */SpelNodeImpl rightOperandTypedValue leftTypedValue rightBooleanTypedValue resultClass<?> rightClassSpelMessage.INSTANCEOF_OPERATOR_NEEDS_CLASS_OPERAND// null is not an instanceof anything// Can only generate bytecode where the right operand is a direct type reference,// not if it is indirect (for example when right operand is a variable reference)// always false - but left operand code always driven// in case it had side effects// value of false/** Implements the matches operator. Matches takes two operands: ... */new ConcurrentHashMap<String,Pattern>(...)int PATTERN_ACCESS_THRESHOLD, ...;ConcurrentMap<String,Pattern> patternCache, ...;/** Check the first operand matches the regex specified as the second operand. ... */SpelNodeImpl rightOpSpelMessage.INVALID_FIRST_OPERAND_FOR_MATCHES_OPERATORSpelMessage.INVALID_SECOND_OPERAND_FOR_MATCHES_OPERATORString rightStringthis.patternCachenew MatcherInput(...)new AccessCount(...)PatternSyntaxException exSpelMessage.INVALID_PATTERNSpelMessage.FLAWED_PATTERNCharSequence value, ...;AccessCount access, ...;/** Represents a NOT operation. ... */// Not is a unary operator so does not extend BinaryOperatorchild.exitTypeDescriptor/** The power operator. ... */pow(...)Operation.POWER/** Represents projection, where a given operation is performed on all elements in some ... */TypedValue opboolean operandIsArrayMap<?,?> mapDataenterScope(...)exitScope(...)new TypedValueHolderValueRef(...)ValueRef.TypedValueHolderValueRefIterable<?> dataClass<?> arrayElementTypedetermineCommonType(...)SpelMessage.PROJECTION_NOT_SUPPORTED_ON_TYPEClass<?> nextTypeClass<?> nextInterface// TypeDescriptor operandTypeDescriptor = op.getTypeDescriptor();// When the input is a map, we push a special context object on the stack// before calling the specified operation. This special context object// has two fields 'key' and 'value' that refer to the map entries key// and value, and they can be referenced in the operation// eg. {'a':'y','b':'n'}.![value=='y'?key:null]" == ['a', null]// TODO unable to build correct type descriptor/** Represents a simple property or field reference. ... */new AccessorLValue(...)isAutoGrowNullReferences(...)TypedValue tvPropertyAccessor accessorToUseCompilablePropertyAccessor accessorsetExitTypeDescriptor(...)readProperty(...)nextChildIs(...)Indexer.classPropertyOrFieldReference.classTypeDescriptor resultDescriptorList<?> newListwriteProperty(...)Map<?,?> newMapObject newObjectSpelMessage.UNABLE_TO_DYNAMICALLY_CREATE_OBJECT/** Attempt to read the named property from the current context object. ... */SpelMessage.EXCEPTION_DURING_PROPERTY_READSpelMessage.PROPERTY_OR_FIELD_NOT_READABLE_ON_NULLSpelMessage.PROPERTY_OR_FIELD_NOT_READABLEthis.cachedWriteAccessorSpelMessage.PROPERTY_OR_FIELD_NOT_WRITABLE_ON_NULLSpelMessage.PROPERTY_OR_FIELD_NOT_WRITABLE/** Determines the set of property resolvers that should be used to try and access a property ... */PropertyOrFieldReference ref, ...;TypedValue contextObject, ...;EvaluationContext evalContext, ...;this.contextObjectthis.evalContextthis.ref.cachedReadAccessorthis.ref.name// Dynamically create the objects if the user has requested that optional behavior// Create a new collection or map ready for the indexer// 'simple' object// This is OK - it may have gone stale due to a class change,// let's try to get a new one and call it before giving up...// Go through the accessors that may be able to resolve it. If they are a cacheable accessor then// get the accessor and use it. If they are not cacheable but report they can read the property// then ask them to read it// let others try// The output of the accessor is a primitive but from the block above it might be null,// so to have a common stack element type at skipIfNull target it is necessary// to box the primitive// If this property or field access would return a primitive - and yet// it is also marked null safe - then the exit type descriptor must be// promoted to the box type to allow a null value to be passed on/** Represents a dot separated sequence of strings that indicate a package qualified type ... */// Cache the concatenation of child identifiers/** Expression language AST node that represents a real literal. ... *//** Represents selection over a map or collection. ... */int ALL, ...;/** All items ({@code ?[]}). */int FIRST, ...;/** The first item ({@code ^[]}). */int LAST, ...;/** The last item ({@code $[]}). */int variant, ...;this.variantSpelNodeImpl selectionCriteriaMap<?,?> mapdataObject lastKeyTypedValue kvPairSpelMessage.RESULT_OF_SELECTION_CRITERIA_IS_NOT_BOOLEANMap<Object,Object> resultMapTypeDescriptor typeDescSpelMessage.INVALID_TYPE_FOR_SELECTIONprefix(...)// TODO don't lose generic info for the new map/** The common supertype of all AST nodes in a parsed Spring Expression Language ... */SpelNodeImpl.NO_CHILDREN...[] NO_CHILDREN, ...;int startPos, ...;int endPos, ...;...[] children, ...;SpelNodeImpl parent, ...;String exitTypeDescriptor, ...;/** Indicates the type descriptor for the result of this expression node. ... */this.startPosthis.endPosoperand.parent/** Return {@code true} if the next child is one of the specified classes. */SpelNodeImpl[] peersthis.parent.childrenpeers.lengthClass<?> peerClassClass<?> desiredClass// by default Ast nodes are not writable/** Check whether a node can be compiled to bytecode. The reasoning in each node may ... *//** Generate the bytecode for this node into the supplied visitor. Context info about ... */SpelMessage.NOT_ASSIGNABLE/** Generate code that handles building the argument values for the specified method. ... */String[] paramDescriptorsboolean isVarargsSpelNodeImpl lastChildString arrayTypeparamDescriptors.lengthgenerateCodeForArgument(...)getExitDescriptor(...)int arrayindexinsertNewArrayCode(...)insertArrayStore(...)/** Ask an argument to generate its bytecode and then follow it up ... */boolean primitiveOnStack// Method// The final parameter may or may not need packaging into an array, or nothing may// have been passed to satisfy the varargs and so something needs to be built.// Current supplied argument being processed// Fulfill all the parameter requirements except the last one// Determine if the final passed argument is already suitably packaged in array// form to be passed to the method// trim the leading '[', may leave other '['// build array big enough to hold remaining arguments// Package up the remaining arguments into the array// Check if need to box it for the method reference?// This would be unnecessary in the case of subtyping (e.g. method takes Number but Integer passed in)/** Expression language AST node that represents a string literal. ... */String valueWithinQuotes/** Represents a ternary expression, for example: "someCheck()?true:false". ... *//** Evaluate the condition and if true evaluate the first alternative, otherwise ... */String leftDescriptorString rightDescriptor// May reach here without it computed if all elements are literals/** Captures primitive types and their corresponding class objects, plus one special entry ... */new TypeCode(...)TypeCode OBJECT, ...;/** An {@link Object}. */TypeCode BOOLEAN, ...;/** A {@code boolean}. */TypeCode BYTE, ...;/** A {@code byte}. */TypeCode CHAR, ...;/** A {@code char}. */TypeCode DOUBLE, ...;/** A {@code double}. */TypeCode FLOAT, ...;/** A {@code float}. */TypeCode INT, ...;/** An {@code int}. */TypeCode LONG, ...;/** A {@code long}. */TypeCode SHORT, ...;TypeCode[] tcstcs.lengthTypeCode[] allValuesTypeCode typeCode/** Represents a reference to a type, for example ... */int dimensions, ...;isLowerCase(...)TypeCode tcmakeArrayIfNecessary(...)// TODO possible optimization here if we cache the discovered type reference, but can we do that?// It is a primitive type// TODO Future optimization - if followed by a static method call, skip generating code here/** Represents a reference to a value.  With a reference it is possible to get or set the ... *//** Returns the value this ValueRef points to, it should not require expression ... *//** Sets the value this ValueRef points to, it should not require expression component ... *//** Indicates whether calling setValue(Object) is supported. ... *//** A ValueRef for the null value. */new NullValueRef(...)NullValueRef INSTANCE, ...;/** A ValueRef holder for a single value, which cannot be set. */TypedValue typedValue, ...;SpelNodeImpl node, ...;// used only for error reportingthis.typedValue// The exception position '0' isn't right but the overhead of creating// instances of this per node (where the node is solely for error reporting)// would be unfortunate./** Represents a variable reference, eg. #someVar. Note this is different to a *local* ... */String THIS, ...;// Well known variables:String ROOT, ...;// currently active context object// root context objectnew VariableRef(...)// a null value will mean either the value was null or the variable was not found// If the type is not public then when generateCode produces a checkcast to it// then an IllegalAccessError will occur.// If resorting to Object isn't sufficient, the hierarchy could be traversed for// the first public type./** SpEL's abstract syntax tree. *//** SpEL's central implementation package. */import TemplateAwareExpressionParserimport Assignimport BooleanLiteralimport CompoundExpressionimport ConstructorReferenceimport Elvisimport FunctionReferenceimport Identifierimport Indexerimport InlineListimport InlineMapimport MethodReferenceimport NullLiteralimport OpAndimport OpDecimport OpDivideimport OpEQimport OpGEimport OpGTimport OpIncimport OpLEimport OpLTimport OpMinusimport OpModulusimport OpMultiplyimport OpNEimport OpOrimport OpPlusimport OperatorBetweenimport OperatorInstanceofimport OperatorMatchesimport OperatorNotimport OperatorPowerimport Projectionimport PropertyOrFieldReferenceimport QualifiedIdentifierimport Selectionimport SpelNodeImplimport StringLiteralimport Ternaryimport TypeReferenceimport VariableReference/** Hand-written SpEL parser. Instances are reusable but are not thread-safe. ... */new ArrayDeque<SpelNodeImpl>(...)Pattern VALID_QUALIFIED_ID_PATTERN, ...;Deque<SpelNodeImpl> constructedNodes, ...;// For rules that build nodes, they are stacked here for return// The expression being parsedList<Token> tokenStream, ...;// The token stream constructed from that expression stringint tokenStreamLength, ...;// length of a populated token streamint tokenStreamPointer, ...;// Current location in the token stream when processing tokens/** Create a parser with some configured behavior. ... */Tokenizer tokenizernew Tokenizer(...)SpelNodeImpl asteatExpression(...)Token tpeekToken(...)this.tokenStreamthis.tokenStreamLengththis.tokenStreamPointerthis.constructedNodest.startPosSpelMessage.MORE_INPUTnew SpelExpression(...)InternalParseException ex//      | (ELVIS^ expression))?;//	    | (QMARK^ expression COLON! expression)//	    | (DEFAULT^ logicalOrExpression)//      ( (ASSIGN^ logicalOrExpression)//    : logicalOrExpression//	expressionSpelNodeImpl expreatLogicalOrExpression(...)t.kindTokenKind.ASSIGNSpelNodeImpl assignedValuenew NullLiteral(...)t.endPosnew Assign(...)TokenKind.ELVISSpelNodeImpl valueIfNullnew Elvis(...)TokenKind.QMARKSpelNodeImpl ifTrueExprValueSpelNodeImpl ifFalseExprValueeatToken(...)TokenKind.COLONnew Ternary(...)//logicalOrExpression : logicalAndExpression (OR^ logicalAndExpression)*;eatLogicalAndExpression(...)peekIdentifierToken(...)TokenKind.SYMBOLIC_ORtakeToken(...)SpelNodeImpl rhExprcheckOperands(...)new OpOr(...)// logicalAndExpression : relationalExpression (AND^ relationalExpression)*;eatRelationalExpression(...)TokenKind.SYMBOLIC_ANDnew OpAnd(...)// relationalExpression : sumExpression (relationalOperator^ sumExpression)?;eatSumExpression(...)Token relationalOperatorTokenmaybeEatRelationalOperator(...)TokenKind tkrelationalOperatorToken.kindisNumericRelationalOperator(...)TokenKind.GTnew OpGT(...)TokenKind.LTnew OpLT(...)TokenKind.LEnew OpLE(...)TokenKind.GEnew OpGE(...)TokenKind.EQnew OpEQ(...)TokenKind.NEnew OpNE(...)TokenKind.INSTANCEOFnew OperatorInstanceof(...)TokenKind.MATCHESnew OperatorMatches(...)TokenKind.BETWEENnew OperatorBetween(...)//sumExpression: productExpression ( (PLUS^ | MINUS^) productExpression)*;eatProductExpression(...)TokenKind.PLUSTokenKind.MINUSTokenKind.INCcheckRightOperand(...)new OpPlus(...)new OpMinus(...)// productExpression: powerExpr ((STAR^ | DIV^| MOD^) powerExpr)* ;eatPowerIncDecExpression(...)TokenKind.STARTokenKind.DIVTokenKind.MODnew OpMultiply(...)new OpDivide(...)new OpModulus(...)// powerExpr  : unaryExpression (POWER^ unaryExpression)? (INC || DEC) ;eatUnaryExpression(...)TokenKind.POWERnew OperatorPower(...)TokenKind.DECnew OpInc(...)new OpDec(...)// unaryExpression: (PLUS^ | MINUS^ | BANG^ | INC^ | DEC^) unaryExpression | primaryExpression ;TokenKind.NOTnew OperatorNot(...)eatPrimaryExpression(...)// primaryExpression : startNode (node)? -> ^(EXPRESSION startNode (node)?);SpelNodeImpl starteatStartNode(...)List<SpelNodeImpl> nodesSpelNodeImpl nodeeatNode(...)new ArrayList<SpelNodeImpl>(...)new CompoundExpression(...)getEndPosition(...)// node : ((DOT dottedNode) | (SAFE_NAVI dottedNode) | nonDottedNode)+;eatDottedNode(...)eatNonDottedNode(...)TokenKind.DOTTokenKind.SAFE_NAVI// nonDottedNode: indexer;TokenKind.LSQUAREmaybeEatIndexer(...)//	;//    ))//    | lastSelection//    | firstSelection//    | selection//    | projection//	  | functionOrVar// : ((methodOrProperty//dottedNodeboolean nullSafeNavigationmaybeEatSelection(...)maybeEatProjection(...)maybeEatMethodOrProperty(...)maybeEatFunctionOrVar(...)internalException(...)SpelMessage.OODSpelMessage.UNEXPECTED_DATA_AFTER_DOT// var : POUND id=ID -> ^(VARIABLEREF[$id]);// function : POUND id=ID methodArgs -> ^(FUNCTIONREF[$id] methodArgs);// | var// : (POUND ID LPAREN) => function// functionOrVarToken functionOrVariableNameTokenKind.IDENTIFIERSpelNodeImpl[] argsmaybeEatMethodArgs(...)TokenKind.HASHnew VariableReference(...)stringValue(...)functionOrVariableName.endPosnew FunctionReference(...)// methodArgs : LPAREN! (argument (COMMA! argument)* (COMMA!)?)? RPAREN!;List<SpelNodeImpl> argsTokenKind.LPARENconsumeArguments(...)TokenKind.RPARENpositionOf(...)SpelMessage.MISSING_CONSTRUCTOR_ARGS/** Used for consuming arguments for either a method or a constructor call. */Token nextSpelMessage.RUN_OUT_OF_ARGUMENTSnext.kindTokenKind.COMMA//	    | constructor//	    | indexer//	    | lastSelection//	    | firstSelection//	    | selection//	    | projection//	    | functionOrVar//	    | methodOrProperty//	    | type// : parenExpr | literal//startNodemaybeEatLiteral(...)maybeEatParenExpression(...)maybeEatConstructorReference(...)maybeEatTypeReference(...)maybeEatNullReference(...)maybeEatBeanReference(...)maybeEatInlineListOrMap(...)// quoted if dotted// parse: @beanname @'bean.name'TokenKind.BEAN_REFTokenKind.FACTORY_BEAN_REFToken beanRefTokenToken beanNameTokenTokenKind.LITERAL_STRINGbeanRefToken.startPosSpelMessage.INVALID_BEAN_REFERENCEString beanNameStringTokenKind.FACTORY_BEAN_REF.tokenCharsnew BeanReference(...)beanNameToken.endPosbeanNameToken.startPosToken typeNameeatPossiblyQualifiedId(...)int dimsTokenKind.RSQUAREnew PropertyOrFieldReference(...)typeName.startPostypeName.endPosToken nullTokennullToken.startPosnullToken.endPos//projection: PROJECT^ expression RCURLY!;TokenKind.PROJECTnew Projection(...)// map  = LCURLY (key ':' value (COMMA key ':' value)*) RCURLY// list = LCURLY (element (COMMA element)*) RCURLYToken closingCurlyTokenKind.LCURLYTokenKind.RCURLYnew InlineList(...)closingCurly.endPosnew InlineMap(...)SpelNodeImpl firstExpressionList<SpelNodeImpl> elementsnew Indexer(...)peekSelectToken(...)SpelMessage.MISSING_SELECTION_EXPRESSIONTokenKind.SELECT_FIRSTnew Selection(...)Selection.FIRSTTokenKind.SELECT_LASTSelection.LASTSelection.ALL/** Eat an identifier, possibly qualified (meaning that it is dotted). ... */Deque<SpelNodeImpl> qualifiedIdPiecesToken nodeisValidQualifiedId(...)node.kindnew Identifier(...)node.startPosnode.endPosSpelMessage.NOT_EXPECTED_TOKENnew QualifiedIdentifier(...)// a series of identifiers and dollars into a single identifier.// Dollars are normally separate tokens but there we want to combine// This is complicated due to the support for dollars in identifiers.Token methodOrPropertyNamemethodOrPropertyName.startPosmethodOrPropertyName.endPosnew MethodReference(...)//:	('new' qualifiedId LPAREN) => 'new' qualifiedId ctorArgs -> ^(CONSTRUCTOR qualifiedId ctorArgs)//constructorToken newTokenSpelNodeImpl possiblyQualifiedConstructorNamenewToken.startPosnewToken.endPosList<SpelNodeImpl> dimensionsnew ConstructorReference(...)eatConstructorArgs(...)//	| NULL_LITERAL//	| DQ_STRING_LITERAL//  | REAL_LITERAL//  | HEXADECIMAL_INTEGER_LITERAL//	| STRING_LITERAL//	| boolLiteral//  : INTEGER_LITERAL//	literalTokenKind.LITERAL_INTgetIntLiteral(...)TokenKind.LITERAL_LONGgetLongLiteral(...)TokenKind.LITERAL_HEXINTTokenKind.LITERAL_HEXLONGTokenKind.LITERAL_REALgetRealLiteral(...)TokenKind.LITERAL_REAL_FLOATnew BooleanLiteral(...)new StringLiteral(...)//parenExpr : LPAREN! expression RPAREN!;// | GREATER_THAN_OR_EQUAL | INSTANCEOF | BETWEEN | MATCHES// : EQUAL | NOT_EQUAL | LESS_THAN | LESS_THAN_OR_EQUAL | GREATER_THAN// relationalOperatorisIdentifier(...)String idStringasInstanceOfToken(...)asMatchesToken(...)asBetweenToken(...)t.dataTokenKind.SELECThasPayload(...)checkLeftOperand(...)token.startPosSpelMessage.LEFT_OPERAND_PROBLEMSpelMessage.RIGHT_OPERAND_PROBLEM// a=b// a?:b (a if it isn't null, otherwise b)// elvis has left the building// a?b:c//consume OR// consume 'AND'// consume relational operator token//consume PLUS or MINUS or INC// consume STAR/DIV/MOD//consume POWER//consume INC/DEC// always a start node// it was a '.' or a '?.'// unexpectedly ran out of data// consume (first time through) or comma (subsequent times)// if null assume the problem is because the right token was// not found at the end of the expression// It looks like a type reference but is T being used as a map key?// looks like 'T]' (T is map key)// dotted qualified id// Are there array dimensions?// empty list '{}'// empty map '{:}'// Next is either:// '}' - end of list// ',' - more expressions in this list// ':' - this is a map!// list with one item in it// multi-item list// map!// property// method reference// TODO what is the end position for a method reference? the name or the last arg?// It looks like a constructor reference but is NEW being used as a map key?// looks like 'NEW]' (so NEW used as map key)// array initializer// regular constructor invocation// TODO correct end position?// Might be one of the textual forms of the operators (e.g. NE for != ) -// in which case we can treat it as an identifier. The list is represented here:// Tokenizer.alternativeOperatorNames and those ones are in order in the TokenKind enum.// if t.data were null, we'd know it wasn't the textual form, it was the symbol formimport CompiledExpression/** A SpelCompiler will take a regular parsed expression and create (and load) a class ... */SpelCompiler.classnew ConcurrentReferenceHashMap<ClassLoader,SpelCompiler>(...)int CLASSES_DEFINED_LIMIT, ...;Map<ClassLoader,SpelCompiler> compilers, ...;// classloader and the child is used to load the compiled expressions.// A compiler is created for each classloader, it manages a child class loader of thatChildClassLoader childClassLoader, ...;// The child ClassLoader used to load the compiled expression classesAtomicInteger suffixId, ...;// Counter suffix for generated classes within this SpelCompiler instancethis.childClassLoadernew ChildClassLoader(...)/** Attempt compilation of the supplied expression. A check is made to see ... */Class<? extends CompiledExpression> clazzcreateExpressionClass(...)this.suffixId/** Generate the class that encapsulates the compiled expression and define it. ... */getNextSuffix(...)ClassWriter cwnew ExpressionClassWriter(...)CodeFlow cfnew CodeFlow(...)/** Load a compiled expression class. Makes sure the classloaders aren't used too much ... */ChildClassLoader cclgetClassesDefinedCount(...)ChildClassLoader currentCcl/** Factory method for compiler instances. The returned SpelCompiler will ... */SpelCompiler compilernew SpelCompiler(...)/** Request that an attempt is made to compile the specified expression. ... */compileExpression(...)/** Request to revert to the interpreter for expression evaluation. ... */revertToInterpreted(...)/** A ChildClassLoader will load the generated compiled expression classes. */new URL[]...[] NO_URLS, ...;AtomicInteger classesDefinedCount, ...;this.classesDefinedCount/** An ASM ClassWriter extension bound to the SpelCompiler's ClassLoader. */ClassWriter.COMPUTE_MAXSClassWriter.COMPUTE_FRAMES// Create class outline 'spel/ExNNN extends org.springframework.expression.spel.CompiledExpression'// Create default constructor// Create getValue() method// Ask the expression AST to generate the body of the method// TODO need to make this conditionally occur based on a debug flag// dump(expressionToCompile.toStringAST(), clazzName, data);// Still the same ClassLoader that needs to be replaced...// Already replaced by some other thread, let's pick it up.// Quick check for existing compiler without lock contention// Full lock now since we're creating a child ClassLoaderimport SpelCompilerMode/** A {@code SpelExpression} represents a parsed (valid) expression that is ready to be ... */int INTERPRETED_COUNT_THRESHOLD, ...;// Number of times to interpret an expression before compiling itint FAILED_ATTEMPTS_THRESHOLD, ...;// Number of times to try compiling an expression before giving upSpelNodeImpl ast, ...;// The default context is used if no override is supplied by the userCompiledExpression compiledAst, ...;// Holds the compiled form of the expression (if it has been compiled)AtomicInteger interpretedCount, ...;// when certain limit reached// Count of many times as the expression been interpreted - can trigger compilationAtomicInteger failedAttempts, ...;// give up trying to compile it when it just doesn't seem to be possible.// The number of times compilation was attempted and failed - enables us to eventually/** Construct an expression, only used by the parser. */this.ast/** Set the evaluation context that will be used if none is specified on an evaluation call. ... *//** Return the default evaluation context that will be used if none is supplied on an evaluation call. ... */// implementing ExpressionCompiledExpression compiledAstthis.compiledAstExpressionState expressionStatenew ExpressionState(...)getCompilerMode(...)SpelCompilerMode.MIXEDthis.interpretedCountSpelMessage.EXCEPTION_RUNNING_COMPILED_EXPRESSIONcheckCompile(...)TypedValue typedResultValuetoTypedValue(...)getValueType(...)getValueTypeDescriptor(...)/** Compile the expression if it has been evaluated more than the threshold number ... */SpelCompilerMode compilerModeSpelCompilerMode.IMMEDIATE/** Perform expression compilation. This will only succeed once exit descriptors for ... */this.failedAttemptsgetCompiler(...)getCompilerClassLoader(...)/** Cause an expression to revert to being interpreted if it has been using a compiled ... *//** Return the Abstract Syntax Tree for the expression. *//** Produce a string representation of the Abstract Syntax Tree for the expression. ... */// If running in mixed mode, revert to interpreted// Running in SpelCompilerMode.immediate mode - propagate exception to caller// compilerMode = SpelCompilerMode.MIXED// Previously compiled// Don't try again// Compiled by another thread before this thread got into the sync block// Successfully compiled// Failed to compile/** SpEL parser. Instances are reusable and thread-safe. ... *//** Create a parser with default settings. *//** Create a parser with the specified configuration. ... */new InternalSpelExpressionParser(...)/** Holder for a kind of token, the associated data and its position in the input data ... */TokenKind kind, ...;String data, ...;// index of first character/** Constructor for use when there is no particular data for the token ... */// index of char after the last characternew Token(...)StringBuilder s/** Token Kinds. ... */new TokenKind(...)TokenKind LITERAL_INT, ...;// ordered by priority - operands firstTokenKind LITERAL_LONG, ...;TokenKind LITERAL_HEXINT, ...;TokenKind LITERAL_HEXLONG, ...;TokenKind LITERAL_STRING, ...;TokenKind LITERAL_REAL, ...;TokenKind LITERAL_REAL_FLOAT, ...;TokenKind LPAREN, ...;TokenKind RPAREN, ...;TokenKind COMMA, ...;TokenKind IDENTIFIER, ...;TokenKind COLON, ...;TokenKind HASH, ...;TokenKind RSQUARE, ...;TokenKind LSQUARE, ...;TokenKind LCURLY, ...;TokenKind RCURLY, ...;TokenKind DOT, ...;TokenKind PLUS, ...;TokenKind STAR, ...;TokenKind MINUS, ...;TokenKind SELECT_FIRST, ...;TokenKind SELECT_LAST, ...;TokenKind QMARK, ...;TokenKind PROJECT, ...;TokenKind DIV, ...;TokenKind GE, ...;TokenKind GT, ...;TokenKind LE, ...;TokenKind LT, ...;TokenKind EQ, ...;TokenKind NE, ...;TokenKind MOD, ...;TokenKind NOT, ...;TokenKind ASSIGN, ...;TokenKind INSTANCEOF, ...;TokenKind MATCHES, ...;TokenKind BETWEEN, ...;TokenKind SELECT, ...;TokenKind POWER, ...;TokenKind ELVIS, ...;TokenKind SAFE_NAVI, ...;TokenKind BEAN_REF, ...;TokenKind FACTORY_BEAN_REF, ...;TokenKind SYMBOLIC_OR, ...;TokenKind SYMBOLIC_AND, ...;TokenKind INC, ...;TokenKind DEC, ...;...[] tokenChars, ...;boolean hasPayload, ...;// is there more to this token than simply the kindthis.tokenCharsthis.hasPayloadthis.tokenChars.length/** Lex some input data into a stream of tokens that can then be parsed. ... */new ArrayList<Token>(...)...[] ALTERNATIVE_OPERATOR_NAMES, ...;// If this gets changed, it must remain sorted......[] FLAGS, ...;byte IS_DIGIT, ...;byte IS_HEXDIGIT, ...;byte IS_ALPHA, ...;...[] charsToProcess, ...;int max, ...;List<Token> tokens, ...;this.charsToProcessthis.maxthis.charsToProcess.lengthlexIdentifier(...)isTwoCharToken(...)pushPairToken(...)pushCharToken(...)raiseParseException(...)SpelMessage.MISSING_CHARACTERlexNumericLiteral(...)lexQuotedStringLiteral(...)lexDoubleQuotedStringLiteral(...)SpelMessage.UNEXPECTED_ESCAPE_CHARthis.tokens// STRING_LITERAL: '\''! (APOS|~'\'')* '\''!;boolean terminatedisExhausted(...)SpelMessage.NON_TERMINATING_QUOTED_STRINGsubarray(...)// DQ_STRING_LITERAL: '"'! (~'"')* '"'!;SpelMessage.NON_TERMINATING_DOUBLE_QUOTED_STRING// : (DECIMAL_DIGIT)+ (INTEGER_TYPE_SUFFIX)?;// INTEGER_LITERAL// fragment REAL_TYPE_SUFFIX : 'F' | 'f' | 'D' | 'd';// fragment SIGN : '+' | '-' ;// (DECIMAL_DIGIT)+ ;// fragment EXPONENT_PART : 'e' (SIGN)* (DECIMAL_DIGIT)+ | 'E' (SIGN)*// '0'|'1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9'|'A'|'B'|'C'|'D'|'E'|'F'|'a'|'b'|'c'|'d'|'e'|'f';// fragment HEX_DIGIT :// fragment INTEGER_TYPE_SUFFIX : ( 'L' | 'l' );// ((DECIMAL_DIGIT)+ (REAL_TYPE_SUFFIX));// ((DECIMAL_DIGIT)+ (EXPONENT_PART) (REAL_TYPE_SUFFIX)?) |// ((DECIMAL_DIGIT)+ '.' (DECIMAL_DIGIT)+ (EXPONENT_PART)? (REAL_TYPE_SUFFIX)?) |// ('.' (DECIMAL_DIGIT)+ (EXPONENT_PART)? (REAL_TYPE_SUFFIX)?) |// REAL_LITERAL :boolean isRealboolean isHexint endOfNumberisHexadecimalDigit(...)isChar(...)pushHexIntToken(...)int dotpospushIntToken(...)SpelMessage.REAL_CANNOT_BE_LONGisExponentChar(...)char possibleSignboolean isFloatisSign(...)isFloatSuffix(...)isDoubleSuffix(...)pushRealToken(...)char[] subarrayString asStringpushOneCharOrTwoCharToken(...)/** Check if this might be a two character token. */kind.tokenChars.lengthkind.tokenChars/** Push a token of just one character in length. *//** Push a token of two characters in length. */// ID: ('a'..'z'|'A'..'Z'|'_'|'$') ('a'..'z'|'A'..'Z'|'_'|'$'|'0'..'9'|DOT_ESCAPED)*;// the other way to start an identifier// drift over white space// hit sentinel at end of value// will take us to the end// may not be the end if the char after is also a '// skip over that too, and continue// may not be the end if the char after is also a "// deal with hexadecimal// real numbers must have leading digits// Consume first part of number// a '.' indicates this number is a real// carry on consuming digits// the number is something like '3.'. It is really an int but may be// part of something like '3.toString()'. In this case process it as// an int and leave the dot as a separate token.// Now there may or may not be an exponent// Is it a long ?// 3.4L - not allowed// if it wasn't before, it is now// exponent digits// Check if this is the alternative (textual) representation of an operator (see// alternativeOperatorNames)/** SpEL's standard parser implementation. *//** A {@link TypedValue} for booleans. ... */new BooleanTypedValue(...)BooleanTypedValue TRUE, ...;/** True. */BooleanTypedValue FALSE, ...;/** False. *//** A {@link org.springframework.expression.MethodResolver} variant for data binding ... *//** Create a new data-binding method resolver for instance method resolution. */new DataBindingMethodResolver(...)/** A {@link org.springframework.expression.PropertyAccessor} variant for data binding ... *//** Create a new property accessor for reading and possibly also writing. ... *//** Create a new data-binding property accessor for read-only operations. */new DataBindingPropertyAccessor(...)/** Create a new data-binding property accessor for read-write operations. *//** Utility methods used by the reflection resolver code to discover the appropriate ... *//** Compare argument arrays and return information about whether they match. ... */ArgumentsMatchKind matchArgumentsMatchKind.EXACTTypeDescriptor suppliedArgTypeDescriptor expectedArgArgumentsMatchKind.REQUIRES_CONVERSIONArgumentsMatchKind.CLOSEnew ArgumentsMatchInfo(...)/** Based on {@link MethodInvoker#getTypeDifferenceWeight(Class[], Object[])} but operates on TypeDescriptors. */TypeDescriptor paramTypeTypeDescriptor argTypeClass<?> paramTypeClazzint argCountUpToVarargsTypeDescriptor varargsDescClass<?> varargsParamType/** Convert a supplied set of arguments into the requested types. If the parameterTypes are related to ... */// TODO could do with more refactoring around argument handling and varargsInteger varargsPositionconvertArguments(...)/** Takes an input set of argument values and converts them to the types specified as the ... */boolean conversionOccurredisFirstEntryInArray(...)/** Check if the supplied value is the first entry in the array represented by the possibleArray value. ... */Object arrayValue/** Package up the arguments so that they correctly match what is expected in parameterTypes. ... */requiredParameterTypes.lengthObject[] newArgsObject repackagedArgsnewArgs.length/** Arguments match kinds. */new ArgumentsMatchKind(...)ArgumentsMatchKind EXACT, ...;/** An exact match is where the parameter types exactly match what the method/constructor is expecting. */ArgumentsMatchKind CLOSE, ...;/** A close match is where the parameter types either exactly match or are assignment-compatible. */ArgumentsMatchKind REQUIRES_CONVERSION, ...;/** A conversion match is where the type converter must be used to transform some of the parameter types. *//** An instance of ArgumentsMatchInfo describes what kind of match was achieved ... */ArgumentsMatchKind kind, ...;// The user may supply null - and that will be ok unless a primitive is expected// Check up until the varargs argument:// Deal with the arguments up to 'expected number' - 1 (that is everything but the varargs argument)// If already confirmed it cannot be a match, then return// Special case: there is one parameter left and it is an array and it matches the varargs// expected argument - that is a match, the caller has already built the array. Proceed with it.// Now... we have the final argument in the method we are checking as a match and we have 0// or more other arguments left to pass to it.// All remaining parameters must be of this type or convertible to this type// Convert everything up to the varargs position// If the target is varargs and there is just one more argument// then convert it here// Three outcomes of that previous line:// 1) the input argument was already compatible (ie. array of valid type) and nothing was done// 2) the input argument was correct type but not in an array so it was made into an array// 3) the input argument was the wrong type and got converted and put into an array// case 3// Convert remaining arguments to the varargs element type// Check if array already built for final argument// Check if repackaging is needed...// zero size array if nothing to pass as the varargs parameter// Create an array for the varargs arguments// Now sort out the final argument, which is the varargs one. Before entering this method,// the arguments should have been converted to the box form of the required type./** A simple ConstructorExecutor implementation that runs a constructor using reflective ... */Constructor<?> ctor, ...;Integer varargsPosition, ...;this.ctorthis.varargsPosition/** A constructor resolver that uses reflection to locate the constructor that should be invoked. ... *//** Locate a constructor on the type. There are three kinds of match that might occur: ... */Constructor<?> closeMatchConstructor<?> matchRequiringConversionnew Comparator<Constructor<?>>(...) { ... }int c1plint c2plReflectionHelper.ArgumentsMatchInfoArgumentsMatchInfo matchInfocompareArgumentsVarargs(...)compareArguments(...)isExactMatch(...)new ReflectiveConstructorExecutor(...)isCloseMatch(...)isMatchRequiringConversion(...)EvaluationException ex// *sigh* complicated// Basically.. we have to have all parameters match up until the varargs one, then the rest of what is// being provided should be// the same type whilst the final argument to the method must be an array of that (oh, how easy...not) -// or the final parameter// we are supplied does match exactly (it is an array already).// worth a closer look/** {@link MethodExecutor} that works via reflection. ... */Method originalMethod, ...;Method methodToInvoke, ...;boolean computedPublicDeclaringClass, ...;Class<?> publicDeclaringClass, ...;boolean argumentConversionOccurred, ...;/** Create a new executor for the given method. ... */this.originalMethodthis.methodToInvoke/** Return the original method that this executor has been configured for. *//** Find the first public class in the methods declaring class hierarchy that declares this method. ... */this.computedPublicDeclaringClassthis.publicDeclaringClassdiscoverPublicDeclaringClass(...)this.argumentConversionOccurred// Continue below.../** Reflection-based {@link MethodResolver} used by default in {@link StandardEvaluationContext} ... */boolean useDistance, ...;// more closely following the Java rules.// Using distance will ensure a more accurate match is discovered,Map<Class<?>,MethodFilter> filters, ...;this.useDistance/** This constructor allows the ReflectiveMethodResolver to be configured such that it ... *//** Register a filter for methods on the given type. ... */new HashMap<Class<?>,MethodFilter>(...)/** Locate a method on a type. There are three kinds of match that might occur: ... */ArrayList<Method> methodsSet<Method> methodsToIterateMethod closeMatchint closeMatchDistanceMethod matchRequiringConversionboolean multipleOptionsList<Method> filteredint m1plint m2plnew ReflectiveMethodExecutor(...)int matchDistanceSpelMessage.MULTIPLE_POSSIBLE_METHODSSet<Method> resultisCandidateForInvocation(...)/** Return the set of methods for this type. The default implementation returns the ... *//** Determine whether the given {@code Method} is a candidate for method resolution ... */// If a filter is registered for this type, call it// Sort methods into a sensible order// vararg methods go last// Resolve any bridge methods// Remove duplicate methods (possible due to resolved bridge methods)// Name and parameter number match, check the arguments// This is a better match...// Take this as a close match if there isn't one already// Add these so that static methods are invocable on the type: e.g. Float.valueOf(..)// Also expose methods from java.lang.Class itself// Expose interface methods (not proxy-declared overrides) for proper vararg introspection/** A powerful {@link PropertyAccessor} that uses reflection to access properties ... */new ConcurrentHashMap<PropertyCacheKey,InvokerPair>(...)new ConcurrentHashMap<PropertyCacheKey,Member>(...)new ConcurrentHashMap<PropertyCacheKey,TypeDescriptor>(...)Set<Class<?>> booleanTypesSet<Class<?>> ANY_TYPES, ...;Set<Class<?>> BOOLEAN_TYPES, ...;boolean allowWrite, ...;Map<PropertyCacheKey,InvokerPair> readerCache, ...;Map<PropertyCacheKey,Member> writerCache, ...;Map<PropertyCacheKey,TypeDescriptor> typeDescriptorCache, ...;Map<Class<?>,Method[]> sortedMethodsCache, ...;InvokerPair lastReadInvokerPair, ...;/** Create a new property accessor for reading as well writing. ... */this.allowWrite/** Returns {@code null} which means this is a general purpose accessor. */PropertyCacheKey cacheKeynew PropertyCacheKey(...)findGetterForProperty(...)this.readerCachenew InvokerPair(...)InvokerPair invokerthis.lastReadInvokerPairinvoker.memberinvoker.typeDescriptorfindSetterForProperty(...)this.writerCacheObject possiblyConvertedNewValueMember cachedMemberEvaluationException evaluationException/** Get the last read invoker pair. ... */InvokerPair lastReadInvokerlastReadInvoker.member/** Find a getter method for the specified property. */findMethodForProperty(...)getPropertyMethodSuffixes(...)/** Find a setter method for the specified property. */getSortedMethods(...)String methodSuffixisCandidateForProperty(...)/** Return class methods ordered with non-bridge methods appearing higher. */this.sortedMethodsCache/** Determine whether the given {@code Method} is a candidate for property access ... *//** Return the method suffixes for a given property name. The default implementation ... */getPropertyMethodSuffix(...)/** Return the method suffix for a given property name. The default implementation ... *//** Find a field of a certain name on a specified class. *//** Attempt to create an optimized property accessor tailored for a property of a ... */InvokerPair invocationTargetinvocationTarget.membernew OptimalPropertyAccessor(...)/** Captures the member (method/field) to call reflectively to access a property value ... */boolean targetIsClass, ...;this.targetIsClassPropertyCacheKey otherKeyotherKey.clazzotherKey.propertyotherKey.targetIsClassother.clazzother.property/** An optimized form of a PropertyAccessor that will use reflection but only knows ... *//** The member being accessed. */target.membertarget.typeDescriptor// Treat it like a property...// The readerCache will only contain gettable properties (let's not worry about setters for now).// Treat it like a property// Attempt to populate the cache entry// Continue with null type descriptor// We'll search superclasses and implemented interfaces explicitly,// although it shouldn't be necessary - however, see SPR-10125.// Don't be clever for arrays or a null target...// A static field/method call will not consume what is on the stack,// it needs to be popped off.import TypeLocator/** A basic implementation of {@link EvaluationContext} that focuses on a subset ... */new StandardTypeComparator(...)new StandardOperatorOverloader(...)new TypeLocator(...) { ... }SpelMessage.TYPE_NOT_FOUNDTypeLocator typeNotFoundTypeLocator, ...;List<PropertyAccessor> propertyAccessors, ...;List<MethodResolver> methodResolvers, ...;TypeComparator typeComparator, ...;OperatorOverloader operatorOverloader, ...;Map<String,Object> variables, ...;this.propertyAccessorsthis.methodResolvers/** Return the specified root object, if any. *//** Return the specified {@link PropertyAccessor} delegates, if any. ... *//** Return an empty list, always, since this context does not support the ... *//** Return the specified {@link MethodResolver} delegates, if any. ... *//** {@code SimpleEvaluationContext} does not support the use of bean references. ... *//** {@code SimpleEvaluationContext} does not support use of type references. ... *//** The configured {@link TypeConverter}. ... *//** Return an instance of {@link StandardTypeComparator}. */this.typeComparator/** Return an instance of {@link StandardOperatorOverloader}. */this.operatorOverloader/** Create a {@code SimpleEvaluationContext} for the specified {@link PropertyAccessor} ... */ReflectivePropertyAccessor.class/** Create a {@code SimpleEvaluationContext} for read-only access to ... */forReadOnlyAccess(...)/** Create a {@code SimpleEvaluationContext} for read-write access to ... */forReadWriteAccess(...)/** Builder for {@code SimpleEvaluationContext}. */List<PropertyAccessor> accessors, ...;List<MethodResolver> resolvers, ...;this.accessors/** Register the specified {@link MethodResolver} delegates for ... */MethodResolver resolverReflectiveMethodResolver.classthis.resolvers/** Register a {@link DataBindingMethodResolver} for instance method invocation purposes ... */forInstanceMethodInvocation(...)/** Register a custom {@link ConversionService}. ... *//** Register a custom {@link TypeConverter}. ... *//** Specify a default root object to resolve against. ... *//** Specify a typed root object to resolve against. ... */new SimpleEvaluationContext(...)/** A powerful and highly configurable {@link EvaluationContext} implementation. ... */List<ConstructorResolver> constructorResolvers, ...;ReflectiveMethodResolver reflectiveMethodResolver, ...;BeanResolver beanResolver, ...;TypeLocator typeLocator, ...;/** Create a {@code StandardEvaluationContext} with a null root object. *//** Create a {@code StandardEvaluationContext} with the given root object. ... */initPropertyAccessors(...)addBeforeDefault(...)this.constructorResolversinitConstructorResolvers(...)initMethodResolvers(...)this.beanResolverthis.typeLocator/** Register a {@code MethodFilter} which will be called during method resolution ... */this.reflectiveMethodResolverregisterMethodFilter(...)List<PropertyAccessor> accessorsnew ReflectivePropertyAccessor(...)List<ConstructorResolver> resolversnew ArrayList<ConstructorResolver>(...)new ReflectiveConstructorResolver(...)List<MethodResolver> resolversnew ArrayList<MethodResolver>(...)// For backwards compatibility, we ignore null names here...// And since ConcurrentHashMap cannot store null values, we simply take null// as a remove from the Map (with the same result from lookupVariable below)./** Standard implementation of {@link OperatorOverloader}. ... *//** A basic {@link TypeComparator} implementation: supports comparison of ... */SpelMessage.NOT_COMPARABLE// If one is null, check if the other is// left cannot be null at this point// Basic number comparisons/** Default implementation of the {@link TypeConverter} interface, ... *//** Create a StandardTypeConverter for the default ConversionService. ... *//** Create a StandardTypeConverter for the given ConversionService. ... */ConversionException ex/** A simple implementation of {@link TypeLocator} that uses the context ClassLoader ... */List<String> knownPackagePrefixes, ...;/** Create a StandardTypeLocator for the default ClassLoader ... *//** Create a StandardTypeLocator for the given ClassLoader. ... *//** Register a new import prefix that will be used when searching for unqualified types. ... */this.knownPackagePrefixes/** Remove that specified prefix from this locator's list of imports. ... *//** Return a list of all the import prefixes registered with this StandardTypeLocator. ... *//** Find a (possibly unqualified) type reference - first using the type name as-is, ... */ClassNotFoundException ey// Similar to when writing regular Java code, it only knows about java.lang by default// try any registered prefixes before giving up// might be a different prefix/** SpEL's default implementations for various core abstractions. *//** Common superclass for expression tests. ... */getTestEvaluationContext(...)boolean DEBUG, ...;boolean SHOULD_BE_WRITABLE, ...;boolean SHOULD_NOT_BE_WRITABLE, ...;ExpressionParser parser, ...;StandardEvaluationContext context, ...;/** Evaluate an expression and check that the actual result matches the ... */Class<?> resultTypeprintAbstractSyntaxTree(...)stringValueOf(...)Class<? extends Object> resultType/** Evaluate the specified expression and ensure the expected message comes out. ... */evaluateAndCheckError(...)SpelEvaluationException.classnew Consumer<SpelEvaluationException>(...) { ... }otherProperties.lengthObject[] insertsgetInserts(...)Object[] expectedInsertsinserts.lengthhasSizeGreaterThanOrEqualTo(...)expectedInserts.length/** Parse the specified expression and ensure the expected message comes out. ... */SpelParseException.classnew Consumer<SpelParseException>(...) { ... }/** Produce a nice string representation of the input object. ... */int[] ll.lengthlong[] lList<Object> l// Check the return value// no point doing other checks// first one is expected position of the error within the string// Check inserts match// do something nice for arrays/** Test construction of arrays. ... */evaluateArrayBuildingExpression(...)SpelMessage.INCORRECT_ELEMENT_TYPE_FOR_ARRAYExpression e/** Tests the evaluation of real boolean expressions, these use AND, OR, NOT, TRUE, FALSE ... */// SPR-9445// without null conversion// with null conversion (null -> false)/** Test for caching in {@link MethodReference} (SPR-10657). ... */new RootObject(...)assertMethodExecution(...)new BaseObject(...)import PlaceOfBirth/** Tests invocation of constructors. ... */this.iStandardEvaluationContext eContextsetRootObject(...)new PlaceOfBirth(...)StandardEvaluationContext ctxList<ConstructorResolver> constructorResolversConstructorResolver dummynew DummyConstructorResolver(...)List<ConstructorResolver> copyaddConstructorResolver(...)removeConstructorResolver(...)setConstructorResolvers(...)/* These tests are attempting to call constructors where we need to widen or convert ... */// Test ctor on inventor:// On 1 it will throw an IllegalArgumentException// On 2 it will throw a RuntimeException// On 3 it will exit normally// In each case it increments the Tester field 'counter' when invoked// Normal exit// Now the expression has cached that throwException(int) is the right thing to// call. Let's change 'bar' to be a PlaceOfBirth which indicates the cached// reference is out of date.// That confirms the logic to mark the cached reference stale and retry is working// Now let's cause the method to exit via exception and ensure it doesn't cause// a retry.// First, switch back to throwException(int)// 4 will make it throw a checked exception - this will be wrapped by spel on the// way out// A problem occurred whilst attempting to construct an object of type// 'org.springframework.expression.spel.ConstructorInvocationTests$Tester'// using arguments '(java.lang.Integer)'// If counter is 4 then the method got called twice!// 1 will make it throw a RuntimeException - SpEL will let this through// If counter is 5 then the method got called twice!// reflective constructor accessor is the only one by default// Calling 'Fruit(String... strings)'// all need converting to strings// needs string conversion// first and last need conversion// Calling 'Fruit(int i, String... strings)' - returns int+length_of_strings// widening of int 3 to double 3 is OK// widening of int 3 to long 3 is OK// Closest ctor will be new String(String) and converter supports Double>String// TODO currently failing as with new ObjectToArray converter closest constructor// matched becomes String(byte[]) which fails...import StandardTypeComparator/** Unit tests for type comparison ... */TypeComparator comparatorBigDecimal bdOneBigDecimal bdTwocanCompare(...)// primitive intimport SpelExpressionimport TestPerson/** Tests the evaluation of real expressions in a real context. ... */ExpressionParser parserTestClass testClassnew TestClass(...)testClass.listEvaluationException.class// wibble2 should be null (cannot be initialized dynamically), there is no setter// mixing operators// property access// nested properties// methods// constructorsSpelExpression eString newString// unary expressions// assignment// variables and functions// type referencesEvaluationContext ctxevaluateAndAskForReturnType(...)int twentyFourdouble oneint oint sixteenint minusFortyFiveboolean trueValueClass<?> stringClass/** SPR-6984: attempting to index a collection on write using an index that ... */TestPerson personnew TestPerson(...)SpelParserConfiguration configgetStreet(...)getCrossStreets(...)/** Verifies behavior requested in SPR-9613. *//** Verifies behavior requested in SPR-9621. */List<MethodResolver> customResolversnew CustomMethodFilter(...)new CustomMethodResolver(...)setMethodResolvers(...)/** This test is checking that with the changes for 9751 that the refactoring in Indexer is ... */Spr9751 instancenew Spr9751(...)StandardEvaluationContext failCtxExpression failExpinstance.listOfStringsTestClass instance// For now I am making #this not assignableSpr9751 helperBigDecimal return_bddouble return_dddfloat return_ffflong return_lllint return_iiishort return_ssshelper.bdhelper.dddhelper.fffhelper.lllhelper.iiihelper.sssint return_sssExpression e1Expression e2helper.index1helper.intArray// Verify how all the nodes behave with assignment (++, --, =)int return_foo_iiiint rexpectFailNotAssignable(...)expectFailSetValueNotSupported(...)helper.foo.iiihelper.fooexpectFailNotIncrementable(...)expectFailNotDecrementable(...)registerFunction(...)Spr9751.classnew MyBeanResolver(...)expectFail(...)Foo wibble, ...;Foo wibble2, ...;Map<String,Integer> mapStringToInteger, ...;List<> list2, ...;Map<> map2, ...;List<String> foo, ...;this.map2this.wibble2// increment/decrement operators - SPR-9751new Spr9751_2(...)BigDecimal bd, ...;double ddd, ...;float fff, ...;long lll, ...;int iii, ...;short sss, ...;Spr9751_2 foo, ...;int index1, ...;int index2, ...;int index3, ...;// map2 should be null, there is no setter// conversion int>string// SPR-16731// not writable because (1) name is private (2) there is no setter, only a getter// repeated evaluation to drive use of cached executor// not writable// ast// cannot convert String to boolean// use cached QualifiedIdentifier:// Register a custom MethodResolver...// or simply...// context.setMethodResolvers(new ArrayList<MethodResolver>());// Register a custom MethodFilter...// Add a new element to the list// Check reference beyond end of collection// Now turn off growing and reference off the end// BigDecimal// double// float// long// int// short// index1 is 2 at the start - the 'intArray[#root.index1++]' should not be evaluated twice!// intArray[2] is 3// index1 is 3 intArray[3] is 4// index1 is 4, intArray[3] is 3// BooleanLiteral// IntLiteral// LongLiteral// NullLiteral// OpAnd// OpDivide// OpEq// OpMinus// OpModulus// OpMultiply// OpNE// OpOr// OpPlus// RealLiteral// StringLiteral// Ternary// TypeReference// OperatorBetween// OperatorInstanceOf// Elvis// OpInc// OpDec// OperatorNot// OperatorPower// Assign// iii=42// Identifier// CompoundExpression// foo.iii == 99// ConstructorReference// MethodReference// OperatorMatches// Selection// slightly diff here because return value isn't a list, it is a single entity// FunctionReference// VariableReference// Projection// projection would be {false,true,false}// InlineList// InlineMap// BeanReference// PropertyOrFieldReference/** Testcases showing the common scenarios/use-cases for picking up the expression language support. ... *////CLOVER:OFF/** Scenario: using the standard infrastructure and running simple expression evaluation. */ExpressionException ex/** Scenario: using the standard context but adding your own variables */List<Integer> primesString str, ...;int property, ...;/** Scenario: using your own root context object */TestClass tctc.str/** Scenario: using your own java methods and calling them from the expression */ExpressionLanguageScenarioTests.class/** Scenario: add a property resolver that will get called in the resolver chain, this one only supports reading. */new FruitColourAccessor(...)Color.orangeColor.bluenew VegetableColourAccessor(...)Color.green/** Regardless of the current context object, or root context object, this resolver can tell you what colour a fruit is ! ... */new HashMap<String,Color>(...)Color.yellowColor.redMap<String,Color> propertyMap, ...;/** Null means you might be able to read any property, if an earlier property resolver hasn't beaten you to it *//** Regardless of the current context object, or root context object, this resolver can tell you what colour a vegetable is ! ... */// Create a parser// Parse an expression// Evaluate it using a 'standard' context// They are reusable// Use the standard evaluation context// all prime numbers > 10 from the list (using selection ?{...})// read it, set it, read it again// or using assignment within the expression// private property will be accessed through getter()// ... and set through setterimport Inventor/** Tests for the expression state object - some features are not yet exploited in the language (eg nested scopes) ... */ExpressionState state// accessible through the evaluation context// Local variables are in variable scopes which come and go during evaluation.  Normal variables aregetState(...)lookupLocalVariable(...)setLocalVariable(...)Inventor.classTypedValue stateRootMap<String,Object> m// found in upper scope// found in nested scope// although the root object is being set on the evaluation context, the value in the 'state' remains what it was when constructed// assertEquals(null, state.getRootContextObject().getValue());// TypedValue root = ctx.getRootObject();// supplied should override root on context/** Expression evaluation where the TypeConverter plugged in is the ... */TypeDescriptor typeDescriptorForListOfString, ...;List<Integer> listOfInteger, ...;TypeDescriptor typeDescriptorForListOfInteger, ...;ExpressionWithConversionTests.typeDescriptorForListOfStringExpressionWithConversionTests.classExpressionWithConversionTests.typeDescriptorForListOfInteger/** Test the service can convert what we are about to use in the expression evaluation tests. */TypeConvertorUsingConversionService tcsnew TypeConvertorUsingConversionService(...)StandardEvaluationContext evaluationContextTypeDescriptor collectionTypeTestTarget.classint totalnew TestTarget(...)Foo rootCollection<String> foosFoo bazgetFoos(...)baz.value/** Type converter that uses the core conversion service. */ConversionService service, ...;Collection<Foo> foos, ...;this.foos// ArrayList containing List<Integer> to List<String>// ArrayList containing List<String> to List<Integer>// Assign a List<String> to the List<Integer> field - the component elements should be converted// size now 3// element type correctly Integer// The type conversion is possible// ... and it can be done successfully// OK up to here, so the evaluation should be fine...// ... but this fails// method call// method call with result from method call/** These are tests for language features that are not yet considered 'live'. Either missing implementation or ... */// PROJECTIONSpelExpression expr// SELECTION// Constructor invocation// no inline list building at the moment// evaluate("1 between {1, 5}", "true", Boolean.class);// inline list creation not supported at the moment// evaluate("{1,2,3,4,5,6,7,8,9,10}.!{#isEven(#this)}", "[n, y, n, y, n, y, n, y, n, y]", ArrayList.class);// inline map creation not supported at the moment// evaluate("#{'a':'y','b':'n','c':'y'}.![value=='y'?key:null].nonnull().sort()", "[a, c]", ArrayList.class);Object property, ...;Map<String,Map<String,String>> propertynew HashMap<String,Map<String,String>>(...)Map<Integer,Integer> propertythis.parameterizedMapMap<Integer,Integer> parameterizedMap, ...;List<String> propertyList<Integer> propertyList<BigDecimal> decimals, ...;this.decimalsnew ArrayList<BigDecimal>(...)this.parameterizedListList<Integer> parameterizedList, ...;List<List<Integer>> propertythis.parameterizedListOfListList<List<Integer>> parameterizedListOfList, ...;SpelParserConfiguration configurationList<String> property2this.property2List<> property2, ...;String[] propertyList<> listNotGeneric, ...;Map<> mapNotGeneric, ...;List<> listOfScalarNotGeneric, ...;List<> listOfMapsNotGeneric, ...;/** Test usage of inline lists. ... */Class<?> unmodifiableClass, ...;// rather than ArrayList// if the list is full of literals then it will be of the type unmodifiableClassparseAndCheckError(...)checkConstantList(...)SpelExpression expressionSpelNode nodegetAST(...)// list should be unmodifiableimport LiteralExpressionLiteralExpression lExnew Rooty(...)getExpressionString(...)new Consumer<EvaluationException>(...) { ... }/** Tests the evaluation of basic literals: boolean, integer, hex integer, long, real, null, date ... */// ask for the result to be made into an Integer// ask for the result to be made into an Integer knowing that it will not fit// For now, everything becomes a double...// getting the expression type to be what we want - either:// calling byteValue() on Integer.class// relying on registered type converters/** Testing variations on map access. ... */Map<String,String> props1ExpressionParser spelExpressionParserInteger priority, ...;Map<String,String> properties, ...;/** Test usage of inline maps. ... */// rather than HashMap (or similar)checkConstantMap(...)new MapHolder(...)Map<> foo, ...;// TODO this looks like a serious issue (but not a new one): the context object against which arguments are evaluated seems wrong://		evaluate("{a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,j:10}.?[isEven(value) == 'y']", "[2, 4, 6, 8, 10]", ArrayList.class);// expression = (SpelExpression) parser.parseExpression("foo['NEW']");// o = expression.getValue(new MapHolder());// assertEquals("VALUE",o);/** Tests invocation of methods. ... */ExpressionInvocationTargetException.class/** Check on first usage (when the cachedExecutor in MethodReference is null) that the exception is not wrapped. */new Consumer<ExpressionInvocationTargetException>(...) { ... }LocalFilter filternew LocalFilter(...)filter.filterCalledfilter.removeIfNotAnnotatedMethodResolver dummynew DummyMethodResolver(...)List<MethodResolver> copyaddMethodResolver(...)removeMethodResolver(...)BytesService servicenew BytesService(...)byte[] outBytesnew BeanResolver(...) { ... }// Simple filterboolean removeIfNotAnnotated, ...;boolean filterCalled, ...;List<Method> forRemoval// name is ok but madeup() does not exist// Rely on Double>String conversion for calling startsWith()// Test method on inventor: throwException()// In each case it increments the Inventor field 'counter' when invoked// Now the expression has cached that throwException(int) is the right thing to call// Let's change 'bar' to be a PlaceOfBirth which indicates the cached reference is// out of date.// Now let's cause the method to exit via exception and ensure it doesn't cause a retry.// Now cause it to throw an exception:// Filter will be called but not do anything, so first doit() will be invoked// Filter will now remove non @Anno annotated methods// check not called for other types// check de-registration works//clear filter// reflective method accessor is the only one by default// Calling 'public int aVarargsMethod(String... strings)'//evaluate("aVarargsMethod('a','b','c')", 3, Integer.class);//evaluate("aVarargsMethod('a')", 1, Integer.class);// evaluate("aVarargsMethod(new String[]{'a','b','c'})", 3, Integer.class);// Calling 'public int aVarargsMethod2(int i, String... strings)' - returns int+length_of_strings// evaluate("aVarargsMethod2(8,new String[]{'a','b','c'})", 11, Integer.class);/** Test providing operator support ... */setOperatorOverloader(...)new StringAndBooleanAddition(...)// no built in support for this:import Operator/** Tests the evaluation of expressions using relational operators. ... */Operator nodegetOperatorNode(...)findOperator(...)Operator possible// AST:// use as a unary operator// string concatenation/** Tests the messages and exceptions that come out for badly formed expressions ... */// will not fit into an int, needs L suffix// rogue 'G' on the end// missing right operand// T() can only take an identifier (possibly qualified), not a literal// message ought to say identifier rather than ID/** Parse some expressions and check we get the AST we expect. Rather than inspecting each node in the AST, we ask it to ... */// literalsparseCheck(...)// boolean operators// relational operators// }// true// parseCheck("'efg' between {'abc', 'xyz'}", "('efg' between {'abc','xyz'})");// public void testRelOperatorsBetween02() {// }// parseCheck("1 between {1, 5}", "(1 between {1,5})");// public void testRelOperatorsBetween01() {// parseCheck("3 in {1,2,3,4,5}", "(3 in {1,2,3,4,5})");// public void testRelOperatorsIn01() {// parseCheck("{1, 2, 3, 4, 5} instanceof List", "({1,2,3,4,5} instanceof List)");// public void testRelOperatorsIs02() {// false// mathematical operators// true// mixed operators// references// parseCheck("{'a','b','a','d','e'}.distinct()");// public void testCollectionProcessorsDistinct01() {// parseCheck("{'a','b',null,'d',null}.nonNull()");// public void testCollectionProcessorsNonNull01() {// parseCheck("new int[] {3,2,1}.sort()");// public void testCollectionProcessorsSort01() {// parseCheck("new int[] {1,2,3}.average()");// public void testCollectionProcessorsAverage01() {// parseCheck("new int[] {1,2,3}.min()");// public void testCollectionProcessorsMin01() {// parseCheck("new int[] {1,2,3}.max()");// public void testCollectionProcessorsMax01() {// parseCheck("new int[] {1,2,3}.count()");// public void testCollectionProcessorsCount02() {// parseCheck("new String[] {'abc','def','xyz'}.count()");// public void testCollectionProcessorsCount01() {// collection processors// properties// inline list creation// inline map creation// parseCheck("new String[] {'abc','xyz'}", "new String[] {'abc','xyz'}");// public void testArrayConstruction02() {// parseCheck("new int[] {1, 2, 3, 4, 5}", "new int[] {1,2,3,4,5}");// public void testArrayConstruction01() {// array construction// parseCheck("new String[3]");// public void testConstructors02() {// "{1,2,3,4,5,6,7,8,9,10}.${(#isEven(#this) == 'y')}");// parseCheck("{1,2,3,4,5,6,7,8,9,10}.${#isEven(#this) == 'y'}",// public void testSelectionsLast01() {// "{1,2,3,4,5,6,7,8,9,10}.^{(#isEven(#this) == 'y')}");// parseCheck("{1,2,3,4,5,6,7,8,9,10}.^{#isEven(#this) == 'y'}",// public void testSelectionsFirst01() {// "{1,2,3,4,5,6,7,8,9,10}.?{(#isEven(#this) == 'y')}");// parseCheck("{1,2,3,4,5,6,7,8,9,10}.?{#isEven(#this) == 'y'}",// public void testSelections01() {// parseCheck("{1,2,3,4,5,6,7,8,9,10}.!{#isEven()}");// public void testProjections01() {// projections and selections// ternary operator// Type references// } // 120// "(#fact={|n| ($n <= 1) ? 1 : ($n * #fact(($n - 1))) };#fact(5))");// parseCheck("(#fact = {|n| $n <= 1 ? 1 : $n * #fact($n-1) }; #fact(5))",// public void testLambdaFactorial() {// parseCheck("(#max = {|x,y| $x > $y ? $x : $y }; #max(5,25))", "(#max={|x,y| ($x > $y) ? $x : $y };#max(5,25))");// public void testLambdaMax() {// "({1}.#isEven(#this) == 'y') ? 'it is even' : 'it is odd'");// parseCheck("{1}.#isEven(#this) == 'y'?'it is even':'it is odd'",// public void testTernaryOperator01() {/** Parse the supplied expression and then create a string representation of the resultant AST, it should be the same ... *//** Parse the supplied expression and then create a string representation of the resultant AST, it should be the ... */import SimpleEvaluationContextimport RecordPerson/** Unit tests for property access. ... *//** The standard reflection resolver cannot find properties on null objects but some ... */SpelExpression flibbleexprnew StringyPropertyAccessor(...)List<PropertyAccessor> propertyAccessorsStringyPropertyAccessor spaList<PropertyAccessor> copyremovePropertyAccessor(...)setPropertyAccessors(...)new ConfigurablePropertyAccessor(...)forReadOnlyDataBinding(...)RecordPerson target1new RecordPerson(...)RecordPerson target2forReadWriteDataBinding(...)withRootObject(...)withInstanceMethods(...)withTypedRootObject(...)new Inventor(...)// This can resolve the property 'flibbles' on any String (very useful...)int flibbles, ...;Map<String,Object> values, ...;// madeup does not exist as a property// name is ok but foobar does not exist:// Adding a new property accessor just for a particular type// Even though this property accessor is added after the reflection one, it specifically// names the String class as the type it is interested in so is chosen in preference to// any 'default' ones// The reflection one will be used for other properties...// Cannot set it to a string value// message will be: EL1063E:(pos 20): A problem occurred whilst attempting to set the property// 'flibbles': 'Cannot set flibbles to an object of type 'class java.lang.String''// System.out.println(e.getMessage());// reflective property accessor is the only one by default/** Spring Security scenarios from https://wiki.springsource.com/display/SECURITY/Spring+Security+Expression-based+Authorization ... */new Manager(...)PersonAccessor pAccessornew PersonAccessor(...)new SecurityPrincipalAccessor(...)setPerson(...)new Supervisor(...)// Here i'm going to change which hasRole() executes and make it one of my own Java methodsnew MyMethodResolver(...)String n, ...;this.nString[] myRolesgetRoles(...)myRoles.lengthroles.lengthhasAnyRole(...)new Principal(...)Person activePerson, ...;this.activePersonTypeConverter tc, ...;this.tcHasRoleExecutor.classnew HasRoleExecutor(...)// Multiple options for supporting this expression: "p.name == principal.name"// (1) If the right person is the root context object then "name==principal.name" is good enough// (2) Or register an accessor that can understand 'p' and return the right person// Might be better with a as a variable although it would work as a property too...// Variable references using a '#'// referenced as #a in the expression// so non-qualified references 'hasRole()' 'hasIpAddress()' are invoked against it// so non-qualified references 'hasRole()' 'hasIpAddress()' are invoked against it);// NEEDS TO OVERRIDE THE REFLECTION ONE - SHOW REORDERING MECHANISM//		SpelExpression expr = parser.parseExpression("(hasRole('SUPERVISOR') or (#a <  1.042)) and hasIpAddress('10.10.0.0/16')");//			ctx.setRootObject(new Manager("Luke"));//			ctx.setVariable("a",1.043d);//			value = (Boolean)expr.getValue(ctx,Boolean.class);//			assertFalse(value);new ListTestBean(...)new SetTestBean(...)new IterableTestBean(...)new ArrayTestBean(...)Integer[] arraynew MapTestBean(...)Expression expMap<String,String> colorsMapcreateList(...)createIterable(...)Number[] arrayList<Integer> integers, ...;new LinkedHashSet<Integer>(...)Set<Integer> integers, ...;new Iterable<Integer>(...) { ... }...[] ints, ...;...[] integers, ...;Map<String,String> colors, ...;IntegerWrapper wrapper, ...;this.wrappernew IntegerWrapper(...)List<IntegerTestBean> listnew ArrayList<IntegerTestBean>(...)new IntegerTestBean(...)Set<IntegerTestBean> setnew LinkedHashSet<IntegerTestBean>(...)new Iterable<IntegerTestBean>(...) { ... }IntegerTestBean[] arraynew IntegerTestBean[]Number value, ...;// colors.put("black", "schwarz");/** Tests set value expressions. ... */setValueExpectError(...)StandardEvaluationContext lContextExpression e3Expression e4Expression e5Expression e6/* Testing the coercion of both the keys and the values to the correct type */Set<?> ksCollection<?> vs/** Call setValue() but expect it to fail. *//** For use when coercion is happening during a setValue().  The expectedValue should be ... */// PROPERTYORFIELDREFERENCE// Non existent field (or property)://			org.springframework.expression.spel.SpelEvaluationException: EL1008E:(pos 15): Property or field 'wibble' cannot be found on object of type 'org.springframework.expression.spel.testresources.ArrayContainer' - maybe not public?//					at org.springframework.expression.spel.ast.PropertyOrFieldReference.readProperty(PropertyOrFieldReference.java:225)// VARIABLE// the variable does not exist (but that is OK, we should be writable)// INDEXER// non existent indexer (wibble made up)// non existent indexer (index via a string)// none of these sets are possible due to (expected) conversion problems// TODO -- this fails with NPE due to ArrayToObject converter - discuss with Andy//setValueExpectError("arrayContainer.doubles[1]", new ArrayList<String>());//setValueExpectError("arrayContainer.shorts[1]", new ArrayList<String>());//setValueExpectError("arrayContainer.longs[1]", new ArrayList<String>());// TODO currently failing since setValue does a getValue and "Wien" string != PlaceOfBirth - check with andy// Key should be coerced to string representation of 42// All keys should be strings// All values should be booleans// One final test check coercion on the key for a map lookupimport PersonInOtherPackage/** Checks SpelCompiler behavior. This should cover compilation all compiled node types. ... */Expression expression, ...;/* Further TODOs for compilation: ... */assertCanCompile(...)assertGetValueFail(...)assertCantCompile(...)List<String>[] arrayOfListsString resultCObject resultIObject resultCdouble resultIdouble resultCint resultIint resultClong resultIlong resultCboolean resultIboolean resultCfloat resultIfloat resultCTestClass4 tcnew TestClass4(...)Object resultI2tc.atc.bString resultIboolean rootFooObjectHolder fohnew FooObjectHolder(...)foh.foonew FooObject(...)StaticsHelper.classnew Three(...)StringBuilder bufDelegatingStringFormat.classsetEvaluationContext(...)Math.classSomeCompareMethod.classSomeCompareMethod2.classnew SomeCompareMethod2(...)String tvarTestClass7 tc7new TestClass7(...)Double dFloat fTestClass7.propertyMap<String,String> datanew MyContext(...)List<String> lsApple aanew Apple(...)Apple bbaa.gotComparedToPayloadX pnew PayloadX(...)checkCalc(...)new GenericMessageTestHelper<T>(...)Person3 personnew Person3(...)/** Test variants of using T(...) and static/non-static method/property/field references. */String shclassStaticsHelper.sh(...).param1SpelExpression exPersonInOtherPackage person2new PersonInOtherPackage(...)String testclass8TestClass8 tc8String testclass9tc8.itc8.stc8.dtc8.zTestClass10 tcnew TestClass10(...)tc.sTestClass5 tcnew TestClass5(...)tc.iTestClass5._iTestClass5._sint[] istc.fieldtc.objchar resultIchar resultCPayload payloadnew Payload(...)getAst(...)TestClass6 tcnew TestClass6(...)getOne(...)String[] sssNumber[] nsnew Number[]double[] dslong[] lsshort[] ssfloat[] fsbyte[] bschar[] csList<Integer> intsMap<String,Integer> map1List<String[]> listOfStringArraysList<Integer[]> listOfIntegerArraysnew ArrayList<Integer[]>(...)List<String>[] stringArrayOfListsnew ArrayList<>[]String[][] referenceTypeArrayOfArraysint[][] primitiveTypeArrayOfArraysList<List<String>> listOfListOfStringsMap<String,List<String>> mapToListsMap<String,int[]> mapToIntArraynew HashMap<String,int[]>(...)Map<String,String>[] mapArraynew Map<>[]stringify(...)new CompilableMapAccessor(...)Object vnew FooString(...)SpelExpression sExprTernary ternaryOpLT opltCompoundExpression cExprString cExprExitDescriptorObject vc...[...].three.four...[...].threepayload.DRPayload2Holder holdernew Payload2Holder(...)new MyAccessor(...)new GenericMessageTestHelper<Integer>(...)new GenericMessageTestHelper<Long>(...)new GenericMessageTestHelper<Float>(...)new GenericMessageTestHelper<Double>(...)// The new helper class here uses an upper bound on the genericnew GenericMessageTestHelper2<Integer>(...)// The other numeric operatorsnew GenericMessageTestHelper2<T>(...)SpelParserConfiguration spcMyMessage rootnew MyMessage(...)assertIsCompiled(...)RecordHolder rhnew RecordHolder(...)rh.expression.someLongrh.expressionnew Reg(...)verifyCompilationAndBehaviourWithNull(...)verifyCompilationAndBehaviourWithNull2(...)Reg rSpelExpression fastSpelExpression slowsetValue2(...)boolean slowResultboolean fastResultSpelExpression.classSet<Object> classloadersUsedCompiledExpression cEx// Helper methodsSpelExpression spelExpressionSpelNode astList<?> lsObject lObject[] os// Nested typesMessageHeaders mhnew MessageHeaders(...)// This test helper has a bound on the type variablePayload2.classPayload2 payload2String memberDeclaringClassSlashedDescriptorFooObject foo, ...;new Two[]new Two(...)...[] DR, ...;Two holder, ...;String var1, ...;String var2, ...;new Payload2(...)Payload2 payload2, ...;Three three, ...;double four, ...;int valueI, ...;Integer valueIB, ...;Integer valueIB58, ...;Integer valueIB60, ...;long valueJ, ...;Long valueJB, ...;Long valueJB58, ...;Long valueJB60, ...;double valueD, ...;Double valueDB, ...;Double valueDB58, ...;Double valueDB60, ...;float valueF, ...;Float valueFB, ...;Float valueFB58, ...;Float valueFB60, ...;byte valueB, ...;byte valueB18, ...;byte valueB20, ...;Byte valueBB, ...;Byte valueBB18, ...;Byte valueBB20, ...;char valueC, ...;Character valueCB, ...;short valueS, ...;short valueS18, ...;short valueS20, ...;Short valueSB, ...;Short valueSB18, ...;Short valueSB20, ...;PayloadX payload, ...;String word, ...;boolean a, ...;String s, ...;String vargObject vargint _i, ...;String _s, ...;short s1, ...;short s2, ...;short s3, ...;long l1, ...;long l2, ...;long l3, ...;float f1, ...;float f2, ...;float f3, ...;char c1, ...;char c2, ...;char c3, ...;byte b1, ...;byte b2, ...;byte b3, ...;// public void seven(Number n) { s = n.toString(); }this.sint vargdouble vfloat vlong vByte vchar vString[] vargString vint[] vargint vString orange, ...;String apple, ...;long peach, ...;double d, ...;boolean z, ...;this.dthis.zString param1, ...;this.param1String output, ...;StringBuilder bString paramint param// final class HttpServlet3RequestFactory implements HttpServletRequestFactory// These test classes simulate a pattern of public/private classes seen in Spring SecurityHttpServlet3RequestFactory outernew HttpServlet3RequestFactory(...)new Servlet3SecurityContextHolderAwareRequestWrapper(...)// private class Servlet3SecurityContextHolderAwareRequestWrapper extends SecurityContextHolderAwareRequestWrapper// public class SecurityContextHolderAwareRequestWrapper extends HttpServletRequestWrapper// Here the declaring class is not public// method not public// publicdouble ifloat inew StaticsHelper(...)StaticsHelper sh, ...;StaticsHelper fielda, ...;String fieldb, ...;Object gotComparedTo, ...;this.gotComparedTothat.i// For opNe_SPR14863Map<String,String> data, ...;new HashMap<String,Long>(...)new LongHolder(...)Map<String,Long> record, ...;LongHolder expression, ...;Long someLong, ...;Integer _value, ...;Long _valueL, ...;Double _valueD, ...;Float _valueF, ...;this._valuethis._valueLthis._valueDthis._valueF// root still null// primitive left operand - should get boxed, return true// primitive left operand - should get boxed, return false// double slot left operand - should get boxed, return false// double slot left operand - should get boxed, return true// Only when the right hand operand is a direct type reference// will it be compilable.// use of primitive as type for instanceof check - compilable// but always false// Code gen is different for -1 .. 6 because there are bytecode instructions specifically for those values// Not an int literal but an opminus with one operand:// expression = parser.parseExpression("-1");// assertCanCompile(expression);// assertEquals(-1, expression.getValue());// Can't compile this as we aren't going down the getfalse() branch in our evaluation// Haven't yet been into second branch// Now been down both// Can't compile this as we aren't going down the gettrue() branch in our evaluation// All literals so we can do this straight away// Have not gone down false branch// First non compiled:// Now revert state of foh and try compiling it:// Static references// Single size primitive (boolean)// Double slot primitives// Static method references// Nullsafe guard on expression element evaluating to primitive/null// Here the target method takes Object... and we are passing a string// Confirms visibility of what is being called.// type nor method are public// type not public but method is// Selection isn't compilable.// This is a methodreference invocation, to compare with functionreference// TODO fails due to conversionservice handling of String[] to Object...//	expression = parser.parseExpression("#append2(#stringArray)");//	assertEquals("xyz", expression.getValue(context).toString());//	assertTrue(((SpelNodeImpl)((SpelExpression) expression).getAST()).isCompilable());//	assertCanCompile(expression);// Differing types of number, not yet supported// number types are not the same// not compatible number types// Exercise the comparator invocation code that runs in// equalityCheck() (called from interpreted and compiled code)// Verify what the expression caused aa to be compared to// Similar test with compiled expression// This is what you had to do before the changes in order for it to compile://	expression = parse("(T(java.lang.Double).parseDouble(payload.valueI.toString()))/60D");// right is a double// right is a float// right is a long// right is an int// right is a short// right is a byte// Method with string return// Three strings, optimal bytecode would only use one StringBuilder// This will trigger compilation (second usage)// Static field access on a T() referenced type// The actual expression from the bug report. It fails if the ENGLISH reference fails// to pop the type reference for Locale off the stack (if it isn't popped then// toLowerCase() will be called with a Locale parameter). In this situation the// code generation for ENGLISH should notice there is something on the stack that// is not required and pop it off.// Property access on a class object// Now the type reference isn't on the stack, and needs loading// These tests below verify that the chain of static accesses (either method/property or field)// leave the right thing on top of the stack for processing by any outer consuming code.// Here the consuming code is the String.valueOf() function.  If the wrong thing were on// the stack (for example if the compiled code for static methods wasn't popping the// previous thing off the stack) the valueOf() would operate on the wrong value.// Basic chain: property access then method access// chain of statics ending with static method// chain of statics ending with static field// chain of statics ending with static property access// variety chain// Need boxing code on the 1 so that toString() can be called// Variant of above more like what was in the bug report:// simple ctor// multi arg ctor that includes primitives// no-arg ctor// pass primitive to reference type ctor// private class, can't compile it// Should call the non varargs version of concat// (which causes the '::' prefix in test output)// This will call the varargs concat with an empty array// varargs string// TODO Fails related to conversion service converting a String[] to satisfy Object...//		expression = parser.parseExpression("sixteen(stringArray)");//		assertCantCompile(expression);//		expression.getValue(tc);//		assertEquals("aaabbbccc", tc.s);//		assertCanCompile(expression);//		tc.reset();// varargs int// one string then varargs string// nothing passed to varargs parameter// nested arrays// nested primitive array// varargs boolean// varargs short// varargs double// varargs long// varargs char// varargs byte// varargs float// non-static method, no args, void return// static method, no args, void return// non-static method, reference type return// non-static method, primitive type return// static method, reference type return// static method, primitive type return// non-static method, one parameter of reference type// static method, one parameter of reference type// non-static method, one parameter of primitive type// static method, one parameter of primitive type// method that gets type converted parameters// Converting from an int to a string// Uncompilable as argument conversion is occurring// Converting from an int to a Number// The generated code should include boxing of the int to a Number// Passing a subtype// method takes a string and we are passing an Integer// changing target// from primitive array to reference type array// method with changing parameter types (change reference type)// method with changing target// non static field// static field// non static getter// static getter// record-style accessor// Without a fix compilation was inserting a checkcast to a private type// Access String (reference type) array// Access int array// Access double array// Access long array// Access short array// Access float array// Access byte array// Access char array// Collections// Maps// Object// getter// list of arrays// array of lists// array of arrays// list of lists of reference types// Map of lists// Map to array// Map array// This next call was failing because the isCompilable check in Indexer// did not check on the key being compilable (and also generateCode in the// Indexer was missing the optimization that it didn't need necessarily// need to call generateCode for that accessor)// What about a map key that is an expression - ensure the getKey() is evaluated in the right scope// When the condition is a primitive// When the condition is a double slot primitive// When the condition is an empty string// null condition// variable access returning primitive// variable access returning array// having a value in value2 fields will enable compilation to succeed, then can switch it to null// try the numbers 0,1,2,null// Verifying that after a number of compilations, the classloaders// used to load the compiled expressions are discarded/replaced.// See SpelCompiler.loadClass()// 1500 is greater than SpelCompiler.CLASSES_DEFINED_LIMIT// target is a Payload2 instance/** Checks the speed of compiled SpEL expressions. ... */int iterations, ...;// number of evaluations that are timed in one runboolean noisyTests, ...;// number of times to repeat 'count' evaluations (for averaging)/** This test verifies the new support for compiling mathematical expressions with ... */NumberHolder nhnew NumberHolder(...)long stimeGreeter glong iTotallong cTotalboolean bclong etimelong interpretedSpeedlogln(...)long compiledSpeedreportPerformance(...)...[...].DRFixedSection.duration...[...].DRFixedSectionlong interpretedTotallong compiledTotalString interpretedResultString compiledResultHW testdatanew HW(...)TestClass2 testdatanew TestClass2(...)double averageInterpreteddouble averageCompileddouble ratiomessage.lengthThree DRFixedSection, ...;double duration, ...;int payload, ...;Bar b, ...;String boo, ...;// warmup// Verify the result// Verify the same result for compiled vs interpreted// Verify if the input changes, the result changes/** Test the examples specified in the documentation. ... */GregorianCalendar csetPlaceOfBirth(...)setInventions(...)Inventor tesla, ...;Inventor pupin, ...;new Inventor[]new ArrayList<Map<String,Object>>(...)...[] Members, ...;List<> Members2, ...;Map<String,Object> officers, ...;List<Map<String,Object>> reverse, ...;List<> linvInventor teslaboolean isEqual// Section 7.4.1// Section 7.5double avogadrosNumberint maxValueObject nullValueString cityStandardEvaluationContext teslaContextString inventionStandardEvaluationContext societyContextIEEE ieeenew IEEE(...)ieee.MembersInventor pupinInventor iInventor i2// 7.5.3String cboolean isMember// 7.5.4.1boolean falseValue// 7.5.4.2// 7.5.4.3int twoString testStringint fourint sixdouble twentyFourint minusTwoint oneIntint minusTwentyOne// 7.5.5Inventor inventorStandardEvaluationContext inventorContextString aleks// 7.5.6Class<?> dateClass// 7.5.7Inventor einstein// 7.5.8List<Integer> primesGreaterThanTen// 7.5.9String helloWorldReversedStringUtils.class// 7.5.10String queryResultString// 7.5.11List<Inventor> list// 7.5.12String randomPhrasenew TemplatedParserContext(...)StringBuilder backwards//  The constructor arguments are name, birthday, and nationaltiy.// evaluates to true// evals to "Hello World"// evals to 2147483647// 1856// Inventions Array//		teslaContext.setRootObject(tesla);// evaluates to "Induction motor"// Members List// evaluates to "Nikola Tesla"// List and Array navigation// evaluates to "Wireless communication"// Officer's Dictionary// evaluates to "Idvor"// setting values// string literal, evaluates to "bc"// evaluates to false//evaluates to false// -- AND --// -- OR --// -- NOT --// -- AND and NOT --// Addition// 'test string'// Subtraction// 4// -9000// Multiplication// 24.0// Division// -2// 1.0// Modulus// 3// Operator precedence// -21// alternatively//create new inventor instance within add method of List// create an array of integers// create parser and set variable 'primes' as the array of integers// queryResultString = "Nikola Tesla is a member of the IEEE Society"/** SpelEvaluationException tests (SPR-16544). ... */Expression spelExpressionsetVariables(...)new HashMap<String,Integer>(...) { ... }new ArrayList<String>(...) { ... }import ExpressionExceptionimport Reserver/** Reproduction tests cornering various reported SpEL issues. ... */new Spr5899Class(...)new MyTypeLocator(...)new TestProperties(...)ParserContext hashesTemplateExpressionParsingTests.HASH_DELIMITED_PARSER_CONTEXTParserContext dollarsTemplateExpressionParsingTests.DEFAULT_TEMPLATE_PARSER_CONTEXTcheckTemplateParsing(...)checkTemplateParsingError(...)/** Should be accessing Goo.getKey because 'bar' field evaluates to "key" */new Goo(...)/** Should be accessing Goo.getKey because 'bar' variable evaluates to "key" *//** $ related identifiers */Holder hnew Holder(...)h.map/** Should be accessing Goo.wibble field because 'bar' variable evaluates to "wibble" *//** Should be accessing (setting) Goo.wibble field because 'bar' variable evaluates to ... */Goo gGoo.instanceg.wibble/** Should be accessing Goo.setKey field because 'bar' variable evaluates to "key" */g.valuenew XX(...)new Consumer<Exception>(...) { ... }ParserContext DOLLARSQUARE_TEMPLATE_PARSER_CONTEXT, ...;SpelParseException speMap<String,String> nameMapString el1String el2SpelExpression expList<?> valueTypeDescriptor evaluatedObject[] valueList<D> listnew ArrayList<D>(...)SpelExpression exp2String el3SpelExpression exp3Object value3new D(...)/** Test whether {@link ReflectiveMethodResolver} follows Java Method Invocation ... */Integer INTEGEREvaluationContext emptyEvalContextList<TypeDescriptor> argsConversionPriority1 targetnew ConversionPriority1(...)MethodExecutor meint compilerConversionPriority2 target2new ConversionPriority2(...)MethodExecutor me2int actual2int compiler2/** Test whether {@link ReflectiveMethodResolver} handles Widening Primitive Conversion. That's passing an 'int' to a ... */Integer INTEGER_VALUEWideningPrimitiveConversion targetnew WideningPrimitiveConversion(...)VarargsReceiver receivernew VarargsReceiver(...)VarargsInterface proxyVarargsInterface.classSpelExpressionParser expressionParserReflectionUtil<Integer> runew ReflectionUtil<Integer>(...)new Reserver(...)String ex// "DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"String NE, ...;String ne, ...;int DIV, ...;int div, ...;Map<String,String> m, ...;Reserver.CONST/** We add property accessors in the order: ... */ExpressionParser expressionParsernew ContextObject(...)new TestPropertyAccessor(...)/** Test the ability to subclass the ReflectiveMethodResolver and change how it ... */new ReflectiveMethodResolver(...) { ... }Number expectedResultSPR9486_FunctionsClass testObjectnew SPR9486_FunctionsClass(...)Number resultNumber expectedNumberBoolean expectedResultBoolean expectedNumberReflectivePropertyAccessor accessorGenericImplementation targetnew GenericImplementation(...)new OnlyBridgeMethod(...)new BooleanHolder(...)doTestSpr10146(...)String fromInterfaceStaticFinalImpl1.classString fromClassStaticFinalImpl2.classExpression parseExpressionExpression spelABC.AABC.BABC.CXYZ.classXYZ.XXYZ.YXYZ.Znew MethodResolver(...) { ... }new MethodExecutor(...) { ... }Spr10486 rootObjectnew Spr10486(...)Expression classNameExpressionExpression nameExpressionSpr10486.classSpr11142 rootObjectnew Spr11142(...)TestClass2 oneTestClass2 twoMap<String,TestClass2> mapnew HashMap<String,TestClass2>(...)ArrayList<> listunmodifiableCollection(...)new Spr11445Class(...)Item itemnew Item(...)Item item1Item item2new UnnamedUser(...)UnnamedUser.classnew NamedUser(...)NamedUser.classList<Map<String,Object>> myPayloadMap<String,Object> v1Map<String,Object> v2List<> resExpression expression1Expression expression2new BeanClass(...)new ListOf(...)List<> list1List<> list3Map<> map1Spr5899Class.classOuter.classProperties jdbcProperties, ...;Properties foo, ...;String floo, ...;List<String> ls, ...;...[] as, ...;Map<String,String> ms, ...;String a, ...;new Resource(...)new ResourceSummary(...)ResourceSummary resource, ...;String payload, ...;Goo instance, ...;String wibble, ...;Map<String,String> map, ...;String mapName, ...;this.mapNameContextObject.classMap<String,String> firstContext, ...;Map<String,String> secondContext, ...;Map<String,String> thirdContext, ...;Map<String,String> fourthContext, ...;double value, ...;List<ListOf> list, ...;new ABC(...)ABC A, ...;ABC B, ...;ABC C, ...;new XYZ(...)XYZ X, ...;XYZ Y, ...;XYZ Z, ...;Boolean simpleProperty, ...;boolean primitiveProperty, ...;this.simplePropertythis.primitiveProperty// SPR-9194(...).stringAtomicInteger counter, ...;int X, ...;new ArrayList<Item>(...)List<Item> children, ...;// varargs// varargs 2 - null is packed into the varargs// check we can find the ctor ok// ctor varargs// ctor varargs 2// root is a map instance// MapAccessor required for this to work// --- dotted property names// lookup foo on the root, then bar on that, then use that as the key into// jdbcProperties// key is foo.bar// will be using the cached accessor this time// will access the field 'wibble' and not use a getter// no resolver registered == exception// bean exists// bean does not exist// bean name will cause AccessException// Different parts of elvis expression are null// Different parts of ternary expression are null// Assignment// Have empty string treated as null for elvis// value is list containing [true,false]// value is array containing [true,false]// trim out the nulls first// MethodInvoker chooses getX(int i) when passing Integer// Compiler chooses getX(Number i) when passing Integer// Fails!// trickier:// #this should be the element from list1// toString() should be called on the element from list1/** Utilities for working with Spring Expressions. ... *//** Output an indented representation of the expression syntax tree to the specified output stream. ... */printAST(...)/* Helper method for printing the AST with indentation */StandardTypeLocator locatorList<String> prefixesgetImportPrefixes(...)// currently does not know about java.util by default//		assertEquals(java.util.List.class,locator.findType("List"));import CompositeStringExpressionimport TemplateParserContextParserContext DEFAULT_TEMPLATE_PARSER_CONTEXT, ...;ParserContext HASH_DELIMITED_PARSER_CONTEXT, ...;CompositeStringExpression cseExpression[] exprsgetExpressions(...)CompositeStringExpression.classexprs.lengthnew Consumer<ParseException>(...) { ... }TemplateParserContext tpcnew TemplateParserContext(...)ParserContext pcParserContext.TEMPLATE_EXPRESSION// treat the nested ${..} as a part of the expression// not a useful expression but tests nested expression syntax that clashes with template prefix/suffix// Just wanting to use the prefix or suffix within the template:/** Builds an evaluation context for test expressions. ... */StandardEvaluationContext testContextsetupRootContextObject(...)populateVariables(...)populateFunctions(...)/** Register some Java reflect methods as well known functions that can be called from an expression. ... */TestScenarioCreator.class/** Register some variables that can be referenced from the tests ... *//** Create the root context object, an Inventor instance. Non-qualified property ... */// in test expressions// These methods are registered in the test context and therefore accessible through function calls/** Tests the evaluation of expressions that access variables and functions (lambda/java). ... */// this method is used by the test above// requires type conversion of '1' to 1// requires type conversion of 37 to '37'import Time/** Unit tests for SpEL's plus operator. ... */StringLiteral strOpPlus oRealLiteral realLiteralIntLiteral intLiteralLongLiteral longLiteralRealLiteral n1RealLiteral n2LongLiteral n1LongLiteral n2IntLiteral n1IntLiteral n2StringLiteral n1StringLiteral n2Time timenew Time(...)VariableReference varStandardEvaluationContext evaluationContextConverterTime.classnew Converter<Time,String>(...) { ... }import Bimport CCustomMap mapimport SpelCompilationCoverageTests/** Tests for the {@link SpelCompiler}. ... */OrderedComponent componentnew OrderedComponent(...)rangeClosed(...)String someField, ...;// some fields// some getters and settersisAdmin(...)hasSomeProperty(...)// gh-24357// Evaluate the expression multiple times to ensure that it gets compiled.// gh-25706parseExceptionRequirements(...)SpelNode rootAstOpOr operatorOrOpAnd operatorAndSpelNode rightOrOperandToken tokentoken.kindtoken.endPosExpressionException exprExnew ExpressionException(...)checkNumber(...)checkNumberError(...)Object exprVal// check position for final 'false'// check position for first 'true'// check position for second 'true'// check position for OperatorAnd// check position for OperatorOrimport AbstractExpressionTestsimport SpelUtilitiesimport ArgumentsMatchKind/** Tests for reflection helper code. ... */PrintStream psTypedValue tv1TypedValue tv2TypedValue tv3StandardTypeConverter tccheckMatch(...)ReflectionHelper.ArgumentsMatchKind.EXACTReflectionHelper.ArgumentsMatchKindSub.classSuper.classStandardTypeConverter typeConvertercheckMatch2(...)Unconvertable.classMethod oneArgMethod twoArgcheckArguments(...)Object firstParamObject[] firstParamArrayfirstParamArray.lengthReflectivePropertyAccessor rpaTester tReflectivePropertyAccessor reflectiveTester testerPropertyAccessor propertyPropertyAccessor field/** Used to validate the match returned from a compareArguments call. */getTypeDescriptors(...)checkArgument(...)List<TypeDescriptor> typeDescriptorsint field, ...;int field2, ...;int field3, ...;String property2, ...;String property3, ...;boolean property4, ...;String iD, ...;String pEBS, ...;String xY, ...;String xyZ, ...;this.pEBS//		===> Expression '3+4+5+6+7-2' - AST start//		OperatorMinus  value:(((((3 + 4) + 5) + 6) + 7) - 2)  #children:2//		  OperatorPlus  value:((((3 + 4) + 5) + 6) + 7)  #children:2//		    OperatorPlus  value:(((3 + 4) + 5) + 6)  #children:2//		      OperatorPlus  value:((3 + 4) + 5)  #children:2//		        OperatorPlus  value:(3 + 4)  #children:2//		          CompoundExpression  value:3//		            IntLiteral  value:3//		          CompoundExpression  value:4//		            IntLiteral  value:4//		        CompoundExpression  value:5//		          IntLiteral  value:5//		      CompoundExpression  value:6//		        IntLiteral  value:6//		    CompoundExpression  value:7//		      IntLiteral  value:7//		  CompoundExpression  value:2//		    IntLiteral  value:2//		===> Expression '3+4+5+6+7-2' - AST end// Calling foo(String) with (String) is exact match// Calling foo(String,Integer) with (String,Integer) is exact match// Calling foo(List) with (ArrayList) is close match (no conversion required)// Passing (Sub,String) on call to foo(Super,String) is close match// Passing (String,Sub) on call to foo(String,Super) is close match// Calling foo(String,int) with (String,Integer) requires boxing conversion of argument one// Passing (int,String) on call to foo(Integer,String) requires boxing conversion of argument zero// Passing (int,Sub) on call to foo(Integer,Super) requires boxing conversion of argument zero// Passing (int,Sub,boolean) on call to foo(Integer,Super,Boolean) requires boxing conversion of arguments zero and two// TODO checkMatch(new Class<?>[] {Integer.TYPE, Sub.class, Boolean.TYPE}, new Class<?>[] {Integer.class, Super.class, Boolean.class}, tc, ArgsMatchKind.REQUIRES_CONVERSION);// Passing (Super,String) on call to foo(Sub,String) is not a match// Passing (String[]) on call to (String[]) is exact match// Passing (Integer, String[]) on call to (Integer, String[]) is exact match// Passing (String, Integer, String[]) on call to (String, String, String[]) is exact match// Passing (Sub, String[]) on call to (Super, String[]) is exact match// Passing (Integer, String[]) on call to (String, String[]) is exact match// Passing (Integer, Sub, String[]) on call to (String, Super, String[]) is exact match// Passing (String) on call to (String[]) is exact match// Passing (Integer,String) on call to (Integer,String[]) is exact match// Passing (String) on call to (Integer[]) is conversion match (String to Integer)// Passing (Sub) on call to (Super[]) is close match// Passing (Super) on call to (Sub[]) is not a match// what happens on (Integer,String) passed to (Integer[]) ?// basic conversion int>String// varargs but nothing to convert// varargs with nothing needing conversion// varargs with conversion required// Simple conversion: int to string// varargs conversion// varargs conversion but no varargs// null value// cached accessor used// Attempted write as first activity on this field and property to drive testing// of populating type descriptor cache// Attempted read as first activity on this field and property (no canRead before them)// Access through is method// repro SPR-9123, ReflectivePropertyAccessor JavaBean property names compliance tests// note: "Id" is not a valid JavaBean name, nevertheless it is treated as "id"// repro SPR-10994// SPR-10122, ReflectivePropertyAccessor JavaBean property names compliance tests - settersTypeComparator tcTypeLocator tlsetTypeComparator(...)OperatorOverloader ooStandardTypeLocator tlremoveImport(...)TypeConverter tc/* Copyright 2014-2018 the original author or authors. ... *//** Hold the various kinds of primitive array for access through the test evaluation context. ... */...[] longs, ...;...[] doubles, ...;...[] chars, ...;...[] shorts, ...;...[] booleans, ...;...[] floats, ...;// setup some valuesString address, ...;Color color, ...;// accessible as property fieldString colorName, ...;// accessible as property through getter/setterint stringscount, ...;this.colorthis.colorNamenew ArrayList<PlaceOfBirth>(...)new LinkedHashMap<String,Boolean>(...)new LinkedHashMap<Integer,String>(...)String _name, ...;String _name_, ...;String publicName, ...;PlaceOfBirth placeOfBirth, ...;Date birthdate, ...;int sinNumber, ...;String nationality, ...;...[] inventions, ...;String randomField, ...;Map<String,String> testMap, ...;boolean wonNobelPrize, ...;...[] placesLived, ...;List<PlaceOfBirth> placesLivedList, ...;ArrayContainer arrayContainer, ...;boolean publicBoolean, ...;boolean accessedThroughGetSet, ...;List<Boolean> booleanList, ...;Map<String,Boolean> mapOfStringToBoolean, ...;Map<Integer,String> mapOfNumbersUpToTen, ...;List<Integer> listOfNumbersUpToTen, ...;List<Integer> listOneFive, ...;...[] stringArrayOfThreeItems, ...;this._namethis._name_this.birthdatethis.nationalitythis.arrayContainernew ArrayContainer(...)this.placesLivednew PlaceOfBirth[]this.placesLivedListthis.inventionsgetCity(...)this.wonNobelPrizethis.accessedThroughGetSetString privateName, ...;Company company, ...;this.privateNameString Country, ...;/** Keith now has a converter that supports String to X, if X has a ctor that takes a String. ... */PlaceOfBirth oPOBoPOB.cityList<String> crossStreets, ...;this.crossStreetsTestAddress address, ...;/** For use when testing that the SpEL expression parser can accommodate SpEL's own ... */String CONST, ...;/** Java agent that saves the {@link Instrumentation} interface from the JVM ... *//** Save the {@link Instrumentation} interface exposed by the JVM. *//** Save the {@link Instrumentation} interface exposed by the JVM. ... *//** Return the {@link Instrumentation} interface exposed by the JVM. ... *//** A simple logging interface abstracting logging APIs.  In order to be ... *//** Is fatal logging currently enabled? ... *//** Is error logging currently enabled? ... *//** Is warn logging currently enabled? ... *//** Is info logging currently enabled? ... *//** Is debug logging currently enabled? ... *//** Is trace logging currently enabled? ... *//** Logs a message with fatal log level. ... *//** Logs an error with fatal log level. ... *//** Logs a message with error log level. ... *//** Logs an error with error log level. ... *//** Logs a message with warn log level. ... *//** Logs an error with warn log level. ... *//** Logs a message with info log level. ... *//** Logs an error with info log level. ... *//** Logs a message with debug log level. ... *//** Logs an error with debug log level. ... *//** Logs a message with trace log level. ... *//** Logs an error with trace log level. ... *//* Licensed to the Apache Software Foundation (ASF) under one or more ... */import LogRecordimport Levelimport ExtendedLoggerimport LoggerContextimport Loggerimport LoggerFactoryimport LocationAwareLogger/** Spring's common JCL adapter behind {@link LogFactory} and {@link LogFactoryService}. ... */LogApi.SLF4J_LALLogApi.LOG4JLogApi.SLF4JLogApi.JULString LOG4J_SPI, ...;String LOG4J_SLF4J_PROVIDER, ...;String SLF4J_SPI, ...;String SLF4J_API, ...;LogApi logApi, ...;/** Create an actual {@link Log} instance for the selected API. ... */createLog(...)createLocationAwareLog(...)LogAdapter.classnew LogApi(...)LogApi LOG4J, ...;LogApi SLF4J_LAL, ...;LogApi SLF4J, ...;LogApi JUL, ...;new Log4jLog(...)Logger loggernew Slf4jLocationAwareLog(...)new Slf4jLog<Logger>(...)new JavaUtilLog(...)Log4jLog.classString FQCN, ...;LoggerContext loggerContext, ...;ExtendedLogger logger, ...;LoggerContext contextLevel.FATALLevel.ERRORLevel.WARNLevel.INFOLevel.DEBUGLevel.TRACElogIfEnabled(...)T logger, ...;Slf4jLocationAwareLog.classLocationAwareLogger.ERROR_INTLocationAwareLogger.WARN_INTLocationAwareLogger.INFO_INTLocationAwareLogger.DEBUG_INTLocationAwareLogger.TRACE_INTLogger logger, ...;isLoggable(...)Level.SEVERELevel.WARNINGLevel.FINELevel.FINESTLogRecord recnew LocationResolvingLogRecord(...)setLoggerName(...)setResourceBundleName(...)getResourceBundleName(...)setResourceBundle(...)setThrown(...)JavaUtilLog.classboolean resolved, ...;getSourceClassName(...)setSourceClassName(...)getSourceMethodName(...)setSourceMethodName(...)StackTraceElement[] stackString sourceClassNameString sourceMethodNameLogRecord serializednew LogRecord(...)getLevel(...)getLoggerName(...)setSequenceNumber(...)getSequenceNumber(...)setParameters(...)setThreadID(...)getThreadID(...)setMillis(...)getThrown(...)// log4j-to-slf4j bridge -> we'll rather go with the SLF4J SPI;// however, we still prefer Log4j over the plain SLF4J API since// the latter does not have location awareness support.// Use Log4j 2.x directly, including location awareness support// Full SLF4J SPI including location awareness support// Minimal SLF4J API without location awareness support// java.util.logging as default// Defensively use lazy-initializing adapter class here as well since the// java.logging module is not present by default on JDK 9. We are requiring// its presence if neither Log4j nor SLF4J is available; however, in the// case of Log4j or SLF4J, we are trying to prevent early initialization// of the JavaUtilLog adapter - e.g. by a JVM in debug mode - when eagerly// trying to parse the bytecode for all the cases of this switch clause.// Circular call in early-init scenario -> static field not initialized yet// Explicitly pass a String argument, avoiding Log4j's argument expansion// for message objects in case of "{}" sequences (SPR-16226)// setMillis is deprecated in JDK 9/** A minimal incarnation of Apache Commons Logging's {@code LogFactory} API, ... *//** Convenience method to return a named logger. ... *//** This method only exists for compatibility with unusual Commons Logging API ... */new LogFactory(...) { ... }/** A minimal subclass of the standard Apache Commons Logging's {@code LogFactory} class, ... */// Just in case some code happens to call uncommon Commons Logging methods.../** Trivial implementation of {@link Log} that throws away all messages. ... *//** Originally a simple Commons Logging provider configured by system properties. ... */SimpleLog.classimport InvalidDataAccessResourceUsageException/** Exception thrown when SQL specified is invalid. Such exceptions always have ... */String sql, ...;/** Constructor for BadSqlGrammarException. ... */this.sql/** Return the wrapped SQLException. *//** Return the SQL that caused the problem. */import DataAccessResourceFailureException/** Fatal exception thrown when we can't connect to an RDBMS using JDBC. ... *//** Constructor for CannotGetJdbcConnectionException. ... */import DataRetrievalFailureException/** Data access exception thrown when a result set did not have the correct column count, ... */int expectedCount, ...;int actualCount, ...;/** Constructor for IncorrectResultSetColumnCountException. ... */this.expectedCountthis.actualCount/** Constructor for IncorrectResultCountDataAccessException. ... *//** Return the expected column count. *//** Return the actual column count. *//** Exception thrown when a ResultSet has been accessed in an invalid fashion. ... *//** Constructor for InvalidResultSetAccessException. ... *//** Return the SQL that caused the problem. ... */import IncorrectUpdateSemanticsDataAccessException/** Exception thrown when a JDBC update affects an unexpected number of rows. ... */int expected, ...;/** Number of rows that should have been affected. */int actual, ...;/** Number of rows that actually were affected. *//** Constructor for JdbcUpdateAffectedIncorrectNumberOfRowsException. ... */this.expected/** Return the number of rows that should have been affected. *//** Return the number of rows that have actually been affected. */getActualRowsAffected(...)/** Exception to be thrown when a LOB could not be retrieved. ... *//** Constructor for LobRetrievalFailureException. ... */import SQLWarningimport UncategorizedDataAccessException/** Exception thrown when we're not ignoring {@link java.sql.SQLWarning SQLWarnings}. ... *//** Constructor for SQLWarningException. ... *//** Return the underlying SQLWarning. *//** Exception thrown when we can't classify an SQLException into ... *//** SQL that led to the problem. *//** Constructor for UncategorizedSQLException. ... */getSQLState(...)/** Return the underlying SQLException. *//** Return the SQL that led to the problem (if known). */import CompositeDatabasePopulatorimport ResourceDatabasePopulator/** Internal utility methods used with JDBC configuration. ... */List<Element> scriptscreateDatabasePopulator(...)CompositeDatabasePopulator.classboolean ignoreFailedDropsboolean continueOnErrorManagedList<BeanMetadataElement> delegatesnew ManagedList<BeanMetadataElement>(...)Element scriptElementString executionAttrBeanDefinitionBuilder delegateResourceDatabasePopulator.classBeanDefinitionBuilder resourcesFactorySortedResourcesFactoryBean.classString separatorgetSeparator(...)String scriptSeparatorString elementSeparator// Use a factory bean for the resources so they can be given an order if a pattern is usedimport EmbeddedDatabaseFactoryBean/** {@link org.springframework.beans.factory.xml.BeanDefinitionParser} that ... */String DB_NAME_ATTRIBUTE, ...;/** Constant for the "database-name" attribute. */String GENERATE_NAME_ATTRIBUTE, ...;/** Constant for the "generate-name" attribute. */EmbeddedDatabaseFactoryBean.classsetGenerateUniqueDatabaseNameFlag(...)setDatabaseName(...)setDatabaseType(...)setDatabasePopulator(...)String generateName// 1) Check for an explicit database name// 2) Fall back to an implicit database name based on the ID// else, let EmbeddedDatabaseFactory use the default "testdb" nameimport DataSourceInitializer/** {@link org.springframework.beans.factory.xml.BeanDefinitionParser} that parses an {@code initialize-database} ... */DataSourceInitializer.class/** {@link NamespaceHandler} for JDBC configuration namespace. ... */new EmbeddedDatabaseBeanDefinitionParser(...)new InitializeDatabaseBeanDefinitionParser(...)/** {@link FactoryBean} implementation that takes a list of location Strings ... */List<String> locations, ...;List<Resource> scriptsnew Comparator<Resource>(...) { ... }/** Defines the Spring JDBC configuration namespace. */import PreparedStatement/** Simple adapter for {@link PreparedStatementSetter} that applies a given array of arguments. ... *//** Create a new ArgPreparedStatementSetter for the given arguments. ... */doSetValue(...)/** Set the value for prepared statements specified parameter index using the passed in value. ... */SqlParameterValue paramValuesetParameterValue(...)SqlTypeValue.TYPE_UNKNOWNcleanupParameters(...)import InvalidDataAccessApiUsageException/** Simple adapter for {@link PreparedStatementSetter} that applies ... */...[] argTypes, ...;/** Create a new ArgTypePreparedStatementSetter for the given arguments. ... */argTypes.lengthnew InvalidDataAccessApiUsageException(...)this.argTypesTypes.ARRAYCollection<?> entriesObject entryObject[] valueArray/** Set the value for the prepared statement's specified parameter position using the passed in ... *//** Batch update callback interface used by the {@link JdbcTemplate} class. ... *//** Set parameter values on the given PreparedStatement. ... *//** Return the size of the batch. ... *//** Generic utility methods for working with JDBC batch statements. ... */batchUpdate(...)new BatchPreparedStatementSetter(...) { ... }setStatementParameters(...)int colIndexint colTypecolumnTypes.lengthimport ResultSetimport ResultSetMetaData/** {@link RowMapper} implementation that converts a row into a new instance ... */Class<T> mappedClass, ...;/** The class we are mapping to. */boolean checkFullyPopulated, ...;/** Whether we're strictly validating. */boolean primitivesDefaultedForNullValue, ...;/** Whether we're defaulting primitives when mapping a null value. *//** ConversionService for binding JDBC values to bean properties. */Map<String,PropertyDescriptor> mappedFields, ...;/** Map of the fields we provide mapping for. */Set<String> mappedProperties, ...;/** Set of bean properties we provide mapping for. *//** Create a new {@code BeanPropertyRowMapper} for bean-style configuration. ... *//** Create a new {@code BeanPropertyRowMapper}, accepting unpopulated ... *//** Create a new {@code BeanPropertyRowMapper}. ... */this.checkFullyPopulated/** Set the class that each row should be mapped to. */this.mappedClass/** Get the class that we are mapping to. *//** Set whether we're strictly validating that all bean properties have been mapped ... *//** Return whether we're strictly validating that all bean properties have been ... *//** Set whether we're defaulting Java primitives in the case of mapping a null value ... */this.primitivesDefaultedForNullValue/** Return whether we're defaulting Java primitives in the case of mapping a null value ... *//** Set a {@link ConversionService} for binding JDBC values to bean properties, ... *//** Return a {@link ConversionService} for binding JDBC values to bean properties, ... *//** Initialize the mapping meta-data for the given class. ... */this.mappedFieldsnew HashMap<String,PropertyDescriptor>(...)this.mappedPropertiesString underscoredNameunderscoreName(...)lowerCaseName(...)/** Convert a name in camelCase to an underscored name in lower case. ... *//** Convert the given name to lower case. ... *//** Extract the values for all columns in the current row. ... */T mappedObjectconstructMappedInstance(...)ResultSetMetaData rsmdgetMetaData(...)int columnCountgetColumnCount(...)Set<String> populatedPropertiesisCheckFullyPopulated(...)String columnlookupColumnName(...)getColumnValue(...)new DataRetrievalFailureException(...)/** Construct an instance of the mapped class for the current row. ... *//** Initialize the given BeanWrapper to be used for row mapping. ... */ConversionService cs/** Retrieve a JDBC object value for the specified column. ... */getResultSetValue(...)/** Static factory method to create a new {@code BeanPropertyRowMapper}. ... */new BeanPropertyRowMapper<T>(...)BeanPropertyRowMapper<T> rowMapper// No PropertyDescriptor foundimport CallableStatementimport DataAccessException/** Generic callback interface for code that operates on a CallableStatement. ... *//** Gets called by {@code JdbcTemplate.execute} with an active JDBC ... *//** One of the three central callback interfaces used by the JdbcTemplate class. ... *//** Create a callable statement in this connection. Allows implementations to use ... *//** Helper class that efficiently creates multiple {@link CallableStatementCreator} ... */ResultSet.TYPE_FORWARD_ONLYString callString, ...;/** The SQL call string, which won't change when the parameters change. */List<SqlParameter> declaredParameters, ...;/** List of SqlParameter objects. May not be {@code null}. */int resultSetType, ...;boolean updatableResults, ...;/** Create a new factory. Will need to add parameters via the ... */this.callStringthis.declaredParametersnew ArrayList<SqlParameter>(...)/** Create a new factory with the given SQL and the given parameters. ... *//** Return the SQL call string. ... *//** Add a new declared parameter. ... *//** Set whether to use prepared statements that return a specific type of ResultSet. ... */this.resultSetType/** Set whether to use prepared statements capable of returning updatable ResultSets. */this.updatableResults/** Return a new CallableStatementCreator instance given this parameters. ... */new CallableStatementCreatorImpl(...)/** Return a new CallableStatementCreator instance given this parameter mapper. ... *//** CallableStatementCreator implementation returned by this class. */ParameterMapper inParameterMapper, ...;Map<String,?> inParameters, ...;/** Create a new CallableStatementCreatorImpl. ... */this.inParameterMapperthis.inParametersCallableStatement csint sqlColIndxprepareCall(...)ResultSet.CONCUR_UPDATABLEResultSet.CONCUR_READ_ONLYSqlParameter declaredParamisResultsParameter(...)Object inValueregisterOutParameter(...)getSqlType(...)getScale(...)isInputValueProvided(...)// If we were given a ParameterMapper, we must let the mapper do its thing to create the Map.// So, it's a call parameter - part of the call string.// Get the value - it may still be null.// It's an output parameter: SqlReturnResultSet parameters already excluded.// It need not (but may be) supplied by the caller.// It's an input parameter; must be supplied by the caller./** {@link RowMapper} implementation that creates a {@code java.util.Map} ... */Map<String,Object> mapOfColumnValuescreateColumnMap(...)getColumnKey(...)/** Create a Map instance to be used as column map. ... */new LinkedCaseInsensitiveMap<Object>(...)/** Determine the key to use for the given column in the column Map. ... *//** Generic callback interface for code that operates on a JDBC Connection. ... */Constructor<T> mappedConstructor, ...;...[] constructorParameterNames, ...;...[] constructorParameterTypes, ...;/** Create a new {@code DataClassRowMapper} for bean-style configuration. ... *//** Create a new {@code DataClassRowMapper}. ... */this.mappedConstructorgetResolvableConstructor(...)this.constructorParameterNamesthis.constructorParameterTypesthis.constructorParameterNames.lengthfindColumn(...)/** Static factory method to create a new {@code DataClassRowMapper}. ... */new DataClassRowMapper<T>(...)DataClassRowMapper<T> rowMapper/** Subinterface of {@link SqlTypeValue} that adds a cleanup callback, ... *//** Clean up resources held by this type value, ... *//** Extension of the {@link BatchPreparedStatementSetter} interface, ... *//** Return whether the batch is complete, that is, whether there were no ... */import IncorrectResultSizeDataAccessExceptionimport KeyHolderimport SqlRowSet/** Interface specifying a basic set of JDBC operations. ... *//** Execute a JDBC data access operation, implemented as callback action ... */// Methods dealing with a plain java.sql.Connection// Methods dealing with static SQL (java.sql.Statement)/** Issue a single SQL execute, typically a DDL statement. ... *//** Execute a query given static SQL, reading the ResultSet with a ... *//** Execute a query given static SQL, reading the ResultSet on a per-row ... *//** Execute a query given static SQL, mapping each row to a result object ... *//** Execute a query given static SQL, mapping a single result row to a ... *//** Execute a query for a result object, given static SQL. ... *//** Execute a query for a result map, given static SQL. ... *//** Execute a query for a result list, given static SQL. ... *//** Execute a query for an SqlRowSet, given static SQL. ... *//** Issue a single SQL update operation (such as an insert, update or delete statement). ... *//** Issue multiple SQL updates on a single JDBC Statement using batching. ... */// Methods dealing with prepared statements/** Query using a prepared statement, reading the ResultSet with a ResultSetExtractor. ... *//** Query given SQL to create a prepared statement from SQL and a list of arguments ... *//** Query using a prepared statement, reading the ResultSet on a per-row basis ... *//** Query given SQL to create a prepared statement from SQL and a ... *//** Query given SQL to create a prepared statement from SQL and a list of ... *//** Query using a prepared statement, mapping each row to a result object ... *//** Query given SQL to create a prepared statement from SQL and a list ... *//** Issue a single SQL update operation (such as an insert, update or delete ... *//** Issue an update statement using a PreparedStatementCreator to provide SQL and ... *//** Issue an update statement using a PreparedStatementSetter to set bind parameters, ... *//** Issue a single SQL update operation (such as an insert, update or delete statement) ... *//** Issue multiple update statements on a single PreparedStatement, ... *//** Execute a batch using the supplied SQL statement with the batch of supplied arguments. ... *//** Execute multiple batches using the supplied SQL statement with the collect of supplied ... */// Methods dealing with callable statements/** Execute an SQL call using a CallableStatementCreator to provide SQL and ... */import BatchUpdateExceptionimport Statementimport DataAccessUtilsimport InvalidResultSetAccessExceptionimport SQLWarningExceptionimport UncategorizedSQLExceptionimport ConnectionProxyimport JdbcAccessor/** <b>This is the central class in the JDBC core package.</b> ... */String RETURN_RESULT_SET_PREFIX, ...;String RETURN_UPDATE_COUNT_PREFIX, ...;boolean ignoreWarnings, ...;/** If this variable is false, we will throw exceptions on SQL warnings. */int fetchSize, ...;/** If this variable is set to a non-negative value, it will be used for setting the ... */int maxRows, ...;int queryTimeout, ...;boolean skipResultsProcessing, ...;/** If this variable is set to true, then all results checking will be bypassed for any ... */boolean skipUndeclaredResults, ...;/** If this variable is set to true then all results from a stored procedure call ... */boolean resultsMapCaseInsensitive, ...;/** If this variable is set to true then execution of a CallableStatement will return ... *//** Construct a new JdbcTemplate for bean usage. ... *//** Construct a new JdbcTemplate, given a DataSource to obtain connections from. ... *//** Set whether or not we want to ignore SQLWarnings. ... */this.ignoreWarnings/** Return whether or not we ignore SQLWarnings. *//** Set the fetch size for this JdbcTemplate. This is important for processing large ... */this.fetchSize/** Return the fetch size specified for this JdbcTemplate. *//** Set the maximum number of rows for this JdbcTemplate. This is important for ... */this.maxRows/** Return the maximum number of rows specified for this JdbcTemplate. *//** Set the query timeout for statements that this JdbcTemplate executes. ... */this.queryTimeout/** Return the query timeout for statements that this JdbcTemplate executes. *//** Set whether results processing should be skipped. Can be used to optimize callable ... */this.skipResultsProcessing/** Return whether results processing should be skipped. *//** Set whether undeclared results should be skipped. */this.skipUndeclaredResults/** Return whether undeclared results should be skipped. *//** Set whether execution of a CallableStatement will return the results in a Map ... */this.resultsMapCaseInsensitive/** Return whether execution of a CallableStatement will return the results in a Map ... */Connection conobtainDataSource(...)Connection conToUsecreateConnectionProxy(...)doInConnection(...)SQLException exString sqlgetSql(...)getDataSource(...)translateException(...)/** Create a close-suppressing proxy for the given JDBC Connection. ... */new CloseSuppressingInvocationHandler(...)ConnectionProxy.classStatement stmtdoInStatement(...)createStatement(...)applyStatementSettings(...)handleWarnings(...)closeStatement(...)/** Callback to execute the statement. */new ExecuteStatementCallback(...)/** Callback to execute the query. */ResultSet rsexecuteQuery(...)extractData(...)closeResultSet(...)new QueryStatementCallback(...)query(...)new RowCallbackHandlerResultSetExtractor(...)result(...)new RowMapperResultSetExtractor<T>(...)new ResultSetSpliterator<T>(...)new StreamStatementCallback(...)queryForObject(...)getColumnMapRowMapper(...)List<T> resultsnullableSingleResult(...)getSingleColumnRowMapper(...)new SqlRowSetResultSetExtractor(...)/** Callback to execute the update statement. */int rowsexecuteUpdate(...)new UpdateStatementCallback(...)new BatchUpdateStatementCallback(...)sql.length/** Callback to execute the batch update. */String currSql, ...;int[] rowsAffectedsupportsBatchUpdates(...)String sqlStmtthis.currSqlappendSql(...)addBatch(...)executeBatch(...)BatchUpdateException exString batchExceptionSqlgetUpdateCounts(...).lengthgetUpdateCounts(...)Statement.EXECUTE_FAILEDgetUpdateCount(...)PreparedStatement psdoInPreparedStatement(...)createPreparedStatement(...)new SimplePreparedStatementCreator(...)/** Query using a prepared statement, allowing for a PreparedStatementCreator ... */new PreparedStatementCallback<T>(...) { ... }setValues(...)newArgTypePreparedStatementSetter(...)newArgPreparedStatementSetter(...)new PreparedStatementCallback<Stream<T>>(...) { ... }queryForStream(...)new PreparedStatementCallback<Integer>(...) { ... }List<Map<String,Object>> generatedKeysgetKeyList(...)ResultSet keysgetGeneratedKeys(...)RowMapperResultSetExtractor<Map<String,Object>> rsenew RowMapperResultSetExtractor<Map<String,Object>>(...)new PreparedStatementCallback<int[]>(...) { ... }int batchSizegetBatchSize(...)InterruptibleBatchPreparedStatementSetter ipssisBatchExhausted(...)List<Integer> rowsAffectedint[] rowsAffectedArrayrowsAffectedArray.lengthint[][] resultnew PreparedStatementCallback<int[][]>(...) { ... }List<int[]> rowsAffectednew ArrayList<int[]>(...)boolean batchSupportedint nint[][] result1T objint batchIdxint itemsresult1.lengthdoInCallableStatement(...)createCallableStatement(...)new SimpleCallableStatementCreator(...)List<SqlParameter> updateCountParametersList<SqlParameter> resultSetParametersList<SqlParameter> callParametersnew CallableStatementCallback<Map<String,Object>>(...) { ... }int updateCountMap<String,Object> resultsMapcreateResultsMap(...)extractReturnedResults(...)extractOutputParameters(...)SqlParameter parameter/** Extract returned ResultSets from the completed stored procedure. ... */int rsIndexint updateIndexboolean moreResultsSqlReturnResultSet declaredRsParamprocessResultSet(...)getResultSet(...)String rsNameSqlReturnResultSet undeclaredRsParamnew SqlReturnResultSet(...)SqlReturnUpdateCount ucParamString declaredUcNameString undeclaredNamegetMoreResults(...)/** Extract output parameters from the completed stored procedure. ... */int sqlColIndexSqlParameter paramSqlOutParameter outParamSqlReturnType returnTypegetSqlReturnType(...)Object outgetTypeValue(...)isResultSetSupported(...)SqlReturnResultSet rsParam/** Process the given ResultSet from a stored procedure. ... */getRowMapper(...)RowMapper<?> rowMapperObject datanew RowMapperResultSetExtractor<?>(...)getRowCallbackHandler(...)RowCallbackHandler rchgetResultSetExtractor(...)/** Create a new RowMapper for reading columns as key-value pairs. ... */// Implementation hooks and helper methodsnew ColumnMapRowMapper(...)/** Create a new RowMapper for reading result objects from a single column. ... */new SingleColumnRowMapper<T>(...)/** Create a Map instance to be used as the results map. ... */isResultsMapCaseInsensitive(...)/** Prepare the given JDBC Statement (or PreparedStatement or CallableStatement), ... */int fetchSizegetFetchSize(...)int maxRowsgetMaxRows(...)setFetchSize(...)setMaxRows(...)applyTimeout(...)getQueryTimeout(...)/** Create a new arg-based PreparedStatementSetter using the args passed in. ... */new ArgumentPreparedStatementSetter(...)/** Create a new arg-type-based PreparedStatementSetter using the args and types passed in. ... */new ArgumentTypePreparedStatementSetter(...)/** Throw an SQLWarningException if we're not ignoring warnings, ... */isIgnoreWarnings(...)SQLWarning warningToLoggetWarnings(...)getNextWarning(...)/** Throw an SQLWarningException if encountering an actual warning. ... */new SQLWarningException(...)/** Translate the given {@link SQLException} into a generic {@link DataAccessException}. ... */DataAccessException daetranslate(...)getExceptionTranslator(...)new UncategorizedSQLException(...)/** Determine SQL from potential provider object. ... *//** Invocation handler that suppresses close calls on JDBC Connections. ... */Connection target, ...;isWrapperFor(...)/** Simple adapter for PreparedStatementCreator, allowing to use a plain SQL statement. */prepareStatement(...)/** Simple adapter for CallableStatementCreator, allowing to use a plain SQL statement. *//** Adapter to enable use of a RowCallbackHandler inside a ResultSetExtractor. ... */RowCallbackHandler rch, ...;this.rchprocessRow(...)/** Spliterator for queryForStream adaptation of a ResultSet to a Stream. ... */ResultSet rs, ...;RowMapper<T> rowMapper, ...;int rowNum, ...;this.rsthis.rowMappermapRow(...)this.rowNumnew InvalidResultSetAccessException(...)Spliterator<>.ORDERED// Create close-suppressing Connection proxy, also preparing returned Statements.// Release Connection early, to avoid potential connection pool deadlock// in the case when the exception translator hasn't been initialized yet.// Invocation on ConnectionProxy interface coming in...// Use hashCode of PersistenceManager proxy.// Handle close method: suppress, not valid.// Handle getTargetConnection method: return underlying Connection.// Invoke method on target Connection.// If return value is a JDBC Statement, apply statement settings// (fetch size, max rows, transaction timeout)./** Interface to be implemented by objects that can close resources ... *//** Close the resources allocated by parameters that the implementing ... *//** Implement this interface when parameters need to be customized based ... *//** Create a Map of input parameters, keyed by name. ... *//** Parameterized callback interface used by the {@link JdbcTemplate} class for ... *//** Generic callback interface for code that operates on a PreparedStatement. ... *//** One of the two central callback interfaces used by the JdbcTemplate class. ... *//** Create a statement in this connection. Allows implementations to use ... *//** Helper class that efficiently creates multiple {@link PreparedStatementCreator} ... *//** The SQL, which won't change when the parameters change. *//** List of SqlParameter objects (may not be {@code null}). */boolean returnGeneratedKeys, ...;...[] generatedKeysColumnNames, ...;/** Create a new factory with the given SQL and JDBC types. ... */sqlTypesToAnonymousParameterList(...)/** Create a new factory with the given SQL and parameters. ... *//** Return the SQL statement to execute. ... *//** Set whether prepared statements should be capable of returning auto-generated keys. */this.returnGeneratedKeys/** Set the column names of the auto-generated keys. */this.generatedKeysColumnNames/** Return a new PreparedStatementSetter for the given parameters. ... */new PreparedStatementCreatorImpl(...)/** Return a new PreparedStatementCreator for the given parameters. ... *//** PreparedStatementCreator implementation returned by this class. */String actualSql, ...;List<?> parameters, ...;this.actualSqlPreparedStatement.RETURN_GENERATED_KEYSObject inSqlParameter declaredParameterIterable<?> entries// Account for named parameters being used multiple times// Set arguments: Does nothing if there are no parameters.// SqlParameterValue overrides declared parameter meta-data, in particular for// independence from the declared parameter position in case of named parameters./** General callback interface used by the {@link JdbcTemplate} class. ... *//** Callback interface used by {@link JdbcTemplate}'s query methods. ... *//** Implementations must implement this method to process the entire ResultSet. ... *//** Common base class for ResultSet-supporting SqlParameters like ... */ResultSetExtractor<?> resultSetExtractor, ...;RowCallbackHandler rowCallbackHandler, ...;RowMapper<?> rowMapper, ...;/** Create a new ResultSetSupportingSqlParameter. ... */this.resultSetExtractorthis.rowCallbackHandler/** Does this parameter support a ResultSet, i.e. does it hold a ... *//** Return the ResultSetExtractor held by this parameter, if any. *//** Return the RowCallbackHandler held by this parameter, if any. *//** Return the RowMapper held by this parameter, if any. *//** An interface used by {@link JdbcTemplate} for processing rows of a ... *//** Implementations must implement this method to process each row of data ... *//** Implementation of RowCallbackHandler. Convenient superclass for callback handlers. ... */int rowCount, ...;/** Rows we've seen so far. */int columnCount, ...;/** Columns we've seen so far. */...[] columnTypes, ...;/** Indexed from 0. Type (as in java.sql.Types) for the columns ... */...[] columnNames, ...;/** Indexed from 0. Column name as returned by ResultSetMetaData object. *//** Implementation of ResultSetCallbackHandler. ... */this.rowCountthis.columnCountthis.columnTypesthis.columnNamesgetColumnType(...)/** Subclasses may override this to perform custom extraction ... *//** Return the types of the columns as java.sql.Types constants ... *//** Return the names of the columns. ... *//** Return the row count of this ResultSet. ... *//** Return the number of columns in this result set. ... */// could also get column names/** An interface used by {@link JdbcTemplate} for mapping rows of a ... *//** Implementations must implement this method to map each row of data ... *//** Adapter implementation of the ResultSetExtractor interface that delegates ... */int rowsExpected, ...;/** Create a new RowMapperResultSetExtractor. ... */this.rowsExpectedint rowNumimport TypeMismatchDataAccessExceptionimport IncorrectResultSetColumnCountException/** {@link RowMapper} implementation that converts a single column into a single ... *//** Create a new {@code SingleColumnRowMapper} for bean-style configuration. ... *//** Create a new {@code SingleColumnRowMapper}. ... */setRequiredType(...)/** Set the type that each result object is expected to match. ... *//** Set a {@link ConversionService} for converting a fetched value. ... *//** Extract a value for the single column in the current row. ... */int nrOfColumnsnew IncorrectResultSetColumnCountException(...)convertValueToRequiredType(...)new TypeMismatchDataAccessException(...)getColumnTypeName(...)/** Retrieve a JDBC object value for the specified column, using the most ... *//** Convert the given column value to the specified required type. ... *//** Static factory method to create a new {@code SingleColumnRowMapper}. ... */SingleColumnRowMapper<T> rowMapper// Validate column count.// Extract column value from JDBC ResultSet.// Extracted value does not match already: try to convert it.// No required type specified -> perform default extraction.// Convert original Number to target Number class.// Convert stringified value to target Number class./** Subclass of {@link SqlOutParameter} to represent an INOUT parameter. ... *//** Create a new SqlInOutParameter. ... *//** Subclass of {@link SqlParameter} to represent an output parameter. ... */SqlReturnType sqlReturnType, ...;/** Create a new SqlOutParameter. ... */this.sqlReturnType/** Return the custom return type, if any. *//** Return whether this parameter holds a custom return type. *//** Object to represent an SQL parameter definition. ... */// The name of the parameter, if anyint sqlType, ...;// SQL type constant from {@code java.sql.Types}// Used for types that are user-named like: STRUCT, DISTINCT, JAVA_OBJECT, named array typesInteger scale, ...;// The scale to apply in case of a NUMERIC or DECIMAL type, if any/** Create a new anonymous SqlParameter, supplying the SQL type. ... */this.sqlTypethis.scale/** Create a new SqlParameter, supplying name and SQL type. ... */otherParam.nameotherParam.sqlTypeotherParam.typeNameotherParam.scale/** Return the name of the parameter, or {@code null} if anonymous. *//** Return the SQL type of the parameter. *//** Return the type name of the parameter, if any. *//** Return the scale of the parameter, if any. *//** Return whether this parameter holds input values that should be set ... *//** Return whether this parameter is an implicit return parameter used during the ... *//** Convert a list of JDBC types, as defined in {@code java.sql.Types}, ... */List<SqlParameter> resultnew SqlParameter(...)/** Object to represent an SQL parameter value, including parameter meta-data ... *//** Create a new SqlParameterValue, supplying the SQL type. ... *//** Create a new SqlParameterValue based on the given SqlParameter declaration. ... *//** Return the value object that this parameter value holds. *//** Interface to be implemented by objects that can provide SQL strings. ... *//** Return the SQL string for this object, i.e. ... *//** Represents a returned {@link java.sql.ResultSet} from a stored procedure call. ... *//** Create a new instance of the {@link SqlReturnResultSet} class. ... *//** Interface to be implemented for retrieving values for more complex database-specific ... */int TYPE_UNKNOWN, ...;/** Constant that indicates an unknown (or unspecified) SQL type. ... *//** Get the type value from the specific object. ... *//** Represents a returned update count from a stored procedure call. ... *//** Create a new SqlReturnUpdateCount. ... */Types.INTEGERimport CachedRowSetimport RowSetFactoryimport RowSetProviderimport ResultSetWrappingSqlRowSet/** {@link ResultSetExtractor} implementation that returns a Spring {@link SqlRowSet} ... */RowSetFactory rowSetFactory, ...;createSqlRowSet(...)/** Create a {@link SqlRowSet} that wraps the given {@link ResultSet}, ... */CachedRowSet rowSetnewCachedRowSet(...)new ResultSetWrappingSqlRowSet(...)/** Create a new {@link CachedRowSet} instance, to be populated by ... */createCachedRowSet(...)/** Interface to be implemented for setting values for more complex database-specific ... */JdbcUtils.TYPE_UNKNOWN/** Set the type value on the given PreparedStatement. ... *//** Generic callback interface for code that operates on a JDBC Statement. ... */import Blobimport Clobimport SqlValue/** Utility methods for PreparedStatementSetter/Creator and CallableStatementCreator ... */StatementCreatorUtils.classnew HashMap<Class<?>,Integer>(...)Types.BOOLEANTypes.TINYINTTypes.SMALLINTTypes.BIGINTTypes.FLOATTypes.DOUBLETypes.DECIMALTypes.DATETypes.TIMETimestamp.classTypes.TIMESTAMPBlob.classTypes.BLOBClob.classTypes.CLOBString IGNORE_GETPARAMETERTYPE_PROPERTY_NAME, ...;/** System property that instructs Spring to ignore {@link java.sql.ParameterMetaData#getParameterType} ... */boolean shouldIgnoreGetParameterType, ...;Map<Class<?>,Integer> javaTypeToSqlTypeMap, ...;/** Derive a default SQL type from the given Java type. ... */Integer sqlTypeTypes.NUMERICisStringValue(...)Types.VARCHARisDateValue(...)/** Set the value for a parameter. The method used is based on the SQL type ... */setParameterValueInternal(...)String typeNameToUseint sqlTypeToUseObject inValueToUseSqlParameterValue parameterValuesetNull(...)/** Set the specified PreparedStatement parameter to null, ... */Types.OTHERboolean useSetObjectInteger sqlTypeToUsegetParameterMetaData(...)DatabaseMetaData dbmdString jdbcDriverNamegetDriverName(...)String databaseProductNameTypes.NULLsetObject(...)setTypeValue(...)Types.LONGVARCHARsetString(...)Types.NVARCHARTypes.LONGNVARCHARsetNString(...)Types.NCLOBsetNClob(...)setClob(...)setBigDecimal(...)setBoolean(...)setDate(...)setTimestamp(...)new Timestamp(...)/** Check whether the given value can be treated as a String value. *//** Check whether the given value is a {@code java.util.Date} ... *//** Clean up all resources held by parameter values which were passed to an ... */// override type info?// Proceed with database-specific checks// "Microsoft SQL Server JDBC Driver 3.0" versus "Microsoft JDBC Driver 4.0 for SQL Server"// Necessary for older Oracle drivers, in particular when running against an Oracle 10 database.// Should also work fine against other drivers/databases since it uses standard JDBC 4.0 API.// Fallback: setString or setNString binding// Fall back to generic setObject call without SQL type specified.// Fall back to generic setObject call with SQL type specified.// Consider any CharSequence (including StringBuffer and StringBuilder) as a String.// Unwrap SqlParameterValue first...// Check for disposable value typesimport RowMapperimport SqlOutParameterimport SqlParameterimport SqlParameterValueimport SqlReturnResultSetimport SqlParameterSourceimport SqlParameterSourceUtils/** Class to manage context meta-data used for the configuration ... */// Logger available to subclassesString procedureName, ...;// Name of procedure to callString catalogName, ...;// Name of catalog for callString schemaName, ...;// Name of schema for callList<SqlParameter> callParameters, ...;// List of SqlParameter objects to be used in call executionString actualFunctionReturnName, ...;// Actual name to use for the return value in the output mapSet<String> limitedInParameterNames, ...;// Set of in parameter names to exclude use for any not listedList<String> outParameterNames, ...;// List of SqlParameter names for out parametersboolean function, ...;// Indicates whether this is a procedure or a functionboolean returnValueRequired, ...;// Indicates whether this procedure's return value should be includedboolean accessCallParameterMetaData, ...;// Should we access call parameter meta-data info or notboolean namedBinding, ...;// Should we bind parameter by nameCallMetaDataProvider metaDataProvider, ...;// The provider of call meta-data/** Specify the name used for the return value of the function. */this.actualFunctionReturnName/** Get the name used for the return value of the function. *//** Specify a limited set of in parameters to be used. */this.limitedInParameterNames/** Get a limited set of in parameters to be used. *//** Specify the names of the out parameters. */this.outParameterNames/** Get a list of the out parameter names. *//** Specify the name of the procedure. */this.procedureName/** Get the name of the procedure. *//** Specify the name of the catalog. */this.catalogName/** Get the name of the catalog. *//** Specify the name of the schema. */this.schemaName/** Get the name of the schema. *//** Specify whether this call is a function call. */this.function/** Check whether this call is a function call. *//** Specify whether a return value is required. */this.returnValueRequired/** Check whether a return value is required. *//** Specify whether call parameter meta-data should be accessed. */this.accessCallParameterMetaData/** Check whether call parameter meta-data should be accessed. *//** Specify whether parameters should be bound by name. ... */this.namedBinding/** Check whether parameters should be bound by name. ... *//** Initialize this class with meta-data from the database. ... */this.metaDataProvidercreateMetaDataProvider(...)/** Create a ReturnResultSetParameter/SqlOutParameter depending on the support provided ... */CallMetaDataProvider providerobtainMetaDataProvider(...)isReturnResultSetSupported(...)isRefCursorSupported(...)new SqlOutParameter(...)getRefCursorSqlType(...)/** Get the name of the single out parameter for this call. ... */isFunction(...)getFunctionReturnName(...)/** Get the List of SqlParameter objects to be used in call execution. */this.callParameters/** Process the list of parameters provided, and if procedure column meta-data is used, ... */reconcileParameters(...)/** Reconcile the provided parameters with available meta-data and add new ones where appropriate. */List<SqlParameter> declaredReturnParamsMap<String,SqlParameter> declaredParamsnew LinkedHashMap<String,SqlParameter>(...)boolean returnDeclaredList<String> outParamNamesList<String> metaDataParamNamesList<SqlParameter> workParamsMap<String,String> limitedInParamNamesMapCallParameterMetaData metagetCallParameterMetaData(...)isReturnParameter(...)lowerCase(...)String paramNameToMatchparameterNameToUse(...)setOutParameterNames(...)isProcedureColumnMetaDataUsed(...)String limitedParamNameString paramNameToCheckString paramNameToUsegetOutParameterNames(...)byPassReturnParameter(...)isReturnValueRequired(...)String returnNameToUsecreateDefaultOutParameter(...)DatabaseMetaData.procedureColumnOutDatabaseMetaData.procedureColumnInOutcreateDefaultInOutParameter(...)createDefaultInParameter(...)/** Match input parameter values with the parameters declared to be used in the call. ... */Map<String,String> caseInsensitiveParameterNamesextractCaseInsensitiveParameterNames(...)Map<String,String> callParameterNamesMap<String,Object> matchedParametersString parameterNameString parameterNameToMatchhasValue(...)String lowerCaseNameString englishLowerCaseNameconvertUnderscoreNameToPropertyName(...)String callParameterNameparameterValues.length/** Build the call string based on configuration and meta-data information. ... */StringBuilder callStringString catalogNameToUseString schemaNameToUseisSupportsSchemasInProcedureCalls(...)isSupportsCatalogsInProcedureCalls(...)catalogNameToUse(...)getCatalogName(...)schemaNameToUse(...)getSchemaName(...)procedureNameToUse(...)getProcedureName(...)createParameterBinding(...)/** Build the parameter binding fragment. ... */isNamedBinding(...)// Get the names of the meta-data parameters// Separate implicit return parameters from explicit parameters...// DatabaseMetaData.procedureColumnReturn or possibly procedureColumnResult// DatabaseMetaData.procedureColumnIn or possibly procedureColumnUnknown// For parameter source lookups we need to provide case-insensitive lookup support// since the database meta-data is not necessarily providing case sensitive parameter names.// For Oracle where catalogs are not supported we need to reverse the schema name// and the catalog name since the catalog is used for the package name/** Interface specifying the API to be implemented by a class providing call meta-data. ... *//** Initialize using the provided DatabaseMetData. ... *//** Initialize the database specific management of procedure column meta-data. ... *//** Provide any modification of the procedure name passed in to match the meta-data currently used. ... *//** Provide any modification of the catalog name passed in to match the meta-data currently used. ... *//** Provide any modification of the schema name passed in to match the meta-data currently used. ... *//** Provide any modification of the column name passed in to match the meta-data currently used. ... *//** Create a default out parameter based on the provided meta-data. ... *//** Create a default in/out parameter based on the provided meta-data. ... *//** Create a default in parameter based on the provided meta-data. ... *//** Get the name of the current user. Useful for meta-data lookups etc. ... *//** Does this database support returning ResultSets that should be retrieved with the JDBC call: ... *//** Does this database support returning ResultSets as ref cursors to be retrieved with ... *//** Get the {@link java.sql.Types} type for columns that return ResultSets as ref cursors ... *//** Are we using the meta-data for the procedure columns? *//** Should we bypass the return parameter with the specified name. ... *//** Get the call parameter meta-data that is currently used. ... *//** Does the database support the use of catalog name in procedure calls? *//** Does the database support the use of schema name in procedure calls? *//** Factory used to create a {@link CallMetaDataProvider} implementation ... */CallMetaDataProviderFactory.classList<String> supportedDatabaseProductsForProcedures, ...;/** List of supported database products for procedure calls. */List<String> supportedDatabaseProductsForFunctions, ...;/** List of supported database products for function calls. *//** Create a {@link CallMetaDataProvider} based on the database meta-data. ... */new DatabaseMetaDataCallback<CallMetaDataProvider>(...) { ... }boolean accessProcedureColumnMetaDataisAccessCallParameterMetaData(...)new OracleCallMetaDataProvider(...)new PostgresCallMetaDataProvider(...)new DerbyCallMetaDataProvider(...)new Db2CallMetaDataProvider(...)new HanaCallMetaDataProvider(...)new SqlServerCallMetaDataProvider(...)new SybaseCallMetaDataProvider(...)new GenericCallMetaDataProvider(...)initializeWithMetaData(...)initializeWithProcedureColumnMetaData(...)new DataAccessResourceFailureException(...)/** Holder of meta-data for a specific parameter that is used for call processing. ... */int parameterType, ...;boolean nullable, ...;/** Constructor taking all the properties except the function marker. *//** Constructor taking all the properties including the function marker. ... */this.nullable/** Return whether this parameter is declared in a function. ... *//** Return the parameter name. *//** Return the parameter type. *//** Determine whether the declared parameter qualifies as a 'return' parameter ... */DatabaseMetaData.functionReturnDatabaseMetaData.procedureColumnReturnDatabaseMetaData.procedureColumnResult/** Return the parameter SQL type. *//** Return the parameter type name. *//** Return whether the parameter is nullable. *//** DB2 specific implementation for the {@link CallMetaDataProvider} interface. ... */setSupportsCatalogsInProcedureCalls(...)supportsCatalogsInProcedureCalls(...)setSupportsSchemasInProcedureCalls(...)supportsSchemasInProcedureCalls(...)setStoresUpperCaseIdentifiers(...)storesUpperCaseIdentifiers(...)setStoresLowerCaseIdentifiers(...)storesLowerCaseIdentifiers(...)String userNamemetaDataSchemaNameToUse(...)// Use current user schema if no schema specified.../** Derby specific implementation for the {@link CallMetaDataProvider} interface. ... *//** The Derby specific implementation of {@link TableMetaDataProvider}. ... */boolean supportsGeneratedKeysOverride, ...;supportsGetGeneratedKeys(...)getDriverVersion(...)this.supportsGeneratedKeysOverrideisGetGeneratedKeysSupported(...)import SqlInOutParameter/** A generic implementation of the {@link CallMetaDataProvider} interface. ... */new ArrayList<CallParameterMetaData>(...)CallMetaDataProvider.classboolean supportsCatalogsInProcedureCalls, ...;boolean supportsSchemasInProcedureCalls, ...;boolean storesUpperCaseIdentifiers, ...;boolean storesLowerCaseIdentifiers, ...;boolean procedureColumnMetaDataUsed, ...;List<CallParameterMetaData> callParameterMetaData, ...;/** Constructor used to initialize with provided database meta-data. ... */this.procedureColumnMetaDataUsedprocessProcedureColumns(...)this.callParameterMetaDataisStoresUpperCaseIdentifiers(...)isStoresLowerCaseIdentifiers(...)new SqlInOutParameter(...)/** Specify whether the database supports the use of catalog name in procedure calls. */this.supportsCatalogsInProcedureCalls/** Specify whether the database supports the use of schema name in procedure calls. */this.supportsSchemasInProcedureCalls/** Specify whether the database uses upper case for identifiers. */this.storesUpperCaseIdentifiers/** Does the database use upper case for identifiers? *//** Specify whether the database uses lower case for identifiers. */this.storesLowerCaseIdentifiers/** Does the database use lower case for identifiers? *//** Process the procedure column meta-data. */String metaDataCatalogNamemetaDataCatalogNameToUse(...)String metaDataSchemaNameString metaDataProcedureNameList<String> foundboolean functionResultSet proceduresgetProcedures(...)ResultSet functionsgetFunctions(...)ResultSet columnsgetFunctionColumns(...)getProcedureColumns(...)String columnNameint columnTypeisInOrOutColumn(...)int nullableDatabaseMetaData.functionNullableDatabaseMetaData.procedureNullablenew CallParameterMetaData(...)DatabaseMetaData.functionColumnInDatabaseMetaData.functionColumnInOutDatabaseMetaData.functionColumnOutDatabaseMetaData.procedureColumnIn// Functions not exposed as procedures anymore on PostgreSQL driver 42.2.11// Although we could invoke `this.callParameterMetaData.clear()` so that// we don't retain a partial list of column names (like we do in// GenericTableMetaDataProvider.processTableColumns(...)), we choose// not to do that here, since invocation of the stored procedure will// likely fail anyway with an incorrect argument list./** A generic implementation of the {@link TableMetaDataProvider} interface ... */new ArrayList<TableParameterMetaData>(...)TableMetaDataProvider.classboolean tableColumnMetaDataUsed, ...;/** indicator whether column meta-data should be used. */String databaseVersion, ...;/** the version of the database. *//** the name of the user currently connected. *//** indicates whether the identifiers are uppercased. *//** indicates whether the identifiers are lowercased. */boolean getGeneratedKeysSupported, ...;/** indicates whether generated keys retrieval is supported. */boolean generatedKeysColumnNameArraySupported, ...;/** indicates whether the use of a String[] for generated keys is supported. */List<String> productsNotSupportingGeneratedKeysColumnNameArray, ...;/** database products we know not supporting the use of a String[] for generated keys. */List<TableParameterMetaData> tableParameterMetaData, ...;/** Collection of TableParameterMetaData objects. */this.tableColumnMetaDataUsedthis.tableParameterMetaDatathis.getGeneratedKeysSupportedthis.generatedKeysColumnNameArraySupportedsetGetGeneratedKeysSupported(...)this.productsNotSupportingGeneratedKeysColumnNameArraysetGeneratedKeysColumnNameArraySupported(...)this.databaseVersiongetDatabaseProductVersion(...)locateTableAndProcessMetaData(...)getDefaultSchema(...)/** Provide access to default schema for subclasses. *//** Provide access to version info for subclasses. *//** Method supporting the meta-data processing for a table. */Map<String,TableMetaData> tableMetanew HashMap<String,TableMetaData>(...)ResultSet tablesgetTables(...)tableNameToUse(...)TableMetaData tmdnew TableMetaData(...)setCatalogName(...)setSchemaName(...)setTableName(...)processTableColumns(...)findTableMetaData(...)/** Method supporting the meta-data processing for a table's columns. */ResultSet tableColumnsString metaDataTableNamegetTableName(...)getColumns(...)int dataTypeboolean nullableTableParameterMetaData metanew TableParameterMetaData(...)int decimalDigits/** Class representing table meta-data. */String tableName, ...;this.tableName// Override a DECIMAL data type for no-decimal numerics// (this is for better Oracle support where there have been issues// using DECIMAL for certain inserts (see SPR-6912))// Clear the metadata so that we don't retain a partial list of column names/** SAP HANA specific implementation for the {@link CallMetaDataProvider} interface. ... *//** The HSQL specific implementation of {@link TableMetaDataProvider}. ... */import ColumnMapRowMapper/** Oracle-specific implementation for the {@link CallMetaDataProvider} interface. ... */String REF_CURSOR_NAME, ...;// Oracle uses catalog name for package name or an empty string if no package// Use current user schema if no schema specified/** Oracle-specific implementation of the {@link org.springframework.jdbc.core.metadata.TableMetaDataProvider}. ... */boolean includeSynonyms, ...;String defaultSchema, ...;this.includeSynonymsthis.defaultSchemalookupDefaultSchema(...)/* Oracle-based implementation for detecting the current schema. */CallableStatement cstmtMethod setIncludeSynonymsBoolean originalValueForIncludeSynonymsinitializeWithTableColumnMetaData(...)Class<?> oracleConClassMethod getIncludeSynonyms/** Postgres-specific implementation for the {@link CallMetaDataProvider} interface. ... */String RETURN_VALUE_NAME, ...;// Use public schema if no schema specified/** The PostgreSQL specific implementation of {@link TableMetaDataProvider}. ... *//** SQL Server specific implementation for the {@link CallMetaDataProvider} interface. ... */String REMOVABLE_COLUMN_PREFIX, ...;/** Sybase specific implementation for the {@link CallMetaDataProvider} interface. ... */import SqlTypeValue// Name of table for this context// Name of catalog for this context// Name of schema for this contextList<String> tableColumns, ...;// List of columns objects to be used in this contextboolean accessTableColumnMetaData, ...;// Should we access insert parameter meta-data info or notboolean overrideIncludeSynonymsDefault, ...;// Should we override default for including synonyms for meta-data lookupsTableMetaDataProvider metaDataProvider, ...;// The provider of table meta-databoolean generatedKeyColumnsUsed, ...;// Are we using generated key columns/** Set the name of the table for this context. *//** Get the name of the table for this context. *//** Set the name of the catalog for this context. *//** Get the name of the catalog for this context. *//** Set the name of the schema for this context. *//** Get the name of the schema for this context. *//** Specify whether we should access table column meta-data. */this.accessTableColumnMetaData/** Are we accessing table meta-data? *//** Specify whether we should override default for accessing synonyms. */this.overrideIncludeSynonymsDefault/** Are we overriding include synonyms default? *//** Get a List of the table column names. */this.tableColumns/** Process the current meta-data with the provided configuration options. ... */reconcileColumnsToUse(...)/** Compare columns created from meta-data with declared columns and return a reconciled list. ... */Set<String> keysgeneratedKeyNames.lengthList<String> columnsthis.generatedKeyColumnsUsedgetTableParameterMetaData(...)/** Match the provided column names and values with the list of columns used. ... */List<Object> values/** Build the insert string based on configuration and meta-data information. ... */StringBuilder insertStatementString paramsnCopies(...)getTableColumns(...)isAccessTableColumnMetaData(...)/** Build the array of {@link java.sql.Types} based on configuration and meta-data information. ... */int[] typesList<TableParameterMetaData> parametersMap<String,TableParameterMetaData> parameterMapint typeIndxTableParameterMetaData tpmd/** Does this database support the JDBC 3.0 feature of retrieving generated keys: ... *//** Does this database support simple query to retrieve generated keys ... */isGetGeneratedKeysSimulated(...)/** Does this database support a simple query to retrieve generated keys ... */getSimpleQueryForGetGeneratedKey(...)/** Is a column name String array for retrieving generated keys supported: ... */isGeneratedKeysColumnNameArraySupported(...)// For parameter source lookups we need to provide case-insensitive lookup support since the// database meta-data is not necessarily providing case-sensitive column names/** Interface specifying the API to be implemented by a class providing table meta-data. ... *//** Initialize using the database meta-data provided. ... *//** Initialize using provided database meta-data, table and column information. ... *//** Get the table name formatted based on meta-data information. ... *//** Get the catalog name formatted based on meta-data information. ... *//** Get the schema name formatted based on meta-data information. ... *//** Are we using the meta-data for the table columns? *//** Does this database support a simple query to retrieve the generated key when ... *//** Get the simple query to retrieve a generated key. *//** Does this database support a column name String array for retrieving generated keys: ... *//** Get the table parameter meta-data that is currently used. ... *//** Factory used to create a {@link TableMetaDataProvider} implementation ... */TableMetaDataProviderFactory.class/** Create a {@link TableMetaDataProvider} based on the database meta-data. ... */new DatabaseMetaDataCallback<TableMetaDataProvider>(...) { ... }TableMetaDataProvider providernew OracleTableMetaDataProvider(...)isOverrideIncludeSynonymsDefault(...)new PostgresTableMetaDataProvider(...)new DerbyTableMetaDataProvider(...)new HsqlTableMetaDataProvider(...)new GenericTableMetaDataProvider(...)/** Holder of meta-data for a specific parameter that is used for table processing. ... *//** Constructor taking all the properties. *//** Get the parameter name. *//** Get the parameter SQL type. *//** Get whether the parameter/column is nullable. *//** Context metadata abstraction for the configuration and execution ... *//** Abstract base class for {@link SqlParameterSource} implementations. ... */Map<String,Integer> sqlTypes, ...;Map<String,String> typeNames, ...;/** Register an SQL type for the given parameter. ... */this.sqlTypesthis.typeNames/** Return the SQL type for the given parameter, if registered. ... *//** Return the type name for the given parameter, if registered. ... *//** Enumerate the parameter names and values with their corresponding SQL type if available, ... */StringBuilder entryint sqlTyperesolveTypeName(...)import StatementCreatorUtils/** {@link SqlParameterSource} implementation that obtains parameter values ... */...[] propertyNames, ...;/** Create a new BeanPropertySqlParameterSource for the given bean. ... *//** Derives a default SQL type from the corresponding property type. ... */Class<?> propTypejavaTypeToSqlParameterType(...)getReadablePropertyNames(...)/** Provide access to the property names of the wrapped bean. ... */this.propertyNames/** A simple empty implementation of the {@link SqlParameterSource} interface. ... */new EmptySqlParameterSource(...)EmptySqlParameterSource INSTANCE, ...;/** A shared instance of {@link EmptySqlParameterSource}. *//** {@link SqlParameterSource} implementation that holds a given Map of parameters. ... *//** Create an empty MapSqlParameterSource, ... *//** Create a new MapSqlParameterSource, with one value ... */addValue(...)/** Create a new MapSqlParameterSource based on a Map. ... */addValues(...)/** Add a parameter to this parameter source. ... */registerSqlType(...)registerTypeName(...)/** Add a Map of parameters to this parameter source. ... *//** Expose the current parameter values as read-only Map. */import BatchPreparedStatementSetterimport JdbcOperations/** Generic utility methods for working with JDBC batch statements using named parameters. ... */String sqlToUsesubstituteNamedParameters(...)batchArgs.lengthbuildValueArray(...)int[] columnTypesbuildSqlTypeArray(...)import JdbcDaoSupport/** Extension of JdbcDaoSupport that exposes a NamedParameterJdbcTemplate as well. ... */NamedParameterJdbcTemplate namedParameterJdbcTemplate, ...;/** Create a NamedParameterJdbcTemplate based on the configured JdbcTemplate. */getJdbcTemplate(...)this.namedParameterJdbcTemplatenew NamedParameterJdbcTemplate(...)/** Return a NamedParameterJdbcTemplate wrapping the configured JdbcTemplate. */import PreparedStatementCallbackimport ResultSetExtractorimport RowCallbackHandler/** Interface specifying a basic set of JDBC operations allowing the use ... *//** Expose the classic Spring JdbcTemplate to allow invocation of ... *//** Query given SQL to create a prepared statement from SQL, ... *//** Issue an update via a prepared statement, binding the given arguments. ... *//** Issue an update via a prepared statement, binding the given arguments, ... *//** Executes a batch using the supplied SQL statement with the batch of supplied arguments. ... */import PreparedStatementCreatorimport PreparedStatementCreatorFactoryimport SingleColumnRowMapperimport SqlRowSetResultSetExtractorimport ConcurrentLruCache/** Template class with a basic set of JDBC operations, allowing the use ... */new ConcurrentLruCache<String,ParsedSql>(...)new Function<String,ParsedSql>(...) { ... }parseSqlStatement(...)/** Default maximum number of entries for this template's SQL cache: 256. */JdbcOperations classicJdbcTemplate, ...;/** The JdbcTemplate we are wrapping. */ConcurrentLruCache<String,ParsedSql> parsedSqlCache, ...;/** Cache of original SQL String to ParsedSql representation. *//** Create a new NamedParameterJdbcTemplate for the given {@link DataSource}. ... */this.classicJdbcTemplate/** Create a new NamedParameterJdbcTemplate for the given classic ... *//** Expose the classic Spring JdbcTemplate operations to allow invocation ... *//** Expose the classic Spring {@link JdbcTemplate} itself, if available, ... *//** Specify the maximum number of entries for this template's SQL cache. ... */this.parsedSqlCache/** Return the maximum number of entries for this template's SQL cache. */getJdbcOperations(...)getPreparedStatementCreator(...)new MapSqlParameterSource(...)EmptySqlParameterSource.INSTANCESqlRowSet resultqueryForRowSet(...)PreparedStatementCreator pscnew Consumer<PreparedStatementCreatorFactory>(...) { ... }setGeneratedKeysColumnNames(...)setReturnGeneratedKeys(...)createBatch(...)ParsedSql parsedSqlgetParsedSql(...)PreparedStatementCreatorFactory pscfgetPreparedStatementCreatorFactory(...)newPreparedStatementSetter(...)/** Build a {@link PreparedStatementCreator} based on the given SQL and named parameters. ... */Object[] paramsnewPreparedStatementCreator(...)/** Obtain a parsed representation of the given SQL statement. ... *//** Build a {@link PreparedStatementCreatorFactory} based on the given SQL and named parameters. ... */List<SqlParameter> declaredParametersbuildSqlParameterList(...)new PreparedStatementCreatorFactory(...)/** Helper methods for named parameter parsing. ... */...[] START_SKIP, ...;/** Set of characters that qualify as comment or quotes starting characters. */...[] STOP_SKIP, ...;/** Set of characters that at are the corresponding comment or quotes ending characters. */String PARAMETER_SEPARATORS, ...;/** Set of characters that qualify as parameter separators, ... */...[] separatorIndex, ...;/** An index with separator flags per character code. ... *//** Parse the SQL statement and locate any placeholders or named parameters. ... */// Core methods used by NamedParameterJdbcTemplate and SqlQuery/SqlUpdateSet<String> namedParametersStringBuilder sqlToUseList<ParameterHolder> parameterListnew ArrayList<ParameterHolder>(...)char[] statementint namedParameterCountint unnamedParameterCountint totalParameterCountint escapesnew ParsedSql(...)statement.lengthint skipToPositionskipCommentsAndQuotes(...)addNewNamedParameter(...)addNamedParameter(...)isParameterSeparator(...)deleteCharAt(...)ParameterHolder phgetStartIndex(...)getEndIndex(...)setNamedParameterCount(...)setUnnamedParameterCount(...)setTotalParameterCount(...)new ParameterHolder(...)/** Skip over comments and quoted names present in an SQL statement. ... */START_SKIP.lengthint mboolean endMatchint endPos/** Parse the SQL statement and locate any placeholders or named parameters. Named ... */String originalSqlgetOriginalSql(...)List<String> paramNamesStringBuilder actualSqlint lastIndexint[] indexesgetParameterIndexes(...)Iterator<?> entryIterObject entryItemObject[] expressionListexpressionList.length/** Convert a Map of named parameter values to a corresponding array. ... */Object[] paramArraygetTotalParameterCount(...)getNamedParameterCount(...)getUnnamedParameterCount(...)findParameter(...)new SqlParameterValue(...)/** Find a matching parameter in the given list of declared parameters. ... *//** Determine whether a parameter name ends at the current position, ... *//** Convert parameter types from an SqlParameterSource into a corresponding int array. ... */int[] sqlTypes/** Convert parameter declarations from an SqlParameterSource to a corresponding List of SqlParameters. ... */List<SqlParameter> params// Convenience methods operating on a plain SQL Stringint startIndex, ...;int endIndex, ...;this.startIndexthis.endIndex// Postgres-style "::" casting operator should be skipped// :{x} style parameter// escaped ":" should be skipped// Postgres-style "??", "?|", "?&" operator should be skipped// last comment not closed properly// found character sequence ending comment or quote// character sequence ending comment or quote not found// First pass: Look for named parameter match.// Second pass: Look for parameter index match.// Only accept unnamed parameters for index matches./** Holds information about a parsed SQL statement. ... */String originalSql, ...;List<String> parameterNames, ...;List<int[]> parameterIndexes, ...;int namedParameterCount, ...;int unnamedParameterCount, ...;int totalParameterCount, ...;/** Create a new instance of the {@link ParsedSql} class. ... */this.originalSql/** Return the SQL statement that is being parsed. *//** Add a named parameter parsed from this SQL statement. ... */this.parameterIndexes/** Return all of the parameters (bind variables) in the parsed SQL statement. ... *//** Return the parameter indexes for the specified parameter. ... *//** Set the count of named parameters in the SQL statement. ... */this.namedParameterCount/** Return the count of named parameters in the SQL statement. ... *//** Set the count of all of the unnamed parameters in the SQL statement. */this.unnamedParameterCount/** Return the count of all of the unnamed parameters in the SQL statement. *//** Set the total count of all of the parameters in the SQL statement. ... */this.totalParameterCount/** Return the total count of all of the parameters in the SQL statement. ... *//** Exposes the original SQL String. *//** Interface that defines common functionality for objects that can ... *//** Determine whether there is a value for the specified named parameter. ... *//** Return the parameter value for the requested named parameter. ... *//** Determine the SQL type for the specified named parameter. ... *//** Determine the type name for the specified named parameter. ... *//** Enumerate all available parameter names if possible. ... *//** Class that provides helper methods for the use of {@link SqlParameterSource}, ... *//** Create an array of {@link SqlParameterSource} objects populated with data ... */SqlParameterSource[] batchnew SqlParameterSource[]new BeanPropertySqlParameterSource(...)/** Create an array of {@link MapSqlParameterSource} objects populated with data from ... */valueMaps.length/** Create a wrapped value if parameter has type information, plain object if not. ... */SqlParameterSource.TYPE_UNKNOWN/** Create a Map of case insensitive parameter names together with the original name. ... *//** JdbcTemplate variant with named parameter support. ... *//** Provides the core JDBC framework, based on JdbcTemplate ... */import CallableStatementCreatorimport CallableStatementCreatorFactoryimport CallMetaDataContext/** Abstract class to provide base functionality for easy stored procedure calls ... */new CallMetaDataContext(...)new LinkedHashMap<String,RowMapper<?>>(...)JdbcTemplate jdbcTemplate, ...;/** Lower-level class used to execute SQL. */CallMetaDataContext callMetaDataContext, ...;/** Context used to retrieve and manage database meta-data. *//** List of SqlParameter objects. */Map<String,RowMapper<?>> declaredRowMappers, ...;/** List of RefCursor/ResultSet RowMapper objects. */boolean compiled, ...;/** Has this operation been compiled? Compilation means at least checking ... *//** The generated string used for call statement. */CallableStatementCreatorFactory callableStatementFactory, ...;/** A delegate enabling us to create CallableStatementCreators ... *//** Constructor to be used when initializing using a {@link DataSource}. ... */this.jdbcTemplate/** Constructor to be used when initializing using a {@link JdbcTemplate}. ... *//** Get the configured {@link JdbcTemplate}. *//** Set the name of the stored procedure. */setProcedureName(...)this.callMetaDataContext/** Get the name of the stored procedure. *//** Set the names of in parameters to be used. */setLimitedInParameterNames(...)/** Get the names of in parameters to be used. */getLimitedInParameterNames(...)/** Set the catalog name to use. *//** Get the catalog name used. *//** Set the schema name to use. *//** Get the schema name used. *//** Specify whether this call is a function call. ... */setFunction(...)/** Is this call a function call? *//** Specify whether the call requires a return value. ... */setReturnValueRequired(...)/** Does the call require a return value? */setNamedBinding(...)/** Should parameters be bound by name? ... *//** Specify whether the parameter meta-data for the call should be used. ... */setAccessCallParameterMetaData(...)/** Get the call string that should be used based on parameters and meta-data. *//** Get the {@link CallableStatementCreatorFactory} being used. */this.callableStatementFactory/** Add a declared parameter to the list of parameters for the call. ... *//** Add a {@link org.springframework.jdbc.core.RowMapper} for the specified parameter or column. ... */this.declaredRowMappers/** Compile this JdbcCall using provided parameters and meta-data plus other settings. ... */// Methods handling compilation issuesisCompiled(...)compileInternal(...)this.compiled/** Delegate method to perform the actual compilation. ... */initializeMetaData(...)new BiConsumer<String,RowMapper<?>>(...) { ... }createReturnResultSetParameter(...)processParameters(...)createCallString(...)new CallableStatementCreatorFactory(...)getCallParameters(...)onCompileInternal(...)/** Hook method that subclasses may override to react to compilation. ... *//** Is this operation "compiled"? ... *//** Check whether this operation has been compiled already; ... *//** Delegate method that executes the call using the passed-in {@link SqlParameterSource}. ... */// Methods handling executionMap<String,Object> paramsmatchInParameterValuesWithCallParameters(...)checkCompiled(...)executeCallInternal(...)/** Delegate method that executes the call using the passed-in array of parameters. ... */Map<String,?> params/** Delegate method that executes the call using the passed-in Map of parameters. ... *//** Delegate method to perform the actual call processing. */CallableStatementCreator cscnewCallableStatementCreator(...)getCallableStatementFactory(...)getCallString(...)/** Get the name of a single out parameter or return value. ... */getScalarOutParameterName(...)/** Get a List of all the call parameters to be used for call. ... *//** Match the provided in parameter values with registered parameters and ... */// Iterate over the declared RowMappers and register the corresponding SqlParameterimport DataIntegrityViolationExceptionimport ConnectionCallbackimport TableMetaDataContextimport GeneratedKeyHolder/** Abstract class to provide base functionality for easy inserts ... */new TableMetaDataContext(...)TableMetaDataContext tableMetaDataContext, ...;List<String> declaredColumns, ...;/** List of column names to be used in insert statement. */...[] generatedKeyNames, ...;/** The names of the columns holding the generated key. */String insertString, ...;/** The generated string used for insert statement. */...[] insertTypes, ...;/** The SQL type information for the insert columns. */// Methods dealing with configuration properties/** Set the name of the table for this insert. */checkIfConfigurationModificationIsAllowed(...)this.tableMetaDataContext/** Get the name of the table for this insert. *//** Set the name of the schema for this insert. *//** Get the name of the schema for this insert. *//** Set the name of the catalog for this insert. *//** Get the name of the catalog for this insert. *//** Set the names of the columns to be used. */this.declaredColumns/** Get the names of the columns used. *//** Specify the name of a single generated key column. */this.generatedKeyNames/** Set the names of any generated keys. *//** Get the names of any generated keys. */setAccessTableColumnMetaData(...)/** Specify whether the default for including synonyms should be changed. ... */setOverrideIncludeSynonymsDefault(...)/** Get the insert string to be used. */this.insertString/** Get the array of {@link java.sql.Types} to be used for insert. */this.insertTypes/** Compile this JdbcInsert using provided parameters and meta-data plus other settings. ... */processMetaData(...)getColumnNames(...)getGeneratedKeyNames(...)createInsertString(...)createInsertTypes(...)/** Method to check whether we are allowed to make any configuration changes at this time. ... *//** Delegate method that executes the insert using the passed-in Map of parameters. ... */matchInParameterValuesWithInsertColumns(...)executeInsertInternal(...)/** Delegate method that executes the insert using the passed-in {@link SqlParameterSource}. ... *//** Delegate method to execute the insert. */getInsertString(...)getInsertTypes(...)/** Method that provides execution of the insert using the passed-in ... */executeInsertAndReturnKeyInternal(...)executeInsertAndReturnKeyHolderInternal(...)/** Delegate method to execute the insert, generating a single key. */KeyHolder khnew DataIntegrityViolationException(...)/** Delegate method to execute the insert, generating any number of keys. */KeyHolder keyHoldernew GeneratedKeyHolder(...)new PreparedStatementCreator(...) { ... }prepareStatementForGeneratedKeys(...)setParameterValues(...)String keyQuerynew InvalidDataAccessResourceUsageException(...)getGeneratedKeyNames(...).lengthLong keyMap<String,Object> keysnew ConnectionCallback<Object>(...) { ... }Statement keyStmt/** Create a PreparedStatement to be used for an insert operation with generated keys. ... */Statement.RETURN_GENERATED_KEYS/** Delegate method that executes a batch insert using the passed-in Maps of parameters. ... */List<List<Object>> batchValuesnew ArrayList<List<Object>>(...)batch.lengthMap<String,?> argsexecuteBatchInternal(...)/** Delegate method that executes a batch insert using the passed-in {@link SqlParameterSource SqlParameterSources}. ... */SqlParameterSource parameterSource/** Delegate method to execute the batch insert. *//** Internal implementation for setting parameter values. ... *//** Match the provided in parameter values with registered parameters and parameters ... */// This is a hack to be able to get the generated key from a database that doesn't support// get generated keys feature. HSQL is one, PostgreSQL is another. Postgres uses a RETURNING// clause while HSQL uses a second query that has to be executed with the same connection.// Do the insert//Get the key/** A SimpleJdbcCall is a multi-threaded, reusable object representing a call ... *//** Constructor that takes one parameter with the JDBC DataSource to use when ... *//** Alternative Constructor that takes one parameter with the JdbcTemplate to be used. ... */SqlParameter sqlParameteraddDeclaredParameter(...)setInParameterNames(...)addDeclaredRowMapper(...)/** Interface specifying the API for a Simple JDBC Call implemented by {@link SimpleJdbcCall}. ... *//** Specify the procedure name to be used - this implies that we will be calling a stored procedure. ... *//** Specify the procedure name to be used - this implies that we will be calling a stored function. ... *//** Optionally, specify the name of the schema that contins the stored procedure. ... *//** Optionally, specify the name of the catalog that contins the stored procedure. ... *//** Indicates the procedure's return value should be included in the results returned. ... *//** Specify one or more parameters if desired. These parameters will be supplemented with ... *//** Not used yet. *//** Used to specify when a ResultSet is returned by the stored procedure and you want it ... *//** Turn off any processing of parameter meta-data information obtained via JDBC. ... *//** Indicates that parameters should be bound by name. ... *//** Execute the stored function and return the results obtained as an Object of the ... *//** Execute the stored procedure and return the single out parameter as an Object ... *//** Execute the stored procedure and return a map of output params, keyed by name ... *//** A SimpleJdbcInsert is a multi-threaded, reusable object providing easy insert ... *//** Constructor that takes one parameter with the JDBC DataSource to use when creating the ... */setColumnNames(...)setGeneratedKeyNames(...)doExecuteAndReturnKey(...)doExecuteAndReturnKeyHolder(...)doExecuteBatch(...)/** Interface specifying the API for a Simple JDBC Insert implemented by {@link SimpleJdbcInsert}. ... *//** Specify the table name to be used for the insert. ... *//** Specify the schema name, if any, to be used for the insert. ... *//** Specify the catalog name, if any, to be used for the insert. ... *//** Specify the column names that the insert statement should be limited to use. ... *//** Specify the names of any columns that have auto generated keys. ... *//** Turn off any processing of column meta-data information obtained via JDBC. ... *//** Include synonyms for the column meta-data lookups via JDBC. ... *//** Execute the insert using the values passed in. ... *//** Execute the insert using the values passed in and return the generated key. ... *//** Execute the insert using the values passed in and return the generated keys. ... *//** Execute a batch insert using the batch of values passed in. ... *//** Simplification layer for table inserts and stored procedure calls. ... */import InterruptibleBatchPreparedStatementSetter/** Abstract implementation of the {@link InterruptibleBatchPreparedStatementSetter} ... */boolean exhausted, ...;/** This implementation calls {@link #setValuesIfAvailable} ... */this.exhaustedsetValuesIfAvailable(...)/** This implementation return this instance's current exhaustion flag. *//** This implementation returns {@code Integer.MAX_VALUE}. ... *//** Check for available values and set them on the given PreparedStatement. ... */import LobCreatorimport LobHandler/** Abstract {@link PreparedStatementCallback} implementation that manages a {@link LobCreator}. ... */LobHandler lobHandler, ...;/** Create a new AbstractLobCreatingPreparedStatementCallback for the ... */this.lobHandlerLobCreator lobCreatorgetLobCreator(...)/** Set values on the given PreparedStatement, using the given ... */import EmptyResultDataAccessExceptionimport LobRetrievalFailureException/** Abstract ResultSetExtractor implementation that assumes streaming of LOB data. ... *//** Delegates to handleNoRowFound, handleMultipleRowsFound and streamData, ... */handleNoRowFound(...)streamData(...)handleMultipleRowsFound(...)new LobRetrievalFailureException(...)/** Handle the case where the ResultSet does not contain a row. ... */new EmptyResultDataAccessException(...)/** Handle the case where the ResultSet contains multiple rows. ... */new IncorrectResultSizeDataAccessException(...)/** Stream LOB content from the given ResultSet to some OutputStream. ... *//** Abstract implementation of the SqlTypeValue interface, for convenient ... */createTypeValue(...)/** Create the type value to be passed into {@code PreparedStatement.setObject}. ... *//** Bean definition reader that reads values from a database table, ... */PropertiesBeanDefinitionReader propReader, ...;/** Create a new JdbcBeanDefinitionReader for the given bean factory, ... */this.propReader/** Create a new JdbcBeanDefinitionReader that delegates to the ... *//** Set the DataSource to use to obtain database connections. ... *//** Set the JdbcTemplate to be used by this bean factory. ... *//** Load bean definitions from the database via the given SQL string. ... */new RowCallbackHandler(...) { ... }// Make a properties entry by combining bean name and property.import DaoSupportimport CannotGetJdbcConnectionExceptionimport SQLExceptionTranslator/** Convenient super class for JDBC-based data access objects. ... *//** Set the JDBC DataSource to be used by this DAO. */createJdbcTemplate(...)initTemplateConfig(...)/** Create a JdbcTemplate for the given DataSource. ... *//** Return the JDBC DataSource used by this DAO. *//** Set the JdbcTemplate for this DAO explicitly, ... *//** Return the JdbcTemplate for this DAO, ... *//** Initialize the template-based configuration of this DAO. ... *//** Return the SQLExceptionTranslator of this DAO's JdbcTemplate, ... *//** Get a JDBC Connection, either from the current transaction or a new one. ... *//** Close the given JDBC Connection, created via this DAO's DataSource, ... */import DisposableSqlTypeValueimport DefaultLobHandler/** Object to represent an SQL BLOB/CLOB value parameter. BLOBs can either be an ... */LobCreator lobCreator, ...;/** This contains a reference to the LobCreator - so we can close it ... *//** Create a new BLOB value with the given byte array, ... */new DefaultLobHandler(...)/** Create a new BLOB value with the given byte array. ... */this.lobCreator/** Create a new CLOB value with the given content string, ... *//** Create a new CLOB value with the given content string. ... *//** Create a new BLOB/CLOB value with the given stream, ... *//** Create a new BLOB/CLOB value with the given stream. ... *//** Create a new CLOB value with the given character stream, ... *//** Create a new CLOB value with the given character stream. ... *//** Set the specified content via the LobCreator. */setBlobAsBytes(...)setBlobAsBinaryStream(...)setClobAsString(...)setClobAsAsciiStream(...)setClobAsCharacterStream(...)/** Close the LobCreator, if any. *//** Classes supporting the {@code org.springframework.jdbc.core} package. ... *//** Abstract base class for Spring's {@link javax.sql.DataSource} ... *//** Returns 0, indicating the default system timeout is to be used. *//** Setting a login timeout is not supported. *//** LogWriter methods are not supported. */// Implementation of JDBC 4.0's Wrapper interface// Implementation of JDBC 4.1's getParentLogger methodLogger.GLOBAL_LOGGER_NAME/** Abstract base class for JDBC {@link javax.sql.DataSource} implementations ... */String url, ...;String catalog, ...;String schema, ...;Properties connectionProperties, ...;/** Set the JDBC URL to use for connecting through the Driver. ... *//** Return the JDBC URL to use for connecting through the Driver. *//** Set the JDBC username to use for connecting through the Driver. ... *//** Return the JDBC username to use for connecting through the Driver. *//** Set the JDBC password to use for connecting through the Driver. ... *//** Return the JDBC password to use for connecting through the Driver. *//** Specify a database catalog to be applied to each Connection. ... */this.catalog/** Return the database catalog to be applied to each Connection, if any. ... *//** Specify a database schema to be applied to each Connection. ... */this.schema/** Return the database schema to be applied to each Connection, if any. ... *//** Specify arbitrary connection properties as key/value pairs, ... */this.connectionProperties/** Return the connection properties to be passed to the Driver, if any. *//** This implementation delegates to {@code getConnectionFromDriver}, ... */getConnectionFromDriver(...)/** Build properties for the Driver, including the given username and password (if any), ... */Properties connPropsgetConnectionProperties(...)setCatalog(...)setSchema(...)/** Obtain a Connection using the given properties. ... *//** Simple interface to be implemented by handles for a JDBC Connection. ... *//** Fetch the JDBC Connection that this handle refers to. *//** Release the JDBC Connection that this handle refers to. ... */import Savepointimport ResourceHolderSupport/** Resource holder wrapping a JDBC {@link Connection}. ... */String SAVEPOINT_NAME_PREFIX, ...;/** Prefix for savepoint names. */ConnectionHandle connectionHandle, ...;Connection currentConnection, ...;boolean transactionActive, ...;Boolean savepointsSupported, ...;int savepointCounter, ...;/** Create a new ConnectionHolder for the given ConnectionHandle. ... */this.connectionHandle/** Create a new ConnectionHolder for the given JDBC Connection, ... */new SimpleConnectionHandle(...)this.transactionActive/** Return the ConnectionHandle held by this ConnectionHolder. *//** Return whether this holder currently has a Connection. *//** Set whether this holder represents an active, JDBC-managed transaction. ... *//** Return whether this holder represents an active, JDBC-managed transaction. *//** Override the existing Connection handle with the given Connection. ... */this.currentConnection/** Return the current Connection held by this ConnectionHolder. ... *//** Return whether JDBC 3.0 Savepoints are supported. ... */this.savepointsSupportedsupportsSavepoints(...)/** Create a new JDBC 3.0 Savepoint for the current Connection, ... */this.savepointCountersetSavepoint(...)/** Releases the current Connection held by this ConnectionHolder. ... */released(...)/** Subinterface of {@link java.sql.Connection} to be implemented by ... *//** Return the target Connection of this proxy. ... */import CannotCreateTransactionExceptionimport TransactionSystemExceptionimport AbstractPlatformTransactionManagerimport DefaultTransactionStatusimport ResourceTransactionManagerimport TransactionSynchronizationUtils/** {@link org.springframework.transaction.PlatformTransactionManager} ... */boolean enforceReadOnly, ...;/** Create a new DataSourceTransactionManager instance. ... */setNestedTransactionAllowed(...)/** Set the JDBC DataSource that this instance should manage transactions for. ... */getTargetDataSource(...)/** Return the JDBC DataSource that this instance manages transactions for. *//** Obtain the DataSource for actual use. ... *//** Specify whether to enforce the read-only nature of a transaction ... */this.enforceReadOnly/** Return whether to enforce the read-only nature of a transaction ... */DataSourceTransactionObject txObjectnew DataSourceTransactionObject(...)ConnectionHolder conHoldersetSavepointAllowed(...)isNestedTransactionAllowed(...)setConnectionHolder(...)hasConnectionHolder(...)isTransactionActive(...)getConnectionHolder(...)Integer previousIsolationLevelprepareConnectionForTransaction(...)int timeoutdetermineTimeout(...)isSynchronizedWithTransaction(...)Connection newConnew ConnectionHolder(...)setSynchronizedWithTransaction(...)setPreviousIsolationLevel(...)setReadOnly(...)isReadOnly(...)getAutoCommit(...)setMustRestoreAutoCommit(...)setAutoCommit(...)prepareTransactionalConnection(...)setTransactionActive(...)TransactionDefinition.TIMEOUT_DEFAULTsetTimeoutInSeconds(...)isNewConnectionHolder(...)bindResource(...)new CannotCreateTransactionException(...)unbindResource(...)isDebug(...)isMustRestoreAutoCommit(...)resetConnectionAfterTransaction(...)getPreviousIsolationLevel(...)/** Prepare the transactional {@code Connection} right after transaction begin. ... */isEnforceReadOnly(...)/** Translate the given JDBC commit/rollback exception to a common Spring ... */new TransactionSystemException(...)/** DataSource transaction object, representing a ConnectionHolder. ... */boolean newConnectionHolder, ...;boolean mustRestoreAutoCommit, ...;this.newConnectionHolderthis.mustRestoreAutoCommitisRollbackOnly(...)triggerFlush(...)// If we got a TransactionAwareDataSourceProxy, we need to perform transactions// for its underlying target DataSource, else data access code won't see// properly exposed transactions (i.e. transactions for the target DataSource).// Switch to manual commit if necessary. This is very expensive in some JDBC drivers,// so we don't want to do it unnecessarily (for example if we've explicitly// configured the connection pool to set it already).// Bind the connection holder to the thread.// Remove the connection holder from the thread, if exposed.// Reset connection./** Helper class that provides static methods for obtaining JDBC Connections from ... */DataSourceUtils.classint CONNECTION_SYNCHRONIZATION_ORDER, ...;/** Order value for TransactionSynchronization objects that clean up JDBC Connections. *//** Obtain a Connection from the given DataSource. Translates SQLExceptions into ... */new CannotGetJdbcConnectionException(...)/** Actually obtain a JDBC Connection from the given DataSource. ... */fetchConnection(...)hasConnection(...)requested(...)setConnection(...)ConnectionHolder holderToUsenew ConnectionSynchronization(...)/** Actually fetch a {@link Connection} from the given {@link DataSource}, ... *//** Prepare the given Connection with the given transaction semantics. ... */Throwable exToCheckgetIsolationLevel(...)TransactionDefinition.ISOLATION_DEFAULTint currentIsolationgetTransactionIsolation(...)setTransactionIsolation(...)/** Reset the given Connection after a transaction, ... *//** Determine whether the given JDBC Connection is transactional, that is, ... */connectionEquals(...)/** Apply the current transaction timeout, if any, ... *//** Apply the specified timeout - overridden by the current transaction timeout, ... */ConnectionHolder holderhasTimeout(...)setQueryTimeout(...)getTimeToLiveInSeconds(...)/** Close the given Connection, obtained from the given DataSource, ... */doReleaseConnection(...)/** Actually close the given Connection, obtained from the given DataSource. ... */doCloseConnection(...)/** Close the Connection, unless a {@link SmartDataSource} doesn't want us to. ... */shouldClose(...)/** Determine whether the given two Connections are equal, asking the target ... */Connection heldCongetTargetConnection(...)/** Return the innermost target Connection of the given Connection. If the given ... *//** Determine the connection synchronization order to use for the given ... */int orderDataSource currDs/** Callback for resource cleanup at the end of a non-native JDBC transaction ... */ConnectionHolder connectionHolder, ...;boolean holderActive, ...;this.connectionHoldergetConnectionSynchronizationOrder(...)this.holderActiveunbindResourceIfPossible(...)// Else we either got no holder or an empty thread-bound holder here.// Use same Connection for further JDBC actions within the transaction.// Thread-bound object will get removed by synchronization at transaction completion.// Unexpected exception from external delegation call -> close Connection and rethrow.// Set read-only flag.// Assume it's a connection timeout that would otherwise get lost: e.g. from JDBC 4.0// "read-only not supported" SQLException -> ignore, it's just a hint anyway// Apply specific isolation level, if any.// Reset transaction isolation to previous value, if changed for the transaction.// Reset read-only flag if we originally switched it to true on transaction begin.// Reset read-only flag.// Remaining transaction timeout overrides specified value.// No current transaction timeout -> apply specified value.// It's the transactional Connection: Don't close it.// Explicitly check for identity too: for Connection handles that do not implement// "equals" properly, such as the ones Commons DBCP exposes).// Release Connection on suspend if the application doesn't keep// a handle to it anymore. We will fetch a fresh Connection if the// application accesses the ConnectionHolder again after resume,// assuming that it will participate in the same transaction.// Release Connection early if the holder is not open anymore// (that is, not used by another resource like a Hibernate Session// that has its own cleanup via transaction synchronization),// to avoid issues with strict JTA implementations that expect// the close call before transaction completion.// If we haven't closed the Connection in beforeCompletion,// close it now. The holder might have been used for other// cleanup in the meantime, for example by a Hibernate Session.// The thread-bound ConnectionHolder might not be available anymore,// since afterCompletion might get called from a different thread.// Reset the ConnectionHolder: It might remain bound to the thread./** JDBC {@link javax.sql.DataSource} implementation that delegates all calls ... */DataSource targetDataSource, ...;/** Create a new DelegatingDataSource. ... */setTargetDataSource(...)/** Set the target DataSource that this DataSource should delegate to. */this.targetDataSource/** Return the target DataSource that this DataSource should delegate to. *//** Obtain the target {@code DataSource} for actual use (never {@code null}). ... */obtainTargetDataSource(...)getLogWriter(...)setLogWriter(...)getLoginTimeout(...)setLoginTimeout(...)import DriverManager/** Simple implementation of the standard JDBC {@link javax.sql.DataSource} interface, ... *//** Constructor for bean-style configuration. *//** Create a new DriverManagerDataSource with the given JDBC URL, ... */setUrl(...)/** Create a new DriverManagerDataSource with the given standard ... */setConnectionProperties(...)/** Set the JDBC driver class name. This driver will get initialized ... */String driverClassNameToUsegetUrl(...)getConnectionFromDriverManager(...)/** Getting a Connection using the nasty static from DriverManager is extracted ... */import DefaultTransactionDefinition/** An adapter for a target {@link javax.sql.DataSource}, applying the current ... */TransactionDefinition.class/** Constants instance for TransactionDefinition. */Integer isolationLevel, ...;/** Set the default isolation level by the name of the corresponding constant ... */DefaultTransactionDefinition.PREFIX_ISOLATIONsetIsolationLevel(...)/** Specify the default isolation level to use for Connection retrieval, ... */this.isolationLevel/** Return the statically specified isolation level, ... *//** Applies the current isolation level value and read-only flag ... */Boolean readOnlyToUsegetCurrentReadOnlyFlag(...)Integer isolationLevelToUsegetCurrentIsolationLevel(...)/** Determine the current isolation level: either the transaction's ... */getCurrentTransactionIsolationLevel(...)/** Determine the current read-only flag: by default, ... */boolean txReadOnlyisCurrentTransactionReadOnly(...)import NestedTransactionNotSupportedExceptionimport SavepointManagerimport TransactionUsageExceptionimport SmartTransactionObject/** Convenient base class for JDBC-aware transaction objects. Can contain a ... */JdbcTransactionObjectSupport.classInteger previousIsolationLevel, ...;boolean readOnly, ...;boolean savepointAllowed, ...;/** Set the ConnectionHolder for this transaction object. *//** Return the ConnectionHolder for this transaction object. *//** Check whether this transaction object has a ConnectionHolder. *//** Set the previous isolation level to retain, if any. */this.previousIsolationLevel/** Return the retained previous isolation level, if any. *//** Set the read-only status of this transaction. ... */this.readOnly/** Return the read-only status of this transaction. ... *//** Set whether savepoints are allowed within this transaction. ... */this.savepointAllowed/** Return whether savepoints are allowed within this transaction. *//** This implementation creates a JDBC 3.0 Savepoint and returns it. ... */// Implementation of SavepointManagergetConnectionHolderForSavepoint(...)new NestedTransactionNotSupportedException(...)createSavepoint(...)/** This implementation rolls back to the given JDBC 3.0 Savepoint. ... */resetRollbackOnly(...)/** This implementation releases the given JDBC 3.0 Savepoint. ... */releaseSavepoint(...)isSavepointAllowed(...)new TransactionUsageException(...)/** Proxy for a target DataSource, fetching actual JDBC Connections lazily, ... */LazyConnectionDataSourceProxy.classBoolean defaultAutoCommit, ...;Integer defaultTransactionIsolation, ...;/** Create a new LazyConnectionDataSourceProxy. ... *//** Set the default auto-commit mode to expose when no target Connection ... */this.defaultAutoCommit/** Set the default transaction isolation level to expose when no target Connection ... */this.defaultTransactionIsolation/** Set the default transaction isolation level by the name of the corresponding ... */setDefaultTransactionIsolation(...)checkDefaultConnectionProperties(...)/** Check the default connection properties (auto-commit, transaction isolation), ... *//** Expose the default auto-commit value. *//** Expose the default transaction isolation value. *//** Return a Connection handle that lazily fetches an actual JDBC Connection ... */new LazyConnectionInvocationHandler(...)/** Invocation handler that defers fetching an actual JDBC Connection ... */ResultSet.CLOSE_CURSORS_AT_COMMITBoolean autoCommit, ...;Integer transactionIsolation, ...;int holdability, ...;this.autoCommitdefaultAutoCommit(...)this.transactionIsolationdefaultTransactionIsolation(...)hasTargetConnection(...)this.holdability/** Return whether the proxy currently holds a target Connection. *//** Return the target Connection, fetching it and initializing it if necessary. */// Determine default auto-commit and transaction isolation// via a Connection from the target DataSource, if possible.// We must avoid fetching a target Connection for "equals".// We must avoid fetching a target Connection for "hashCode",// and we must return the same hash code even when the target// Connection has been fetched: use hashCode of Connection proxy.// Handle getTargetConnection method: return underlying connection.// No physical target Connection kept yet ->// resolve transaction demarcation methods without fetching// a physical JDBC Connection until absolutely necessary.// Else fetch actual Connection and check there,// because we didn't have a default specified.// Ignore: no statements created yet.// Ignore: no warnings to expose yet.// Ignore: no target connection yet.// Connection proxy closed, without ever having fetched a// physical JDBC Connection: throw corresponding SQLException.// Target Connection already fetched,// or target Connection necessary for current operation ->// invoke method on target connection.// No target Connection held -> fetch one.// Fetch physical Connection from DataSource.// If we still lack default connection properties, check them now.// Apply kept transaction settings, if any.// "read-only not supported" -> ignore, it's just a hint anyway// Target Connection already held -> return it./** Simple implementation of the {@link ConnectionHandle} interface, ... */Connection connection, ...;/** Create a new SimpleConnectionHandle for the given Connection. ... *//** Return the specified Connection as-is. */import DriverDriver driver, ...;/** Create a new DriverManagerDataSource with the given standard Driver parameters. ... */setDriver(...)/** Specify the JDBC Driver implementation class to use. ... */this.driver/** Specify the JDBC Driver instance to use. ... *//** Return the JDBC Driver instance to use. */Driver drivergetDriver(...)/** Implementation of {@link SmartDataSource} that wraps a single JDBC Connection ... */boolean suppressClose, ...;/** Create a close-suppressing proxy?. *//** Override auto-commit state?. *//** Wrapped Connection. *//** Proxy Connection. */Object connectionMonitor, ...;/** Synchronization monitor for the shared Connection. *//** Create a new SingleConnectionDataSource with the given standard ... */this.suppressClose/** Create a new SingleConnectionDataSource with a given Connection. ... */getCloseSuppressingConnectionProxy(...)/** Set whether the returned Connection should be a close-suppressing proxy ... *//** Return whether the returned Connection will be a close-suppressing proxy ... *//** Set whether the returned Connection's "autoCommit" setting should be overridden. *//** Return whether the returned Connection's "autoCommit" setting should be overridden. ... */this.connectionMonitorinitConnection(...)isClosed(...)/** Specifying a custom username and password doesn't make sense ... *//** This is a single Connection: Do not close it when returning to the "pool". *//** Close the underlying Connection. ... */closeConnection(...)/** Initialize the underlying Connection via the DriverManager. */prepareConnection(...)isSuppressClose(...)/** Reset the underlying shared Connection, to be reinitialized on next access. *//** Prepare the given Connection before it is exposed. ... */Boolean autoCommitgetAutoCommitValue(...)/** Close the underlying shared Connection. *//** Wrap the given Connection with a proxy that delegates every method call to it ... *//** Invocation handler that suppresses close calls on JDBC Connections. */// No underlying Connection -> lazy init via DriverManager.// Use hashCode of Connection proxy.// Handle close method: don't pass the call on./** Extension of the {@code javax.sql.DataSource} interface, to be ... *//** Should we close this Connection, obtained from this DataSource? ... *//** Proxy for a target JDBC {@link javax.sql.DataSource}, adding awareness of ... */boolean reobtainTransactionalConnections, ...;/** Create a new TransactionAwareDataSourceProxy. ... *//** Specify whether to reobtain the target Connection for each operation ... */this.reobtainTransactionalConnections/** Delegates to DataSourceUtils for automatically participating in Spring-managed ... */getTransactionAwareConnectionProxy(...)/** Wraps the given Connection with a proxy that delegates every method call to it ... */new TransactionAwareInvocationHandler(...)/** Determine whether to obtain a fixed target Connection for the proxy ... *//** Invocation handler that delegates close calls on JDBC Connections ... */Connection actualTargetshouldObtainFixedConnection(...)applyTransactionTimeout(...)// Only considered as equal when proxies are identical.// Allow for differentiating between the proxy and the raw Connection.// Handle close method: only close if not within a transaction.// Avoid creation of target Connection on pre-close cleanup (e.g. Hibernate Session)// If return value is a Statement, apply transaction timeout.// Applies to createStatement, prepareStatement, prepareCall./** An adapter for a target JDBC {@link javax.sql.DataSource}, applying the specified ... */new NamedThreadLocal<JdbcUserCredentials>(...)ThreadLocal<JdbcUserCredentials> threadBoundCredentials, ...;/** Set the default username that this adapter should use for retrieving Connections. ... *//** Set the default user's password that this adapter should use for retrieving Connections. ... *//** Specify a database catalog to be applied to each retrieved Connection. ... *//** Specify a database schema to be applied to each retrieved Connection. ... *//** Set user credententials for this proxy and the current thread. ... */this.threadBoundCredentialsnew JdbcUserCredentials(...)/** Remove any user credentials for this proxy from the current thread. ... *//** Determine whether there are currently thread-bound credentials, ... */JdbcUserCredentials threadCredentialsthreadCredentials.usernamethreadCredentials.password/** Simply delegates to {@link #doGetConnection(String, String)}, ... *//** This implementation delegates to the {@code getConnection(username, password)} ... *//** Inner class used as ThreadLocal value. *//** {@link DataSource} implementation that delegates all calls to a WebSphere ... */Class<?> wsDataSourceClass, ...;Method newJdbcConnSpecMethod, ...;Method wsDataSourceGetConnectionMethod, ...;Method setTransactionIsolationMethod, ...;Method setReadOnlyMethod, ...;Method setUserNameMethod, ...;Method setPasswordMethod, ...;/** This constructor retrieves the WebSphere JDBC connection spec API, ... */Class<?> jdbcConnSpecClassClass<?> wsrraFactoryClassthis.wsDataSourceClassthis.newJdbcConnSpecMethodthis.wsDataSourceGetConnectionMethodthis.setTransactionIsolationMethodthis.setReadOnlyMethodthis.setUserNameMethodthis.setPasswordMethod/** Checks that the specified 'targetDataSource' actually is ... *//** Builds a WebSphere JDBCConnectionSpec object for the current settings ... */Object connSpeccreateConnectionSpec(...)invokeJdbcMethod(...)/** Create a WebSphere {@code JDBCConnectionSpec} object for the given characteristics. ... */// Create JDBCConnectionSpec using current isolation level value and read-only flag.// Create Connection through invoking WSDataSource.getConnection(JDBCConnectionSpec)// If the username is empty, we'll simply let the target DataSource// use its default credentials./** Base class for {@link EmbeddedDatabaseConfigurer} implementations ... *//** {@code ConnectionProperties} serves as a simple data container that allows ... *//** Set the JDBC driver class to use to connect to the database. ... *//** Set the JDBC connection URL for the database. ... *//** Set the username to use to connect to the database. ... *//** Set the password to use to connect to the database. ... *//** {@code DataSourceFactory} encapsulates the creation of a particular ... *//** Get the {@linkplain ConnectionProperties connection properties} ... *//** Get the {@link DataSource} with the ... */import EmbeddedDriver/** {@link EmbeddedDatabaseConfigurer} for the Apache Derby database. ... */String URL_TEMPLATE, ...;DerbyEmbeddedDatabaseConfigurer instance, ...;/** Get the singleton {@link DerbyEmbeddedDatabaseConfigurer} instance. ... */OutputStreamFactory.classnew DerbyEmbeddedDatabaseConfigurer(...)setDriverClass(...)EmbeddedDriver.classnew EmbeddedDriver(...)// disable log file// Error code that indicates successful shutdown/** {@code EmbeddedDatabase} serves as a handle to an embedded database instance. ... *//** Shut down this embedded database. */import ScriptUtils/** A builder that provides a convenient API for constructing an embedded database. ... */EmbeddedDatabaseFactory databaseFactory, ...;ResourceDatabasePopulator databasePopulator, ...;/** Create a new embedded database builder with a {@link DefaultResourceLoader}. *//** Create a new embedded database builder with the given {@link ResourceLoader}. ... */this.databaseFactorynew EmbeddedDatabaseFactory(...)this.databasePopulatornew ResourceDatabasePopulator(...)/** Specify whether a unique ID should be generated and used as the database name. ... */setGenerateUniqueDatabaseName(...)/** Set the name of the embedded database. ... *//** Set the type of embedded database. ... *//** Set the factory to use to create the {@link DataSource} instance that ... */setDataSourceFactory(...)/** Add default SQL scripts to execute to populate the database. ... */addScripts(...)/** Add an SQL script to execute to initialize or populate the database. ... */addScript(...)/** Add multiple SQL scripts to execute to initialize or populate the database. ... */String script/** Specify the character encoding used in all SQL scripts, if different from ... */setSqlScriptEncoding(...)/** Specify the statement separator used in all SQL scripts, if a custom one. ... */setSeparator(...)/** Specify the single-line comment prefix used in all SQL scripts. ... */setCommentPrefix(...)/** Specify the prefixes that identify single-line comments within all SQL scripts. ... */setCommentPrefixes(...)/** Specify the start delimiter for block comments in all SQL scripts. ... */setBlockCommentStartDelimiter(...)/** Specify the end delimiter for block comments in all SQL scripts. ... */setBlockCommentEndDelimiter(...)/** Specify that all failures which occur while executing SQL scripts should ... */setContinueOnError(...)/** Specify that a failed SQL {@code DROP} statement within an executed ... */setIgnoreFailedDrops(...)/** Build the embedded database. ... */getDatabase(...)/** {@code EmbeddedDatabaseConfigurer} encapsulates the configuration required to ... *//** Configure the properties required to create and connect to the embedded database. ... *//** Shut down the embedded database instance that backs the supplied {@link DataSource}. ... *//** Maps well-known {@linkplain EmbeddedDatabaseType embedded database types} ... *//** Return a configurer instance for the given embedded database type. ... */import SimpleDriverDataSourceimport DatabasePopulatorimport DatabasePopulatorUtils/** Factory for creating an {@link EmbeddedDatabase} instance. ... */new SimpleDriverDataSourceFactory(...)EmbeddedDatabaseFactory.classString DEFAULT_DATABASE_NAME, ...;/** Default name for an embedded database: {@value}. */boolean generateUniqueDatabaseName, ...;String databaseName, ...;DataSourceFactory dataSourceFactory, ...;EmbeddedDatabaseConfigurer databaseConfigurer, ...;DatabasePopulator databasePopulator, ...;/** Set the {@code generateUniqueDatabaseName} flag to enable or disable ... */this.generateUniqueDatabaseName/** Set the name of the database. ... */this.databaseNamethis.dataSourceFactory/** Set the type of embedded database to use. ... */this.databaseConfigurergetConfigurer(...)/** Set the strategy that will be used to configure the embedded database instance. ... *//** Set the strategy that will be used to initialize or populate the embedded ... *//** Factory method that returns the {@linkplain EmbeddedDatabase embedded database} ... */initDatabase(...)new EmbeddedDataSourceProxy(...)/** Hook to initialize the embedded database. ... */configureConnectionProperties(...)SimpleDriverDataSource simpleDriverDataSourceshutdownDatabase(...)/** Hook to shutdown the embedded database. Subclasses may call this method ... *//** Hook that gets the {@link DataSource} that provides the connectivity to the ... */// getParentLogger() is required for JDBC 4.1 compatibility// Create the embedded database first// Now populate the database// failed to populate, so leave it as not initialized/** A subclass of {@link EmbeddedDatabaseFactory} that implements {@link FactoryBean} ... */DatabasePopulator databaseCleaner, ...;/** Set a script execution to be run in the bean destruction callback, ... */this.databaseCleaner/** A supported embedded database type. ... */new EmbeddedDatabaseType(...)EmbeddedDatabaseType HSQL, ...;/** The <a href="http://hsqldb.org">Hypersonic</a> Embedded Java SQL Database. */EmbeddedDatabaseType H2, ...;/** The <a href="https://h2database.com">H2</a> Embedded Java SQL Database Engine. */EmbeddedDatabaseType DERBY, ...;/** The <a href="https://db.apache.org/derby">Apache Derby</a> Embedded SQL Database. *//** {@link EmbeddedDatabaseConfigurer} for an H2 embedded database instance. ... */H2EmbeddedDatabaseConfigurer instance, ...;Class<? extends Driver> driverClass, ...;/** Get the singleton {@code H2EmbeddedDatabaseConfigurer} instance. ... */new H2EmbeddedDatabaseConfigurer(...)H2EmbeddedDatabaseConfigurer.classthis.driverClass/** {@link EmbeddedDatabaseConfigurer} for an HSQL embedded database instance. ... */HsqlEmbeddedDatabaseConfigurer instance, ...;/** Get the singleton {@link HsqlEmbeddedDatabaseConfigurer} instance. ... */new HsqlEmbeddedDatabaseConfigurer(...)HsqlEmbeddedDatabaseConfigurer.class/** Internal helper for exposing dummy OutputStreams to embedded databases ... *//** Returns an {@link java.io.OutputStream} that ignores all data given to it. */new OutputStream(...) { ... }// ignore the output/** Creates a {@link SimpleDriverDataSource}. ... */new SimpleDriverDataSource(...)SimpleDriverDataSource dataSource, ...;new ConnectionProperties(...) { ... }/** Provides extensible support for creating embedded database instances. *//** Thrown by {@link ScriptUtils} if an SQL script cannot be read. ... *//** Construct a new {@code CannotReadScriptException}. ... *//** Composite {@link DatabasePopulator} that delegates to a list of given ... */new ArrayList<DatabasePopulator>(...)List<DatabasePopulator> populators, ...;/** Create an empty {@code CompositeDatabasePopulator}. ... *//** Create a {@code CompositeDatabasePopulator} with the given populators. ... */this.populators/** Specify one or more populators to delegate to. *//** Add one or more populators to the list of delegates. */DatabasePopulator populator/** Used to {@linkplain #setDatabasePopulator set up} a database during ... *//** The {@link DataSource} for the database to populate when this component ... *//** Set the {@link DatabasePopulator} to execute during the bean initialization phase. ... *//** Set the {@link DatabasePopulator} to execute during the bean destruction ... *//** Flag to explicitly enable or disable the {@linkplain #setDatabasePopulator ... *//** Use the {@linkplain #setDatabasePopulator database populator} to set up ... *//** Use the {@linkplain #setDatabaseCleaner database cleaner} to clean up the ... *//** Strategy used to populate, initialize, or clean up a database. ... *//** Populate, initialize, or clean up the database using the provided JDBC ... *//** Utility methods for executing a {@link DatabasePopulator}. ... *//** Execute the given {@link DatabasePopulator} against the given {@link DataSource}. ... */Connection connectionnew UncategorizedScriptException(...)/** Populates, initializes, or cleans up a database using SQL scripts defined in ... */ScriptUtils.DEFAULT_STATEMENT_SEPARATORScriptUtils.DEFAULT_COMMENT_PREFIXESScriptUtils.DEFAULT_BLOCK_COMMENT_START_DELIMITERScriptUtils.DEFAULT_BLOCK_COMMENT_END_DELIMITERList<Resource> scripts, ...;String sqlScriptEncoding, ...;...[] commentPrefixes, ...;String blockCommentStartDelimiter, ...;String blockCommentEndDelimiter, ...;boolean continueOnError, ...;boolean ignoreFailedDrops, ...;/** Construct a new {@code ResourceDatabasePopulator} with default settings. ... *//** Construct a new {@code ResourceDatabasePopulator} with default settings ... */setScripts(...)/** Construct a new {@code ResourceDatabasePopulator} with the supplied values. ... */this.continueOnErrorthis.ignoreFailedDrops/** Add a script to execute to initialize or clean up the database. ... */this.scripts/** Add multiple scripts to execute to initialize or clean up the database. ... */assertContentsOfScriptArray(...)/** Set the scripts to execute to initialize or clean up the database, ... *//** Specify the encoding for the configured SQL scripts, ... */this.sqlScriptEncoding/** Specify the statement separator, if a custom one. ... *//** Set the prefix that identifies single-line comments within the SQL scripts. ... */this.commentPrefixes/** Set the prefixes that identify single-line comments within the SQL scripts. ... *//** Set the start delimiter that identifies block comments within the SQL ... */this.blockCommentStartDelimiter/** Set the end delimiter that identifies block comments within the SQL ... */this.blockCommentEndDelimiter/** Flag to indicate that all failures in SQL should be logged but not cause a failure. ... *//** Flag to indicate that a failed SQL {@code DROP} statement can be ignored. ... */Resource scriptEncodedResource encodedScriptexecuteSqlScript(...)/** Execute this {@code ResourceDatabasePopulator} against the given ... */// Ensure that the list is modifiable/** Root of the hierarchy of data access exceptions that are related to processing ... *//** Constructor for {@code ScriptException}. ... *//** Thrown by {@link ScriptUtils} if an SQL script cannot be properly parsed. ... *//** Construct a new {@code ScriptParseException}. ... *//** Thrown by {@link ScriptUtils} if a statement in an SQL script failed when ... *//** Construct a new {@code ScriptStatementFailedException}. ... *//** Build an error message for an SQL script execution failure, ... */import LineNumberReader/** Generic utility methods for working with SQL scripts. ... */ScriptUtils.classString DEFAULT_STATEMENT_SEPARATOR, ...;/** Default statement separator within SQL scripts: {@code ";"}. */String FALLBACK_STATEMENT_SEPARATOR, ...;/** Fallback statement separator within SQL scripts: {@code "\n"}. ... */String EOF_STATEMENT_SEPARATOR, ...;/** End of file (EOF) SQL statement separator: {@code "^^^ END OF SCRIPT ^^^"}. ... */String DEFAULT_COMMENT_PREFIX, ...;/** Default prefix for single-line comments within SQL scripts: {@code "--"}. */...[] DEFAULT_COMMENT_PREFIXES, ...;/** Default prefixes for single-line comments within SQL scripts: {@code ["--"]}. ... */String DEFAULT_BLOCK_COMMENT_START_DELIMITER, ...;/** Default start delimiter for block comments within SQL scripts: {@code "/*"}. */String DEFAULT_BLOCK_COMMENT_END_DELIMITER, ...;/** Default end delimiter for block comments within SQL scripts: <code>"*&#47;"</code>. *//** Split an SQL script into separate statements delimited by the provided ... */splitSqlScript(...)boolean inSingleQuoteboolean inDoubleQuoteboolean inEscapeString commentPrefixstartsWithAny(...)int indexOfNextNewlineint indexOfCommentEndnew ScriptParseException(...)/** Read a script from the given resource, using "{@code --}" as the comment prefix ... */readScript(...)/** Read a script from the provided resource, using the supplied comment prefixes ... */LineNumberReader lnrnew LineNumberReader(...)/** Read a script from the provided {@code LineNumberReader}, using the supplied ... */String[] lineCommentPrefixesString currentStatementStringBuilder scriptBuilderappendSeparatorToScriptIfNecessary(...)/** Does the provided SQL script contain the specified delimiter? ... */boolean inLiteral/** Execute the given SQL script using default settings for statement ... *//** Execute the given SQL script. ... */long startTimeList<String> statementsint stmtNumberlong elapsedTimenew CannotReadScriptException(...)containsSqlScriptDelimiters(...)String statementint rowsAffectedboolean dropStatementnew ScriptStatementFailedException(...)// MySQL style escapes// We've reached the end of the current statement// Skip over any content from the start of the comment to the EOL// If there's no EOL, we must be at the end of the script, so stop here.// Skip over any block comments// Avoid multiple adjacent whitespace characters// separator ends in whitespace, so we might want to see if the script is trying// to end the same way/** Thrown when we cannot determine anything more specific than "something went ... *//** Construct a new {@code UncategorizedScriptException}. ... *//** Provides extensible support for initializing databases through scripts. */import AbstractDataSource/** Abstract {@link javax.sql.DataSource} implementation that routes {@link #getConnection()} ... */new JndiDataSourceLookup(...)Map<Object,Object> targetDataSources, ...;Object defaultTargetDataSource, ...;boolean lenientFallback, ...;DataSourceLookup dataSourceLookup, ...;Map<Object,DataSource> resolvedDataSources, ...;DataSource resolvedDefaultDataSource, ...;/** Specify the map of target DataSources, with the lookup key as key. ... */this.targetDataSources/** Specify the default target DataSource, if any. ... */this.defaultTargetDataSource/** Specify whether to apply a lenient fallback to the default DataSource ... */this.lenientFallback/** Set the DataSourceLookup implementation to use for resolving data source ... */this.dataSourceLookupthis.resolvedDataSourcesObject lookupKeyresolveSpecifiedLookupKey(...)resolveSpecifiedDataSource(...)this.resolvedDefaultDataSource/** Resolve the given lookup key object, as specified in the ... *//** Resolve the specified data source object into a DataSource instance. ... *//** Return the resolved target DataSources that this router manages. ... *//** Return the resolved default target DataSource, if any. ... */determineTargetDataSource(...)/** Retrieve the current target DataSource. Determines the ... */determineCurrentLookupKey(...)/** Determine the current lookup key. This will typically be ... *//** {@link DataSourceLookup} implementation based on a Spring {@link BeanFactory}. ... *//** Create a new instance of the {@link BeanFactoryDataSourceLookup} class. ... */new DataSourceLookupFailureException(...)/** Strategy interface for looking up DataSources by name. ... *//** Retrieve the DataSource identified by the given name. ... */import NonTransientDataAccessException/** Exception to be thrown by a DataSourceLookup implementation, ... *//** Constructor for DataSourceLookupFailureException. ... *//** DataSource that routes to one of various target DataSources based on the ... *//** Supports Integer values for the isolation level constants ... */String constantName/** JNDI-based {@link DataSourceLookup} implementation. ... *//** Simple {@link DataSourceLookup} implementation that relies on a map for doing lookups. ... */new HashMap<String,DataSource>(...)Map<String,DataSource> dataSources, ...;/** Create a new instance of the {@link MapDataSourceLookup} class. *//** Create a new instance of the {@link MapDataSourceLookup} class. ... */setDataSources(...)addDataSource(...)/** Set the {@link Map} of {@link DataSource DataSources}; the keys ... */this.dataSources/** Get the {@link Map} of {@link DataSource DataSources} maintained by this object. ... *//** Add the supplied {@link DataSource} to the map of {@link DataSource DataSources} ... *//** An implementation of the DataSourceLookup that simply wraps a ... *//** Create a new instance of the {@link SingleDataSourceLookup} class. ... *//** Provides a strategy for looking up JDBC DataSources by name. *//** Provides a utility class for easy DataSource access, ... *//** SqlUpdate subclass that performs batch update operations. Encapsulates ... */new ArrayDeque<Object[]>(...)int DEFAULT_BATCH_SIZE, ...;/** Default number of inserts to accumulate before committing a batch (5000). */int batchSize, ...;boolean trackRowsAffected, ...;Deque<Object[]> parameterQueue, ...;List<Integer> rowsAffected, ...;/** Constructor to allow use as a JavaBean. DataSource and SQL ... *//** Construct an update object with a given DataSource and SQL. ... *//** Construct an update object with a given DataSource, SQL ... *//** Construct an update object with a given DataSource, SQL, ... */setBatchSize(...)/** Set the number of statements that will trigger an automatic intermediate ... */this.batchSize/** Set whether to track the rows affected by batch updates performed ... */this.trackRowsAffected/** BatchSqlUpdate does not support BLOB or CLOB parameters. *//** Overridden version of {@code update} that adds the given statement ... */this.parameterQueue/** Trigger any queued update operations to be added as a final batch. ... */resolveSql(...)int rowCountcheckRowsAffected(...)this.rowsAffected/** Return the current number of statements or statement parameters ... *//** Return the number of already executed statements. *//** Return the number of affected rows for all already executed statements. ... *//** Reset the statement parameter queue, the rows affected cache, ... *//** A concrete variant of {@link SqlQuery} which can be configured ... */Class<? extends RowMapper<>> rowMapperClass, ...;/** Set a specific {@link RowMapper} instance to use for this query. ... *//** Set a {@link RowMapper} class for this query, creating a fresh ... */this.rowMapperClass/** Concrete implementation making it possible to define the RDBMS stored procedures ... *//** Reusable query in which concrete subclasses must implement the abstract ... *//** Constructor that allows use as a JavaBean. *//** Convenient constructor with DataSource and SQL string. ... *//** This method is implemented to invoke the simpler mapRow ... *//** Subclasses must implement this method to convert each row of the ... *//** Reusable RDBMS query in which concrete subclasses must implement ... *//** Constructor to allow use as a JavaBean. *//** Implementation of protected abstract method. This invokes the subclass's ... */new RowMapperImpl(...)/** Subclasses must implement this method to convert each row ... *//** Implementation of RowMapper that calls the enclosing ... */Map<?,?> context, ...;/** Use an array results. More efficient if we know how many results to expect. */MappingSqlQueryWithParameters<>.this/** An "RDBMS operation" is a multi-threaded, reusable object representing a query, ... *//** Has this operation been compiled? Compilation means at ... *//** An alternative to the more commonly used {@link #setDataSource} when you want to ... *//** Return the {@link JdbcTemplate} used by this operation object. *//** Set the JDBC {@link DataSource} to obtain connections from. ... *//** Set the fetch size for this RDBMS operation. This is important for processing ... *//** Set the maximum number of rows for this RDBMS operation. This is important ... *//** Set the query timeout for statements that this RDBMS operation executes. ... *//** Set whether to use statements that return a specific type of ResultSet. ... *//** Return whether statements will return a specific type of ResultSet. *//** Set whether to use statements that are capable of returning ... *//** Return whether statements will return updatable ResultSets. *//** Set whether prepared statements should be capable of returning ... *//** Return whether statements should be capable of returning ... *//** Set the column names of the auto-generated keys. ... *//** Return the column names of the auto generated keys. *//** Set the SQL executed by this operation. *//** Subclasses can override this to supply dynamic SQL if they wish, but SQL is ... *//** Resolve the configured SQL for actual use. ... *//** Add anonymous parameters, specifying only their SQL types ... */declareParameter(...)/** Declare a parameter for this operation. ... *//** Add one or more declared parameters. Used for configuring this operation ... *//** Return a list of the declared {@link SqlParameter} objects. *//** Ensures compilation if used in a bean factory. *//** Compile this query. ... *//** Is this operation "compiled"? Compilation, as in JDO, ... *//** Validate the parameters passed to an execute method based on declared parameters. ... */int declaredInParameterssupportsLobParameters(...)validateParameterCount(...)/** Validate the named parameters passed to an execute method based on declared parameters. ... */Map<String,?> paramsToUse/** Validate the given parameter count against the given declared parameters. ... */allowsUnusedParameters(...)/** Subclasses must implement this template method to perform their own compilation. ... *//** Return whether BLOB/CLOB parameters are supported for this kind of operation. ... *//** Return whether this operation accepts additional parameters that are ... */import ParameterMapper/** RdbmsOperation using a JdbcTemplate and representing an SQL-based ... *//** Flag used to indicate that this call is for a function and to ... */boolean sqlReadyForUse, ...;/** Flag used to indicate that the sql for this call should be used exactly as ... *//** Call string as defined in java.sql.CallableStatement. ... *//** Object enabling us to create CallableStatementCreators ... *//** Constructor to allow use as a JavaBean. ... *//** Create a new SqlCall object with SQL, but without parameters. ... */setSql(...)/** Set whether this call is for a function. *//** Return whether this call is for a function. *//** Set whether the SQL can be used as is. */this.sqlReadyForUse/** Return whether the SQL can be used as is. *//** Overridden method to configure the CallableStatementCreatorFactory ... */isSqlReadyForUse(...)List<SqlParameter> parametersgetDeclaredParameters(...)setResultSetType(...)getResultSetType(...)setUpdatableResults(...)isUpdatableResults(...)/** Get the call string. *//** Return a CallableStatementCreator to perform an operation ... *//** SQL "function" wrapper for a query that returns a single row of results. ... */SingleColumnRowMapper<T> rowMapper, ...;setRowsExpected(...)/** Create a new SqlFunction object with SQL, but without parameters. ... *//** Create a new SqlFunction object with SQL and parameters. ... */setTypes(...)/** Create a new SqlFunction object with SQL, parameters and a result type. ... */setResultType(...)/** Specify the type that the result object is required to match. ... *//** This implementation of this method extracts a single value from the ... *//** Convenient method to run the function without arguments. ... *//** Convenient method to run the function with a single int argument. ... *//** Analogous to the SqlQuery.execute([]) method. This is a ... */findObject(...)/** Convenient method to run the function without arguments, ... *//** Analogous to the {@code SqlQuery.findObject(Object[])} method. ... */import PreparedStatementSetterimport NamedParameterUtilsimport ParsedSql/** Operation object representing an SQL-based operation such as a query or update, ... */PreparedStatementCreatorFactory preparedStatementFactory, ...;/** Object enabling us to create PreparedStatementCreators efficiently, ... */ParsedSql cachedSql, ...;/** Parsed representation of the SQL statement. */Object parsedSqlMonitor, ...;/** Monitor for locking the cached representation of the parsed SQL statement. *//** Overridden method to configure the PreparedStatementCreatorFactory ... */this.preparedStatementFactoryisReturnGeneratedKeys(...)getGeneratedKeysColumnNames(...)/** Hook method that subclasses may override to post-process compilation. ... *//** Obtain a parsed representation of this operation's SQL statement. ... */this.parsedSqlMonitorthis.cachedSql/** Return a PreparedStatementSetter to perform an operation ... *//** Return a PreparedStatementCreator to perform an operation ... */import MapSqlParameterSource/** Reusable operation object representing an SQL query. ... *//** The number of rows to expect; if 0, unknown. *//** Convenient constructor with a {@code DataSource} and SQL string. ... *//** Set the number of rows expected. ... *//** Get the number of rows expected. *//** Central execution method. All un-named parameter execution goes through this method. ... */RowMapper<T> rowMappernewRowMapper(...)/** Convenient method to execute without context. ... *//** Convenient method to execute without parameters. ... *//** Convenient method to execute without parameters nor context. *//** Convenient method to execute with a single int parameter and context. ... *//** Convenient method to execute with a single int parameter. ... *//** Convenient method to execute with two int parameters and context. ... *//** Convenient method to execute with two int parameters. ... *//** Convenient method to execute with a single long parameter and context. ... *//** Convenient method to execute with a single long parameter. ... *//** Convenient method to execute with a single String parameter and context. ... *//** Convenient method to execute with a single String parameter. ... *//** Central execution method. All named parameter execution goes through this method. ... */MapSqlParameterSource paramSourcevalidateNamedParameters(...)executeByNamedParam(...)/** Generic object finder method, used by all other {@code findObject} methods. ... */singleResult(...)/** Convenient method to find a single object without context. *//** Convenient method to find a single object given a single int parameter ... *//** Convenient method to find a single object given a single int parameter. *//** Convenient method to find a single object given two int parameters ... *//** Convenient method to find a single object given two int parameters. *//** Convenient method to find a single object given a single long parameter ... *//** Convenient method to find a single object given a single long parameter. *//** Convenient method to find a single object given a single String parameter ... *//** Convenient method to find a single object given a single String parameter. *//** Generic object finder method for named parameters. ... */findObjectByNamedParam(...)/** Subclasses must implement this method to extract an object per row, to be ... */import JdbcUpdateAffectedIncorrectNumberOfRowsException/** Reusable operation object representing an SQL update. ... */int maxRowsAffected, ...;/** Maximum number of rows the update may affect. If more are ... */int requiredRowsAffected, ...;/** An exact number of rows that must be affected. ... *//** Constructs an update object with a given DataSource and SQL. ... */this.maxRowsAffected/** Set the maximum number of rows that may be affected by this update. ... *//** Set the <i>exact</i> number of rows that must be affected by this update. ... */this.requiredRowsAffected/** Check the given number of affected rows against the ... */new JdbcUpdateAffectedIncorrectNumberOfRowsException(...)/** Generic method to execute the update given parameters. ... *//** Method to execute the update given arguments and ... *//** Convenience method to execute an update with no parameters. *//** Convenient method to execute an update given one int arg. *//** Convenient method to execute an update given two int args. *//** Convenient method to execute an update given one long arg. *//** Convenient method to execute an update given two long args. *//** Convenient method to execute an update given one String arg. *//** Convenient method to execute an update given two String args. *//** Generic method to execute the update given named parameters. ... *//** Superclass for object abstractions of RDBMS stored procedures. ... *//** Allow use as a bean. *//** Create a new object wrapper for a stored procedure. ... */setJdbcTemplate(...)/** StoredProcedure parameter Maps are by default allowed to contain ... *//** Declare a parameter. ... *//** Execute the stored procedure with the provided parameter values. This is ... */Map<String,Object> paramsToUseinParams.length/** Execute the stored procedure. Subclasses should define a strongly typed ... *//** Implementation of the superclass template method. This invokes the subclass's ... *//** Subclasses must implement this method to update each row of the ... */updateRow(...)/** The classes in this package represent RDBMS queries, updates, ... *//** The classes in this package make JDBC easier to use and ... *//** Base class for {@link SQLExceptionTranslator} implementations that allow for ... */SQLExceptionTranslator fallbackTranslator, ...;/** Override the default SQL state fallback translator ... */this.fallbackTranslator/** Return the fallback exception translator, if any. *//** Pre-checks the arguments, calls {@link #doTranslate}, and invokes the ... */doTranslate(...)SQLExceptionTranslator fallbackgetFallbackTranslator(...)/** Template method for actually translating the given exception. ... *//** Build a message {@code String} for the given {@link java.sql.SQLException}. ... */// Specific exception match found.// Looking for a fallback.../** JavaBean for holding custom JDBC error codes translation for a particular ... */...[] errorCodes, ...;Class<?> exceptionClass, ...;/** Set the SQL error codes to match. */this.errorCodes/** Return the SQL error codes to match. *//** Set the exception class for the specified error codes. */DataAccessException.classthis.exceptionClass/** Return the exception class for the specified error codes. *//** Registry for custom {@link SQLExceptionTranslator} instances for specific databases. ... */new HashMap<String,SQLExceptionTranslator>(...)Map<String,SQLExceptionTranslator> translators, ...;/** Map registry to hold custom translators specific databases. ... *//** Setter for a Map of {@link SQLExceptionTranslator} references where the key must ... */this.translatorsnew BiConsumer<String,SQLExceptionTranslator>(...) { ... }registerTranslator(...)/** Registry for custom {@link org.springframework.jdbc.support.SQLExceptionTranslator} instances associated with ... */CustomSQLExceptionTranslatorRegistry.classnew CustomSQLExceptionTranslatorRegistry(...)CustomSQLExceptionTranslatorRegistry instance, ...;/** Return the singleton instance. */Map<String,SQLExceptionTranslator> translatorMap, ...;/** Create a new instance of the {@link CustomSQLExceptionTranslatorRegistry} class. ... *//** Register a new custom translator for the specified database name. ... */SQLExceptionTranslator replacedthis.translatorMap/** Find a custom translator for the specified database. ... *//** A callback interface used by the JdbcUtils class. Implementations of this ... *//** Implementations must implement this method to process the meta-data ... *//** Bean that checks if a database has already started up. To be referenced ... */int DEFAULT_INTERVAL, ...;/** The default interval. */int DEFAULT_TIMEOUT, ...;/** The default timeout. */String validationQuery, ...;int interval, ...;int timeout, ...;/** Set the DataSource to validate. *//** Set the SQL query string to use for validation. ... */this.validationQuery/** Set the interval between validation runs (in seconds). ... *//** Set the timeout (in seconds) after which a fatal exception ... *//** Check whether the validation query can be executed on a Connection ... */boolean validatedlong beginTimelong deadLineSQLException latestExfloat restfloat duration/** The standard implementation of the {@link KeyHolder} interface, to be used for ... */List<Map<String,Object>> keyList, ...;/** Create a new GeneratedKeyHolder with a default list. */this.keyList/** Create a new GeneratedKeyHolder with a given list. ... */getKeyAs(...)Iterator<Object> keyIter/** Base class for {@link org.springframework.jdbc.core.JdbcTemplate} and ... */SQLExceptionTranslator exceptionTranslator, ...;boolean lazyInit, ...;/** Set the JDBC DataSource to obtain connections from. *//** Return the DataSource used by this template. *//** Specify the database product name for the DataSource that this accessor uses. ... */this.exceptionTranslatornew SQLErrorCodeSQLExceptionTranslator(...)/** Set the exception translator for this instance. ... *//** Return the exception translator for this instance. ... */SQLExceptionTranslator exceptionTranslatornew SQLExceptionSubclassTranslator(...)new SQLStateSQLExceptionTranslator(...)/** Set whether to lazily initialize the SQLExceptionTranslator for this accessor, ... *//** Return whether to lazily initialize the SQLExceptionTranslator for this accessor. ... *//** Eagerly initialize the exception translator, if demanded, ... *//** {@link JdbcAccessor}-aligned subclass of the plain {@link DataSourceTransactionManager}, ... *//** Create a new JdbcTransactionManager instance. ... *//** Specify the database product name for the DataSource that this transaction manager ... *//** Set whether to lazily initialize the SQLExceptionTranslator for this transaction manager, ... *//** Return whether to lazily initialize the SQLExceptionTranslator for this transaction manager. ... *//** This implementation attempts to use the {@link SQLExceptionTranslator}, ... */import SQLFeatureNotSupportedException/** Generic utility methods for working with JDBC. Mainly for internal use ... */JdbcUtils.classMap<Integer,String> typeNames, ...;/** Close the given JDBC Connection and ignore any thrown exception. ... *//** Close the given JDBC Statement and ignore any thrown exception. ... *//** Close the given JDBC ResultSet and ignore any thrown exception. ... *//** Retrieve a JDBC column value from a ResultSet, using the specified value type. ... */getTimestamp(...)getBlob(...)getClob(...)AbstractMethodError errSQLFeatureNotSupportedException exwasNull(...)/** Retrieve a JDBC column value from a ResultSet, using the most appropriate ... */Blob blobClob clobgetSubString(...)String metaDataClassNamegetColumnClassName(...)/** Extract database meta-data via the given DatabaseMetaDataCallback. ... */DatabaseMetaData metaDataisConnectionTransactional(...)new MetaDataAccessException(...)CannotGetJdbcConnectionException ex/** Call the specified method on DatabaseMetaData for the given DataSource, ... */new DatabaseMetaDataCallback<Object>(...) { ... }DatabaseMetaData.class/** Return whether the given JDBC driver supports JDBC 2.0 batch updates. ... *//** Extract a common name for the target database in use even if ... *//** Check whether the given SQL type is numeric. ... */Types.BITTypes.REAL/** Resolve the standard type name for the given SQL type, if possible. ... *//** Determine the column name to use. The column name is determined based on a ... */getColumnLabel(...)getColumnName(...)/** Convert a column name with underscores to the corresponding property name using "camel case". ... */boolean nextIsUpper// We don't trust the JDBC driver: It might throw RuntimeException or Error.// Explicitly extract typed value, as far as possible.// Enums can either be represented through a String or an enum index value:// leave enum type conversion up to the caller (e.g. a ConversionService)// but make sure that we return nothing other than a String or an Integer.// Defensively convert any Number to an Integer (as needed by our// ConversionService's IntegerToEnumConverterFactory) for use as index// e.g. on Postgres: getObject returns a PGObject but we need a String// Some unknown type desired -> rely on getObject.// Corresponding SQL types for JSR-310 / Joda-Time types, left up// to the caller to convert them (e.g. through a ConversionService).// Fall back to getObject without type specification, again// left up to the caller to convert the value if necessary.// Perform was-null check if necessary (for results that the JDBC driver returns as primitives).// Probably a closed thread-bound Connection - retry against fresh Connection// should only happen in test environments/** Interface for retrieving keys, typically used for auto-generated keys ... *//** Retrieve the first item from the first map, assuming that there is just ... *//** Retrieve the first map of keys. ... *//** Return a reference to the List that contains the keys. ... *//** Exception indicating that something went wrong during JDBC meta-data lookup. ... *//** Constructor for MetaDataAccessException. ... */import CannotAcquireLockExceptionimport CannotSerializeTransactionExceptionimport DeadlockLoserDataAccessExceptionimport PermissionDeniedDataAccessExceptionimport TransientDataAccessResourceExceptionimport BadSqlGrammarException/** Implementation of {@link SQLExceptionTranslator} that analyzes vendor-specific error codes. ... */int MESSAGE_ONLY_CONSTRUCTOR, ...;int MESSAGE_THROWABLE_CONSTRUCTOR, ...;int MESSAGE_SQLEX_CONSTRUCTOR, ...;int MESSAGE_SQL_THROWABLE_CONSTRUCTOR, ...;int MESSAGE_SQL_SQLEX_CONSTRUCTOR, ...;SingletonSupplier<SQLErrorCodes> sqlErrorCodes, ...;/** Error codes used by this translator. *//** Constructor for use as a JavaBean. ... */setFallbackTranslator(...)/** Create an SQL error code translator for the given DataSource. ... *//** Create an SQL error code translator for the given database product name. ... */setDatabaseProductName(...)/** Create an SQLErrorCode translator given these error codes. ... */this.sqlErrorCodes/** Set the DataSource for this translator. ... */new Supplier<SQLErrorCodes>(...) { ... }resolveErrorCodes(...)/** Set the database product name for this translator. ... */getErrorCodes(...)/** Set custom error codes to be used for translation. ... *//** Return the error codes used by this translator. ... */SQLException sqlExcustomTranslate(...)SQLErrorCodes sqlErrorCodesgetSqlErrorCodes(...)getNextException(...)SQLException nestedSqlExSQLExceptionTranslator customTranslatorgetCustomSqlExceptionTranslator(...)DataAccessException customDexisUseSqlStateForTranslation(...)SQLException currentCustomSQLErrorCodesTranslation[] customTranslationsgetCustomTranslations(...)CustomSQLErrorCodesTranslation customTranslationgetExceptionClass(...)DataAccessException customExceptioncreateCustomException(...)logTranslation(...)getBadSqlGrammarCodes(...)new BadSqlGrammarException(...)getInvalidResultSetAccessCodes(...)getDuplicateKeyCodes(...)new DuplicateKeyException(...)getDataIntegrityViolationCodes(...)getPermissionDeniedCodes(...)new PermissionDeniedDataAccessException(...)getDataAccessResourceFailureCodes(...)getTransientDataAccessResourceCodes(...)new TransientDataAccessResourceException(...)getCannotAcquireLockCodes(...)new CannotAcquireLockException(...)getDeadlockLoserCodes(...)new DeadlockLoserDataAccessException(...)getCannotSerializeTransactionCodes(...)new CannotSerializeTransactionException(...)String codes/** Subclasses can override this method to attempt a custom mapping from ... *//** Create a custom {@link DataAccessException}, based on a given exception ... */int constructorTypeConstructor<?> exceptionConstructorClass<?>[] messageAndSqlAndSqlExArgsClassObject[] messageAndSqlAndSqlExArgsClass<?>[] messageAndSqlAndThrowableArgsClassObject[] messageAndSqlAndThrowableArgsClass<?>[] messageAndSqlExArgsClassObject[] messageAndSqlExArgsClass<?>[] messageAndThrowableArgsClassObject[] messageAndThrowableArgsClass<?>[] messageOnlyArgsClassObject[] messageOnlyArgsString intro// try early initialization - otherwise the supplier will retry later// First, try custom translation from overridden method.// Next, try the custom SQLException translator, if available.// Check SQLErrorCodes with corresponding error code, if available.// Try to find SQLException with actual error code, looping through the causes.// E.g. applicable to java.sql.DataTruncation as of JDK 1.6.// Look for defined custom translations first.// Next, look for grouped error codes.// We couldn't identify it more precisely - let's hand it over to the SQLState fallback translator.// Find appropriate constructor for the given exception class// invoke constructor/** JavaBean for holding JDBC error codes for a particular database. ... */...[] databaseProductNames, ...;boolean useSqlStateForTranslation, ...;...[] badSqlGrammarCodes, ...;...[] invalidResultSetAccessCodes, ...;...[] duplicateKeyCodes, ...;...[] dataIntegrityViolationCodes, ...;...[] permissionDeniedCodes, ...;...[] dataAccessResourceFailureCodes, ...;...[] transientDataAccessResourceCodes, ...;...[] cannotAcquireLockCodes, ...;...[] deadlockLoserCodes, ...;...[] cannotSerializeTransactionCodes, ...;...[] customTranslations, ...;SQLExceptionTranslator customSqlExceptionTranslator, ...;/** Set this property if the database name contains spaces, ... */this.databaseProductNamesthis.databaseProductNames.length/** Set this property to specify multiple database names that contains spaces, ... *//** Set this property to true for databases that do not provide an error code ... */this.useSqlStateForTranslationthis.badSqlGrammarCodesthis.invalidResultSetAccessCodesthis.duplicateKeyCodesthis.dataIntegrityViolationCodesthis.permissionDeniedCodesthis.dataAccessResourceFailureCodesthis.transientDataAccessResourceCodesthis.cannotAcquireLockCodesthis.deadlockLoserCodesthis.cannotSerializeTransactionCodesthis.customTranslationsthis.customSqlExceptionTranslator/** Factory for creating {@link SQLErrorCodes} based on the ... */new ConcurrentReferenceHashMap<DataSource,SQLErrorCodes>(...)SQLErrorCodesFactory.classnew SQLErrorCodesFactory(...)String SQL_ERROR_CODE_OVERRIDE_PATH, ...;/** The name of custom SQL error codes file, loading from the root ... */String SQL_ERROR_CODE_DEFAULT_PATH, ...;/** The name of default SQL error code files, loading from the class path. */SQLErrorCodesFactory instance, ...;Map<String,SQLErrorCodes> errorCodesMap, ...;/** Map to hold error codes for all databases defined in the config file. ... */Map<DataSource,SQLErrorCodes> dataSourceCache, ...;/** Map to cache the SQLErrorCodes instance per DataSource. *//** Create a new instance of the {@link SQLErrorCodesFactory} class. ... */Map<String,SQLErrorCodes> errorCodesXmlBeanDefinitionReader bdrloadResource(...)SQLErrorCodes.classthis.errorCodesMap/** Load the given resource from the class path. ... *//** Return the {@link SQLErrorCodes} instance for the given database. ... */SQLErrorCodes secSQLErrorCodes candidategetDatabaseProductNames(...)checkCustomTranslatorRegistry(...)new SQLErrorCodes(...)/** Return {@link SQLErrorCodes} for the given {@link DataSource}, ... */this.dataSourceCacheidentify(...)registerDatabase(...)/** Associate the specified database name with the given {@link DataSource}. ... *//** Clear the cache for the specified {@link DataSource}, if registered. ... *//** Build an identification String for the given {@link DataSource}, ... *//** Check the {@link CustomSQLExceptionTranslatorRegistry} for any entries. */findTranslatorForDatabase(...)setCustomSqlExceptionTranslator(...)// Load default SQL error codes.// Load custom SQL error codes, overriding defaults.// Check all beans of type SQLErrorCodes.// Could not find the database among the defined ones.// Try efficient lock-free access for existing cache entry// Double-check within full dataSourceCache lock// We could not find it - got to look it up.import SQLDataExceptionimport SQLIntegrityConstraintViolationExceptionimport SQLInvalidAuthorizationSpecExceptionimport SQLNonTransientConnectionExceptionimport SQLNonTransientExceptionimport SQLRecoverableExceptionimport SQLSyntaxErrorExceptionimport SQLTimeoutExceptionimport SQLTransactionRollbackExceptionimport SQLTransientConnectionExceptionimport SQLTransientExceptionimport ConcurrencyFailureExceptionimport QueryTimeoutExceptionimport RecoverableDataAccessException/** {@link SQLExceptionTranslator} implementation which analyzes the specific ... */new ConcurrencyFailureException(...)new QueryTimeoutException(...)new RecoverableDataAccessException(...)// Fallback to Spring's own SQL state translation.../** Strategy interface for translating between {@link SQLException SQLExceptions} ... *//** {@link SQLExceptionTranslator} implementation that analyzes the SQL state in ... */Set<String> BAD_SQL_GRAMMAR_CODES, ...;Set<String> DATA_INTEGRITY_VIOLATION_CODES, ...;Set<String> DATA_ACCESS_RESOURCE_FAILURE_CODES, ...;Set<String> TRANSIENT_DATA_ACCESS_RESOURCE_CODES, ...;Set<String> CONCURRENCY_FAILURE_CODES, ...;String sqlStategetSqlState(...)String classCode/** Gets the SQL state code from the supplied {@link SQLException exception}. ... */SQLException nestedEx// Dynamic SQL error// Cardinality violation// Syntax error direct SQL// Syntax error dynamic SQL// General SQL syntax error// Oracle: unknown identifier// Data truncation// No data found// Value out of range// Integrity constraint violation// Triggered data change violation// With check violation// Connection exception// PostgreSQL: insufficient resources (e.g. disk full)// PostgreSQL: program limit exceeded (e.g. statement too complex)// DB2: out-of-memory exception / database not started// DB2: unexpected system error// Sybase: internal I/O error// Sybase: unexpected I/O error// DB2: communication failure// Transaction rollback// Oracle: deadlock// First, the getSQLState check...// For MySQL: exception class name indicating a timeout?// (since MySQL doesn't throw the JDBC 4 SQLTimeoutException)// Couldn't resolve anything proper - resort to UncategorizedSQLException./** Simple interface for complex types to be set as statement parameters. ... *//** Set the value on the given PreparedStatement. ... *//** Clean up resources held by this value object. *//** Abstract base class for {@link DataFieldMaxValueIncrementer} implementations that use ... */String columnName, ...;/** The name of the column for this sequence. */int cacheSize, ...;/** The number of keys buffered in a cache. *//** Default constructor for bean property style usage. ... *//** Convenience constructor. ... */this.columnName/** Set the name of the column in the sequence table. *//** Return the name of the column in the sequence table. *//** Set the number of buffered keys. */this.cacheSize/** Return the number of buffered keys. *//** Base implementation of {@link DataFieldMaxValueIncrementer} that delegates ... */String incrementerName, ...;/** The name of the sequence/table containing the sequence. */int paddingLength, ...;/** The length to which a string result should be pre-pended with zeroes. */this.incrementerName/** Set the data source to retrieve the value from. *//** Return the data source to retrieve the value from. *//** Set the name of the sequence/table. *//** Return the name of the sequence/table. *//** Set the padding length, i.e. the length to which a string result ... */this.paddingLength/** Return the padding length for String values. */getNextKey(...)/** Determine the next key to use, as a long. ... *//** Abstract base class for {@link DataFieldMaxValueIncrementer} implementations ... */boolean deleteSpecificValues, ...;...[] valueCache, ...;/** The current cache of values. */int nextValueIndex, ...;/** The next id to serve from the value cache. *//** Specify whether to delete the entire range below the current maximum key value ... */this.deleteSpecificValues/** Return whether to delete the entire range below the current maximum key value ... */this.nextValueIndexgetCacheSize(...)getIdentityStatement(...)getIncrementStatement(...)getDeleteStatement(...)/** Statement to use to increment the "sequence" value. ... *//** Statement to use to obtain the current identity value. ... *//** Statement to use to clean up "sequence" values. ... */getIncrementerName(...)isDeleteSpecificValues(...)long maxValue/* Need to use straight JDBC code because we need to make sure that the insert and select ... *//** Executes the SQL as specified by {@link #getSequenceQuery()}. */getSequenceQuery(...)/** Return the database-specific query to use for retrieving a sequence value. ... *//** {@link DataFieldMaxValueIncrementer} that retrieves the next value ... *//** Interface that defines contract of incrementing any data store field's ... *//** Increment the data store field's max value as int. ... *//** Increment the data store field's max value as long. ... *//** Increment the data store field's max value as String. ... *//** {@link DataFieldMaxValueIncrementer} that increments the maximum value of a given Derby table ... */String DEFAULT_DUMMY_NAME, ...;/** The default for dummy name. */String dummyName, ...;/** The name of the dummy column used for inserts. */this.dummyName/** Set the name of the dummy column. *//** Return the name of the dummy column. */getDummyName(...)/** {@link DataFieldMaxValueIncrementer} that increments the maximum value of a given HSQL table ... *//** {@link DataFieldMaxValueIncrementer} that increments the maximum value of a given MySQL table ... */String VALUE_SQL, ...;/** The SQL string for retrieving the new sequence value. */long nextId, ...;/** The next id to serve. */long maxId, ...;/** The max id to serve. */boolean useNewConnection, ...;/** Whether or not to use a new connection for the incrementer. *//** Set whether to use a new connection for the incrementer. ... */this.useNewConnectionthis.maxIdthis.nextIdboolean mustRestoreAutoCommitSQLException ignore/* If useNewConnection is true, then we obtain a non-managed connection so our modifications ... */// Increment the sequence column...// Retrieve the new max of the sequence column.../** {@link DataFieldMaxValueIncrementer} that increments the maximum value of a given SQL Server table ... *//** {@link DataFieldMaxValueIncrementer} that increments the maximum value of a given Sybase table ... *//** Abstract base class for {@link LobHandler} implementations. ... */getBlobAsBytes(...)getBlobAsBinaryStream(...)getClobAsString(...)getClobAsAsciiStream(...)getClobAsCharacterStream(...)/** Default implementation of the {@link LobHandler} interface. ... */boolean wrapAsLob, ...;boolean streamAsLob, ...;boolean createTemporaryLob, ...;/** Specify whether to submit a byte array / String to the JDBC driver ... */this.wrapAsLob/** Specify whether to submit a binary stream / character stream to the JDBC ... */this.streamAsLob/** Specify whether to copy a byte array / String into a temporary JDBC ... */this.createTemporaryLobgetBinaryStream(...)getAsciiStream(...)getCharacterStream(...)new TemporaryLobCreator(...)new DefaultLobCreator(...)/** Default LobCreator implementation as an inner class. ... */setBlob(...)new PassThroughBlob(...)setBytes(...)setBinaryStream(...)new PassThroughClob(...)setAsciiStream(...)setCharacterStream(...)// nothing to do when not creating temporary LOBs/** Interface that abstracts potentially database-specific creation of large binary ... *//** Set the given content as bytes on the given statement, using the given ... *//** Set the given content as binary stream on the given statement, using the given ... *//** Set the given content as String on the given statement, using the given ... *//** Set the given content as ASCII stream on the given statement, using the given ... *//** Set the given content as character stream on the given statement, using the given ... *//** Close this LobCreator session and free its temporarily created BLOBs and CLOBs. ... *//** Abstraction for handling large binary fields and large text fields in ... *//** Retrieve the given column as bytes from the given ResultSet. ... *//** Retrieve the given column as binary stream from the given ResultSet. ... *//** Retrieve the given column as String from the given ResultSet. ... *//** Retrieve the given column as ASCII stream from the given ResultSet. ... *//** Retrieve the given column as character stream from the given ResultSet. ... *//** Create a new {@link LobCreator} instance, i.e. a session for creating BLOBs ... *//** Simple JDBC {@link Blob} adapter that exposes a given byte array or binary stream. ... */InputStream binaryStream, ...;long contentLength, ...;this.contentLengththis.binaryStream/** Simple JDBC {@link Clob} adapter that exposes a given String or character stream. ... */String content, ...;Reader characterStream, ...;InputStream asciiStream, ...;this.characterStreamthis.asciiStreamString tempContent/** {@link LobCreator} implementation based on temporary LOBs, ... */new LinkedHashSet<Blob>(...)new LinkedHashSet<Clob>(...)TemporaryLobCreator.classSet<Blob> temporaryBlobs, ...;Set<Clob> temporaryClobs, ...;createBlob(...)this.temporaryBlobscreateClob(...)this.temporaryClobsfree(...)/** Provides a strategy interface for Large OBject handling, ... *//** Support classes for the JDBC framework, used by the classes in the ... */import Timestamp/** The default implementation of Spring's {@link SqlRowSet} interface, wrapping a ... */ResultSet resultSet, ...;SqlRowSetMetaData rowSetMetaData, ...;Map<String,Integer> columnLabelMap, ...;/** Create a new ResultSetWrappingSqlRowSet for the given ResultSet. ... */this.resultSetthis.rowSetMetaDatanew ResultSetWrappingSqlRowSetMetaData(...)SQLException sethis.columnLabelMap/** Return the underlying ResultSet ... */Integer columnIndex// RowSet methods for extracting data valuesgetNString(...)// RowSet navigation methodsabsolute(...)afterLast(...)beforeFirst(...)getRow(...)isAfterLast(...)isBeforeFirst(...)isFirst(...)isLast(...)previous(...)relative(...)// Make sure to preserve first matching column for any given name,// as defined in ResultSet's type-level javadoc (lines 81 to 83)./** The default implementation of Spring's {@link SqlRowSetMetaData} interface, wrapping a ... */ResultSetMetaData resultSetMetaData, ...;/** Create a new ResultSetWrappingSqlRowSetMetaData object ... */this.resultSetMetaDatagetColumnDisplaySize(...)getPrecision(...)isCaseSensitive(...)isCurrency(...)isSigned(...)/** Mirror interface for {@link javax.sql.RowSet}, representing a disconnected variant of ... *//** Retrieve the meta-data, i.e. number, types and properties ... *//** Map the given column label to its column index. ... *//** Retrieve the value of the indicated column in the current row as a BigDecimal object. ... *//** Retrieve the value of the indicated column in the current row as a boolean. ... *//** Retrieve the value of the indicated column in the current row as a byte. ... *//** Retrieve the value of the indicated column in the current row as a Date object. ... *//** Retrieve the value of the indicated column in the current row as a Double object. ... *//** Retrieve the value of the indicated column in the current row as a float. ... *//** Retrieve the value of the indicated column in the current row as an int. ... *//** Retrieve the value of the indicated column in the current row as a long. ... *//** Retrieve the value of the indicated column in the current row as a String ... *//** Retrieve the value of the indicated column in the current row as an Object. ... *//** Retrieve the value of the indicated column in the current row as a short. ... *//** Retrieve the value of the indicated column in the current row as a String. ... *//** Retrieve the value of the indicated column in the current row as a Time object. ... *//** Retrieve the value of the indicated column in the current row as a Timestamp object. ... *//** Move the cursor to the given row number in the row set, just after the last row. ... *//** Move the cursor to the end of this row set. ... *//** Move the cursor to the front of this row set, just before the first row. ... *//** Move the cursor to the first row of this row set. ... *//** Retrieve the current row number. ... *//** Retrieve whether the cursor is after the last row of this row set. ... *//** Retrieve whether the cursor is before the first row of this row set. ... *//** Retrieve whether the cursor is on the first row of this row set. ... *//** Retrieve whether the cursor is on the last row of this row set. ... *//** Move the cursor to the last row of this row set. ... *//** Move the cursor to the next row. ... *//** Move the cursor to the previous row. ... *//** Move the cursor a relative number of rows, either positive or negative. ... *//** Report whether the last column read had a value of SQL {@code NULL}. ... *//** Metadata interface for Spring's {@link SqlRowSet}, analogous to JDBC's ... *//** Retrieve the catalog name of the table that served as the source for the ... *//** Retrieve the fully qualified class that the specified column will be mapped to. ... *//** Retrieve the number of columns in the RowSet. ... *//** Return the column names of the table that the result set represents. ... *//** Retrieve the maximum width of the designated column. ... *//** Retrieve the suggested column title for the column specified. ... *//** Retrieve the column name for the indicated column. ... *//** Retrieve the SQL type code for the indicated column. ... *//** Retrieve the DBMS-specific type name for the indicated column. ... *//** Retrieve the precision for the indicated column. ... *//** Retrieve the scale of the indicated column. ... *//** Retrieve the schema name of the table that served as the source for the ... *//** Retrieve the name of the table that served as the source for the ... *//** Indicate whether the case of the designated column is significant. ... *//** Indicate whether the designated column contains a currency value. ... *//** Indicate whether the designated column contains a signed number. ... *//** Provides a convenient holder for disconnected result sets. ... */import SQLXML/** Default implementation of the {@link SqlXmlHandler} interface. ... */// Convenience methods for accessing XML contentSQLXML xmlObjectgetSQLXML(...)DOMSource.class// Convenience methods for building XML contentnew AbstractJdbc4SqlXmlValue(...) { ... }provideXml(...)setNode(...)DOMResult.class/** Internal base class for {@link SqlXmlValue} implementations. */SQLXML xmlObject, ...;this.xmlObjectcreateSQLXML(...)setSQLXML(...)/** Exception thrown when the underlying implementation does not support the ... *//** Constructor for SqlXmlFeatureNotImplementedException. ... *//** Abstraction for handling XML fields in specific databases. Its main purpose ... *//** Retrieve the given column as Source implemented using the specified source class ... *//** Create a {@code SqlXmlValue} instance for the given XML data, ... *//** Subinterface of {@link org.springframework.jdbc.support.SqlValue} ... *//** Interface defining handling involved with providing {@code OutputStream} ... *//** Implementations must implement this method to provide the XML content ... *//** Interface defining handling involved with providing {@code Writer} ... *//** Interface defining handling involved with providing {@code Result} ... *//** Abstraction for handling fields of SQLXML data type. */int id, ...;String forename, ...;this.forenameString enabled, ...;ClassPathXmlApplicationContext context, ...;assertCorrectSetup(...)BadSqlGrammarException.classJdbcTemplate tCacheData cacheCacheData.classgetCachedData(...)JdbcTemplate jtList<Map<String,Object>> cache, ...;import AbstractDriverBasedDataSourceimport static EmbeddedDatabaseFactory.DEFAULT_DATABASE_NAMEassertCorrectSetupForSingleDataSource(...)Predicate<String> urlPredicateassertCorrectSetupAndCloseContext(...)JdbcTemplate templateassertNumRowsInTestTable(...)assertBeanPropertyValueOf(...)BeanDefinition beanString dataSourceNameAbstractDriverBasedDataSource adbDataSource// If Derby isn't cleaned up properly this will fail...// Table has been droppedimport ConcretePersonimport ConstructorPersonimport DatePersonimport SpacePersonimport SingleConnectionDataSourceimport SQLStateSQLExceptionTranslator/** Mock object based abstract class for RowMapper tests. ... */usingComparator(...)getBirth_date(...)new Comparator<Date>(...) { ... }getBalance(...)verifyPersonViaBeanWrapper(...)getLastName(...)getBirthDate(...)birth_date(...)balance(...)new MockType(...)MockType ONE, ...;MockType TWO, ...;MockType THREE, ...;Statement statement, ...;MockType.ONEStatement.classResultSet.classResultSetMetaData.classnew SQLFeatureNotSupportedException(...)MockType.TWOMockType.THREEnew SingleConnectionDataSource(...)setExceptionTranslator(...)import ExtendedPersonBeanPropertyRowMapper<> mappernew BeanPropertyRowMapper<>(...)InvalidDataAccessApiUsageException.classsetMappedClass(...)BeanPropertyRowMapper<Person> mappernew BeanPropertyRowMapper<Person>(...)Mock mocknew Mock(...)List<Person> resultverifyPerson(...)verifyClosed(...)List<ConcretePerson> resultConcretePerson.classList<ExtendedPerson> resultExtendedPerson.classExtendedPerson beanList<SpacePerson> resultSpacePerson.classList<DatePerson> resultDatePerson.classList<ConstructorPerson> resultConstructorPerson.classPreparedStatement preparedStatement, ...;JdbcTemplate template, ...;this.statementthis.preparedStatementPreparedStatement.classthis.templateList<Map<String,Object>> liList<Integer> liqueryForMap(...)IncorrectResultSizeDataAccessException.classnew RowMapper<Integer>(...) { ... }AtomicInteger countStream<Integer> sdoTestQueryForListWithArgs(...)import AbstractInterruptibleBatchPreparedStatementSetterimport SQLErrorCodeSQLExceptionTranslator/** Mock object based tests for JdbcTemplate. ... */CallableStatement callableStatement, ...;this.callableStatementCallableStatement.classsetIgnoreWarnings(...)int idParamDispatcher dnew Dispatcher(...)setInt(...)SQLException sqlExceptionUncategorizedSQLException.classdoTestStrings(...)new JdbcTemplateCallback(...) { ... }Integer argumentnew PreparedStatementSetter(...) { ... }String[] resultsStringHandler shnew StringHandler(...)String[] forenamesdoInJdbcTemplate(...)forenames.lengthresults.lengthSingleConnectionDataSource scfRowCountCallbackHandler rcchnew RowCountCallbackHandler(...)new ConnectionCallback<String>(...) { ... }JdbcTemplateTests.this.connectionJdbcTemplateTests.this/** Test that we see a runtime exception come back. */RuntimeException runtimeException/** Test update with static SQL. */int actualRowsAffected/** Test update with dynamic SQL. */String[] sqlint[] actualRowsAffectedmockDatabaseMetaData(...)actualRowsAffected.lengthnew BatchUpdateException(...)UncategorizedSQLException exint[] idsBatchPreparedStatementSetter setterids.lengthnew InterruptibleBatchPreparedStatementSetter(...) { ... }new AbstractInterruptibleBatchPreparedStatementSetter(...) { ... }List<Object[]> idsnew ArrayList<Object[]>(...)List<Integer> idsint[] rowsAffected1int[] rowsAffected2ParameterizedPreparedStatementSetter<Integer> setternew ParameterizedPreparedStatementSetter<Integer>(...) { ... }int[][] actualRowsAffectedCannotGetJdbcConnectionException.classdoTestCouldNotGetConnectionInOperationWithExceptionTranslatorInitialized(...)/** If beanProperty is true, initialize via exception translator bean property; ... */int expectedRowsUpdatedPreparedStatementSetter pssint actualRowsUpdated/** Mock objects allow us to produce warnings at will */SQLWarning warningsnew SQLWarning(...)ResultSetExtractor<Byte> extractornew ResultSetExtractor<Byte>(...) { ... }SQLWarningException.class/** Test that we see an SQLException translated using Error Code. ... */ResultSet resultSet2new ResultSetExtractor<Object>(...) { ... }new CallableStatementCreator(...) { ... }Map<String,Object> outsetResultsMapCaseInsensitive(...)LinkedCaseInsensitiveMap<>.classResultSetMetaData metaDataDatabaseMetaData databaseMetaData// It's because Integers aren't canonical// Match// if close is called entire test will fail// This will get a connection.// This will cause creation of default SQL translator.// Too long: truncation// Bad SQL state// Set custom exception translator// SPR-16578new RowMapper<TestBean>(...) { ... }RowMapper<TestBean> testRowMapper, ...;List<TestBean> result, ...;/** Simple row count callback handler for testing purposes. ... *//** Tests for {@link SingleColumnRowMapper}. ... */Timestamp timestampSingleColumnRowMapper<LocalDateTime> rowMapperResultSet resultSetLocalDateTime actualLocalDateTimeDefaultConversionService myConversionServiceSingleColumnRowMapper<MyLocalDateTime> rowMapperMyLocalDateTime.classMyLocalDateTime actualMyLocalDateTimenew Converter<Timestamp,MyLocalDateTime>(...) { ... }new MyLocalDateTime(...)actualMyLocalDateTime.valueTypeMismatchDataAccessException.classLocalDateTime value, ...;// SPR-16483import ParameterMetaDataStatementCreatorUtils.shouldIgnoreGetParameterTypeParameterMetaData pmdParameterMetaData.classTypes.CHAR// SPR-8571BeanPropertySqlParameterSource sourcenew NoReadableProperties(...)MapSqlParameterSource sourceMapSqlParameterSource mspsMapSqlParameterSource msps2import CustomerString SELECT_NAMED_PARAMETERS, ...;String SELECT_NAMED_PARAMETERS_PARSED, ...;String SELECT_NO_PARAMETERS, ...;String UPDATE_NAMED_PARAMETERS, ...;String UPDATE_NAMED_PARAMETERS_PARSED, ...;String UPDATE_ARRAY_PARAMETERS, ...;String UPDATE_ARRAY_PARAMETERS_PARSED, ...;...[] COLUMN_NAMES, ...;DatabaseMetaData databaseMetaData, ...;Map<String,Object> params, ...;NamedParameterJdbcTemplate namedParameterTemplate, ...;new PreparedStatementCallback<Object>(...) { ... }List<Integer> typeIdsCustomer custnew ResultSetExtractor<Customer>(...) { ... }Customer cust1setForename(...)getForename(...)List<Customer> customersnew ArrayList<Customer>(...)new RowMapper<Customer>(...) { ... }Stream<Customer> snew Consumer<Customer>(...) { ... }Map<String,Integer>[] idsSqlParameterSource[] idsMap<String,Object>[] parametersInOrder inOrderNamedParameterJdbcTemplate template, ...;MapSqlParameterSource paramsnew RowMapper<Object>(...) { ... }List<Object[]> l1BeanPropertySqlParameterSource paramsnew ParameterBean(...)new ParameterCollectionBean(...)Collection<Integer> ids, ...;this.idsParsedSql psqlString sql2ParsedSql psql2String sql3ParsedSql psql3MapSqlParameterSource namedParamsMap<String,String> paramMapbuildValueArray(...).lengthbuildSqlTypeArray(...).lengthString expectedSqlString newSqlString sql1ParsedSql psql1MapSqlParameterSource paramMapString sql4ParsedSql psql4String finalSqlString expectedSql2ParsedSql parsedSql2String finalSql2// SPR-4789// SPR-4612// SPR-13582// SPR-15382// SPR-7476// SPR-2544// SPR-3173// SPR-8280/** Mock object based tests for CallMetaDataContext. ... */CallMetaDataContext context, ...;String TABLEString USERMapSqlParameterSource parameterSourceMap<String,Object> inParameters/** Tests for {@link SimpleJdbcCall}. ... */String NO_SUCH_PROCSimpleJdbcCall sprocwithProcedureName(...)new SimpleJdbcCall(...)String MY_PROCSimpleJdbcCall adderNumber newIdexecuteObject(...)initializeAddInvoiceWithoutMetaData(...)declareParameters(...)verifyAddInvoiceWithoutMetaData(...)initializeAddInvoiceWithMetaData(...)verifyAddInvoiceWithMetaData(...)withFunctionName(...)executeFunction(...)verifyStatement(...)withNamedBinding(...)/** This test demonstrates that a CALL statement will still be generated if ... */ResultSet proceduresResultSetResultSet procedureColumnsResultSet// Shouldn't succeed in adding unnamed parameter// gh-26486// Return a valid data type for the first 2 columns.// 3rd time, simulate an error while retrieving metadata.// If an exception were not thrown for column 3, we would expect:// {call ADD_INVOICE(AMOUNT => ?, CUSTID => ?, NEWID => ?)}/** Mock object based tests for {@link SimpleJdbcInsert}. ... */SimpleJdbcInsert insertwithTableName(...)new SimpleJdbcInsert(...)ResultSet tableResultSetResultSet columnResultSet// Shouldn't succeed in inserting into table which doesn't exist// true, true, false --> simulates processing of two columns// Return a column name the first time.// Second time, simulate an error while retrieving metadata./** Mock object based tests for TableMetaDataContext. ... */TableMetaDataContext context, ...;ResultSet metaDataResultSetResultSet columnsResultSetMapSqlParameterSource mapString[] keyColsString insertStringStatement statementJdbcBeanDefinitionReader readernew JdbcBeanDefinitionReader(...)DataSource dsList<String> testJdbcDaoSupport daonew JdbcDaoSupport(...) { ... }LobHandler handlerLobHandler.classLobCreator creatorLobCreator.classSetValuesCalled svcnew SetValuesCalled(...)AbstractLobCreatingPreparedStatementCallback pscnew AbstractLobCreatingPreparedStatementCallback(...) { ... }svc.bResultSet rsetAbstractLobStreamingResultSetExtractor<Void> lobRseclearWarnings(...)LobRetrievalFailureException.classnew AbstractLobStreamingResultSetExtractor<Void>(...) { ... }import MockitoSettingsimport Strictness/** Test cases for the SQL LOB value: ... */Strictness.LENIENTLobHandler handler, ...;LobCreator creator, ...;ArgumentCaptor<InputStream> inputStreamCaptor, ...;byte[] testBytesSqlLobValue lobnew SqlLobValue(...)String testContentbyte[] testContentSqlLobValue lob2SqlLobValue lob3// a bit BS, but we need to test them, as long as they don't throw exceptions// same for BLOBlong age, ...;Date birth_date, ...;this.birth_dateBigDecimal balance, ...;this.balanceLocalDate birthDate, ...;this.birthDateObject someField, ...;this.someFieldLocalDateTime birthDate, ...;import RollbackExceptionimport SystemExceptionimport Transactionimport TransactionManagerimport UserTransactionimport BeanFactoryDataSourceLookupimport IsolationLevelDataSourceRouterimport JtaTransactionManagerimport JtaTransactionObjectimport TransactionCallbackWithoutResultUserTransaction userTransaction, ...;TransactionManager transactionManager, ...;Transaction transaction, ...;UserTransaction.classTransactionManager.classTransaction.classgetCurrentTransactionName(...)isActualTransactionActive(...)doTestJtaTransaction(...)JtaTransactionManager ptmnew JtaTransactionManager(...)TransactionTemplate tthasResource(...)Status.STATUS_NO_TRANSACTIONStatus.STATUS_ACTIVEnew TransactionCallbackWithoutResult(...) { ... }Connection cisNewTransaction(...)doTestJtaTransactionWithPropagationRequiresNew(...)DataSource dsToUsenew TransactionAwareDataSourceProxy(...)setPropagationBehavior(...)TransactionDefinition.PROPAGATION_REQUIRES_NEWdoTestJtaTransactionCommitWithNewTransactionWithinEmptyTransaction(...)Connection connection1Connection connection2TransactionDefinition.PROPAGATION_NOT_SUPPORTEDTransactionDefinition.PROPAGATION_SUPPORTSTransactionTemplate tt2TransactionDefinition.PROPAGATION_REQUIREDdoTestJtaTransactionWithPropagationRequiresNewAndBeginException(...)new SystemException(...)setReobtainTransactionalConnections(...)TransactionException.classnew JtaTransactionManager(...) { ... }Thread asyncinvokeAfterCompletion(...)TransactionSynchronization.STATUS_COMMITTEDboolean releaseConIsolationLevelDataSourceAdapter dsToUsenew IsolationLevelDataSourceAdapter(...)setAllowCustomIsolationLevels(...)TransactionDefinition.ISOLATION_REPEATABLE_READConnection.TRANSACTION_REPEATABLE_READdoTestJtaTransactionWithIsolationLevelDataSourceRouter(...)DataSource dataSource1DataSource dataSource2IsolationLevelDataSourceRouter dsToUsenew IsolationLevelDataSourceRouter(...)Map<Object,Object> targetDataSourcesStaticListableBeanFactory beanFactorysetDefaultTargetDataSource(...)setDataSourceLookup(...)new BeanFactoryDataSourceLookup(...)setTargetDataSources(...)import IllegalTransactionStateExceptionimport TransactionTimedOutExceptionimport UnexpectedRollbackExceptionDataSource ds, ...;Connection con, ...;DataSourceTransactionManager tm, ...;doTestTransactionCommitRestoringAutoCommit(...)new LazyConnectionDataSourceProxy(...)Connection.TRANSACTION_READ_COMMITTEDConnection tCondoTestTransactionRollbackRestoringAutoCommit(...)setTransactionSynchronization(...)DataSourceTransactionManager.SYNCHRONIZATION_NEVERRuntimeException ex2doTestParticipatingTransactionWithRollbackOnly(...)TransactionStatus tsnew DefaultTransactionDefinition(...)TestTransactionSynchronization synchnew TestTransactionSynchronization(...)TransactionSynchronization.STATUS_ROLLED_BACKboolean outerTransactionBoundaryReachedsetFailEarlyOnGlobalRollbackOnly(...)UnexpectedRollbackException exsynch.beforeCommitCalledsynch.beforeCompletionCalledsynch.afterCommitCalledsynch.afterCompletionCalledsetValidateExistingTransaction(...)IllegalTransactionStateException.classTransactionDefinition.ISOLATION_SERIALIZABLEnew TestTransactionSynchronization(...) { ... }doAfterCompletion(...)synch.afterCompletionExceptionDataSource ds2Connection con2DataSourceTransactionManager tm2TransactionSynchronization.STATUS_UNKNOWNUnexpectedRollbackException.classPlatformTransactionManager tm2SQLException failureCannotCreateTransactionException.classTransactionDefinition.PROPAGATION_NEVERConnection con1setEnforceReadOnly(...)setTimeout(...)TransactionTimedOutException exTransactionAwareDataSourceProxy dsProxyTransactionTemplate.PROPAGATION_REQUIRES_NEW/** Test behavior if the first operation on a connection (getAutoCommit) throws SQLException. */TransactionSystemException.classsetRollbackOnCommitFailure(...)doTestExistingTransactionWithPropagationNested(...)DatabaseMetaData mdSavepoint spSavepoint.classConnectionHolder.SAVEPOINT_NAME_PREFIXTransactionDefinition.PROPAGATION_NESTEDhasSavepoint(...)TransactionTemplate nttObject savepointrollbackToSavepoint(...)int status, ...;boolean beforeCommitCalled, ...;boolean beforeCompletionCalled, ...;boolean afterCommitCalled, ...;boolean afterCompletionCalled, ...;Throwable afterCompletionException, ...;this.statusthis.beforeCommitCalledthis.beforeCompletionCalledthis.afterCommitCalledthis.afterCompletionExceptionthis.afterCompletionCalled// tm has no synch enabled (used at outer level), tm2 has synch enabled (inner level)// something transactional// should be ignored/** Tests for {@link DelegatingDataSource}. ... */new DelegatingDataSource(...)DataSource delegate, ...;DelegatingDataSource dataSource, ...;PrintWriter writerExampleWrapper wrapperExampleWrapper.classnew DelegatingDataSourceWithWrapper(...)String jdbcUrlString unameString pwdDriverManagerDataSource dsnew TestDriverManagerDataSource(...)Connection actualConString bogusClassNamenew DriverManagerDataSource(...)setDriverClassName(...)//ds.setDriverClassName("foobar");DataSource target, ...;UserCredentialsDataSourceAdapter adapternew UserCredentialsDataSourceAdapter(...)setCredentialsForCurrentThread(...)removeCredentialsFromCurrentThread(...)import ClassRelativeResourceLoaderimport CannotReadScriptExceptionimport ScriptStatementFailedExceptionimport static EmbeddedDatabaseType.DERBYimport static EmbeddedDatabaseType.H2/** Integration tests for {@link EmbeddedDatabaseBuilder}. ... */new ClassRelativeResourceLoader(...)EmbeddedDatabaseBuilder builder, ...;doTwice(...)EmbeddedDatabase dbaddDefaultScripts(...)assertDatabaseCreatedAndShutdown(...)CannotReadScriptException.classignoreFailedDrops(...)EmbeddedDatabase db1ScriptStatementFailedException.classgenerateUniqueName(...)JdbcTemplate template1EmbeddedDatabase db2assertDatabaseCreated(...)ClassRelativeResourceLoader resourceLoader, ...;EmbeddedDatabaseFactoryBean beannew EmbeddedDatabaseFactoryBean(...)ResourceDatabasePopulator populatorresource(...)EmbeddedDatabaseFactory factory, ...;StubDatabasePopulator populatornew StubDatabasePopulator(...)populator.populateCalledboolean populateCalled, ...;this.populateCalledimport EmbeddedDatabase/** Abstract base class for integration tests involving database initialization. ... */EmbeddedDatabase db, ...;getEmbeddedDatabaseType(...)String lastName/** Abstract base class for integration tests for {@link ResourceDatabasePopulator} ... */String COUNT_DAVE_SQL, ...;String COUNT_KEITH_SQL, ...;assertTestDatabaseCreated(...)defaultSchema(...)usersSchema(...)assertUsersDatabaseCreated(...)ScriptUtils.EOF_STATEMENT_SEPARATOR/** See SPR-9457 */DatabasePopulator.classinitSynchronization(...)/** See SPR-9781 *//** Unit tests for {@link CompositeDatabasePopulator}. ... */Connection mockedConnection, ...;DatabasePopulator mockedDatabasePopulator1, ...;DatabasePopulator mockedDatabasePopulator2, ...;CompositeDatabasePopulator populatornew CompositeDatabasePopulator(...)addPopulators(...)setPopulators(...)Set<DatabasePopulator> populatorsnew LinkedHashSet<DatabasePopulator>(...)// multiple// overrideEmbeddedDatabaseType.H2/** https://jira.spring.io/browse/SPR-15896 ... */// Set statement separator to double newline so that ";" is not// considered a statement separator within the source code of the// aliased function 'REVERSE'./** Unit tests for {@link ResourceDatabasePopulator}. ... */Resource script1, ...;Resource script2, ...;Resource script3, ...;ResourceDatabasePopulator databasePopulatordatabasePopulator.scriptsimport static ScriptUtils.executeSqlScript/** Integration tests for {@link ScriptUtils}. ... */import static ScriptUtils.DEFAULT_BLOCK_COMMENT_END_DELIMITERimport static ScriptUtils.DEFAULT_BLOCK_COMMENT_START_DELIMITERimport static ScriptUtils.DEFAULT_COMMENT_PREFIXESimport static ScriptUtils.DEFAULT_STATEMENT_SEPARATORimport static ScriptUtils.containsSqlScriptDelimitersimport static ScriptUtils.splitSqlScript/** Unit tests for {@link ScriptUtils}. ... */String rawStatement1String cleanedStatement1String rawStatement2String cleanedStatement2String rawStatement3String cleanedStatement3char delimString statement1String statement2String statement3splitScriptContainingComments(...)String statement4EncodedResource resource// SPR-13218// SPR-11560// Statement 4 addresses the error described in SPR-9982.// SPR-10330// SPR-9531// MySQL style escapes '\\'String DATASOURCE_BEAN_NAME, ...;StubDataSource expectedDataSourcenew StubDataSource(...)BeanFactoryDataSourceLookup lookupDataSourceLookupFailureException.classString DATA_SOURCE_NAME, ...;DataSource expectedDataSourceJndiDataSourceLookup lookupnew JndiDataSourceLookup(...) { ... }MapDataSourceLookup lookupnew MapDataSourceLookup(...)Map<> dataSourcesgetDataSources(...)Map<String,DataSource> dataSourcesStubDataSource overridenDataSource// must be idempotent (i.e. the following lookup must still work);// must override existing entry/** Stub, do-nothing DataSource implementation. ... */doTestBatchUpdate(...)PreparedStatement preparedStatementDatabaseMetaData mockDatabaseMetaDataBatchSqlUpdate updatenew BatchSqlUpdate(...)getQueueCount(...)getRowsAffected(...).lengthgetRowsAffected(...)import TestDataSourceWrapperString SELECT_ID_FORENAME_NAMED_PARAMETERS_PARSED, ...;TestDataSourceWrapper testDataSourceSqlQuery<?> querydoTestCustomerQuery(...)List<?> queryResultsCallableStatement callableStatementStoredProcedure adderMap<String,Object> inInteger idimport DriverManagerDataSourcenew TestRdbmsOperation(...)TestRdbmsOperation operation, ...;Map<String,String> paramsSqlOperation operationnew SqlOperation(...) { ... }new SqlParameter[]String SELECT_ID, ...;//FIXME inline?String SELECT_ID_WHERE, ...;String SELECT_FORENAME, ...;String SELECT_FORENAME_EMPTY, ...;String SELECT_ID_FORENAME_WHERE, ...;String SELECT_ID_FORENAME_NAMED_PARAMETERS, ...;String SELECT_ID_FORENAME_WHERE_ID_IN_LIST_1, ...;String SELECT_ID_FORENAME_WHERE_ID_IN_LIST_2, ...;String SELECT_ID_FORENAME_WHERE_ID_REUSED_1, ...;String SELECT_ID_FORENAME_WHERE_ID_REUSED_2, ...;String SELECT_ID_FORENAME_WHERE_ID, ...;...[] COLUMN_TYPES, ...;SqlQuery<Integer> querynew MappingSqlQueryWithParameters<Integer>(...) { ... }MappingSqlQuery<Integer> querynew MappingSqlQuery<Integer>(...) { ... }String[] dbResultsStringQuery querynew StringQuery(...)CustomerQuery querynew CustomerQuery(...)findCustomer(...)PreparedStatement preparedStatement2Customer cust2List<Customer> listResultSet.TYPE_SCROLL_SENSITIVEMap<String,Integer> paramsdoTestNamedParameterCustomerQuery(...)List<Customer> custfindCustomers(...)CustomerUpdateQuery querynew CustomerUpdateQuery(...)Map<Integer,String> valuesupdateString(...)// Query should not succeed since parameter declaration did not specify parameter nameString UPDATE, ...;String UPDATE_INT, ...;String UPDATE_INT_INT, ...;String UPDATE_STRING, ...;String UPDATE_OBJECTS, ...;String INSERT_GENERATE_KEYS, ...;Updater pcnew Updater(...)IntUpdater pcnew IntUpdater(...)IntIntUpdater pcnew IntIntUpdater(...)doTestNamedParameterUpdate(...)NamedParameterUpdater pcnew NamedParameterUpdater(...)updateByNamedParam(...)StringUpdater pcnew StringUpdater(...)MixedUpdater pcnew MixedUpdater(...)GeneratedKeysUpdater pcnew GeneratedKeysUpdater(...)KeyHolder generatedKeyHolderConstructorUpdater pcnew ConstructorUpdater(...)MaxRowsUpdater pcnew MaxRowsUpdater(...)JdbcUpdateAffectedIncorrectNumberOfRowsException.classRequiredRowsUpdater pcnew RequiredRowsUpdater(...)setMaxRowsAffected(...)setRequiredRowsAffected(...)import SimpleRowCountCallbackHandlerimport AbstractSqlTypeValueimport ConnectionHolderimport static ArgumentMatchers.startsWithboolean verifyClosedAfter, ...;NoSuchStoredProcedure sprocnew NoSuchStoredProcedure(...)NoSuchStoredProcedure.SQLAddInvoice addernew AddInvoice(...)int idAddInvoiceUsingObjectArray addernew AddInvoiceUsingObjectArray(...)AddInvoice.SQLtestAddInvoice(...)testAddInvoiceUsingObjectArray(...)/** Confirm no connection was used to get metadata. Does not use superclass replay ... */TestJdbcTemplate tnew TestJdbcTemplate(...)StoredProcedureConfiguredViaJdbcTemplate spnew StoredProcedureConfiguredViaJdbcTemplate(...)StoredProcedureConfiguredViaJdbcTemplate.SQLt.calls/** Confirm our JdbcTemplate is used */NullArg nanew NullArg(...)NullArg.SQLthis.verifyClosedAfternew UnnamedParameterStoredProcedure(...)MissingParameterStoredProcedure mpnew MissingParameterStoredProcedure(...)StoredProcedureExceptionTranslator sprocnew StoredProcedureExceptionTranslator(...)StoredProcedureExceptionTranslator.SQLCustomDataException.classStoredProcedureWithResultSet sprocnew StoredProcedureWithResultSet(...)StoredProcedureWithResultSet.SQLStoredProcedureWithResultSetMapped sprocnew StoredProcedureWithResultSetMapped(...)Map<String,Object> resList<String> rsStoredProcedureWithResultSetMapped.SQLResultSet resultSet1ResultSetMetaData resultSetMetaDataList<String> rs1List<Object> rs2Map<String,String> m2Number nsetSkipResultsProcessing(...)setSkipUndeclaredResults(...)ParameterMapperStoredProcedure pmspnew ParameterMapperStoredProcedure(...)executeTest(...)ParameterMapperStoredProcedure.SQLint[] testValSqlTypeValueStoredProcedure stvspnew SqlTypeValueStoredProcedure(...)SqlTypeValueStoredProcedure.SQLNumericWithScaleStoredProcedure nwsspnew NumericWithScaleStoredProcedure(...)NumericWithScaleStoredProcedure.SQLString SQL, ...;Map<String,Integer> inMap<String,String> innew SimpleRowCountCallbackHandler(...)SimpleRowCountCallbackHandler handler, ...;this.handlernew TestParameterMapper(...)Map<String,Object> inParmsString testValueMap<String,AbstractSqlTypeValue> innew HashMap<String,AbstractSqlTypeValue>(...)new AbstractSqlTypeValue(...) { ... }new SQLExceptionTranslator(...) { ... }new CustomDataException(...)// Will fail without the following, because we're not able to get a connection// from the DataSource here if we need to create an ExceptionTranslator// Shouldn't succeed in creating stored procedure with unnamed parameter// assertEquals(Connection.class, con.getClass());// assertEquals(Types.ARRAY, type);// assertEquals("NUMBER", typeName);/** Tests for custom {@link SQLExceptionTranslator}. ... */SQLErrorCodes codesSQLErrorCodeSQLExceptionTranslator sextDataAccessException exFor4200DataAccessException exFor2DataAccessException exFor3CustomSQLExceptionTranslatorRegistrarTests.classsetSqlErrorCodes(...)TransientDataAccessResourceException.class/** Custom SQLException translation for testing. ... */import HanaSequenceMaxValueIncrementerimport HsqlMaxValueIncrementerimport MySQLMaxValueIncrementerimport OracleSequenceMaxValueIncrementerimport PostgresSequenceMaxValueIncrementerHanaSequenceMaxValueIncrementer incrementernew HanaSequenceMaxValueIncrementer(...)setIncrementerName(...)setPaddingLength(...)nextLongValue(...)nextStringValue(...)HsqlMaxValueIncrementer incrementernew HsqlMaxValueIncrementer(...)setColumnName(...)setCacheSize(...)nextIntValue(...)setDeleteSpecificValues(...)MySQLMaxValueIncrementer incrementernew MySQLMaxValueIncrementer(...)OracleSequenceMaxValueIncrementer incrementernew OracleSequenceMaxValueIncrementer(...)PostgresSequenceMaxValueIncrementer incrementernew PostgresSequenceMaxValueIncrementer(...)/** Mock object based tests for {@code DatabaseStartupValidator}. ... */new DatabaseStartupValidator(...)DatabaseStartupValidator validator, ...;String validationQuerysetValidationQuery(...)/* Copyright 2003-2020 the original author or authors. ... */// ensure tests don't accidentally run too longPreparedStatement ps, ...;InputStream bisReader strimport LazyConnectionDataSourceProxyimport TransactionAwareDataSourceProxyJdbcTransactionManager tm, ...;new JdbcTransactionManager(...)JdbcTransactionManager.SYNCHRONIZATION_NEVERJdbcTransactionManager tm2ConcurrencyFailureException.class/** Unit tests for {@link JdbcUtils}. ... *//** Tests for {@link KeyHolder} and {@link GeneratedKeyHolder}. ... */KeyHolder kh, ...;DataRetrievalFailureException.classimport DataTruncationsetBadSqlGrammarCodes(...)setInvalidResultSetAccessCodes(...)setDuplicateKeyCodes(...)setDataAccessResourceFailureCodes(...)setDataIntegrityViolationCodes(...)setCannotAcquireLockCodes(...)setDeadlockLoserCodes(...)setCannotSerializeTransactionCodes(...)SQLErrorCodes ERROR_CODES, ...;SQLExceptionTranslator sextSQLException badSqlExBadSqlGrammarException bsgexSQLException invResExInvalidResultSetAccessException irsexSQLException dupKeyExDataAccessException dksexSQLException sexBadSqlGrammarException bsgex2getSQLException(...)checkTranslation(...)DataAccessResourceFailureException.classDataIntegrityViolationException.classCannotAcquireLockException.classDeadlockLoserDataAccessException.classCannotSerializeTransactionException.classDataAccessException exBatchUpdateException batchUpdateExsetNextException(...)SQLException dataAccessExDataTruncation dataTruncationnew DataTruncation(...)DataAccessResourceFailureException daexString TASKString SQLnew DataAccessException(...) { ... }SQLException intVioExnew SQLErrorCodeSQLExceptionTranslator(...) { ... }DataIntegrityViolationException diexSQLErrorCodes customErrorCodesnew CustomSQLErrorCodesTranslation(...)setErrorCodes(...)setExceptionClass(...)CustomErrorCodeException.classsetCustomTranslations(...)SQLException connectionExceptionSQLException duplicateKeyException// Test fallback. We assume that no database will ever return this error code,// but 07xxx will be bad grammar picked up by the fallback SQLState translator// Shouldn't custom translate this// Should custom translate this// Shouldn't custom translate this - invalid class/** Tests for SQLErrorCodes loading. ... *//** Check that a default instance returns empty error codes for an unknown database. */getBadSqlGrammarCodes(...).lengthgetDataIntegrityViolationCodes(...).length/** Check that a known database produces recognizable codes. */assertIsOracle(...)getPermissionDeniedCodes(...).lengthgetDuplicateKeyCodes(...).lengthgetDataAccessResourceFailureCodes(...).lengthgetCannotAcquireLockCodes(...).lengthgetDeadlockLoserCodes(...).lengthTestSQLErrorCodesFactory sfnew TestSQLErrorCodesFactory(...)int lookups, ...;SQLErrorCodesFactory.SQL_ERROR_CODE_DEFAULT_PATHSQLErrorCodesFactory.SQL_ERROR_CODE_OVERRIDE_PATH/** Check that user defined error codes take precedence. */SQLErrorCodesFactoryTests.class/** Check that custom error codes take precedence. */CustomSQLErrorCodesTranslation translationgetCustomTranslations(...).lengthgetErrorCodes(...).lengthassertIsEmpty(...)SQLException expectedSQLExceptionSQLErrorCodesFactory secfSQLErrorCodes sec2getErrorCodesFromDataSource(...)assertIsSQLServer(...)assertIsHsql(...)assertIsDB2(...)assertIsHana(...)/** Check that wild card database name works. */WildcardSQLErrorCodesFactory factorynew WildcardSQLErrorCodesFactory(...)// These had better be a Bad SQL Grammar code// This had better NOT be// This had better be a Bad SQL Grammar code// Should have only one more lookup// Should have failed to load without error// Should have loaded without error// Guaranteed to be on the classpath, but most certainly NOT XML/** Unit tests for custom SQLException translation. ... */setCustomSqlExceptionTranslatorClass(...)CustomSqlExceptionTranslator.classSQLExceptionTranslator sext, ...;SQLException badSqlGrammarExceptionExnewSQLDataException(...)SQLException dataAccessResourceEx/** Class to generate Java 6 SQLException subclasses for testing purposes. ... */new SQLDataException(...)new SQLIntegrityConstraintViolationException(...)new SQLInvalidAuthorizationSpecException(...)new SQLNonTransientConnectionException(...)new SQLSyntaxErrorException(...)new SQLTransactionRollbackException(...)new SQLTransientConnectionException(...)new SQLTimeoutException(...)new SQLRecoverableException(...)SQLException dataIntegrityViolationExDataIntegrityViolationException divexSQLException featureNotSupExnewSQLFeatureNotSupportedException(...)InvalidDataAccessApiUsageException idaexSQLException dataIntegrityViolationEx2newSQLIntegrityConstraintViolationException(...)DataIntegrityViolationException divex2SQLException permissionDeniedExnewSQLInvalidAuthorizationSpecException(...)PermissionDeniedDataAccessException pdaexnewSQLNonTransientConnectionException(...)DataAccessResourceFailureException darexSQLException badSqlEx2newSQLSyntaxErrorException(...)SQLException tranRollbackExnewSQLTransactionRollbackException(...)ConcurrencyFailureException cfexSQLException transientConnExnewSQLTransientConnectionException(...)TransientDataAccessResourceException tdarexSQLException transientConnEx2newSQLTimeoutException(...)QueryTimeoutException tdarex2SQLException recoverableExnewSQLRecoverableException(...)RecoverableDataAccessException rdaex2SQLException sexEctBadSqlGrammarException bsgEctSQLException sexFbtBadSqlGrammarException bsgFbtSQLException sexFbt2DataAccessResourceFailureException darfFbt// Test classic error code translation. We should move there next if the exception we pass in is not one// of the new sub-classes.// and 08xxx will be data resource failure (non-transient) picked up by the fallback SQLState translatorSQLStateSQLExceptionTranslator trans, ...;// also allow chain of translators? default if can't do specific?// ALSO CHECK CHAIN of SQLExceptions!?this.transBadSqlGrammarException ex/** PostgreSQL can return null. ... */// OK// One char's not allowedString REASON, ...;String TASK, ...;SQLExceptionTranslator translatorDataAccessException daxResultSetWrappingSqlRowSet rowSet, ...;Method rsetMethod rowsetResultSetWrappingSqlRowSet.classInvocationTargetException.classnew Consumer<InvocationTargetException>(...) { ... }isExactlyInstanceOf(...)InvalidResultSetAccessException.class/** Runtime exception mirroring the JMS IllegalStateException. ... *//** Runtime exception mirroring the JMS InvalidClientIDException. ... *//** Runtime exception mirroring the JMS InvalidDestinationException. ... *//** Runtime exception mirroring the JMS InvalidSelectorException. ... */import JMSException/** Base class for exception thrown by the framework whenever it ... *//** Constructor that takes a message. ... *//** Constructor that takes a message and a root cause. ... *//** Constructor that takes a plain root cause, intended for ... *//** Convenience method to get the vendor specific error code if ... *//** Return the detail message, including the message from the linked exception ... */Exception linkedExgetLinkedException(...)String linkedMessageString causeMessage/** Runtime exception mirroring the JMS JMSSecurityException. ... *//** Runtime exception mirroring the JMS MessageEOFException. ... *//** Runtime exception mirroring the JMS MessageFormatException. ... *//** Runtime exception mirroring the JMS MessageNotReadableException. ... *//** Runtime exception mirroring the JMS MessageNotWriteableException. ... *//** Runtime exception mirroring the JMS ResourceAllocationException. ... *//** Runtime exception mirroring the JMS TransactionInProgressException. ... *//** Runtime exception mirroring the JMS TransactionRolledBackException. ... *//** JmsException to be thrown when no other matching subclass found. ... *//** Constructor that takes a root cause only. ... *//** Enable JMS listener annotated endpoints that are created under the cover ... */JmsBootstrapConfiguration.classimport JmsListenerConfigUtilsimport JmsListenerEndpointRegistry/** {@code @Configuration} class that registers a {@link JmsListenerAnnotationBeanPostProcessor} ... */JmsListenerConfigUtils.JMS_LISTENER_ANNOTATION_PROCESSOR_BEAN_NAMEnew JmsListenerAnnotationBeanPostProcessor(...)JmsListenerConfigUtils.JMS_LISTENER_ENDPOINT_REGISTRY_BEAN_NAMEnew JmsListenerEndpointRegistry(...)import MessageMapping/** Annotation that marks a method to be the target of a JMS message listener on the ... */JmsListeners.class/** The unique identifier of the container managing this endpoint. ... *//** The bean name of the {@link org.springframework.jms.config.JmsListenerContainerFactory} ... *//** The destination name for this listener, resolved through the container-wide ... *//** The name for the durable subscription, if any. *//** The JMS message selector expression, if any. ... *//** The concurrency limits for the listener, if any. Overrides the value defined ... */import JmsListenerContainerFactoryimport JmsListenerEndpointRegistrarimport MethodJmsListenerEndpointimport DefaultMessageHandlerMethodFactoryimport MessageHandlerMethodFactoryimport InvocableHandlerMethod/** Bean post-processor that registers methods annotated with {@link JmsListener} ... */new MessageHandlerMethodFactoryAdapter(...)new JmsListenerEndpointRegistrar(...)String DEFAULT_JMS_LISTENER_CONTAINER_FACTORY_BEAN_NAME, ...;/** The bean name of the default {@link JmsListenerContainerFactory}. */String containerFactoryBeanName, ...;JmsListenerEndpointRegistry endpointRegistry, ...;MessageHandlerMethodFactoryAdapter messageHandlerMethodFactory, ...;JmsListenerEndpointRegistrar registrar, ...;/** Set the name of the {@link JmsListenerContainerFactory} to use by default. ... */this.containerFactoryBeanName/** Set the {@link JmsListenerEndpointRegistry} that will hold the created ... */this.endpointRegistry/** Set the {@link MessageHandlerMethodFactory} to use to configure the message ... */setMessageHandlerMethodFactory(...)this.messageHandlerMethodFactoryMessageHandlerMethodFactory handlerMethodFactorygetMessageHandlerMethodFactory(...)Map<String,JmsListenerConfigurer> beansJmsListenerConfigurer.classList<JmsListenerConfigurer> configurersnew ArrayList<JmsListenerConfigurer>(...)JmsListenerConfigurer configurerconfigureJmsListeners(...)setContainerFactoryBeanName(...)getEndpointRegistry(...)JmsListenerEndpointRegistry.classsetEndpointRegistry(...)JmsListener.classMap<Method,Set<JmsListener>> annotatedMethodsMethodIntrospector.MetadataLookup<Set<JmsListener>>new MetadataLookup<Set<JmsListener>>(...) { ... }Set<JmsListener> listenerMethodsnew BiConsumer<Method,Set<JmsListener>>(...) { ... }new Consumer<JmsListener>(...) { ... }processJmsListener(...)/** Process the given {@link JmsListener} annotation on the given method, ... */MethodJmsListenerEndpoint endpointcreateMethodJmsListenerEndpoint(...)JmsListenerContainerFactory<?> factoryString containerFactoryBeanNamecontainerFactory(...)setBean(...)setMethod(...)setMostSpecificMethod(...)getEndpointId(...)setDestination(...)destination(...)selector(...)setSelector(...)subscription(...)setSubscription(...)concurrency(...)setConcurrency(...)JmsListenerContainerFactory<>.classregisterEndpoint(...)/** Instantiate an empty {@link MethodJmsListenerEndpoint} for further ... */new MethodJmsListenerEndpoint(...)id(...)/** A {@link MessageHandlerMethodFactory} adapter that offers a configurable underlying ... */MessageHandlerMethodFactory messageHandlerMethodFactory, ...;createInvocableHandlerMethod(...)createDefaultJmsHandlerMethodFactory(...)DefaultMessageHandlerMethodFactory defaultFactorynew DefaultMessageHandlerMethodFactory(...)// Apply JmsListenerConfigurer beans from the BeanFactory, if any// Determine JmsListenerEndpointRegistry bean from the BeanFactory// Set the custom handler method factory once resolved by the configurer// Actually register all listeners/** Optional interface to be implemented by a Spring managed bean willing ... *//** Callback allowing a {@link org.springframework.jms.config.JmsListenerEndpointRegistry ... *//** Container annotation that aggregates several {@link JmsListener} annotations. ... *//** Annotations and support classes for declarative JMS listener endpoints. */import ConnectionFactoryimport ExceptionListenerimport AbstractMessageListenerContainerimport QosSettingsimport MessageConverterimport DestinationResolver/** Base {@link JmsListenerContainerFactory} for Spring's base container implementation. ... */ConnectionFactory connectionFactory, ...;DestinationResolver destinationResolver, ...;MessageConverter messageConverter, ...;ExceptionListener exceptionListener, ...;Boolean sessionTransacted, ...;Integer sessionAcknowledgeMode, ...;Boolean pubSubDomain, ...;Boolean replyPubSubDomain, ...;QosSettings replyQosSettings, ...;Boolean subscriptionDurable, ...;Boolean subscriptionShared, ...;String clientId, ...;Integer phase, ...;Boolean autoStartup, ...;this.connectionFactorythis.destinationResolverthis.messageConverterthis.exceptionListenerthis.sessionTransactedthis.sessionAcknowledgeModethis.pubSubDomainthis.replyPubSubDomainthis.replyQosSettingsthis.subscriptionDurablethis.subscriptionSharedthis.clientIdC instancecreateContainerInstance(...)setConnectionFactory(...)setDestinationResolver(...)setMessageConverter(...)setExceptionListener(...)setSessionTransacted(...)setSessionAcknowledgeMode(...)setPubSubDomain(...)setReplyPubSubDomain(...)setReplyQosSettings(...)setSubscriptionDurable(...)setSubscriptionShared(...)setClientId(...)setPhase(...)initializeContainer(...)setupListenerContainer(...)/** Create an empty container instance. *//** Further initialize the specified container. ... */import MessageListenerimport MessageListenerContainerimport JmsActivationSpecConfigimport JmsMessageEndpointManager/** Base model for a JMS listener endpoint. ... */String destination, ...;String subscription, ...;String selector, ...;String concurrency, ...;/** Set the name of the destination for this endpoint. */this.destination/** Return the name of the destination for this endpoint. *//** Set the name for the durable subscription. */this.subscription/** Return the name for the durable subscription, if any. *//** Set the JMS message selector expression. ... *//** Return the JMS message selector expression, if any. *//** Set a concurrency for the listener, if any. ... */this.concurrency/** Return the concurrency for the listener, if any. */setupJmsListenerContainer(...)configureEndpoint(...)new JcaEndpointConfigurer(...)getDestination(...)setDestinationName(...)getSubscription(...)setSubscriptionName(...)getSelector(...)setMessageSelector(...)getConcurrency(...)setupMessageListener(...)/** Create a {@link MessageListener} that is able to serve this endpoint for the ... */createMessageListener(...)/** Return a description for this endpoint. ... */getEndpointDescription(...)/** Inner class to avoid a hard dependency on the JCA API. */setupJcaMessageContainer(...)AbstractMessageListenerContainer.classJmsMessageEndpointManager.classJmsActivationSpecConfig activationSpecConfiggetActivationSpecConfig(...)new JmsActivationSpecConfig(...)setActivationSpecConfig(...)/** Abstract parser for JMS listener container elements, providing support for ... */String FACTORY_ID_ATTRIBUTE, ...;String LISTENER_ELEMENT, ...;String DESTINATION_ATTRIBUTE, ...;String SUBSCRIPTION_ATTRIBUTE, ...;String SELECTOR_ATTRIBUTE, ...;String DESTINATION_RESOLVER_ATTRIBUTE, ...;String MESSAGE_CONVERTER_ATTRIBUTE, ...;String RESPONSE_DESTINATION_ATTRIBUTE, ...;String DESTINATION_TYPE_ATTRIBUTE, ...;String DESTINATION_TYPE_QUEUE, ...;String DESTINATION_TYPE_TOPIC, ...;String DESTINATION_TYPE_DURABLE_TOPIC, ...;String DESTINATION_TYPE_SHARED_TOPIC, ...;String DESTINATION_TYPE_SHARED_DURABLE_TOPIC, ...;String RESPONSE_DESTINATION_TYPE_ATTRIBUTE, ...;String CLIENT_ID_ATTRIBUTE, ...;String ACKNOWLEDGE_ATTRIBUTE, ...;String ACKNOWLEDGE_AUTO, ...;String ACKNOWLEDGE_CLIENT, ...;String ACKNOWLEDGE_DUPS_OK, ...;String ACKNOWLEDGE_TRANSACTED, ...;String TRANSACTION_MANAGER_ATTRIBUTE, ...;String CONCURRENCY_ATTRIBUTE, ...;String PHASE_ATTRIBUTE, ...;String PREFETCH_ATTRIBUTE, ...;MutablePropertyValues commonPropertiesparseCommonContainerProperties(...)MutablePropertyValues specificPropertiesparseSpecificContainerProperties(...)String factoryIdcreateContainerFactory(...)parseListener(...)PropertyValue messageConverterPvBeanDefinition containerDefcreateContainer(...)String containerBeanNameString responseDestinationBoolean pubSubDomainPropertyValue destinationResolverString destinationString subscriptionString selectorString concurrencyMutablePropertyValues propertiesString destinationTypeboolean pubSubDomainboolean subscriptionDurableboolean subscriptionSharedboolean replyPubSubDomainString replyDestinationTypeString clientIdString messageConverter/** Parse the common properties for all listeners as defined by the specified ... *//** Create the {@link BeanDefinition} for the container factory using the specified ... *//** Create the container {@link BeanDefinition} for the specified context. */String acknowledgeint acknowledgeModeSession.AUTO_ACKNOWLEDGESession.SESSION_TRANSACTEDSession.DUPS_OK_ACKNOWLEDGESession.CLIENT_ACKNOWLEDGE// If no bean id is given auto generate one using the ReaderContext's BeanNameGenerator// Register the listener and fire event// the default: queue// the default: same value as pubSubDomain/** Parser for the 'annotation-driven' element of the 'jms' namespace. ... */String endpointRegistryString containerFactoryString handlerMethodFactoryregisterDefaultEndpointRegistry(...)registerInfrastructureBean(...)// Register component for the surrounding <jms:annotation-driven> element.import ResourceAdapterimport JmsActivationSpecFactory/** A {@link JmsListenerContainerFactory} implementation to build a ... */ResourceAdapter resourceAdapter, ...;JmsActivationSpecFactory activationSpecFactory, ...;Object transactionManager, ...;this.resourceAdapterthis.activationSpecFactoryJmsMessageEndpointManager instancesetResourceAdapter(...)setActivationSpecFactory(...)setTransactionManager(...)new JmsMessageEndpointManager(...)import DefaultMessageListenerContainerimport BackOff/** A {@link JmsListenerContainerFactory} implementation to build a regular ... */Integer cacheLevel, ...;String cacheLevelName, ...;Integer maxMessagesPerTask, ...;Long receiveTimeout, ...;Long recoveryInterval, ...;BackOff backOff, ...;this.cacheLevelthis.cacheLevelNamethis.maxMessagesPerTaskthis.receiveTimeoutthis.recoveryIntervalthis.backOffnew DefaultMessageListenerContainer(...)setCacheLevel(...)setCacheLevelName(...)setMaxMessagesPerTask(...)setReceiveTimeout(...)setBackOff(...)setRecoveryInterval(...)/** Parser for the JMS {@code <jca-listener-container>} element. ... */String RESOURCE_ADAPTER_ATTRIBUTE, ...;String ACTIVATION_SPEC_FACTORY_ATTRIBUTE, ...;RootBeanDefinition factoryDefRootBeanDefinition containerDefparseListenerConfiguration(...)Integer acknowledgeModeparseAcknowledgeMode(...)String prefetchString activationSpecFactoryBeanNameString destinationResolverBeanNameString transactionManagerBeanNameString phaseString resourceAdapterBeanNameString JMS_LISTENER_ANNOTATION_PROCESSOR_BEAN_NAME, ...;/** The bean name of the internally managed JMS listener annotation processor. */String JMS_LISTENER_ENDPOINT_REGISTRY_BEAN_NAME, ...;/** The bean name of the internally managed JMS listener endpoint registry. *//** Factory of {@link MessageListenerContainer} based on a ... *//** Create a {@link MessageListenerContainer} for the given {@link JmsListenerEndpoint}. ... *//** Parser for the JMS {@code <listener-container>} element. ... */String CONTAINER_TYPE_ATTRIBUTE, ...;String CONTAINER_CLASS_ATTRIBUTE, ...;String CONNECTION_FACTORY_ATTRIBUTE, ...;String TASK_EXECUTOR_ATTRIBUTE, ...;String ERROR_HANDLER_ATTRIBUTE, ...;String CACHE_ATTRIBUTE, ...;String RECEIVE_TIMEOUT_ATTRIBUTE, ...;String RECOVERY_INTERVAL_ATTRIBUTE, ...;String BACK_OFF_ATTRIBUTE, ...;String containerTypeString containerClassboolean isSimpleContainerString connectionFactoryBeanNameString taskExecutorBeanNameString errorHandlerBeanNameString receiveTimeoutString backOffBeanNameString recoveryInterval// not supported// Parse listener specific settings// No need to consider this if back-off is set/** Model for a JMS listener endpoint. Can be used against a ... *//** Return the id of this endpoint. *//** Setup the specified message listener container with the model ... *//** Helper bean for registering {@link JmsListenerEndpoint} with a {@link JmsListenerEndpointRegistry}. ... */new ArrayList<JmsListenerEndpointDescriptor>(...)this.endpointDescriptorsJmsListenerContainerFactory<?> containerFactory, ...;List<JmsListenerEndpointDescriptor> endpointDescriptors, ...;boolean startImmediately, ...;/** Set the {@link JmsListenerEndpointRegistry} instance to use. *//** Return the {@link JmsListenerEndpointRegistry} instance for this ... *//** Return the custom {@link MessageHandlerMethodFactory} to use, if any. *//** Set the {@link JmsListenerContainerFactory} to use in case a {@link JmsListenerEndpoint} ... */this.containerFactory/** Set the bean name of the {@link JmsListenerContainerFactory} to use in case ... *//** A {@link BeanFactory} only needs to be available in conjunction with ... */registerAllEndpoints(...)JmsListenerEndpointDescriptor descriptorregisterListenerContainer(...)descriptor.endpointresolveContainerFactory(...)this.startImmediatelydescriptor.containerFactory/** Register a new {@link JmsListenerEndpoint} alongside the ... */new JmsListenerEndpointDescriptor(...)/** Register a new {@link JmsListenerEndpoint} using the default ... */JmsListenerEndpoint endpoint, ...;this.endpoint// trigger immediate startup// Consider changing this if live change of the factory is required...// Factory may be null, we defer the resolution right before actually creating the container// register and start immediately/** Creates the necessary {@link MessageListenerContainer} instances for the ... */new ConcurrentHashMap<String,MessageListenerContainer>(...)Map<String,MessageListenerContainer> listenerContainers, ...;boolean contextRefreshed, ...;this.contextRefreshed/** Return the {@link MessageListenerContainer} with the specified id or ... */this.listenerContainers/** Return the ids of the managed {@link MessageListenerContainer} instance(s). ... *//** Return the managed {@link MessageListenerContainer} instance(s). *//** Create a message listener container for the given {@link JmsListenerEndpoint}. ... */MessageListenerContainer containercreateListenerContainer(...)startIfNecessary(...)/** Create and start a new container using the specified factory. */MessageListenerContainer listenerContainerint containerPhase// Delegating implementation of SmartLifecyclegetListenerContainers(...)Collection<MessageListenerContainer> listenerContainersAggregatingCallback aggregatingCallbacknew AggregatingCallback(...)/** Start the specified {@link MessageListenerContainer} if it should be started ... */Runnable finishCallback, ...;this.finishCallbackdecrementAndGet(...)// a custom phase value/** A {@link org.springframework.beans.factory.xml.NamespaceHandler} ... */new JmsListenerContainerParser(...)new JcaListenerContainerParser(...)new AnnotationDrivenJmsBeanDefinitionParser(...)import MessagingMessageListenerAdapterimport SendTo/** A {@link JmsListenerEndpoint} providing the method to invoke to process ... */Method mostSpecificMethod, ...;/** Set the actual bean instance to invoke this endpoint method on. *//** Set the method to invoke for processing a message managed by this endpoint. *//** Set the most specific method known for this endpoint's declaration. ... */this.mostSpecificMethod/** Set the {@link MessageHandlerMethodFactory} to use to build the ... *//** Set a value resolver for embedded placeholders and expressions. *//** Set the {@link BeanFactory} to use to resolve expressions (may be {@code null}). */MessagingMessageListenerAdapter messageListenercreateMessageListenerInstance(...)InvocableHandlerMethod invocableHandlerMethodgetDefaultResponseDestination(...)QosSettings responseQosSettingsgetReplyQosSettings(...)MessageConverter messageConvertergetMessageConverter(...)DestinationResolver destinationResolvergetDestinationResolver(...)setHandlerMethod(...)isReplyPubSubDomain(...)setDefaultResponseTopicName(...)setDefaultResponseQueueName(...)setResponseQosSettings(...)/** Create an empty {@link MessagingMessageListenerAdapter} instance. ... */new MessagingMessageListenerAdapter(...)/** Return the default response destination, if any. */SendTo anngetSendTo(...)Object[] destinationsdestinations.lengthSendTo.classimport SimpleMessageListenerContainernew SimpleMessageListenerContainer(...)/** A {@link JmsListenerEndpoint} simply providing the {@link MessageListener} to ... */MessageListener messageListener, ...;/** Set the {@link MessageListener} to invoke when a message matching ... */this.messageListener/** Return the {@link MessageListener} to invoke when a message matching ... */MessageListener listenergetMessageListener(...)/** Support package for declarative messaging configuration, ... */import MessageConsumerimport QueueReceiverimport Topicimport TopicSubscriber/** JMS MessageConsumer decorator that adapts all calls ... */MessageConsumer target, ...;getMessageSelector(...)getQueue(...)getTopic(...)getNoLocal(...)setMessageListener(...)receive(...)receiveNoWait(...)// It's a cached MessageConsumer...import CompletionListenerimport Destinationimport MessageProducerimport QueueSenderimport TopicPublisher/** JMS MessageProducer decorator that adapts calls to a shared MessageProducer ... */MessageProducer target, ...;Boolean originalDisableMessageID, ...;Boolean originalDisableMessageTimestamp, ...;Long originalDeliveryDelay, ...;int deliveryMode, ...;long timeToLive, ...;this.deliveryModegetDeliveryMode(...)this.timeToLivethis.originalDisableMessageIDgetDisableMessageID(...)setDisableMessageID(...)this.originalDisableMessageTimestampgetDisableMessageTimestamp(...)setDisableMessageTimestamp(...)this.originalDeliveryDelaygetDeliveryDelay(...)setDeliveryDelay(...)// It's a cached MessageProducer... reset properties only.import QueueSessionimport TemporaryQueueimport TemporaryTopicimport TopicSession/** {@link SingleConnectionFactory} subclass that adds {@link javax.jms.Session} ... */new ConcurrentHashMap<Integer,Deque<Session>>(...)int sessionCacheSize, ...;boolean cacheProducers, ...;boolean cacheConsumers, ...;ConcurrentMap<Integer,Deque<Session>> cachedSessions, ...;/** Create a new CachingConnectionFactory for bean-style usage. ... */setReconnectOnException(...)/** Create a new CachingConnectionFactory for the given target ... *//** Specify the desired size for the JMS Session cache (per JMS Session type). ... */this.sessionCacheSize/** Return the desired size for the JMS Session cache (per JMS Session type). *//** Specify whether to cache JMS MessageProducers per JMS Session instance ... */this.cacheProducers/** Return whether to cache JMS MessageProducers per JMS Session instance. *//** Specify whether to cache JMS MessageConsumers per JMS Session instance ... */this.cacheConsumers/** Return whether to cache JMS MessageConsumers per JMS Session instance. *//** Resets the Session cache as well. */this.cachedSessionsDeque<Session> sessionListresetConnection(...)/** Checks for a cached Session for the given mode. */new Function<Integer,Deque<Session>>(...) { ... }new ArrayDeque<Session>(...)getTargetSession(...)Session targetSessioncreateSession(...)getCachedSessionProxy(...)/** Wrap the given Session with a proxy that delegates every method call to it ... */SessionProxy.classQueueSession.classTopicSession.classnew CachedSessionInvocationHandler(...)/** Invocation handler for a cached JMS Session proxy. */new HashMap<DestinationCacheKey,MessageProducer>(...)new HashMap<ConsumerCacheKey,MessageConsumer>(...)Session target, ...;Deque<Session> sessionList, ...;Map<DestinationCacheKey,MessageProducer> cachedProducers, ...;Map<ConsumerCacheKey,MessageConsumer> cachedConsumers, ...;boolean transactionOpen, ...;this.sessionListgetSessionCacheSize(...)logicalClose(...)JMSException exphysicalClose(...)this.transactionOpenisCacheProducers(...)Destination destgetCachedProducer(...)isCacheConsumers(...)getCachedConsumer(...)DestinationCacheKey cacheKeynew DestinationCacheKey(...)MessageProducer producerthis.cachedProducerscreateProducer(...)new CachedMessageProducer(...)ConsumerCacheKey cacheKeynew ConsumerCacheKey(...)MessageConsumer consumerthis.cachedConsumerscreateSharedDurableConsumer(...)createSharedConsumer(...)createDurableSubscriber(...)createConsumer(...)new CachedMessageConsumer(...)boolean returnedgetTransacted(...)Iterator<Entry<ConsumerCacheKey,MessageConsumer>> itMap<>.Entry<ConsumerCacheKey,MessageConsumer>Entry<ConsumerCacheKey,MessageConsumer> entrygetKey(...).subscription/** Simple wrapper class around a Destination reference. ... */Destination destination, ...;String destinationString, ...;this.destinationStringotherKey.destinationgetDestinationString(...)destinationEquals(...)/** Simple wrapper class around a Destination and other consumer attributes. ... */Boolean noLocal, ...;boolean durable, ...;this.noLocalthis.durableConsumerCacheKey otherKeyotherKey.selectorotherKey.noLocalotherKey.subscriptionotherKey.durable// Now proceed with actual closing of the shared Connection...// Use hashCode of Session proxy.// Remain open in the session list.// Proceed to physical close from here...// If we get here, we're supposed to shut down.// Handle getTargetSession method: return underlying Session.// Destination argument being null is ok for a producer// let raw JMS invocation throw an exception if Destination (i.e. args[0]) is null// Preserve rollback-on-close semantics.// Physically close durable subscribers at time of Session close call.// Allow for multiple close calls...// Explicitly close all MessageProducers and MessageConsumers that// this Session happens to cache...// Now actually close the Session.// Effectively checking object equality as well as toString equality.// On WebSphere MQ, Destination objects do not implement equals...// Can't use a more specific hashCode since we can't rely on// this.destination.hashCode() actually being the same value// for equivalent destinations... Thanks a lot, WebSphere MQ!/** Implementation of the JMS ExceptionListener interface that supports chaining, ... */new ArrayList<ExceptionListener>(...)List<ExceptionListener> delegates, ...;/** List of ExceptionListeners. *//** Add an ExceptionListener to the chained delegate list. */this.delegates/** Return all registered ExceptionListener delegates (as array). */new ExceptionListener[]ExceptionListener listeneronException(...)import QueueConnectionimport QueueConnectionFactoryimport TopicConnectionimport TopicConnectionFactoryimport ResourceHolderSynchronization/** Helper class for managing a JMS {@link javax.jms.ConnectionFactory}, in particular ... */ConnectionFactoryUtils.class/** Release the given Connection, stopping it (if necessary) and eventually closing it. ... */shouldStop(...)/** Return the innermost target Session of the given Session. If the given ... */Session sessionToUse/** Determine whether the given JMS Session is transactional, that is, ... */JmsResourceHolder resourceHoldercontainsSession(...)/** Obtain a JMS Session that is synchronized with the current transaction, if any. ... */doGetTransactionalSession(...)new ResourceFactory(...) { ... }Session.classcreateConnection(...)/** Obtain a JMS QueueSession that is synchronized with the current transaction, if any. ... */QueueConnection.classcreateQueueConnection(...)createQueueSession(...)/** Obtain a JMS TopicSession that is synchronized with the current transaction, if any. ... */TopicConnection.classcreateTopicConnection(...)createTopicSession(...)JmsResourceHolder resourceHolderToUsenew JmsResourceHolder(...)boolean isExistingConaddConnection(...)addSession(...)new JmsResourceSynchronization(...)isSynchedLocalTransactionAllowed(...)/** Callback interface for resource creation. ... *//** Fetch an appropriate Session from the given JmsResourceHolder. ... *//** Fetch an appropriate Connection from the given JmsResourceHolder. ... *//** Create a new JMS Connection for registration with a JmsResourceHolder. ... *//** Create a new JMS Session for registration with a JmsResourceHolder. ... *//** Return whether to allow for a local JMS transaction that is synchronized with ... *//** Callback for resource cleanup at the end of a non-native JMS transaction ... */boolean transacted, ...;this.transactedcommitAll(...)new SynchedLocalTransactionFailedException(...)closeAll(...)import JMSContext/** {@link javax.jms.ConnectionFactory} implementation that delegates all calls ... */ConnectionFactory targetConnectionFactory, ...;boolean shouldStopConnections, ...;/** Set the target ConnectionFactory that this ConnectionFactory should delegate to. */this.targetConnectionFactory/** Return the target ConnectionFactory that this ConnectionFactory delegates to. */ConnectionFactory targetgetTargetConnectionFactory(...)/** Indicate whether Connections obtained from the target factory are supposed ... */this.shouldStopConnectionsobtainTargetConnectionFactory(...)import TransactionInProgressException/** Resource holder wrapping a JMS {@link Connection} and a JMS {@link Session}. ... */new ArrayDeque<Connection>(...)new HashMap<Connection,Deque<Session>>(...)JmsResourceHolder.classDeque<Connection> connections, ...;Deque<Session> sessions, ...;Map<Connection,Deque<Session>> sessionsPerConnection, ...;/** Create a new JmsResourceHolder that is open for resources to be added. ... *//** Create a new JmsResourceHolder for the given JMS Session. ... *//** Create a new JmsResourceHolder for the given JMS resources. ... *//** Return whether this resource holder is frozen, i.e. does not ... *//** Add the given Connection to this resource holder. */this.connections/** Add the given Session to this resource holder. *//** Add the given Session to this resource holder, ... */this.sessionsDeque<Session> sessionsthis.sessionsPerConnectionnew Function<Connection,Deque<Session>>(...) { ... }/** Determine whether the given Session is registered ... *//** Return this resource holder's default Connection, ... *//** Return this resource holder's Connection of the given type, ... *//** Return an existing original Session, if any. ... *//** Return this resource holder's default Session, ... *//** Return this resource holder's Session of the given type, ... *//** Return this resource holder's Session of the given type ... *//** Commit all of this resource holder's Sessions. ... */TransactionInProgressException exMethod getDataSourceMethodObject dsMethod getTargetDataSourceMethodNoSuchMethodException nsme/** Close all of this resource holder's Sessions and clear its state. ... */// Ignore -> can only happen in case of a JTA transaction.// IllegalStateException from sharing the underlying JDBC Connection// which typically gets committed first, e.g. with Oracle AQ --> ignore// Check for decorated DataSource a la Spring's DelegatingDataSource// No working getDataSource method - cannot perform DataSource transaction checkimport TransactionRolledBackExceptionimport InvalidIsolationLevelException/** {@link org.springframework.transaction.PlatformTransactionManager} implementation ... */boolean lazyResourceRetrieval, ...;/** Create a new JmsTransactionManager for bean-style usage. ... *//** Create a new JmsTransactionManager, given a ConnectionFactory. ... *//** Set the JMS ConnectionFactory that this instance should manage transactions for. *//** Return the JMS ConnectionFactory that this instance should manage transactions for. *//** Obtain the ConnectionFactory for actual use. ... */ConnectionFactory connectionFactorygetConnectionFactory(...)/** Specify whether this transaction manager should lazily retrieve a JMS ... */this.lazyResourceRetrieval/** Make sure the ConnectionFactory has been set. */obtainConnectionFactory(...)JmsTransactionObject txObjectnew JmsTransactionObject(...)setResourceHolder(...)hasResourceHolder(...)new InvalidIsolationLevelException(...)new LazyJmsResourceHolder(...)getOriginalSession(...)getResourceHolder(...)TransactionRolledBackException exnew UnexpectedRollbackException(...)/** Create a JMS Connection via this template's ConnectionFactory. ... *//** Create a JMS Session for the given Connection. ... *//** Lazily initializing variant of {@link JmsResourceHolder}, ... */boolean connectionInitialized, ...;boolean sessionInitialized, ...;initializeConnection(...)initializeSession(...)this.connectionInitializedthis.sessionInitialized/** JMS transaction object, representing a JmsResourceHolder. ... */JmsResourceHolder resourceHolder, ...;this.resourceHolder// If we got a TransactionAwareConnectionFactoryProxy, we need to perform transactions// for its underlying target ConnectionFactory, else JMS access code won't see// properly exposed transactions (i.e. transactions for the target ConnectionFactory)./** Subinterface of {@link javax.jms.Session} to be implemented by ... *//** Return the target Session of this proxy. ... *//** A JMS ConnectionFactory adapter that returns the same Connection ... */boolean reconnectOnException, ...;/** The target Connection. */Boolean pubSubMode, ...;/** A hint whether to create a queue or topic connection. */AggregatedExceptionListener aggregatedExceptionListener, ...;/** An internal aggregator allowing for per-connection ExceptionListeners. *//** Whether the shared Connection has been started. *//** Create a new SingleConnectionFactory for bean-style usage. ... *//** Create a new SingleConnectionFactory that always returns the given Connection. ... *//** Create a new SingleConnectionFactory that always returns a single Connection ... *//** Set the target ConnectionFactory which will be used to lazily ... *//** Return the target ConnectionFactory which will be used to lazily ... *//** Specify a JMS client ID for the single Connection created and exposed ... *//** Return a JMS client ID for the single Connection created and exposed ... *//** Specify an JMS ExceptionListener implementation that should be ... *//** Return the JMS ExceptionListener implementation that should be registered ... *//** Specify whether the single Connection should be reset (to be subsequently renewed) ... */this.reconnectOnException/** Return whether the single Connection should be renewed when ... *//** Make sure a Connection or ConnectionFactory has been set. */getSharedConnectionProxy(...)this.pubSubMode/** Obtain an initialized shared Connection. ... *//** Initialize the underlying shared Connection. ... */doCreateConnection(...)/** Exception listener callback that renews the underlying single Connection. ... *//** Close the underlying shared connection. ... *//** Reset the underlying shared Connection, to be reinitialized on next access. ... */ConnectionFactory cfgetClientId(...)setClientID(...)this.aggregatedExceptionListenerisReconnectOnException(...)getExceptionListener(...)ExceptionListener listenerToUsenew AggregatedExceptionListener(...)this.aggregatedExceptionListener.delegates/** Template method for obtaining a (potentially cached) Session. ... *//** Create a default Session for this ConnectionFactory, ... */boolean transactedint ackMode/** Close the given Connection. ... */new SharedConnectionInvocationHandler(...)/** Invocation handler for a cached JMS Connection proxy. */ExceptionListener localExceptionListener, ...;boolean locallyStarted, ...;InvocationHandler otherHandlerString currentClientIdgetClientID(...)Integer modethis.localExceptionListeneraggregatedExceptionListener.delegateslocalStart(...)localStop(...)Integer ackModethis.locallyStartedSingleConnectionFactory.this/** Internal aggregated ExceptionListener for handling the internal ... */new LinkedHashSet<ExceptionListener>(...)Set<ExceptionListener> delegates, ...;Set<ExceptionListener> copy// Determine JMS API arguments...// Now actually call the appropriate JMS factory method...// Use hashCode of containing SingleConnectionFactory.// Handle setClientID method: throw exception if not compatible.// Handle setExceptionListener method: add to the chain.// Default: JMS 2.0 createSession() method// JMS 2.0 createSession(int) method// JMS 1.1 createSession(boolean, int) method// Iterate over temporary copy in order to avoid ConcurrentModificationException,// since listener invocations may in turn trigger registration of listeners.../** Extension of the {@code javax.jms.ConnectionFactory} interface, ... *//** Should we stop the Connection, obtained from this ConnectionFactory? ... */import JmsException/** Exception thrown when a synchronized local transaction failed to complete ... *//** Create a new SynchedLocalTransactionFailedException. ... *//** Proxy for a target JMS {@link javax.jms.ConnectionFactory}, adding awareness of ... */boolean synchedLocalTransactionAllowed, ...;/** Create a new TransactionAwareConnectionFactoryProxy. *//** Create a new TransactionAwareConnectionFactoryProxy. ... */setTargetConnectionFactory(...)/** Return the target ConnectionFactory that this ConnectionFactory should delegate to. *//** Set whether to allow for a local JMS transaction that is synchronized with a ... */this.synchedLocalTransactionAllowed/** Return whether to allow for a local JMS transaction that is synchronized ... */Connection targetConnectionQueueConnection targetConnectionTopicConnection targetConnectionnew TransactionAwareConnectionInvocationHandler(...)/** Invocation handler that exposes transactional Sessions for the underlying Connection. */getTransactionalSession(...)getCloseSuppressingSessionProxy(...)QueueSession sessiongetTransactionalQueueSession(...)TopicSession sessiongetTransactionalTopicSession(...)new CloseSuppressingSessionInvocationHandler(...)/** Invocation handler that suppresses close calls for a transactional JMS Session. */new TransactionInProgressException(...)// Invocation on SessionProxy interface coming in...// Handle close method: not to be closed within a transaction.// Invoke method on target Session./** An adapter for a target JMS {@link javax.jms.ConnectionFactory}, applying the ... */new NamedThreadLocal<JmsUserCredentials>(...)ThreadLocal<JmsUserCredentials> threadBoundCredentials, ...;/** Set the username that this adapter should use for retrieving Connections. ... *//** Set the password that this adapter should use for retrieving Connections. ... */new JmsUserCredentials(...)JmsUserCredentials threadCredentials/** Delegate the call straight to the target ConnectionFactory. *//** This implementation delegates to the {@code createConnection(username, password)} ... */doCreateQueueConnection(...)/** Delegate the call straight to the target QueueConnectionFactory. *//** This implementation delegates to the {@code createQueueConnection(username, password)} ... */QueueConnectionFactory queueFactorydoCreateTopicConnection(...)/** Delegate the call straight to the target TopicConnectionFactory. *//** This implementation delegates to the {@code createTopicConnection(username, password)} ... */TopicConnectionFactory queueFactory/** Provides a PlatformTransactionManager implementation for a single ... */import QueueBrowser/** Callback for browsing the messages in a JMS queue. ... *//** Perform operations on the given {@link javax.jms.Session} and ... */import MessagePostProcessorimport MessageReceivingOperationsimport MessageRequestReplyOperationsimport MessageSendingOperations/** A specialization of {@link MessageSendingOperations}, {@link MessageReceivingOperations} ... *//** Send a message to the given destination. ... *//** Convert the given Object to serialized form, possibly using a ... *//** Receive a message from the given destination. ... *//** Receive a message from the given destination and convert its payload to the ... *//** Send a request message and receive the reply from the given destination. ... *//** Convert the given request Object to serialized form, possibly using a ... */import InvalidDestinationExceptionimport MessagingMessageConverterimport SimpleMessageConverterimport MessageConversionExceptionimport AbstractMessagingTemplateimport DestinationResolutionException/** An implementation of {@link JmsMessageOperations}. ... */new MessagingMessageConverter(...)JmsTemplate jmsTemplate, ...;MessageConverter jmsMessageConverter, ...;boolean converterSet, ...;String defaultDestinationName, ...;/** Constructor for use with bean properties. ... *//** Create a {@code JmsMessagingTemplate} instance with the JMS {@link ConnectionFactory} ... */this.jmsTemplatenew JmsTemplate(...)/** Create a {@code JmsMessagingTemplate} instance with the {@link JmsTemplate} to use. *//** Set the ConnectionFactory to use for the underlying {@link JmsTemplate}. ... *//** Return the ConnectionFactory that the underlying {@link JmsTemplate} uses. ... *//** Set the {@link JmsTemplate} to use. *//** Return the configured {@link JmsTemplate}. *//** Set the {@link MessageConverter} to use to convert a {@link Message} from ... */this.jmsMessageConverterthis.converterSet/** Return the {@link MessageConverter} to use to convert a {@link Message} ... *//** Configure the default destination name to use in send methods that don't have ... */this.defaultDestinationName/** Return the configured default destination name. */setPayloadConverter(...)Destination defaultDestinationgetDefaultDestination(...)getRequiredDefaultDestinationName(...)convertAndSend(...)Message<?> messagedoConvert(...)receiveAndConvert(...)doReceive(...)sendAndReceive(...)doSendAndReceive(...)convertSendAndReceive(...)Message<?> requestMessageMessage<?> replyMessagefromMessage(...)obtainJmsTemplate(...)createMessageCreator(...)JmsException exconvertJmsException(...)Message jmsMessageconvertJmsMessage(...)new MessagingMessageCreator(...)getJmsMessageConverter(...)getDefaultDestinationName(...)new MessageConversionException(...)new DestinationResolutionException(...)Message<?> message, ...;toMessage(...)/** Specifies a basic set of JMS operations. ... *//** Execute the action specified by the given action object within a JMS Session. ... *//** Send messages to the default JMS destination (or one specified ... *//** Send messages to a JMS destination. The callback gives access to the JMS Session ... *//** Send a message to the default destination. ... *///---------------------------------------------------------------------------------------// Convenience methods for sending messages/** Send a message to the specified destination. ... *//** Send the given object to the default destination, converting the object ... */// Convenience methods for sending auto-converted messages/** Send the given object to the specified destination, converting the object ... *//** Receive a message synchronously from the default destination, but only ... */// Convenience methods for receiving messages/** Receive a message synchronously from the specified destination, but only ... */// Convenience methods for receiving auto-converted messages/** Send a request message and receive the reply from a default destination. The ... */// Convenience methods for sending messages to and receiving the reply from a destination/** Send a message and receive the reply from the specified destination. The ... *//** Browse messages in the default JMS queue. The callback gives access to the JMS ... */// Convenience methods for browsing messages/** Browse messages in a JMS queue. The callback gives access to the JMS Session ... *//** Browse selected messages in a JMS queue. The callback gives access to the JMS ... */import DeliveryModeimport ConnectionFactoryUtilsimport JmsResourceHolderimport JmsUtilsimport JmsDestinationAccessor/** Helper class that simplifies synchronous JMS access code. ... */new JmsTemplateResourceFactory(...)Message.DEFAULT_DELIVERY_MODEMessage.DEFAULT_PRIORITYMessage.DEFAULT_TIME_TO_LIVEJmsTemplateResourceFactory transactionalResourceFactory, ...;/** Internal ResourceFactory adapter for interacting with ConnectionFactoryUtils. */Object defaultDestination, ...;boolean messageIdEnabled, ...;boolean messageTimestampEnabled, ...;boolean pubSubNoLocal, ...;long receiveTimeout, ...;long deliveryDelay, ...;boolean explicitQosEnabled, ...;/** Create a new JmsTemplate for bean-style usage. ... */initDefaultStrategies(...)/** Create a new JmsTemplate, given a ConnectionFactory. ... *//** Initialize the default implementations for the template's strategies: ... */new SimpleMessageConverter(...)/** Set the destination to be used on send/receive operations that do not ... */this.defaultDestination/** Return the destination to be used on send/receive operations that do not ... *//** Set the destination name to be used on send/receive operations that ... *//** Return the destination name to be used on send/receive operations that ... *//** Set the message converter for this template. Used to resolve ... *//** Return the message converter for this template. */MessageConverter converter/** Set whether message IDs are enabled. Default is "true". ... */this.messageIdEnabled/** Return whether message IDs are enabled. *//** Set whether message timestamps are enabled. Default is "true". ... */this.messageTimestampEnabled/** Return whether message timestamps are enabled. *//** Set whether to inhibit the delivery of messages published by its own connection. ... */this.pubSubNoLocal/** Return whether to inhibit the delivery of messages published by its own connection. *//** Set the timeout to use for receive calls (in milliseconds). ... *//** Return the timeout to use for receive calls (in milliseconds). *//** Set the delivery delay to use for send calls (in milliseconds). ... */this.deliveryDelay/** Return the delivery delay to use for send calls (in milliseconds). *//** Set if the QOS values (deliveryMode, priority, timeToLive) ... */this.explicitQosEnabled/** If "true", then the values of deliveryMode, priority, and timeToLive ... *//** Set the {@link QosSettings} to use when sending a message. ... */setExplicitQosEnabled(...)setDeliveryMode(...)/** Set whether message delivery should be persistent or non-persistent, ... */DeliveryMode.PERSISTENTDeliveryMode.NON_PERSISTENT/** Set the delivery mode to use when sending a message. ... *//** Return the delivery mode to use when sending a message. *//** Set the priority of a message when sending. ... *//** Return the priority of a message when sending. *//** Set the time-to-live of the message when sending. ... *//** Return the time-to-live of the message when sending. */// JmsOperations execute methods/** Execute the action specified by the given action object within a ... */Connection conToCloseSession sessionToClosethis.transactionalResourceFactorydoInJms(...)convertJmsAccessException(...)closeSession(...)String defaultDestinationNamenew SessionCallback<T>(...) { ... }closeMessageProducer(...)Destination destinationresolveDestinationName(...)new SessionCallback<Object>(...) { ... }/** Send the given JMS message. ... */Message messagecreateMessage(...)isSessionLocallyTransacted(...)commitIfNecessary(...)/** Actually send the given JMS message. ... */isExplicitQosEnabled(...)new MessageCreator(...) { ... }getRequiredMessageConverter(...)Message msgpostProcessMessage(...)receiveSelected(...)new SessionCallback<Message>(...) { ... }/** Receive a JMS message. ... *//** Actually receive a JMS message. ... */long timeoutgetReceiveTimeout(...)receiveFromConsumer(...)getTimeToLiveInMillis(...)isClientAcknowledge(...)acknowledge(...)closeMessageConsumer(...)doConvertFromMessage(...)/** Extract the content from the given JMS message. ... */executeLocal(...)/** Send a request message to the given {@link Destination} and block until ... */TemporaryQueue responseQueueMessage requestMessagecreateTemporaryQueue(...)setJMSReplyTo(...)/** A variant of {@link #execute(SessionCallback, boolean)} that explicitly ... */Queue defaultQueuegetDefaultQueue(...)browse(...)browseSelected(...)QueueBrowser browsercreateBrowser(...)closeQueueBrowser(...)Queue queue/** Check whether the given Session is locally transacted, that is, whether ... */isSessionTransacted(...)isSessionTransactional(...)/** Create a JMS MessageProducer for the given Session and Destination, ... */doCreateProducer(...)isMessageIdEnabled(...)isMessageTimestampEnabled(...)/** Create a raw JMS MessageProducer for the given Session and Destination. ... *//** Create a JMS MessageConsumer for the given Session and Destination. ... */isPubSubDomain(...)isPubSubNoLocal(...)/** ResourceFactory implementation that delegates to this template's protected callback methods. */ConnectionFactoryUtils.ResourceFactoryJmsTemplate.this// Check commit - avoid commit call within a JTA transaction.// Transacted session created by this template -> commit.// Use transaction timeout (if available).// Commit necessary - but avoid commit call within a JTA transaction.// Manually acknowledge message, if any.// Only pass in the NoLocal flag in case of a Topic:// Some JMS providers, such as WebSphere MQ 6.0, throw IllegalStateException// in case of the NoLocal flag being specified for a Queue./** Creates a JMS message given a {@link Session}. ... *//** Create a {@link Message} to be sent. ... *//** To be used with JmsTemplate's send method that converts an object to a message. ... *//** Process the given message. ... *//** Callback for sending a message to a JMS destination. ... *//** Perform operations on the given {@link Session} and {@link MessageProducer}. ... *//** Callback for executing any number of operations on a provided {@link Session}. ... *//** Execute any number of operations against the supplied JMS {@link Session}, ... *//** Core package of the JMS support. ... */import JmsTemplate/** Convenient super class for application classes that need JMS access. ... *//** Set the JMS connection factory to be used by the gateway. ... */createJmsTemplate(...)/** Create a JmsTemplate for the given ConnectionFactory. ... *//** Return the JMS ConnectionFactory used by the gateway. *//** Set the JmsTemplate for the gateway. ... *//** Return the JmsTemplate for the gateway. */initGateway(...)/** Classes supporting the {@code org.springframework.jms.core} package. ... *//** Common base class for all containers which need to implement listening ... */Connection sharedConnection, ...;boolean sharedConnectionStarted, ...;Object sharedConnectionMonitor, ...;List<Object> pausedTasks, ...;Object lifecycleMonitor, ...;/** Specify the JMS client ID for a shared Connection created and used ... *//** Return the JMS client ID for the shared Connection created and used ... *//** Set whether to automatically start the container after initialization. ... *//** Specify the phase in which this container should be started and ... *//** Return the phase in which this container will be started and stopped. *//** Return the bean name that this listener container has been assigned ... *//** Delegates to {@link #validateConfiguration()} and {@link #initialize()}. */validateConfiguration(...)/** Validate the configuration of this container. ... *//** Calls {@link #shutdown()} when the BeanFactory destroys the container instance. ... *//** Initialize this container. ... */// Lifecycle methods for starting and stopping the containerthis.lifecycleMonitordoInitialize(...)this.sharedConnectionMonitorthis.sharedConnection/** Stop the shared Connection, call {@link #doShutdown()}, ... */boolean wasRunningthis.pausedTaskssharedConnectionEnabled(...)stopSharedConnection(...)doShutdown(...)/** Return whether this container is currently active, ... *//** Start this container. ... *//** Start the shared Connection, if any, and notify all invoker tasks. ... */establishSharedConnection(...)resumePausedTasks(...)startSharedConnection(...)/** Stop this container. ... *//** Notify all invoker tasks and stop the shared Connection, if any. ... *//** Determine whether this container is currently running, ... */runningAllowed(...)/** Check whether this container's listeners are generally allowed to run. ... *//** Establish a shared Connection for this container. ... */// Management of a shared JMS ConnectioncreateSharedConnection(...)/** Refresh the shared Connection that this container holds. ... */this.sharedConnectionStarted/** Create a shared Connection for this container. ... */prepareSharedConnection(...)/** Prepare the given Connection, which is about to be registered ... *//** Start the shared Connection. ... *//** Stop the shared Connection. ... *//** Return the shared JMS Connection maintained by this container. ... */new SharedConnectionNotInitializedException(...)/** Take the given task object and reschedule it, either immediately if ... */// Management of paused tasksdoRescheduleTask(...)logRejectedTask(...)/** Try to resume all paused tasks. ... */Object task/** Determine the number of currently paused tasks, if any. *//** Reschedule the given task object immediately. ... *//** Log a task that has been rejected by {@link #doRescheduleTask}. ... *//** Return whether a shared JMS Connection should be maintained ... *//** Register any invokers within this container. ... *//** Close the registered invokers. ... *//** Exception that indicates that the initial setup of this container's ... *//** Create a new SharedConnectionNotInitializedException. ... */// Stop shared Connection early, if necessary.// Shut down the invokers.// Lazily establish a shared Connection, if necessary.// Reschedule paused tasks, if any.// Start the shared Connection, if any.// Keep the task in paused mode.../** Abstract base class for Spring message listener container implementations. ... */Object destination, ...;String messageSelector, ...;Object messageListener, ...;boolean subscriptionDurable, ...;boolean subscriptionShared, ...;String subscriptionName, ...;boolean exposeListenerSession, ...;boolean acceptMessagesWhileStopping, ...;/** Specify concurrency limits. *//** Set the destination to receive messages from. ... *//** Return the destination to receive messages from. Will be {@code null} ... *//** Set the name of the destination to receive messages from. ... *//** Return the name of the destination to receive messages from. ... *//** Return a descriptive String for this container's JMS destination ... */Object destination/** Set the JMS message selector expression (or {@code null} if none). ... */this.messageSelector/** Return the JMS message selector expression (or {@code null} if none). *//** Set the message listener implementation to register. ... */checkMessageListener(...)this.subscriptionNamegetDefaultSubscriptionName(...)/** Return the message listener object to register. *//** Check the given message listener, throwing an exception ... */MessageListener.classSessionAwareMessageListener<>.class/** Determine the default subscription name for the given message listener. ... */getSubscriptionName(...)/** Set whether to make the subscription durable. The durable subscription name ... *//** Return whether to make the subscription durable. *//** Set whether to make the subscription shared. The shared subscription name ... *//** Return whether to make the subscription shared. ... *//** Set the name of a subscription to create. To be applied in case ... *//** Return the name of a subscription to create, if any. ... *//** Set the name of a durable subscription to create. This method switches ... *//** Return the name of a durable subscription to create, if any. *//** Return whether to inhibit the delivery of messages published by its own connection. ... *//** Configure the reply destination type. By default, the configured {@code pubSubDomain} ... *//** Return whether the Publish/Subscribe domain ({@link javax.jms.Topic Topics}) is used ... *//** Configure the {@link QosSettings} to use when sending a reply. Can be set to ... *//** Set the {@link MessageConverter} strategy for converting JMS Messages. ... *//** Set the JMS ExceptionListener to notify in case of a JMSException thrown ... *//** Return the JMS ExceptionListener to notify in case of a JMSException thrown ... *//** Set the ErrorHandler to be invoked in case of any uncaught exceptions thrown ... *//** Return the ErrorHandler to be invoked in case of any uncaught exceptions thrown ... *//** Set whether to expose the listener JMS Session to a registered ... */this.exposeListenerSession/** Return whether to expose the listener JMS {@link Session} to a ... *//** Set whether to accept received messages while the listener container ... */this.acceptMessagesWhileStopping/** Return whether to accept received messages while the listener container ... *//** Execute the specified listener, ... */// Template methods for listener executiondoExecuteListener(...)handleListenerException(...)isAcceptMessagesWhileStopping(...)rollbackIfNecessary(...)new MessageRejectedWhileStoppingException(...)rollbackOnExceptionIfNecessary(...)/** Invoke the specified listener: either as standard JMS MessageListener ... *//** Invoke the specified listener as Spring SessionAwareMessageListener, ... */isExposeListenerSession(...)onMessage(...)/** Invoke the specified listener as standard JMS MessageListener. ... *//** Perform a commit or message acknowledgement, as appropriate. ... *//** Perform a rollback, if appropriate. ... */recover(...)/** Perform a rollback, handling rollback exceptions properly. ... */IllegalStateException ex2isSubscriptionShared(...)isSubscriptionDurable(...)/** Handle the given exception that arose during listener execution. ... */invokeExceptionListener(...)invokeErrorHandler(...)/** Invoke the registered JMS ExceptionListener, if any. ... */ExceptionListener exceptionListener/** Invoke the registered ErrorHandler, if any. Log at warn level otherwise. ... *//** Internal exception class that indicates a rejected message on shutdown. ... */// Clearly a Topic: let's set the "pubSubDomain" flag accordingly.// We need to expose a separate Session.// Actually invoke the message listener...// Clean up specially exposed Session, if any.// Transacted session created by this container -> commit.// Commit session or acknowledge message.// Transacted session created by this container -> rollback.// Only pass in the NoLocal flag in case of a Topic (pub-sub mode):// Internal exception - has been handled before.// Regular case: failed while active.// Invoke ErrorHandler if available.// Rare case: listener thread failed after container shutdown.// Log at debug level, to avoid spamming the shutdown log.import SingleConnectionFactory/** Base class for listener container implementations which are based on polling. ... */new MessageListenerContainerResourceFactory(...)long DEFAULT_RECEIVE_TIMEOUT, ...;/** The default receive timeout: 1000 ms = 1 second. */MessageListenerContainerResourceFactory transactionalResourceFactory, ...;boolean sessionTransactedCalled, ...;DefaultTransactionDefinition transactionDefinition, ...;this.sessionTransactedCalled/** Specify the Spring {@link org.springframework.transaction.PlatformTransactionManager} ... *//** Return the Spring PlatformTransactionManager to use for transactional ... *//** Specify the transaction name to use for transactional wrapping. ... */this.transactionDefinition/** Specify the transaction timeout to use for transactional wrapping, in <b>seconds</b>. ... *//** Set the timeout to use for receive calls, in <b>milliseconds</b>. ... *//** Return the receive timeout (ms) configured for this listener container. ... */sameResourceFactory(...)/** Create a MessageConsumer for the given JMS Session, ... */String destinationNamegetDestinationName(...)/** Execute the listener for a message received from the given consumer, ... */TransactionStatus statusboolean messageReceiveddoReceiveAndExecute(...)rollbackOnException(...)/** Actually execute the listener for a message received from the given consumer, ... */MessageConsumer consumerToCloseboolean transactionalMessageConsumer consumerToUsereceiveMessage(...)getSharedConnection(...)createListenerConsumer(...)boolean exposeResourcemessageReceived(...)new LocallyExposedJmsResourceHolder(...)noMessageReceived(...)shouldCommitAfterNoMessageReceived(...)/** This implementation checks whether the Session is externally synchronized. ... *//** Determine whether to trigger a commit after no message has been received. ... *//** Receive a message from the given consumer. ... *//** Template method that gets called right when a new message has been received, ... *//** Template method that gets called when <i>no</i> message has been received, ... *//** ResourceFactory implementation that delegates to this listener container's protected callback methods. */AbstractPollingMessageListenerContainer.thisConnection sharedConnew SingleConnectionFactory(...)// Set sessionTransacted=true in case of a non-JTA transaction manager.// Use bean name as default transaction name.// Proceed with superclass initialization.// Execute receive within transaction.// Execute receive outside of transaction.// Rethrow JMSException to indicate an infrastructure problem// that may have to trigger recovery...// Indicate that a message has been received.// Nevertheless call commit, in order to reset the transaction timeout (if any).// Indicate that no message has been received.import CachingDestinationResolver/** Message listener container variant that uses plain JMS client APIs, specifically ... */new HashSet<AsyncMessageListenerInvoker>(...)DefaultMessageListenerContainer.classString DEFAULT_THREAD_NAME_PREFIX, ...;/** Default thread name prefix: "DefaultMessageListenerContainer-". */long DEFAULT_RECOVERY_INTERVAL, ...;int CACHE_NONE, ...;/** Constant that indicates to cache no JMS resources at all. ... */int CACHE_CONNECTION, ...;/** Constant that indicates to cache a shared JMS {@code Connection} for each ... */int CACHE_SESSION, ...;/** Constant that indicates to cache a shared JMS {@code Connection} and a JMS ... */int CACHE_CONSUMER, ...;/** Constant that indicates to cache a shared JMS {@code Connection}, a JMS ... */int CACHE_AUTO, ...;/** Constant that indicates automatic choice of an appropriate caching level ... */int cacheLevel, ...;int concurrentConsumers, ...;int maxConcurrentConsumers, ...;int maxMessagesPerTask, ...;int idleConsumerLimit, ...;int idleTaskExecutionLimit, ...;Set<AsyncMessageListenerInvoker> scheduledInvokers, ...;int activeInvokerCount, ...;int registeredWithDestination, ...;boolean recovering, ...;Runnable stopCallback, ...;Object currentRecoveryMarker, ...;Object recoveryMonitor, ...;/** Set the Spring {@code TaskExecutor} to use for running the listener threads. ... *//** Specify the {@link BackOff} instance to use to compute the interval ... *//** Specify the interval between recovery attempts, in <b>milliseconds</b>. ... *//** Specify the level of caching that this listener container is allowed to apply, ... *//** Specify the level of caching that this listener container is allowed to apply. ... *//** Return the level of caching that this listener container is allowed to apply. *//** Specify concurrency limits via a "lower-upper" String, e.g. "5-10", or a simple ... */setConcurrentConsumers(...)setMaxConcurrentConsumers(...)/** Specify the number of concurrent consumers to create. Default is 1. ... */this.concurrentConsumersthis.maxConcurrentConsumers/** Return the "concurrentConsumer" setting. ... *//** Specify the maximum number of concurrent consumers to create. Default is 1. ... *//** Return the "maxConcurrentConsumer" setting. ... *//** Specify the maximum number of messages to process in one task. ... *//** Return the maximum number of messages to process in one task. *//** Specify the limit for the number of consumers that are allowed to be idle ... */this.idleConsumerLimit/** Return the limit for the number of idle consumers. *//** Specify the limit for idle executions of a consumer task, not having ... */this.idleTaskExecutionLimit/** Return the limit for idle executions of a consumer task. */// Implementation of AbstractMessageListenerContainer's template methodsgetTransactionManager(...)createDefaultTaskExecutor(...)prefersShortLivedTasks(...)/** Creates the specified number of concurrent consumers, ... */scheduleNewInvoker(...)/** Destroy the registered JMS Sessions and associated MessageConsumers. */long receiveTimeoutlong waitStartTimeint waitCountthis.activeInvokerCountAsyncMessageListenerInvoker scheduledInvokerthis.scheduledInvokersinterruptIfNecessary(...)clearResources(...)/** Overridden to reset the stop callback, if any. */this.stopCallback/** Stop this listener container, invoking the specific callback ... *//** Return the number of currently scheduled consumers. ... *//** Return the number of currently active consumers. ... *//** Return whether at least one consumer has entered a fixed registration with the ... */this.registeredWithDestination/** Create a default TaskExecutor. Called if no explicit TaskExecutor has been specified. ... */String threadNamePrefix/** Schedule a new invoker, increasing the total number of scheduled ... */AsyncMessageListenerInvoker invokernew AsyncMessageListenerInvoker(...)rescheduleTaskIfNecessary(...)/** Use a shared JMS Connection depending on the "cacheLevel" setting. ... */getCacheLevel(...)/** Re-executes the given task via this listener container's TaskExecutor. ... *//** Tries scheduling a new invoker, since we know messages are coming in... ... */setIdle(...)scheduleNewInvokerIfAppropriate(...)/** Marks the affected invoker as idle. */getIdleInvokerCount(...)/** Determine whether the current invoker should be rescheduled, ... */boolean superfluous/** Determine whether this listener container currently has more ... */isIdle(...)/** Overridden to accept a failure in the initial setup - leaving it up to the ... *//** This implementations proceeds even after an exception thrown from ... *//** Handle the given exception that arose during setup of a listener. ... */getDestinationDescription(...)/** Recover this listener container after a listener failed to set itself up, ... */this.recoveringrefreshConnectionUntilSuccessful(...)refreshDestination(...)this.interrupted/** Refresh the underlying Connection, not returning before an attempt has been ... */refreshSharedConnection(...)applyBackOffTime(...)/** Refresh the JMS destination that this listener container operates on. ... */String destNameDestinationResolver destResolverremoveFromCache(...)/** Apply the next back-off time using the specified {@link BackOffExecution}. ... */long intervalInterruptedException interEx/** Return whether this listener container is currently in a recovery attempt. ... *//** Runnable that performs looped {@code MessageConsumer.receive()} calls. */// Inner classes used as internal adaptersMessageConsumer consumer, ...;Object lastRecoveryMarker, ...;boolean lastMessageSucceeded, ...;int idleTaskExecutionCount, ...;boolean idle, ...;Thread currentReceiveThread, ...;executeOngoingLoop(...)int messageCountboolean alreadyRecoveredthis.lastMessageSucceededwaitBeforeRecoveryAttempt(...)this.lastRecoveryMarkerhandleListenerSetupFailure(...)recoverAfterListenerSetupFailure(...)decreaseActiveInvokerCount(...)this.idleTaskExecutionCountshouldRescheduleInvoker(...)int nonPausedConsumersgetScheduledConsumerCount(...)getPausedTaskCount(...)getConcurrentConsumers(...)boolean activeboolean wasWaitingthis.currentReceiveThreadreceiveAndExecute(...)initResourcesIfNecessary(...)updateRecoveryMarker(...)Thread currentReceiveThreadisInterrupted(...)/** Apply the back-off time once. In a regular scenario, the back-off is only applied if we ... */DefaultMessageListenerContainer.this.backOffDefaultMessageListenerContainer.thisthis.idle// Adapt default cache level.// Prepare taskExecutor and maxMessagesPerTask.// TaskExecutor indicated a preference for short-lived tasks. According to// setMaxMessagesPerTask javadoc, we'll use 10 message per task in this case// unless the user specified a custom value.// Proceed with actual listener initialization.// Unexpectedly some invokers are still active after the receive timeout period// -> interrupt remaining receive attempts since we'd reject the messages anyway// Wait for AsyncMessageListenerInvokers to deactivate themselves...// Clear remaining scheduled invokers, possibly left over as paused tasks// Not started, already stopped, or previous stop attempt in progress// -> return immediately, no stop process to control anymore.// This should always be true, since we're only calling this when active.// Recovery during active operation..// Interrupted right before and still failing... give up.// We failed more than once in a row or on startup -// wait before first recovery attempt.// We're shutting down completely./** {@link JmsResourceHolder} marker subclass that indicates local exposure, ... *//** Internal abstraction used by the framework representing a message ... *//** Setup the message listener to use. Throws an {@link IllegalArgumentException} ... *//** Return the {@link MessageConverter} that can be used to ... *//** Return the {@link DestinationResolver} to use to resolve ... *//** Return whether the Publish/Subscribe domain ({@link javax.jms.Topic Topics}) is used. ... *//** Return whether the reply destination uses Publish/Subscribe domain ... *//** Return the {@link QosSettings} to use when sending a reply, ... *//** Variant of the standard JMS {@link javax.jms.MessageListener} interface, ... *//** Callback for processing a received JMS message. ... *//** Message listener container that uses the plain JMS client API's ... */boolean connectLazily, ...;boolean recoverOnException, ...;Set<Session> sessions, ...;Set<MessageConsumer> consumers, ...;Object consumersMonitor, ...;/** Specify whether to connect lazily, i.e. whether to establish the JMS Connection ... */this.connectLazily/** Specify whether to explicitly recover the shared JMS Connection and the ... */this.recoverOnException/** Set the Spring TaskExecutor to use for executing the listener once ... *//** Always use a shared JMS Connection. */initializeConsumers(...)/** Re-initializes this container's JMS message consumers, ... *//** Registers this listener container as JMS ExceptionListener on the shared connection. *//** JMS ExceptionListener implementation, invoked by the JMS provider in ... */this.consumersMonitorthis.consumersJMSException recoverEx/** Initialize the JMS Sessions and MessageConsumers for this container. ... */new HashSet<Session>(...)new HashSet<MessageConsumer>(...)new MessageListener(...) { ... }processMessage(...)/** Process a message received from the provider. ... */executeListener(...)// First invoke the user-specific ExceptionListener, if any.// Now try to recover the shared Connection and all consumers...// Register Sessions and MessageConsumers./** Interface to be implemented by message listener objects that suggest a specific ... *//** Determine the subscription name for this message listener object. */import BytesMessageimport SessionAwareMessageListenerimport JmsHeaderMapperimport SimpleJmsHeaderMapperimport SmartMessageConverterimport DynamicDestinationResolverimport MessageHeaders/** An abstract JMS {@link MessageListener} adapter providing the necessary ... */new DynamicDestinationResolver(...)new MessagingMessageConverterAdapter(...)Object defaultResponseDestination, ...;MessagingMessageConverterAdapter messagingMessageConverter, ...;QosSettings responseQosSettings, ...;/** Set the default destination to send response messages to. This will be applied ... */this.defaultResponseDestination/** Set the name of the default response queue to send response messages to. ... */new DestinationNameHolder(...)/** Set the name of the default response topic to send response messages to. ... *//** Set the DestinationResolver that should be used to resolve response ... *//** Return the DestinationResolver for this adapter. *//** Set the converter that will convert incoming JMS messages to ... *//** Return the converter that will convert incoming JMS messages to ... *//** Set the {@link JmsHeaderMapper} implementation to use to map the standard ... */setHeaderMapper(...)this.messagingMessageConverter/** Return the {@link MessagingMessageConverter} for this listener, ... *//** Set the {@link QosSettings} to use when sending a response. Can be set to ... */this.responseQosSettings/** Return the {@link QosSettings} to use when sending a response, ... *//** Standard JMS {@link MessageListener} entry point. ... *//** Extract the message body from the given JMS message. ... *//** Handle the given result object returned from the listener method, ... */Message responsegetResponseDestination(...)postProcessResponse(...)sendResponse(...)new ReplyFailureException(...)/** Build a JMS message to be sent as response based on the given result object. ... */Object contentpreProcessResponse(...)getResponse(...)/** Pre-process the given result before it is converted to a {@link Message}. ... *//** Post-process the given response message before it will be sent. ... */String correlationgetJMSCorrelationID(...)getJMSMessageID(...)setJMSCorrelationID(...)JmsResponse<?> jmsResponseresolveDestination(...)/** Determine a response destination for the given message. ... */Destination replyTogetJMSReplyTo(...)resolveDefaultResponseDestination(...)new InvalidDestinationException(...)/** Resolve the default response destination into a JMS {@link Destination}, using this ... */DestinationNameHolder nameHoldernameHolder.namenameHolder.isTopic/** Send the given response message to the given destination. ... */QosSettings settingsgetResponseQosSettings(...)postProcessProducer(...)/** Post-process the given message producer before using it to send the response. ... *//** A {@link MessagingMessageConverter} that lazily invokes payload extraction and ... */new LazyResolutionMessage(...)extractMessage(...)Message message, ...;Object payload, ...;MessageHeaders headers, ...;unwrapPayload(...)/** Extract the payload of the current message. Since we deferred the resolution ... */extractPayload(...)this.headersextractHeaders(...)/** Internal class combining a destination name ... */boolean isTopic, ...;this.isTopic// No JMS Session available// In case the BytesMessage is going to be received as a user argument:// reset it, otherwise it would appear empty to such processing code...// Continue since the BytesMessage typically won't be used any further./** Return type of any JMS listener method used to indicate the actual response ... */T response, ...;/** Create a new {@link JmsResponse} instance. ... */this.response/** Return the content of the response. *//** Resolve the {@link Destination} to use for this instance. The {@link DestinationResolver} ... */nameHolder.destinationNamenameHolder.pubSubDomain/** Create a {@link JmsResponse} targeting the queue with the specified name. */new JmsResponse<T>(...)/** Create a {@link JmsResponse} targeting the topic with the specified name. *//** Create a {@link JmsResponse} targeting the specified {@link Destination}. */String destinationName, ...;boolean pubSubDomain, ...;this.destinationName/** Exception to be thrown when the execution of a listener method failed. ... *//** Constructor for ListenerExecutionFailedException. ... */import SubscriptionNameProvider/** Message listener adapter that delegates the handling of messages to target ... */String ORIGINAL_DEFAULT_LISTENER_METHOD, ...;/** Out-of-the-box value for the default listener method: "handleMessage". */String defaultListenerMethod, ...;/** Create a new {@link MessageListenerAdapter} with default settings. *//** Create a new {@link MessageListenerAdapter} for the given delegate. ... *//** Set a target object to delegate message listening to. ... *//** Return the target object to delegate message listening to. *//** Specify the name of the default listener method to delegate to, ... */this.defaultListenerMethod/** Return the name of the default listener method to delegate to. *//** Spring {@link SessionAwareMessageListener} entry point. ... */Object convertedMessagegetListenerMethodName(...)Object[] listenerArgumentsbuildListenerArguments(...)invokeListenerMethod(...)/** Determine the name of the listener method that is supposed to ... */getDefaultListenerMethod(...)/** Build an array of arguments to be passed into the target listener method. ... *//** Invoke the specified listener method. ... */new ListenerExecutionFailedException(...)// Check whether the delegate is a MessageListener impl itself.// In that case, the adapter will simply act as a pass-through.// Regular case: find a handler method reflectively.// Invoke the handler method with appropriate arguments.import AbstractMessageSendingTemplateimport MessageBuilder/** A {@link javax.jms.MessageListener} adapter that invokes a configurable ... */InvocableHandlerMethod handlerMethod, ...;/** Set the {@link InvocableHandlerMethod} to use to invoke the method ... */this.handlerMethodtoMessagingMessage(...)invokeHandler(...)MethodParameter returnTypegetHandlerMethod(...)AbstractMessageSendingTemplate<>.CONVERSION_HINT_HEADERwithPayload(...)getMessagingMessageConverter(...)/** Invoke the handler, wrapping any exception to a {@link ListenerExecutionFailedException} ... */InvocableHandlerMethod handlerMethodcreateMessagingErrorMessage(...)/** Exception to be thrown when the reply of a message failed to be sent. ... *//** Message listener adapter mechanism that delegates to target listener ... *//** Default implementation of the {@link JmsActivationSpecFactory} interface. ... */String RESOURCE_ADAPTER_SUFFIX, ...;String RESOURCE_ADAPTER_IMPL_SUFFIX, ...;String ACTIVATION_SPEC_SUFFIX, ...;String ACTIVATION_SPEC_IMPL_SUFFIX, ...;/** This implementation guesses the ActivationSpec class name from the ... */String adapterClassNameString providerPackageString specClassNameString providerName/** This implementation supports Spring's extended "maxConcurrency" ... */populateActivationSpecProperties(...)getMaxConcurrency(...)getPrefetchSize(...)/** This implementation maps {@code SESSION_TRANSACTED} onto an ... */applyAcknowledgeMode(...)// e.g. ActiveMQ//e.g. WebSphere// e.g. JORAM// ActivationSpecImpl class in "inbound" subpackage (WebSphere MQ 6.0.2.1)// ActiveMQ// JORAM// WebSphere/** Common configuration object for activating a JMS message endpoint. ... */Constants sessionConstants, ...;/** Constants instance for {@code javax.jms.Session}. */int acknowledgeMode, ...;int maxConcurrency, ...;int prefetchSize, ...;/** Set the JMS acknowledgement mode by the name of the corresponding constant ... */setAcknowledgeMode(...)/** Set the JMS acknowledgement mode to use. ... */this.acknowledgeMode/** Return the JMS acknowledgement mode to use. */setMaxConcurrency(...)/** Specify the maximum number of consumers/sessions to use, effectively ... */this.maxConcurrency/** Return the maximum number of consumers/sessions to use. *//** Specify the maximum number of messages to load into a session ... */this.prefetchSize/** Return the maximum number of messages to load into a session. *//** Return the {@link MessageConverter} to use, if any. */import ActivationSpec/** Strategy interface for creating JCA 1.5 ActivationSpec objects ... *//** Create a JCA 1.5 ActivationSpec object based on the given ... */import ResourceExceptionimport UnavailableExceptionimport AbstractMessageEndpointFactory/** JMS-specific implementation of the JCA 1.7 ... *//** Set the JMS MessageListener for this endpoint. *//** Return the JMS MessageListener for this endpoint. *//** Creates a concrete JMS message endpoint, internal to this factory. */new JmsMessageEndpoint(...)/** Private inner class that implements the concrete JMS message endpoint. */Throwable endpointExboolean applyDeliveryCallshasBeforeDeliveryBeenCalled(...)beforeDelivery(...)ResourceException exnew JmsResourceException(...)onEndpointException(...)afterDelivery(...)/** Internal exception thrown when a ResourceException has been encountered ... */import GenericMessageEndpointManager/** Extension of the generic JCA 1.5 ... */new JmsMessageEndpointFactory(...)new DefaultJmsActivationSpecFactory(...)JmsMessageEndpointFactory endpointFactory, ...;boolean messageListenerSet, ...;JmsActivationSpecConfig activationSpecConfig, ...;/** Set the JMS MessageListener for this endpoint. ... */this.endpointFactorythis.messageListenerSet/** Set the XA transaction manager to use for wrapping endpoint ... *//** Set the factory for concrete JCA 1.5 ActivationSpec objects, ... *//** Set the DestinationResolver to use for resolving destination names ... */DefaultJmsActivationSpecFactory factory/** Specify the {@link JmsActivationSpecConfig} object that this endpoint manager ... */this.activationSpecConfig/** Return the {@link JmsActivationSpecConfig} object that this endpoint manager ... *//** Set the name of this message endpoint. Populated with the bean name ... */getResourceAdapter(...)setMessageEndpointFactory(...)setActivationSpec(...)createActivationSpec(...)JmsActivationSpecConfig config/** Standard implementation of the {@link JmsActivationSpecFactory} interface. ... */Class<?> activationSpecClass, ...;Map<String,String> defaultProperties, ...;/** Specify the fully-qualified ActivationSpec class name for the target ... */this.activationSpecClass/** Specify custom default properties, with String keys and String values. ... */this.defaultProperties/** Return the {@link DestinationResolver} to use for resolving destinations names. */Class<?> activationSpecClassToUseActivationSpec specdetermineActivationSpecClass(...)/** Determine the ActivationSpec class for the given ResourceAdapter, ... *//** Populate the given ApplicationSpec object with the settings ... */Topic.classQueue.classgetAcknowledgeMode(...)/** Apply the specified acknowledge mode to the ActivationSpec object. ... */// Standard JCA 1.5 "subscriptionDurability" apparently not supported...// Standard JCA 1.5 "acknowledgeMode" apparently not supported (e.g. WebSphere MQ 6.0.2.1)/** This package provides JCA-based endpoint management for JMS message listeners. *//** This package contains the base message listener container facility. ... *//** This package contains integration classes for JMS, ... */import MessageFormatExceptionimport RemoteTimeoutException/** {@link org.aopalliance.intercept.MethodInterceptor} for accessing a ... */Object queue, ...;/** Set the QueueConnectionFactory to use for obtaining JMS QueueConnections. *//** Return the QueueConnectionFactory to use for obtaining JMS QueueConnections. *//** Set the target Queue to send invoker requests to. *//** Set the name of target queue to send invoker requests to. ... *//** Set the DestinationResolver that is to be used to resolve Queue ... *//** Set the {@link RemoteInvocationFactory} to use for this accessor. ... *//** Specify the {@link MessageConverter} to use for turning ... *//** Set the timeout to use for receiving the response message for a request ... *//** Return the timeout to use for receiving the response message for a request ... */RemoteInvocation invocationRemoteInvocationResult resultexecuteRequest(...)convertJmsInvokerAccessException(...)recreateRemoteInvocationResult(...)hasInvocationTargetException(...)/** Create a new {@code RemoteInvocation} object for the given AOP method invocation. ... *//** Execute the given remote invocation, sending an invoker request message ... */Queue queueToUseresolveQueue(...)createRequestMessage(...)Message responseMessagedoExecuteRequest(...)extractInvocationResult(...)onReceiveTimeout(...)/** Create a new JMS Connection for this JMS invoker. *//** Create a new JMS Session for this JMS invoker. *//** Resolve this accessor's target queue. ... */resolveQueueName(...)/** Resolve the given queue name into a JMS {@link javax.jms.Queue}, ... *//** Create the invoker request message. ... *//** Actually execute the given request, sending the invoker request message ... *//** Extract the invocation result from the response message. ... */onInvalidResponse(...)/** Callback that is invoked by {@link #executeRequest} when the receive ... */new RemoteTimeoutException(...)/** Callback that is invoked by {@link #extractInvocationResult} when ... */new MessageFormatException(...)/** Recreate the invocation result contained in the given {@link RemoteInvocationResult} ... *//** Convert the given JMS invoker access exception to an appropriate ... *//** FactoryBean for JMS invoker proxies. Exposes the proxied service for use ... *//** Set the interface that the proxy must implement. ... *//** JMS message listener that exports the specified service bean as a ... */boolean ignoreInvalidRequests, ...;/** Specify the MessageConverter to use for turning request messages into ... *//** Set whether invalidly formatted messages should be discarded. ... */this.ignoreInvalidRequestsreadRemoteInvocation(...)invokeAndCreateResult(...)writeRemoteInvocationResult(...)/** Read a RemoteInvocation from the given JMS message. ... */onInvalidRequest(...)/** Send the given RemoteInvocationResult as a JMS message to the originator. ... */createResponseMessage(...)/** Create the invocation result response message. ... *//** Callback that is invoked by {@link #readRemoteInvocation} ... *//** Remoting classes for transparent Java-to-Java remoting via a JMS provider. ... *//** Base class for {@link org.springframework.jms.core.JmsTemplate} and other ... */boolean sessionTransacted, ...;int sessionAcknowledgeMode, ...;/** Set the ConnectionFactory to use for obtaining JMS {@link Connection Connections}. *//** Return the ConnectionFactory that this accessor uses for obtaining ... *//** Set the transaction mode that is used when creating a JMS {@link Session}. ... *//** Return whether the JMS {@link Session sessions} used by this ... *//** Set the JMS acknowledgement mode that is used when creating a JMS ... *//** Return the acknowledgement mode for JMS {@link Session sessions}. *//** Convert the specified checked {@link javax.jms.JMSException JMSException} to ... */getSessionAcknowledgeMode(...)/** Determine whether the given Session is in client acknowledge mode. ... */import HeaderMapper/** Strategy interface for mapping {@link org.springframework.messaging.Message} ... */String CONTENT_TYPE_PROPERTY, ...;/** The JMS-compliant {@code content_type} property. *//** Pre-defined names and prefixes to be used for setting and/or retrieving ... */String PREFIX, ...;/** Prefix used for JMS API related headers in order to distinguish from ... */String CORRELATION_ID, ...;/** Correlation ID for the message. This may be the {@link #MESSAGE_ID} of ... */String DESTINATION, ...;/** Name of the destination (topic or queue) of the message. ... */String DELIVERY_MODE, ...;/** Distribution mode. ... */String EXPIRATION, ...;/** Message expiration date and time. ... */String MESSAGE_ID, ...;/** Unique identifier for a message. ... */String PRIORITY, ...;/** The message priority level. ... */String REPLY_TO, ...;/** Name of the destination (topic or queue) the message replies should ... */String REDELIVERED, ...;/** Specify if the message was resent. This occurs when a message ... */String TYPE, ...;/** Message type label. This type is a string value describing the message ... */String TIMESTAMP, ...;/** Date and time of the message sending operation. ... */import NativeMessageHeaderAccessor/** A {@link org.springframework.messaging.support.MessageHeaderAccessor} ... *//** Return the {@link JmsHeaders#CORRELATION_ID correlationId}. ... */getHeader(...)JmsHeaders.CORRELATION_ID/** Return the {@link JmsHeaders#DESTINATION destination}. ... */JmsHeaders.DESTINATION/** Return the {@link JmsHeaders#DELIVERY_MODE delivery mode}. ... */JmsHeaders.DELIVERY_MODE/** Return the message {@link JmsHeaders#EXPIRATION expiration}. ... */JmsHeaders.EXPIRATION/** Return the {@link JmsHeaders#MESSAGE_ID message id}. ... */JmsHeaders.MESSAGE_ID/** Return the {@link JmsHeaders#PRIORITY priority}. ... */JmsHeaders.PRIORITY/** Return the {@link JmsHeaders#REPLY_TO reply to}. ... */JmsHeaders.REPLY_TO/** Return the {@link JmsHeaders#REDELIVERED redelivered} flag. ... */JmsHeaders.REDELIVERED/** Return the {@link JmsHeaders#TYPE type}. ... */JmsHeaders.TYPE/** Return the {@link JmsHeaders#TIMESTAMP timestamp}. ... */JmsHeaders.TIMESTAMP/** Create a {@link JmsMessageHeaderAccessor} from the headers of an existing message. */// Static factory methodnew JmsMessageHeaderAccessor(...)import QueueRequestorimport InvalidClientIDExceptionimport InvalidSelectorExceptionimport JmsSecurityExceptionimport MessageEOFExceptionimport MessageNotReadableExceptionimport MessageNotWriteableExceptionimport ResourceAllocationExceptionimport UncategorizedJmsException/** Generic utility methods for working with JMS. Mainly for internal use ... */JmsUtils.class/** Close the given JMS Connection and ignore any thrown exception. ... *//** Close the given JMS Session and ignore any thrown exception. ... *//** Close the given JMS MessageProducer and ignore any thrown exception. ... *//** Close the given JMS MessageConsumer and ignore any thrown exception. ... */boolean wasInterruptedinterrupted(...)/** Close the given JMS QueueBrowser and ignore any thrown exception. ... *//** Close the given JMS QueueRequestor and ignore any thrown exception. ... *//** Commit the Session if not within a JTA transaction. ... *//** Rollback the Session if not within a JTA transaction. ... *//** Build a descriptive exception message for the given JMSException, ... *//** Convert the specified checked {@link javax.jms.JMSException JMSException} to a ... */new InvalidClientIDException(...)new InvalidSelectorException(...)new JmsSecurityException(...)new MessageEOFException(...)new MessageNotReadableException(...)new MessageNotWriteableException(...)new ResourceAllocationException(...)new TransactionRolledBackException(...)new UncategorizedJmsException(...)// We don't trust the JMS provider: It might throw RuntimeException or Error.// Clear interruptions to ensure that the consumer closes successfully...// (working around misbehaving JMS providers such as ActiveMQ)// Reset the interrupted flag as it was before.// fallback/** Gather the Quality-of-Service settings that can be used when sending a message. ... *//** Create a new instance with the default settings. ... *//** Create a new instance with the specified settings. */QosSettings otherSettingsotherSettings.deliveryModeotherSettings.priorityotherSettings.timeToLiveimport AbstractHeaderMapper/** Simple implementation of {@link JmsHeaderMapper}. ... */Set<Class<?>> SUPPORTED_PROPERTY_TYPES, ...;Object jmsCorrelationIdDestination jmsReplyTogetHeaderIfAvailable(...)Destination.classString jmsTypeSet<Entry<String,Object>> entriessetJMSType(...)String headerNameJmsHeaders.PREFIXfromHeaderName(...)setObjectProperty(...)Map<String,Object> headersEnumeration<?> jmsPropertyNamesString correlationIdgetJMSDestination(...)int deliveryModegetJMSDeliveryMode(...)long expirationgetJMSExpiration(...)getJMSPriority(...)getJMSRedelivered(...)getJMSType(...)getJMSTimestamp(...)toHeaderName(...)getObjectProperty(...)/** Add the outbound prefix if necessary. ... */MessageHeaders.CONTENT_TYPE/** Add the inbound prefix if necessary. ... */import TextMessageimport JsonViewimport DeserializationFeatureimport JavaTypeimport MapperFeatureimport ObjectMapperimport ObjectWriter/** Message converter that uses Jackson 2.x to convert messages to and from JSON. ... */MessageType.BYTES/** The default encoding used for writing to text messages: UTF-8. */ObjectMapper objectMapper, ...;MessageType targetType, ...;String encodingPropertyName, ...;String typeIdPropertyName, ...;Map<String,Class<?>> idClassMappings, ...;Map<Class<?>,String> classIdMappings, ...;this.objectMappernew ObjectMapper(...)MapperFeature.DEFAULT_VIEW_INCLUSIONDeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES/** Specify the {@link ObjectMapper} to use instead of using the default. *//** Specify whether {@link #toMessage(Object, Session)} should marshal to a ... *//** Specify the encoding to use when converting to and from text-based ... *//** Specify the name of the JMS message property that carries the encoding from ... */this.encodingPropertyName/** Specify the name of the JMS message property that carries the type id for the ... */this.typeIdPropertyName/** Specify mappings from type ids to Java classes, if desired. ... */this.idClassMappingsnew BiConsumer<String,Class<?>>(...) { ... }this.classIdMappingsmapToTextMessage(...)writer(...)mapToBytesMessage(...)mapToMessage(...)setTypeIdOnMessage(...)getSerializationView(...)/** Convert a Java object to a JMS Message using the specified json view ... */writerWithView(...)JavaType targetJavaTypegetJavaTypeForMessage(...)convertToObject(...)/** Map the given object to a {@link TextMessage}. ... */writeValue(...)createTextMessage(...)/** Map the given object to a {@link BytesMessage}. ... */BytesMessage messagecreateBytesMessage(...)OutputStreamWriter writersetStringProperty(...)/** Template method that allows for custom message mapping. ... *//** Set a type id for the given payload object on the given JMS Message. ... */String typeId/** Convenience method to dispatch to converters for individual message types. */convertFromTextMessage(...)convertFromBytesMessage(...)convertFromMessage(...)/** Convert a TextMessage to a Java Object with the specified type. ... */String body/** Convert a BytesMessage to a Java Object with the specified type. ... */getBodyLength(...)propertyExists(...)getStringProperty(...)/** Determine a Jackson JavaType for the given JMS Message, ... */Class<?> mappedClassconstructType(...)/** Determine a Jackson serialization view based on the given conversion hint. ... */JsonView annotationJsonView.classgetMethodAnnotation(...)extractViewClass(...)// Jackson usually defaults to UTF-8 but can also go straight to bytes, e.g. for Smile.// We use a direct byte array argument for the latter case to work as well.// Jackson internally performs encoding detection, falling back to UTF-8.import Marshallerimport Unmarshallerimport XmlMappingException/** Spring JMS {@link MessageConverter} that uses a {@link Marshaller} and {@link Unmarshaller}. ... */Marshaller marshaller, ...;Unmarshaller unmarshaller, ...;/** Construct a new {@code MarshallingMessageConverter} with no {@link Marshaller} ... *//** Construct a new {@code MarshallingMessageConverter} with the given {@link Marshaller} set. ... */this.marshallerthis.unmarshaller/** Construct a new {@code MarshallingMessageConverter} with the ... *//** Set the {@link Marshaller} to be used by this message converter. *//** Set the {@link Unmarshaller} to be used by this message converter. *//** Specify whether {@link #toMessage(Object, Session)} should marshal to ... *//** This implementation marshals the given object to a {@link javax.jms.TextMessage} or ... */marshalToTextMessage(...)marshalToBytesMessage(...)marshalToMessage(...)/** This implementation unmarshals the given {@link Message} into an object. ... */TextMessage textMessageunmarshalFromTextMessage(...)BytesMessage bytesMessageunmarshalFromBytesMessage(...)unmarshalFromMessage(...)XmlMappingException ex/** Marshal the given object to a {@link TextMessage}. ... */marshal(...)/** Marshal the given object to a {@link BytesMessage}. ... */StreamResult streamResult/** Template method that allows for custom message marshalling. ... *//** Unmarshal the given {@link TextMessage} into an object. ... */unmarshal(...)/** Unmarshal the given {@link BytesMessage} into an object. ... */ByteArrayInputStream bisStreamSource source/** Template method that allows for custom message unmarshalling. ... *//** Thrown by {@link MessageConverter} implementations when the conversion ... *//** Create a new MessageConversionException. ... *//** Strategy interface that specifies a converter between Java objects and JMS messages. ... *//** Convert a Java object to a JMS Message using the supplied session ... *//** Convert from a JMS Message to a Java object. ... *//** Constants that indicate a target message type to convert to: a ... */new MessageType(...)MessageType TEXT, ...;/** A {@link javax.jms.TextMessage}. */MessageType BYTES, ...;/** A {@link javax.jms.BytesMessage}. */MessageType MAP, ...;/** A {@link javax.jms.MapMessage}. */MessageType OBJECT, ...;/** A {@link javax.jms.ObjectMessage}. *//** Convert a {@link Message} from the messaging abstraction to and from a ... */MessageConverter payloadConverter, ...;JmsHeaderMapper headerMapper, ...;/** Create an instance with a default payload converter. ... */new SimpleJmsHeaderMapper(...)/** Create an instance with the specific payload converter. ... *//** Create an instance with the specified payload converter and ... */this.payloadConverterthis.headerMapper/** Set the {@link MessageConverter} to use to convert the payload. *//** Set the {@link JmsHeaderMapper} to use to map JMS headers to and from ... */Message<?> inputMessageHeaders headersgetHeaders(...)Object conversionHintAbstractMessagingTemplate<>.CONVERSION_HINT_HEADERMessage replycreateMessageForPayload(...)Message<>.classfromHeaders(...)Map<String,Object> mappedHeadersObject convertedObjectMessageBuilder<Object> buildercopyHeadersIfAbsent(...)/** Extract the payload of the specified {@link javax.jms.Message}. *//** Create a JMS message for the specified payload and conversionHint. ... */toHeaders(...)import MapMessageimport ObjectMessage/** A simple message converter which is able to handle TextMessages, BytesMessages, ... *//** This implementation creates a TextMessage for a String, a ... */createMessageForString(...)createMessageForByteArray(...)createMessageForMap(...)createMessageForSerializable(...)/** This implementation converts a TextMessage back to a String, a ... */extractStringFromMessage(...)extractByteArrayFromMessage(...)extractMapFromMessage(...)extractSerializableFromMessage(...)/** Create a JMS TextMessage for the given String. ... *//** Create a JMS BytesMessage for the given byte array. ... *//** Create a JMS MapMessage for the given Map. ... */MapMessage messagecreateMapMessage(...)/** Create a JMS ObjectMessage for the given Serializable object. ... */createObjectMessage(...)/** Extract a String from the given TextMessage. ... *//** Extract a byte array from the given {@link BytesMessage}. ... *//** Extract a Map from the given {@link MapMessage}. ... */Enumeration<String> engetMapNames(...)/** Extract a Serializable object from the given {@link ObjectMessage}. ... *//** An extended {@link MessageConverter} SPI with conversion hint support. ... *//** A variant of {@link #toMessage(Object, Session)} which takes an extra conversion ... *//** Provides a MessageConverter abstraction to convert ... *//** {@link DestinationResolver} implementation based on a Spring {@link BeanFactory}. ... *//** Create a new instance of the {@link BeanFactoryDestinationResolver} class. ... *//** Extension of the DestinationResolver interface, ... *//** Remove the destination with the given name from the cache ... *//** Clear the entire destination cache. ... *//** Thrown by a DestinationResolver when it cannot resolve a destination name. ... *//** Create a new DestinationResolutionException. ... *//** Strategy interface for resolving JMS destinations. ... *//** Resolve the given destination name, either as located resource ... *//** Simple {@link DestinationResolver} implementation resolving destination names ... *//** Resolve the specified destination name as a dynamic destination. ... */resolveTopic(...)/** Resolve the given destination name to a {@link Topic}. ... */createTopic(...)/** Resolve the given destination name to a {@link Queue}. ... */import JmsAccessorlong RECEIVE_TIMEOUT_NO_WAIT, ...;/** Timeout value indicating that a receive operation should ... */long RECEIVE_TIMEOUT_INDEFINITE_WAIT, ...;/** Timeout value indicating a blocking receive without timeout. ... *//** Set the {@link DestinationResolver} that is to be used to resolve ... *//** Return the DestinationResolver for this accessor (never {@code null}). *//** Configure the destination accessor with knowledge of the JMS domain used. ... *//** Resolve the given destination name into a JMS {@link Destination}, ... *//** Actually receive a message from the given consumer. ... *//** {@link DestinationResolver} implementation which interprets destination names ... */new ConcurrentHashMap<String,Destination>(...)boolean fallbackToDynamicDestination, ...;DestinationResolver dynamicDestinationResolver, ...;Map<String,Destination> destinationCache, ...;/** Set whether to cache resolved destinations. Default is "true". ... *//** Set whether this resolver is supposed to create dynamic destinations ... */this.fallbackToDynamicDestination/** Set the {@link DestinationResolver} to use when falling back to dynamic ... */this.dynamicDestinationResolverthis.destinationCachevalidateDestination(...)/** Validate the given Destination object, checking whether it matches ... *//** Support classes for Spring's JMS framework. *//** This package provides generic JMS support classes, ... */import BootstrapContextimport ResourceAdapterInternalExceptionimport MessageEndpointFactoryimport XAResource/** A stub implementation of the JMS ConnectionFactory for testing. ... *//** Stub implementation of the {@link javax.jms.Queue} interface. ... */String DEFAULT_QUEUE_NAME, ...;String queueName, ...;this.queueName/** Stub JMS Message implementation intended for testing purposes only. ... */String messageId, ...;String correlationId, ...;Destination replyTo, ...;long deliveryTime, ...;long expiration, ...;boolean redelivered, ...;ConcurrentHashMap<String,Object> properties, ...;this.correlationIdthis.expirationthis.messageIdthis.redeliveredthis.deliveryTime/** Stub implementation of the {@link Topic} interface. ... */String DEFAULT_TOPIC_NAME, ...;String topicName, ...;this.topicNameimport StubTextMessageimport JmsListenerContainerTestFactoryimport JmsListenerEndpointimport SimpleJmsListenerEndpoint/** Test for {@link SampleBean} discovery. If a factory with the default name ... */JmsListenerContainerTestFactory defaultFactoryJmsListenerContainerTestFactory.classJmsListenerContainerTestFactory simpleFactory/** Test for {@link FullBean} discovery. In this case, no default is set because ... */getEndpoint(...)/** Test for {@link CustomBean} and an manually endpoint registered ... */JmsListenerContainerTestFactory customFactoryJmsListenerEndpoint endpointJmsListenerEndpointRegistry customRegistrySimpleJmsListenerEndpoint.classgetListenerContainerIds(...)getListenerContainer(...)/** Test for {@link DefaultBean} that does not define the container ... *//** Test for {@link ValidationBean} with a validator ({@link TestValidator}) specified ... */SimpleMessageListenerContainer containerMessagingMessageListenerAdapter listenernew StubTextMessage(...)/** Test for {@link JmsListenerRepeatableBean} and {@link JmsListenersBean} that validates that the ... */MethodJmsListenerEndpoint firstMethodJmsListenerEndpoint secondimport ListenerExecutionFailedExceptionimport MethodArgumentNotValidExceptiontestSampleConfiguration(...)testFullConfiguration(...)testCustomConfiguration(...)testExplicitContainerFactoryConfiguration(...)testDefaultContainerFactoryConfiguration(...)MethodArgumentNotValidException.classListenerExecutionFailedException.classtestJmsHandlerMethodFactoryConfiguration(...)testJmsListenerRepeatable(...)SimpleJmsListenerEndpoint endpointnew SimpleJmsListenerEndpoint(...)import MessageListenerTestContainerimport MessageListenerAdapterEnableJmsSampleConfig.classSampleBean.classEnableJmsFullConfig.classFullBean.classEnableJmsFullConfigurableConfig.classFullConfigurableBean.classEnableJmsCustomConfig.classCustomBean.classEnableJmsCustomContainerFactoryConfig.classDefaultBean.classEnableJmsDefaultContainerFactoryConfig.classJmsListenerContainerTestFactory factoryMessageListenerTestContainer containerEnableJmsAutoStartupFalseConfig.classJmsListenerEndpointRegistry registryEnableJmsHandlerMethodFactoryConfig.classValidationBean.classJmsListenerRepeatableBean.classJmsListenersBean.classComposedJmsListenersBean.classLazyBean.classisStopped(...)new JmsListenerContainerTestFactory(...)customRegistry(...)simpleMessageListener(...)new MessageListenerAdapter(...)setContainerFactory(...)simpleFactory(...)customMessageHandlerMethodFactory(...)DefaultMessageHandlerMethodFactory factorynew TestValidator(...)// not found// trigger lazy resolution// close and stop the listeners// Also register a custom endpointimport AbstractJmsListenerEndpointimport HeaderSimpleMessageListenerTestBean.classMethodJmsListenerEndpoint methodEndpointSimpleMessageListenerContainer listenerContainerMethodJmsListenerEndpoint.classMetaAnnotationTestBean.classProxyConfig.classInterfaceProxyTestBean.classClassProxyTestBean.classJmsListenerAnnotationBeanPostProcessor postProcessorjmsListenerEndpointRegistry(...)PlatformTransactionManager.class// Close and stop the listenersnew DefaultJmsListenerContainerFactory(...)new JmsEndpointSampleBean(...)DefaultJmsListenerContainerFactory containerFactory, ...;DefaultMessageHandlerMethodFactory factory, ...;JmsEndpointSampleBean sample, ...;JmsEndpointSampleInterface listener, ...;initializeFactory(...)new UpperCaseMessageConverter(...)testMessageConverterIsUsed(...)MessagingMessageConverter convertercreateDefaultMethodJmsEndpoint(...)assertListenerMethodInvocation(...)JmsEndpointSampleInterface.classJmsEndpointSampleBean.classDefaultMessageListenerContainer messageListenerContainersample.invocationscreateMethodJmsEndpoint(...)new HashMap<String,Boolean>(...)Map<String,Boolean> invocations, ...;import StubConnectionFactoryimport StubJmsActivationSpecFactorynew StubConnectionFactory(...)SimpleJmsListenerContainerFactory factorynew SimpleJmsListenerContainerFactory(...)MessageListener messageListenersetDefaultJmsConfig(...)assertDefaultJmsConfig(...)DefaultJmsListenerContainerFactory factoryDefaultMessageListenerContainer containerDefaultMessageListenerContainer.CACHE_CONSUMERgetMaxConcurrentConsumers(...)getMaxMessagesPerTask(...)DefaultJcaListenerContainerFactory factorynew DefaultJcaListenerContainerFactory(...)JmsMessageEndpointManager containersetDefaultJcaConfig(...)assertDefaultJcaConfig(...)new StubJmsActivationSpecFactory(...)BackOff backOffnew QosSettings(...)new LinkedHashMap<String,MessageListenerTestContainer>(...)Map<String,MessageListenerTestContainer> listenerContainers, ...;new ArrayList<MessageListenerTestContainer>(...)new MessageListenerTestContainer(...)JmsListenerEndpointRegistry registry, ...;JmsListenerContainerTestFactory containerFactory, ...;createEndpoint(...)MessageListenerContainer.class// simple implementation only support max valueString DEFAULT_CONNECTION_FACTORY, ...;String EXPLICIT_CONNECTION_FACTORY, ...;ToolingTestApplicationContext context, ...;new ToolingTestApplicationContext(...)Map<String,?> containersGenericMessageEndpointManager.classMap<String,DefaultMessageListenerContainer> containersConnectionFactory defaultConnectionFactoryConnectionFactory.classConnectionFactory explicitConnectionFactoryint defaultConnectionFactoryCountint explicitConnectionFactoryCountMap<String,JmsMessageEndpointManager> containersJmsMessageEndpointManager listener3Object endpointFactoryObject messageListenerMessageListenerAdapter adapterDirectFieldAccessor adapterFieldAccessorMessageListenerAdapter.classMap<String,DefaultJmsListenerContainerFactory> containersDefaultJmsListenerContainerFactory.classcreateDummyEndpoint(...)DefaultMessageListenerContainer.CACHE_CONNECTIONMap<String,DefaultJcaListenerContainerFactory> containersDefaultJcaListenerContainerFactory.classTestMessageListener testBean3TestMessageListener.classTextMessage message1TextMessage.classMessageListener listener1getListener(...)TextMessage message2MessageListener listener2TextMessage message3MessageListener listener3testBean3.messageObject testBackOffBackOff backOff1getBackOff(...)BackOff backOff2long recoveryInterval3getRecoveryInterval(...)DefaultMessageListenerContainer.DEFAULT_RECOVERY_INTERVALDefaultMessageListenerContainer listener0DefaultMessageListenerContainer listener1DefaultMessageListenerContainer listener2JmsMessageEndpointManager listener4ErrorHandler expectedErrorHandler.classErrorHandler errorHandler1ErrorHandler errorHandler2ErrorHandler defaultErrorHandlerint phase1int phase2int phase3int phase4int defaultPhasecontainsComponentDefinition(...)Iterator<ComponentDefinition> iteratorgetRegisteredComponents(...)ComponentDefinition compDefvalidateComponentDefinition(...)BeanDefinition[] beanDefsFixedBackOff.classObject container/** Internal extension that registers a {@link ReaderEventListener} to store ... */Set<ComponentDefinition> registeredComponents, ...;this.registeredComponentsnew HashSet<ComponentDefinition>(...)new StoringReaderEventListener(...)ComponentDefinition cdComponentDefinition[] innerCdsComponentDefinition innerCd// JMS// JCAboolean startInvoked, ...;boolean initializationInvoked, ...;boolean stopInvoked, ...;boolean destroyInvoked, ...;this.startInvokedthis.initializationInvokedthis.stopInvokedthis.destroyInvokedimport ReplyFailureExceptionimport JmsHeadersimport JmsMessageHeaderAccessorimport HeadersDefaultMessageListenerContainer container, ...;MessageConverter.classDestinationResolver.classgetListenerMethod(...)DirectFieldAccessor accessorcreateDefaultInstance(...)Message.classcreateSimpleJmsTextMessage(...)assertDefaultListenerMethodInvocation(...)StubTextMessage messagesetIntProperty(...)setJMSMessageID(...)MessageHeaders.classsetLongProperty(...)JmsMessageHeaderAccessor.classsetBooleanProperty(...)setJMSPriority(...)MyBean myBeanObjectMessage messageObjectMessage.classmyBean.nameDestination replyDestinationnew Destination(...) { ... }TextMessage replyQueueSender queueSenderQueueSender.classStubTextMessage inputMessagesetDefaultResponseDestination(...)processAndReplyWithSendTo(...)this.sampleQosSettings replyQosSettingsInvalidDestinationException.classReplyFailureException.classDefaultMessageHandlerMethodFactory customFactorytestValidator(...)// failure scenarioMessageConversionException.classbean.invocationsnew Validator(...) { ... }MethodJmsListenerEndpointTests.classbean.name// test is a valid value// test is an invalid value// test is not a valid integer// ref to method// Message<String> as Message<Integer>SimpleMessageListenerContainer container, ...;import StubQueueimport SessionCallbackJmsTransactionManager tmnew JmsTransactionManager(...)JmsTemplate jtnew SessionCallback<Void>(...) { ... }Session session2new StubQueue(...)MessageProducer.classsetLazyResourceRetrieval(...)SingleConnectionFactory scfQueueConnection con1QueueConnection con2TopicConnection con1TopicConnection con2QueueConnectionFactory cfQueueConnectionFactory.classQueueConnection conTopicConnectionFactory cfTopicConnectionFactory.classTopicConnection connew ChainedExceptionListener(...)TestConnection connew TestConnection(...)new JMSException(...)getStartCount(...)getCloseCount(...)TestExceptionListener listenernew TestExceptionListener(...)TestExceptionListener listener0TestExceptionListener listener1TestExceptionListener listener2new SingleConnectionFactory(...) { ... }Session txSessionSession nonTxSessionCachingConnectionFactory scfnew CachingConnectionFactory(...)Session session1QueueSession txSessionQueueSession nonTxSessionTopicSession txSessionTopicSession nonTxSession// should trigger actual close// should lead to rollbackimport ConnectionConsumerimport ConnectionMetaDataimport ServerSessionPoolint startCount, ...;this.startCountthis.closeCountimport GenericMessageConverter/** Tests for {@link JmsMessagingTemplate}. ... */ArgumentCaptor<MessageCreator> messageCreator, ...;JmsMessagingTemplate messagingTemplate, ...;this.messagingTemplatenew JmsMessagingTemplate(...)getJmsTemplate(...)JmsMessagingTemplate messagingTemplateassertPayloadConverter(...)setJmsTemplate(...)MessageConverter customMessageConvertersetJmsMessageConverter(...)MessageConverter jmsMessageConverterMessagingMessageConverter.classMessage<String> messagethis.messageCreatorassertTextMessage(...)setDefaultDestination(...)setDefaultDestinationName(...)JmsMessagingTemplate tnew SimpleMessageConverter(...) { ... }createJmsTextMessage(...)String payloadInteger payloadnew GenericMessageConverter(...)Writer.classMessage<String> requestMessage replyJmsMessageMessage<?> actualString replyinvokeMessageCreator(...)MessageNotReadableException.classDestinationResolutionException.classMessageFormatException.classMessageNotWriteableException.classMessageCreator messageCreatorStubTextMessage jmsMessageJMSException eTextMessage jmsMessageSession mocknew Answer<TextMessage>(...) { ... }// see createTextMessageimport TransactionAwareConnectionFactoryProxyimport JndiDestinationResolver/** Unit tests for the JmsTemplate implemented using JMS 1.1. ... */Context jndiContext, ...;Destination queue, ...;QosSettings qosSettings, ...;/** Create the mock objects for testing. */this.jndiContextuseTransactedTemplate(...)useTransactedSession(...)JmsTemplate templateJndiDestinationResolver destMannew JndiDestinationResolver(...)JmsTemplateTests.this.jndiContextJmsTemplateTests.thisJMSException jmsExException innerExJmsException springJmsExStringWriter swPrintWriter outString tracesetLinkedException(...)createTemplate(...)MessageProducer messageProducernew ProducerCallback<Void>(...) { ... }setMessageIdEnabled(...)setMessageTimestampEnabled(...)/** Test the method execute(SessionCallback action). */TransactionAwareConnectionFactoryProxy tacfnew TransactionAwareConnectionFactoryProxy(...)Connection tacSession tasList<TransactionSynchronization> synchsgetSynchronizations(...)TransactionSynchronization synchbeforeCommit(...)beforeCompletion(...)afterCommit(...)afterCompletion(...)clearSynchronization(...)/** Test sending to a destination using the method ... */doTestSendDestination(...)/** Test sending to the default destination. *//** Test sending to the default destination name. *//** Test sending to the default destination using explicit QOS parameters. *//** Test sending to the default destination name using explicit QOS parameters. *//** Common method for testing a send method that uses the MessageCreator ... */setQosSettings(...)this.qosSettingsdoTestReceive(...)JmsTemplate.RECEIVE_TIMEOUT_INDEFINITE_WAITJmsTemplate.RECEIVE_TIMEOUT_NO_WAITMessageConsumer messageConsumerMessageConsumer.classString selectorStringString textFromMessagesetPubSubNoLocal(...)receiveSelectedAndConvert(...)doTestSendAndReceive(...)Session localSessiongetLocalSession(...)TemporaryQueue replyDestinationTemporaryQueue.classTextMessage requestMessageCreator.classdoTestJmsException(...)InvalidClientIDException.classInvalidSelectorException.classnew JMSSecurityException(...)JmsSecurityException.classMessageEOFException.classResourceAllocationException.classTransactionInProgressException.classTransactionRolledBackException.classUncategorizedJmsException.class// replyTO set on the requestSession localSession, ...;setupMocks(...)this.localSessionConnectionFactory mockConnectionFactoryJmsGatewaySupport gatewaynew JmsGatewaySupport(...) { ... }BackOff.classBackOffExecution.classcreateFailingContainerFactory(...)createRecoverableContainerFactory(...)createRunningContainer(...)TestRunnable runnable2new TestRunnable(...)waitForCompletion(...)createSuccessfulConnectionFactory(...)DefaultMessageListenerContainer.CACHE_NONEwill(...)int currentAttempts, ...;// 3 attempts max// only on attempt as the second one lead to a recovery// container is stopped but should nevertheless invoke the runnable argument// never happenString DESTINATION_NAME, ...;String EXCEPTION_MESSAGE, ...;StubQueue QUEUE_DESTINATION, ...;new TestMessageListener(...)SimpleMessageConsumer messageConsumernew SimpleMessageConsumer(...)Set<String> failurenew SessionAwareMessageListener<Message>(...) { ... }TestMessageListener listenernew TaskExecutor(...) { ... }listener.executorInvokedlistener.listenerInvokedJMSException theExceptionExceptionListener.classIllegalStateException theExceptionboolean executorInvoked, ...;boolean listenerInvoked, ...;this.listenerInvoked// Queue gets created in order to create MessageConsumer for that Destination...// and then the MessageConsumer gets created...// no MessageSelector...// session gets created in order to register MessageListener...// and the connection is start()ed after the listener is registered...// an exception is thrown, so the rollback logic is being applied here...// Check correct Session passed into SessionAwareMessageListener.// manually trigger an Exception with the above bad MessageListener...// a Throwable from a MessageListener MUST simply be swallowed...// Session is rolled back 'cos it is transacted...Destination actualforDestination(...)JmsResponse<String> jmsResponseforQueue(...)forTopic(...)/** See the MessageListenerAdapterTests class for usage. ... */new SerializableObject(...)String TEXT, ...;Integer NUMBER, ...;SerializableObject OBJECT, ...;String RESPONSE_TEXT, ...;MessageContentsDelegate delegateMessageContentsDelegate.classhandleMessage(...)BytesMessage.classgetBytes(...).lengthByteArrayInputStream inputStreamObjectMessage objectMessageMessageDelegate delegateMessageDelegate.classStubMessageListenerAdapter adapternew StubMessageListenerAdapter(...)wasCalled(...)setDefaultListenerMethod(...)new MessageListenerAdapter(...) { ... }ListenerExecutionFailedException lefxMessageListenerAdapter.ORIGINAL_DEFAULT_LISTENER_METHODResponsiveMessageDelegate delegateResponsiveMessageDelegate.classQueue destinationTextMessage sentTextMessageTextMessage responseTextMessageJMSException.classTextMessage messageTextMessage responseMessageResponsiveJmsTextMessageReturningMessageDelegate delegateResponsiveJmsTextMessageReturningMessageDelegate.class// TextMessage contents must be unwrapped...// BytesMessage contents must be unwrapped...// we DON'T want the default SimpleMessageConversion happening...// correlation ID is queried when response is being created...// Reply-To is queried when response is being created...// we want to fall back to the default...import MappingJackson2MessageConverterimport MessageTypenew SampleBean(...)Destination sharedReplyDestination, ...;SampleBean sample, ...;Message<String> resultgetSimpleInstance(...)Message replyMessagesample.simplesQueue replyDestinationgetPayloadInstance(...)Topic replyDestinationtestReplyWithJackson(...)MappingJackson2MessageConverter messageConverternew MappingJackson2MessageConverter(...)MessageType.TEXTMessagingMessageListenerAdapter adapternew MessagingMessageListenerAdapter(...) { ... }new ArrayList<Message<String>>(...)List<Message<String>> simples, ...;new JmsResponse<String>(...)createSampleResponse(...)Summary.classnew SampleResponse(...)Full.class// Triggers headers resolution/** Stub extension of the {@link MessageListenerAdapter} class for use in testing. ... */import StubResourceAdapternew JmsActivationSpecConfig(...) { ... }setPrefetchSize(...)setDurableSubscriptionName(...)JmsActivationSpecFactory activationSpecFactoryStubActiveMQActivationSpec specnew StubActiveMQResourceAdapter(...)getMaxSessions(...)getMaxMessagesPerSessions(...)isUseRAManagedTransaction(...)DefaultJmsActivationSpecFactory activationSpecFactoryStubWebSphereActivationSpecImpl specnew StubWebSphereResourceAdapterImpl(...)getMaxBatchSize(...)int maxSessions, ...;int maxMessagesPerSessions, ...;boolean useRAManagedTransaction, ...;this.maxSessionsthis.maxMessagesPerSessionsthis.useRAManagedTransactionint maxBatchSize, ...;this.maxBatchSizeJmsMessageEndpointManager endpoint// far from idealimport StubActivationSpec/** StubActivationSpec which implements all required and optional properties (see ... */String destinationType, ...;String subscriptionDurability, ...;String acknowledgeMode, ...;this.destinationTypethis.subscriptionDurabilitynew StubActivationSpec(...)QueueConnectionFactory mockConnectionFactory, ...;QueueConnection mockConnection, ...;QueueSession mockSession, ...;Queue mockQueue, ...;doTestJmsInvokerProxyFactoryBeanAndServiceExporter(...)JmsInvokerProxyFactoryBean pfbnew JmsInvokerProxyFactoryBean(...) { ... }this.mockConnectionFactorysetQueue(...)this.mockQueueRemoteTimeoutException.classJmsInvokerServiceExporter exporternew JmsInvokerServiceExporter(...)Session mockExporterSessionResponseStoringProducer mockProducernew ResponseStoringProducer(...)mockProducer.closedmockProducer.responsesetService(...)new MockSimpleMessageConverter(...)setQueueName(...)setStringArray(...)IllegalAccessException.classMessage response, ...;Serializable serializable, ...;this.serializablenew MockObjectMessage(...)// faking no message received/** Unit tests for the {@link JmsAccessor} class. ... */JmsAccessor accessornew StubJmsAccessor(...)setSessionAcknowledgeModeName(...)/** Crummy, stub, do-nothing subclass of the JmsAccessor class for use in testing. */copyHeaders(...)JmsMessageHeaderAccessor headerAccessorsetJMSDestination(...)setJMSDeliveryMode(...)setJMSExpiration(...)setJMSRedelivered(...)setJMSTimestamp(...)getCorrelationId(...)getExpiration(...)getMessageId(...)getRedelivered(...)getReplyChannel(...)// Making sure replyChannel is not mixed with replyToSimpleJmsHeaderMapper mapper, ...;// Outbound mappinginitBuilder(...)String jmsCorrelationIdJmsHeaderMapper.CONTENT_TYPE_PROPERTYsetOutboundPrefix(...)new StubTextMessage(...) { ... }assertAttemptReadDisallowedPropertyIsNotFatal(...)// Inbound mappingassertInboundHeader(...)int prioritysetInboundPrefix(...)Object barObject badObject headerValue/** Unit tests for the {@link SimpleMessageConverter} class. ... */SimpleMessageConverter converterByteArrayInputStream byteArrayInputStreamMapMessage.classMap<String,String> contentInteger contentObject msgMap<Integer,String> contentMap<Object,String> contentnew HashMap<Object,String>(...)MappingJackson2MessageConverter converter, ...;Session sessionMock, ...;setEncodingPropertyName(...)setTypeIdPropertyName(...)BytesMessage bytesMessageMockDate toBeMarshalledMap<String,String> unmarshalledTextMessage textMessageMockMap<String,String> toBeMarshalledMyBean unmarshalledMyBean resulttestToTextMessageWithReturnType(...)MyAnotherBean beannew MyAnotherBean(...)MyAnotherBean.classbean.fooMarshallingMessageConverter converter, ...;Marshaller marshallerMock, ...;Unmarshaller unmarshallerMock, ...;Marshaller.classUnmarshaller.classnew MarshallingMessageConverter(...)Object toBeMarshalledResult.classObject unmarshalledSource.classMessagingMessageConverter converter, ...;Serializable payloadObjectMessage jmsMessageTextMessage jmsMsgMessage<?> msgnew TestMessageConverter(...)import StubTopicTopic expectedDestinationnew StubTopic(...)testResolveDestination(...)Queue expectedDestinationDynamicDestinationResolver resolverJmsDestinationAccessor accessornew StubJmsDestinationAccessor(...)Destination DESTINATION, ...;JndiDestinationResolver resolvernew OneTimeLookupJndiDestinationResolver(...)CountingCannedJndiDestinationResolver resolvernew CountingCannedJndiDestinationResolver(...)DestinationResolver dynamicResolvernew JndiDestinationResolver(...) { ... }setFallbackToDynamicDestination(...)setDynamicDestinationResolver(...)/** A generic message representation with headers and body. ... *//** Return the message payload. *//** Return message headers for the message (never {@code null} but may be empty). *//** Defines methods for sending messages. ... */long INDEFINITE_TIMEOUT, ...;/** Constant for sending a message without a prescribed timeout. *//** Send a {@link Message} to this channel. If the message is sent successfully, ... *//** Send a message, blocking until either the message is accepted or the ... *//** Exception that indicates an error occurred during message delivery. ... *//** Simple contract for handling a {@link Message}. ... *//** Handle the given message. ... *//** Exception that indicates an error occurred during message handling. ... */import AlternativeJdkIdGeneratorimport IdGenerator/** The headers for a {@link Message}. ... */new AlternativeJdkIdGenerator(...)UUID ID_VALUE_NONE, ...;/** UUID for none. *//** The key for the Message ID. This is an automatically generated UUID and ... *//** The key for the message timestamp. */String CONTENT_TYPE, ...;/** The key for the message content type. */String REPLY_CHANNEL, ...;/** The key for the message reply channel. */String ERROR_CHANNEL, ...;/** The key for the message error channel. */IdGenerator defaultIdGenerator, ...;IdGenerator idGenerator, ...;Map<String,Object> headers, ...;/** Construct a {@link MessageHeaders} with the given headers. An {@link #ID} and ... *//** Constructor providing control over the ID and TIMESTAMP header values. ... */generateId(...)getIdGenerator(...)/** Copy constructor which allows for ignoring certain entries. ... */original.headersIdGenerator generator// Delegating Map implementation/** Since MessageHeaders are immutable, the call to this method ... */// Unsupported Map operations// Serialization methodsSet<String> keysToIgnoredefaultWriteObject(...)// equals, hashCode, toString(...).headers// All entries are serializable -> serialize the regular MessageHeaders instance// Some non-serializable entries -> serialize a temporary MessageHeaders copy/** The base exception for any failures related to messaging. ... */Message<?> failedMessage, ...;this.failedMessage/** A {@link MessageChannel} from which messages may be actively received through polling. ... *//** Receive a message from this channel, blocking indefinitely if necessary. ... *//** Receive a message from this channel, blocking until either a message is available ... *//** Reactive contract for handling a {@link Message}. ... *//** A {@link MessageChannel} that maintains a registry of subscribers and invokes ... *//** Register a message handler. ... *//** Un-register a message handler. ... *//** Common base class for plain JSON converters, e.g. Gson and JSON-B. ... */Type resolvedTypegetResolvedType(...)fromJson(...)getSerializedPayloadClass(...)getWriter(...)toJson(...)InputStream ingetCharsetToUse(...)getMimeType(...)// Assuming a text-based source payload// Assuming a text-based target payloadimport MessageHeaderAccessor/** Abstract base class for {@link SmartMessageConverter} implementations including ... */new DefaultContentTypeResolver(...)List<MimeType> supportedMimeTypes, ...;ContentTypeResolver contentTypeResolver, ...;boolean strictContentTypeMatch, ...;Class<?> serializedPayloadClass, ...;/** Constructor with a single MIME type. ... *//** Constructor with one or more MIME types via vararg. ... *//** Constructor with a Collection of MIME types. ... */this.supportedMimeTypes/** Return the supported MIME types. *//** Allows subclasses to add more supported mime types. ... *//** Configure the {@link ContentTypeResolver} to use to resolve the content ... */this.contentTypeResolver/** Return the configured {@link ContentTypeResolver}. *//** Whether this converter should convert messages for which no content type ... */getSupportedMimeTypes(...)getContentTypeResolver(...)this.strictContentTypeMatch/** Whether content type resolution must produce a value that matches one of ... *//** Configure the preferred serialization class to use (byte[] or String) when ... */this.serializedPayloadClass/** Return the configured preferred serialization payload class. */canConvertFrom(...)convertFromInternal(...)Object payloadToUseconvertToInternal(...)getDefaultContentType(...)MessageBuilder<?> buildercanConvertTo(...)MessageHeaderAccessor accessorgetAccessor(...)MessageHeaderAccessor.classisMutable(...)setHeaderIfAbsent(...)getMessageHeaders(...)supportsMimeType(...)isStrictContentTypeMatch(...)MimeType current/** Return the default content type for the payload. Called when ... *//** Whether the given class is supported by this converter. ... *//** Convert the message payload from serialized form to an Object. ... *//** Convert the payload object to serialized form. ... */Type genericParameterTypegetNestedGenericParameterType(...)Class<?> contextClassnestedIfOptional(...)/** A {@link MessageConverter} that supports MIME type "application/octet-stream" with the ... *//** A {@link MessageConverter} that delegates to a list of registered converters ... */List<MessageConverter> converters, ...;/** Create an instance with the given converters. */new ArrayList<MessageConverter>(...)getConverters(...)Message<?> result/** Return the underlying list of delegate converters. */import InvalidMimeTypeException/** Resolve the content type for a message. ... *//** Determine the {@link MimeType} of a message from the given MessageHeaders. ... *//** A default {@link ContentTypeResolver} that checks the ... */MimeType defaultMimeType, ...;/** Set the default MIME type to use when there is no ... */this.defaultMimeType/** Return the default MIME type to use if no ... *//** An extension of the {@link SimpleMessageConverter} that uses a ... *//** Create a new instance with a default {@link ConversionService}. *//** Create a new instance with the given {@link ConversionService}. */import Gson/** Implementation of {@link MessageConverter} that can read and write JSON ... */Gson gson, ...;/** Construct a new {@code GsonMessageConverter} with default configuration. */this.gsonnew Gson(...)/** Construct a new {@code GsonMessageConverter} with the given delegate. ... *//** Set the {@code Gson} instance to use. ... *//** Return the configured {@code Gson} instance for this converter. */getGson(...)import Jsonbimport JsonbBuilderimport JsonbConfigJsonb jsonb, ...;/** Construct a new {@code JsonbMessageConverter} with default configuration. */this.jsonb/** Construct a new {@code JsonbMessageConverter} with the given configuration. ... *//** Construct a new {@code JsonbMessageConverter} with the given delegate. ... *//** Set the {@code Jsonb} instance to use. ... *//** Return the configured {@code Jsonb} instance for this converter. */getJsonb(...)import KSerializerimport SerializersKtimport Jsonnew ConcurrentReferenceHashMap<Type,KSerializer<Object>>(...)Map<Type,KSerializer<Object>> serializerCache, ...;Json json, ...;/** Construct a new {@code KotlinSerializationJsonMessageConverter} with default configuration. */Json.Default/** Construct a new {@code KotlinSerializationJsonMessageConverter} with the given delegate. ... */this.jsonserializer(...)/** Tries to find a serializer that can marshall or unmarshall instances of the given type ... */KSerializer<Object> serializerimport JsonEncodingimport JsonGeneratorimport DefaultPrettyPrinterimport JsonMappingExceptionimport SerializationFeature/** A Jackson 2 based {@link MessageConverter} implementation. ... */Boolean prettyPrint, ...;/** Construct a {@code MappingJackson2MessageConverter} supporting ... */initObjectMapper(...)ObjectMapper objectMapper/** Set the {@code ObjectMapper} for this converter. ... */configurePrettyPrint(...)/** Return the underlying {@code ObjectMapper} for this converter. *//** Whether to use the {@link DefaultPrettyPrinter} when writing JSON. ... */this.prettyPrintSerializationFeature.INDENT_OUTPUTJavaType javaTypeAtomicReference<Throwable> causeRefcanDeserialize(...)logWarningIfNecessary(...)canSerialize(...)/** Determine whether to log the given exception coming from a ... */boolean debugLevelClass<?> viewreaderWithView(...)JsonEncoding encodinggetJsonEncoding(...)JsonGenerator generatorcreateGenerator(...)getFactory(...)/** Determine the JSON encoding to use for the given content type. ... */getJavaName(...)JsonEncoding.UTF8// Do not log warning for serializer not found (note: different message wording on Jackson 2.9)// should not be called, since we override canConvertFrom/canConvertTo instead// No JSON view specified.../** Implementation of {@link MessageConverter} that can read and write XML using Spring's ... *//** Default construct allowing for {@link #setMarshaller(Marshaller)} and/or ... *//** Constructor with a given list of MIME types to support. ... *//** Constructor with {@link Marshaller}. If the given {@link Marshaller} also ... *//** Return the configured Marshaller. *//** Return the configured unmarshaller. *//** An exception raised by {@link MessageConverter} implementations. ... *//** A converter to turn the payload of a {@link Message} from serialized form to a typed ... *//** Convert the payload of a {@link Message} from a serialized form to a typed Object ... *//** Create a {@link Message} whose payload is the result of converting the given ... */import ExtensionRegistryimport JsonFormat/** Subclass of {@link ProtobufMessageConverter} for use with the official ... *//** Constructor with default instances of {@link com.google.protobuf.util.JsonFormat.Parser ... *//** Constructor with given instances of {@link com.google.protobuf.util.JsonFormat.Parser ... */JsonFormat.ParserJsonFormat.Printernew ProtobufJavaUtilSupport(...)import static MimeTypeUtils.APPLICATION_JSONimport static MimeTypeUtils.TEXT_PLAIN/** An {@code MessageConverter} that reads and writes ... */new ConcurrentReferenceHashMap<Class<?>,Method>(...)/** The default charset used by the converter. */MimeType PROTOBUF, ...;/** The mime-type for protobuf {@code application/x-protobuf}. */Map<Class<?>,Method> methodCache, ...;ExtensionRegistry extensionRegistry, ...;ProtobufFormatSupport protobufFormatSupport, ...;/** Constructor with a default instance of {@link ExtensionRegistry}. *//** Constructor with a given {@code ExtensionRegistry}. */this.protobufFormatSupportaddSupportedMimeTypes(...)supportedMediaTypes(...)this.extensionRegistryMimeType contentTypesupportsWriteOnly(...)Message.BuildergetMessageBuilder(...)mergeFrom(...)ByteArrayOutputStream byteArrayOutputStream/** Create a new {@code Message.Builder} instance for the given class. ... *//** Protobuf format support. *//** {@link ProtobufFormatSupport} implementation used when ... */JsonFormat.Parser parser, ...;JsonFormat.Printer printer, ...;parser(...)printer(...)new MimeType[]/** A simple converter that simply unwraps the message payload as long as it matches the ... *//** A variant of {@link #fromMessage(Message, Class)} which takes an extra ... *//** A variant of {@link #toMessage(Object, MessageHeaders)} which takes an extra ... *//** A {@link MessageConverter} that supports MIME type "text/plain" with the ... */getContentTypeCharset(...)/** Provides support for message conversion. *//** An extension of {@link AbstractMessagingTemplate} that adds operations for sending ... */DestinationResolver<D> destinationResolver, ...;/** Configure the {@link DestinationResolver} to use to resolve String destination ... *//** Return the configured destination resolver. */D destination/** An extension of {@link AbstractMessageSendingTemplate} that adds support for ... */getRequiredDefaultDestination(...)/** Actually receive a message from the given destination. ... *//** Convert from the given message to the given target class. ... *//** Abstract base class for implementations of {@link MessageSendingOperations}. ... */String CONVERSION_HINT_HEADER, ...;/** Name of the header that can be set to provide further information ... */D defaultDestination, ...;MessageConverter converter, ...;/** Configure the default destination to use in send methods that don't have ... *//** Return the configured default destination. *//** Set the {@link MessageConverter} to use in {@code convertAndSend} methods. ... *//** Return the configured {@link MessageConverter}. */MessageHeaders messageHeadersMap<String,Object> headersToUseprocessHeadersToSend(...)String payloadTypeObject contentType/** Provides access to the map of input headers before a send operation. ... *//** An extension of {@link AbstractMessageReceivingTemplate} that adds support for ... */import MessageChannel/** An implementation of {@link DestinationResolver} that interprets a destination ... *//** A default constructor that can be used when the resolver itself is configured ... *//** A constructor that accepts a {@link BeanFactory} useful if instantiating this ... */MessageChannel.class/** {@link DestinationResolver} implementation that proxies a target DestinationResolver, ... */new ConcurrentHashMap<String,D>(...)Map<String,D> resolvedDestinationCache, ...;DestinationResolver<D> targetDestinationResolver, ...;/** Create a new CachingDestinationResolverProxy, setting the target DestinationResolver ... *//** Create a new CachingDestinationResolverProxy using the given target ... */this.targetDestinationResolver/** Set the target DestinationResolver to delegate to. *//** Resolves and caches destinations if successfully resolved by the target ... */this.resolvedDestinationCache/** Thrown by a {@link DestinationResolver} when it cannot resolve a destination. ... *//** Strategy for resolving a String destination name to an actual destination ... *//** Resolve the given destination name. ... *//** Extends {@link MessageReceivingOperations} and adds operations for receiving messages ... *//** Resolve the given destination name and receive a message from it. ... *//** Resolve the given destination name, receive a message from it, ... *//** Extends {@link MessageRequestReplyOperations} and adds operations for sending and ... *//** Resolve the given destination name to a destination and send the given message, ... *//** Resolve the given destination name, convert the payload request Object ... *//** Extends {@link MessageSendingOperations} and adds operations for sending messages ... *//** Resolve the given destination name to a destination and send a message to it. ... *//** Resolve the given destination name to a destination, convert the payload Object ... *//** Resolve the given destination name to a destination, convert the payload ... */import MessageDeliveryExceptionimport PollableChannel/** A messaging template that resolves destinations names to {@link MessageChannel}'s ... */String DEFAULT_SEND_TIMEOUT_HEADER, ...;/** The default header key used for a send timeout. */String DEFAULT_RECEIVE_TIMEOUT_HEADER, ...;/** The default header key used for a receive timeout. */long sendTimeout, ...;String sendTimeoutHeader, ...;String receiveTimeoutHeader, ...;boolean throwExceptionOnLateReply, ...;/** Configure the default timeout value to use for send operations. ... */this.sendTimeout/** Return the configured default send operation timeout value. *//** Configure the default timeout value to use for receive operations. ... *//** Return the configured receive operation timeout value. *//** Set the name of the header used to determine the send timeout (if present). ... */this.sendTimeoutHeader/** Return the configured send-timeout header. ... */this.receiveTimeoutHeader/** Return the configured receive-timeout header. ... *//** Whether the thread sending a reply should have an exception raised if the ... */this.throwExceptionOnLateReplynew BeanFactoryMessageChannelDestinationResolver(...)sendTimeout(...)Message<?> messageToSendboolean sentremoveHeader(...)setImmutable(...)new MessageDeliveryException(...)Object originalReplyChannelHeaderObject originalErrorChannelHeadergetErrorChannel(...)long sendTimeoutreceiveTimeout(...)TemporaryReplyChannel tempReplyChannelnew TemporaryReplyChannel(...)setErrorChannel(...)setReplyChannel(...)setSendFailed(...)MessageHeaders.ERROR_CHANNELMessageHeaders.REPLY_CHANNELLong sendTimeoutheaderToLong(...)Long receiveTimeout/** A temporary channel for receiving a single reply message. */TemporaryReplyChannel.classCountDownLatch replyLatch, ...;Message<?> replyMessage, ...;boolean hasReceived, ...;boolean hasTimedOut, ...;boolean hasSendFailed, ...;this.hasSendFailedthis.replyLatchthis.hasReceivedthis.hasTimedOutthis.replyMessageboolean alreadyReceivedReplyString errorDescription/** A contract for processing a {@link Message} after it has been created, either ... *//** Operations for receiving messages from a destination. ... *//** Receive a message from a default destination. ... *//** Receive a message from a default destination and convert its payload to the ... *//** Operations for sending messages to and receiving the reply from a destination. ... *//** Send a request message and receive the reply from a default destination. ... *//** Operations for sending messages to a destination. ... *//** Send a message to a default destination. ... *//** Defines interfaces and implementation classes for messaging templates. *//** Base class for {@code MessageCondition's} that pre-declares abstract methods ... */getToStringInfix(...)Object expression/** Return the collection of objects the message condition is composed of ... *//** The notation to use when printing discrete items of content. ... *//** Composite {@link MessageCondition} that delegates to other message conditions. ... */List<MessageCondition<?>> messageConditions, ...;this.messageConditionsMessageCondition<?> conditionList<MessageCondition<?>> resultnew ArrayList<MessageCondition<?>>(...)checkCompatible(...)getMessageConditions(...)new CompositeMessageCondition(...)MessageCondition<?> matchingConditiongetMatchingCondition(...)List<MessageCondition<?>> otherConditionsList<MessageCondition<?>> othersCompositeMessageCondition otherCompositenew Function<MessageCondition<?>,String>(...) { ... }import RouteMatcherimport SimpleRouteMatcher/** {@link MessageCondition} to match the destination header of a Message ... */String LOOKUP_DESTINATION_HEADER, ...;/** The name of the "lookup destination" header. */Set<String> patterns, ...;RouteMatcher routeMatcher, ...;/** Constructor with patterns only. Creates and uses an instance of ... *//** Constructor with patterns and a {@code PathMatcher} instance. ... */new SimpleRouteMatcher(...)/** Constructor with patterns and a {@code RouteMatcher} instance. ... */prependLeadingSlash(...)boolean slashSeparatorthis.routeMatcher/** Returns a new instance with URL patterns from the current instance ("this") and ... */other.patternsString pattern1String pattern2new DestinationPatternsMessageCondition(...)/** Check if any of the patterns match the given Message destination and return an instance ... */matchPattern(...)RouteMatcher.Route/** Compare the two conditions based on the destination patterns they contain. ... */Comparator<String> patternComparatorIterator<String> iteratorOther/** Encapsulates information about a handler method consisting of a ... */HandlerMethod.class/** Public for wrapping with fallback logger. */Method bridgedMethod, ...;...[] parameters, ...;HandlerMethod resolvedFromHandlerMethod, ...;/** Create an instance from a bean instance and a method. */this.bridgedMethodinitMethodParameters(...)/** Create an instance from a bean instance, method name, and parameter types. ... *//** Create an instance from a bean name, a method, and a {@code BeanFactory}. ... *//** Copy constructor for use in subclasses. */handlerMethod.beanhandlerMethod.beanFactoryhandlerMethod.beanTypehandlerMethod.methodhandlerMethod.bridgedMethodhandlerMethod.parametersthis.resolvedFromHandlerMethodhandlerMethod.resolvedFromHandlerMethod/** Re-create HandlerMethod with the resolved handler. */MethodParameter[] resultnew MethodParameter[]new HandlerMethodParameter(...)/** Return the bean for this handler method. *//** Return the method for this handler method. *//** This method returns the type of the handler for this handler method. ... *//** If the bean method is a bridge method, this method returns the bridged ... *//** Return the method parameters for this handler method. *//** Return the HandlerMethod return type. *//** Return the actual return value type. */new ReturnValueMethodParameter(...)/** Return {@code true} if the method return type is void, {@code false} otherwise. *//** Return a single annotation on the underlying method traversing its super methods ... *//** Return the HandlerMethod from which this HandlerMethod instance was ... *//** If the provided instance contains a bean name rather than an object instance, ... */Object handlernew HandlerMethod(...)/** Return a short representation of this handler method for log message purposes. */int argsHandlerMethod otherMethodotherMethod.beanotherMethod.method// Support methods for use in "InvocableHandlerMethod" sub-class variants..Object providedArgformatInvokeError(...)String formattedArgsnew IntFunction<String>(...) { ... }getBridgedMethod(...)/** A MethodParameter with HandlerMethod-specific behavior. */HandlerMethod.this.bridgedMethodHandlerMethod.thishasMethodAnnotation(...)/** A MethodParameter for a HandlerMethod return type based on an actual return value. */Object returnValue, ...;this.returnValueoriginal.returnValue/** Contract for mapping conditions to messages. ... *//** Define the rules for combining this condition with another. ... *//** Check if this condition matches the given Message and returns a ... *//** Compare this condition to another in the context of a specific message. ... *//** Represents a Spring-managed bean with cross-cutting functionality to be ... *//** Return the type of the contained advice bean. ... *//** Return the advice bean instance, if necessary resolving a bean specified ... *//** Whether this {@link MessagingAdviceBean} applies to the given bean type. ... *//** Annotation that indicates a method parameter should be bound to a template variable ... *//** The name of the destination template variable to bind to. *//** Annotation which indicates that a method parameter should be bound to a message header. ... *//** Alias for {@link #name}. *//** The name of the request header to bind to. ... *//** Whether the header is required. ... *//** The default value to use as a fallback. ... *//** Annotation which indicates that a method parameter should be bound to the headers of a ... *//** Annotation for handling exceptions thrown from message-handling methods within a ... *//** Exceptions handled by the annotated method. If empty, will default to any ... *//** Annotation for mapping a {@link Message} onto a message-handling method by ... *//** Destination-based mapping expressed by this annotation. ... *//** Annotation that binds a method parameter to the payload of a message. Can also ... *//** Alias for {@link #expression}. *//** A SpEL expression to be evaluated against the payload object as the root context. ... *//** Whether payload content is required. ... *//** Annotation that indicates a method's return value should be converted to ... *//** The destination for a message created from the return value of a method. *//** Common annotation value constants. ... */String DEFAULT_NONE, ...;/** Constant defining a value for no default - as a replacement for {@code null} which ... *//** Annotations and support classes for handling messages. */import ValueConstantsimport SyncHandlerMethodArgumentResolver/** Abstract base class to resolve method arguments from a named value, e.g. ... */new ConcurrentHashMap<MethodParameter,NamedValueInfo>(...)ConfigurableBeanFactory configurableBeanFactory, ...;BeanExpressionContext expressionContext, ...;Map<MethodParameter,NamedValueInfo> namedValueInfoCache, ...;/** Constructor with a {@link ConversionService} and a {@link BeanFactory}. ... */this.configurableBeanFactorythis.expressionContextNamedValueInfo namedValueInfogetNamedValueInfo(...)MethodParameter nestedParameterObject resolvedNameresolveEmbeddedValuesAndExpressions(...)namedValueInfo.nameresolveArgumentInternal(...)namedValueInfo.defaultValuenamedValueInfo.requiredhandleMissingValue(...)handleNullValue(...)/** Obtain the named value for the given method parameter. */this.namedValueInfoCachecreateNamedValueInfo(...)updateNamedValueInfo(...)/** Create the {@link NamedValueInfo} object for the given method parameter. ... *//** Fall back on the parameter name from the class file if necessary and ... */info.namenew NamedValueInfo(...)info.requiredinfo.defaultValueValueConstants.DEFAULT_NONE/** Resolve the given annotation-specified value, ... */String placeholdersResolvedBeanExpressionResolver exprResolver/** Resolves the given parameter type and value name into an argument value. ... *//** Invoked when a value is required, but {@link #resolveArgumentInternal} ... *//** One last chance to handle a possible null value. ... *//** Represents a named value declaration. */String defaultValue, ...;// Check for null value after conversion of incoming argument valueimport HandlerMethodArgumentResolver/** No-op resolver for method arguments of type {@link kotlin.coroutines.Continuation}. ... */import MessageHandlingExceptionimport DestinationVariable/** Resolve for {@link DestinationVariable @DestinationVariable} method parameters. ... */DestinationVariableMethodArgumentResolver.classString DESTINATION_TEMPLATE_VARIABLES_HEADER, ...;/** The name of the header used to for template variables. */hasParameterAnnotation(...)DestinationVariable.classDestinationVariable annotnew DestinationVariableNamedValueInfo(...)Map<String,String> varsnew MessageHandlingException(...)/** Resolver for {@link Header @Header} arguments. Headers are resolved from ... */HeaderMethodArgumentResolver.classHeader.classHeader annotnew HeaderNamedValueInfo(...)Object nativeHeaderValuegetNativeHeaderValue(...)Map<String,List<String>> nativeHeadersgetNativeHeaders(...)List<?> nativeHeaderValuesNativeMessageHeaderAccessor.NATIVE_HEADERSdefaultValue(...)/** Argument resolver for headers. Resolves the following method parameters: ... */Headers.classnew MessageHeaderAccessor(...)import CompositeMessageConditionimport DestinationPatternsMessageConditionimport HandlerMethodimport AnnotationExceptionHandlerMethodResolverimport AbstractExceptionHandlerMethodResolverimport AbstractEncoderMethodReturnValueHandlerimport AbstractMethodMessageHandlerimport HandlerMethodReturnValueHandler/** Extension of {@link AbstractMethodMessageHandler} for reactive, non-blocking ... */new ArrayList<Decoder<?>>(...)List<Decoder<?>> decoders, ...;setHandlerPredicate(...)/** Configure the decoders to use for incoming payloads. */this.decoders/** Return the configured decoders. *//** Set the Validator instance used for validating {@code @Payload} arguments. ... *//** Return the configured Validator instance. *//** Set the {@code RouteMatcher} to use for mapping messages to handlers ... *//** Return the {@code RouteMatcher} used to map messages to handlers. ... *//** Obtain the {@code RouteMatcher} for actual use. ... */RouteMatcher routeMatchergetRouteMatcher(...)/** Configure a {@link ConversionService} to use for type conversion of ... *//** Return the configured ConversionService. */AntPathMatcher pathMatcherList<HandlerMethodArgumentResolver> resolversnew ArrayList<HandlerMethodArgumentResolver>(...)new HeaderMethodArgumentResolver(...)new HeadersMethodArgumentResolver(...)new DestinationVariableMethodArgumentResolver(...)isKotlinPresent(...)new ContinuationHandlerMethodArgumentResolver(...)getCustomResolvers(...)getArgumentResolverConfigurer(...)new PayloadMethodArgumentResolver(...)getDecoders(...)getReactiveAdapterRegistry(...)CompositeMessageCondition methodConditionCompositeMessageCondition typeCondition/** Determine the mapping condition for the given annotated element. ... */MessageMapping annMessageMapping.classprocessDestinations(...)value(...).lengthobtainRouteMatcher(...)/** Resolve placeholders in the given destinations. ... */DestinationPatternsMessageCondition.classDestinationPatternsMessageCondition.LOOKUP_DESTINATION_HEADERnew Comparator<CompositeMessageCondition>(...) { ... }new AnnotationExceptionHandlerMethodResolver(...)Set<String> patternsRoute destinationmatchAndExtract(...)MessageHeaderAccessor mhaDestinationVariableMethodArgumentResolver.DESTINATION_TEMPLATE_VARIABLES_HEADERhandleMatch(...)// Initialize RouteMatcher before parent initializes handler mappings// Annotation-based resolvers// Type-based...// Custom resolvers// Catch-allimport DecodingExceptionimport MethodArgumentResolutionException/** A resolver to extract and decode the payload of a message using a ... */ReactiveAdapterRegistry adapterRegistry, ...;boolean useDefaultResolution, ...;this.adapterRegistrythis.useDefaultResolution/** Return a read-only list of the configured decoders. *//** Return the configured validator, if any. *//** Return the configured {@link ReactiveAdapterRegistry}. *//** Whether this resolver is configured to use default resolution, i.e. ... */Payload.class/** Decode the content of the given message payload through a compatible ... */Payload annFlux<DataBuffer> contentextractContent(...)expression(...)decodeContent(...)new Function<?,DataBuffer>(...) { ... }getUnexpectedPayloadError(...)new MethodArgumentResolutionException(...)/** Return the mime type for the content. By default this method checks the ... */getAdapterRegistry(...)Consumer<Object> validatorMap<String,Object> hintsDecoder<?> decoderFlux<?> fluxonErrorResume(...)nonEmptyDataBuffer(...)new Function<DataBuffer,?>(...) { ... }new Function<Throwable,Publisher<? extends ?>>(...) { ... }handleReadError(...)switchIfEmpty(...)new Supplier<Throwable>(...) { ... }handleMissingBody(...)Mono<?> mononew Function<Throwable,Mono<? extends ?>>(...) { ... }Object hintsObject[] validationHintsBeanPropertyBindingResult bindingResultnew MethodArgumentNotValidException(...)// Single-value (with or without reactive type wrapper)/** Support classes for working with annotated message-handling methods with ... */handleResolvedValue(...)/** Invoked after a value is resolved. ... */// Fallback on shared ConversionService for now for historic reasons.// Possibly remove after discussion in gh-23882.//noinspection ConstantConditionsimport MessageExceptionHandler/** A sub-class of {@link AbstractExceptionHandlerMethodResolver} that looks for ... *//** A constructor that finds {@link MessageExceptionHandler} methods in the given type. ... */initExceptionMappings(...)Map<Method,MessageExceptionHandler> methodsMethodIntrospector.MetadataLookup<MessageExceptionHandler>new MetadataLookup<MessageExceptionHandler>(...) { ... }MessageExceptionHandler.classMap<Class<? extends Throwable>,Method> resultnew HashMap<Class<? extends Throwable>,Method>(...)Entry<Method,MessageExceptionHandler> entryMap<>.Entry<Method,MessageExceptionHandler>List<Class<? extends Throwable>> exceptionTypesgetExceptionsFromMethodSignature(...)Class<? extends Throwable> exceptionTypeMethod oldMethodimport HandlerMethodArgumentResolverComposite/** The default {@link MessageHandlerMethodFactory} implementation creating an ... */new HandlerMethodArgumentResolverComposite(...)List<HandlerMethodArgumentResolver> customArgumentResolvers, ...;HandlerMethodArgumentResolverComposite argumentResolvers, ...;/** Set the {@link ConversionService} to use to convert the original ... *//** Set the {@link MessageConverter} to use. By default a {@link GenericMessageConverter} ... *//** Set the list of custom {@code HandlerMethodArgumentResolver}s that will be used ... */this.customArgumentResolvers/** Configure the complete list of supported argument types effectively overriding ... */this.argumentResolversaddResolvers(...)/** A {@link BeanFactory} only needs to be available for placeholder resolution ... */getResolvers(...)initArgumentResolvers(...)new InvocableHandlerMethod(...)setMessageMethodArgumentResolvers(...)new MessageMethodArgumentResolver(...)// Annotation-based argument resolution// Type-based argument resolution/** A factory for {@link InvocableHandlerMethod} that is suitable to process ... *//** Create the {@link InvocableHandlerMethod} that is able to process the specified ... *//** {@code HandlerMethodArgumentResolver} for {@link Message} method arguments. ... *//** Create a default resolver instance without message conversion. *//** Create a resolver instance with the given {@link MessageConverter}. ... */Class<?> targetMessageTypeClass<?> targetPayloadTypegetPayloadType(...)new MethodArgumentTypeMismatchException(...)isEmptyPayload(...)convertPayload(...)/** Resolve the target class to convert the payload to. ... */Type genericParamType/** Check if the given {@code payload} is empty. ... */SmartMessageConverter smartConverter/** Exception to be thrown when a method argument fails validation perhaps as a ... *//** Create a new instance with the invalid {@code MethodParameter}. *//** Create a new instance with the invalid {@code MethodParameter} and a ... */getValidationErrorMessage(...)/** Return the BindingResult if the failure is validation-related, ... *//** Exception that indicates that a method argument has not the expected type. ... *//** A resolver to extract and convert the payload of a message using a ... *//** Create a new {@code PayloadArgumentResolver} with the given ... */resolveTargetClass(...)Class<?> payloadClass/** Specify if the given {@code payload} is empty. ... *//** Validate the payload if applicable. ... *//** Support classes for working with annotated message-handling methods. *//** Convenient base class for {@link AsyncHandlerMethodReturnValueHandler} ... */// Should never be called since we return "true" from isAsyncReturnValueimport ExceptionDepthComparator/** Cache exception handling method mappings and provide options to look up a method ... */new ConcurrentReferenceHashMap<Class<? extends Throwable>,Method>(...)AbstractExceptionHandlerMethodResolver.classMethod NO_MATCHING_EXCEPTION_HANDLER_METHOD, ...;Map<Class<? extends Throwable>,Method> mappedMethods, ...;Map<Class<? extends Throwable>,Method> exceptionLookupCache, ...;/** Protected constructor accepting exception-to-method mappings. */this.mappedMethods/** Extract the exceptions this method handles. This implementation looks for ... */List<Class<? extends Throwable>> result/** Whether the contained type has any exception mappings. *//** Find a {@link Method} to handle the given exception. ... */resolveMethodByExceptionType(...)/** Find a {@link Method} to handle the given exception type. This can be ... */this.exceptionLookupCachegetMappedMethod(...)/** Return the {@link Method} mapped to the given exception type, or ... */List<Class<? extends Throwable>> matchesClass<? extends Throwable> mappedException/** For the {@link #NO_MATCHING_EXCEPTION_HANDLER_METHOD} constant. */import MessageHandlerimport MessagingAdviceBean/** Abstract base class for HandlerMethod-based message handling. Provides most of ... */new ArrayList<HandlerMethodReturnValueHandler>(...)new HandlerMethodReturnValueHandlerComposite(...)new LinkedHashMap<T,HandlerMethod>(...)new LinkedMultiValueMap<String,T>(...)new ConcurrentHashMap<Class<?>,AbstractExceptionHandlerMethodResolver>(...)new LinkedHashMap<MessagingAdviceBean,AbstractExceptionHandlerMethodResolver>(...)String SCOPED_TARGET_NAME_PREFIX, ...;/** Bean name prefix for target beans behind scoped proxies. Used to exclude those ... */Log handlerMethodLogger, ...;List<String> destinationPrefixes, ...;List<HandlerMethodReturnValueHandler> customReturnValueHandlers, ...;HandlerMethodReturnValueHandlerComposite returnValueHandlers, ...;Map<T,HandlerMethod> handlerMethods, ...;MultiValueMap<String,T> destinationLookup, ...;Map<Class<?>,AbstractExceptionHandlerMethodResolver> exceptionHandlerCache, ...;Map<MessagingAdviceBean,AbstractExceptionHandlerMethodResolver> exceptionHandlerAdviceCache, ...;/** When this property is configured only messages to destinations matching ... */this.destinationPrefixes/** Return the configured destination prefixes, if any. *//** Sets the list of custom {@code HandlerMethodArgumentResolver}s that will be used ... *//** Return the configured custom argument resolvers, if any. *//** Set the list of custom {@code HandlerMethodReturnValueHandler}s that will be used ... */this.customReturnValueHandlers/** Return the configured custom return value handlers, if any. *//** Configure the complete list of supported argument types, effectively overriding ... *//** Return the complete list of argument resolvers. *//** Configure the complete list of supported return value types, effectively overriding ... */this.returnValueHandlersaddHandlers(...)/** Return the complete list of return value handlers. */getReturnValueHandlers(...)Log returnValueLoggergetReturnValueHandlerLogger(...)initReturnValueHandlers(...)this.handlerMethodLoggergetHandlerMethodLogger(...)isHandler(...)detectHandlerMethods(...)/** Return the list of argument resolvers to use. Invoked only if the resolvers ... *//** Return the list of return value handlers to use. Invoked only if the return ... *//** Whether the given bean type should be introspected for messaging handling methods. *//** Detect if the given handler has any methods that can handle messages and if ... */Class<?> handlerTypeClass<?> userTypeMap<Method,T> methodsMethodIntrospector.MetadataLookup<T>new MetadataLookup<T>(...) { ... }getMappingForMethod(...)formatMappings(...)new BiConsumer<Method,T>(...) { ... }registerHandlerMethod(...)String formattedTypeFunction<Method,String> methodFormatternew Function<Method,String>(...) { ... }new Function<Entry<Method,T>,String>(...) { ... }/** Provide the mapping for a handler method. ... *//** Register a handler method and its unique mapping. ... */HandlerMethod newHandlerMethodcreateHandlerMethod(...)HandlerMethod oldHandlerMethodthis.handlerMethodsgetDirectLookupDestinations(...)this.destinationLookup/** Create a HandlerMethod instance from an Object handler that is either a handler ... */HandlerMethod handlerMethod/** Return destinations contained in the mapping that are not patterns and are ... *//** Return a logger to set on {@link HandlerMethodReturnValueHandlerComposite}. ... *//** Return a logger to set on {@link InvocableHandlerMethod}. ... *//** Subclasses can invoke this method to populate the MessagingAdviceBean cache ... */this.exceptionHandlerAdviceCache/** Return a map with all handler methods and their mappings. */String lookupDestinationgetLookupDestination(...)MessageHeaderAccessor headerAccessorgetMutableAccessor(...)setLeaveMutable(...)getShortLogMessage(...)handleMessageInternal(...)/** Check whether the given destination (of an incoming message) matches to ... */List<Match> matchesnew ArrayList<Match>(...)List<T> mappingsByUrlComparator<Match> comparatornew MatchComparator(...)getMappingComparator(...)Match bestMatchaddMatchesToCollection(...)Set<T> allMappingshandleNoMatch(...)Match secondBestMatchbestMatch.handlerMethodsecondBestMatch.handlerMethodbestMatch.mappingT mappingT matchgetMatchingMapping(...)new Match(...)/** Check if a mapping matches the current message and return a possibly ... *//** Return a comparator for sorting matching mappings. ... */InvocableHandlerMethod invocablecreateWithResolvedBean(...)isAsyncReturnValue(...)toListenableFuture(...)new ReturnValueListenableFutureCallback(...)handleReturnValue(...)processHandlerMethodException(...)Exception handlingExceptiongetExceptionHandlerMethod(...)/** Find an {@code @MessageExceptionHandler} method for the given exception. ... */AbstractExceptionHandlerMethodResolver resolverthis.exceptionHandlerCacheresolveMethod(...)createExceptionHandlerMethodResolverFor(...)Entry<MessagingAdviceBean,AbstractExceptionHandlerMethodResolver> entryMap<>.Entry<MessagingAdviceBean,AbstractExceptionHandlerMethodResolver>MessagingAdviceBean adviceisApplicableToBeanType(...)getDestinationPrefixes(...)/** A thin wrapper around a matched HandlerMethod and its matched mapping for ... */T mapping, ...;HandlerMethod handlerMethod, ...;match1.mappingmatch2.mappinggetAsyncReturnValueType(...)handleFailure(...)// No direct hits, go through all mappings/** An extension of {@link HandlerMethodReturnValueHandler} for handling async, ... *//** Whether the return value represents an asynchronous, Future-like type ... *//** Adapt the asynchronous return value to a {@link ListenableFuture}. ... */import CompletableToListenableFutureAdapter/** Support for {@link CompletableFuture} (and as of 4.3.7 also {@link CompletionStage}) ... */new CompletableToListenableFutureAdapter<Object>(...)/** Strategy interface for resolving method parameters into argument values ... *//** Whether the given {@linkplain MethodParameter method parameter} is ... *//** Resolves a method parameter into an argument value from a given message. ... *//** Resolves method parameters by delegating to a list of registered ... */new ConcurrentHashMap<MethodParameter,HandlerMethodArgumentResolver>(...)List<HandlerMethodArgumentResolver> argumentResolvers, ...;Map<MethodParameter,HandlerMethodArgumentResolver> argumentResolverCache, ...;/** Add the given {@link HandlerMethodArgumentResolver}. *//** Add the given {@link HandlerMethodArgumentResolver HandlerMethodArgumentResolvers}. ... *//** Add the given {@link HandlerMethodArgumentResolver HandlerMethodArgumentResolvers}. *//** Return a read-only list with the contained resolvers, or an empty list. *//** Clear the list of configured resolvers. */getArgumentResolver(...)/** Iterate over registered ... */HandlerMethodArgumentResolver resolverresolveArgument(...)/** Find a registered {@link HandlerMethodArgumentResolver} that supports ... */HandlerMethodArgumentResolver resultthis.argumentResolverCachesupportsParameter(...)/** Strategy interface to handle the value returned from the invocation of a ... *//** Whether the given {@linkplain MethodParameter method return type} is ... *//** Handle the given return value. ... *//** A HandlerMethodReturnValueHandler that wraps and delegates to others. ... */HandlerMethodReturnValueHandlerComposite.classList<HandlerMethodReturnValueHandler> returnValueHandlers, ...;/** Return a read-only list with the configured handlers. *//** Clear the list of configured handlers. *//** Add the given {@link HandlerMethodReturnValueHandler}. *//** Add the given {@link HandlerMethodReturnValueHandler HandlerMethodReturnValueHandlers}. */getReturnValueHandler(...)HandlerMethodReturnValueHandler handlersupportsReturnType(...)/** Extension of {@link HandlerMethod} that invokes the underlying method with ... */HandlerMethodArgumentResolverComposite resolvers, ...;/** Create an instance from a {@code HandlerMethod}. *//** Construct a new handler method with the given bean instance, method name and parameters. ... *//** Set {@link HandlerMethodArgumentResolver HandlerMethodArgumentResolvers} to use to use for resolving method argument values. *//** Set the ParameterNameDiscoverer for resolving parameter names when needed ... *//** Invoke the method after resolving its argument values in the context of the given message. ... */getMethodArgumentValues(...)/** Get the method argument values for the current message, checking the provided ... */MethodParameter[] parametersgetMethodParameters(...)findProvidedArgument(...)formatArgumentError(...)String exMsg/** Invoke the handler method with the given argument values. */new AsyncResultMethodParameter(...)ResolvableType returnType, ...;this.returnTypeoriginal.returnType// Leave stack trace for later, exception may actually be resolved and handled...// Unwrap for HandlerExceptionResolvers .../** Support for {@link ListenableFuture} as a return value type. ... *//** Common exception resulting from the invocation of ... */MethodParameter parameter, ...;/** Create a new instance providing the invalid {@code MethodParameter}. */getMethodParameterMessage(...)/** Create a new instance providing the invalid {@code MethodParameter} and ... *//** Create a new instance providing the invalid {@code MethodParameter}, ... *//** Return the MethodParameter that was rejected. */import MonoToListenableFutureAdapter/** Support for single-value reactive types (like {@code Mono} or {@code Single}) ... */new MonoToListenableFutureAdapter<Object>(...)/** Common infrastructure for invoking message handler methods. *//** Base class for a return value handler that encodes return values to ... */ResolvableType VOID_RESOLVABLE_TYPE, ...;ResolvableType OBJECT_RESOLVABLE_TYPE, ...;String COROUTINES_FLOW_CLASS_NAME, ...;List<Encoder<?>> encoders, ...;this.encoders/** The configured encoders. *//** The configured adapter registry. */DataBufferFactory bufferFactoryHandlerMethodReturnValueHandler.DATA_BUFFER_FACTORY_HEADERFlux<DataBuffer> encodedContentencodeContent(...)handleNoContent(...)new ChannelSendOperator<DataBuffer>(...)new Function<Publisher<DataBuffer>,Publisher<Void>>(...) { ... }handleEncodedContent(...)ResolvableType returnValueTypePublisher<?> publisherEncoder<?> encoderboolean isUnwrappedisSuspendingFunction(...)justOrEmpty(...)getEncoders(...)/** Subclasses implement this method to handle encoded values in some way ... *//** Invoked for a {@code null} return value, which could mean a void method ... */// We could check canEncode but we're probably last in order anywayimport ReactiveMessageHandler/** Abstract base class for reactive HandlerMethod-based message handling. ... */new ArgumentResolverConfigurer(...)new ReturnValueHandlerConfigurer(...)new InvocableHelper(...)new Function<Class<?>,AbstractExceptionHandlerMethodResolver>(...) { ... }createExceptionMethodResolverFor(...)new ConcurrentHashMap<T,HandlerMethod>(...)new ConcurrentHashMap<String,List<T>>(...)Predicate<Class<?>> handlerPredicate, ...;List<Object> handlers, ...;ArgumentResolverConfigurer argumentResolverConfigurer, ...;ReturnValueHandlerConfigurer returnValueHandlerConfigurer, ...;InvocableHelper invocableHelper, ...;Map<String,List<T>> destinationLookup, ...;/** Configure a predicate for selecting which Spring beans to check for the ... */this.handlerPredicate/** Return the {@link #setHandlerPredicate configured} handler predicate. *//** Manually configure the handlers to check for the presence of message ... */this.handlers/** Configure custom resolvers for handler method arguments. */this.argumentResolverConfigurer/** Return the configured custom resolvers for handler method arguments. *//** Configure custom return value handlers for handler methods. */this.returnValueHandlerConfigurer/** Return the configured return value handlers. *//** Configure the registry for adapting various reactive types. ... */setReactiveAdapterRegistry(...)this.invocableHelper/** Return the configured registry for adapting reactive types. */registerExceptionHandlerAdvice(...)/** Return a read-only map with all handler methods and their mappings. *//** Return a read-only multi-value map with a direct lookup of mappings, ... */unmodifiableMultiValueMap(...)/** Return the argument resolvers initialized during {@link #afterPropertiesSet()}. ... */getArgumentResolvers(...)List<? extends HandlerMethodArgumentResolver> resolversList<? extends HandlerMethodReturnValueHandler> handlersaddArgumentResolvers(...)getCustomHandlers(...)addReturnValueHandlers(...)initHandlerMethods(...)/** Return the list of argument resolvers to use. ... *//** Return the list of return value handlers to use. ... */Predicate<Class<?>> predicate/** Obtain the mapping for the given method, if any. ... */extendMapping(...)getDirectLookupMappings(...)List<T> valuesnew Function<String,List<T>>(...) { ... }new CopyOnWriteArrayList<T>(...)/** This method is invoked just before mappings are added. It allows ... *//** Return String-based destinations for the given mapping, if any, that can ... */Match<T> matchmatch.mappingmatch.handlerMethodList<Match<T>> matchesnew ArrayList<Match<T>>(...)Comparator<Match<T>> comparatorMatch<T> bestMatchMatch<T> secondBestMatchHandlerMethod m1HandlerMethod m2/** Extract the destination from the given message. ... */new Match<T>(...)/** Invoked when no matching handler is found. ... *//** Create a concrete instance of {@link AbstractExceptionHandlerMethodResolver} ... *//** Container for matched mapping and HandlerMethod. Used for best match ... */// handleNoMatch would have been invoked already/** Assist with configuration for handler method argument resolvers. ... */List<HandlerMethodArgumentResolver> customResolvers, ...;/** Configure resolvers for custom handler method arguments. ... */this.customResolversimport Scannableimport Operators/** ---------------------- ... */Function<Publisher<T>,Publisher<Void>> writeFunction, ...;Flux<T> source, ...;this.writeFunctionAttr<>.PREFETCHAttr<>.PARENTnew WriteBarrier(...)/** No emissions from the upstream source yet. */State FIRST_SIGNAL_RECEIVED, ...;/** At least one signal of any kind has been received; we're ready to ... */State EMITTING_CACHED_SIGNALS, ...;/** The write subscriber has subscribed and requested; we're going to ... */State READY_TO_WRITE, ...;/** The write subscriber has subscribed, and cached signals have been ... *//** A barrier inserted between the write source and the write subscriber ... */WriteCompletionBarrier writeCompletionBarrier, ...;/* Bridges signals to and from the completionSubscriber */Subscription subscription, ...;/* Upstream write source subscription */T item, ...;/** Cached data item before readyToWrite. */Throwable error, ...;/** Cached error signal before readyToWrite. */boolean completed, ...;/** Cached onComplete signal before readyToWrite. */long demandBeforeReadyToWrite, ...;/** Recursive demand while emitting cached signals. *//** Current state. */Subscriber<? super T> writeSubscriber, ...;/** The actual writeSubscriber from the HTTP server adapter. */this.writeCompletionBarriernew WriteCompletionBarrier(...)// Subscriber<T> methods (we're the subscriber to the write source)..State.READY_TO_WRITEonNext(...)requiredWriteSubscriber(...)Publisher<Void> resultthis.itemState.FIRST_SIGNAL_RECEIVEDonError(...)this.writeSubscriberonComplete(...)currentContext(...)// Subscription methods (we're the Subscription to the writeSubscriber)..Subscription sState.EMITTING_CACHED_SIGNALSthis.demandBeforeReadyToWriteemitCachedSignals(...)T itemreleaseCachedItem(...)Object item// Publisher<T> methods (we're the Publisher to the writeSubscriber)..onSubscribe(...)emptySubscription(...)/** We need an extra barrier between the WriteBarrier itself and the actual ... */CoreSubscriber<? super Void> completionSubscriber, ...;/* Downstream write completion subscriber */WriteBarrier writeBarrier, ...;this.completionSubscriberthis.writeBarrier/** Connect the underlying completion subscriber to this barrier in order ... */// Subscriber methods (we're the subscriber to the write function)..Subscription subscription//FIXME revisit in case of reentrant sync deadlock// Ignore: we don't produce dataHandlerMethodArgumentResolver methodArgumentResolver/** Handle the return value from the invocation of an annotated {@link Message} ... */String DATA_BUFFER_FACTORY_HEADER, ...;/** Header containing a DataBufferFactory for use in return value handling. */import CoroutinesUtilsMono<Object[]> EMPTY_ARGS, ...;Object NO_ARG_VALUE, ...;ReactiveAdapterRegistry reactiveAdapterRegistry, ...;/** Configure the argument resolvers to use to use for resolving method ... *//** Return the configured argument resolvers. *//** Return the configured parameter name discoverer. *//** Configure a reactive adapter registry. This is needed for async return values. ... */this.reactiveAdapterRegistry/** Invoke the method for the given exchange. ... */new Function<Object[],Mono<? extends Object>>(...) { ... }boolean isSuspendingFunctionClass<?> reactiveTypeinvokeSuspendingFunction(...)isAsyncVoidReturnType(...)List<Mono<Object>> argMonosnew ArrayList<Mono<Object>>(...)doOnError(...)defaultIfEmpty(...)logArgumentErrorIfNecessary(...)zip(...)new Function<Object[],Object[]>(...) { ... }// Unlikely to ever get here, but it must be handled...// Leave stack trace for later, if error is not handled.../** Help to initialize and invoke an {@link InvocableHandlerMethod}, and to then ... */InvocableHelper.classFunction<Class<?>,AbstractExceptionHandlerMethodResolver> exceptionMethodResolverFactory, ...;this.exceptionMethodResolverFactory/** Add the arguments resolvers to use for message handling and exception ... *//** Return the configured resolvers. ... *//** Add the return value handlers to use for message handling and exception ... *//** Method to populate the MessagingAdviceBean cache (e.g. to support "global" ... *//** Create {@link InvocableHandlerMethod} with the configured arg resolvers. ... */setArgumentResolvers(...)/** Find an exception handling method for the given exception. ... */InvocableHandlerMethod exceptionHandlerMethodinitMessageMappingMethod(...)new Supplier<Mono<? extends Void>>(...) { ... }new Function<Object,Mono<? extends Void>>(...) { ... }new Function<Throwable,Mono<? extends Void>>(...) { ... }InvocableHandlerMethod exHandlerinitExceptionHandlerMethod(...)/** Assist with configuration for handler method return value handlers. ... */List<HandlerMethodReturnValueHandler> customHandlers, ...;/** Configure custom return value handlers for handler methods. ... */this.customHandlers/** An extension of {@link HandlerMethodArgumentResolver} for implementations ... */resolveArgumentValue(...)/** Resolve the value for the method parameter synchronously. ... *//** Common infrastructure for invoking message handler methods with non-blocking, ... *//** Basic abstractions for working with message handler methods. *//** Support for working with messaging APIs and protocols. */import BiConsumerimport CompositeMetadataimport RoutingMetadataimport WellKnownMimeTypeimport ParameterizedTypeReference/** Default {@link MetadataExtractor} implementation that relies on ... */new HashMap<String,EntryExtractor<?>>(...)DefaultMetadataExtractor.classMap<String,EntryExtractor<?>> registrations, ...;/** Constructor with decoders for de-serializing metadata entries. *//** Constructor with list of decoders for de-serializing metadata entries. *//** Return a read-only list with the configured decoders. */registerMetadata(...)this.registrationsnew EntryExtractor<T>(...)WellKnownMimeType.MESSAGE_RSOCKET_COMPOSITE_METADATACompositeMetadata.Entrynew CompositeMetadata(...)metadata(...)extractEntry(...)EntryExtractor<?> extractorWellKnownMimeType.MESSAGE_RSOCKET_ROUTINGnew RoutingMetadata(...)MetadataExtractor.ROUTE_KEYByteBufAllocator.DEFAULTNettyDataBufferFactory bufferFactory, ...;// We only need this to wrap ByteBufsDecoder<T> decoder, ...;MimeType mimeType, ...;BiConsumer<T,Map<String,Object>> accumulator, ...;this.accumulatorNettyDataBuffer dataBufferimport RSocketimport RSocketClient/** Default implementation of {@link RSocketRequester}. ... */Map<String,Object> EMPTY_HINTS, ...;RSocketClient rsocketClient, ...;RSocket rsocket, ...;MimeType dataMimeType, ...;MimeType metadataMimeType, ...;RSocketStrategies strategies, ...;Mono<DataBuffer> emptyBufferMono, ...;this.rsocketClientthis.rsocketthis.dataMimeTypethis.metadataMimeTypethis.strategiesthis.emptyBufferMonodataBufferFactory(...)new DefaultRequestSpec(...)new MetadataEncoder(...)metadataMimeType(...)MetadataEncoder metadataEncoder, ...;Mono<Payload> payloadMono, ...;Flux<Payload> payloadFlux, ...;route(...)this.metadataEncodercreatePayload(...)reactiveAdapterRegistry(...)this.payloadMonofirstPayload(...)encodeData(...)this.payloadFluxisVoid(...)then(...)when(...)Mono<DataBuffer> dataswitchOnFirst(...)new BiFunction<Signal<? extends DataBuffer>,Flux<DataBuffer>,Publisher<? extends Payload>>(...) { ... }DataBuffer datanew Function<DataBuffer,Payload>(...) { ... }new Consumer<Payload>(...) { ... }bufferFactory(...)/** Create the 1st request payload with encoded data and metadata. ... */new Function<Tuple2<DataBuffer,DataBuffer>,Payload>(...) { ... }getT1(...)getT2(...)metadataPush(...)getPayloadMono(...)fireAndForget(...)retrieveMono(...)Mono<Payload> payloadMonorequestResponse(...)decoder(...)new Function<Payload,DataBuffer>(...) { ... }retainDataAndReleasePayload(...)retrieveFlux(...)Flux<Payload> payloadFluxrequestChannel(...)requestStream(...)thenMany(...)import RSocketConnectorimport PayloadDecoderimport LoadbalanceRSocketClientimport LoadbalanceStrategyimport LoadbalanceTargetimport ClientTransportimport TcpClientTransportimport WebsocketClientTransportimport DefaultPayloadimport StringDecoder/** Default implementation of {@link RSocketRequester.Builder}. ... */RSocketRequester.Buildernew ArrayList<Consumer<Builder>>(...)new ArrayList<RSocketConnectorConfigurer>(...)Map<String,Object> HINTS, ...;...[] EMPTY_BYTE_ARRAY, ...;Payload EMPTY_SETUP_PAYLOAD, ...;Object setupData, ...;String setupRoute, ...;...[] setupRouteVars, ...;Map<Object,MimeType> setupMetadata, ...;List<Consumer<Builder>> strategiesConfigurers, ...;RSocketStrategies.BuilderList<RSocketConnectorConfigurer> rsocketConnectorConfigurers, ...;this.setupDatathis.setupRoutethis.setupRouteVarsthis.setupMetadatanew LinkedHashMap<Object,MimeType>(...)this.strategiesConfigurersthis.rsocketConnectorConfigurerstransport(...)RSocketStrategies strategiesgetRSocketStrategies(...)MimeType metaMimeTypegetMetadataMimeType(...)MimeType dataMimeTypegetDataMimeType(...)RSocketConnector connectorinitConnector(...)RSocketClient clientnew DefaultRSocketRequester(...)LoadbalanceRSocketClient clientloadbalanceStrategy(...)connector(...)RSocketStrategies rsocketStrategiesnew Function<RSocket,RSocketRequester>(...) { ... }RSocketStrategies resultmutate(...)new Consumer<Consumer<Builder>>(...) { ... }encoders(...)decoders(...)Decoder<?> candidateisCoreCodec(...)StringDecoder.classboolean hasMetadataMono<DataBuffer> dataMonoMono<DataBuffer> metaMonoMono<DataBuffer> emptyBufferEncoder<Object> encodermetadataAndOrRoute(...)Mono<Payload> setupPayloadMonogetSetupPayload(...)new Consumer<RSocketConnectorConfigurer>(...) { ... }payloadDecoder(...)PayloadDecoder.ZERO_COPYdataMimeType(...)setupPayload(...)// First non-basic Decoder (e.g. CBOR, Protobuf)// First core decoder (e.g. String)import ByteArrayDecoderimport ByteArrayEncoderimport ByteBufferDecoderimport ByteBufferEncoderimport CharSequenceEncoderimport DataBufferDecoderimport DataBufferEncoder/** Default implementation of {@link RSocketStrategies}. ... */MetadataExtractor metadataExtractor, ...;this.metadataExtractor/** Default implementation of {@link RSocketStrategies.Builder}. */new ArrayList<Encoder<?>>(...)new ArrayList<Consumer<MetadataExtractorRegistry>>(...)List<Consumer<MetadataExtractorRegistry>> metadataExtractors, ...;routeMatcher(...)metadataExtractor(...)this.metadataExtractorsRouteMatcher matcherinitRouteMatcher(...)DataBufferFactory factoryMetadataExtractor extractornew DefaultMetadataExtractor(...)new Consumer<Consumer<MetadataExtractorRegistry>>(...) { ... }new DefaultRSocketStrategies(...)// Order of decoders may be significant for default data MimeType// selection in RSocketRequester.Builder/** Helps to collect metadata values and mime types, and encode them. ... */new ArrayList<MetadataEntry>(...)Pattern VARS_PATTERN, ...;/** For route variable replacement. */Object NO_VALUE, ...;boolean isComposite, ...;ByteBufAllocator allocator, ...;String route, ...;List<MetadataEntry> metadataEntries, ...;boolean hasAsyncValues, ...;this.isCompositethis.allocator/** Set the route to a remote handler as described in ... */this.routeexpand(...)assertMetadataEntryCount(...)StringBuffer sbrouteVars.lengththis.metadataEntries/** Add a metadata entry. If called more than once or in addition to route, ... */this.hasAsyncValuesnew MetadataEntry(...)/** Add route and/or metadata, both optional. */Entry<Object,MimeType> entryMap<>.Entry<Object,MimeType>/** Encode the collected metadata entries to a {@code DataBuffer}. ... */resolveAsyncMetadata(...)new Function<List<MetadataEntry>,DataBuffer>(...) { ... }encodeEntries(...)encodeAndAddMetadata(...)encodeRoute(...)new Consumer<MetadataEntry>(...) { ... }mimeType(...)asByteBuf(...)encodeEntry(...)asDataBuffer(...)String routingMimeTypeMetadataEntry entrycreateRoutingMetadata(...)Encoder<T> encoderList<Mono<?>> valueMonosnew ArrayList<Mono<?>>(...)new Function<Object[],List<MetadataEntry>>(...) { ... }List<MetadataEntry> result/** Holder for the metadata value and mime type. ... *//** Strategy to extract a map of value(s) from {@link Payload} metadata, which ... */String ROUTE_KEY, ...;/** The key to assign to the extracted "route" of the payload. *//** Extract a map of values from the given {@link Payload} metadata. ... *//** Stores registrations of extractors for metadata entries. ... *//** Decode metadata entries with the given {@link MimeType} to the specified ... */metadataToExtract(...)new BiConsumer<?,Map<String,Object>>(...) { ... }/** Variant of {@link #metadataToExtract(MimeType, Class, String)} that accepts ... *//** Variant of {@link #metadataToExtract(MimeType, Class, String)} that allows ... *//** Variant of {@link #metadataToExtract(MimeType, Class, BiConsumer)} that ... */import ByteBufPayloadimport DefaultDataBuffer/** Static utility methods to create {@link Payload} from {@link DataBuffer}s ... *//** Use this method to slice, retain and wrap the data portion of the ... */sliceData(...)/** Create a Payload from the given metadata and data. ... *//** Create a Payload with data only. The created payload is ... *//** Strategy to apply configuration to an {@code RSocketConnector}. For use with ... *//** Apply configuration to the given {@code RSocketConnector}. */import ConnectionSetupPayloadimport RSocketMessageHandler/** A thin wrapper around a sending {@link RSocket} with a fluent API accepting ... *//** Return the underlying {@link RSocketClient} used to make requests with. ... *//** Return the underlying {@link RSocket} if the requester was created with a ... *//** Return the data {@code MimeType} selected for the underlying RSocket ... *//** Return the metadata {@code MimeType} selected for the underlying RSocket ... *//** Begin to specify a new request with the given route to a remote handler. ... *//** Begin to specify a new request with the given metadata value, which can ... *//** Obtain a builder to create a client {@link RSocketRequester} by connecting ... */new DefaultRSocketRequesterBuilder(...)/** Wrap an existing {@link RSocket}. Typically for internal framework use, ... *//** Builder to create a requester by connecting to a server. *//** Configure the payload data MimeType to specify on the {@code SETUP} ... *//** Configure the payload metadata MimeType to specify on the {@code SETUP} ... *//** Set the data for the setup payload. The data will be encoded ... *//** Set the route for the setup payload. The rules for formatting and ... *//** Add metadata entry to the setup payload. Composite metadata must be ... *//** Provide the {@link RSocketStrategies} to use. ... *//** Customize the {@link RSocketStrategies}. ... *//** Callback to configure the {@code RSocketConnector} directly. ... *//** Configure this builder through a {@code Consumer}. This enables ... *//** Build an {@link RSocketRequester} with an ... *//** Variant of {@link #tcp(String, int)} and {@link #websocket(URI)} ... *//** Connect to the server over TCP. ... *//** Connect to the server over WebSocket. ... *//** Connect to the server with the given {@code ClientTransport}. ... *//** Spec to declare the input for an RSocket request. *//** Append additional metadata entries through a {@code Consumer}. ... *//** Perform a {@link RSocket#metadataPush(Payload) metadataPush}. ... *//** Provide payload data for the request. This can be one of: ... *//** Variant of {@link #data(Object)} that also accepts a hint for the ... *//** Variant of {@link #data(Object, Class)} for when the type hint has ... *//** Spec for providing additional composite metadata entries. ... *//** Use this to append additional metadata entries when using composite ... *//** Spec to declare the expected output for an RSocket request. ... *//** Perform a {@link RSocket#fireAndForget fireAndForget} sending the ... *//** Perform a {@link RSocket#requestResponse requestResponse} exchange. ... *//** Variant of {@link #retrieveMono(Class)} for when the dataType has ... *//** Perform an {@link RSocket#requestStream requestStream} or a ... *//** Variant of {@link #retrieveFlux(Class)} for when the dataType has ... *//** Access to strategies for use by RSocket requester and responder components. ... *//** Return the configured {@link Builder#encoder(Encoder[]) encoders}. ... *//** Find a compatible Encoder for the given element type. ... *//** Return the configured {@link Builder#decoder(Decoder[]) decoders}. ... *//** Find a compatible Decoder for the given element type. ... *//** Return the configured {@link Builder#routeMatcher(RouteMatcher)}. *//** Return the configured ... *//** Return the configured {@link Builder#metadataExtractor(MetadataExtractor)}. *//** Return a builder to create a new {@link RSocketStrategies} instance ... */new DefaultRSocketStrategiesBuilder(...)DefaultRSocketStrategies.DefaultRSocketStrategiesBuilder/** Create an {@code RSocketStrategies} instance with default settings. ... *//** Return a builder to prepare a new {@code RSocketStrategies} instance. ... *//** The builder options for creating {@code RSocketStrategies}. *//** Append to the list of encoders to use for serializing Objects to the ... *//** Apply the consumer to the list of configured encoders, immediately. *//** Append to the list of decoders to use for de-serializing Objects from ... *//** Apply the consumer to the list of configured decoders, immediately. *//** Configure a {@code RouteMatcher} for matching routes to message ... *//** Configure the registry for reactive type support. This can be used to ... *//** Configure the DataBufferFactory to use for allocating buffers when ... *//** Configure a {@link MetadataExtractor} to extract the route along with ... *//** Apply the consumer to the {@link MetadataExtractorRegistry} in order ... *//** Build the {@code RSocketStrategies} instance. *//** Annotation to map the initial {@link ConnectionSetupPayload} and subsequent ... *//** Mappings expressed by this annotation to match to the route from the ... *//** Annotations and support classes for handling RSocket streams. */import FrameTypeimport MetadataExtractorimport PayloadUtilsimport RSocketRequesterimport RSocketStrategies/** Responder {@link RSocket} that wraps the payload and metadata of incoming ... */ReactiveMessageHandler messageHandler, ...;RSocketRequester requester, ...;this.requesterthis.messageHandler/** Wrap the {@link ConnectionSetupPayload} with a {@link Message} and ... */FrameType.SETUPFrameType.REQUEST_FNFhandleAndReply(...)FrameType.REQUEST_RESPONSEFrameType.REQUEST_STREAMnew BiFunction<Signal<? extends Payload>,Flux<Payload>,Publisher<? extends Payload>>(...) { ... }Payload firstPayloadFrameType.REQUEST_CHANNELFrameType.METADATA_PUSHcreateHeaders(...)int refCountrefCount(...)doFinally(...)new Consumer<SignalType>(...) { ... }AtomicReference<Flux<Payload>> responseRefnew AtomicReference<Flux<Payload>>(...)AtomicBoolean readFlux<DataBuffer> buffersdoOnSubscribe(...)new Consumer<Subscription>(...) { ... }Message<Flux<DataBuffer>> messagenew Supplier<Publisher<Payload>>(...) { ... }MessageHeaderAccessor headersMap<String,Object> metadataValuesRoute routeparseRoute(...)setContentType(...)RSocketFrameTypeMessageCondition.FRAME_TYPE_HEADERRSocketRequesterMethodArgumentResolver.RSOCKET_REQUESTER_HEADERRSocketPayloadReturnValueHandler.RESPONSE_HEADER// frameDecoder does not apply to connectionSetupPayload// so retain here since handle expects it..// Not very useful until createHeaders does more with metadata// Subscription should have happened by now due to ChannelSendOperatorimport AbstractMessageCondition/** A condition to assist with mapping onto handler methods based on the RSocket ... */new RSocketFrameTypeMessageCondition(...)values(...).lengthFrameType typeString FRAME_TYPE_HEADER, ...;/** The name of the header that contains the RSocket frame type being processed. */RSocketFrameTypeMessageCondition CONNECT_CONDITION, ...;/** Match connection-level frames "SETUP" or "METADATA_PUSH". */RSocketFrameTypeMessageCondition REQUEST_FNF_OR_RESPONSE_CONDITION, ...;/** Match RSocket frames "REQUEST_FNF" or "REQUEST_RESPONSE". */RSocketFrameTypeMessageCondition REQUEST_RESPONSE_CONDITION, ...;/** Match RSocket frame "REQUEST_RESPONSE". */RSocketFrameTypeMessageCondition REQUEST_STREAM_CONDITION, ...;/** Match RSocket frame "REQUEST_STREAM". */RSocketFrameTypeMessageCondition REQUEST_CHANNEL_CONDITION, ...;/** Match RSocket frame "REQUEST_CHANNEL". */RSocketFrameTypeMessageCondition EMPTY_CONDITION, ...;/** Empty condition that does not match to any RSocket frames (e.g. for type-level mappings) */RSocketFrameTypeMessageCondition REQUEST_CONDITION, ...;/** Condition to match "REQUEST_FNF", "REQUEST_RESPONSE", "REQUEST_STREAM", ... */Map<String,RSocketFrameTypeMessageCondition> frameTypeConditionCache, ...;/** Per FrameType cache to return ready instances from getMatchingCondition. */Set<FrameType> frameTypes, ...;this.frameTypes/** Find the RSocket frame type in the message headers. ... */Set<FrameType> setnew LinkedHashSet<FrameType>(...)other.frameTypesFrameType actualFrameType.class/** Return a condition for matching the RSocket request interaction type with ... */import SocketAcceptorimport MessageConditionimport MessageMappingMessageHandlerimport PayloadMethodArgumentResolverimport ConnectMapping/** Extension of {@link MessageMappingMessageHandler} for handling RSocket ... */MimeType defaultDataMimeType, ...;MimeType defaultMetadataMimeType, ...;setRSocketStrategies(...)/** Configure the encoders to use for encoding handler method return values. ... */new Consumer<List<Encoder<?>>>(...) { ... }/** Return the configured {@link #setEncoders(List) encoders}. */setDecoders(...)new Consumer<List<Decoder<?>>>(...) { ... }setRouteMatcher(...)reactiveAdapterStrategy(...)/** Return the configured {@link #setMetadataExtractor MetadataExtractor}. *//** Configure this handler through an {@link RSocketStrategies} instance which ... *//** Return the {@link #setRSocketStrategies configured} {@code RSocketStrategies}. *//** Configure the default content type to use for data payloads if the ... */this.defaultDataMimeType/** Configure the default {@code MimeType} for payload data if the ... */this.defaultMetadataMimeTypeaddCustomResolver(...)new RSocketRequesterMethodArgumentResolver(...)getHandlerMethods(...)new BiConsumer<CompositeMessageCondition,HandlerMethod>(...) { ... }RSocketFrameTypeMessageCondition.CONNECT_CONDITIONgetCardinality(...)List<HandlerMethodReturnValueHandler> handlersnew RSocketPayloadReturnValueHandler(...)getReturnValueHandlerConfigurer(...)MessageMapping ann1ConnectMapping ann2ConnectMapping.classRSocketFrameTypeMessageCondition.EMPTY_CONDITIONList<MessageCondition<?>> conditionsint responseCardinalityint requestCardinalityFrameType frameTypegetFrameType(...)Set<FrameType> frameTypesnew Function<CompositeMessageCondition,List<MessageCondition<?>>>(...) { ... }new Predicate<List<MessageCondition<?>>>(...) { ... }new Function<List<MessageCondition<?>>,RSocketFrameTypeMessageCondition>(...) { ... }new Function<RSocketFrameTypeMessageCondition,Stream<? extends FrameType>>(...) { ... }getFrameTypes(...)/** Return an RSocket {@link SocketAcceptor} backed by this ... */new SocketAcceptor(...) { ... }MessagingRSocket respondercreateResponder(...)handleConnectionSetupPayload(...)RSocketRequester requesterisDataMimeTypeSupported(...)new MessagingRSocket(...)getMetadataExtractor(...)MimeType encodable/** Static factory method to create an RSocket {@link SocketAcceptor} ... */List<Object> handlerscandidateHandlers.lengthRSocketMessageHandler handlernew RSocketMessageHandler(...)setHandlers(...)responder(...)// Add argument resolver before parent initializes argument resolution// optional handling// Can't propagate error to client, so just log/** Extension of {@link AbstractEncoderMethodReturnValueHandler} that ... */String RESPONSE_HEADER, ...;/** Message header name that is expected to have an {@link java.util.concurrent.atomic.AtomicReference} ... */getResponseReference(...)/** Resolves arguments of type {@link RSocket} that can be used for making ... */String RSOCKET_REQUESTER_HEADER, ...;/** Message header name that is expected to have the {@link RSocket} to ... */RSocketRequester.classRSocket.classrsocket(...)/** Support classes for working with annotated RSocket stream handling methods. *//** Support for the RSocket protocol. *//** A wrapper class for access to attributes associated with a SiMP session ... */SimpAttributes.classforLogName(...)String SESSION_MUTEX_NAME, ...;/** Key for the mutex session attribute. */String SESSION_COMPLETED_NAME, ...;/** Key set after the session is completed. */String DESTRUCTION_CALLBACK_NAME_PREFIX, ...;/** Prefix for the name of session attributes used to store destruction callbacks. */String sessionId, ...;/** Constructor wrapping the given session attributes map. ... */this.sessionId/** Return the value for the attribute of the given name, if any. ... *//** Set the value with the given name replacing an existing value (if any). ... *//** Remove the attribute of the given name, if it exists. ... */removeDestructionCallback(...)/** Retrieve the names of all attributes. ... *//** Register a callback to execute on destruction of the specified attribute. ... */getSessionMutex(...)isSessionCompleted(...)getSessionId(...)/** Return an id for the associated session. ... *//** Expose the object to synchronize on for the underlying session. ... *//** Whether the {@link #sessionCompleted()} was already invoked. *//** Invoked when the session is completed. Executed completion callbacks. */executeDestructionCallbacks(...)/** Extract the SiMP session attributes from the given message and ... */String sessionIdMap<String,Object> sessionAttributesgetSessionAttributes(...)new SimpAttributes(...)/** Holder class to expose SiMP attributes associated with a session (e.g. WebSocket) ... */new NamedThreadLocal<SimpAttributes>(...)ThreadLocal<SimpAttributes> attributesHolder, ...;/** Reset the SimpAttributes for the current thread. *//** Bind the given SimpAttributes to the current thread. ... */resetAttributes(...)/** Extract the SiMP session attributes from the given message, wrap them in ... *//** Return the SimpAttributes currently bound to the thread. ... *//** Return the SimpAttributes currently bound to the thread or raise an ... */SimpAttributes attributesimport LogDelegateFactory/** Holds the shared logger named "org.springframework.web.SimpLogging" to use ... */SimpLogging.classLog fallbackLogger, ...;/** Create a primary logger for the given class and wrap it with a composite ... */Log primaryLoggerforLog(...)/** Wrap the given primary logger with a composite logger that delegates to ... */getCompositeLog(...)import IdTimestampMessageHeaderInitializer/** A base class for working with message headers in simple messaging protocols that ... */new IdTimestampMessageHeaderInitializer(...)setDisableIdGeneration(...)setEnableTimestamp(...)IdTimestampMessageHeaderInitializer headerInitializer, ...;String DESTINATION_HEADER, ...;// SiMP header namesString MESSAGE_TYPE_HEADER, ...;String SESSION_ID_HEADER, ...;String SESSION_ATTRIBUTES, ...;String SUBSCRIPTION_ID_HEADER, ...;String USER_HEADER, ...;String CONNECT_MESSAGE_HEADER, ...;String DISCONNECT_MESSAGE_HEADER, ...;String HEART_BEAT_HEADER, ...;String ORIGINAL_DESTINATION, ...;/** A header for internal use with "user" destinations where we need to ... */String IGNORE_ERROR, ...;/** A header that indicates to the broker that the sender will ignore errors. ... */Consumer<Principal> userCallback, ...;/** A constructor for creating new message headers. ... */initHeaders(...)/** A constructor for accessing and modifying existing message headers. This ... */getMessageType(...)/** Return the id of the current session. *//** A static alternative for access to the session attributes header. *//** Return the attributes associated with the current session. */this.userCallback/** Return the user associated with the current session. *//** Provide a callback to be invoked if and when {@link #setUser(Principal)} ... */getBaseLogMessage(...)getDetailedLogMessage(...)getShortPayloadLogMessage(...)getDetailedPayloadLogMessage(...)SimpMessageType messageTypeString subscriptionIdgetSubscriptionId(...)Principal usergetUser(...)SimpMessageType.OTHER/** Create an instance with ... */// Static factory methods and accessorsnew SimpMessageHeaderAccessor(...)SimpMessageType.MESSAGE/** Create an instance with the given ... *//** Create an instance from the payload and headers of the given Message. *//** {@link MessageCondition} for SImple Messaging Protocols. Encapsulates the following ... */CompositeMessageCondition delegate, ...;SimpMessageTypeMessageCondition.classnew SimpMessageMappingInfo(...)other.delegateCompositeMessageCondition condition(...).delegate/** A specialization of {@link MessageSendingOperations} with methods for use with ... *//** Send a message to the given user. ... *//** A generic representation of different kinds of messages found in simple messaging ... */new SimpMessageType(...)SimpMessageType CONNECT, ...;SimpMessageType CONNECT_ACK, ...;SimpMessageType MESSAGE, ...;SimpMessageType SUBSCRIBE, ...;SimpMessageType UNSUBSCRIBE, ...;SimpMessageType HEARTBEAT, ...;SimpMessageType DISCONNECT, ...;SimpMessageType DISCONNECT_ACK, ...;SimpMessageType OTHER, ...;/** {@code MessageCondition} that matches by the message type obtained via ... */new SimpMessageTypeMessageCondition(...)SimpMessageType.SUBSCRIBESimpMessageTypeMessageCondition MESSAGE, ...;SimpMessageTypeMessageCondition SUBSCRIBE, ...;SimpMessageType messageType, ...;/** A constructor accepting a message type. ... */this.messageTypeSimpMessageType actualimport MessageHeaderInitializer/** An implementation of ... */MessageChannel messageChannel, ...;String destinationPrefix, ...;MessageHeaderInitializer headerInitializer, ...;/** Create a new {@link SimpMessagingTemplate} instance. ... */this.messageChannel/** Return the configured message channel. *//** Configure the prefix to use for destinations targeting a specific user. ... */this.destinationPrefix/** Return the configured user destination prefix. *//** Specify the timeout value to use for send operations (in milliseconds). *//** Return the configured send timeout (in milliseconds). *//** Configure a {@link MessageHeaderInitializer} to apply to the headers of all ... */this.headerInitializer/** Return the configured header initializer. *//** If the headers of the given message already contain a ... */sendInternal(...)SimpMessageHeaderAccessor simpAccessorSimpMessageHeaderAccessor.classsetMessageTypeIfNotSet(...)getHeaderInitializer(...)convertAndSendToUser(...)/** Creates a new map and puts the given headers under the key ... */SimpMessageHeaderAccessor headerAccessorSimpMessageHeaderAccessor accessorsetNativeHeader(...)// Try and keep the original accessor type/** A {@link Scope} implementation exposing the attributes of a SiMP session ... */SimpAttributes simpAttributescurrentAttributes(...)/** Indicates the return value of a message-handling method should be sent as a ... *//** Alias for {@link #destinations}. ... *//** One or more destinations to send a message to. ... *//** Whether messages should be sent to all sessions associated with the user ... *//** Annotation for mapping subscription messages onto specific handler methods based ... *//** Annotations and for handling messages from SImple Messaging Protocols such as STOMP. *//** {@link MessagingException} thrown when a session is missing. ... */import SimpMessageHeaderAccessor/** Resolver for arguments of type {@link Principal}, including {@code Optional<Principal>}. ... */Principal.classimport DestinationVariableMethodArgumentResolverimport SimpMessageSendingOperationsimport SimpMessageTypeimport SimpMessagingTemplateimport SendToUserimport DestinationUserNameProvider/** A {@link HandlerMethodReturnValueHandler} for sending to destinations specified in a ... */SimpMessageSendingOperations messagingTemplate, ...;boolean annotationRequired, ...;String defaultDestinationPrefix, ...;String defaultUserDestinationPrefix, ...;PropertyPlaceholderHelper placeholderHelper, ...;this.annotationRequired/** Configure a default prefix to add to message destinations in cases where a method ... */this.defaultDestinationPrefix/** Return the configured default destination prefix. ... *//** Configure a default prefix to add to message destinations in cases where a ... */this.defaultUserDestinationPrefix/** Return the configured default user destination prefix. ... */SendToUser.classDestinationHelper destinationHelpergetDestinationHelper(...)SendToUser sendToUsergetSendToUser(...)SendTo sendToboolean broadcastbroadcast(...)String userString[] destinationsgetTargetDestinations(...)new MissingSessionUserException(...)expandTemplateVars(...)SendToUser m1SendTo m2SendToUser c1SendTo c2new DestinationHelper(...)Principal principalgetDestinationUserName(...)setSessionId(...)SimpMessagingTemplate.CONVERSION_HINT_HEADERPlaceholderResolver placeholderResolver, ...;SendTo sendTo, ...;SendToUser sendToUser, ...;getTemplateVariables(...)this.placeholderResolverthis.sendTothis.sendToUserimport SubscribableChannelimport ByteArrayMessageConverterimport CompositeMessageConverterimport StringMessageConverterimport HeaderMethodArgumentResolverimport HeadersMethodArgumentResolverimport MessageMethodArgumentResolverimport CompletableFutureReturnValueHandlerimport HandlerMethodReturnValueHandlerCompositeimport ListenableFutureReturnValueHandlerimport ReactiveReturnValueHandlerimport SimpAttributesContextHolderimport SimpLoggingimport SimpMessageMappingInfoimport SimpMessageTypeMessageConditionimport SubscribeMapping/** A handler for messages delegating to {@link MessageMapping @MessageMapping} ... */SimpAnnotationMethodMessageHandler.classSubscribableChannel clientInboundChannel, ...;SimpMessageSendingOperations clientMessagingTemplate, ...;SimpMessageSendingOperations brokerTemplate, ...;boolean slashPathSeparator, ...;/** Create an instance of SimpAnnotationMethodMessageHandler with the given ... */Collection<MessageConverter> convertersthis.clientInboundChannelthis.clientMessagingTemplatenew SimpMessagingTemplate(...)this.brokerTemplatenew StringMessageConverter(...)new ByteArrayMessageConverter(...)new CompositeMessageConverter(...)setDestinationPrefixes(...)appendSlashes(...)Collection<String> result/** Configure a {@link MessageConverter} to use to convert the payload of a message from ... *//** Configure a {@link ConversionService} to use when resolving method arguments, ... *//** Return the configured {@link ConversionService}. *//** Set the PathMatcher implementation to use for matching destinations ... */this.slashPathSeparator/** Return the PathMatcher implementation to use for matching destinations. *//** Configure a {@link MessageHeaderInitializer} to pass on to ... */unsubscribe(...)new PrincipalMethodArgumentResolver(...)getCustomArgumentResolvers(...)SendToMethodReturnValueHandler sendToHandlernew SendToMethodReturnValueHandler(...)SubscriptionMethodReturnValueHandler subscriptionHandlernew SubscriptionMethodReturnValueHandler(...)new ListenableFutureReturnValueHandler(...)new CompletableFutureReturnValueHandler(...)new ReactiveReturnValueHandler(...)setHeaderInitializer(...)getCustomReturnValueHandlers(...)HandlerMethodReturnValueHandlerComposite.defaultLoggerHandlerMethod.defaultLoggerMessageMapping messageAnnSubscribeMapping subscribeAnnSubscribeMapping.classMessageMapping typeAnnSimpMessageMappingInfo resultcreateMessageMappingCondition(...)createSubscribeMappingCondition(...)String[] resolvedDestinationsresolveEmbeddedValuesInDestinations(...)SimpMessageTypeMessageCondition.MESSAGESimpMessageTypeMessageCondition.SUBSCRIBE/** Resolve placeholder values in the given array of destinations. ... */getDestinationConditions(...)new Comparator<SimpMessageMappingInfo>(...) { ... }setAttributesFromMessage(...)// Single-purpose return value types// Annotation-based return value types// Custom return value types// Only actually register it if there are destinations specified;// otherwise @MessageMapping is just being used as a (meta-annotation) marker.// otherwise @SubscribeMapping is just being used as a (meta-annotation) marker./** {@code HandlerMethodReturnValueHandler} for replying directly to a ... */SubscriptionMethodReturnValueHandler.classMessageSendingOperations<String> messagingTemplate, ...;/** Construct a new SubscriptionMethodReturnValueHandler. ... */MessageHeaders headersToSendsetSubscriptionId(...)/** Support classes for handling messages from simple messaging protocols ... */import ChannelInterceptorimport InterceptableChannel/** Abstract base class for a {@link MessageHandler} that broker messages to ... */new BrokerAvailabilityEvent(...)new UnsentDisconnectChannelInterceptor(...)MessageChannel clientOutboundChannel, ...;SubscribableChannel brokerChannel, ...;Collection<String> destinationPrefixes, ...;Predicate<String> userDestinationPredicate, ...;boolean preservePublishOrder, ...;AtomicBoolean brokerAvailable, ...;BrokerAvailabilityEvent availableEvent, ...;BrokerAvailabilityEvent notAvailableEvent, ...;ChannelInterceptor unsentDisconnectInterceptor, ...;/** Constructor with no destination prefixes (matches all destinations). ... *//** Constructor with destination prefixes to match to destinations of messages. ... */this.clientOutboundChannelthis.brokerChannel/** Return destination prefixes prefixes to use to filter messages to forward ... *//** Configure a Predicate to identify messages with a user destination. When ... */this.userDestinationPredicate/** Whether the client must receive messages in the order of publication. ... */configureInterceptor(...)this.preservePublishOrder/** Whether to ensure messages are received in the order of publication. ... */this.eventPublisheraddInterceptor(...)this.unsentDisconnectInterceptorstartInternal(...)stopInternal(...)removeInterceptor(...)/** Check whether this message handler is currently running. ... *//** Whether the message broker is currently available and able to process messages. ... */this.brokerAvailable/** Whether a message with the given destination should be processed. This is ... */isUserDestination(...)boolean shouldPublishthis.availableEventthis.notAvailableEvent/** Get the MessageChannel to use for sending messages to clients, possibly ... */new OrderedMessageChannelDecorator(...)getClientOutboundChannel(...)/** Detect unsent DISCONNECT messages and process them anyway. */SimpMessageType.DISCONNECT/** Abstract base class for implementations of {@link SubscriptionRegistry} that ... */new LinkedMultiValueMap<K,V>(...)MultiValueMap<String,String> EMPTY_MAP, ...;addSubscriptionInternal(...)SimpMessageType.UNSUBSCRIBEremoveSubscriptionInternal(...)SimpMessageType typefindSubscriptionsInternal(...)/** Event raised when a broker's availability changes. ... */boolean brokerAvailable, ...;/** Creates a new {@code BrokerAvailabilityEvent}. ... */import ConcurrentLinkedQueue/** Implementation of {@link SubscriptionRegistry} that stores subscriptions ... */new DestinationCache(...)new SessionRegistry(...)forPropertyAccessors(...)new SimpMessageHeaderPropertyAccessor(...)/** Default maximum number of entries for the destination cache: 1024. */EvaluationContext messageEvalContext, ...;/** Static evaluation context to reuse. */String selectorHeaderName, ...;boolean selectorHeaderInUse, ...;DestinationCache destinationCache, ...;SessionRegistry sessionRegistry, ...;/** Specify the {@link PathMatcher} to use. *//** Return the configured {@link PathMatcher}. *//** Specify the maximum number of entries for the resolved destination cache. ... */ensureCacheLimit(...)/** Return the maximum number of entries for the resolved destination cache. *//** Configure the name of a header that a subscription message can have for ... */this.selectorHeaderName/** Return the name for the selector header name. ... */boolean isPatterngetSelectorExpression(...)new Subscription(...)addSubscription(...)this.sessionRegistryupdateAfterNewSubscription(...)getFirstNativeHeader(...)getSelectorHeaderName(...)this.selectorHeaderInUseSessionInfo inforemoveSubscription(...)updateAfterRemovedSubscription(...)removeSubscriptions(...)updateAfterRemovedSession(...)MultiValueMap<String,String> allMatchesgetSubscriptions(...)MultiValueMap<String,String> resultnew BiConsumer<String,List<String>>(...) { ... }evaluateExpression(...)/** Cache for destinations resolved previously via ... */new ConcurrentHashMap<String,LinkedMultiValueMap<String,String>>(...)new ConcurrentLinkedQueue<String>(...)Map<String,LinkedMultiValueMap<String,String>> destinationCache, ...;// destination -> [sessionId -> subscriptionId's]AtomicInteger cacheSize, ...;Queue<String> cacheEvictionPolicy, ...;LinkedMultiValueMap<String,String> sessionIdToSubscriptionIdsnew Function<String,LinkedMultiValueMap<String,String>>(...) { ... }LinkedMultiValueMap<String,String> matchescomputeMatchingSubscriptions(...)this.cacheEvictionPolicyforEachSubscription(...)DefaultSubscriptionRegistry.this.sessionRegistryDefaultSubscriptionRegistry.thisnew BiConsumer<String,Subscription>(...) { ... }addMatchedSubscriptionId(...)String headString cachedDestinationaddToDestination(...)computeIfPresent(...)new BiFunction<String,LinkedMultiValueMap<String,String>,LinkedMultiValueMap<String,String>>(...) { ... }new BiConsumer<String,LinkedMultiValueMap<String,String>>(...) { ... }List<String> subscriptionIdsremoveInternal(...)/** Registry for all session and their subscriptions. */new ConcurrentHashMap<String,SessionInfo>(...)ConcurrentMap<String,SessionInfo> sessions, ...;new BiConsumer<String,SessionInfo>(...) { ... }new Function<String,SessionInfo>(...) { ... }new SessionInfo(...)/** Container for the subscriptions of a session. */new ConcurrentHashMap<String,Subscription>(...)Map<String,Subscription> subscriptionMap, ...;// subscriptionId -> Subscriptionthis.subscriptionMap/** Represents a subscription. */boolean isPattern, ...;Expression selector, ...;this.isPattern// Update queue first, so that cacheSize <= queue.size(// Remove (vs poll): we expect an element/* Most likely case: single subscription per destination per session. */// Should never happen...import ExecutorChannelInterceptorimport ExecutorSubscribableChannel/** Decorator for an {@link ExecutorSubscribableChannel} that ensures messages ... */new ConcurrentLinkedQueue<Message<?>>(...)String NEXT_MESSAGE_TASK_HEADER, ...;MessageChannel channel, ...;Queue<Message<?>> messages, ...;AtomicBoolean sendInProgress, ...;this.messagestrySend(...)this.sendInProgresssendNextMessage(...)addNextMessageTaskHeader(...)removeMessage(...)Message<?> next/** Obtain the task to release the next message, if found. */OrderedMessageChannelDecorator.NEXT_MESSAGE_TASK_HEADER/** Install or remove an {@link ExecutorChannelInterceptor} that invokes a ... */ExecutorSubscribableChannel execChannelExecutorSubscribableChannel.classnew Predicate<ChannelInterceptor>(...) { ... }new CallbackInterceptor(...)new Function<ChannelInterceptor,Boolean>(...) { ... }getNextMessageTask(...)// Take sendInProgress flag only if queue is not empty/** A "simple" message broker that recognizes the message types defined in ... */...[] EMPTY_PAYLOAD, ...;Integer cacheLimit, ...;...[] heartbeatValue, ...;SubscriptionRegistry subscriptionRegistry, ...;Map<String,SessionInfo> sessions, ...;ScheduledFuture<?> heartbeatFuture, ...;/** Create a SimpleBrokerMessageHandler instance with the given message channels ... */this.subscriptionRegistrynew DefaultSubscriptionRegistry(...)/** Configure a custom SubscriptionRegistry to use for storing subscriptions. ... */initPathMatcherToUse(...)initCacheLimitToUse(...)initSelectorHeaderNameToUse(...)/** When configured, the given PathMatcher is passed down to the underlying ... */setPathMatcher(...)/** When configured, the specified cache limit is passed down to the ... */setSelectorHeaderName(...)/** Configure the {@link org.springframework.scheduling.TaskScheduler} to ... */this.heartbeatValue/** Return the configured TaskScheduler. ... *//** Configure the value for the heart-beat settings. The first number ... */heartbeat.length/** The configured value for the heart-beat settings. ... *//** Configure a {@link MessageHeaderInitializer} to apply to the headers ... *//** Return the configured header initializer. ... */publishBrokerAvailableEvent(...)initHeartbeatTaskDelay(...)this.heartbeatFuturenew HeartbeatTask(...)getHeartbeatValue(...)publishBrokerUnavailableEvent(...)updateSessionReadTime(...)checkDestinationPrefix(...)logMessage(...)sendMessageToSubscribers(...)SimpMessageType.CONNECTlong[] heartbeatIngetHeartbeat(...)long[] heartbeatOutMessageChannel outChannelgetClientOutboundChannelForSession(...)SimpMessageHeaderAccessor connectAckSimpMessageType.CONNECT_ACKMessage<byte[]> messageOutsetUser(...)SimpMessageHeaderAccessor.CONNECT_MESSAGE_HEADERSimpMessageHeaderAccessor.HEART_BEAT_HEADERhandleDisconnect(...)registerSubscription(...)unregisterSubscription(...)setLastReadTime(...)SimpMessageType.DISCONNECT_ACKMessage<byte[]> messageunregisterAllSubscriptions(...)SimpMessageHeaderAccessor.DISCONNECT_MESSAGE_HEADERMultiValueMap<String,String> subscriptionsfindSubscriptions(...)long nowMessage<?> replysetLastWriteTime(...)long HEARTBEAT_MULTIPLIER, ...;/* STOMP spec: receiver SHOULD take into account an error margin */Principal user, ...;long readInterval, ...;long writeInterval, ...;long lastReadTime, ...;long lastWriteTime, ...;this.userthis.readIntervalthis.writeIntervalthis.lastReadTimethis.lastWriteTimegetReadInterval(...)getLastReadTime(...)getWriteInterval(...)getLastWriteTime(...)SimpMessageType.HEARTBEAT/** A registry of subscription by session that allows looking up subscriptions. ... *//** Register a subscription represented by the given message. ... *//** Unregister a subscription. ... *//** Remove all subscriptions associated with the given sessionId. *//** Find all subscriptions that should receive the given message. ... *//** Provides a "simple" message broker implementation along with an abstract base ... */import AbstractBrokerMessageHandler/** Base class for message broker registration classes. ... */import SmartApplicationListenerimport DefaultContentTypeResolverimport GsonMessageConverterimport JsonbMessageConverterimport KotlinSerializationJsonMessageConverterimport SimpAnnotationMethodMessageHandlerimport SimpleBrokerMessageHandlerimport StompBrokerRelayMessageHandlerimport DefaultUserDestinationResolverimport MultiServerUserRegistryimport SimpUserRegistryimport UserDestinationMessageHandlerimport UserDestinationResolverimport UserRegistryMessageHandlerimport AbstractSubscribableChannelimport ImmutableMessageChannelInterceptor/** Provides essential configuration for handling messages with simple messaging ... */AbstractMessageBrokerConfiguration.classString MVC_VALIDATOR_NAME, ...;boolean jackson2Present, ...;boolean gsonPresent, ...;boolean jsonbPresent, ...;boolean kotlinSerializationJsonPresent, ...;ChannelRegistration clientInboundChannelRegistration, ...;ChannelRegistration clientOutboundChannelRegistration, ...;MessageBrokerRegistry brokerRegistry, ...;/** Protected constructor. */ExecutorSubscribableChannel channelnew ExecutorSubscribableChannel(...)ChannelRegistration reggetClientInboundChannelRegistration(...)hasInterceptors(...)setInterceptors(...)TaskExecutorRegistration regtaskExecutor(...)this.clientInboundChannelRegistrationChannelRegistration registrationnew ChannelRegistration(...)configureClientInboundChannel(...)interceptors(...)new ImmutableMessageChannelInterceptor(...)/** A hook for subclasses to customize the message channel for inbound messages ... */getClientOutboundChannelRegistration(...)this.clientOutboundChannelRegistrationconfigureClientOutboundChannel(...)/** A hook for subclasses to customize the message channel for messages from ... */MessageBrokerRegistry registrygetBrokerRegistry(...)getBrokerChannelRegistration(...)hasTaskExecutor(...)/** An accessor for the {@link MessageBrokerRegistry} that ensures its one-time creation ... */this.brokerRegistrynew MessageBrokerRegistry(...)configureMessageBroker(...)/** A hook for subclasses to customize message broker configuration through the ... *//** Provide access to the configured PatchMatcher for access from other ... */SimpAnnotationMethodMessageHandler handlercreateAnnotationMethodMessageHandler(...)MessageBrokerRegistry brokerRegistryList<HandlerMethodArgumentResolver> argumentResolversList<HandlerMethodReturnValueHandler> returnValueHandlersPathMatcher pathMatchergetApplicationDestinationPrefixes(...)simpValidator(...)setCustomArgumentResolvers(...)setCustomReturnValueHandlers(...)/** Protected method for plugging in a custom subclass of ... */new SimpAnnotationMethodMessageHandler(...)SimpleBrokerMessageHandler handlergetSimpleBroker(...)updateUserDestinationResolver(...)getUserDestinationPrefix(...)Collection<String> prefixessetRemoveLeadingSlash(...)setUserDestinationPredicate(...)StompBrokerRelayMessageHandler handlergetStompBrokerRelay(...)Map<String,MessageHandler> subscriptionsnew HashMap<String,MessageHandler>(...)getUserDestinationBroadcast(...)getUserRegistryBroadcast(...)setSystemSubscriptions(...)UserDestinationMessageHandler handlernew UserDestinationMessageHandler(...)setBroadcastDestination(...)MultiServerUserRegistry.classnew UserRegistryMessageHandler(...)// Expose alias for 4.1 compatibilitySimpMessagingTemplate templatesetUserDestinationPrefix(...)List<MessageConverter> convertersboolean registerDefaultsconfigureMessageConverters(...)createJacksonConverter(...)new GsonMessageConverter(...)new JsonbMessageConverter(...)new KotlinSerializationJsonMessageConverter(...)DefaultContentTypeResolver resolverMappingJackson2MessageConverter convertersetDefaultMimeType(...)setContentTypeResolver(...)/** Override this method to add custom message converters. ... */DefaultUserDestinationResolver resolvernew DefaultUserDestinationResolver(...)SimpUserRegistry userRegistrycreateLocalUserRegistry(...)getUserRegistryOrder(...)new MultiServerUserRegistry(...)/** Create the user registry that provides access to local users. ... *//** Return an {@link org.springframework.validation.Validator} instance for ... *//** Override this method to provide a custom {@link Validator}. ... */// Should never be used/** A registration class for customizing the configuration for a ... */new ArrayList<ChannelInterceptor>(...)TaskExecutorRegistration registration, ...;List<ChannelInterceptor> interceptors, ...;/** Configure the thread pool backing this message channel. *//** Configure the thread pool backing this message channel using a custom ... */this.registrationnew TaskExecutorRegistration(...)/** Configure the given interceptors for this message channel, ... *//** Configure interceptors for the message channel. ... *//** A registry for configuring message broker options. ... */SimpleBrokerRegistration simpleBrokerRegistration, ...;StompBrokerRelayRegistration brokerRelayRegistration, ...;ChannelRegistration brokerChannelRegistration, ...;...[] applicationDestinationPrefixes, ...;String userDestinationPrefix, ...;Integer userRegistryOrder, ...;/** Enable a simple message broker and configure one or more prefixes to filter ... */this.simpleBrokerRegistrationnew SimpleBrokerRegistration(...)/** Enable a STOMP broker relay and configure the destination prefixes supported by the ... */this.brokerRelayRegistrationnew StompBrokerRelayRegistration(...)/** Customize the channel used to send messages from the application to the message ... */this.brokerChannelRegistration/** Configure one or more prefixes to filter destinations targeting application ... */this.applicationDestinationPrefixes/** Configure the prefix used to identify user destinations. User destinations ... */this.userDestinationPrefix/** Set the order for the ... */this.userRegistryOrder/** Configure the PathMatcher to use to match the destinations of incoming ... *//** Configure the cache limit to apply for registrations with the broker. ... */enableSimpleBroker(...)getMessageHandler(...)setPreservePublishOrder(...)StompBrokerRelayMessageHandler relay/** Registration class for configuring a {@link SimpleBrokerMessageHandler}. ... */...[] heartbeat, ...;/** Configure the value for the heartbeat settings. The first number ... */this.heartbeatnew SimpleBrokerMessageHandler(...)getClientInboundChannel(...)setHeartbeatValue(...)import TcpOperations/** Registration class for configuring a {@link StompBrokerRelayMessageHandler}. ... */String relayHost, ...;int relayPort, ...;String clientLogin, ...;String clientPasscode, ...;String systemLogin, ...;String systemPasscode, ...;Long systemHeartbeatSendInterval, ...;Long systemHeartbeatReceiveInterval, ...;String virtualHost, ...;TcpOperations<byte[]> tcpClient, ...;String userDestinationBroadcast, ...;String userRegistryBroadcast, ...;/** Set the STOMP message broker host. */this.relayHost/** Set the STOMP message broker port. */this.relayPort/** Set the login to use when creating connections to the STOMP broker on ... */this.clientLogin/** Set the passcode to use when creating connections to the STOMP broker on ... */this.clientPasscode/** Set the login for the shared "system" connection used to send messages to ... */this.systemLogin/** Set the passcode for the shared "system" connection used to send messages to ... */this.systemPasscode/** Set the interval, in milliseconds, at which the "system" relay session will, ... */this.systemHeartbeatSendInterval/** Set the maximum interval, in milliseconds, at which the "system" relay session ... */this.systemHeartbeatReceiveInterval/** Set the value of the "host" header to use in STOMP CONNECT frames. When this ... */this.virtualHost/** Configure a TCP client for managing TCP connections to the STOMP broker. ... */this.tcpClient/** Some STOMP clients (e.g. stomp-js) always send heartbeats at a fixed rate ... *//** Configure whether the {@link StompBrokerRelayMessageHandler} should start ... *//** Set a destination to broadcast messages to user destinations that remain ... */this.userDestinationBroadcast/** Set a destination to broadcast the content of the local user registry to ... */this.userRegistryBroadcastnew StompBrokerRelayMessageHandler(...)setRelayHost(...)setRelayPort(...)setClientLogin(...)setClientPasscode(...)setSystemLogin(...)setSystemPasscode(...)setSystemHeartbeatSendInterval(...)setSystemHeartbeatReceiveInterval(...)setVirtualHost(...)setTcpClient(...)/** A registration class for customizing the properties of {@link ThreadPoolTaskExecutor}. ... */ThreadPoolTaskExecutor taskExecutor, ...;Integer corePoolSize, ...;Integer maxPoolSize, ...;/** Create a new {@code TaskExecutorRegistration} for a default ... *//** Create a new {@code TaskExecutorRegistration} for a given ... *//** Set the core pool size of the ThreadPoolExecutor. ... *//** Set the max pool size of the ThreadPoolExecutor. ... *//** Set the time limit for which threads may remain idle before being terminated. ... *//** Set the queue capacity for the ThreadPoolExecutor. ... *//** Configuration support for WebSocket messaging using higher level messaging protocols. *//** Generic support for Simple Messaging Protocols including protocols such as STOMP. *//** An extension of {@link org.springframework.messaging.simp.stomp.StompDecoder} ... */new LinkedBlockingQueue<ByteBuffer>(...)StompDecoder stompDecoder, ...;int bufferSizeLimit, ...;Queue<ByteBuffer> chunks, ...;Integer expectedContentLength, ...;/** Create a new {@code BufferingStompDecoder} wrapping the given {@code StompDecoder}. ... */this.stompDecoderthis.bufferSizeLimit/** Return the wrapped {@link StompDecoder}. *//** Return the configured buffer size limit. *//** Decodes one or more STOMP frames from the given {@code ByteBuffer} into a ... */Integer contentLengththis.expectedContentLengthByteBuffer bufferToDecodeassembleChunksAndReset(...)MultiValueMap<String,String> headersList<Message<byte[]>> messagesthis.chunkscheckBufferLimits(...)getBufferSize(...)getContentLength(...)ByteBuffer partialnew StompConversionException(...)/** Calculate the current buffer size. *//** Get the expected content length of the currently buffered, incomplete STOMP frame. *//** A {@link StompSession} that implements ... *//** Return a future that will complete when the session is ready for use. *//** Raised when the connection for a STOMP session is lost rather than closed. ... */import TcpConnection/** Default implementation of {@link ConnectionHandlingStompSession}. ... */new SettableListenableFuture<StompSession>(...)new ConcurrentHashMap<String,DefaultSubscription>(...)new ConcurrentHashMap<String,ReceiptHandler>(...)DefaultStompSession.classStompHeaderAccessor accessorcreateForHeartbeat(...)StompDecoder.HEARTBEAT_PAYLOAD/** An empty payload. */Message<byte[]> HEARTBEAT, ...;StompSessionHandler sessionHandler, ...;StompHeaders connectHeaders, ...;SettableListenableFuture<StompSession> sessionFuture, ...;long receiptTimeLimit, ...;boolean autoReceiptEnabled, ...;TcpConnection<byte[]> connection, ...;String version, ...;AtomicInteger subscriptionIndex, ...;Map<String,DefaultSubscription> subscriptions, ...;AtomicInteger receiptIndex, ...;Map<String,ReceiptHandler> receiptHandlers, ...;boolean closing, ...;/* Whether the client is willfully closing the connection *//** Create a new session. ... */this.sessionHandlerthis.connectHeaderscreateHeaderAccessor(...)StompCommand.CONNECTaddNativeHeaders(...)/** Return the configured session handler. */this.sessionFuture/** Set the {@link MessageConverter} to use to convert the payload of incoming ... *//** Configure the TaskScheduler to use for receipt tracking. *//** Return the configured TaskScheduler to use for receipt tracking. *//** Configure the time in milliseconds before a receipt expires. ... */this.receiptTimeLimit/** Return the configured time limit before a receipt expires. */this.autoReceiptEnabled/** Whether receipt headers should be automatically added. */StompHeaders headersnew StompHeaders(...)String receiptIdcheckOrAddReceipt(...)Receiptable receiptablenew ReceiptHandler(...)StompCommand.SENDgetReceipt(...)isAutoReceiptEnabled(...)DefaultStompSession.this.receiptIndexDefaultStompSession.thissetReceipt(...)updateSimpMessageHeadersFromStompHeaders(...)updateStompHeadersFromSimpMessageHeaders(...)TcpConnection<byte[]> connStompHeaderAccessor.classnew DefaultSubscription(...)StompCommand.SUBSCRIBEDefaultStompSession.this.subscriptionIndexsetMessageId(...)StompCommand commandStompCommand.ACKStompCommand.NACKStompCommand.UNSUBSCRIBEthis.closingStompCommand.DISCONNECT// TcpConnectionHandlergetAcceptVersion(...)setAcceptVersion(...)handleTransportError(...)getCommand(...)readOnlyStompHeaders(...)boolean isHeartbeatisHeartbeat(...)StompCommand.MESSAGEDefaultSubscription subscriptionthis.subscriptionsgetHandler(...)StompCommand.RECEIPTgetReceiptId(...)ReceiptHandler handlerthis.receiptHandlershandleReceiptReceived(...)StompCommand.CONNECTEDinitHeartbeatTasks(...)afterConnected(...)StompCommand.ERRORhandleException(...)Type payloadTypegetPayload(...).lengthhandleFrame(...)long[] connectlong[] connectedTcpConnection<byte[]> cononWriteInactivity(...)new WriteInactivityTask(...)onReadInactivity(...)new ReadInactivityTask(...)new ConnectionLostException(...)TcpConnection<?> connString receiptId, ...;List<Runnable> receiptCallbacks, ...;List<Runnable> receiptLostCallbacks, ...;Boolean result, ...;this.receiptIdinitReceiptHandling(...)getReceiptTimeLimit(...)getTaskScheduler(...)DefaultStompSession.this.receiptHandlershandleReceiptNotReceived(...)addTask(...)this.receiptCallbacksthis.receiptLostCallbackshandleInternal(...)StompHeaders headers, ...;StompFrameHandler handler, ...;DefaultStompSession.this.subscriptionsnew ListenableFutureCallback<Void>(...) { ... }// no-op if already setimport ReactorNettyTcpClient/** A STOMP over TCP client that uses {@link ReactorNettyTcpClient}. ... *//** Create an instance with host "127.0.0.1" and port 61613. *//** Create an instance with the given host and port. ... */initTcpClient(...)/** Create an instance with a pre-configured TCP client. ... */ReactorNettyTcpClient<byte[]> clientnew ReactorNettyTcpClient<byte[]>(...)new StompReactorNettyCodec(...)/** Connect and notify the given {@link StompSessionHandler} when connected ... *//** An overloaded version of {@link #connect(StompSessionHandler)} that ... */ConnectionHandlingStompSession sessiongetSessionFuture(...)/** Shut down the client and release resources. */import FixedIntervalReconnectStrategyimport ReactorNettyCodec/** A {@link org.springframework.messaging.MessageHandler} that handles messages by ... */new DefaultStats(...)new ConcurrentHashMap<String,RelayConnectionHandler>(...)new ListenableFutureTask<Void>(...)new VoidCallable(...)String SYSTEM_SESSION_ID, ...;/** The system session ID. *//** STOMP recommended error of margin for receiving heartbeats. */int MAX_TIME_TO_CONNECTED_FRAME, ...;/** Heartbeat starts once CONNECTED frame with heartbeat settings is received. ... */ListenableFutureTask<Void> EMPTY_TASK, ...;StompHeaderAccessor HEART_BEAT_ACCESSOR, ...;Message<byte[]> HEARTBEAT_MESSAGE, ...;long systemHeartbeatSendInterval, ...;long systemHeartbeatReceiveInterval, ...;Map<String,MessageHandler> systemSubscriptions, ...;DefaultStats stats, ...;Map<String,RelayConnectionHandler> connectionHandlers, ...;/** Create a StompBrokerRelayMessageHandler instance with the given message channels ... *//** Return the STOMP message broker host. *//** Return the STOMP message broker port. *//** Return the configured login to use for connections to the STOMP broker ... *//** Set the client passcode to use to create connections to the STOMP broker on ... *//** Return the configured passcode to use for connections to the STOMP broker on ... *//** Return the login used for the shared "system" connection to the STOMP broker. *//** Return the passcode used for the shared "system" connection to the STOMP broker. *//** Set the interval, in milliseconds, at which the "system" connection will, in the ... *//** Return the interval, in milliseconds, at which the "system" connection will ... *//** Set the maximum interval, in milliseconds, at which the "system" connection ... *//** Return the interval, in milliseconds, at which the "system" connection expects ... *//** Configure one more destinations to subscribe to on the shared "system" ... */this.systemSubscriptions/** Return the configured map with subscriptions on the "system" connection. *//** Return the configured virtual host value. *//** Get the configured TCP client (never {@code null} unless not configured ... *//** Return a String describing internal state and counters. ... */this.stats/** Return a structured object with internal state and counters. ... *//** Return the current count of TCP connection to the broker. */this.connectionHandlers/** Configure the {@link TaskScheduler} to use to reset client-to-broker ... */String virtualHostgetVirtualHost(...)SystemSessionConnectionHandler handlernew SystemSessionConnectionHandler(...)setLogin(...)setPasscode(...)setHeartbeat(...)incrementConnectCount(...)new FixedIntervalReconnectStrategy(...)new ClientSendMessageCountTask(...)StompDecoder decodernew StompDecoder(...)ReactorNettyCodec<byte[]> codecStompHeaderAccessor stompAccessorisBrokerAvailable(...)RelayConnectionHandler handlersendStompErrorFrameToClient(...)clearConnection(...)updateStompCommandAsClientMessage(...)StompCommand.STOMPnew RelayConnectionHandler(...)incrementDisconnectCount(...)forward(...)requiresDestination(...)shouldSendHeartbeatForIgnoredMessage(...)getTcpClientInfo(...)StompHeaderAccessor connectHeaders, ...;boolean isRemoteClientSession, ...;MessageChannel outboundChannel, ...;TcpConnection<byte[]> tcpConnection, ...;boolean isStompConnected, ...;long clientSendInterval, ...;AtomicInteger clientSendMessageCount, ...;long clientSendMessageTimestamp, ...;this.isRemoteClientSessionthis.outboundChannelthis.clientSendIntervalthis.clientSendMessageCountthis.clientSendMessageTimestampthis.tcpConnectionthis.isStompConnectedhandleTcpConnectionFailure(...)/** Invoked when any TCP connectivity issue is detected, i.e. failure to establish ... */Message<?> errorMessagehandleInboundMessage(...)afterStompConnected(...)/** Invoked after the STOMP CONNECTED frame is received. At this point the ... */incrementConnectedCount(...)initHeartbeats(...)/** Whether to forward a heartbeat message in lieu of a message with a non-broker ... *//** Reset the clientSendMessageCount if the current heartbeat period has expired. ... *//** Forward the given message to the STOMP broker. ... */ListenableFuture<Void> futureafterDisconnectSent(...)/** After a DISCONNECT there should be no more client frames so we can ... *//** Clean up state associated with the connection and close it. ... */StompBrokerRelayMessageHandler.this.connectionHandlersStompBrokerRelayMessageHandler.thissendSystemSubscriptions(...)getTcpConnection(...)long clientSendIntervalgetConnectHeaders(...)long clientReceiveIntervallong serverSendIntervallong serverReceiveIntervalnew SuccessCallback<Void>(...) { ... }getSystemSubscriptions(...)MessageHandler handlerafterConnectionClosed(...)SimpMessageHeaderAccessor.IGNORE_ERRORupdateClientSendMessageCount(...)/** Contract for access to session counters. ... *//** The number of connection handlers. *//** The number of CONNECT frames processed. *//** The number of CONNECTED frames processed. *//** The number of DISCONNECT frames processed. */AtomicInteger connect, ...;AtomicInteger connected, ...;AtomicInteger disconnect, ...;this.connectthis.connectedthis.disconnect// Not a broker destination but send a heartbeat to keep the connection// Prevent clearConnection() from trying to close// Shouldn't happen with connection reset beforehand/** Base class for STOMP client implementations. ... */...[] defaultHeartbeat, ...;/** Configure a scheduler to use for heartbeats and for receipt tracking. ... *//** The configured TaskScheduler. *//** Configure the default value for the "heart-beat" header of the STOMP ... */this.defaultHeartbeat/** Return the configured default heart-beat value (never {@code null}). *//** Determine whether heartbeats are enabled. ... */long[] heartbeatgetDefaultHeartbeat(...)/** Configure the number of milliseconds before a receipt is considered expired. ... *//** Return the configured receipt time limit. *//** Factory method for create and configure a new session. ... */DefaultStompSession sessionnew DefaultStompSession(...)processConnectHeaders(...)setReceiptTimeLimit(...)/** Further initialize the StompHeaders, for example setting the heart-beat ... *//** Represents a STOMP command. ... */new StompCommand(...)StompCommand STOMP, ...;// clientStompCommand CONNECT, ...;StompCommand DISCONNECT, ...;StompCommand SUBSCRIBE, ...;StompCommand UNSUBSCRIBE, ...;StompCommand SEND, ...;StompCommand ACK, ...;StompCommand NACK, ...;StompCommand BEGIN, ...;StompCommand COMMIT, ...;StompCommand ABORT, ...;StompCommand CONNECTED, ...;// serverStompCommand RECEIPT, ...;StompCommand MESSAGE, ...;StompCommand ERROR, ...;boolean destination, ...;boolean subscriptionId, ...;boolean body, ...;this.subscriptionIdthis.body/** Raised after a failure to encode or decode a STOMP message. ... *//** Decodes one or more STOMP frames contained in a {@link ByteBuffer}. ... */StompDecoder.class...[] HEARTBEAT_PAYLOAD, ...;/** Configure a {@link MessageHeaderInitializer} to apply to the headers of ... *//** Return the configured {@code MessageHeaderInitializer}, if any. *//** Decodes one or more STOMP frames from the given {@code buffer} and returns ... */new ArrayList<Message<byte[]>>(...)decodeMessage(...)skipEol(...)/** Decode a single STOMP frame from the given {@code buffer} into a {@link Message}. */Message<byte[]> decodedMessageString commandreadCommand(...)StompHeaderAccessor headerAccessorbyte[] payloadStompCommand stompCommandreadHeaders(...)readPayload(...)payload.lengthisBodyAllowed(...)MultiValueMap<String,String> mapMessageHeaderInitializer initializer/** Skip one ore more EOL characters at the start of the given ByteBuffer. ... */tryConsumeEndOfLine(...)ByteArrayOutputStream commandByteArrayOutputStream headerStreamboolean headerCompleteString headerunescape(...)String headerValueaddNativeHeader(...)InvalidMimeTypeException ex/** See STOMP Spec 1.2: ... */ByteArrayOutputStream payload/** Try to read an EOL incrementing the buffer position if successful. ... */// Explicit mark/reset access via Buffer base type for compatibility// position in the old string/** An encoder for STOMP frames. ... */new LinkedHashMap<String,byte[]>(...) { ... }Map<>.Entry<String,byte[]>StompEncoder.classByte LINE_FEED_BYTE, ...;Byte COLON_BYTE, ...;int HEADER_KEY_CACHE_LIMIT, ...;Map<String,byte[]> headerKeyAccessCache, ...;Map<String,byte[]> headerKeyUpdateCache, ...;/** Encodes the given STOMP {@code message} into a {@code byte[]}. ... *//** Encodes the given payload and headers into a {@code byte[]}. ... */new DefaultResult(...)writeHeaders(...)boolean shouldEscapeEntry<String,List<String>> entrybyte[] encodedKeyencodeHeaderKey(...)requiresContentLength(...)StompHeaderAccessor.STOMP_PASSCODE_HEADERgetPasscode(...)encodeHeaderValue(...)int contentLengthString inputToUseescape(...)this.headerKeyAccessCachethis.headerKeyUpdateCachegetStringBuilder(...)/** Accumulates byte content and returns an aggregated byte[] at the end. */int positionbyte[] src/** Contract to handle a STOMP frame. ... *//** Invoked before {@link #handleFrame(StompHeaders, Object)} to determine the ... *//** Handle a STOMP frame with the payload converted to the target type returned ... *//** A {@code MessageHeaderAccessor} to use when creating a {@code Message} from ... */AtomicLong messageIdCounter, ...;...[] DEFAULT_HEARTBEAT, ...;String STOMP_ID_HEADER, ...;// STOMP header namesString STOMP_HOST_HEADER, ...;String STOMP_ACCEPT_VERSION_HEADER, ...;String STOMP_MESSAGE_ID_HEADER, ...;String STOMP_RECEIPT_HEADER, ...;String STOMP_RECEIPT_ID_HEADER, ...;// any client frame except CONNECTString STOMP_SUBSCRIPTION_HEADER, ...;// RECEIPT frameString STOMP_VERSION_HEADER, ...;String STOMP_MESSAGE_HEADER, ...;String STOMP_ACK_HEADER, ...;String STOMP_NACK_HEADER, ...;String STOMP_LOGIN_HEADER, ...;String STOMP_PASSCODE_HEADER, ...;String STOMP_DESTINATION_HEADER, ...;String STOMP_CONTENT_TYPE_HEADER, ...;String STOMP_CONTENT_LENGTH_HEADER, ...;String STOMP_HEARTBEAT_HEADER, ...;String COMMAND_HEADER, ...;// Other header namesString CREDENTIALS_HEADER, ...;/** A constructor for creating message headers from a parsed STOMP frame. *//** A constructor for accessing and modifying existing message headers. ... */protectPasscode(...)trySetStompHeaderForSubscriptionId(...)// Redeclared for visibility within simp.stomp/** Return the STOMP command, or {@code null} if not yet set. */String rawValueString[] rawValuescommaDelimitedListToSet(...)new StompPasscode(...)/** Return the passcode header value, or {@code null} if not set. */StompPasscode credentialscredentials.passcode// Logging relatedappendSession(...)appendPayload(...)String receiptisReadableContentType(...)/** Create an instance for the given STOMP command. */new StompHeaderAccessor(...)/** Create an instance for the given STOMP command and headers. *//** Create headers for a heartbeat. While a STOMP heartbeat frame does not ... *//** Return the STOMP command from the given headers, or {@code null} if not set. */String passcode, ...;this.passcode/** Represents STOMP frame headers. ... */// Standard headers (as defined in the spec)String CONTENT_LENGTH, ...;// SEND, MESSAGE, ERRORString RECEIPT, ...;String HOST, ...;// CONNECT// any client frame other than CONNECTString ACCEPT_VERSION, ...;String LOGIN, ...;String PASSCODE, ...;String HEARTBEAT, ...;String SESSION, ...;// CONNECTEDString SERVER, ...;// SEND// SUBSCRIBE, UNSUBSCRIBEString ACK, ...;String SUBSCRIPTION, ...;// MESSAGEString RECEIPT_ID, ...;// RECEIPTMap<String,List<String>> headers, ...;/** Create a new instance to be populated with new header values. *//** Set the content-type header. ... *//** Return the content-type header value. *//** Set the content-length header. ... *//** Return the content-length header or -1 if unknown. *//** Set the receipt header. ... *//** Get the receipt header. *//** Set the host header. ... *//** Get the host header. *//** Set the accept-version header. Must be one of "1.1", "1.2", or both. ... *//** Get the accept-version header. ... *//** Set the login header. ... *//** Get the login header. *//** Set the passcode header. ... *//** Get the passcode header. *//** Set the heartbeat header. ... *//** Get the heartbeat header. *//** Whether heartbeats are enabled. Returns {@code false} if ... *//** Set the session header. ... *//** Get the session header. *//** Set the server header. ... *//** Get the server header. ... *//** Set the destination header. *//** Get the destination header. ... *//** Set the id header. ... *//** Get the id header. *//** Set the ack header to one of "auto", "client", or "client-individual". ... *//** Get the ack header. *//** Get the subscription header. *//** Set the message-id header. ... *//** Get the message-id header. *//** Set the receipt-id header. ... *//** Return the first header value for the given header name, if any. ... */List<String> headerValues/** Add the given, single header value under the given name. ... */List<String> currentValues/** Set the given, single header value under the given name. ... */LinkedHashMap<String,String> singleValueMap/** Return a {@code StompHeaders} object that can only be read, not written to. */import AbstractNioBufferReactorNettyCodec/** Simple delegation to StompDecoder and StompEncoder. ... */StompDecoder decoder, ...;StompEncoder encoder, ...;new StompEncoder(...)/** Represents a STOMP session with operations to send messages, ... *//** Return the id for the session. *//** Whether the session is connected. *//** When enabled, a receipt header is automatically added to future ... *//** Send a message to the specified destination, converting the payload to a ... *//** An overloaded version of {@link #send(String, Object)} with full ... *//** Subscribe to the given destination by sending a SUBSCRIBE frame and handle ... *//** An overloaded version of {@link #subscribe(String, StompFrameHandler)} ... *//** Send an acknowledgement whether a message was consumed or not resulting ... *//** An overloaded version of {@link #acknowledge(String, boolean)} with ... *//** Disconnect the session by sending a DISCONNECT frame. *//** Variant of {@link #disconnect()} with headers. ... *//** A handle to use to track receipts. ... *//** Return the receipt id, or {@code null} if the STOMP frame for which ... *//** Task to invoke when a receipt is received. ... *//** Task to invoke when a receipt is not received in the configured time. ... *//** A handle to use to unsubscribe or to track a receipt. *//** Return the id for the subscription. *//** Return the headers used on the SUBSCRIBE frame. ... *//** Remove the subscription by sending an UNSUBSCRIBE frame. *//** Alternative to {@link #unsubscribe()} with additional custom headers ... *//** A contract for client STOMP session lifecycle events including a callback ... *//** Invoked when the session is ready to use, i.e. after the underlying ... *//** Handle any exception arising while processing a STOMP frame such as a ... *//** Handle a low level transport error which could be an I/O error or a ... *//** Abstract adapter class for {@link StompSessionHandler} with mostly empty ... *//** This implementation returns String as the expected payload type ... *//** This implementation is empty. */import TcpConnectionHandler/** A {@link TcpConnectionHandler} for use with STOMP connections, exposing ... *//** Return the {@link SimpMessageHeaderAccessor#getSessionId() sessionId} ... *//** Return the headers that will be sent in the STOMP CONNECT frame. *//** Generic support for simple messaging protocols (like STOMP). *//** A default implementation of {@code UserDestinationResolver} that relies ... */DefaultUserDestinationResolver.classSimpUserRegistry userRegistry, ...;boolean removeLeadingSlash, ...;/** Create an instance that will access user session id information through ... */this.userRegistry/** Return the configured {@link SimpUserRegistry}. *//** The prefix used to identify user destinations. Any destinations that do not ... *//** Return the configured prefix for user destinations. *//** Use this property to indicate whether the leading slash from translated ... */this.removeLeadingSlash/** Whether to remove the leading slash from target destinations. ... *//** Provide the {@code PathMatcher} in use for working with destinations ... */ParseResult parseResultString sourceDestinationgetSourceDestination(...)Set<String> targetSetString subscribeDestinationgetSubscribeDestination(...)getSessionIds(...)String actualDestinationgetActualDestination(...)String targetDestinationgetTargetDestination(...)new UserDestinationResult(...)checkDestination(...)parseSubscriptionMessage(...)parseMessage(...)Set<String> sessionIdsisRemoveLeadingSlash(...)new ParseResult(...)int userEndString actualDestString subscribeDestgetSessionIdsByUser(...)SimpUser userSet<SimpSession> sessionsgetSessions(...)SimpSession session/** This method determines how to translate the source "user" destination to an ... *//** A temporary placeholder for a parsed source "user" destination. */String sourceDestination, ...;String actualDestination, ...;String subscribeDestination, ...;Set<String> sessionIds, ...;String user, ...;this.sourceDestinationthis.actualDestinationthis.subscribeDestinationthis.sessionIds/** A {@link java.security.Principal} can also implement this contract when ... *//** Return a globally unique user name for use with "user" destinations. *//** {@code SimpUserRegistry} that looks up users in a "local" user registry as ... */new ConcurrentHashMap<String,UserRegistrySnapshot>(...)new SessionLookup(...)SimpUserRegistry localRegistry, ...;Map<String,UserRegistrySnapshot> remoteRegistries, ...;boolean delegateApplicationEvents, ...;SessionLookup sessionLookup, ...;/* Cross-server session lookup (e.g. same user connected to multiple servers) *//** Create an instance wrapping the local user registry. */this.localRegistrythis.delegateApplicationEventsgetHostAddress(...)getLocalHost(...)UnknownHostException ex// SmartApplicationListener methods// SimpUserRegistry methodsUserRegistrySnapshot registrythis.remoteRegistriesgetUserMap(...)Set<SimpUser> resultnew HashSet<SimpUser>(...)getUsers(...)int userCountgetUserCount(...)Set<SimpSubscription> resultnew HashSet<SimpSubscription>(...)// Internal methods for UserRegistryMessageHandler to manage broadcastsnew UserRegistrySnapshot(...)UserRegistrySnapshot.classthis.sessionLookupnew Predicate<Entry<String,UserRegistrySnapshot>>(...) { ... }isExpired(...)/** Holds a copy of a SimpUserRegistry for the purpose of broadcasting to and ... */Map<String,TransferSimpUser> users, ...;long expirationTime, ...;/** Default constructor for JSON deserialization. *//** Constructor to create DTO from a local user registry. */Set<SimpUser> usersthis.usersnew TransferSimpUser(...)this.expirationTimeTransferSimpUser userafterDeserialization(...)TransferSimpSession sessionuser.sessionsSimpSubscription subscriptionsession.subscriptions/** SimpUser that can be (de)serialized and broadcast to other servers. */Set<TransferSimpSession> sessions, ...;// User sessions from "this" registry only (i.e. one server)// Cross-server session lookup (e.g. user connected to multiple servers)new HashSet<TransferSimpSession>(...)/** Constructor to create user from a local user. */new TransferSimpSession(...)findSessions(...)Map<String,SimpSession> sessionsnew HashSet<SimpSession>(...)/** SimpSession that can be (de)serialized and broadcast to other servers. */TransferSimpUser user, ...;Set<TransferSimpSubscription> subscriptions, ...;new HashSet<TransferSimpSubscription>(...)/** Constructor to create DTO from the local user session. */Set<SimpSubscription> subscriptionsnew TransferSimpSubscription(...)TransferSimpSubscription subscription/** SimpSubscription that can be (de)serialized and broadcast to other servers. */TransferSimpSession session, ...;/** Constructor to create DTO from a local user subscription. */SimpSubscription otherSubscription/** Helper class to find user sessions across all servers. */Map<String,SimpSession> mapnew HashMap<String,SimpSession>(...)TransferSimpUser transferUseraddSessions(...)// Prefer remote registries due to cross-server SessionLookup/** Represents a session of connected user. ... *//** Return the session id. *//** Return the user associated with the session. *//** Return the subscriptions for this session. *//** Represents a subscription within a user session. ... *//** Return the id associated of the subscription. *//** Return the session of the subscription. *//** Return the subscription's destination. *//** A strategy for matching subscriptions. ... *//** Match the given subscription. ... *//** Represents a connected user. ... *//** The unique user name. *//** Return the user associated with the session, if available. Typically, the ... *//** Whether the user has any sessions. *//** Look up the session for the given id. ... *//** Return the sessions for the user. ... *//** A registry of currently connected users. ... *//** Get the user for the given name. ... *//** Return a snapshot of all connected users. ... *//** Return the count of all connected users. ... *//** Find subscriptions with the given matcher. ... *//** {@code MessageHandler} with support for "user" destinations. ... */UserDestinationMessageHandler.classUserDestinationResolver destinationResolver, ...;BroadcastHandler broadcastHandler, ...;/** Create an instance with the given client and broker channels subscribing ... *//** Return the configured {@link UserDestinationResolver}. *//** Set a destination to broadcast messages to that remain unresolved because ... */this.broadcastHandlernew BroadcastHandler(...)/** Return the configured destination for unresolved messages. */getBroadcastDestination(...)/** Return the messaging template used to send resolved messages to the ... *//** Configure a custom {@link MessageHeaderInitializer} to initialize the ... */Message<?> messageToUseUserDestinationResult resultpreHandle(...)handleUnresolved(...)SimpMessageHeaderAccessor.ORIGINAL_DESTINATIONString target/** A handler that broadcasts locally unresolved messages to the broker and ... */List<String> NO_COPY_LIST, ...;String broadcastDestination, ...;this.broadcastDestinationSimpMessageHeaderAccessor newAccessortoNativeHeaderMap(...)// Our own broadcast// ensure send doesn't block// Re-broadcast/** A strategy for resolving a "user" destination by translating it to one or more ... *//** Resolve the given message with a user destination to one or more messages ... *//** Contains the result from parsing a "user" destination from a source message ... */Set<String> targetDestinations, ...;this.targetDestinations/** The "user" destination from the source message. This may look like ... *//** The target destinations that the source destination was translated to, ... *//** The user destination in the form expected when a client subscribes, e.g. ... *//** The user for this user destination. ... */import BrokerAvailabilityEvent/** {@code MessageHandler} that handles user registry broadcasts from other ... */new UserRegistryTask(...)MultiServerUserRegistry userRegistry, ...;SimpMessagingTemplate brokerTemplate, ...;TaskScheduler scheduler, ...;UserRegistryTask schedulerTask, ...;ScheduledFuture<?> scheduledFuture, ...;long registryExpirationPeriod, ...;/** Constructor. ... *//** Return the configured destination for broadcasting UserRegistry information. *//** Configure the amount of time (in milliseconds) before a remote user ... */this.registryExpirationPeriod/** Return the configured registry expiration period. */getRegistryExpirationPeriod(...)this.scheduledFuturethis.schedulerTaskaddRemoteRegistryDto(...)getLocalRegistryDto(...)purgeExpiredRegistries(...)/** Support for handling messages to "user" destinations (i.e. destinations that are ... *//** A base {@link HeaderMapper} implementation. ... */String inboundPrefix, ...;String outboundPrefix, ...;/** Specify a prefix to be appended to the message header name for any ... */this.inboundPrefix/** Specify a prefix to be appended to the protocol property name for any ... */this.outboundPrefix/** Generate the name to use to set the header defined by the specified ... *//** Return the header value, or {@code null} if it does not exist ... *//** Abstract base class for {@link MessageChannel} implementations. ... *//** A message channel uses the bean name primarily for logging purposes. *//** Return the bean name for this message channel. */ChannelInterceptorChain chainnew ChannelInterceptorChain(...)applyPreSend(...)applyPostSend(...)triggerAfterSendCompletion(...)MessageDeliveryException ex2/** Assists with the invocation of the configured channel interceptors. */int sendInterceptorIndex, ...;int receiveInterceptorIndex, ...;ChannelInterceptor interceptorMessage<?> resolvedMessagepreSend(...)this.sendInterceptorIndexpostSend(...)afterSendCompletion(...)preReceive(...)triggerAfterReceiveCompletion(...)this.receiveInterceptorIndexpostReceive(...)afterReceiveCompletion(...)/** Abstract base class for {@link SubscribableChannel} implementations. ... */new CopyOnWriteArraySet<MessageHandler>(...)Set<MessageHandler> handlers, ...;/** Interface for interceptors that are able to view and/or modify the ... *//** Invoked before the Message is actually sent to the channel. ... *//** Invoked immediately after the send invocation. The boolean ... *//** Invoked after the completion of a send regardless of any exception that ... *//** Invoked as soon as receive is called and before a Message is ... *//** Invoked immediately after a Message has been retrieved but before ... *//** Invoked after the completion of a receive regardless of any exception that ... *//** A {@link ChannelInterceptor} base class with empty method implementations ... *//** A {@link GenericMessage} with a {@link Throwable} payload. ... */Message<?> originalMessage, ...;/** Create a new message with the given payload. ... */this.originalMessage/** Create a new message with the given payload and headers. ... *//** A constructor with the {@link MessageHeaders} instance to use. ... *//** Create a new message with the given payload and original message. ... *//** Create a new message with the given payload, headers and original message. ... *//** Create a new message with the payload, {@link MessageHeaders} and original message. ... *//** Return the original message (if available) at the point in the stack ... *//** An extension of {@link ChannelInterceptor} with callbacks to intercept the ... *//** Invoked inside the {@link Runnable} submitted to the Executor just before ... *//** Invoked inside the {@link Runnable} submitted to the Executor after calling ... *//** A {@link SubscribableChannel} that sends messages to each of its subscribers. ... */new ArrayList<ExecutorChannelInterceptor>(...)List<ExecutorChannelInterceptor> executorInterceptors, ...;/** Create a new {@link ExecutorSubscribableChannel} instance ... */this.executorInterceptorsnew Consumer<ChannelInterceptor>(...) { ... }updateExecutorInterceptorsFor(...)getSubscribers(...)SendTask sendTasknew SendTask(...)/** Invoke a MessageHandler with ExecutorChannelInterceptors. */Message<?> inputMessage, ...;MessageHandler messageHandler, ...;int interceptorIndex, ...;this.inputMessageapplyBeforeHandle(...)triggerAfterMessageHandled(...)ExecutorChannelInterceptor interceptorbeforeHandle(...)ExecutorSubscribableChannel.thisthis.interceptorIndexafterMessageHandled(...)/** An implementation of {@link Message} with a generic payload. ... */GenericMessage<?> otherMsgotherMsg.payloadotherMsg.headers// Using nullSafeEquals for proper array equals comparisons// Using nullSafeHashCode for proper array hashCode handling/** Generic strategy interface for mapping {@link MessageHeaders} to and from other ... *//** Map from the given {@link MessageHeaders} to the specified target message. ... *//** Map from the given target message to abstracted {@link MessageHeaders}. ... *//** A {@link org.springframework.messaging.support.MessageHeaderInitializer MessageHeaderInitializer} ... */new IdGenerator(...) { ... }MessageHeaders.ID_VALUE_NONEIdGenerator ID_VALUE_NONE_GENERATOR, ...;boolean enableTimestamp, ...;/** Configure the IdGenerator strategy to initialize {@code MessageHeaderAccessor} ... */this.idGenerator/** Return the configured {@code IdGenerator}, if any. *//** A shortcut for calling {@link #setIdGenerator} with an id generation strategy ... *//** Whether to enable the automatic addition of the ... */this.enableTimestamp/** Return whether the timestamp header is enabled or not. */IdGenerator idGeneratorsetIdGenerator(...)isEnableTimestamp(...)/** A simpler interceptor that calls {@link MessageHeaderAccessor#setImmutable()} ... *//** A {@link org.springframework.messaging.MessageChannel MessageChannel} that ... *//** Set the list of channel interceptors clearing any existing interceptors. *//** Add a channel interceptor to the end of the list. *//** Add a channel interceptor at the specified index. *//** Return the list of configured interceptors. *//** Remove the given interceptor. *//** Remove the interceptor at the given index. *//** A builder for creating a {@link GenericMessage} ... */Message<T> providedMessage, ...;MessageHeaderAccessor headerAccessor, ...;this.providedMessagethis.headerAccessor/** Set the message headers to use by providing a {@code MessageHeaderAccessor}. ... *//** Set the value for the given header name. If the provided value is {@code null}, ... *//** Set the value for the given header name only if the header name is not already ... *//** Removes all headers provided via array of 'headerPatterns'. As the name suggests ... */removeHeaders(...)/** Remove the value for the given header name. *//** Copy the name-value pairs from the provided Map. This operation will overwrite any ... *//** Copy the name-value pairs from the provided Map. This operation will <em>not</em> ... */setReplyChannelName(...)setErrorChannelName(...)MessageHeaders headersToUsetoMessageHeaders(...)getOriginalMessage(...)new ErrorMessage(...)new GenericMessage<T>(...)/** Create a builder for a new {@link Message} instance pre-populated with all of the ... */new MessageBuilder<T>(...)/** Create a new builder for a message with the given payload. ... *//** A shortcut factory method for creating a message with the given payload ... *//** Extension of the {@link Runnable} interface with methods to obtain the ... *//** Return the Message that will be handled. *//** Return the MessageHandler that will be used to handle the message. *//** Wrapper around {@link MessageHeaders} that provides extra features such as ... */MimeTypeUtils.APPLICATION_XML/** The default charset used for headers. */...[] READABLE_MIME_TYPES, ...;MutableMessageHeaders headers, ...;boolean leaveMutable, ...;/** A constructor to create new headers. *//** A constructor accepting the headers of an existing message to copy. ... */new MutableMessageHeaders(...)/** Build a 'nested' accessor for the given message. ... *//** By default when {@link #getMessageHeaders()} is called, {@code "this"} ... */// Configuration propertiesthis.leaveMutable/** Whether the underlying headers can still be modified. ... *//** Mark the underlying message headers as modified. ... *//** Check whether the underlying message headers have been marked as modified. ... *//** A package private mechanism to enables the automatic addition of the ... *//** A package-private mechanism to configure the IdGenerator strategy to use. ... *//** Return the underlying {@code MessageHeaders} instance. ... */// Accessors for the resulting MessageHeaders/** Return a copy of the underlying header values as a {@link MessageHeaders} object. ... *//** Return a copy of the underlying header values as a plain {@link Map} object. ... *//** Retrieve the value for the header with the given name. ... */// Generic header accessors/** Set the value for the given header name. ... */verifyType(...)getRawHeaders(...)/** Set the value for the given header name only if the header name is not ... *//** Removes all headers provided via array of 'headerPatterns'. ... */List<String> headersToRemovegetMatchingHeaderNames(...)String headerToRemoveList<String> matchingHeaderNames/** Copy the name-value pairs from the provided Map. ... */MessageHeaders.IDMessageHeaders.TIMESTAMP// Specific header accessors/** Return a concise message for logging purposes. ... */// Log message stuff/** Return a more detailed message for logging purposes. ... */String payloadText/** Return the original {@code MessageHeaderAccessor} used to create the headers ... *//** A variation of {@link #getAccessor(org.springframework.messaging.Message, Class)} ... */MutableMessageHeaders mutableHeaders/** Return a mutable {@code MessageHeaderAccessor} for the given message attempting ... *//** Extension of {@link MessageHeaders} that helps to preserve the link to ... */boolean mutable, ...;this.mutableMessageHeaderAccessor.this.idGeneratorMessageHeaderAccessor.thisUUID idMessageHeaderAccessor.this.enableTimestamp// Modify header if necessary// Remove header if available// Serialize as regular MessageHeaders (without MessageHeaderAccessor reference)/** Callback interface for initializing a {@link MessageHeaderAccessor}. ... *//** Initialize the given {@code MessageHeaderAccessor}. ... *//** {@link MessageHeaderAccessor} sub-class that supports storage and access of ... */String NATIVE_HEADERS, ...;/** The header name used to store native headers. *//** Protected constructor to create a new instance. *//** Protected constructor to create an instance with the given native headers. ... *//** Protected constructor that copies headers from another message. *//** Subclasses can use this method to access the "native" headers sub-map. *//** Return a copy of the native headers sub-map, or an empty map. */setNativeHeaderValues(...)/** Whether the native header map contains the give header name. ... *//** Return all values for the specified native header, if present. ... *//** Return the first value for the specified native header, if present. ... *//** Set the specified native header value replacing existing values. ... */setModified(...)/** Variant of {@link #addNativeHeader(String, String)} for all values. ... *//** Add the specified native header value to existing values. ... *//** Add the specified native headers to existing values. ... *//** Remove the specified native header value replacing existing values. ... *//** Return the first value for the specified native header, ... */// setHeader checks for equality but we need copy of native headers// setHeader checks for equality but we need immutable wrapper// setHeader checks for equality, native headers should be equal by now/** Provides implementations of {@link org.springframework.messaging.Message} along with ... *//** A simple strategy for making reconnect attempts at a fixed interval. ... *//** Create a new {@link FixedIntervalReconnectStrategy} instance. ... *//** A contract to determine the frequency of reconnect attempts after connection failure. ... *//** Return the time to the next attempt to reconnect. ... *//** A contract for sending messages and managing a TCP connection. ... *//** Send the given message. ... *//** Register a task to invoke after a period of read inactivity. ... *//** Register a task to invoke after a period of write inactivity. ... *//** Close the connection. *//** A contract for managing lifecycle events for a TCP connection including ... *//** Invoked after a connection is successfully established. ... *//** Invoked on failure to connect. ... *//** Handle a message received from the remote host. ... *//** Handle a failure on the connection. ... *//** Invoked after the connection is closed. *//** A contract for establishing TCP connections. ... *//** Open a new connection. ... *//** Open a new connection and a strategy for reconnecting if the connection fails. ... *//** Shut down and close any open connections. ... *//** Contains abstractions and implementation classes for establishing TCP connections via ... *//** Convenient base class for {@link ReactorNettyCodec} implementations that need ... */ByteBuffer nioBufferList<Message<P>> messagesdecodeInternal(...)skipBytes(...)encodeInternal(...)/** Simple holder for a decoding {@link Function} and an encoding ... *//** Decode the input {@link ByteBuf} into one or more {@link Message Messages}. ... *//** Encode the given {@link Message} to the output {@link ByteBuf}. ... */import ChannelHandlerContextimport ChannelGroupimport DefaultChannelGroupimport ByteToMessageDecoderimport ImmediateEventExecutorimport Sinksimport FutureMonoimport NettyInboundimport NettyOutboundimport LoopResourcesimport TcpClientimport Retryimport ReconnectStrategy/** Reactor Netty based implementation of {@link TcpOperations}. ... */newParallel(...)ReactorNettyTcpClient<>.classint PUBLISH_ON_BUFFER_SIZE, ...;TcpClient tcpClient, ...;ReactorNettyCodec<P> codec, ...;ChannelGroup channelGroup, ...;LoopResources loopResources, ...;ConnectionProvider poolResources, ...;boolean stopping, ...;/** Simple constructor with the host and port to use to connect to. ... */this.channelGroupnew DefaultChannelGroup(...)ImmediateEventExecutor.INSTANCEthis.loopResourcesthis.poolResourcesthis.codecdoOnConnected(...)runOn(...)port(...)host(...)new Consumer<Connection>(...) { ... }channel(...)/** A variant of {@link #ReactorNettyTcpClient(String, int, ReactorNettyCodec)} ... *//** Constructor with an externally created {@link TcpClient} instance whose ... */Mono<Void> connectMonoextendTcpClient(...)new ReactorNettyHandler(...)afterConnectFailure(...)this.stoppinghandleShuttingDownConnectFailure(...)/** Provides an opportunity to initialize the {@link TcpClient} for the given ... */CompletableFuture<Void> connectFuturenew CompletableFuture<Void>(...)repeatWhen(...)retryWhen(...)new Consumer<? extends Connection>(...) { ... }new Function<? extends Connection,Mono<? extends Void>>(...) { ... }new Function<Flux<RetrySignal>,Publisher<?>>(...) { ... }new Function<RetrySignal,Integer>(...) { ... }totalRetriesInARow(...)new Function<Integer,Publisher<? extends ? extends Long>>(...) { ... }reconnect(...)new Function<Flux<Long>,Publisher<?>>(...) { ... }new BiFunction<Integer,Long,Integer>(...) { ... }new CompletableToListenableFutureAdapter<Void>(...)Long timegetTimeToNextAttempt(...)SettableListenableFuture<Void> futurenew SettableListenableFuture<Void>(...)disposeLater(...)stopScheduler(...)fromRunnable(...)dispose(...)isDisposed(...)TcpConnectionHandler<P> connectionHandler, ...;this.connectionHandlerSinks.Empty<Void>Empty<Void> completionSinkTcpConnection<P> connectionnew ReactorNettyTcpConnection<P>(...)withConnection(...)address(...)addHandler(...)new StompMessageDecoder<P>(...)publishOn(...)receiveObject(...)new Consumer<Message<>>(...) { ... }asMono(...)Collection<Message<P>> messages// Report first connect to the ListenableFuture// report all connect failures to the handler// post-connect issues/** Reactor Netty based implementation of {@link TcpConnection}. ... */NettyInbound inbound, ...;NettyOutbound outbound, ...;Sinks.Empty<Void> completionSink, ...;this.inboundthis.outboundthis.completionSinkalloc(...)Mono<Void> sendCompletiononReadIdle(...)onWriteIdle(...)tryEmitEmpty(...)// Ignore result: concurrent attempts to complete are ok/** Contains support for TCP messaging based on Reactor. *//** Test fixture for {@link MessageHeaders}. ... */MessageHeaders headers1MessageHeaders headers2Map<String,Object> inputMessageHeaders inputMessageHeaders outputObject addressAtomicLong idnew MyMH(...)/** A stub MessageChannel that saves all sent messages. ... */new ArrayList<MessageHandler>(...)List<Message<byte[]>> messages, ...;List<MessageHandler> handlers, ...;/** Test fixture for {@link org.springframework.messaging.converter.DefaultContentTypeResolver}. ... */DefaultContentTypeResolver resolver, ...;MimeTypeUtils.APPLICATION_JSON_VALUEGenericMessageConverter converter, ...;Message<String> contentMessage<Integer> contentConversionException.class/** Test fixture for {@link GsonMessageConverter}. ... */GsonMessageConverter converterMyBean actualgetFraction(...)HashMap<String,Object> actualMyBean payloadsetFraction(...)setArray(...)setBool(...)StandardCharsets.UTF_16BEsetSerializedPayloadClass(...)int number, ...;float fraction, ...;this.numberthis.fraction/** Test fixture for {@link JsonbMessageConverter}. ... */JsonbMessageConverter converter/** Test fixture for {@link MappingJackson2MessageConverter}. ... */getDeserializationConfig(...)getObjectMapper(...)MimeType mimetypeMimeType jsonMimetypeMimeType xmlMimetypejsonViewResponse(...)JacksonViewBean backJacksonViewBean.classgetWithView1(...)getWithView2(...)getWithoutView(...)MyJacksonView1.classJacksonViewBean beannew JacksonViewBean(...)setWithView1(...)setWithView2(...)setWithoutView(...)MyJacksonView2.classString withView1, ...;String withView2, ...;String withoutView, ...;this.withView1this.withView2this.withoutView// SPR-12724// gh-22386// SPR-16252// SPR-16486import XmlRootElementimport Jaxb2Marshallerimport static ComparisonType.XML_STANDALONEimport static DifferenceEvaluators.Defaultimport static DifferenceEvaluators.chainimport static DifferenceEvaluators.downgradeDifferencesToEqualJaxb2Marshaller marshallernew Jaxb2Marshaller(...)setClassesToBeBound(...)DifferenceEvaluator evchain(...)downgradeDifferencesToEqual(...)/** Unit tests for ... */TestMessageConverter converter, ...;setStrictContentTypeMatch(...)import Msgimport SecondMsgimport static MessageHeaders.CONTENT_TYPE/** Test suite for {@link ProtobufMessageConverter}. ... */ProtobufMessageConverter converter, ...;Msg testMsg, ...;Message<byte[]> message, ...;Message<byte[]> messageWithoutContentType, ...;Message<String> messageJson, ...;ExtensionRegistry.classnew ProtobufMessageConverter(...)this.testMsgsetBlah(...)ProtobufMessageConverter.PROTOBUFthis.messageWithoutContentTypethis.messageJsonProtobufMessageConverter converterconverter.extensionRegistryMsg.classMsg msgMsg resultProtobufMessageConverter.ProtobufJavaUtilSupport//convertTo//convertFromSimpleMessageConverter converter, ...;/** Test fixture for {@link org.springframework.messaging.converter.StringMessageConverter}. ... */StringMessageConverter converter, ...;/** Unit tests for {@link CachingDestinationResolverProxy}. ... */DestinationResolver<String> resolverDestinationResolver<>.classCachingDestinationResolverProxy<String> resolverProxynew CachingDestinationResolverProxy<String>(...)import GenericMessage/** Unit tests for {@link AbstractDestinationResolvingMessagingTemplate}. ... */TestDestinationResolvingMessagingTemplate template, ...;ExecutorSubscribableChannel myChannel, ...;TestMessagePostProcessor postProcessor, ...;TestMessageChannelDestinationResolver resolvernew TestMessageChannelDestinationResolver(...)this.myChannelregisterMessageChannel(...)new TestDestinationResolvingMessagingTemplate(...)this.postProcessornew TestMessagePostProcessor(...)new GenericMessage<Object>(...)this.template.messageChannelthis.template.messageTestDestinationResolvingMessagingTemplate templateMessage<?> expectedsetReceiveMessage(...)Message<?> responseMessageMessage<?> receiveMessage, ...;this.receiveMessagenew HashMap<String,MessageChannel>(...)Map<String,MessageChannel> channels, ...;this.channelsimport StubMessageChannel/** Unit tests for {@link GenericMessagingTemplate}. ... */GenericMessagingTemplate template, ...;StubMessageChannel messageChannel, ...;ThreadPoolTaskExecutor executor, ...;new StubMessageChannel(...)new GenericMessagingTemplate(...)new TestDestinationResolver(...)SubscribableChannel channelSubscribableChannel.classAtomicReference<Message<?>> sentnew AtomicReference<Message<?>>(...)GenericMessagingTemplate.DEFAULT_RECEIVE_TIMEOUT_HEADERGenericMessagingTemplate.DEFAULT_SEND_TIMEOUT_HEADERnew GenericMessage<String>(...)new MessageHandler(...) { ... }MessageChannel replyChannelAtomicReference<Throwable> failurecreateLateReplier(...)setSendTimeout(...)setThrowExceptionOnLateReply(...)setSendTimeoutHeader(...)setReceiveTimeoutHeader(...)MessageDeliveryException exgetMessages(...)/** Unit tests for receiving operations in {@link AbstractMessagingTemplate}. ... */TestMessagingTemplate template, ...;new TestMessagingTemplate(...)this.template.destinationMessageConversionException exgetFailedMessage(...)/** Unit tests for request and reply operations in {@link AbstractMessagingTemplate}. ... */this.template.requestMessageString responseMessage<?> requestMessage, ...;this.requestMessage/** Unit tests for {@link AbstractMessageSendingTemplate}. ... */TestMessageSendingTemplate template, ...;new TestMessageSendingTemplate(...)MessageHeaders actual/** Unit tests for {@link DestinationPatternsMessageCondition}. ... */DestinationPatternsMessageCondition c// SPR-8255DestinationPatternsMessageCondition c1DestinationPatternsMessageCondition c2DestinationPatternsMessageCondition conditionDestinationPatternsMessageCondition matchmessageTo(...)DestinationPatternsMessageCondition expectedDestinationPatternsMessageCondition match1DestinationPatternsMessageCondition match2/** Predicates for messaging annotations. ... */new DestinationVariablePredicate(...)new HeaderPredicate(...)noAttributes(...)DestinationVariable annotationBoolean required, ...;Header annotationimport ResolvableMethodimport static MessagingPredicates.destinationVar/** Test fixture for {@link DestinationVariableMethodArgumentResolver} tests. ... */on(...)DestinationVariableMethodArgumentResolver resolver, ...;ResolvableMethod resolvable, ...;arg(...)annot(...)this.resolvabledestinationVar(...)annotNotPresent(...)Map<String,Object> varsMessageHandlingException.classimport static MessagingPredicates.headerimport static MessagingPredicates.headerPlain/** Test fixture for {@link HeaderMethodArgumentResolver} tests. ... */HeaderMethodArgumentResolver resolver, ...;headerPlain(...)TestMessageHeaderAccessor headersnew TestMessageHeaderAccessor(...)setHeaders(...)header(...)// SPR-11326/** Test fixture for {@link HeadersMethodArgumentResolver} tests. ... */HeadersMethodArgumentResolver resolver, ...;annotPresent(...)TestMessageHeaderAccessor.classimport TestEncoderMethodReturnValueHandler/** Unit tests for {@link MessageMappingMessageHandler}. ... */TestEncoderMethodReturnValueHandler returnValueHandler, ...;MessageMappingMessageHandler messsageHandlerinitMesssageHandler(...)verifyOutputContent(...)GenericMessage<?> messageexpectErrorSatisfies(...)List<Decoder<?>> decodersList<Encoder<?>> encodersPropertySource<?> sourceMessageMappingMessageHandler messageHandlernew MessageMappingMessageHandler(...)this.returnValueHandlernew TestEncoderMethodReturnValueHandler(...)TestController.classaddCustomHandler(...)Flux<DataBuffer> payloadnew Function<String,DataBuffer>(...) { ... }Flux<String> resultgetContentAsStrings(...)delayElement(...)delayElements(...)new Function<Long,Mono<? extends String>>(...) { ... }new Function<Long,String>(...) { ... }/** Unit tests for {@link PayloadMethodArgumentResolver}. ... */ResolvableMethod testMethod, ...;boolean useDefaultResolutionPayloadMethodArgumentResolver resolvercreateResolver(...)this.testMethodMono<Object> monoconsumeErrorWith(...)MethodArgumentResolutionException.classnew Function<Long,DataBuffer>(...) { ... }List<String> bodyFlux<Object> fluxTestValidator validatornew GenericMessage<Publisher<DataBuffer>>(...)Mono<Object> resultClass<?> expectedTypeList<StringDecoder> decodersnew PayloadMethodArgumentResolver(...) { ... }/** Test fixture for {@link AnnotationExceptionHandlerMethodResolver} tests. ... */ExceptionController.classAnnotationExceptionHandlerMethodResolver resolver, ...;IOException exceptionAssertionError exceptionIOException ioExceptionSocketException bindExceptionSocketException exceptionnew SocketException(...)Exception exceptionIllegalStateException exceptionAmbiguousController.classNoExceptionController.classSocketException.classDefaultMessageHandlerMethodFactory instancenew Converter<SampleBean,String>(...) { ... }assertMethodInvocation(...)List<HandlerMethodArgumentResolver> customResolversnew CustomHandlerMethodArgumentResolver(...)InvocableHandlerMethod invocableHandlerMethod2// This will work as the local resolver is set// This won't work as no resolver is known for the payloadimport ErrorMessage/** Unit tests for {@link MessageMethodArgumentResolver}. ... */MessageMethodArgumentResolver resolver, ...;MessageMethodArgumentResolverTests.classErrorMessage.classMessage<Integer> messageMessage<Integer> actualMessage<Locale> messageErrorMessage messageMessage<? extends Throwable> messagenew GenericMessage<Throwable>(...)MethodArgumentTypeMismatchException.classGenericMessage<>.classMessage<String> inMessageMessage<?> outMessage/** Test fixture for {@link PayloadMethodArgumentResolver}. ... */PayloadMethodArgumentResolver resolver, ...;MethodParameter paramAnnotated, ...;MethodParameter paramAnnotatedNotRequired, ...;MethodParameter paramAnnotatedRequired, ...;MethodParameter paramWithSpelExpression, ...;MethodParameter paramNotAnnotated, ...;MethodParameter paramValidatedNotAnnotated, ...;MethodParameter paramValidated, ...;Method payloadMethodPayloadMethodArgumentResolverTests.classthis.paramAnnotatedthis.paramAnnotatedNotRequiredthis.paramAnnotatedRequiredthis.paramWithSpelExpressionthis.paramValidatedthis.paramValidatedNotAnnotatedthis.paramNotAnnotatedPayloadMethodArgumentResolver strictResolverMessage<?> emptyByteArrayMessageMessage<?> emptyStringMessageMessage<?> notEmptyMessage// required but empty// See testValidator()/** Unit tests for {@link InvocableHandlerMethod}. ... */mockCall(...)Handler.classnew Consumer<Handler>(...) { ... }addResolver(...)new StubArgumentResolver(...)getResolvedParameters(...)getStubResolver(...)new ExceptionRaisingArgumentResolver(...)argTypes(...)Error errornew Error(...)// expected -  allow HandlerMethodArgumentResolver exceptions to propagate// Based on SPR-13917 (spring-web)/** Test fixture for ... */TestMethodMessageHandler messageHandler, ...;TestController testController, ...;List<String> destinationPrefixesnew TestMethodMessageHandler(...)this.testControllernew TestController(...)registerHandler(...)new DuplicateMappingsController(...)Map<String,HandlerMethod> handlerMethodstoDestination(...)this.testController.methodthis.testController.argumentsMap<String,Object> arguments, ...;new Comparator<String>(...) { ... }DestinationPatternsMessageCondition cond1DestinationPatternsMessageCondition cond2new TestExceptionResolver(...)/** NOTE: This class is a replica of the same class in spring-web so it can ... */ResolvableMethod.classParameterNameDiscoverer nameDiscoverer, ...;String DEFAULT_VALUE_NONE, ...;// Matches ValueConstants.DEFAULT_NONE (spring-web and spring-messaging)/** Return the resolved method. *//** Return the declared return type of the resolved method. *//** Find a unique argument matching the given type. ... */new ArgResolver(...)/** Filter on method arguments with annotation. ... *//** Filter on method arguments that don't have the given annotation type(s). ... */formatMethod(...)new Function<Parameter,String>(...) { ... }formatParameter(...)formatAnnotation(...)ResolvableType[] genericTypes/** Create a {@code ResolvableMethod} builder for the given handler class. */new Builder<T>(...)/** Builder for {@code ResolvableMethod}. */new ArrayList<Predicate<Method>>(...)Class<?> objectClass, ...;List<Predicate<Method>> filters, ...;this.objectClassnew LabeledPredicate<Method>(...)/** Filter on methods with the given name. */addFilter(...)/** Filter on methods with the given parameter types. *//** Filter on annotated methods. ... *//** Filter on methods annotated with the given annotation type. ... */new Predicate<Class<? extends Annotation>>(...) { ... }/** Filter on methods not annotated with the given annotation type. */annotationTypes.length/** Filter on methods returning the given type. ... */toResolvableType(...)/** Filter on methods returning the given type with generics. ... *//** Build a {@code ResolvableMethod} from the provided filters which must ... */Set<Method> methodsformatMethods(...)new ResolvableMethod(...)new Predicate<Predicate<Method>>(...) { ... }MethodInvocationInterceptor interceptornew MethodInvocationInterceptor(...)T proxyinitProxy(...)getInvokedMethod(...)/** Resolve and return the {@code Method} equivalent to: ... */// Build & resolve shortcuts.../** Resolve and return the declared return type equivalent to: ... */returnType(...)/** Shortcut to the unique return type equivalent to: ... */formatFilters(...)new Function<Predicate<Method>,String>(...) { ... }/** Predicate with a descriptive label. */String label, ...;Predicate<T> delegate, ...;this.label/** Resolver for method arguments. */new ArrayList<Predicate<MethodParameter>>(...)List<Predicate<MethodParameter>> filters, ...;/** Filter on method arguments with annotations. ... *//** Filter on method arguments that have the given annotations. ... */new Predicate<MethodParameter>(...) { ... }/** Filter on method arguments that don't have the given annotations. ... *//** Resolve the argument also matching to the given type. ... *//** Resolve the argument. */List<MethodParameter> matchesapplyFilters(...)new ArrayList<MethodParameter>(...)new Predicate<Predicate<MethodParameter>>(...) { ... }Method invokedMethod, ...;this.invokedMethodisObjectMethod(...)intercept(...)Supplier<>.class/** Stub resolver for a fixed value type and/or value. ... */Class<?> valueType, ...;List<MethodParameter> resolvedParameters, ...;this.valueTypethis.resolvedParameters/** Sub-class for {@link AbstractExceptionHandlerMethodResolver} for testing. ... */ReflectionUtils.MethodFilter EXCEPTION_HANDLER_METHOD_FILTER, ...;Class<? extends Throwable> exceptionimport Completableimport static ResolvableMethod.on/** Unit tests for {@link AbstractEncoderMethodReturnValueHandler}. ... */TestEncoderMethodReturnValueHandler handler, ...;testVoidReturnType(...)expectErrorMessage(...)List<HandlerMethodArgumentResolver> resolvers, ...;invokeAndBlock(...)InvocableHandlerMethodTests.ExceptionRaisingArgumentResolverhandleAsync(...)new AtomicReference<String>(...)AtomicReference<String> result, ...;thenEmpty(...)import TestExceptionResolver/** Unit tests for {@link AbstractMethodMessageHandler}. ... */initMethodMessageHandler(...)DuplicateMappingsController.classTestMethodMessageHandler messageHandlerMap<String,HandlerMethod> mappingsTestMethodMessageHandler handlerTestController controllergetLastReturnValue(...)ArgumentResolverConfigurer configurernew Consumer<TestMethodMessageHandler>(...) { ... }setArgumentResolverConfigurer(...)new TestReturnValueHandler(...)TestReturnValueHandler returnValueHandler, ...;SimpleRouteMatcher routeMatcher/** Implementation of {@link AbstractEncoderMethodReturnValueHandler} for tests. ... */Flux<DataBuffer> encodedContent, ...;this.encodedContent/** Return value handler that simply stores the last return value. ... */Object lastReturnValue, ...;this.lastReturnValuenew ChannelSendOperator<>(...)saveValue(...)new Function<>(...) { ... }/** Protobuf type {@code Msg} */new AbstractParser<Msg>(...) { ... }new Msg(...)initFields(...)// Use Msg.newBuilder() to construct.GeneratedMessage.Builder<?>this.unknownFieldsgetUnknownFields(...)getDefaultInstance(...)Msg defaultInstance, ...;UnknownFieldSet unknownFields, ...;int mutable_bitField0_UnknownFieldSet.BuilderBuilder unknownFieldsboolean donereadTag(...)parseUnknownField(...)SecondMsg.BuilderBuilder subBuildertoBuilder(...)readMessage(...)SecondMsg.PARSERbuildPartial(...)InvalidProtocolBufferException esetUnfinishedMessage(...)new InvalidProtocolBufferException(...)makeExtensionsImmutable(...)Descriptors.DescriptorOuterSample.internal_static_Msg_descriptorGeneratedMessage.FieldAccessorTableensureFieldAccessorsInitialized(...)OuterSample.internal_static_Msg_fieldAccessorTableMsg.Builder.classMsg.BuilderParser<Msg> PARSER, ...;int bitField0_, ...;int FOO_FIELD_NUMBER, ...;// optional string foo = 1;Object foo_, ...;/** <code>optional string foo = 1;</code> */Object refByteString bstoStringUtf8(...)isValidUtf8(...)ByteString bcopyFromUtf8(...)int BLAH_FIELD_NUMBER, ...;// optional .SecondMsg blah = 2;SecondMsg blah_, ...;/** <code>optional .SecondMsg blah = 2;</code> */byte memoizedIsInitialized, ...;byte isInitializedgetSerializedSize(...)getFooBytes(...)writeMessage(...)int memoizedSerializedSize, ...;computeBytesSize(...)computeMessageSize(...)writeReplace(...)parseFrom(...)parseDelimitedFrom(...)GeneratedMessage.BuilderParentGeneratedMessage.Builder<Builder>// Construct using org.springframework.messaging.protobuf.Msg.newBuilder()maybeForceBuilderInitialization(...)GeneratedMessage.alwaysUseFieldBuildersgetBlahFieldBuilder(...)newUninitializedMessageException(...)int from_bitField0_int to_bitField0_result.foo_result.blah_result.bitField0_onBuilt(...)hasFoo(...)other.foo_onChanged(...)hasBlah(...)mergeBlah(...)getBlah(...)mergeUnknownFields(...)Msg parsedMessageparsePartialFrom(...)getUnfinishedMessage(...)SingleFieldBuilder<SecondMsg,Builder,SecondMsgOrBuilder> blahBuilder_, ...;getBuilder(...)getMessageOrBuilder(...)new SingleFieldBuilder<SecondMsg,Builder,SecondMsgOrBuilder>(...)getParentForChildren(...)isClean(...)// Generated by the protocol buffer compiler.  DO NOT EDIT!// source: sample.proto// @@protoc_insertion_point(builder_scope:Msg)// @@protoc_insertion_point(class_scope:Msg)String[] descriptorDataDescriptors.FileDescriptor.InternalDescriptorAssignerInternalDescriptorAssigner assignernew Descriptors.FileDescriptor.InternalDescriptorAssigner(...) { ... }Descriptors.FileDescriptorgetMessageTypes(...)new FieldAccessorTable(...)internalBuildGeneratedFileFrom(...)new FileDescriptor[]Descriptors.Descriptor internal_static_Msg_descriptor, ...;GeneratedMessage.FieldAccessorTable internal_static_Msg_fieldAccessorTable, ...;Descriptors.Descriptor internal_static_SecondMsg_descriptor, ...;GeneratedMessage.FieldAccessorTable internal_static_SecondMsg_fieldAccessorTable, ...;Descriptors.FileDescriptor descriptor, ...;// @@protoc_insertion_point(outer_class_scope)/** Protobuf type {@code SecondMsg} */new AbstractParser<SecondMsg>(...) { ... }new SecondMsg(...)// Use SecondMsg.newBuilder() to construct.SecondMsg defaultInstance, ...;readInt32(...)OuterSample.internal_static_SecondMsg_descriptorOuterSample.internal_static_SecondMsg_fieldAccessorTableSecondMsg.classSecondMsg.Builder.classParser<SecondMsg> PARSER, ...;// optional int32 blah = 1;int blah_, ...;/** <code>optional int32 blah = 1;</code> */writeInt32(...)computeInt32Size(...)// Construct using org.springframework.messaging.protobuf.SecondMsg.newBuilder()SecondMsg resultSecondMsg parsedMessage// @@protoc_insertion_point(builder_scope:SecondMsg)// @@protoc_insertion_point(class_scope:SecondMsg)import AbstractDataBufferDecoderimport static MetadataExtractor.ROUTE_KEYimport static MimeTypeUtils.TEXT_HTMLimport static MimeTypeUtils.TEXT_XML/** Unit tests for {@link DefaultMetadataExtractor}. ... */MimeType COMPOSITE_METADATA, ...;DefaultMetadataExtractor extractor, ...;new LeakAwareNettyDataBufferFactory(...)this.extractorMetadataEncoder metadataEncoderDataBuffer metadataMetadataEncoder encodernew BiConsumer<String,Map<String,Object>>(...) { ... }String[] itemsitems.lengthDefaultMetadataExtractor extractornew TestDecoder(...)/** Like StringDecoder but consumes the reader index in order to prove that ... */import SocketAddressimport DuplexConnectionimport RSocketErrorExceptionimport DefaultConnectionSetupPayload/** Unit tests for {@link DefaultRSocketRequesterBuilder}. ... */new MockConnection(...)new TestRSocketConnectorConfigurer(...)ClientTransport transport, ...;MockConnection connection, ...;TestRSocketConnectorConfigurer connectorConfigurer, ...;ClientTransport.classmaxFrameLength(...)Consumer<Builder> strategiesConfigurerConsumer<>.classrsocketStrategies(...)rsocketConnector(...)this.connectorConfigurerRSocketStrategies.Builder.classnew TestJsonDecoder(...)ConnectionSetupPayload setupPayloadgetConnectionSetupPayload(...)new RSocketConnectorConfigurer(...) { ... }setupData(...)setupRoute(...)getMetadataUtf8(...)getDataUtf8(...)Mono<String> asyncMeta1Mono<String> asyncMeta2Mono<String> datasetupMetadata(...)MimeType compositeMimeTypetestPayloadDecoder(...)PayloadDecoder.DEFAULTsource(...)rsocketClient(...)new DefaultConnectionSetupPayload(...)setupFrame(...)RSocketConnector.classPayloadDecoder decoderByteBuf setupFrame, ...;this.setupFramecreateUnresolved(...)RSocketConnector connector, ...;// RSocketStrategies and RSocketConnector configurers should have been called// Trigger connection establishmentimport RequestSpecimport RetrieveSpec/** Unit tests for {@link DefaultRSocketRequester}. ... */Duration MILLIS_10, ...;TestRSocket rsocket, ...;new TestRSocket(...)testSendMono(...)new Function<RequestSpec,RetrieveSpec>(...) { ... }data(...)timer(...)getSavedMethodName(...)getSavedPayload(...)Flux<String> stringFluxtestSendFlux(...)List<Payload> payloadsgetSavedPayloadFlux(...)new Function<Payload,String>(...) { ... }TestRSocket rsocketMono<String> responsesetPayloadMonoToReturn(...)thenReturn(...)toPayload(...)AtomicBoolean consumedMono<Payload> monodoOnSuccess(...)Flux<String> responsesetPayloadFluxToReturn(...)new Function<String,Payload>(...) { ... }Flux<Payload> fluxdoOnComplete(...)Mono<Payload> payloadMonoToReturn, ...;Flux<Payload> payloadFluxToReturn, ...;String savedMethodName, ...;Payload savedPayload, ...;Flux<Payload> savedPayloadFlux, ...;this.payloadMonoToReturnthis.payloadFluxToReturnthis.savedMethodNamethis.savedPayloadthis.savedPayloadFlux// data(Object)// data(Publisher<T>, Class<T>)/** Unit tests for {@link RSocketStrategies}. ... */hasOnlyElementsOfTypes(...)CharSequenceEncoder.classByteArrayEncoder.classByteBufferEncoder.classDataBufferEncoder.classByteArrayDecoder.classByteBufferDecoder.classDataBufferDecoder.classSimpleRouteMatcher matcherRSocketStrategies strategies1RSocketStrategies strategies2hasSameElementsAs(...)Consumer<MetadataExtractorRegistry> consumermetadataExtractorRegistry(...)/** Unlike {@link org.springframework.core.testfixture.io.buffer.LeakAwareDataBufferFactory} ... */new ArrayList<DataBufferLeakInfo>(...)List<DataBufferLeakInfo> created, ...;new Consumer<DataBufferLeakInfo>(...) { ... }getDataBuffer(...)getError(...)recordHint(...)Unpooled.EMPTY_BUFFERAssertionError errornew DataBufferLeakInfo(...)DataBuffer dataBuffer, ...;AssertionError error, ...;CompositeMetadata entriesIterator<Entry> iteratorassertRoute(...)MimeTypeUtils.TEXT_PLAIN_VALUEMimeTypeUtils.APPLICATION_OCTET_STREAM_VALUEMetadataEncoder encoder1MetadataEncoder encoder2MetadataEncoder encoder3Map<Object,MimeType> metadataDefaultDataBufferFactory bufferFactoryIterator<String> tags// Route, metadata// Metadata, route// Route and metadata/** Unit tests for {@link PayloadUtils}. ... */LeakAwareNettyDataBufferFactory nettyBufferFactory, ...;this.nettyBufferFactoryDefaultDataBuffer.classNettyDataBuffer datacreateNettyDataBuffer(...)NettyDataBuffer metadataByteBufPayload.classcreateDefaultDataBuffer(...)DefaultPayload.classDefaultDataBuffer metadataDefaultDataBuffer dataDefaultDataBuffer bufferimport ReferenceCountedimport RSocketServerimport ApplicationErrorExceptionimport RSocketInterceptorimport CloseableChannelimport TcpServerTransport/** Tests for scenarios that could lead to Payload and/or DataBuffer leaks. ... */new PayloadInterceptor(...)PayloadInterceptor payloadInterceptor, ...;CloseableChannel server, ...;RSocketMessageHandler messageHandlerRSocketMessageHandler.classSocketAcceptor responderServerConfig.classnew Consumer<InterceptorRegistry>(...) { ... }forResponder(...)tcp(...)forRequester(...)RSocketStrategies.classgetLeakAwareNettyDataBufferFactory(...)Mono<String> resultexpectErrorMatches(...)new Predicate<Throwable>(...) { ... }Flux<String> inputApplicationErrorException.classnew Function<Integer,String>(...) { ... }new ServerController(...)/** Store all intercepted incoming and outgoing payloads and then use ... */new CopyOnWriteArrayList<PayloadSavingDecorator>(...)List<PayloadSavingDecorator> rsockets, ...;this.rsocketsnew Function<PayloadSavingDecorator,Many<PayloadLeakInfo>>(...) { ... }getPayloads(...)new Consumer<Many<PayloadLeakInfo>>(...) { ... }tryEmitComplete(...)new Consumer<PayloadLeakInfo>(...) { ... }checkForLeak(...)getReferenceCount(...)new Consumer<PayloadSavingDecorator>(...) { ... }PayloadSavingDecorator decoratornew PayloadSavingDecorator(...)all(...)replay(...)many(...)RSocket delegate, ...;Sinks.Many<PayloadLeakInfo> payloads, ...;Sinks.Many<PayloadLeakInfo>this.payloadsaddPayload(...)tryEmitNext(...)new PayloadLeakInfo(...)ReferenceCounted referenceCounted, ...;this.referenceCounted// intercept responding// gh-24741// pending https://github.com/rsocket/rsocket-java/pull/777// https://github.com/rsocket/rsocket-java/issues/613/** Server-side handling of RSocket requests. ... */new CountingInterceptor(...)MimeType FOO_MIME_TYPE, ...;CountingInterceptor interceptor, ...;MimeType metadataMimeTypenew Function<Integer,Publisher<? extends Void>>(...) { ... }thenAwait(...)getBean(...).fireForgetPayloadsServerController.classgetFireAndForgetCount(...)new Function<Integer,Publisher<? extends String>>(...) { ... }new Function<String,Publisher<? extends Void>>(...) { ... }sendMetadata(...)getBean(...).metadataPushPayloadsgetMetadataPushCount(...)Sinks.Many<String> fireForgetPayloads, ...;Sinks.Many<String>Sinks.Many<String> metadataPushPayloads, ...;this.fireForgetPayloadsinterval(...)this.metadataPushPayloadsnew Consumer<MetadataExtractorRegistry>(...) { ... }AtomicInteger fireAndForgetCount, ...;AtomicInteger metadataPushCount, ...;this.fireAndForgetCountthis.metadataPushCountnew Consumer<Void>(...) { ... }// gh-26344/** Client-side handling of requests initiated from the server side. ... */RSocketConfig.classconnectAndRunTest(...)new ClientHandler(...)acceptor(...)Sinks.Empty<Void> resultSink, ...;// Must be initialized by @Test method...this.resultSinkrunTest(...)Flux<String> fluxsubscribeOn(...)boundedElastic(...)tryEmitError(...)emitNext(...)Sinks.EmitFailureHandler.FAIL_FASTSinks.EmitFailureHandler// Trigger connection establishment.// StepVerifier will block// Ignore result: signals cannot competeimport static RSocketFrameTypeMessageCondition.CONNECT_CONDITIONimport static RSocketFrameTypeMessageCondition.EMPTY_CONDITION/** Unit tests for {@link RSocketFrameTypeMessageCondition}. ... */RSocketFrameTypeMessageCondition FNF_RR_CONDITION, ...;RSocketFrameTypeMessageCondition actualMessageBuilder<byte[]> builderimport DefaultMetadataExtractor/** Unit tests for {@link RSocketMessageHandler}. ... */setEncoders(...)setMetadataExtractor(...)testMapping(...)new SimpleController(...)new TypeLevelMappingController(...)new HandleAllController(...)Map<CompositeMessageCondition,HandlerMethod> mapRSocketFrameTypeMessageCondition c1RSocketFrameTypeMessageCondition.classnew InvalidConnectMappingController(...)new AnotherInvalidConnectMappingController(...)InteractionMismatchController controllernew InteractionMismatchController(...)controller.invokeCounttestHandleNoMatch(...)Message<Object> messageint invokeCount, ...;this.invokeCount// 1. Set properties// 2. Set properties again// Simply dropped and logged (error cannot propagate to client)SimpAttributes simpAttributes, ...;this.simpAttributesConcurrentHashMap<String,Object> mapSimpAttributes attrssetSessionAttributes(...)/** Unit tests for {@link SimpAttributes}. ... */getAttributeNames(...)Runnable callbackSimpAttributes.DESTRUCTION_CALLBACK_NAME_PREFIXsessionCompleted(...)Runnable callback1Runnable callback2getAttributeNames(...).lengthSimpAttributes.SESSION_MUTEX_NAME/** Unit tests for SimpMessageHeaderAccessor. ... */UserCallback userCallbacknew UserCallback(...)Principal user1Principal user2setUserChangeCallback(...)/** Unit tests for SimpMessageTypeMessageCondition. ... */SimpMessageType subscribeTypeSimpMessageTypeMessageCondition conditionSimpMessageTypeMessageCondition actualSimpMessageHeaderAccessor.MESSAGE_TYPE_HEADERimport StompCommandimport StompHeaderAccessor/** Unit tests for {@link org.springframework.messaging.simp.SimpMessagingTemplate}. ... */SimpMessagingTemplate messagingTemplate, ...;getNativeHeader(...)// SPR-11868Message<byte[]> sentMessageMessageHeaderAccessor sentAccessor// gh-23836/** Unit tests for {@link org.springframework.messaging.simp.SimpSessionScope}. ... */SimpSessionScope scope, ...;ObjectFactory<> objectFactory, ...;new SimpSessionScope(...)Object removedgetConversationId(...)/** Unit tests for {@link PrincipalMethodArgumentResolver}. ... */PrincipalMethodArgumentResolver resolver, ...;new Principal(...) { ... }SimpMessageHeaderAccessor.USER_HEADERnew Function<Object,?>(...) { ... }/** Test fixture for {@link SendToMethodReturnValueHandlerTests}. ... */param(...)SendToTestBean.classSendToUserTestBean.classMimeType MIME_TYPE, ...;String PAYLOAD, ...;ArgumentCaptor<Message<?>> messageCaptor, ...;SendToMethodReturnValueHandler handler, ...;SendToMethodReturnValueHandler handlerAnnotationNotRequired, ...;SendToMethodReturnValueHandler jsonHandler, ...;MethodParameter noAnnotationsReturnType, ...;MethodParameter sendToReturnType, ...;MethodParameter sendToDefaultDestReturnType, ...;MethodParameter sendToWithPlaceholdersReturnType, ...;MethodParameter sendToUserReturnType, ...;MethodParameter sendToUserInSessionReturnType, ...;MethodParameter sendToSendToUserReturnType, ...;MethodParameter sendToUserDefaultDestReturnType, ...;MethodParameter sendToUserInSessionDefaultDestReturnType, ...;MethodParameter jsonViewReturnType, ...;MethodParameter defaultNoAnnotation, ...;MethodParameter defaultEmptyAnnotation, ...;MethodParameter defaultOverrideAnnotation, ...;MethodParameter userDefaultNoAnnotation, ...;MethodParameter userDefaultEmptyAnnotation, ...;MethodParameter userDefaultOverrideAnnotation, ...;SimpMessagingTemplate messagingTemplateSimpMessagingTemplate jsonMessagingTemplatethis.handlerAnnotationNotRequiredthis.jsonHandlerthis.sendToReturnTypethis.sendToUserReturnTypethis.noAnnotationsReturnTypethis.defaultNoAnnotationthis.defaultEmptyAnnotationthis.defaultOverrideAnnotationthis.userDefaultNoAnnotationthis.userDefaultEmptyAnnotationthis.userDefaultOverrideAnnotationMessage<?> inputMessagethis.messageCaptorassertResponse(...)this.sendToDefaultDestReturnTypeSendToUserWithSendToOverrideTestBean.classgetCapturedAccessor(...)SimpMessageSendingOperations messagingTemplateSimpMessageSendingOperations.classSendToMethodReturnValueHandler handlerArgumentCaptor<MessageHeaders> captorTestUser usernew TestUser(...)this.sendToSendToUserReturnTypeSimpMessageHeaderAccessor actualthis.sendToWithPlaceholdersReturnTypethis.sendToUserInSessionReturnTypenew UniqueUser(...)this.sendToUserDefaultDestReturnTypethis.sendToUserInSessionDefaultDestReturnTypeString byteshandleAndSendToJsonView(...)this.jsonViewReturnTypegetAllValues(...)JacksonViewBean payload// SPR-14238// SPR-12170import SimpAttributes/** Test fixture for {@link SimpAnnotationMethodMessageHandler}. ... */String TEST_INVALID_VALUE, ...;SubscribableChannel channel, ...;ArgumentCaptor<Object> payloadCaptor, ...;TestSimpAnnotationMethodMessageHandler messageHandler, ...;SimpMessagingTemplate brokerTemplatenew TestSimpAnnotationMethodMessageHandler(...)new StringTestValidator(...)SimpMessageHeaderAccessor headersDotPathSeparatorController controllernew DotPathSeparatorController(...)controller.methodMessage<> emptyMessageListenableFutureController controllernew ListenableFutureController(...)controller.futurethis.payloadCaptorcontroller.exceptionCaughtCompletableFutureController controllernew CompletableFutureController(...)ReactiveController controllernew ReactiveController(...)controller.sinkOneemitValue(...)emitError(...)controller.sinkManyListenableFutureTask<String> future, ...;boolean exceptionCaught, ...;this.exceptionCaughtCompletableFuture<String> future, ...;new CompletableFuture<String>(...)Sinks.One<String> sinkOne, ...;Sinks.One<String>Sinks.Many<String> sinkMany, ...;this.sinkOneone(...)this.sinkManyonBackpressureBuffer(...)unicast(...)String invalidValue, ...;this.invalidValue/** Test fixture for {@link SubscriptionMethodReturnValueHandler}. ... */SubscriptionMethodReturnValueHandler handler, ...;SubscriptionMethodReturnValueHandler jsonHandler, ...;MethodParameter subscribeEventReturnType, ...;MethodParameter subscribeEventSendToReturnType, ...;MethodParameter messageMappingReturnType, ...;MethodParameter subscribeEventJsonViewReturnType, ...;this.subscribeEventReturnTypethis.subscribeEventSendToReturnTypethis.messageMappingReturnTypethis.subscribeEventJsonViewReturnTypecreateInputMessage(...)MessageSendingOperations<> messagingTemplateMessageSendingOperations<>.classSubscriptionMethodReturnValueHandler handlergetJsonView(...)// not needed for the tests but here for completeness/** Unit tests for {@link org.springframework.messaging.simp.broker.AbstractBrokerMessageHandler}. ... */new TestBrokerMessageHandler(...)TestBrokerMessageHandler handler, ...;this.handler.availabilityEventsthis.handler.messagesTestBrokerMessageHandler theHandlerList<Message<?>> listtheHandler.messagesSimpMessageHeaderAccessor.DESTINATION_HEADERnew ArrayList<Message<?>>(...)List<Message<?>> messages, ...;List<Boolean> availabilityEvents, ...;this.availabilityEventsDefaultSubscriptionRegistry registry, ...;String sessIdString subsIdMultiValueMap<String,String> actualsubscribeMessage(...)String subIdList<String> sessIdsString destPatternString sess1String sess2String subs1String subs2String subs3String destNasdaqIbmMessage<?> destNasdaqIbmMessageunsubscribeMessage(...)String subs4String subs5Iterator<Entry<String,List<String>>> iteratorMap<>.Entry<String,List<String>>MultiValueMap<String,String> allSubscriptionsIterator<String> iteratorValues// SPR-11657// SPR-11755// First, try with selector header// Then without// SPR-11931// no exceptions// SPR-12665// no ConcurrentModificationException// SPR-13185// SPR-13555/** Unit tests for {@link OrderedMessageChannelDecorator}. ... */OrderedMessageChannelDecoratorTests.classOrderedMessageChannelDecorator sender, ...;ExecutorSubscribableChannel channel, ...;this.senderAtomicInteger indexAtomicReference<Object> resultInteger actual// Force messages to queue up periodically/** Unit tests for {@link SimpleBrokerMessageHandler}. ... */SimpleBrokerMessageHandler messageHandler, ...;SubscribableChannel clientInChannel, ...;MessageChannel clientOutChannel, ...;this.clientInChannelthis.clientOutChannelstartSession(...)createSubscriptionMessage(...)messageCaptured(...)Message<?> capturedMessage<String> connectMessageMessage<?> connectAckMessageSimpMessageHeaderAccessor connectAckHeadersScheduledFuture<> futureScheduledFuture<>.classArgumentCaptor<Runnable> taskCaptorRunnable heartbeatTaskTestPrincipal usercreateConnectMessage(...)List<Message<?>> messagesSimpMessageHeaderAccessor.SESSION_ID_HEADERimport ContentTypeResolverimport DefaultSubscriptionRegistryimport SimpSubscriptionimport SimpSubscriptionMatcherimport SimpUserimport OptionalValidatorFactoryBean/** Test fixture for {@link AbstractMessageBrokerConfiguration}. ... */loadConfig(...)SimpleBrokerConfig.classTestChannel channelTestChannel.classSet<MessageHandler> handlersSimpleBrokerMessageHandler.classBrokerRelayConfig.classStompBrokerRelayMessageHandler.classAbstractSubscribableChannel channelAbstractSubscribableChannel.classCustomThreadPoolTaskExecutor taskExecutorCustomThreadPoolTaskExecutor.classSimpAnnotationMethodMessageHandler messageHandlerStompHeaderAccessor headerschannel.messagesTestChannel outboundChannelSimpleBrokerMessageHandler brokeroutboundChannel.messagesThreadPoolTaskExecutor taskExecutorisPreservePublishOrder(...)getExecutor(...)AbstractMessageBrokerConfiguration confignew BaseTestMessageBrokerConfig(...)CompositeMessageConverter compositeConverterbrokerMessageConverter(...)ContentTypeResolver resolverStringMessageConverter.classByteArrayMessageConverter.classMappingJackson2MessageConverter.classgetDefaultMimeType(...)DefaultConfig.classMessageConverter testConverternew BaseTestMessageBrokerConfig(...) { ... }Iterator<MessageConverter> iteratorList<HandlerMethodReturnValueHandler> customHandlersOptionalValidatorFactoryBean.classStaticApplicationContext appCxtTestValidator.classDefaultSubscriptionRegistry registrygetSubscriptionRegistry(...)SimpUserRegistry registrySimpUserRegistry.classUserDestinationMessageHandler handler1UserRegistryMessageHandler handler2UserRegistryMessageHandler.classObject nullBeanDotSeparatorWithSlashBrokerConventionConfig.classtestDotSeparator(...)DotSeparatorWithDotBrokerConventionConfig.classMessageChannel inChannelTestChannel outChannelMessageChannel brokerChannelMessage<?> outputMessageoutChannel.messagesObject expecteds1Object expectedsTestUserRegistry registrynew TestUserRegistry(...)new TestChannel(...)setUserRegistryBroadcast(...)setUserDestinationBroadcast(...)enableStompBrokerRelay(...)new ChannelInterceptor(...) { ... }ChannelInterceptor interceptor, ...;queueCapacity(...)keepAliveSeconds(...)maxPoolSize(...)corePoolSize(...)new CustomThreadPoolTaskExecutor(...)HandlerMethodArgumentResolver.classHandlerMethodReturnValueHandler.classconfigureBrokerChannel(...)setUserRegistryOrder(...)// RabbitMQ-style broker convention for STOMP destinations// Artemis-style broker convention for STOMP destinations// subscribe// message// No way to verify queue capacity// SPR-16275// 1. Subscribe to user destination// 2. Send message to user via inboundChannel// 3. Send message via broker channel// synchronousSubscribableChannel inChannelString[] prefixesStompBrokerRelayRegistration registrationgetClientLogin(...)getClientPasscode(...)getSystemLogin(...)getSystemPasscode(...)getSystemHeartbeatReceiveInterval(...)getSystemHeartbeatSendInterval(...)/** Unit tests for {@link BufferingStompDecoder}. ... */StompDecoder STOMP_DECODER, ...;BufferingStompDecoder stompDecodernew BufferingStompDecoder(...)String chunktoByteBuffer(...)getExpectedContentLength(...)String chunk1String chunk2String chunk3StompConversionException.class// SPR-13416import Receiptableimport static ArgumentMatchers.notNullimport static ArgumentMatchers.same/** Unit tests for {@link DefaultStompSession}. ... */DefaultStompSession session, ...;ArgumentCaptor<Message<byte[]>> messageCaptor, ...;StompHeaders stompHeaderssetVersion(...)ArgumentCaptor<Long> writeIntervalArgumentCaptor<Long> readIntervalStompHeaderAccessor connectedArgumentCaptor<Runnable> writeTaskCaptorArgumentCaptor<Runnable> readTaskCaptorRunnable writeTaskRunnable readTasksame(...)StompFrameHandler frameHandlerStompFrameHandler.classConnectionLostException.classsetAutoReceipt(...)MessageDeliveryException.classStompHeaders subscribeHeadersStompHeaders unsubscribeHeadersgetSubscriptionHeaders(...)AtomicReference<Boolean> receivednew AtomicReference<Boolean>(...)addReceiptTask(...)setReceiptId(...)TaskScheduler taskSchedulerAtomicReference<Boolean> notReceivedRunnable scheduledTaskaddReceiptLostTask(...)// SPR-16844// StompEncoder isn't involved// gh-23358// SPR-15131import BrokerService/** Integration tests for {@link ReactorNettyTcpStompClient}. ... */ReactorNettyTcpStompClientTests.classBrokerService activeMQBroker, ...;ReactorNettyTcpStompClient client, ...;ThreadPoolTaskScheduler taskSchedulerthis.activeMQBrokernew BrokerService(...)addConnector(...)setStartAsync(...)setPersistent(...)setUseJmx(...)setLimit(...)getMemoryUsage(...)getSystemUsage(...)getTempUsage(...)this.clientnew ReactorNettyTcpStompClient(...)ConsumingHandler consumingHandler1new ConsumingHandler(...)ListenableFuture<StompSession> consumerFuture1ConsumingHandler consumingHandler2ListenableFuture<StompSession> consumerFuture2ProducingHandler producingHandlernew ProducingHandler(...)ListenableFuture<StompSession> producerFutureawaitForSubscriptions(...)addToSend(...)awaitForMessageCount(...)getReceived(...)List<String> topics, ...;CountDownLatch subscriptionLatch, ...;List<String> received, ...;this.topicsthis.subscriptionLatchString topicnew StompFrameHandler(...) { ... }List<Object> payloads, ...;/** Integration tests for {@link StompBrokerRelayMessageHandler} running against ActiveMQ. ... */StompBrokerRelayMessageHandlerIntegrationTests.classStompBrokerRelayMessageHandler relay, ...;ExecutorSubscribableChannel responseChannel, ...;TestMessageHandler responseHandler, ...;TestEventPublisher eventPublisher, ...;this.responseChannelthis.responseHandlernew TestMessageHandler(...)new TestEventPublisher(...)startActiveMqBroker(...)createAndStartRelay(...)StubMessageChannel channelthis.relayexpectBrokerAvailabilityEvent(...)getStatsInfo(...)stopActiveMqBrokerAndAwait(...)MessageExchange conn1MessageExchange conn2MessageExchange subscribesubscribeWithReceipt(...)MessageExchange sendandExpectMessage(...)conn1.messageconn2.messageexpectMessages(...)subscribe.messagesend.messageMessageExchange connectMessageExchange errorconnect.messageMessageExchange disconnectdisconnectWithReceipt(...)disconnect.messagenew LinkedBlockingQueue<BrokerAvailabilityEvent>(...)BlockingQueue<BrokerAvailabilityEvent> eventQueue, ...;this.eventQueueBrokerAvailabilityEvent eventnew LinkedBlockingQueue<Message<?>>(...)BlockingQueue<Message<?>> queue, ...;List<MessageExchange> expectedMessagesnew ArrayList<MessageExchange>(...)MessageExchange matchfindMatch(...)MessageExchange exchangematchMessage(...)/** Holds a message as well as expected and actual messages matched against expectations. */...[] expected, ...;...[] actual, ...;new Message<?>[]this.expected.lengthnew ArrayList<MessageMatcher>(...)StompHeaderAccessor headers, ...;List<MessageMatcher> expected, ...;andExpectError(...)new MessageExchangeBuilder(...)MessageExchangeBuilder builderbuilder.expectednew StompConnectedFrameMessageMatcher(...)// TODO Determine why connectWithError() is unused.new StompReceiptFrameMessageMatcher(...)new StompMessageFrameMessageMatcher(...)new StompFrameMessageMatcher(...)new MessageExchange(...)new MessageMatcher[]StompCommand command, ...;this.commandmatchInternal(...)String subscriptionId, ...;getPayloadAsText(...)/** Unit tests for {@link StompBrokerRelayMessageHandler}. ... */StompBrokerRelayMessageHandler brokerRelay, ...;StubMessageChannel outboundChannel, ...;StubTcpOperations tcpClient, ...;ArgumentCaptor<Runnable> messageCountTaskCaptor, ...;this.brokerRelaynew StompBrokerRelayMessageHandler(...) { ... }new StubTcpOperations(...)StompHeaderAccessor headers1getSentHeaders(...)StompHeaderAccessor headers2connectMessage(...)StompBrokerRelayMessageHandler.SYSTEM_SESSION_IDgetLogin(...)Message<byte[]> connectMessagethis.messageCountTaskCaptor// SPR-12820getConnectionCount(...)MessageHandler.classArgumentCaptor<Message<>> captorListenableFutureTask<Void> futureTasknew Callable<Void>(...) { ... }new StubTcpConnection(...)StubTcpConnection connection, ...;TcpConnectionHandler<byte[]> connectionHandler, ...;getVoidFuture(...)// Force this, since we'll never actually connect// gh-22822// Run the messageCountTask to clear the message count/** Unit tests for {@link StompClientSupport}. ... */new StompClientSupport(...) { ... }StompClientSupport stompClient, ...;trySetDefaultHeartbeat(...)setDefaultHeartbeat(...)this.stompClientisDefaultHeartbeatEnabled(...)StompHeaders connectHeadersnew EnumMap<StompCommand,SimpMessageType>(...)StompCommand.classCollection<StompCommand> destinationRequired, ...;Collection<StompCommand> subscriptionIdRequired, ...;Collection<StompCommand> contentLengthRequired, ...;Collection<StompCommand> bodyAllowed, ...;Map<StompCommand,SimpMessageType> messageTypes, ...;SimpMessageType simprequiresSubscriptionId(...)/** Test fixture for {@link StompDecoder}. ... */Message<byte[]> frameString acceptString bodyText// SPR-11528String frame1String frame2String valuelessKeyassertIncompleteDecode(...)String frame// gh-23713// SPR-13111/** Test fixture for {@link StompEncoder}. ... */String frameStringsetContentLength(...)/** Unit tests for {@link StompHeaderAccessor}. ... */MultiValueMap<String,String> extHeadersStompHeaderAccessor.STOMP_ID_HEADERStompHeaderAccessor.STOMP_DESTINATION_HEADERStompHeaderAccessor.DESTINATION_HEADERStompHeaderAccessor.STOMP_SUBSCRIPTION_HEADERStompHeaderAccessor.STOMP_CONTENT_TYPE_HEADERMap<String,List<String>> outputStompHeaderAccessor.STOMP_LOGIN_HEADERMap<String,List<String>> actualupdateStompCommandAsServerMessage(...)StompHeaderAccessor.STOMP_MESSAGE_ID_HEADERSimpMessageHeaderAccessor simpHeaderAccessorStompHeaderAccessor stompHeaderAccessorString accountIdIdTimestampMessageHeaderInitializer headerInitializerDefaultUserDestinationResolver resolver, ...;SimpUserRegistry registry, ...;TestSimpUser simpUsernew TestSimpUser(...)new TestSimpSession(...)UserDestinationResult actualTestSimpUser otherSimpUserTestPrincipal otherUser// SPR-14044// SPR-11325// SPR-12444// no destination// not a user destination// subscribe + not a user destination// no match on message type/** Unit tests for {@link MultiServerUserRegistry}. ... */MultiServerUserRegistry registry, ...;SimpUser.classTestSimpUser testUserTestSimpSession testSessionSimpUserRegistry testRegistryObject registryDtoaddSubscriptions(...)new TestSimpSubscription(...)hasSessions(...)TestSimpUser user1TestSimpUser user2TestSimpUser user3TestSimpSession session1TestSimpSession session2TestSimpSession session3Set<SimpSubscription> matchesnew SimpSubscriptionMatcher(...) { ... }Iterator<SimpSubscription> iteratorTestSimpUser localUserTestSimpSession localSessionTestSimpUser remoteUserTestSimpSession remoteSessionSimpUserRegistry remoteRegistryObject remoteRegistryDto// Prepare broadcast message from remote server// Add remote registry// SPR-13800// Add user to local registryTestSimpUser user, ...;Set<SimpSubscription> subscriptions, ...;TestSimpSubscription subscriptionTestSimpSession session, ...;Map<String,SimpSession> sessions, ...;TestSimpSession sessionimport static SimpMessageHeaderAccessor.ORIGINAL_DESTINATION/** Unit tests for {@link UserDestinationMessageHandler}. */String SESSION_ID, ...;UserDestinationMessageHandler handler, ...;Message<> messagecreateWith(...)// Should ignore our own broadcast to brokerChannel// No re-broadcast/** User tests for {@link UserRegistryMessageHandler}. ... */UserRegistryMessageHandler handler, ...;MultiServerUserRegistry multiServerRegistry, ...;MessageChannel brokerChannel, ...;this.multiServerRegistrygetUserRegistryTask(...)TestSimpUser simpUser1TestSimpUser simpUser2HashSet<SimpUser> simpUsersMultiServerUserRegistry remoteRegistrySimpUserRegistry remoteUserRegistryArgumentCaptor<? extends Runnable> captor/** Test fixture for the use of {@link ChannelInterceptor}s. ... */TestMessageHandler messageHandler, ...;PreSendInterceptor interceptornew PreSendInterceptor(...)setMessageToReturn(...)wasAfterCompletionInvoked(...)PreSendInterceptor interceptor1NullReturningPreSendInterceptor interceptor2new NullReturningPreSendInterceptor(...)AtomicBoolean preSendInvokedAtomicBoolean completionInvokedassertInput(...)ChannelInterceptorTests.this.channelChannelInterceptorTests.thisAbstractMessageChannel testChannelnew AbstractMessageChannel(...) { ... }PreSendInterceptor interceptor2setExceptionToRaise(...)boolean afterCompletionInvoked, ...;this.afterCompletionInvokedMessage<?> messageToReturn, ...;RuntimeException exceptionToRaise, ...;this.messageToReturnthis.exceptionToRaiseErrorMessage emString emString/** Unit tests for {@link ExecutorSubscribableChannel}. ... */MessageHandler handler, ...;ArgumentCaptor<Runnable> runnableCaptor, ...;Message<Object> message, ...;BeforeHandleInterceptor interceptornew BeforeHandleInterceptor(...)wasAfterHandledInvoked(...)TaskExecutor executorExecutorSubscribableChannel testChannelthis.runnableCaptorMessageHandler secondHandlerMessageDeliveryException actualExceptionBeforeHandleInterceptor interceptor1NullReturningBeforeHandleInterceptor interceptor2new NullReturningBeforeHandleInterceptor(...)IllegalStateException expectedMessageDeliveryException actualboolean afterHandledInvoked, ...;this.afterHandledInvoked// TODO Determine why setExceptionToRaise() is unused.Message<String> message1Message<String> message2Long timestampMessage<String> sourceErrorMessage errorMessage1Message<Throwable> errorMessage2ErrorMessage actualMessage<Integer> message1Message<Integer> message2Message<?> originalDate currentMap<String,Object> originalHeadersMap<String,Object> newHeadersMessageBuilder<?> messageBuilderMessage<?> message1Message<?> message2Message<?> message3// gh-23417/** Test fixture for {@link MessageHeaderAccessor}. ... */GenericMessage<String> messageMap<String,Object> map3MessageHeaderAccessor expectedTestMessageHeaderAccessor expectedMessageHeaderAccessor actualMessageHeaderAccessor mutableAccessorMessage<?> output/** Test fixture for {@link NativeMessageHeaderAccessor}. ... */MultiValueMap<String,String> inputNativeHeadersNativeMessageHeaderAccessor headerAccessornew NativeMessageHeaderAccessor(...)Map<String,Object> actualMap<String,Object> inputHeadersMap<String,List<String>> actualNativeHeadersMap<String,Object> nativeHeadersMultiValueMap<String,String> nativeHeadersNativeMessageHeaderAccessor headersNativeMessageHeaderAccessor sourceAccessorNativeMessageHeaderAccessor targetAccessorMessage<?> targetMessageHeaderAccessor targetAccessorNativeMessageHeaderAccessor accessor// gh-25821// gh-26155// Does not fail with ConcurrentModificationExceptionimport OptimisticLockingFailureException/** Exception thrown on an optimistic locking violation for a mapped object. ... */Object persistentClass, ...;Object identifier, ...;/** Create a general ObjectOptimisticLockingFailureException with the given message, ... */this.persistentClass/** Create a new ObjectOptimisticLockingFailureException for the given object, ... *//** Return the persistent class of the object for which the locking failed. ... *//** Return the name of the persistent class of the object for which the locking failed. ... *//** Return the identifier of the object for which the locking failed. *//** Exception thrown if a mapped object could not be retrieved via its identifier. ... *//** Create a general ObjectRetrievalFailureException with the given message, ... *//** Create a new ObjectRetrievalFailureException for the given object, ... *//** Return the persistent class of the object that was not found. ... *//** Return the name of the persistent class of the object that was not found. ... *//** Return the identifier of the object that was not found. */import Synchronizationimport TransactionSynchronizationRegistryimport JtaPlatformimport UserTransactionAdapter/** Implementation of Hibernate 5's JtaPlatform SPI, exposing passed-in {@link TransactionManager}, ... */TransactionSynchronizationRegistry transactionSynchronizationRegistry, ...;/** Create a new ConfigurableJtaPlatform instance with the given ... */this.userTransactionnew UserTransactionAdapter(...)this.transactionSynchronizationRegistrySystemException exnew TransactionException(...)registerInterposedSynchronization(...)import HibernateException/** Callback interface for Hibernate code. To be used with {@link HibernateTemplate}'s ... *//** Gets called by {@code HibernateTemplate.execute} with an active ... */import PersistenceExceptionimport JDBCExceptionimport EntityManagerFactoryUtils/** {@link PersistenceExceptionTranslator} capable of translating {@link HibernateException} ... */SQLExceptionTranslator jdbcExceptionTranslator, ...;/** Set the JDBC exception translator for Hibernate exception translation purposes. ... */this.jdbcExceptionTranslatorconvertHibernateAccessException(...)convertJpaAccessExceptionIfPossible(...)/** Convert the given HibernateException to an appropriate exception from the ... */JDBCException jdbcExgetSQL(...)/** Hibernate-specific subclass of UncategorizedDataAccessException, ... *//** Return the SQL that led to the problem. */import UnresolvableObjectExceptionimport WrongClassExceptionimport ObjectRetrievalFailureException/** Hibernate-specific subclass of ObjectRetrievalFailureException. ... */import LockModeimport ReplicationModeimport DetachedCriteria/** Interface that specifies a common set of Hibernate operations as well as ... *//** Return the persistent instance of the given entity class ... */// Convenience methods for loading individual objects/** Return all persistent instances of the given entity class. ... *//** Load the persistent instance with the given identifier ... *//** Re-read the state of the given persistent instance. ... *//** Check whether the given object is in the Session cache. ... *//** Remove the given object from the {@link org.hibernate.Session} cache. ... *//** Force initialization of a Hibernate proxy or persistent collection. ... *//** Return an enabled Hibernate {@link Filter} for the given filter name. ... *//** Obtain the specified lock level upon the given object, implicitly ... */// Convenience methods for storing individual objects/** Persist the given transient instance. ... *//** Update the given persistent instance, ... *//** Save or update the given persistent instance, ... *//** Persist the state of the given detached instance according to the ... *//** Persist the given transient instance. Follows JSR-220 semantics. ... *//** Copy the state of the given object onto the persistent object ... *//** Delete the given persistent instance. ... *//** Delete all given persistent instances. ... *//** Flush all pending saves, updates and deletes to the database. ... *//** Remove all objects from the {@link org.hibernate.Session} cache, and ... *//** Execute a query based on a given Hibernate criteria object. ... */// Convenience finder methods for detached criteria/** Execute a query based on the given Hibernate criteria object. ... *//** Execute a query based on the given example entity object. ... *//** Execute a query based on a given example entity object. ... *//** Execute an HQL query, binding a number of values to "?" parameters ... */// Convenience finder methods for HQL strings/** Execute an HQL query, binding one value to a ":" named parameter ... *//** Execute an HQL query, binding a number of values to ":" named ... *//** Execute an HQL query, binding the properties of the given bean to ... *//** Execute a named query binding a number of values to "?" parameters ... */// Convenience finder methods for named queries/** Execute a named query, binding one value to a ":" named parameter ... *//** Execute a named query, binding a number of values to ":" named ... *//** Execute a named query, binding the properties of the given bean to ... *//** Execute a query for persistent instances, binding a number of ... */// Convenience query methods for iteration and bulk updates/deletes/** Immediately close an {@link Iterator} created by any of the various ... *//** Update/delete all objects according to the given query, binding a number of ... */import StaleObjectStateExceptionimport StaleStateExceptionimport OptimisticEntityLockExceptionimport ObjectOptimisticLockingFailureException/** Hibernate-specific subclass of ObjectOptimisticLockingFailureException. ... */import QueryException/** Hibernate-specific subclass of InvalidDataAccessResourceUsageException, ... *//** Return the HQL query string that was invalid. */getQueryString(...)/** Create a new HibernateSystemException, ... */import Criteriaimport FlushModeimport Hibernateimport LockOptionsimport SessionFactoryimport Exampleimport Query/** Helper class that simplifies Hibernate data access code. Automatically ... */SessionFactory sessionFactory, ...;...[] filterNames, ...;boolean exposeNativeSession, ...;boolean checkWriteOperations, ...;boolean cacheQueries, ...;String queryCacheRegion, ...;int maxResults, ...;/** Create a new HibernateTemplate instance. *//** Create a new HibernateTemplate instance. ... */setSessionFactory(...)/** Set the Hibernate SessionFactory that should be used to create ... */this.sessionFactory/** Return the Hibernate SessionFactory that should be used to create ... *//** Obtain the SessionFactory for actual use. ... */SessionFactory sessionFactorygetSessionFactory(...)/** Set one or more names of Hibernate filters to be activated for all ... */this.filterNames/** Return the names of Hibernate filters to be activated, if any. *//** Set whether to expose the native Hibernate Session to ... */this.exposeNativeSession/** Return whether to expose the native Hibernate Session to ... *//** Set whether to check that the Hibernate Session is not in read-only mode ... */this.checkWriteOperations/** Return whether to check that the Hibernate Session is not in read-only ... *//** Set whether to cache all queries executed by this template. ... */this.cacheQueries/** Return whether to cache all queries executed by this template. *//** Set the name of the cache region for queries executed by this template. ... */this.queryCacheRegion/** Return the name of the cache region for queries executed by this template. *//** Set the fetch size for this HibernateTemplate. This is important for processing ... *//** Return the fetch size specified for this HibernateTemplate. *//** Set the maximum number of rows for this HibernateTemplate. This is important ... */this.maxResults/** Return the maximum number of rows specified for this HibernateTemplate. *//** Execute the action specified by the given action object within a Session. ... */boolean isNewgetCurrentSession(...)obtainSessionFactory(...)HibernateException exopenSession(...)setHibernateFlushMode(...)FlushMode.MANUALSession sessionToExposecreateSessionProxy(...)isExposeNativeSession(...)enableFilters(...)doInHibernate(...)PersistenceException exdisableFilters(...)/** Create a close-suppressing proxy for the given Hibernate Session. ... *//** Enable the specified filters on the given Session. ... */String[] filterNamesgetFilterNames(...)String filterNameenableFilter(...)/** Disable the specified filters on the given Session. ... */disableFilter(...)executeWithNativeSession(...)new HibernateCallback<T>(...) { ... }new LockOptions(...)new HibernateCallback<Object>(...) { ... }new HibernateCallback<List<T>>(...) { ... }Criteria criteriacreateCriteria(...)setResultTransformer(...)Criteria.DISTINCT_ROOT_ENTITYprepareCriteria(...)new HibernateCallback<Boolean>(...) { ... }getEnabledFilter(...)buildLockRequest(...)new HibernateCallback<Serializable>(...) { ... }checkWriteOperationAllowed(...)saveOrUpdate(...)replicate(...)Object entityfindByCriteria(...)new HibernateCallback<List<?>>(...) { ... }Criteria executableCriteriagetExecutableCriteria(...)setFirstResult(...)setMaxResults(...)findByExample(...)Query<?> queryObjectcreateQuery(...)prepareQuery(...)setParameter(...)findByNamedParam(...)applyNamedParameterToQuery(...)getNamedQuery(...)findByNamedQueryAndNamedParam(...)new HibernateCallback<Iterator<?>>(...) { ... }iterate(...)new HibernateCallback<Integer>(...) { ... }/** Check whether write operations are allowed on the given Session. ... */// Helper methods used by the operations aboveisCheckWriteOperations(...)lessThan(...)getHibernateFlushMode(...)FlushMode.COMMIT/** Prepare the given Criteria object, applying cache settings and/or ... */ResourceHolderSupport sessionHolderisCacheQueries(...)setCacheable(...)getQueryCacheRegion(...)setCacheRegion(...)getMaxResults(...)/** Prepare the given Query object, applying cache settings and/or ... *//** Apply the given name parameter to the given Query object. ... */setParameterList(...)/** Invocation handler that suppresses close calls on Hibernate Sessions. ... */// Callback code threw application exception...// Invocation on Session interface coming in...// If return value is a Query or Criteria, apply transaction timeout.// Applies to createQuery, getNamedQuery, createCriteria.import ConnectionReleaseModeimport SessionImplementorimport JdbcTransactionObjectSupportboolean autodetectDataSource, ...;boolean prepareConnection, ...;boolean allowResultAccessAfterCompletion, ...;boolean hibernateManagedSession, ...;Consumer<Session> sessionInitializer, ...;Object entityInterceptor, ...;/** Just needed for entityInterceptorBeanName. ... *//** Create a new HibernateTransactionManager instance. ... *//** Set the SessionFactory that this instance should manage transactions for. *//** Return the SessionFactory that this instance should manage transactions for. *//** Set whether to autodetect a JDBC DataSource used by the Hibernate SessionFactory, ... */this.autodetectDataSource/** Set whether to prepare the underlying JDBC Connection of a transactional ... */this.prepareConnection/** Set whether to allow result access after completion, typically via Hibernate's ... */this.allowResultAccessAfterCompletion/** Set whether to operate on a Hibernate-managed Session instead of a ... */this.hibernateManagedSession/** Specify a callback for customizing every Hibernate {@code Session} resource ... */this.sessionInitializer/** Set the bean name of a Hibernate entity interceptor that allows to inspect ... */this.entityInterceptor/** Set a Hibernate entity interceptor that allows to inspect and change ... *//** Return the current Hibernate entity interceptor, or {@code null} if none. ... *//** The bean factory just needs to be known for resolving entity interceptor ... */DataSource sfdsHibernateTransactionObject txObjectnew HibernateTransactionObject(...)SessionHolder sessionHoldersetSessionHolder(...)setExistingSession(...)hasSpringManagedTransaction(...)hasHibernateManagedTransaction(...)SessionImplementor sessionnew IllegalTransactionStateException(...)boolean holdabilityNeededisNewSession(...)boolean isolationLevelNeededTransaction hibTxhasSessionHolder(...)getSessionHolder(...)Interceptor entityInterceptorgetEntityInterceptor(...)Session newSessioninterceptor(...)withOptions(...)SessionImplementor.classConnectionReleaseMode.ON_CLOSEgetReleaseMode(...)getConnectionHandlingMode(...)getLogicalConnection(...)getJdbcCoordinator(...)connection(...)int currentHoldabilitygetHoldability(...)ResultSet.HOLD_CURSORS_OVER_COMMITsetPreviousHoldability(...)setHoldability(...)connectionPrepared(...)setDefaultReadOnly(...)FlushMode flushModeFlushMode.AUTOsetPreviousFlushMode(...)beginTransaction(...)setTransaction(...)new ConnectionHandle(...) { ... }getConnectionHandle(...)isNewSessionHolder(...)TransactionStatus.ACTIVEConnectionHolder connectionHoldernew SuspendedResourcesHolder(...)SuspendedResourcesHolder resourcesHolderTransactionException exneedsConnectionReset(...)isPhysicallyConnected(...)Integer previousHoldabilitygetPreviousHoldability(...)getPreviousFlushMode(...)disconnectOnCompletion(...)/** Disconnect a pre-existing Hibernate Session on transaction completion, ... *//** Convert the given HibernateException to an appropriate exception ... *//** Hibernate transaction object, representing a SessionHolder. ... */SessionHolder sessionHolder, ...;boolean newSessionHolder, ...;boolean newSession, ...;boolean needsConnectionReset, ...;Integer previousHoldability, ...;this.sessionHoldernew SessionHolder(...)this.newSessionHolderthis.newSessionthis.needsConnectionResetthis.previousHoldability/** Holder for suspended resources. ... */// Check for SessionFactory's DataSource.// Use the SessionFactory's DataSource for exposing transactions to JDBC code.// We're allowed to change the transaction settings of the JDBC Connection.// Not allowed to change the transaction settings of the JDBC Connection.// We should set a specific isolation level but are not allowed to...// Just set to MANUAL in case of a new Session for this transaction.// As of 5.1, we're also setting Hibernate's read-only entity mode by default.// We need AUTO or COMMIT for a non-read-only transaction.// Register transaction timeout.// Use Hibernate's own transaction timeout mechanism on Hibernate 3.1+// Applies to all statements, also to inserts, updates and deletes!// Open a plain Hibernate transaction without specified timeout.// Add the Hibernate transaction to the session holder.// Register the Hibernate Session's JDBC Connection for the DataSource, if set.// Bind the session holder to the thread.// From non-transactional code running in active transaction synchronization// -> can be safely removed, will be closed on transaction completion.// assumably from commit call to the underlying JDBC connection// assumably failed to flush changes to database// Shouldn't really happen, as a rollback doesn't cause a flush.// Clear all pending inserts/updates/deletes in the Session.// Necessary for pre-bound Sessions, to avoid inconsistent state.// Remove the session holder from the thread.// Remove the JDBC connection holder from the thread, if exposed.// We're running with connection release mode ON_CLOSE: We're able to reset// the isolation level and/or read-only flag of the JDBC Connection here.// Else, we need to rely on the connection pool to perform proper cleanup.import MetadataSourcesimport ImplicitNamingStrategyimport PhysicalNamingStrategyimport BootstrapServiceRegistryBuilderimport RegionFactoryimport CurrentTenantIdentifierResolverimport MultiTenantConnectionProviderimport Integratorimport ServiceRegistry/** {@link FactoryBean} that creates a Hibernate {@link SessionFactory}. This is the usual ... */...[] mappingResources, ...;...[] cacheableMappingLocations, ...;...[] mappingJarLocations, ...;...[] mappingDirectoryLocations, ...;Interceptor entityInterceptor, ...;ImplicitNamingStrategy implicitNamingStrategy, ...;PhysicalNamingStrategy physicalNamingStrategy, ...;Object jtaTransactionManager, ...;RegionFactory cacheRegionFactory, ...;MultiTenantConnectionProvider multiTenantConnectionProvider, ...;CurrentTenantIdentifierResolver currentTenantIdentifierResolver, ...;Properties hibernateProperties, ...;...[] entityTypeFilters, ...;...[] annotatedClasses, ...;...[] annotatedPackages, ...;...[] packagesToScan, ...;AsyncTaskExecutor bootstrapExecutor, ...;...[] hibernateIntegrators, ...;boolean metadataSourcesAccessed, ...;MetadataSources metadataSources, ...;/** Set the DataSource to be used by the SessionFactory. ... *//** Set the location of a single Hibernate XML config file, for example as ... *//** Set the locations of multiple Hibernate XML config files, for example as ... *//** Set Hibernate mapping resources to be found in the class path, ... */this.mappingResources/** Set locations of Hibernate mapping files, for example as classpath ... *//** Set locations of cacheable Hibernate mapping files, for example as web app ... */this.cacheableMappingLocations/** Set locations of jar files that contain Hibernate mapping resources, ... */this.mappingJarLocations/** Set locations of directories that contain Hibernate mapping resources, ... */this.mappingDirectoryLocations/** Set a Hibernate 5 {@link ImplicitNamingStrategy} for the SessionFactory. ... */this.implicitNamingStrategy/** Set a Hibernate 5 {@link PhysicalNamingStrategy} for the SessionFactory. ... */this.physicalNamingStrategy/** Set the Spring {@link org.springframework.transaction.jta.JtaTransactionManager} ... */this.jtaTransactionManager/** Set the Hibernate {@link RegionFactory} to use for the SessionFactory. ... */this.cacheRegionFactory/** Set a {@link MultiTenantConnectionProvider} to be passed on to the SessionFactory. ... */this.multiTenantConnectionProvider/** Set a {@link CurrentTenantIdentifierResolver} to be passed on to the SessionFactory. ... */this.currentTenantIdentifierResolver/** Set Hibernate properties, such as "hibernate.dialect". ... */this.hibernateProperties/** Return the Hibernate properties, if any. Mainly available for ... *//** Specify custom type filters for Spring-based scanning for entity classes. ... */this.entityTypeFilters/** Specify annotated entity classes to register with this Hibernate SessionFactory. ... */this.annotatedClasses/** Specify the names of annotated packages, for which package-level ... */this.annotatedPackages/** Specify packages to search for autodetection of your entity classes in the ... */this.packagesToScan/** Specify an asynchronous executor for background bootstrapping, ... */this.bootstrapExecutor/** Specify one or more Hibernate {@link Integrator} implementations to apply. ... */this.hibernateIntegrators/** Specify a Hibernate {@link MetadataSources} service to use (e.g. reusing an ... */this.metadataSourcesAccessedthis.metadataSources/** Determine the Hibernate {@link MetadataSources} to use. ... */BootstrapServiceRegistryBuilder buildernew BootstrapServiceRegistryBuilder(...)applyClassLoader(...)Integrator integratorapplyIntegrator(...)new MetadataSources(...)/** Specify a Spring {@link ResourceLoader} to use for Hibernate metadata. ... *//** Determine the Spring {@link ResourceLoader} to use for Hibernate metadata. ... *//** Accept the containing {@link BeanFactory}, registering corresponding Hibernate ... */LocalSessionFactoryBuilder sfbnew LocalSessionFactoryBuilder(...)getMetadataSources(...)Resource mraddInputStream(...)addCacheableFile(...)addJar(...)addDirectory(...)setInterceptor(...)setImplicitNamingStrategy(...)setPhysicalNamingStrategy(...)setJtaTransactionManager(...)setBeanContainer(...)setCacheRegionFactory(...)setMultiTenantConnectionProvider(...)setCurrentTenantIdentifierResolver(...)addProperties(...)setEntityTypeFilters(...)addAnnotatedClasses(...)addPackages(...)scanPackages(...)buildSessionFactory(...)/** Subclasses can override this method to perform custom initialization ... *//** Return the Hibernate Configuration object used to build the SessionFactory. ... */SessionFactory.class// Repeated initialization with no user-customized MetadataSources -> clear it.// Load Hibernate configuration from given location.// Register given Hibernate mapping definitions, contained in resource files.// Register given cacheable Hibernate mapping definitions, read from the file system.// Register given Hibernate mapping definitions, contained in jar files.// Register all Hibernate mapping definitions in the given directories.// Build SessionFactory instance.import AttributeConverterimport MappingExceptionimport AvailableSettingsimport SessionFactoryImplementorimport PhysicalConnectionHandlingModeimport InfrastructureProxy/** A Spring-provided extension of the standard Hibernate {@link Configuration} class, ... */new TypeFilter[]String RESOURCE_PATTERN, ...;String PACKAGE_INFO_SUFFIX, ...;...[] DEFAULT_ENTITY_TYPE_FILTERS, ...;TypeFilter CONVERTER_TYPE_FILTER, ...;/** Create a new LocalSessionFactoryBuilder for the given DataSource. ... */AvailableSettings.CURRENT_SESSION_CONTEXT_CLASSSpringSessionContext.classAvailableSettings.DATASOURCEAvailableSettings.CONNECTION_HANDLINGPhysicalConnectionHandlingMode.DELAYED_ACQUISITION_AND_HOLDAvailableSettings.CLASSLOADERS/** Set the Spring {@link JtaTransactionManager} or the JTA {@link TransactionManager} ... */boolean webspherePresentAvailableSettings.JTA_PLATFORMJtaTransactionManager jtaTmnew ConfigurableJtaPlatform(...)getUserTransaction(...)getTransactionSynchronizationRegistry(...)AvailableSettings.TRANSACTION_COORDINATOR_STRATEGYPhysicalConnectionHandlingMode.DELAYED_ACQUISITION_AND_RELEASE_AFTER_STATEMENT/** Set a Hibernate {@link org.hibernate.resource.beans.container.spi.BeanContainer} ... */AvailableSettings.BEAN_CONTAINERnew SpringBeanContainer(...)AvailableSettings.CACHE_REGION_FACTORYAvailableSettings.MULTI_TENANT_CONNECTION_PROVIDER/** Overridden to reliably pass a {@link CurrentTenantIdentifierResolver} to the SessionFactory. ... */AvailableSettings.MULTI_TENANT_IDENTIFIER_RESOLVER/** Add the given annotated classes in a batch. ... */Class<?> annotatedClassaddAnnotatedClass(...)/** Add the given annotated packages in a batch. ... */String annotatedPackageaddPackage(...)/** Perform Spring-based scanning for entity classes, registering them ... */Set<String> entityClassNamesSet<String> converterClassNamesSet<String> packageNamesmatchesEntityTypeFilter(...)new MappingException(...)addAttributeConverter(...)/** Check whether any of the configured entity type filters matches ... *//** Build the Hibernate {@code SessionFactory} through background bootstrapping, ... */new BootstrapSessionFactoryInvocationHandler(...)SessionFactoryImplementor.classInfrastructureProxy.class/** Proxy invocation handler for background bootstrapping, only enforcing ... */Future<SessionFactory> sessionFactoryFuture, ...;this.sessionFactoryFuturenew Callable<SessionFactory>(...) { ... }LocalSessionFactoryBuilder.this// Use hashCode of EntityManagerFactory proxy.// Call coming in through InfrastructureProxy interface...// Regular delegation to the target SessionFactory,// enforcing its full initialization...// Rethrow a provider configuration exception (possibly with a nested cause) directlyimport NonUniqueObjectExceptionimport NonUniqueResultExceptionimport ObjectDeletedExceptionimport PersistentObjectExceptionimport PessimisticLockExceptionimport PropertyValueExceptionimport TransientObjectExceptionimport PessimisticEntityLockExceptionimport DataExceptionimport JDBCConnectionExceptionimport LockAcquisitionExceptionimport SQLGrammarExceptionimport UnknownServiceExceptionimport PessimisticLockingFailureException/** Helper class featuring methods for Hibernate Session handling. ... */DataSourceUtils.CONNECTION_SYNCHRONIZATION_ORDERSessionFactoryUtils.classint SESSION_SYNCHRONIZATION_ORDER, ...;/** Order value for TransactionSynchronization objects that clean up Hibernate Sessions. ... *//** Trigger a flush on the given Hibernate Session, converting regular ... *//** Perform actual closing of the Hibernate Session, ... *//** Determine the DataSource of the given SessionFactory. ... */Method getPropertiesMap<?,?> propsObject dataSourceValueEnvironment.DATASOURCESessionFactoryImplementor sfiConnectionProvider cpgetServiceRegistry(...)ConnectionProvider.classUnknownServiceException exSQLGrammarException jdbcExQueryTimeoutException jdbcExLockAcquisitionException jdbcExPessimisticLockException jdbcExnew PessimisticLockingFailureException(...)ConstraintViolationException jdbcExgetConstraintName(...)DataException jdbcExnew HibernateJdbcException(...)new HibernateQueryException(...)new HibernateObjectRetrievalFailureException(...)new HibernateOptimisticLockingFailureException(...)new HibernateSystemException(...)// end of JDBCException (subclass) handlingimport EntityManagerHolder/** Resource holder wrapping a Hibernate {@link Session} (plus an optional {@link Transaction}). ... */FlushMode previousFlushMode, ...;getEntityManager(...)this.transactionthis.previousFlushModeimport BeanContainerimport ContainedBeanimport BeanInstanceProducer/** Spring's implementation of Hibernate 5.3's {@link BeanContainer} SPI, ... */new ConcurrentReferenceHashMap<Object,SpringContainedBean<?>>(...)SpringBeanContainer.classMap<Object,SpringContainedBean<?>> beanCache, ...;/** Instantiate a new SpringBeanContainer for the given bean factory. ... */SpringContainedBean<?> beancanUseCachedReferences(...)this.beanCachenew Consumer<SpringContainedBean<?>>(...) { ... }destroyIfNecessary(...)useJpaCompliantCreation(...)new SpringContainedBean<Object>(...)new SpringContainedBean<?>(...)produceBeanInstance(...)B beanInstance, ...;Consumer<B> destructionCallback, ...;this.destructionCallback// Rethrow original Spring exception from first attempt.// Throw fallback producer exception since original was probably NoSuchBeanDefinitionException./** Simple synchronization adapter that propagates a {@code flush()} call ... */(...).sessionimport JTASessionContext/** Spring-specific subclass of Hibernate's JTASessionContext, ... */buildOrObtainSession(...)import CurrentSessionContext/** Implementation of Hibernate 3.1's {@link CurrentSessionContext} interface ... */SessionFactoryImplementor sessionFactory, ...;CurrentSessionContext jtaSessionContext, ...;/** Create a new SpringSessionContext for the given Hibernate SessionFactory. ... */JtaPlatform jtaPlatformJtaPlatform.classretrieveTransactionManager(...)this.jtaSessionContextnew SpringJtaSessionContext(...)/** Retrieve the Spring-managed Session for the current thread, if any. */new SpringSessionSynchronization(...)currentSession(...)new SpringFlushSynchronization(...)new HibernateException(...)// HibernateTransactionManager// Switch to FlushMode.AUTO, as we have to assume a thread-bound Session// with FlushMode.MANUAL, which needs to allow flushing within the transaction.// JpaTransactionManager/** Callback for resource cleanup at the end of a Spring-managed transaction ... */SessionFactoryUtils.SESSION_SYNCHRONIZATION_ORDER// Eagerly disconnect the Session here, to make release mode "on_close" work on JBoss.// Read-write transaction -> flush the Hibernate Session.// Further check: only flush when not FlushMode.MANUAL.// In case of pre-bound Session, restore previous flush mode.// Eagerly disconnect the Session here, to make release mode "on_close" work nicely.// Unbind at this point if it's a new Session...// Call close() at this point if it's a new Session...import SessionFactoryUtilsimport SessionHolderimport NativeWebRequestimport CallableProcessingInterceptorimport DeferredResultimport DeferredResultProcessingInterceptor/** An interceptor with asynchronous web requests used in OpenSessionInViewFilter and ... */AsyncRequestInterceptor.classboolean timeoutInProgress, ...;boolean errorInProgress, ...;bindSession(...)this.timeoutInProgressthis.errorInProgress// Implementation of DeferredResultProcessingInterceptor methods// give other interceptors a chance to handle the timeout// give other interceptors a chance to handle the errorimport HibernateTemplate/** Convenient super class for Hibernate-based data access objects. ... */HibernateTemplate hibernateTemplate, ...;/** Set the Hibernate SessionFactory to be used by this DAO. ... */this.hibernateTemplatecreateHibernateTemplate(...)/** Create a HibernateTemplate for the given SessionFactory. ... */new HibernateTemplate(...)/** Return the Hibernate SessionFactory used by this DAO. *//** Set the HibernateTemplate for this DAO explicitly, ... *//** Return the HibernateTemplate for this DAO, ... *//** Conveniently obtain the current Hibernate Session. ... */import FilterChainimport HttpServletRequestimport HttpServletResponseimport WebAsyncManagerimport WebAsyncUtilsimport WebApplicationContextUtilsimport OncePerRequestFilter/** Servlet Filter that binds a Hibernate Session to the thread for the entire ... */String DEFAULT_SESSION_FACTORY_BEAN_NAME, ...;/** The default bean name used for the session factory. */String sessionFactoryBeanName, ...;/** Set the bean name of the SessionFactory to fetch from Spring's ... */this.sessionFactoryBeanName/** Return the bean name of the SessionFactory to fetch from Spring's ... *//** Returns "false" so that the filter may re-bind the opened Hibernate ... *//** Returns "false" so that the filter may provide a Hibernate ... */lookupSessionFactory(...)boolean participateWebAsyncManager asyncManagergetAsyncManager(...)getAlreadyFilteredAttributeName(...)boolean isFirstRequestisAsyncDispatch(...)applySessionBindingInterceptor(...)AsyncRequestInterceptor interceptornew AsyncRequestInterceptor(...)registerCallableInterceptor(...)registerDeferredResultInterceptor(...)doFilter(...)isAsyncStarted(...)/** Look up the SessionFactory that this filter should use, ... *//** Look up the SessionFactory that this filter should use. ... */WebApplicationContext wacgetRequiredWebApplicationContext(...)getServletContext(...)getSessionFactoryBeanName(...)/** Open a Session for the SessionFactory that this filter uses. ... */CallableProcessingInterceptor cpigetCallableInterceptor(...)// Do not modify the Session: just set the participate flag.import ModelMapimport AsyncWebRequestInterceptorimport WebRequest/** Spring web request interceptor that binds a Hibernate {@code Session} to the ... */String PARTICIPATE_SUFFIX, ...;/** Suffix that gets appended to the {@code SessionFactory} ... *//** Set the Hibernate SessionFactory that should be used to create Hibernate Sessions. *//** Return the Hibernate SessionFactory that should be used to create Hibernate Sessions. */SessionFactory sf/** Open a new Hibernate {@code Session} according and bind it to the thread via the ... */getParticipateAttributeName(...)hasConcurrentResult(...)WebRequest.SCOPE_REQUESTint newCountAsyncRequestInterceptor asyncRequestInterceptor/** Unbind the Hibernate {@code Session} from the thread and close it). ... */decrementParticipateCount(...)String participateAttributeName/** Open a Session for the SessionFactory that this interceptor uses. ... *//** Return the name of the request attribute that identifies that a request is ... */// Do not modify the Session: just mark the request accordingly.// Do not modify the Session: just clear the marker./** Simple AOP Alliance {@link MethodInterceptor} implementation that binds a new ... *//** Open a Session for the given SessionFactory. ... */// New Session to be bound for the current method's scope...// Pre-bound Session found -> simply proceed./** Classes supporting the {@code org.springframework.orm.hibernate5} package. */import EntityManagerimport EntityManagerFactoryimport SynchronizationTypeimport PersistenceProviderimport PersistenceUnitInfo/** Abstract {@link org.springframework.beans.factory.FactoryBean} that creates ... */PersistenceProvider persistenceProvider, ...;String persistenceUnitName, ...;Map<String,Object> jpaPropertyMap, ...;Class<? extends EntityManagerFactory> entityManagerFactoryInterface, ...;Class<? extends EntityManager> entityManagerInterface, ...;JpaDialect jpaDialect, ...;JpaVendorAdapter jpaVendorAdapter, ...;Consumer<EntityManager> entityManagerInitializer, ...;EntityManagerFactory nativeEntityManagerFactory, ...;/** Raw EntityManagerFactory as returned by the PersistenceProvider. */Future<EntityManagerFactory> nativeEntityManagerFactoryFuture, ...;/** Future for lazily initializing raw target EntityManagerFactory. */EntityManagerFactory entityManagerFactory, ...;/** Exposed client-level EntityManagerFactory proxy. *//** Set the PersistenceProvider implementation class to use for creating the ... */this.persistenceProvider/** Set the PersistenceProvider instance to use for creating the ... *//** Specify the name of the EntityManagerFactory configuration. ... */this.persistenceUnitName/** Specify JPA properties, to be passed into ... */this.jpaPropertyMap/** Specify JPA properties as a Map, to be passed into ... *//** Allow Map access to the JPA properties to be passed to the persistence ... *//** Specify the (potentially vendor-specific) EntityManagerFactory interface ... */this.entityManagerFactoryInterface/** Specify the (potentially vendor-specific) EntityManager interface ... */this.entityManagerInterface/** Specify the vendor-specific JpaDialect implementation to associate with ... */this.jpaDialect/** Specify the JpaVendorAdapter implementation for the desired JPA provider, ... */this.jpaVendorAdapter/** Return the JpaVendorAdapter implementation for this EntityManagerFactory, ... *//** Specify a callback for customizing every {@code EntityManager} created ... */this.entityManagerInitializer/** Return the asynchronous executor for background bootstrapping, if any. ... */JpaVendorAdapter jpaVendorAdaptergetJpaVendorAdapter(...)AsyncTaskExecutor bootstrapExecutorgetBootstrapExecutor(...)PersistenceUnitInfo puigetPersistenceUnitInfo(...)Map<String,?> vendorPropertyMapgetJpaPropertyMap(...)getPersistenceProvider(...)getEntityManagerFactoryInterface(...)EntityManagerFactory.classgetEntityManagerInterface(...)EntityManager.classgetJpaDialect(...)this.nativeEntityManagerFactoryFuturenew Callable<EntityManagerFactory>(...) { ... }buildNativeEntityManagerFactory(...)this.nativeEntityManagerFactorythis.entityManagerFactorycreateEntityManagerFactoryProxy(...)EntityManagerFactory emfcreateNativeEntityManagerFactory(...)PersistenceException.classString causeStringnew PersistenceException(...)postProcessEntityManagerFactory(...)getPersistenceUnitName(...)/** Create a proxy for the given {@link EntityManagerFactory}. We do this to be able to ... */Class<?> entityManagerFactoryInterfaceEntityManagerFactoryInfo.classnew ManagedEntityManagerFactoryInvocationHandler(...)/** Delegate an incoming invocation from the proxy, dispatching to EntityManagerFactoryInfo ... */getNativeEntityManagerFactory(...)SynchronizationType.SYNCHRONIZEDEntityManager rawEntityManagercreateEntityManager(...)postProcessEntityManager(...)createApplicationManagedEntityManager(...)/** Subclasses must implement this method to create the EntityManagerFactory ... *//** Implementation of the PersistenceExceptionTranslator interface, as ... */JpaDialect jpaDialecttranslateExceptionIfPossible(...)/** Optional callback for post-processing the native EntityManager ... */Consumer<EntityManager> customizer/** Return the singleton EntityManagerFactory. *//** Close the EntityManagerFactory on bean factory shutdown. */new SerializedEntityManagerFactoryBeanReference(...)/** Minimal bean reference to the surrounding AbstractEntityManagerFactoryBean. ... */String lookupName, ...;this.lookupNameAbstractEntityManagerFactoryBean.class/** Dynamic proxy invocation handler for an {@link EntityManagerFactory}, returning a ... */AbstractEntityManagerFactoryBean entityManagerFactoryBean, ...;this.entityManagerFactoryBeaninvokeProxyMethod(...)// Wrap the EntityManagerFactory in a factory implementing all its interfaces.// This allows interception of createEntityManager methods to return an// application-managed EntityManager proxy that automatically joins// existing transactions.// Plain PersistenceException wrapper for underlying exception?// Make sure the nested exception message is properly exposed,// along the lines of Spring's NestedRuntimeException.getMessage()// JPA 2.1's createEntityManager(SynchronizationType, Map)// Redirect to plain createEntityManager and add synchronization semantics through Spring proxy// Look for Query arguments, primarily JPA 2.1's addNamedQuery(String, Query)// Assumably a Spring-generated proxy from SharedEntityManagerCreator:// since we're passing it back to the native EntityManagerFactory,// let's unwrap it to the original Query object from the provider.// Ignore - simply proceed with given Query object then// Standard delegation to the native factory, just post-processing EntityManager return values// Any other createEntityManager variant - expecting non-synchronized semantics// Handle JPA 2.1 unwrap method - could be a proxy match.import ConnectionHandle/** Default implementation of the {@link JpaDialect} interface. ... *//** This implementation invokes the standard JPA {@code Transaction.begin} ... *//** This implementation does nothing, since the default {@code beginTransaction} ... *//** This implementation does nothing, assuming that the Connection ... *//** This implementation delegates to EntityManagerFactoryUtils. ... *///-----------------------------------------------------------------------------------// Hook for exception translation (used by JpaTransactionManager)/** Base class for any class that needs to access a JPA {@link EntityManagerFactory}, ... *//** Set the JPA EntityManagerFactory that should be used to create ... *//** Return the JPA EntityManagerFactory that should be used to create ... *//** Obtain the EntityManagerFactory for actual use. ... */getEntityManagerFactory(...)/** Set the name of the persistence unit to access the EntityManagerFactory for. ... *//** Return the name of the persistence unit to access the EntityManagerFactory for, if any. *//** Retrieves an EntityManagerFactory by persistence unit name, if none set explicitly. ... */setEntityManagerFactory(...)findEntityManagerFactory(...)/** Obtain a new EntityManager from this accessor's EntityManagerFactory. ... */obtainEntityManagerFactory(...)Map<String,Object> properties/** Obtain the transactional EntityManager for this accessor's EntityManagerFactory, if any. ... */getTransactionalEntityManager(...)/** Metadata interface for a Spring-managed JPA {@link EntityManagerFactory}. ... *//** Return the underlying PersistenceProvider that the underlying ... *//** Return the PersistenceUnitInfo used to create this ... *//** Return the name of the persistence unit used to create this ... *//** Return the JDBC DataSource that this EntityManagerFactory ... *//** Return the (potentially vendor-specific) EntityManager interface ... *//** Return the vendor-specific JpaDialect implementation for this ... *//** Return the ClassLoader that the application's beans are loaded with. ... *//** Return the raw underlying EntityManagerFactory. ... *//** Create a native JPA EntityManager to be used as the framework-managed ... */import EntityExistsExceptionimport EntityNotFoundExceptionimport LockTimeoutExceptionimport NoResultExceptionimport OptimisticLockExceptionimport TransactionRequiredException/** Helper class featuring methods for JPA EntityManager handling, ... */EntityManagerFactoryUtils.classint ENTITY_MANAGER_SYNCHRONIZATION_ORDER, ...;/** Order value for TransactionSynchronization objects that clean up JPA ... *//** Find an EntityManagerFactory with the given name in the given ... *//** Obtain a JPA EntityManager from the given factory. Is aware of a corresponding ... */doGetTransactionalEntityManager(...)EntityManagerHolder emHolderEntityManager emjoinTransaction(...)TransactionRequiredException exObject transactionDataprepareTransaction(...)new TransactionalEntityManagerSynchronization(...)SynchronizationType.UNSYNCHRONIZEDnew EntityManagerHolder(...)new TransactionScopedEntityManagerSynchronization(...)closeEntityManager(...)/** Prepare a transaction on the given EntityManager, if possible. ... */EntityManagerFactoryInfo emfInfocleanupTransaction(...)/** Apply the current transaction timeout, if any, to the given JPA Query object. ... */int timeoutValuesetHint(...)/** Convert the given runtime exception to an appropriate exception from the ... */new JpaObjectRetrievalFailureException(...)new JpaOptimisticLockingFailureException(...)new JpaSystemException(...)/** Close the given JPA EntityManager, ... *//** Callback for resource cleanup at the end of a non-JPA transaction ... */Object transactionData, ...;boolean newEntityManager, ...;this.transactionDatathis.newEntityManagerEntityManager targetgetTargetEntityManager(...)/** Minimal callback that just closes the EntityManager at the end of the transaction. */// See whether we can find an EntityManagerFactory with matching persistence unit name.// No matching persistence unit found - simply take the EntityManagerFactory// with the persistence unit name as bean name (by convention).// Find unique EntityManagerFactory bean in the context, falling back to parent contexts.// Try to explicitly synchronize the EntityManager itself// with an ongoing JTA transaction, if any.// Use holder's reference count to track synchronizedWithTransaction access.// isOpen() check used below to find out about it.// unsynchronized EntityManager demanded// EntityManagerHolder with an active transaction coming from JpaTransactionManager,// with no synchronized EntityManager having been requested by application code before.// Unbind in order to register a new unsynchronized EntityManager instead.// Either a previously bound unsynchronized EntityManager, or the application// has requested a synchronized EntityManager before and therefore upgraded// this transaction's EntityManager to synchronized before.// Indicate that we can't obtain a transactional EntityManager.// Create a new EntityManager for use within the current transaction.// JPA 2.1 API available but method not actually implemented in persistence provider:// falling back to regular createEntityManager method.// Use same EntityManager for further JPA operations within the transaction.// Unsynchronized - just scope it for the transaction, as demanded by the JPA 2.1 spec...// Unexpected exception from external delegation call -> close EntityManager and rethrow.// oh well, at least we tried...// Following the JPA specification, a persistence provider can also// throw these two exceptions, besides PersistenceException.// Check for well-known PersistenceException subclasses.// If we have another kind of PersistenceException, throw it.// If we get here, we have an exception that resulted from user code,// rather than the persistence provider, so we return null to indicate// that translation should not occur.// ExtendedEntityManagerSynchronization active after joinTransaction() call:// flush synchronization already registered.// Clear all pending inserts/updates/deletes in the EntityManager.// Necessary for pre-bound EntityManagers, to avoid inconsistent state./** Resource holder wrapping a JPA {@link EntityManager}. ... */EntityManager entityManager, ...;SavepointManager savepointManager, ...;this.entityManagerthis.savepointManager/** Subinterface of {@link javax.persistence.EntityManager} to be implemented by ... *//** Return the underlying EntityManager that this proxy will delegate to. ... */import EntityTransactionimport PersistenceUnitTransactionType/** Delegate for creating a variety of {@link javax.persistence.EntityManager} ... */new ConcurrentReferenceHashMap<Class<?>,Class<?>[]>(...)Map<Class<?>,Class<?>[]> cachedEntityManagerInterfaces, ...;/** Create an application-managed extended EntityManager proxy. ... *//** Create a container-managed extended EntityManager proxy. ... */createContainerManagedEntityManager(...)createNativeEntityManager(...)/** Actually create the EntityManager proxy. ... */Boolean jtagetTransactionType(...)PersistenceUnitTransactionType.JTAnew Function<Class<?>,Class<?>[]>(...) { ... }EntityManagerProxy.classnew ExtendedEntityManagerInvocationHandler(...)ExtendedEntityManagerCreator.class/** InvocationHandler for extended EntityManagers as defined in the JPA spec. */ExtendedEntityManagerInvocationHandler.classEntityManager target, ...;PersistenceExceptionTranslator exceptionTranslator, ...;boolean jta, ...;boolean containerManaged, ...;boolean synchronizedWithTransaction, ...;this.jtaisJtaEntityManager(...)this.containerManagedthis.synchronizedWithTransactionExtendedEntityManagerSynchronization synchsynch.closeOnCompletiondoJoinTransaction(...)/** Join an existing transaction, if not already joined. ... */enlistInCurrentTransaction(...)new TransactionRequiredException(...)/** Enlist this application-managed EntityManager in the current transaction. */EntityTransaction etExtendedEntityManagerSynchronization extendedEntityManagerSynchronizationnew ExtendedEntityManagerSynchronization(...)/** TransactionSynchronization enlisting an extended EntityManager ... */boolean closeOnCompletion, ...;EntityManagerFactoryUtils.ENTITY_MANAGER_SYNCHRONIZATION_ORDERconvertException(...)this.closeOnCompletion// Invocation on EntityManager interface coming in...// Use hashCode of EntityManager proxy.// Handle EntityManagerProxy interface.// Handle JPA 2.0 unwrap method - could be a proxy match.// Local transaction joined - don't actually call close() before transaction completion// Handle JPA 2.1 isJoinedToTransaction method for the non-JTA case.// Do automatic joining if required. Excludes toString, equals, hashCode calls.// Invoke method on current EntityManager.// Let's try whether we're in a JTA transaction.// Resource local transaction, need to acquire the EntityTransaction,// start a transaction now and enlist a synchronization for commit or rollback later.// Trigger commit here to let exceptions propagate to the caller.// Haven't had an afterCommit call: trigger a rollback./** SPI strategy that encapsulates certain functionality that standard JPA 2.1 does ... *//** Begin the given JPA transaction, applying the semantics specified by the ... *//** Prepare a JPA transaction, applying the specified semantics. Called by ... *//** Clean up the transaction via the given transaction data. Called by ... *//** Retrieve the JDBC Connection that the given JPA EntityManager uses underneath, ... *//** Release the given JDBC Connection, which has originally been retrieved ... *//** JPA-specific subclass of ObjectRetrievalFailureException. ... *//** JPA-specific subclass of ObjectOptimisticLockingFailureException. ... *//** JPA-specific subclass of UncategorizedDataAccessException, ... */import DelegatingTransactionDefinitionimport ResourceTransactionDefinitionnew DefaultJpaDialect(...)/** Create a new JpaTransactionManager instance. ... *//** Set the EntityManagerFactory that this instance should manage transactions for. ... *//** Return the EntityManagerFactory that this instance should manage transactions for. *//** Set the name of the persistence unit to manage transactions for. ... *//** Return the name of the persistence unit to manage transactions for, if any. *//** Set the JPA dialect to use for this transaction manager. ... *//** Return the JPA dialect to use for this transaction manager. *//** Specify a callback for customizing every {@code EntityManager} resource ... *//** Eagerly initialize the JPA dialect, creating a default one ... */setJpaDialect(...)JpaTransactionObject txObjectnew JpaTransactionObject(...)setEntityManagerHolder(...)hasTransaction(...)getEntityManagerHolder(...)int timeoutToUsenew JpaTransactionDefinition(...)isNewEntityManagerHolder(...)hasEntityManagerHolder(...)EntityManager newEmcreateEntityManagerForTransaction(...)setTransactionData(...)ConnectionHandle conHandlegetJdbcConnection(...)closeEntityManagerAfterFailedBegin(...)/** Create a JPA EntityManager to be used for a transaction. ... *//** Close the current transaction's EntityManager. ... */EntityManagerHolder entityManagerHolder/** This implementation returns "true": a JPA commit will properly handle ... */EntityTransaction txRollbackException extranslateIfNecessary(...)releaseJdbcConnection(...)getTransactionData(...)/** JPA transaction object, representing a EntityManagerHolder. ... */EntityManagerHolder entityManagerHolder, ...;boolean newEntityManagerHolder, ...;this.entityManagerHolderthis.newEntityManagerHoldersetSavepointManager(...)getRollbackOnly(...)getSavepointManager(...)SavepointManager savepointManager/** JPA-specific transaction definition to be passed to {@link JpaDialect#beginTransaction}. ... */boolean localResource, ...;this.localResource// Delegate to JpaDialect for actual transaction begin.// Register the JPA EntityManager's JDBC Connection for the DataSource, if set.// Bind the entity manager holder to the thread.// Assumably failed to flush changes to database.// Remove the entity manager holder from the thread, if still there.// (Could have been removed by EntityManagerFactoryUtils in order// to replace it with an unsynchronized EntityManager).// Just log it, to keep a transaction-related exception.// Remove the entity manager holder from the thread./** SPI interface that allows to plug in vendor-specific behavior ... *//** Return the vendor-specific persistence provider. *//** Return the name of the persistence provider's root package ... *//** Return a Map of vendor-specific JPA properties for the given persistence ... *//** Return a Map of vendor-specific JPA properties, ... *//** Return the vendor-specific EntityManagerFactory interface ... *//** Return the vendor-specific EntityManager interface ... *//** Optional callback for post-processing the native EntityManagerFactory ... */import SharedCacheModeimport ValidationModeimport SingleDataSourceLookupimport DefaultPersistenceUnitManagerimport PersistenceUnitManagerimport PersistenceUnitPostProcessorimport SmartPersistenceUnitInfo/** {@link org.springframework.beans.factory.FactoryBean} that creates a JPA ... */new DefaultPersistenceUnitManager(...)PersistenceUnitManager persistenceUnitManager, ...;DefaultPersistenceUnitManager internalPersistenceUnitManager, ...;PersistenceUnitInfo persistenceUnitInfo, ...;/** Set the PersistenceUnitManager to use for obtaining the JPA persistence unit ... */this.persistenceUnitManager/** Set the location of the {@code persistence.xml} file ... */setPersistenceXmlLocation(...)this.internalPersistenceUnitManager/** Uses the specified persistence unit name as the name of the default ... */setPersistenceUnitName(...)setDefaultPersistenceUnitName(...)/** Set a persistence unit root location for the default persistence unit. ... */setDefaultPersistenceUnitRootLocation(...)/** Set whether to use Spring-based scanning for entity classes in the classpath ... */setPackagesToScan(...)/** Specify one or more mapping resources (equivalent to {@code <mapping-file>} ... */setMappingResources(...)/** Specify the JPA 2.0 shared cache mode for this persistence unit, ... */setSharedCacheMode(...)/** Specify the JPA 2.0 validation mode for this persistence unit, ... *//** Specify the JDBC DataSource that the JPA persistence provider is supposed ... */new SingleDataSourceLookup(...)setDefaultDataSource(...)setDefaultJtaDataSource(...)/** Set the PersistenceUnitPostProcessors to be applied to the ... */setPersistenceUnitPostProcessors(...)/** Specify the Spring LoadTimeWeaver to use for class instrumentation according ... */PersistenceUnitManager managerToUsethis.persistenceUnitInfodeterminePersistenceUnitInfo(...)String rootPackagegetPersistenceProviderRootPackage(...)setPersistenceProviderPackageName(...)PersistenceProvider providercreateContainerEntityManagerFactory(...)String providerClassNamegetPersistenceProviderClassName(...)Class<?> providerClass/** Determine the PersistenceUnitInfo to use for the EntityManagerFactory ... */obtainPersistenceUnitInfo(...)obtainDefaultPersistenceUnitInfo(...)/** Hook method allowing subclasses to customize the EntityManagerFactory ... */getJtaDataSource(...)getNonJtaDataSource(...)getDefaultJtaDataSource(...)getDefaultDataSource(...)import Persistence/** Initialize the EntityManagerFactory for the given configuration. ... */createEntityManagerFactory(...)// Create EntityManagerFactory directly through PersistenceProvider.// Let JPA perform its standard PersistenceProvider autodetection.import ParameterModeimport StoredProcedureQuery/** Delegate for creating a shareable JPA {@link javax.persistence.EntityManager} ... */...[] NO_ENTITY_MANAGER_INTERFACES, ...;Map<Class<?>,Class<?>[]> cachedQueryInterfaces, ...;Set<String> transactionRequiringMethods, ...;Set<String> queryTerminatingMethods, ...;/** Create a transactional EntityManager proxy for the given EntityManagerFactory. ... */createSharedEntityManager(...)Class<?> emIfcentityManagerInterfaces.lengthnew SharedEntityManagerInvocationHandler(...)SharedEntityManagerCreator.class/** Invocation handler that delegates all calls to the current ... */EntityManagerFactory targetFactory, ...;Map<?,?> properties, ...;this.targetFactoryinitProxyClassLoader(...)boolean isNewEmQuery querynew DeferredQueryInvocationHandler(...)/** Invocation handler that handles deferred Query objects created by ... */Query target, ...;Map<Object,Object> outputParameters, ...;this.outputParametersParameterMode.OUTParameterMode.INOUTStoredProcedureQuery storedProcgetOutputParameterValue(...)// JPA 2.1 StoredProcedureQuery// Hibernate Query.list() method// Deliver toString without touching a target EntityManager.// JPA 2.0: return EntityManagerFactory without creating an EntityManager.// JPA 2.0: return EntityManagerFactory's CriteriaBuilder/Metamodel (avoid creation of EntityManager)// JPA 2.0: handle unwrap method - could be a proxy match.// Handle isOpen method: always return true.// Determine current EntityManager: either the transactional one// managed by the factory or a temporary one for the given invocation.// We need a transactional target now.// Still perform unwrap call on target EntityManager.// We need a transactional target now, according to the JPA spec.// Otherwise, the operation would get accepted but remain unflushed...// Regular EntityManager operations.// Invocation on Query interface coming in...// Invoke method on actual Query object.// Actual execution of the query: close the EntityManager right// afterwards, since that was the only reason we kept it open./** Package providing integration of JPA (Java Persistence API) with Spring concepts. ... */import ClassTransformer/** Simple adapter that implements the {@code java.lang.instrument.ClassFileTransformer} ... */ClassFileTransformerAdapter.classClassTransformer classTransformer, ...;boolean currentlyTransforming, ...;this.classTransformerthis.currentlyTransformingtransformed.lengthclassfileBuffer.lengthClassCircularityError ex// Defensively back out when called from within the transform delegate below:// in particular, for the over-eager transformer implementation in Hibernate 5.// The exception will be ignored by the class loader, anyway...import DataSourceLookupimport JndiDataSourceLookupimport MapDataSourceLookup/** Default implementation of the {@link PersistenceUnitManager} interface. ... */new HashMap<String,PersistenceUnitInfo>(...)new LinkedHashSet<AnnotationTypeFilter>(...)String CLASS_RESOURCE_PATTERN, ...;String DEFAULT_ORM_XML_RESOURCE, ...;String PERSISTENCE_XML_FILENAME, ...;String DEFAULT_PERSISTENCE_XML_LOCATION, ...;/** Default location of the {@code persistence.xml} file: ... */String ORIGINAL_DEFAULT_PERSISTENCE_UNIT_ROOT_LOCATION, ...;/** Default location for the persistence unit root URL: ... */String ORIGINAL_DEFAULT_PERSISTENCE_UNIT_NAME, ...;/** Default persistence unit name. */Set<AnnotationTypeFilter> entityTypeFilters, ...;...[] persistenceXmlLocations, ...;String defaultPersistenceUnitRootLocation, ...;String defaultPersistenceUnitName, ...;SharedCacheMode sharedCacheMode, ...;ValidationMode validationMode, ...;DataSource defaultDataSource, ...;DataSource defaultJtaDataSource, ...;...[] persistenceUnitPostProcessors, ...;Set<String> persistenceUnitInfoNames, ...;Map<String,PersistenceUnitInfo> persistenceUnitInfos, ...;/** Specify the location of the {@code persistence.xml} files to load. ... */this.persistenceXmlLocations/** Specify multiple locations of {@code persistence.xml} files to load. ... *//** Set the default persistence unit root location, to be applied ... */this.defaultPersistenceUnitRootLocation/** Specify the name of the default persistence unit, if any. Default is "default". ... */this.defaultPersistenceUnitName/** Specify the JPA 2.0 shared cache mode for all of this manager's persistence ... */this.sharedCacheMode/** Specify the JPA 2.0 validation mode for all of this manager's persistence ... *//** Specify the JDBC DataSources that the JPA persistence provider is supposed ... *//** Specify the JDBC DataSourceLookup that provides DataSources for the ... *//** Return the JDBC DataSourceLookup that provides DataSources for the ... *//** Specify the JDBC DataSource that the JPA persistence provider is supposed to use ... */this.defaultDataSource/** Return the JDBC DataSource that the JPA persistence provider is supposed to use ... */this.defaultJtaDataSource/** Return the JTA-aware DataSource that the JPA persistence provider is supposed to use ... *//** Set the PersistenceUnitPostProcessors to be applied to each ... */this.persistenceUnitPostProcessors/** Return the PersistenceUnitPostProcessors to be applied to each ... *//** Return the Spring LoadTimeWeaver to use for class instrumentation according ... */preparePersistenceUnitInfos(...)/** Prepare the PersistenceUnitInfos according to the configuration ... */List<SpringPersistenceUnitInfo> puisreadPersistenceUnitInfos(...)this.persistenceUnitInfoNamesthis.persistenceUnitInfosSpringPersistenceUnitInfo puigetPersistenceUnitRootUrl(...)setPersistenceUnitRootUrl(...)determineDefaultPersistenceUnitRootUrl(...)setJtaDataSource(...)setNonJtaDataSource(...)postProcessPersistenceUnitInfo(...)isPersistenceUnitOverrideAllowed(...)/** Read all persistence unit infos from {@code persistence.xml}, ... */List<SpringPersistenceUnitInfo> infosnew ArrayList<SpringPersistenceUnitInfo>(...)String defaultNameboolean buildDefaultUnitboolean foundDefaultUnitPersistenceUnitReader readernew PersistenceUnitReader(...)SpringPersistenceUnitInfo[] readInfosSpringPersistenceUnitInfo readInfobuildDefaultPersistenceUnitInfo(...)/** Perform Spring-based scanning for entity classes. ... */SpringPersistenceUnitInfo scannedUnitnew SpringPersistenceUnitInfo(...)setExcludeUnlistedClasses(...)scanPackage(...)String mappingFileNameaddMappingFileName(...)Resource ormXmlgetOrmXmlForDefaultPersistenceUnit(...)determinePersistenceUnitRootUrl(...)Set<String> managedPackagesaddManagedClassName(...)addManagedPackage(...)matchesFilter(...)/** Try to determine the persistence unit root URL based on the given ... *//** Determine JPA's default "META-INF/orm.xml" resource for use with Spring's default ... */Resource persistenceXml/** Return the specified PersistenceUnitInfo from this manager's cache ... *//** Hook method allowing subclasses to customize each PersistenceUnitInfo. ... */PersistenceUnitPostProcessor[] postProcessorsgetPersistenceUnitPostProcessors(...)PersistenceUnitPostProcessor postProcessor/** Return whether an override of a same-named persistence unit is allowed. ... */// Cannot resolve relative persistence.xml file - let's assume it's not there./** Spring's base implementation of the JPA ... */new ArrayList<URL>(...)SharedCacheMode.UNSPECIFIEDValidationMode.AUTOString persistenceProviderClassName, ...;PersistenceUnitTransactionType transactionType, ...;DataSource nonJtaDataSource, ...;DataSource jtaDataSource, ...;List<String> mappingFileNames, ...;List<URL> jarFileUrls, ...;URL persistenceUnitRootUrl, ...;List<String> managedClassNames, ...;List<String> managedPackages, ...;boolean excludeUnlistedClasses, ...;String persistenceXMLSchemaVersion, ...;String persistenceProviderPackageName, ...;this.persistenceProviderClassNamethis.transactionTypePersistenceUnitTransactionType.RESOURCE_LOCALthis.jtaDataSourcethis.nonJtaDataSourcethis.mappingFileNamesthis.jarFileUrlsthis.persistenceUnitRootUrl/** Add a managed class name to the persistence provider's metadata. ... */this.managedClassNames/** Add a managed package to the persistence provider's metadata. ... */this.managedPackagesthis.excludeUnlistedClassesthis.persistenceXMLSchemaVersionthis.persistenceProviderPackageName/** This implementation returns the default ClassLoader. ... *//** This implementation throws an UnsupportedOperationException. *//** Interface that defines an abstraction for finding and managing ... *//** Obtain the default PersistenceUnitInfo from this manager. ... *//** Obtain the specified PersistenceUnitInfo from this manager. ... *//** Callback interface for post-processing a JPA PersistenceUnitInfo. ... *//** Post-process the given PersistenceUnitInfo, for example registering ... *//** Internal helper class for reading JPA-compliant {@code persistence.xml} files. ... */PersistenceUnitReader.classString PERSISTENCE_VERSION, ...;String PERSISTENCE_UNIT, ...;String UNIT_NAME, ...;String MAPPING_FILE_NAME, ...;String JAR_FILE_URL, ...;String MANAGED_CLASS_NAME, ...;String PROPERTIES, ...;String PROVIDER, ...;String TRANSACTION_TYPE, ...;String JTA_DATA_SOURCE, ...;String NON_JTA_DATA_SOURCE, ...;String EXCLUDE_UNLISTED_CLASSES, ...;String SHARED_CACHE_MODE, ...;String VALIDATION_MODE, ...;String META_INF, ...;/** Create a new PersistenceUnitReader. ... *//** Parse and build all persistence unit infos defined in the specified XML file(s). ... *//** Parse and build all persistence unit infos defined in the given XML files. ... */ErrorHandler handlerDocument documentbuildDocument(...)parseDocument(...)new SpringPersistenceUnitInfo[]/** Validate the given stream and return a valid DOM document for parsing. */DocumentBuilderFactory dbfDocumentBuilder parser/** Parse the validated document and add entries to the given unit info list. */Element persistenceString versionURL rootUrlList<Element> unitsElement unitparsePersistenceUnitInfo(...)/** Parse the unit info DOM element. */SpringPersistenceUnitInfo unitInfoString txTypeString jtaDataSourceString nonJtaDataSourceElement excludeUnlistedClassesString cacheModeString validationModesetPersistenceXMLSchemaVersion(...)setTransactionType(...)setPersistenceProviderClassName(...)String excludeTextparseProperties(...)parseManagedClasses(...)parseMappingFiles(...)parseJarFiles(...)/** Parse the {@code property} XML elements. */Element propRootList<Element> propertiesElement property/** Parse the {@code class} XML elements. */List<Element> classes/** Parse the {@code mapping-file} XML elements. */List<Element> files/** Parse the {@code jar-file} XML elements. */List<Element> jarsaddJarFileUrl(...)/** Determine the persistence unit root URL based on the given resource ... */URL originalURLString urlToStringString persistenceUnitRoot// set JPA version (1.0 or 2.0)// set persistence unit root URL// set unit name// set transaction type// evaluate data sources// provider// exclude unlisted classes// set JPA 2.0 shared cache mode// set JPA 2.0 validation mode// relative to the persistence unit root, according to the JPA spec// If we get an archive, simply return the jar URL (section 6.2 from the JPA spec)// Check META-INF folder/** Extension of the standard JPA PersistenceUnitInfo interface, for advanced collaboration ... *//** Return a list of managed Java packages, to be introspected by the persistence provider. ... *//** Set the persistence provider's own package name, for exclusion from class transformation. ... *//** Subclass of {@link MutablePersistenceUnitInfo} that adds instrumentation hooks based on ... *//** Initialize this PersistenceUnitInfo with the LoadTimeWeaver SPI interface ... *//** Initialize this PersistenceUnitInfo with the current class loader ... *//** This implementation returns the LoadTimeWeaver's instrumentable ClassLoader, ... *//** This implementation delegates to the LoadTimeWeaver, if specified. */new ClassFileTransformerAdapter(...)ClassLoader tclString packageToExcludegetPersistenceProviderPackageName(...)/** Internal support for managing JPA persistence units. */EntityManagerFactory emFactory, ...;EntityManagerHolder emHolder, ...;this.emFactorythis.emHolderbindEntityManager(...)/** Servlet Filter that binds a JPA EntityManager to the thread for the ... */String DEFAULT_ENTITY_MANAGER_FACTORY_BEAN_NAME, ...;/** Default EntityManagerFactory bean name: "entityManagerFactory". ... */String entityManagerFactoryBeanName, ...;/** Set the bean name of the EntityManagerFactory to fetch from Spring's ... */this.entityManagerFactoryBeanName/** Return the bean name of the EntityManagerFactory to fetch from Spring's ... *//** Returns "false" so that the filter may re-bind the opened {@code EntityManager} ... *//** Returns "false" so that the filter may provide an {@code EntityManager} ... */lookupEntityManagerFactory(...)applyEntityManagerBindingInterceptor(...)/** Look up the EntityManagerFactory that this filter should use, ... *//** Look up the EntityManagerFactory that this filter should use. ... */String emfBeanNamegetEntityManagerFactoryBeanName(...)String puName/** Create a JPA EntityManager to be bound to a request. ... */// Do not modify the EntityManager: just set the participate flag.// Includes fallback search for single EntityManagerFactory bean by type.import EntityManagerFactoryAccessor/** Spring web request interceptor that binds a JPA EntityManager to the ... *//** Suffix that gets appended to the EntityManagerFactory toString ... */// Do not modify the EntityManager: just mark the request accordingly.import PersistenceContextimport PersistenceContextTypeimport PersistencePropertyimport PersistenceUnitimport EntityManagerFactoryInfoimport EntityManagerProxyimport ExtendedEntityManagerCreatorimport SharedEntityManagerCreator/** BeanPostProcessor that processes {@link javax.persistence.PersistenceUnit} ... */new ConcurrentHashMap<Object,EntityManager>(...)Object jndiEnvironment, ...;Map<String,String> persistenceUnits, ...;Map<String,String> persistenceContexts, ...;Map<String,String> extendedPersistenceContexts, ...;Map<Object,EntityManager> extendedEntityManagersToClose, ...;this.jndiEnvironment/** Specify the persistence units for EntityManagerFactory lookups, ... */this.persistenceUnits/** Specify the <i>transactional</i> persistence contexts for EntityManager lookups, ... */this.persistenceContexts/** Specify the <i>extended</i> persistence contexts for EntityManager lookups, ... */this.extendedPersistenceContexts/** Specify the default persistence unit name, to be used in case ... */findPersistenceMetadata(...)EntityManager emToClosethis.extendedEntityManagersToClosebuildPersistenceMetadata(...)PersistenceContext.classPersistenceUnit.classnew PersistenceElement(...)/** Return a specified persistence unit for the given unit name, ... */String unitNameForLookup/** Return a specified persistence context for the given unit name, as defined ... */Map<String,String> contexts/** Find an EntityManagerFactory with the given name in the current Spring ... */findNamedEntityManagerFactory(...)findDefaultEntityManagerFactory(...)/** Find an EntityManagerFactory with the given name in the current ... *//** Find a single default EntityManagerFactory in the Spring application context. ... */NamedBeanHolder<EntityManagerFactory> emfHolder/** Perform a JNDI lookup for the given resource by name. ... */new LocatorDelegate(...)/** Separate inner class to isolate the JNDI API dependency ... */JndiLocatorDelegate locatorString unitName, ...;PersistenceContextType type, ...;PersistenceContext pcPersistenceUnit puPersistenceProperty[] ppsproperties(...)PersistenceProperty ppthis.unitNameunitName(...)synchronization(...)/** Resolve the object against the application context. */resolveExtendedEntityManager(...)resolveEntityManager(...)PersistenceContextType.EXTENDEDresolveEntityManagerFactory(...)getPersistenceUnit(...)getPersistenceContext(...)// Fancy variant with dependency registration// Plain variant: just find a default bean// Resolves to EntityManagerFactory or EntityManager.// OK, so we need an EntityManagerFactory...// Obtain EntityManagerFactory from JNDI?// Need to search for EntityManagerFactory beans.// Obtain EntityManager reference from JNDI?// No pre-built EntityManager found -> build one based on factory.// Inject a shared transactional EntityManager proxy.// Create EntityManager based on the info's vendor-specific type// (which might be more specific than the field's type).// Create EntityManager based on the field's type.// Inject a container-managed extended EntityManager./** {@link FactoryBean} that exposes a shared JPA {@link javax.persistence.EntityManager} ... */EntityManager shared, ...;/** Specify the EntityManager interface to expose. ... *//** Set whether to automatically join ongoing transactions (according ... *//** Classes supporting the {@code org.springframework.orm.jpa} package. */import JpaDialectimport JpaVendorAdapter/** Abstract {@link JpaVendorAdapter} implementation that defines common properties, ... */Database.DEFAULTDatabase database, ...;String databasePlatform, ...;boolean generateDdl, ...;boolean showSql, ...;/** Specify the target database to operate on, as a value of the {@code Database} enum: ... */this.database/** Return the target database to operate on. *//** Specify the name of the target database to operate on. ... */this.databasePlatform/** Return the name of the target database to operate on. *//** Set whether to generate DDL after the EntityManagerFactory has been initialized, ... */this.generateDdl/** Return whether to generate DDL after the EntityManagerFactory has been initialized ... *//** Set whether to show SQL in the log (or in the console). ... */this.showSql/** Return whether to show SQL in the log (or in the console). *//** Enumeration for common database platforms. Allows strong typing of database type ... */new Database(...)Database DEFAULT, ...;Database DB2, ...;Database DERBY, ...;Database H2, ...;Database HANA, ...;Database HSQL, ...;Database INFORMIX, ...;Database MYSQL, ...;Database ORACLE, ...;Database POSTGRESQL, ...;Database SQL_SERVER, ...;Database SYBASE, ...;import UnitOfWorkimport DefaultJpaDialect/** {@link org.springframework.orm.jpa.JpaDialect} implementation for Eclipse ... */boolean lazyDatabaseTransaction, ...;/** Set whether to lazily start a database resource transaction within a ... */this.lazyDatabaseTransactionUnitOfWork uowUnitOfWork.classbeginEarlyTransaction(...)new EclipseLinkConnectionHandle(...)/** {@link ConnectionHandle} implementation that lazily fetches an ... */// Pass custom isolation level on to EclipseLink's DatabaseLogin configuration// (since Spring 4.1.2)// Begin an early transaction to force EclipseLink to get a JDBC Connection// so that Spring can manage transactions with JDBC as well as EclipseLink.// As of Spring 4.1.2, we're using a custom ConnectionHandle for lazy retrieval// of the underlying Connection (allowing for deferred internal transaction begin// within the EclipseLink EntityManager)import PersistenceUnitPropertiesimport TargetDatabaseimport JpaEntityManager/** {@link org.springframework.orm.jpa.JpaVendorAdapter} implementation for Eclipse ... */new PersistenceProvider(...)new EclipseLinkJpaDialect(...)EclipseLinkJpaDialect jpaDialect, ...;Map<String,Object> jpaPropertiesgetDatabasePlatform(...)PersistenceUnitProperties.TARGET_DATABASEString targetDatabasedetermineTargetDatabaseName(...)isGenerateDdl(...)PersistenceUnitProperties.DDL_GENERATIONPersistenceUnitProperties.CREATE_ONLYPersistenceUnitProperties.DDL_GENERATION_MODEPersistenceUnitProperties.DDL_DATABASE_GENERATIONisShowSql(...)PersistenceUnitProperties.CATEGORY_LOGGING_LEVEL_SessionLog.SQLPersistenceUnitProperties.LOGGING_PARAMETERS/** Determine the EclipseLink target database name for the given database. ... */TargetDatabase.DB2TargetDatabase.DerbyTargetDatabase.HANATargetDatabase.HSQLTargetDatabase.InformixTargetDatabase.MySQLTargetDatabase.OracleTargetDatabase.PostgreSQLTargetDatabase.SQLServerTargetDatabase.SybaseJpaEntityManager.classimport JpaSystemException/** {@link org.springframework.orm.jpa.JpaDialect} implementation for ... */Connection preparedConFlushMode previousFlushModeprepareFlushMode(...)getTimeout(...)isLocalResource(...)new SessionTransactionData(...)resetSessionState(...)new HibernateConnectionHandle(...)UnresolvableObjectException hibExnew ObjectRetrievalFailureException(...)WrongClassException hibExStaleObjectStateException hibExnew ObjectOptimisticLockingFailureException(...)SessionImplementor session, ...;setFlushMode(...)Connection conToReset// Standard JPA transaction begin call for full JPA context setup...// Adapt flush mode and store previous isolation level, if any.// As of 5.1, we explicitly optimize for a transaction-local EntityManager,// aligned with native HibernateTransactionManager behavior.// We should suppress flushing for a read-only transaction.// No FlushMode change needed...// end of JDBCException subclass handling/** Simple {@code FactoryBean} that exposes the underlying {@link SessionFactory} ... */Method getSessionFactoryimport DB2Dialectimport DerbyTenSevenDialectimport H2Dialectimport HANAColumnStoreDialectimport HSQLDialectimport Informix10Dialectimport MySQL57Dialectimport Oracle12cDialectimport PostgreSQL95Dialectimport SQLServer2012Dialectimport SybaseDialect/** {@link org.springframework.orm.jpa.JpaVendorAdapter} implementation for Hibernate ... */new HibernateJpaDialect(...)HibernateJpaDialect jpaDialect, ...;new SpringHibernateJpaPersistenceProvider(...)setPrepareConnection(...)buildJpaPropertyMap(...)this.jpaDialect.prepareConnectionAvailableSettings.DIALECTClass<?> databaseDialectClassdetermineDatabaseDialectClass(...)AvailableSettings.HBM2DDL_AUTOAvailableSettings.SHOW_SQL/** Determine the Hibernate database dialect class for the given target database. ... */DB2Dialect.classDerbyTenSevenDialect.classH2Dialect.classHANAColumnStoreDialect.classHSQLDialect.classInformix10Dialect.classMySQL57Dialect.classOracle12cDialect.classPostgreSQL95Dialect.classSQLServer2012Dialect.classSybaseDialect.class// as of Spring 5.3import HibernatePersistenceProviderimport EntityManagerFactoryBuilderImplimport PersistenceUnitInfoDescriptor/** Spring-specific subclass of the standard {@link HibernatePersistenceProvider} ... */List<String> mergedClassesAndPackagesgetManagedClassNames(...)getManagedPackages(...)new EntityManagerFactoryBuilderImpl(...)new PersistenceUnitInfoDescriptor(...) { ... }/** Support classes for adapting to specific JPA vendors. *//** Root package for Spring's O/R Mapping integration classes. ... */import FlushModeTypeimport DriversLicense/** Integration tests for LocalContainerEntityManagerFactoryBean. ... */EntityManagerFactoryInfo emficountRowsInTable(...)testJdbcTx2(...)Query qgetResultList(...)Person notTheregetFirstName(...)Person tonyPerson newTonysetDriversLicense(...)new DriversLicense(...)setComplete(...)endTransaction(...)startNewTransaction(...)getDriversLicense(...)getSerialNumber(...)deleteFromTables(...)String firstNameList<Person> peopleinsertPerson(...)String INSERT_PERSONtestInstantiateAndSave(...)NoResultException.classgetSingleResult(...)this.sharedEntityManagerFlushModeType.AUTOQuery q2// required in OpenJPA case// We may get here (as with Hibernate). Either behaviour is valid:// throw exception on first access or on getReference itself.// Add with JDBC// We would typically expect an IllegalStateException, but Hibernate throws a// PersistenceException. So we assert the contents of the exception message instead./** Superclass for unit tests for EntityManagerFactory-creating beans. ... */EntityManagerFactory mockEmf, ...;Object gotObjectEntityManagerFactory emf, ...;this.emf...[] ECLIPSELINK_CONFIG_LOCATIONS, ...;EntityManager sharedEntityManager, ...;TransactionStatus transactionStatus, ...;boolean complete, ...;boolean zappedTables, ...;autowireBean(...)this.transactionStatusisCompleted(...)this.zappedTablesthis.completeboolean commitString tableNamecreateNativeQuery(...)/** An application-managed entity manager can join an existing transaction, ... */doInstantiateAndSave(...)TransactionRequiredException.classdeleteAllPeopleUsingEntityManager(...)testStateClean(...)// TODO following lines are a workaround for Hibernate bug// If Hibernate throws an exception due to flush(),// it actually HAS flushed, meaning that the database// was updated outside the transaction// Call any method: should cause automatic tx invocation// Should rollback// Now clean up the database/** Integration tests using in-memory database for container-managed JPA ... */doTestExceptionTranslationWithDialectFound(...)RuntimeException in1PersistenceException in2DataAccessException dex// This would be legal, at least if not actually _starting_ a tx/* See comments in spec on EntityManager.joinTransaction(). ... *///assertFalse(em.getTransaction().isActive());//assertTrue(em.getTransaction().isActive());JpaDialect dialect, ...;DefaultTransactionDefinition definitionTransactionDefinition definitionEntityManager entityManagerEntityTransaction entityTxEntityTransaction.classOptimisticLockException exnew OptimisticLockException(...)DummyEntityManagerFactoryBean demfnew DummyEntityManagerFactoryBean(...)checkInvariants(...)// Should trigger close method expected by EntityManagerFactory mock/* Test method for ... */EntityManagerFactory factoryEntityManager managerIllegalStateException iseIllegalArgumentException iae/** We do not convert unknown exceptions. They may result from user code. */UnsupportedOperationException userRuntimeExceptionEntityNotFoundException entityNotFoundnew EntityNotFoundException(...)NoResultException noResultnew NoResultException(...)NonUniqueResultException nonUniqueResultnew NonUniqueResultException(...)OptimisticLockException optimisticLockEntityExistsException entityExistsnew EntityExistsException(...)TransactionRequiredException transactionRequiredPersistenceException unknownnew PersistenceException(...) { ... }JpaObjectRetrievalFailureException.classEmptyResultDataAccessException.classJpaOptimisticLockingFailureException.classJpaSystemException.class// test null assertion// no tx activeimport TransactionCallbackEntityManagerFactory factory, ...;EntityManager manager, ...;EntityTransaction tx, ...;JpaTransactionManager tm, ...;TransactionTemplate tt, ...;new JpaTransactionManager(...)List<String> lnew TransactionCallback<>(...) { ... }new RollbackException(...)TransactionSystemException tseRollbackException.classEntityManager manager2EntityTransaction tx2InvalidIsolationLevelException.classimport ProviderUtilimport MutablePersistenceUnitInfoimport DefaultTransactionAttributeMap<> actualProps, ...;// Static fields set by inner class DummyPersistenceProviderPersistenceUnitInfo actualPui, ...;parseValidPersistenceUnit(...)LocalContainerEntityManagerFactoryBean cefbObject testEntityEntityManager mockEmEntityTransaction mockTxEntityManager sharedEmJpaTransactionManager jpatmTransactionStatus txStatusnew DefaultTransactionAttribute(...)new NoOpEntityTransaction(...)OptimisticLockingFailureException.classMutablePersistenceUnitInfo puiLocalContainerEntityManagerFactoryBean emfbcreateEntityManagerFactoryBean(...)LocalContainerEntityManagerFactoryBean containerEmfbnew LocalContainerEntityManagerFactoryBean(...)setPersistenceProviderClass(...)DummyContainerPersistenceProvider.classsetJpaProperties(...)String entityManagerName// JPA 2.1 method// This one's for the tx (shared)// This is the application-specific one// This will be set by DummyPersistenceProvider//checkInvariants(containerEmfb);//containerEmfb.destroy();//emfMc.verify();testValidUsage(...)LocalEntityManagerFactoryBean lemfbnew LocalEntityManagerFactoryBean(...)DummyPersistenceProvider.classimport static Mockito.withSettings/** Unit tests for {@link SharedEntityManagerCreator}. ... */extraInterfaces(...)withSettings(...)EntityManager targetEmQuery.classgetResultStream(...)StoredProcedureQuery queryStoredProcedureQuery.classStoredProcedureQuery spqcreateStoredProcedureQuery(...)registerStoredProcedureParameter(...)ParameterMode.IN// EntityManagerFactoryInfo.getEntityManagerInterface returns nullimport Idimport TableString serial_number, ...;this.serial_numberimport Basicimport CascadeTypeimport EntityListenersimport FetchTypeimport GeneratedValueimport GenerationTypeimport JoinColumnimport OneToOne/** Simple JavaBean domain object representing an person. ... */PersonListener.classGenerationType.AUTODriversLicense driversLicense, ...;// Lazy relationship to force use of instrumentation in JPA implementation.FetchType.LAZYCascadeType.PERSISTString first_name, ...;String last_name, ...;ApplicationContext postLoaded, ...;this.first_namethis.last_namethis.driversLicenseimport PostLoadperson.postLoadedimport AbstractContainerEntityManagerFactoryIntegrationTests/** EclipseLink-specific JPA tests. ... */JpaEntityManager eclipselinkEntityManagergetActiveSession(...)/** Hibernate-specific JPA tests. ... */EntityManager proxyHibernateEntityManager.classisDefaultReadOnly(...)// as of Hibernate 5.2// SPR-16956/** Hibernate-specific JPA tests with multiple EntityManagerFactory instances. ... */EntityManagerFactory entityManagerFactory2, ...;this.entityManagerFactory2/** Hibernate-specific JPA tests with native SessionFactory setup and getCurrentSession interaction. ... */get(...).postLoadedQuery<> qimport ManagedBeanRegistryimport AbstractEntityManagerFactoryIntegrationTestsimport BeanSourceimport MultiplePrototypesInSpringContextTestBeanimport NoDefinitionInSpringContextTestBeanimport SinglePrototypeInSpringContextTestBean/** Hibernate-specific SpringBeanContainer integration tests. ... */ServiceRegistry serviceRegistrygetSessionFactoryOptions(...)requireService(...)ManagedBeanRegistry.classgetBeanContainer(...)getManagedBeanRegistry(...)BeanContainer beanContainerContainedBean<SinglePrototypeInSpringContextTestBean> beanSinglePrototypeInSpringContextTestBean.classJpaLifecycleOptions.INSTANCEIneffectiveBeanInstanceProducer.INSTANCESinglePrototypeInSpringContextTestBean instanceContainedBean<MultiplePrototypesInSpringContextTestBean> beanMultiplePrototypesInSpringContextTestBean.classMultiplePrototypesInSpringContextTestBean instanceNativeLifecycleOptions.INSTANCEContainedBean<SinglePrototypeInSpringContextTestBean> bean2SinglePrototypeInSpringContextTestBean instance2ContainedBean<MultiplePrototypesInSpringContextTestBean> bean2MultiplePrototypesInSpringContextTestBean instance2NoDefinitionInSpringContextTestBeanInstanceProducer fallbackProducernew NoDefinitionInSpringContextTestBeanInstanceProducer(...)ContainedBean<NoDefinitionInSpringContextTestBean> beanNoDefinitionInSpringContextTestBean.classNoDefinitionInSpringContextTestBean instancecurrentUnnamedInstantiationCount(...)currentNamedInstantiationCount(...)BeanSource.FALLBACKAttributeConverter<>.class/** The lifecycle options mandated by the JPA spec and used as a default in Hibernate ORM. */BeanContainer.LifecycleOptionsnew JpaLifecycleOptions(...)JpaLifecycleOptions INSTANCE, ...;/** The lifecycle options used by libraries integrating into Hibernate ORM ... */new NativeLifecycleOptions(...)NativeLifecycleOptions INSTANCE, ...;new IneffectiveBeanInstanceProducer(...)IneffectiveBeanInstanceProducer INSTANCE, ...;int unnamedInstantiationCount, ...;int namedInstantiationCount, ...;new NoDefinitionInSpringContextTestBean(...)RuntimeException e// Due to the lifecycle options, and because the bean has the "prototype" scope, we should not return the same instance/* We only expect to ever be asked to instantiate this class, so we just cut corners here. ... */new BeanSource(...)BeanSource SPRING, ...;BeanSource FALLBACK, ...;/* Expect instantiation through a non-default constructor, just to be sure that Spring will fail if it tries to instantiate it, ... */BeanSource source, ...;/** Tests for {@link DefaultPersistenceUnitManager}. ... */DefaultPersistenceUnitManager manager, ...;testDefaultDomain(...)SpringPersistenceUnitInfo puInfoimport SimpleNamingContextBuilder/** Unit and integration tests for the JPA XML resource parsing support. ... */PersistenceUnitInfo[] infogetJarFileUrls(...)excludeUnlistedClasses(...)getMappingFileNames(...)emptyActivatedContextBuilder(...)MapDataSourceLookup dataSourceLookupPersistenceUnitInfo pu1PersistenceUnitInfo pu2ClassPathResource archiveString newRootResource insideArchivesameFile(...)PersistenceUnitInfo noExcludePersistenceUnitInfo emptyExcludePersistenceUnitInfo trueExcludePersistenceUnitInfo falseExclude// the following assertions fail only during coverage runs// assertEquals(1, pu2.getJarFileUrls().size());// assertEquals(new ClassPathResource("order-supplemental.jar").getURL(), pu2.getJarFileUrls().get(0));// make sure the location actually existsimport AsyncEventimport AsyncListenerimport ServletWebRequestimport AsyncWebRequestimport StandardServletAsyncWebRequestimport MockAsyncContextimport MockFilterConfigimport MockHttpServletResponseimport PassThroughFilterChainnew TestTaskExecutor(...)MockHttpServletRequest request, ...;MockHttpServletResponse response, ...;ServletWebRequest webRequest, ...;TestTaskExecutor taskExecutor, ...;this.requestsetAsyncSupported(...)new MockHttpServletResponse(...)this.webRequestnew ServletWebRequest(...)OpenEntityManagerInViewInterceptor interceptornew OpenEntityManagerInViewInterceptor(...)MockServletContext scpostHandle(...)AsyncWebRequest asyncWebRequestnew StandardServletAsyncWebRequest(...)setAsyncWebRequest(...)startCallableProcessing(...)getConcurrentResult(...)afterConcurrentHandlingStarted(...)clearConcurrentResult(...)MockAsyncContext asyncContextgetAsyncContext(...)AsyncListener listenergetListeners(...)onTimeout(...)new AsyncEvent(...)EntityManagerFactory factory2StaticWebApplicationContext wacMockHttpServletResponse responseMockFilterConfig filterConfignew MockFilterConfig(...)MockFilterConfig filterConfig2OpenEntityManagerInViewFilter filternew OpenEntityManagerInViewFilter(...)OpenEntityManagerInViewFilter filter2FilterChain filterChainnew FilterChain(...) { ... }FilterChain filterChain2FilterChain filterChain3new PassThroughFilterChain(...)WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTEAtomicInteger count2AsyncWebRequest.classaddCompletionHandler(...)addTimeoutHandler(...)startAsync(...)Runnable decoratedTask// check that further invocations simply participate// Initial request thread// Async dispatch thread// Async request timeout// Async request error// Async dispatch after concurrent handling produces result ...import JpaTransactionManagerEntityManagerHoldingBean bean, ...;JpaTransactionManager tmPersistenceAnnotationBeanPostProcessor pabppnew PersistenceAnnotationBeanPostProcessor(...) { ... }new EntityManagerHoldingBean(...)new TransactionCallback<Object>(...) { ... }bean.sharedEntityManagerbean.extendedEntityManagerbean.sharedEntityManagerUnsynchronizedbean.extendedEntityManagerUnsynchronizedEntityManager extendedEntityManager, ...;EntityManager sharedEntityManagerUnsynchronized, ...;EntityManager extendedEntityManagerUnsynchronized, ...;import DefaultPublicPersistenceContextSetterimport DefaultPublicPersistenceUnitSetterNamedPersonDefaultPublicPersistenceContextSetter defaultSetterInjected, ...;DefaultPublicPersistenceUnitSetterNamedPerson namedSetterInjected, ...;import AbstractEntityManagerFactoryBeanTests/** Unit tests for persistence context and persistence unit injection. ... */GenericApplicationContext gacDefaultPrivatePersistenceContextField beanDefaultPrivatePersistenceContextField.classFactoryBeanWithPersistenceContextField bean2FactoryBeanWithPersistenceContextField.classserializable(...)PersistenceAnnotationBeanPostProcessor.classbean.embean2.emDefaultVendorSpecificPrivatePersistenceContextField beanDefaultVendorSpecificPrivatePersistenceContextField.classDefaultPublicPersistenceContextSetter beanDefaultPublicPersistenceContextSetter.classEntityManagerFactory mockEmf2EntityManager mockEm2SpecificPublicPersistenceContextSetter beanSpecificPublicPersistenceContextSetter.classDefaultPrivatePersistenceContextField existingBean1new DefaultPrivatePersistenceContextField(...)DefaultPublicPersistenceContextSetter existingBean2new DefaultPublicPersistenceContextSetter(...)existingBean1.emexistingBean2.emDummyInvocationHandler ihnew DummyInvocationHandler(...)Object mockEmSimpleMapScope myScopeSimpleMapScope serializedDummyInvocationHandler.closedEntityManagerFactoryWithInfo mockEmfEntityManagerFactoryWithInfo.classDefaultPrivatePersistenceUnitField beanDefaultPrivatePersistenceUnitField.classbean.emfDefaultPublicPersistenceUnitSetter beanDefaultPublicPersistenceUnitSetter.classRootBeanDefinition processorDefDefaultPublicPersistenceUnitSetterNamedPerson bean2DefaultPublicPersistenceUnitSetterNamedPerson.classbean2.emfEntityManagerFactoryWithInfo mockEmf2Map<String,String> persistenceUnitsExpectedLookupTemplate jtPersistenceAnnotationBeanPostProcessor bppnew PersistenceAnnotationBeanPostProcessor(...)DefaultPrivatePersistenceContextField bean3DefaultPublicPersistenceContextSetter bean4setPersistenceUnits(...)bean3.embean4.emEntityManager mockEm3Map<String,String> persistenceContextsMap<String,String> extendedPersistenceContextsDefaultPrivatePersistenceContextField bean1DefaultPrivatePersistenceContextFieldNamedPerson bean2DefaultPrivatePersistenceContextFieldNamedPerson.classDefaultPublicPersistenceContextSetter bean3setPersistenceContexts(...)setExtendedPersistenceContexts(...)bean1.emDefaultPublicPersistenceContextSetter bean2new FieldOfWrongTypeAnnotatedWithPersistenceUnit(...)new SetterOfWrongTypeAnnotatedWithPersistenceUnit(...)new SetterWithNoArgs(...)new MockPersistenceAnnotationBeanPostProcessor(...)DefaultPrivatePersistenceContextFieldExtended dppcfnew DefaultPrivatePersistenceContextFieldExtended(...)dppcf.emDefaultPrivatePersistenceContextFieldExtendedWithProps dppcfnew DefaultPrivatePersistenceContextFieldExtendedWithProps(...)DefaultPrivatePersistenceContextFieldWithProperties transactionalFieldnew DefaultPrivatePersistenceContextFieldWithProperties(...)transactionalField.em/** Binds an EMF to the thread and tests if EM with different properties ... */DefaultPrivatePersistenceContextFieldWithProperties transactionalFieldWithPropertiesDefaultPrivatePersistenceContextField transactionalFieldtransactionalFieldWithProperties.emEntityManager em, ...;HibernateEntityManager em, ...;this.emsetEntityManager(...)String thisFieldIsOfTheWrongType, ...;// only one call made  - the first EM definition wins (in this case the one w/ the properties)// the EM w/ properties will be created// bind em to the thread now since it's created// only one call made  - the first EM definition wins (in this case the one w/o the properties)// the EM w/o properties will be createdEntityManagerFactory mockEmfSharedEntityManagerBean proxyFactoryBeannew SharedEntityManagerBean(...)EntityManagerProxy emProxyimport XmlAccessTypeimport XmlAccessorTypeimport XmlType/** <p>Java class for flightType complex type. ... */XmlAccessType.FIELDlong number, ...;/** Gets the value of the number property. *//** Sets the value of the number property. */// This file was generated by the JavaTM Architecture for XML Binding(JAXB) Reference Implementation, v2.3.1 // See <a href="https://javaee.github.io/jaxb-v2/">https://javaee.github.io/jaxb-v2/</a> // Any modifications to this file will be lost upon recompilation of the source schema. // Generated on: 2021.06.20 at 02:15:16 PM CDT import XmlElement/** <p>Java class for anonymous complex type. ... */List<FlightType> flight, ...;/** Gets the value of the flight property. ... */new ArrayList<FlightType>(...)this.flightimport JAXBElementimport XmlElementDeclimport XmlRegistry/** This object contains factory methods for each ... */QName _Flight_QNAME, ...;/** Create a new ObjectFactory that can be used to create new instances of schema derived classes for package: org.springframework.oxm.jaxb.test *//** Create an instance of {@link Flights } */new Flights(...)/** Create an instance of {@link FlightType } */new FlightType(...)/** Create an instance of {@link JAXBElement }{@code <}{@link FlightType }{@code >} ... */new JAXBElement<FlightType>(...)FlightType.class/** Subinterface of {@link Marshaller} that has support for Java 5 generics. ... *//** Indicates whether this marshaller can marshal instances of the supplied generic type. ... *//** Subinterface of {@link Unmarshaller} that has support for Java 5 generics. ... *//** Defines the contract for Object XML Mapping Marshallers. Implementations of this interface ... *//** Indicate whether this marshaller can marshal instances of the supplied type. ... *//** Marshal the object graph with the given root into the provided {@link Result}. ... *//** Base class for exception thrown when a marshalling or unmarshalling error occurs. ... *//** Construct a {@code MarshallingException} with the specified detail message. ... *//** Construct a {@code MarshallingException} with the specified detail message ... *//** Exception thrown on marshalling failure. ... *//** Construct a {@code MarshallingFailureException} with the specified detail message. ... *//** Construct a {@code MarshallingFailureException} with the specified detail message ... *//** Exception that indicates that the cause cannot be distinguished further. ... *//** Construct an {@code UncategorizedMappingException} with the specified detail message ... *//** Defines the contract for Object XML Mapping unmarshallers. Implementations of this ... *//** Indicate whether this unmarshaller can unmarshal instances of the supplied type. ... *//** Unmarshal the given {@link Source} into an object graph. ... *//** Exception thrown on unmarshalling failure. ... *//** Exception thrown on marshalling validation failure. ... *//** Construct a {@code ValidationFailureException} with the specified detail message. ... *//** Construct a {@code ValidationFailureException} with the specified detail message ... *//** Root of the hierarchy of Object XML Mapping exceptions. ... *//** Construct an {@code XmlMappingException} with the specified detail message. ... *//** Construct an {@code XmlMappingException} with the specified detail message ... *//** Parser for the {@code <oxm:jaxb2-marshaller/>} element. ... */String contextPathManagedList<String> classesToBeBoundElement classToBeBound/** Parser for the {@code <oxm:jibx-marshaller/>} element. ... *//** {@link NamespaceHandler} for the '{@code oxm}' namespace. ... */new Jaxb2MarshallerBeanDefinitionParser(...)new JibxMarshallerBeanDefinitionParser(...)/** Provides an namespace handler for the Spring Object/XML namespace. */import XmlEnumimport XmlSeeAlsoimport UncategorizedMappingException/** Helper class for {@link Jaxb2Marshaller} that scans given packages for classes marked with JAXB2 annotations. ... */XmlRootElement.classXmlType.classXmlSeeAlso.classXmlEnum.classXmlRegistry.class...[] JAXB2_TYPE_FILTERS, ...;/** Scan the packages for classes marked with JAXB2 annotations. ... */List<Class<?>> jaxb2ClassesString packageToScanisJaxb2Class(...)Class<?> jaxb2AnnotatedClassnew UncategorizedMappingException(...)import URLEncoderimport JAXBContextimport JAXBExceptionimport ValidationEventHandlerimport XmlAdapterimport AttachmentMarshallerimport AttachmentUnmarshallerimport XMLGregorianCalendarimport Schemaimport SchemaFactoryimport LSResourceResolverimport GenericMarshallerimport GenericUnmarshallerimport MarshallingFailureExceptionimport UnmarshallingFailureExceptionimport ValidationFailureExceptionimport MimeContainerimport MimeMarshallerimport MimeUnmarshallerimport SaxResourceUtilsimport StaxUtils/** Implementation of the {@code GenericMarshaller} interface for JAXB 2.2. ... */XMLConstants.W3C_XML_SCHEMA_NS_URIString CID, ...;EntityResolver NO_OP_ENTITY_RESOLVER, ...;String contextPath, ...;...[] classesToBeBound, ...;Map<String,?> jaxbContextProperties, ...;Map<String,?> marshallerProperties, ...;Map<String,?> unmarshallerProperties, ...;Marshaller.Listener marshallerListener, ...;Marshaller.ListenerUnmarshaller.Listener unmarshallerListener, ...;Unmarshaller.ListenerValidationEventHandler validationEventHandler, ...;...[] adapters, ...;...[] schemaResources, ...;String schemaLanguage, ...;LSResourceResolver schemaResourceResolver, ...;boolean mtomEnabled, ...;boolean supportJaxbElementClass, ...;boolean checkForXmlRootElement, ...;Class<?> mappedClass, ...;Object jaxbContextMonitor, ...;JAXBContext jaxbContext, ...;Schema schema, ...;boolean supportDtd, ...;boolean processExternalEntities, ...;/** Set multiple JAXB context paths. The given array of context paths gets ... */this.contextPath/** Set a JAXB context path. ... *//** Return the JAXB context path. *//** Set the list of Java classes to be recognized by a newly created JAXBContext. ... */this.classesToBeBound/** Return the list of Java classes to be recognized by a newly created JAXBContext. *//** Set the packages to search for classes with JAXB2 annotations in the classpath. ... *//** Return the packages to search for JAXB2 annotations. *//** Set the {@code JAXBContext} properties. These implementation-specific ... */this.jaxbContextProperties/** Set the JAXB {@code Marshaller} properties. ... */this.marshallerProperties/** Set the JAXB {@code Unmarshaller} properties. ... */this.unmarshallerProperties/** Specify the {@code Marshaller.Listener} to be registered with the JAXB {@code Marshaller}. */this.marshallerListener/** Set the {@code Unmarshaller.Listener} to be registered with the JAXB {@code Unmarshaller}. */this.unmarshallerListener/** Set the JAXB validation event handler. This event handler will be called by JAXB ... */this.validationEventHandler/** Specify the {@code XmlAdapter}s to be registered with the JAXB {@code Marshaller} ... *//** Set the schema resource to use for validation. */this.schemaResources/** Set the schema resources to use for validation. *//** Set the schema language. ... */this.schemaLanguage/** Set the resource resolver, as used to load the schema resources. ... */this.schemaResourceResolver/** Set whether to lazily initialize the {@link JAXBContext} for this marshaller. ... *//** Specify whether MTOM support should be enabled or not. ... */this.mtomEnabled/** Specify whether the {@link #supports(Class)} returns {@code true} for the ... */this.supportJaxbElementClass/** Specify whether the {@link #supports(Class)} should check for ... */this.checkForXmlRootElement/** Specify a JAXB mapped class for partial unmarshalling. ... *//** Indicate whether DTD parsing should be supported. ... */this.supportDtd/** Return whether DTD parsing is supported. *//** Indicate whether external XML entities are processed when unmarshalling. ... */this.processExternalEntities/** Return whether XML external entities are allowed. */boolean hasContextPathboolean hasClassesToBeBoundboolean hasPackagesToScangetJaxbContext(...)loadSchema(...)/** Return the JAXBContext used by this marshaller, lazily building it if necessary. */JAXBContext contextthis.jaxbContextthis.jaxbContextMonitorcreateJaxbContextFromContextPath(...)createJaxbContextFromClasses(...)createJaxbContextFromPackages(...)JAXBException exconvertJaxbException(...)ClassPathJaxb2TypeScanner scannernew ClassPathJaxb2TypeScanner(...)Class<?>[] jaxb2ClassesSource[] schemaSourcesnew Source[]XMLReader xmlReaderSchemaFactory schemaFactorycreateInputSource(...)setResourceResolver(...)newSchema(...)supportsInternal(...)JAXBElement<>.classClass<?> classArgumentisStandardClass(...)GenericArrayType arrayTypeString[] contextPaths/** Checks whether the given type is a primitive wrapper type. ... *//** Checks whether the given type is a standard class. ... */XMLGregorianCalendar.classImage.classDataHandler.class// MarshallingMarshaller marshallercreateMarshaller(...)setAttachmentMarshaller(...)new Jaxb2AttachmentMarshaller(...)marshalStaxResult(...)/** Return a newly created JAXB marshaller. ... */initJaxbMarshaller(...)/** Template method that can be overridden by concrete JAXB marshallers ... */setListener(...)setEventHandler(...)XmlAdapter<?,?> adaptersetAdapter(...)// UnmarshallingprocessSource(...)Unmarshaller unmarshallercreateUnmarshaller(...)setAttachmentUnmarshaller(...)new Jaxb2AttachmentUnmarshaller(...)unmarshalStaxSource(...)isSupportDtd(...)new UnmarshallingFailureException(...)/** Return a newly created JAXB unmarshaller. ... */initJaxbUnmarshaller(...)SAXSource saxSourcegetXMLReader(...)getInputSource(...)StreamSource streamSourceisProcessExternalEntities(...)/** Convert the given {@code JAXBException} to an appropriate exception ... */new ValidationFailureException(...)new MarshallingFailureException(...)MimeContainer mimeContainer, ...;this.mimeContainerByteArrayDataSource dataSourcenew ByteArrayDataSource(...)addMtomAttachment(...)String contentIdconvertToXopPackage(...)DataHandler dataHandlergetAttachmentAsDataHandler(...)getAttachment(...)isXopPackage(...)/** DataSource that wraps around a byte array. */int offset, ...;this.offset// analogous to the JAXBContext.newInstance(String) implementation// Source and subclasses should be supported according to the JAXB2 spec, but aren't in the RI// Source.class.isAssignableFrom(clazz) ||/** Package providing integration of <a href="https://java.sun.com/webservices/jaxb/">JAXB</a> ... */import BindingDirectoryimport IBindingFactoryimport IMarshallingContextimport IUnmarshallingContextimport IXMLReaderimport IXMLWriterimport JiBXExceptionimport MarshallingContextimport StAXReaderWrapperimport StAXWriterimport UnmarshallingContextimport AbstractMarshaller/** Implementation of the {@code Marshaller} and {@code Unmarshaller} interfaces for JiBX. ... */String DEFAULT_BINDING_NAME, ...;String targetPackage, ...;String bindingName, ...;int indent, ...;Boolean standalone, ...;String docTypeRootElementName, ...;String docTypeSystemId, ...;String docTypePublicId, ...;String docTypeInternalSubset, ...;IBindingFactory bindingFactory, ...;TransformerFactory transformerFactory, ...;/** Set the target class for this instance. Setting either this property or the ... *//** Set the target package for this instance. Setting either this property or the ... */this.targetPackage/** Set the optional binding name for this instance. */this.bindingName/** Set the number of nesting indent spaces. Default is {@code -1}, i.e. no indentation. */this.indent/** Set the document encoding using for marshalling. Default is UTF-8. *//** Set the document standalone flag for marshalling. By default, this flag is not present. */this.standalone/** Set the root element name for the DTD declaration written when marshalling. ... */this.docTypeRootElementName/** Set the system id for the DTD declaration written when marshalling. ... */this.docTypeSystemId/** Set the public id for the DTD declaration written when marshalling. ... */this.docTypePublicId/** Set the internal subset Id for the DTD declaration written when marshalling. ... */this.docTypeInternalSubsetthis.bindingFactoryString[] mappedClassesgetMappedClasses(...)String mappedClass// Supported marshallingIMarshallingContext marshallingContextcreateMarshallingContext(...)marshalDocument(...)JiBXException exconvertJibxException(...)IXMLWriter xmlWritergetXmlWriter(...)writeDocType(...)// Unsupported marshallingtransformAndMarshal(...)createEventStreamWriter(...)marshalXmlStreamWriter(...)MarshallingContext marshallingContextnew StAXWriter(...)setXmlWriter(...)SAXResult saxResultthis.transformerFactorymarshalOutputStream(...)TransformerException excreateEventStreamReader(...)unmarshalXmlStreamReader(...)UnmarshallingContext unmarshallingContextcreateUnmarshallingContext(...)IXMLReader xmlReadernew StAXReaderWrapper(...)setDocument(...)unmarshalElement(...)IUnmarshallingContext unmarshallingContextunmarshalDocument(...)// Unsupported UnmarshallingtransformAndUnmarshal(...)OutputKeys.ENCODINGunmarshalInputStream(...)/** Create a new {@code IMarshallingContext}, configured with the correct indentation. ... */setIndent(...)/** Create a new {@code IUnmarshallingContext}. ... *//** Convert the given {@code JiBXException} to an appropriate exception from the ... */// JiBX does not support DOM natively, so we write to a buffer first, and transform that to the Node// JiBX does not support SAX natively, so we write to a buffer first, and transform that to the handlers/** Package providing integration of <a href="http://jibx.sourceforge.net/">JiBX</a> ... *//** Represents a container for MIME attachments ... *//** Indicate whether this container is a XOP package. ... *//** Turn this message into a XOP package. ... *//** Add the given data handler as an attachment to this container. ... *//** Return the attachment with the given content id, or {@code null} if not found. ... *//** Subinterface of {@link Marshaller} that can use MIME attachments to optimize ... *//** Marshals the object graph with the given root into the provided {@link Result}, ... *//** Subinterface of {@link org.springframework.oxm.Unmarshaller} that can use MIME attachments ... *//** Unmarshals the given provided {@link Source} into an object graph, ... *//** Contains (un)marshallers optimized to store binary data in MIME attachments. *//** Root package for Spring's O/X Mapping integration classes. ... *//** Abstract implementation of the {@code Marshaller} and {@code Unmarshaller} interface. ... */DocumentBuilderFactory documentBuilderFactory, ...;Object documentBuilderFactoryMonitor, ...;/** Return whether XML external entities are allowed. ... *//** Build a new {@link Document} from this marshaller's {@link DocumentBuilderFactory}, ... */this.documentBuilderFactoryMonitorthis.documentBuilderFactory/** Create a {@code DocumentBuilder} that this marshaller will use for creating ... *//** Create an {@code XMLReader} that this marshaller will when passed an empty {@code SAXSource}. ... *//** Determine the default encoding to use for marshalling or unmarshalling from ... *//** Marshals the object graph with the given root into the provided {@code javax.xml.transform.Result}. ... */marshalDomResult(...)marshalSaxResult(...)marshalStreamResult(...)/** Template method for handling {@code DOMResult}s. ... */marshalDomNode(...)/** Template method for handling {@code StaxResult}s. ... */marshalXmlEventWriter(...)/** Template method for handling {@code SAXResult}s. ... */marshalSaxHandlers(...)/** Template method for handling {@code StreamResult}s. ... */marshalWriter(...)/** Unmarshals the given provided {@code javax.xml.transform.Source} into an object graph. ... */unmarshalDomSource(...)unmarshalSaxSource(...)unmarshalStreamSource(...)/** Template method for handling {@code DOMSource}s. ... */unmarshalDomNode(...)/** Template method for handling {@code StaxSource}s. ... */unmarshalXmlEventReader(...)/** Template method for handling {@code SAXSource}s. ... */setXMLReader(...)createXmlReader(...)setInputSource(...)unmarshalSaxReader(...)/** Template method for handling {@code StreamSource}s. ... */unmarshalReader(...)/** Abstract template method for marshalling the given object graph to a DOM {@code Node}. ... */// Abstract template methods/** Abstract template method for marshalling the given object to a StAX {@code XMLEventWriter}. ... *//** Abstract template method for marshalling the given object to a StAX {@code XMLStreamWriter}. ... *//** Abstract template method for marshalling the given object graph to a SAX {@code ContentHandler}. ... *//** Abstract template method for marshalling the given object graph to a {@code OutputStream}. ... *//** Abstract template method for marshalling the given object graph to a {@code Writer}. ... *//** Abstract template method for unmarshalling from a given DOM {@code Node}. ... *//** Abstract template method for unmarshalling from a given Stax {@code XMLEventReader}. ... *//** Abstract template method for unmarshalling from a given Stax {@code XMLStreamReader}. ... *//** Abstract template method for unmarshalling using a given SAX {@code XMLReader} ... *//** Abstract template method for unmarshalling from a given {@code InputStream}. ... *//** Abstract template method for unmarshalling from a given {@code Reader}. ... *//** {@link Source} implementation that uses a {@link Marshaller}.Can be constructed with a ... *//** Create a new {@code MarshallingSource} with the given marshaller and content. ... */new MarshallingXMLReader(...)/** Return the {@code Marshaller} used by this {@code MarshallingSource}. *//** Return the object to be marshalled. *//** Throws a {@code UnsupportedOperationException}. */SAXResult result/** Convenient utility methods for dealing with SAX. ... *//** Create a SAX {@code InputSource} from the given resource. ... *//** Retrieve the URL from the given resource as System ID. ... *//** Provides generic support classes for using Spring's O/X Mapping integration ... */import HierarchicalStreamReaderimport HierarchicalStreamWriter/** XStream {@link Converter} that supports all classes, but throws exceptions for ... */import MarshallingStrategyimport XStreamimport ConverterLookupimport ConverterMatcherimport DataHolderimport SingleValueConverterimport ReflectionProviderimport ClassLoaderReferenceimport DefaultConverterLookupimport HierarchicalStreamDriverimport StreamExceptionimport NameCoderimport CompactWriterimport DomReaderimport DomWriterimport QNameMapimport SaxWriterimport StaxReaderimport StaxWriterimport XmlFriendlyNameCoderimport XppDriverimport CannotResolveClassExceptionimport Mapperimport MapperWrapper/** Implementation of the {@code Marshaller} interface for XStream. ... */new DefaultConverterLookup(...)this.converterLookupnew XmlFriendlyNameCoder(...)new Supplier<XStream>(...) { ... }buildXStream(...)/** The default encoding used for stream access: UTF-8. */ReflectionProvider reflectionProvider, ...;HierarchicalStreamDriver streamDriver, ...;HierarchicalStreamDriver defaultDriver, ...;Mapper mapper, ...;...[] mapperWrappers, ...;ConverterLookup converterLookup, ...;ConverterRegistry converterRegistry, ...;...[] converters, ...;MarshallingStrategy marshallingStrategy, ...;Integer mode, ...;Map<String,?> aliases, ...;Map<String,?> aliasesByType, ...;Map<String,String> fieldAliases, ...;...[] useAttributeForTypes, ...;Map<?,?> useAttributeFor, ...;Map<Class<?>,String> implicitCollections, ...;Map<Class<?>,String> omittedFields, ...;boolean autodetectAnnotations, ...;NameCoder nameCoder, ...;...[] supportedClasses, ...;SingletonSupplier<XStream> xstream, ...;/** Set a custom XStream {@link ReflectionProvider} to use. ... */this.reflectionProvider/** Set a XStream {@link HierarchicalStreamDriver} to be used for readers and writers. ... */this.streamDriverthis.defaultDrivernew XppDriver(...)/** Set a custom XStream {@link Mapper} to use. ... */this.mapper/** Set one or more custom XStream {@link MapperWrapper} classes. ... */this.mapperWrappers/** Set a custom XStream {@link ConverterLookup} to use. ... */this.converterRegistry/** Set a custom XStream {@link ConverterRegistry} to use. ... *//** Set the {@code Converters} or {@code SingleValueConverters} to be registered ... *//** Set a custom XStream {@link MarshallingStrategy} to use. ... */this.marshallingStrategy/** Set the XStream mode to use. ... */this.mode/** Set the alias/type map, consisting of string aliases mapped to classes. ... *//** Set the <em>aliases by type</em> map, consisting of string aliases mapped to classes. ... */this.aliasesByType/** Set the field alias/type map, consisting of field names. ... */this.fieldAliases/** Set types to use XML attributes for. ... */this.useAttributeForTypes/** Set the types to use XML attributes for. The given map can contain ... */this.useAttributeFor/** Specify implicit collection fields, as a Map consisting of {@code Class} instances ... */this.implicitCollections/** Specify omitted fields, as a Map consisting of {@code Class} instances ... */this.omittedFields/** Set annotated classes for which aliases will be read from class-level annotation metadata. ... *//** Activate XStream's autodetection mode. ... */this.autodetectAnnotations/** Set the encoding to be used for stream access. ... *//** Set a custom XStream {@link NameCoder} to use. ... */this.nameCoder/** Set the classes supported by this marshaller. ... */this.supportedClasses/** Build the native XStream delegate to be used by this marshaller, ... */XStream xstreamconstructXStream(...)configureXStream(...)customizeXStream(...)/** Construct an XStream instance, either using one of the ... */new XStream(...) { ... }getDefaultDriver(...)new ClassLoaderReference(...)MapperWrapper mapperToWrapClass<? extends MapperWrapper> mapperWrapperConstructor<? extends MapperWrapper> ctorMapper.classMapperWrapper.class/** Configure the XStream instance with this marshaller's bean properties. ... */this.converters.lengthregisterConverter(...)setMarshallingStrategy(...)setMode(...)Map<String,Class<?>> classMaptoClassMap(...)aliasType(...)aliasField(...)useAttributeFor(...)List<Object> listValuenew BiConsumer<Class<?>,String>(...) { ... }String[] collectionFieldsString collectionFieldaddImplicitCollection(...)omitField(...)processAnnotations(...)autodetectAnnotations(...)Map<String,Class<?>> result/** Template to allow for customizing the given {@link XStream}. ... *//** Return the native XStream delegate used by this marshaller. ... */this.xstreamClass<?> supportedClassHierarchicalStreamWriter streamWriternew DomWriter(...)doMarshal(...)createContentHandler(...)new StaxWriter(...)new QNameMap(...)convertXStreamException(...)SaxWriter saxWriternew SaxWriter(...)createWriter(...)new CompactWriter(...)/** Marshals the given graph to the given XStream HierarchicalStreamWriter. ... */getXStream(...)HierarchicalStreamReader streamReadernew DomReader(...)doUnmarshal(...)new StaxReader(...)createReader(...)/** Unmarshals the given graph to the given XStream HierarchicalStreamWriter. ... *//** Convert the given XStream exception to an appropriate exception from the ... */// no-op due to use of SingletonSupplier for the XStream field./** Package providing integration of <a href="https://x-stream.github.io/">XStream</a> ... */String EXPECTED_STRING, ...;M marshaller, ...;Object flights, ...;createFlights(...)DOMResult domResultElement flightsElementAttr namespacecreateAttributeNS(...)Element flightElementElement numberElementsetNodeValue(...)setAttributeNode(...)isSimilarToIgnoringWhitespace(...)StreamResult resultcreateStaxResult(...)U unmarshaller, ...;String INPUT_STRING, ...;DOMSource sourceObject flightstestFlights(...)XMLReader readercreateStaxSource(...)Object flighttestFlight(...)// skip to flights// skip to flight/** Tests the {@link OxmNamespaceHandler} class. ... */Jaxb2Marshaller jaxb2MarshallerJaxb2Marshaller.classimport XmlAttachmentRefDEFAULT.classDataHandler dataHandler, ...;DataHandler swaDataHandler, ...;this.dataHandlerimport AbstractMarshallerTestsimport FlightTypeimport FlightsString CONTEXT_PATH, ...;Flights flights, ...;setContextPath(...)FlightType flightgetFlight(...)setMarshallerProperties(...)Marshaller.JAXB_FORMATTED_OUTPUTUncategorizedMappingException.classFlights flightsXmlMappingException.classtestSupports(...)Flights.classObjectFactory.classJAXBElement<FlightType> flightTypeJAXBElementsetSupportJaxbElementClass(...)DummyRootElement.classDummyType.classtestSupportsPrimitives(...)testSupportsStandardClasses(...)Primitives primitivesnew Primitives(...)Primitives.classnew ReflectionUtils.MethodCallback(...) { ... }new ReflectionUtils.MethodFilter(...) { ... }Type returnTypeStandardClasses standardClassesnew StandardClasses(...)StandardClasses.classMimeContainer mimeContainerMimeContainer.classResource logoBinaryObject objectnew BinaryObject(...)BinaryObject.classsetMtomEnabled(...)Airplane airplanenew Airplane(...)new Jaxb2Marshaller(...) { ... }ArgumentCaptor<SAXSource> sourceCaptorSAXSource.classSAXSource resultsetProcessExternalEntities(...)setSupportDtd(...)new DummyType(...)DummyType t, ...;// make sure the marshalling does not result in errors// SPR-10714// SPR-10806// 1. external-general-entities and dtd support disabled (default)// 2. external-general-entities and dtd support enabledimport AbstractUnmarshallerTestsJaxb2Marshaller unmarshallerStringReader readergetSwaDataHandler(...)JAXBElement<FlightType> elementJAXBElement<Airplane> airplaneFlights f/** Used by {@link org.springframework.oxm.jaxb.Jaxb2MarshallerTests}. ... */QName NAME, ...;// following methods are used to test support for primitivesnew JAXBElement<Boolean>(...)new JAXBElement<Byte>(...)new JAXBElement<Short>(...)new JAXBElement<Integer>(...)new JAXBElement<Long>(...)new JAXBElement<Double>(...)new JAXBElement<byte[]>(...)import URLDataSourceimport ImageIOimport DatatypeConfigurationExceptionimport DatatypeFactoryDatatypeFactory factory, ...;/* java.net.URI ... */new JAXBElement<String>(...)new JAXBElement<BigInteger>(...)new JAXBElement<BigDecimal>(...)new JAXBElement<Calendar>(...)new JAXBElement<GregorianCalendar>(...)GregorianCalendar.classnew JAXBElement<Date>(...)new JAXBElement<QName>(...)new JAXBElement<URI>(...)XMLGregorianCalendar calendarnewXMLGregorianCalendar(...)new JAXBElement<XMLGregorianCalendar>(...)Duration durationnewDuration(...)new JAXBElement<Duration>(...)Image imagenew JAXBElement<Image>(...)new URLDataSource(...)new JAXBElement<DataHandler>(...)/* The following should work according to the spec, but doesn't on the JAXB2 implementation including in JDK 1.6.0_17 ... */new JAXBElement<UUID>(...)new JAXBElement<Airplane>(...)Airplane.classString airline, ...;this.airline/* Copyright 2006-2012 the original author or authors. ... */ArrayList<FlightType> flightList, ...;import EnabledOnJreimport static JRE.JAVA_8/** NOTE: These tests fail under Eclipse/IDEA because JiBX binding does not occur by ... */JibxMarshaller marshallernew JibxMarshaller(...)setTargetPackage(...)addFlight(...)setDocTypeRootElementName(...)setDocTypeSystemId(...)// JiBX compiler is currently not compatible with JDK 9/** NOTE: These tests fail under Eclipse/IDEA because JiBX binding does ... */String INPUT_STRING_WITH_SPECIAL_CHARACTERS, ...;JibxMarshaller unmarshallersizeFlightList(...)getAirline(...)// JiBX does not support reading XML fragments, hence the override hereimport XStreamAliaslong flightNumber, ...;this.flightNumbernew ArrayList<Flight>(...)List<Flight> flights, ...;this.flightsthis.stringsimport EncodedByteArrayConverterimport JettisonMappedXmlDriverimport JsonHierarchicalStreamDriverimport JsonWriterimport Inputimport JAXPXPathEnginenew XStreamMarshaller(...)new Flight(...)XStreamMarshaller marshaller, ...;Flight flight, ...;setAliases(...)Flight.classsetFlightNumber(...)// see SWS-392Document existentElement eRootElementElement eFlightsElementElement eFlightElementElement eNumberElementnew EncodedByteArrayConverter(...)byte[] bufResultsetUseAttributeForTypes(...)setUseAttributeFor(...)Map<String,Class<?>> aliasesFlightSubclass flightnew FlightSubclass(...)setAliasesByType(...)Map<String,String> aliasessetFieldAliases(...)Map<> omittedFieldsMapsetOmittedFields(...)assertXpathDoesNotExist(...)Map<> implicitCollectionsgetFlights(...)setImplicitCollections(...)assertXpathExists(...)Flight unflightsetStreamDriver(...)new JettisonMappedXmlDriver(...)getFlightNumber(...)new JsonHierarchicalStreamDriver(...) { ... }new JsonWriter(...)JsonWriter.DROP_ROOT_MODEnew Format(...)JsonWriter.FormatJsonWriter.Format.SPACE_AFTER_LABELJsonWriter.Format.COMPACT_EMPTY_ELEMENTFlight flightsetAnnotatedClasses(...)Iterable<Node> nodesselectNodes(...)new JAXPXPathEngine(...)hasSizeGreaterThan(...)// marshall into the existent document// Execute multiple times concurrently to ensure there are no concurrency issues.// See https://github.com/spring-projects/spring-framework/issues/25017XStreamMarshaller unmarshaller, ...;import R2dbcException/** Exception thrown when SQL specified is invalid. Such exceptions always have a ... *//** Return the wrapped {@link R2dbcException}. *//** Exception thrown when we can't classify a {@link R2dbcException} into ... *//** Constructor for {@code UncategorizedSQLException}. ... */import R2dbcBadGrammarExceptionimport R2dbcDataIntegrityViolationExceptionimport R2dbcNonTransientExceptionimport R2dbcNonTransientResourceExceptionimport R2dbcPermissionDeniedExceptionimport R2dbcRollbackExceptionimport R2dbcTimeoutExceptionimport R2dbcTransientExceptionimport R2dbcTransientResourceExceptionimport Wrappedimport UncategorizedR2dbcException/** Helper class that provides static methods for obtaining R2DBC Connections from ... *//** Order value for ReactiveTransactionSynchronization objects that clean up R2DBC Connections. *//** Obtain a {@link Connection} from the given {@link ConnectionFactory}. ... */onErrorMap(...)new Function<Throwable,Throwable>(...) { ... }/** Actually obtain a R2DBC Connection from the given {@link ConnectionFactory}. ... */NoTransactionException.classforCurrentTransaction(...)new Function<TransactionSynchronizationManager,Mono<? extends Connection>>(...) { ... }Mono<Connection> connew Function<Connection,Mono<? extends Connection>>(...) { ... }new Function<Throwable,Mono<? extends Connection>>(...) { ... }new Function<NoTransactionException,Mono<? extends Connection>>(...) { ... }/** Actually fetch a {@link Connection} from the given {@link ConnectionFactory}. ... *//** Close the given {@link Connection}, obtained from the given {@link ConnectionFactory}, if ... *//** Actually close the given {@link Connection}, obtained from the given ... */new Function<TransactionSynchronizationManager,Mono<? extends Void>>(...) { ... }new Function<NoTransactionException,Mono<? extends Void>>(...) { ... }/** Obtain the {@link ConnectionFactory} from the current {@link TransactionSynchronizationManager}. ... */new Predicate<TransactionSynchronizationManager>(...) { ... }new Function<TransactionSynchronizationManager,ConnectionFactory>(...) { ... }/** Translate the given {@link R2dbcException} into a generic {@link DataAccessException}. ... */new UncategorizedR2dbcException(...)/** Build a message {@code String} for the given {@link R2dbcException}. ... *//** Determine whether the given two {@link Connection}s are equal, asking the target ... *//** Return the innermost target {@link Connection} of the given {@link Connection}. ... *//** Determine the connection synchronization order to use for the given {@link ConnectionFactory}. ... */ConnectionFactory current/** Callback for resource cleanup at the end of a non-native R2DBC transaction. */new Consumer<TransactionSynchronizationManager>(...) { ... }// Use same Connection for further R2DBC actions within the transaction.// "equals" properly).// Release Connection early if the holder is not open anymore (that is,// not used by another resource that has its own cleanup via transaction// synchronization), to avoid issues with strict transaction implementations// that expect the close call before transaction completion.// close it now.// The bound ConnectionHolder might not be available anymore,// Reset the ConnectionHolder: It might remain bound to the context./** Resource holder wrapping a R2DBC {@link Connection}. ... *//** Create a new ConnectionHolder for the given R2DBC {@link Connection}, ... *//** Create a new ConnectionHolder for the given R2DBC {@link Connection}. ... *//** Return whether this holder currently has a {@link Connection}. *//** Set whether this holder represents an active, R2DBC-managed transaction. ... *//** Return whether this holder represents an active, R2DBC-managed transaction. *//** Override the existing Connection with the given {@link Connection}. ... *//** Return the current {@link Connection} held by this {@link ConnectionHolder}. ... *//** Releases the current {@link Connection}. */import ConnectionFactoryMetadata/** R2DBC {@link ConnectionFactory} implementation that delegates ... *//** Create a new DelegatingConnectionFactory. ... */import IsolationLevelimport AbstractReactiveTransactionManagerimport GenericReactiveTransaction/** {@link org.springframework.transaction.ReactiveTransactionManager} ... *//** Create a new @link ConnectionFactoryTransactionManager} instance. ... *//** Create a new {@link R2dbcTransactionManager} instance. ... *//** Set the R2DBC {@link ConnectionFactory} that this instance should manage transactions for. ... *//** Return the R2DBC {@link ConnectionFactory} that this instance manages transactions for. *//** Obtain the {@link ConnectionFactory} for actual use. ... *//** Specify whether to enforce the read-only nature of a transaction (as indicated by ... *//** Return whether to enforce the read-only nature of a transaction through an ... */ConnectionFactoryTransactionObject txObjectnew ConnectionFactoryTransactionObject(...)new Supplier<Mono<? extends Connection>>(...) { ... }Mono<Connection> connectionMonoMono<Connection> newConDuration timeoutsetTimeoutInMillis(...)CannotCreateTransactionException ex/** Determine the actual timeout to use for the given definition. ... */Duration.ZEROnew Supplier<Mono<? extends Object>>(...) { ... }R2dbcException.classcommitTransaction(...)new Function<R2dbcException,Throwable>(...) { ... }rollbackTransaction(...)Mono<Void> afterCleanupsetTransactionIsolationLevel(...)/** Prepare the transactional {@link Connection} right after transaction begin. ... */Mono<Void> prepareIsolationLevel isolationLevelToUseresolveIsolationLevel(...)new Function<? extends Result,Publisher<? extends Integer>>(...) { ... }getRowsUpdated(...)IsolationLevel currentIsolationgetTransactionIsolationLevel(...)asSql(...)isAutoCommit(...)/** Resolve the {@link TransactionDefinition#getIsolationLevel() isolation level constant} to a R2DBC ... */TransactionDefinition.ISOLATION_READ_COMMITTEDIsolationLevel.READ_COMMITTEDTransactionDefinition.ISOLATION_READ_UNCOMMITTEDIsolationLevel.READ_UNCOMMITTEDIsolationLevel.REPEATABLE_READIsolationLevel.SERIALIZABLE/** Translate the given R2DBC commit/rollback exception to a common Spring exception to propagate ... */convertR2dbcException(...)/** ConnectionFactory transaction object, representing a ConnectionHolder. ... */IsolationLevel previousIsolationLevel, ...;// Remove the connection holder from the context, if exposed.// Switch to manual commit if necessary. This is very expensive in some R2DBC drivers,import ConnectionFactories/** Implementation of {@link DelegatingConnectionFactory} that wraps a ... */new AtomicReference<Connection>(...)AtomicReference<Connection> target, ...;Mono<? extends Connection> connectionEmitter, ...;this.connectionEmitter/** Create a new {@link SingleConnectionFactory} using a R2DBC connection URL. ... *//** Create a new {@link SingleConnectionFactory} with a given {@link Connection} and ... */new ConnectionFactory(...) { ... }/** Set whether the returned {@link Connection} should be a close-suppressing proxy ... *//** Return whether the returned {@link Connection} will be a close-suppressing proxy ... *//** Set whether the returned {@link Connection}'s "autoCommit" setting should be overridden. *//** Return whether the returned {@link Connection}'s "autoCommit" setting should be overridden. ... */new Function<? extends Connection,Connection>(...) { ... }/** Close the underlying {@link Connection}. ... *//** Prepare the {@link Connection} before using it. ... *//** Wrap the given {@link Connection} with a proxy that delegates every method call to it ... */SingleConnectionFactory.classWrapped<>.class/** Invocation handler that suppresses close calls on R2DBC Connections. ... *//** Proxy for a target R2DBC {@link ConnectionFactory}, adding awareness ... *//** Create a new {@link TransactionAwareConnectionFactoryProxy}. ... *//** Delegates to {@link ConnectionFactoryUtils} for automatically participating ... *//** Wraps the given {@link Connection} with a proxy that delegates every method call ... */new Function<Connection,Connection>(...) { ... }proxyConnection(...)TransactionAwareConnectionFactoryProxy.class/** Invocation handler that delegates close calls on R2DBC Connections to ... */proxyToString(...)/** Create a new {@code CannotReadScriptException}. ... *//** Create a {@code CompositeDatabasePopulator}. with the given populators. ... */new Function<DatabasePopulator,Publisher<? extends Void>>(...) { ... }/** The {@link ConnectionFactory} for the database to populate when this ... *//** Set the {@link DatabasePopulator} to execute during the bean destruction phase, cleaning up the database and ... *//** Flag to explicitly enable or disable the {@link #setDatabasePopulator database populator} ... *//** Use the {@link #setDatabasePopulator database populator} to set up the database. *//** Use the {@link #setDatabaseCleaner database cleaner} to clean up the database. *//** Populate, initialize, or clean up the database using the ... *//** Execute the given {@link DatabasePopulator} against the given {@link ConnectionFactory}. ... */usingWhen(...)new Function<Connection,Mono<? extends Void>>(...) { ... }new Function<Connection,Publisher<?>>(...) { ... }new BiFunction<Connection,Throwable,Publisher<?>>(...) { ... }/** Populates, initializes, or cleans up a database using SQL ... */Charset sqlScriptEncoding, ...;/** Create a new {@code ResourceDatabasePopulator} with default settings. *//** Create a new {@code ResourceDatabasePopulator} with default settings for the supplied scripts. ... *//** Set the {@link DataBufferFactory} to use for {@link Resource} loading. ... */new Function<Resource,Publisher<? extends Void>>(...) { ... }/** Root of the hierarchy of data access exceptions that are related to processing of SQL scripts. ... *//** Create a new {@code ScriptException}. ... *//** Create a new {@code ScriptParseException}. ... *//** Create a new {@code ScriptStatementFailedException}. ... *//** Default prefixes for single-line comments within SQL scripts: {@code ["--"]}. */new BiConsumer<DataBuffer,SynchronousSink<String>>(...) { ... }InputStreamReader inMono<String> scriptnew Function<IOException,Throwable>(...) { ... }AtomicInteger statementNumberFlux<Void> executeScriptflatMapIterable(...)new Function<String,Iterable<? extends String>>(...) { ... }String separatorToUserunStatement(...)Mono<Long> executionsummingLong(...)new ToLongFunction<Integer>(...) { ... }new Consumer<Long>(...) { ... }new Function<Throwable,Mono<? extends Long>>(...) { ... }/** Thrown when we cannot determine anything more specific than "something went wrong while ... *//** Create a new {@code UncategorizedScriptException}. ... *//** Abstract {@link ConnectionFactory} implementation that routes ... */new MapConnectionFactoryLookup(...)Object FALLBACK_MARKER, ...;Map<?,?> targetConnectionFactories, ...;Object defaultTargetConnectionFactory, ...;ConnectionFactoryLookup connectionFactoryLookup, ...;Map<Object,ConnectionFactory> resolvedConnectionFactories, ...;ConnectionFactory resolvedDefaultConnectionFactory, ...;/** Specify the map of target {@link ConnectionFactory ConnectionFactories}, ... */this.targetConnectionFactories/** Specify the default target {@link ConnectionFactory}, if any. ... */this.defaultTargetConnectionFactory/** Specify whether to apply a lenient fallback to the default {@link ConnectionFactory} ... *//** Set the {@link ConnectionFactoryLookup} implementation to use for resolving ... */this.connectionFactoryLookupthis.resolvedConnectionFactoriesresolveSpecifiedConnectionFactory(...)this.resolvedDefaultConnectionFactory/** Resolve the specified connection factory object into a ... */determineTargetConnectionFactory(...)new Function<ConnectionFactory,Publisher<? extends Connection>>(...) { ... }new Function<Publisher<? extends Connection>,Mono<? extends Connection>>(...) { ... }/** Retrieve the current target {@link ConnectionFactory}. Determines the ... */Mono<Object> lookupKeynew BiConsumer<Object,SynchronousSink<ConnectionFactory>>(...) { ... }/** Determine the current lookup key. This will typically be implemented to check a ... *//** {@link ConnectionFactoryLookup} implementation based on a ... *//** Create a new instance of the {@link BeanFactoryConnectionFactoryLookup} class. ... */new ConnectionFactoryLookupFailureException(...)/** Strategy interface for looking up {@link ConnectionFactory} by name. ... *//** Retrieve the {@link ConnectionFactory} identified by the given name. ... *//** Exception to be thrown by a {@link ConnectionFactoryLookup} implementation, ... *//** Create a new {@code ConnectionFactoryLookupFailureException}. ... *//** Simple {@link ConnectionFactoryLookup} implementation that relies ... */new HashMap<String,ConnectionFactory>(...)Map<String,ConnectionFactory> connectionFactories, ...;/** Create a new instance of the {@link MapConnectionFactoryLookup} class. *//** Create a new instance of the {@link MapConnectionFactoryLookup} class. ... */setConnectionFactories(...)addConnectionFactory(...)/** Set the {@link Map} of {@link ConnectionFactory ConnectionFactories}. ... */this.connectionFactories/** Get the {@link Map} of {@link ConnectionFactory ConnectionFactories} maintained by this object. ... *//** Add the supplied {@link ConnectionFactory} to the map of ... */new Function<String,ConnectionFactory>(...) { ... }/** An implementation of {@link ConnectionFactoryLookup} that ... *//** Create a new instance of the {@link SingleConnectionFactoryLookup} class. ... *//** Provides a strategy for looking up R2DBC ConnectionFactories by name. *//** Provides a utility class for easy ConnectionFactory access, ... *//** Interface that defines common functionality for objects ... *//** Determine the type for the specified named parameter. ... *//** Return the parameter names of the underlying parameter source. ... */import ColumnMetadataimport Rowimport RowMetadata/** {@link BiFunction Mapping function} implementation that creates a ... */ColumnMapRowMapper INSTANCE, ...;/** A default {@code ColumnMapRowMapper} instance. */Collection<String> columnsMap<String,Object> mapOfColValues/** Create a {@link Map} instance to be used as column map. ... *//** Determine the key to use for the given column in the column {@link Map}. ... *//** Retrieve a R2DBC object value for the specified column. ... *//** Interface declaring methods that accept callback {@link Function} ... *//** Execute a callback {@link Function} within a {@link Connection} scope. ... *//** Union type combining {@link Function} and {@link SqlProvider} to expose the SQL that is ... */Function<Connection,R> function, ...;import BindMarkersFactory/** A non-blocking, reactive client for performing database calls requests with ... *//** Return the {@link ConnectionFactory} that this client uses. ... *//** Specify a static {@code sql} statement to run. Contract for specifying a ... *//** Specify a {@link Supplier SQL supplier} that provides SQL to run. ... *//** Create a {@code DatabaseClient} that will use the provided {@link ConnectionFactory}. ... */connectionFactory(...)new DefaultDatabaseClientBuilder(...)/** Obtain a {@code DatabaseClient} builder. */DatabaseClient.Builder/** A mutable builder for creating a {@link DatabaseClient}. *//** Configure the {@link BindMarkersFactory BindMarkers} to be used. *//** Configure the {@link ConnectionFactory R2DBC connector}. *//** Configure a {@link ExecuteFunction} to execute {@link Statement} objects. ... *//** Configure whether to use named parameter expansion. ... *//** Configures a {@link Consumer} to configure this builder. *//** Builder the {@link DatabaseClient} instance. *//** Contract for specifying an SQL call along with options leading to the execution. *//** Bind a non-{@code null} value to a parameter identified by its ... *//** Bind a {@code null} value to a parameter identified by its {@code index}. ... *//** Bind a non-{@code null} value to a parameter identified by its {@code name}. ... *//** Bind a {@code null} value to a parameter identified by its {@code name}. ... *//** Add the given filter to the end of the filter chain. ... */new StatementFilterFunction(...) { ... }/** Configure a result mapping {@link Function function} and enter the execution stage. ... */new BiFunction<Row,RowMetadata,R>(...) { ... }/** Configure a result mapping {@link BiFunction function} and enter the execution stage. ... *//** Perform the SQL call and retrieve the result by entering the execution stage. *//** Perform the SQL call and return a {@link Mono} that completes without result ... */import BindTarget/** Default implementation of {@link DatabaseClient}. ... */BindMarkersFactory bindMarkersFactory, ...;ExecuteFunction executeFunction, ...;NamedParameterExpander namedParameterExpander, ...;this.bindMarkersFactorythis.executeFunctionthis.namedParameterExpandernew NamedParameterExpander(...)sql(...)new DefaultGenericExecuteSpec(...)Mono<ConnectionCloseHolder> connectionMononew Function<Connection,ConnectionCloseHolder>(...) { ... }new ConnectionCloseHolder(...)new Function<Connection,Publisher<Void>>(...) { ... }new Function<ConnectionCloseHolder,Mono<? extends T>>(...) { ... }Connection connectionToUseconnectionCloseHolder.connectionR2dbcException exnew Function<ConnectionCloseHolder,Publisher<?>>(...) { ... }new BiFunction<ConnectionCloseHolder,Throwable,Publisher<?>>(...) { ... }new Function<ConnectionCloseHolder,Publisher<? extends T>>(...) { ... }/** Obtain a {@link Connection}. ... *//** Release the {@link Connection}. ... */currentConnectionFactory(...)new Function<Exception,Mono<? extends Void>>(...) { ... }/** Create a close-suppressing proxy for the given R2DBC ... */DatabaseClient.classsummingInt(...)new Function<Result,Publisher<? extends Integer>>(...) { ... }/** Base class for {@link DatabaseClient.GenericExecuteSpec} implementations. */Map<Integer,Parameter> byIndex, ...;Map<String,Parameter> byName, ...;Supplier<String> sqlSupplier, ...;StatementFilterFunction filterFunction, ...;this.byIndexthis.byNamethis.sqlSupplierthis.filterFunctionStatementFilterFunction.EMPTY_FILTERMap<Integer,Parameter> byIndexnew LinkedHashMap<Integer,Parameter>(...)assertNotPreparedOperation(...)fromOrEmpty(...)Map<String,Parameter> byNamenew LinkedHashMap<String,Parameter>(...)ColumnMapRowMapper.INSTANCErowsUpdated(...)fetch(...)getRequiredSql(...)Function<Connection,Statement> statementFunctionnew Function<Connection,Statement>(...) { ... }BindTarget bindTargetnew StatementWrapper(...)bindTo(...)DefaultDatabaseClient.this.namedParameterExpanderDefaultDatabaseClient.thisMap<String,Parameter> remainderByNameMap<Integer,Parameter> remainderByIndexList<String> parameterNamesMapBindParameterSource namedBindingsretrieveParameters(...)PreparedOperation<String> operationDefaultDatabaseClient.this.bindMarkersFactoryString expandedbindByName(...)bindByIndex(...)Function<Connection,Flux<Result>> resultFunctionnew Function<Connection,Flux<Result>>(...) { ... }checkpoint(...)DefaultDatabaseClient.this.executeFunctionnew DefaultFetchSpec<T>(...)new ConnectionFunction<R>(...)new Function<Connection,Mono<Integer>>(...) { ... }sumRowsUpdated(...)Map<String,Parameter> namedBindingsnew MapBindParameterSource(...)new BiConsumer<String,Parameter>(...) { ... }bindNull(...)new BiConsumer<Integer,Parameter>(...) { ... }/** Invocation handler that suppresses close calls on R2DBC Connections. Also prepares ... *//** Holder for a connection that makes sure the close action is invoked atomically only once. */Function<Connection,Publisher<Void>> closeFunction, ...;this.closeFunction// Create close-suppressing Connection proxyimport BindMarkersFactoryResolver/** Default implementation of {@link DatabaseClient.Builder}. ... */new ExecuteFunction(...) { ... }BindMarkersFactory bindMarkers, ...;boolean namedParameters, ...;this.bindMarkersthis.namedParametersBindMarkersFactory bindMarkersanonymous(...)new DefaultDatabaseClient(...)/** Default {@link FetchSpec} implementation. ... */ConnectionAccessor connectionAccessor, ...;Function<Connection,Flux<Result>> resultFunction, ...;Function<Connection,Mono<Integer>> updatedRowsFunction, ...;BiFunction<Row,RowMetadata,T> mappingFunction, ...;this.connectionAccessorthis.resultFunctionthis.updatedRowsFunctionthis.mappingFunctionnew Function<List<T>,Publisher<? extends T>>(...) { ... }inConnectionMany(...)new Function<Connection,Flux<T>>(...) { ... }new Function<Result,Publisher<? extends T>>(...) { ... }inConnection(...)/** Represents a function that executes a {@link Statement} for a (delayed) ... *//** Execute the given {@link Statement} for a stream of {@link Result} objects. ... *//** Union type for fetching results. ... *//** {@link BindParameterSource} implementation that holds a given {@link Map} of parameters ... */Map<String,Parameter> values, ...;/** Create a new empty {@link MapBindParameterSource}. *//** Creates a new {@link MapBindParameterSource} given {@link Map} of {@link Parameter}. ... *//** Add a key-value pair to the {@link MapBindParameterSource}. ... *//** SQL translation support allowing the use of named parameters ... *//** Default maximum number of entries for the SQL cache: 256. */import BindMarkerimport BindMarkers// Core methods used by NamedParameterSupport.NamedParameters markerHoldernew NamedParameters(...)new ExpandedQuery(...)NamedParameters.NamedParameterNamedParameter markergetOrCreate(...)getPlaceholder(...)ParameterHolder thatthat.startIndexthat.endIndexthat.parameterName/** Holder for bind markers progress. */new TreeMap<String,List<NamedParameter>>(...)BindMarkers bindMarkers, ...;boolean identifiable, ...;Map<String,List<NamedParameter>> references, ...;this.identifiableidentifiablePlaceholders(...)/** Get the {@link NamedParameter} identified by {@code namedParameter}. ... */List<NamedParameter> referencenew Function<String,List<NamedParameter>>(...) { ... }new ArrayList<NamedParameter>(...)NamedParameter paramnew NamedParameter(...)new ArrayList<BindMarker>(...)String namedParameter, ...;List<BindMarker> placeholders, ...;this.namedParameter/** Create a placeholder to translate a single value into a bindable parameter. ... */BindMarker bindMarkerNamedParameters.this.bindMarkersNamedParameters.thisthis.placeholdersaddPlaceholder(...)/** Expanded query that allows binding of parameters using parameter names that were ... */String expandedSql, ...;NamedParameters parameters, ...;BindParameterSource parameterSource, ...;this.expandedSqlthis.parameterSourceList<BindMarker> bindMarkersgetBindMarkers(...)Iterator<Object> iteratorIterator<BindMarker> markersObject valueToBindtoQuery(...)List<NamedParameter> parametersgetMarker(...)List<BindMarker> markersNamedParameter parameterparameter.placeholdersString namedParameter/** A database value that can be set in a statement. ... *//** Create a new {@link Parameter} from {@code value}. ... */new Parameter(...)/** Create a new {@link Parameter} from {@code value} and {@code type}. ... *//** Create a new empty {@link Parameter} for {@code type}. ... *//** Return the column value (can be {@code null}). ... *//** Return the column value type. Must be also present if the {@code value} is {@code null}. *//** Return whether this {@link Parameter} has a value. ... *//** Return whether this {@link Parameter} has a empty. ... */Parameter other/** Extension to {@link QueryOperation} for a prepared SQL query ... *//** Return the underlying query source. ... *//** Apply bindings to {@link BindTarget}. ... *//** Interface declaring a query operation that can be represented ... *//** Return the string-representation of this operation to ... *//** Contract for fetching tabular results. ... *//** Get exactly zero or one result. ... *//** Get the first or no result. ... *//** Get all matching elements. ... *//** Represents a function that filters an {@link ExecuteFunction execute function}. ... */StatementFilterFunction EMPTY_FILTER, ...;/** An empty {@link StatementFilterFunction} that delegates to {@link ExecuteFunction}. *//** Apply this filter to the given {@link Statement} and {@link ExecuteFunction}. ... *//** Return a composed filter function that first applies this filter, and then ... *//** Contract for fetching the number of affected rows. ... *//** Get the number of updated rows. ... */import AtomicIntegerFieldUpdater/** Anonymous, index-based bind marker using a static placeholder. ... */newUpdater(...)AnonymousBindMarkers.classAtomicIntegerFieldUpdater<AnonymousBindMarkers> COUNTER_INCREMENTER, ...;String placeholder, ...;// access via COUNTER_INCREMENTER/** Create a new {@link AnonymousBindMarkers} instance given {@code placeholder}. ... */this.placeholdernew IndexedBindMarker(...)IndexedBindMarkers.IndexedBindMarker/** A bind marker represents a single bindable parameter within a query. ... *//** Return the database-specific placeholder for a given substitution. *//** Bind the given {@code value} to the {@link Statement} using the underlying binding strategy. ... *//** Bind a {@code null} value to the {@link Statement} using the underlying binding strategy. ... *//** Bind markers represent placeholders in SQL queries for substitution ... *//** Create a new {@link BindMarker}. *//** Create a new {@link BindMarker} that accepts a {@code hint}. ... *//** This class creates new {@link BindMarkers} instances to bind ... *//** Create a new {@link BindMarkers} instance. *//** Return whether the {@link BindMarkersFactory} uses identifiable placeholders: ... *//** Create index-based {@link BindMarkers} using indexes to bind parameters. ... */new BindMarkersFactory(...) { ... }new IndexedBindMarkers(...)/** Create anonymous, index-based bind marker using a static placeholder. ... */new AnonymousBindMarkers(...)/** Create named {@link BindMarkers} using identifiers to bind parameters. ... */new NamedBindMarkers(...)/** Resolves a {@link BindMarkersFactory} from a {@link ConnectionFactory} using ... */BindMarkerFactoryProvider.classBindMarkersFactoryResolver.classList<BindMarkerFactoryProvider> DETECTORS, ...;/** Retrieve a {@link BindMarkersFactory} by inspecting {@link ConnectionFactory} ... */BindMarkerFactoryProvider detectorBindMarkersFactory bindMarkersFactorynew NoBindMarkersFactoryException(...)/** SPI to extend Spring's default R2DBC BindMarkersFactory discovery mechanism. ... *//** Return a {@link BindMarkersFactory} for a {@link ConnectionFactory}. ... *//** Exception thrown when {@link BindMarkersFactoryResolver} cannot resolve a ... *//** Constructor for NoBindMarkersFactoryException. ... *//** Built-in bind maker factories. Used typically as last {@link BindMarkerFactoryProvider} ... */new LinkedCaseInsensitiveMap<BindMarkersFactory>(...)indexed(...)filterBindMarker(...)Map<String,BindMarkersFactory> BUILTIN, ...;ConnectionFactoryMetadata metadataBindMarkersFactory r2dbcDialectString it// ascii letter or digit/** Target to apply bindings to. ... *//** Bind a value. ... *//** Bind a value to an index. Indexes are zero-based. ... *//** Bind a {@code null} value. ... *//** Value object representing value and {@code null} bindings ... */Bindings.Bindingnew Bindings(...)Bindings EMPTY, ...;Map<BindMarker,Binding> bindings, ...;/** Create empty {@link Bindings}. */this.bindings/** Create {@link Bindings} from the given collection. ... */Map<BindMarker,Binding> mappingnew Consumer<Binding>(...) { ... }getBindMarker(...)/** Merge this bindings with an other {@link Bindings} object and ... *//** Apply the bindings to a {@link BindTarget}. ... */new BiConsumer<BindMarker,Binding>(...) { ... }/** Perform the given action for each binding of this {@link Bindings} until all ... *//** Return an empty {@link Bindings} object. */List<Binding> resultnew ArrayList<Binding>(...)/** Base class for value objects representing a value or a {@code NULL} binding. */BindMarker marker, ...;this.marker/** Return the associated {@link BindMarker}. *//** Return whether the binding has a value associated with it. ... *//** Return whether the binding is empty. ... *//** Return the binding value. ... *//** Apply the binding to a {@link BindTarget}. ... *//** Value binding. *//** {@code NULL} binding. *//** Index-based bind marker. This implementation creates indexed bind ... */IndexedBindMarkers.classAtomicIntegerFieldUpdater<IndexedBindMarkers> COUNTER_INCREMENTER, ...;/** Create a new {@link IndexedBindMarker} instance given {@code prefix} and {@code beginWith}. ... *//** A single indexed bind marker. ... *//** Mutable extension to {@link Bindings} for Value and {@code null} bindings ... */BindMarkers markers, ...;/** Create new {@link MutableBindings}. ... */new LinkedHashMap<BindMarker,Binding>(...)this.markers/** Obtain the next {@link BindMarker}. ... *//** Obtain the next {@link BindMarker} with a name {@code hint}. ... *//** Bind a value to {@link BindMarker}. ... */new ValueBinding(...)/** Bind a value and return the related {@link BindMarker}. ... */BindMarker markernextMarker(...)/** Bind a {@code NULL} value to {@link BindMarker}. ... */new NullBinding(...)/** Bind a {@code NULL} value and return the related {@link BindMarker}. ... *//** Name-based bind markers. ... */NamedBindMarkers.classAtomicIntegerFieldUpdater<NamedBindMarkers> COUNTER_INCREMENTER, ...;int nameLimit, ...;Function<String,String> hintFilterFunction, ...;this.nameLimitthis.hintFilterFunctionnextName(...)new NamedBindMarker(...)/** A single named bind marker. *//** Classes providing an abstraction over SQL bind markers. *//** Core domain types around DatabaseClient. *//** The classes in this package make R2DBC easier to use and ... *//** Unit tests for {@link ConnectionFactoryUtils}. ... */new R2dbcTransientResourceException(...)new R2dbcRollbackException(...)new R2dbcTimeoutException(...)QueryTimeoutException.classnew MyTransientExceptions(...)UncategorizedR2dbcException.classnew R2dbcNonTransientResourceException(...)new R2dbcDataIntegrityViolationException(...)new R2dbcPermissionDeniedException(...)PermissionDeniedDataAccessException.classnew R2dbcBadGrammarException(...)/* Copyright 2019-2020 the original author or authors. ... */import static BDDMockito.mockimport static BDDMockito.when/** Unit tests for {@link DelegatingConnectionFactory}. ... */new ExampleConnectionFactory(...)ConnectionFactory delegate, ...;Connection connectionMock, ...;DelegatingConnectionFactory connectionFactory, ...;import TransactionalOperatorimport static ArgumentMatchers.anyBooleanimport static BDDMockito.neverimport static BDDMockito.resetimport static BDDMockito.verifyimport static BDDMockito.verifyNoMoreInteractions/** Unit tests for {@link R2dbcTransactionManager}. ... */ConnectionFactory connectionFactoryMock, ...;R2dbcTransactionManager tm, ...;new R2dbcTransactionManager(...)TestTransactionSynchronization syncAtomicInteger commitsTransactionalOperator operatornew Function<Connection,Mono<? extends TransactionSynchronizationManager>>(...) { ... }new Function<Mono<TransactionSynchronizationManager>,Mono<TransactionSynchronizationManager>>(...) { ... }transactional(...)new Function<Mono<TransactionSynchronizationManager>,FirstStep<TransactionSynchronizationManager>>(...) { ... }sync.beforeCommitCalledsync.afterCommitCalledsync.beforeCompletionCalledsync.afterCompletionCallednew Function<Mono<Connection>,Mono<Connection>>(...) { ... }new Function<Mono<Connection>,FirstStep<Connection>>(...) { ... }R2dbcBadGrammarException.classanyBoolean(...)new Function<Mono<Void>,Mono<Void>>(...) { ... }new Function<Mono<Void>,FirstStep<Void>>(...) { ... }AtomicInteger rollbacksnew TransactionCallback<Void>(...) { ... }new Function<Flux<Void>,FirstStep<Void>>(...) { ... }new Function<Flux<Object>,FirstStep<Object>>(...) { ... }DefaultTransactionDefinition innerDefTransactionalOperator innerimport H2Connection/** Unit tests for {@link SingleConnectionFactory}. ... */SingleConnectionFactory factoryMono<? extends Connection> cf1Mono<? extends Connection> cf2Connection c1Connection c2new Function<Mono<? extends Connection>,FirstStep<? extends Connection>>(...) { ... }H2Connection.classR2dbcNonTransientResourceException.classConnection connectionMockConnectionFactoryMetadata.classConnection otherConnectionimport static BDDMockito.timesimport static BDDMockito.verifyNoInteractions/** Unit tests for {@link TransactionAwareConnectionFactoryProxy}. ... */Connection connectionMock1, ...;Connection connectionMock2, ...;Connection connectionMock3, ...;new Function<Connection,Wrapped<>>(...) { ... }new Function<Mono<Wrapped<>>,FirstStep<Wrapped<>>>(...) { ... }new Consumer<Wrapped<>>(...) { ... }TransactionalOperator rxtxAtomicReference<Connection> transactionalConnectionTransactionAwareConnectionFactoryProxy proxyCfnew Function<Connection,Publisher<? extends Void>>(...) { ... }import DatabaseClient/** Abstract test support for {@link DatabasePopulator}. ... */runPopulator(...)DatabaseClient clientnew BiFunction<Row,RowMetadata,Object>(...) { ... }new Function<Object,Integer>(...) { ... }new Function<Mono<Integer>,FirstStep<Integer>>(...) { ... }import MockConnectionimport MockConnectionFactory/** Unit tests for {@link ConnectionFactoryInitializer}. ... */AtomicBoolean called, ...;DatabasePopulator populator, ...;MockConnectionFactory connectionFactory, ...;ConnectionFactoryInitializer initializernew ConnectionFactoryInitializer(...)setDatabaseCleaner(...)/** Integration tests for {@link DatabasePopulator} using H2. ... */UUID databaseName, ...;import StringscontainsSequence(...)/** Unit tests for {@link AbstractRoutingConnectionFactory}. ... */String ROUTING_KEY, ...;ConnectionFactory defaultConnectionFactory, ...;ConnectionFactory routedConnectionFactory, ...;DummyRoutingConnectionFactory connectionFactory, ...;new DummyRoutingConnectionFactory(...)setDefaultTargetConnectionFactory(...)setTargetConnectionFactories(...)setConnectionFactoryLookup(...)contextWrite(...)new Function<Mono<ConnectionFactory>,FirstStep<ConnectionFactory>>(...) { ... }ConnectionFactoryLookupFailureException.classsetLenientFallback(...)MapConnectionFactoryLookup lookupgetConnectionFactories(...)deferContextual(...)new Function<ContextView,Mono<? extends Object>>(...) { ... }hasKey(...)/** Unit tests for {@link BeanFactoryConnectionFactoryLookup}. ... */String CONNECTION_FACTORY_BEAN_NAME, ...;DummyConnectionFactory expectedConnectionFactorynew DummyConnectionFactory(...)BeanFactoryConnectionFactoryLookup lookupnew BeanFactoryConnectionFactoryLookup(...)thenThrow(...)/** Stub, do-nothing {@link ConnectionFactory} implementation. ... *//** Unit tests for {@link MapConnectionFactoryLookup}. ... */String CONNECTION_FACTORY_NAME, ...;Map<String,ConnectionFactory> connectionFactoriesDummyConnectionFactory overriddenConnectionFactoryMap<> connectionFactories/** Integration tests for {@link DatabaseClient}. ... */createConnectionFactory(...)new Function<? extends Connection,Publisher<? extends Void>>(...) { ... }new Function<Throwable,Publisher<? extends Integer>>(...) { ... }getCreateTableStatement(...)/** Creates a {@link ConnectionFactory} to be used in this test. ... *//** Return the the CREATE TABLE statement for table {@code legoset} with the following ... */DatabaseClient databaseClientassertNext(...)new Function<Row,Object>(...) { ... }new Function<Mono<Object>,FirstStep<Object>>(...) { ... }executeInsert(...)new Function<Statement,Statement>(...) { ... }returnGeneratedValues(...)new Function<Row,Number>(...) { ... }new Function<Mono<Number>,FirstStep<Number>>(...) { ... }import R2dbcTransactionManagerimport ReactiveTransactionManager/** Abstract base class for transactional integration tests for {@link DatabaseClient}. ... */DatabaseClient databaseClient, ...;R2dbcTransactionManager transactionManager, ...;TransactionalOperator rxtx, ...;/** Create a {@link ConnectionFactory} to be used in this test. ... *//** Return the the CREATE TABLE statement for table {@code legoset} with the following three columns: ... *//** Get a parameterized {@code INSERT INTO legoset} statement setting id, name, and manual values. */Flux<Integer> integerFluxflux(...)getInsertIntoLegosetStatement(...)new Function<Flux<Integer>,Flux<Integer>>(...) { ... }new Function<Flux<Integer>,FirstStep<Integer>>(...) { ... }new Function<Mono<Map<String,Object>>,FirstStep<Map<String,Object>>>(...) { ... }new Consumer<Map<String,Object>>(...) { ... }hasEntrySatisfying(...)numberOf(...)Mono<Object> integerFluxnew Function<Mono<Object>,Mono<Object>>(...) { ... }TransactionalOperator transactionalOperatorfromSupplier(...)new Supplier<Integer>(...) { ... }new Condition<Object>(...)GenericApplicationContext context, ...;import MockColumnMetadataimport MockResultimport MockRowimport MockRowMetadataimport static BDDMockito.doReturnimport static BDDMockito.inOrder/** Unit tests for {@link DefaultDatabaseClient}. ... */DatabaseClient.Builder databaseClientBuilder, ...;bindMarkers(...)DefaultDatabaseClient databaseClientnew Function<Connection,Flux<Object>>(...) { ... }new CoreSubscriber<Object>(...) { ... }mockStatementFor(...)namedParameters(...)MockRowMetadata metadatacolumnMetadata(...)MockResult.BuilderBuilder resultBuilderrowMetadata(...)MockResult resultrow(...)identified(...)mockStatement(...)mockSingleColumnResult(...)new Function<Flux<Map<String,Object>>,FirstStep<Map<String,Object>>>(...) { ... }new PreparedOperation<String>(...) { ... }mockSingleColumnEmptyResult(...)doReturn(...)/** Mocks a {@link Result} with a single column "name" and a single row if a non null ... */MockRow.Builderimport H2ConnectionFactory/** Integration tests for {@link DatabaseClient} against H2. ... */String CREATE_TABLE_LEGOSET, ...;inMemory(...)/** Unit tests for {@link NamedParameterUtils}. ... */BindMarkersFactory BIND_MARKERS, ...;MapBindParameterSource namedParamsnew HashMap<String,Parameter>(...)PreparedOperation<?> operationPreparedOperation<?> operation2BindTarget.classMapBindParameterSource paramMapParsedSql parsedBindMarkersFactory factorynew BindTarget(...) { ... }MultiValueMap<Integer,Object> bindingsnew LinkedMultiValueMap<Integer,Object>(...)Map<Integer,Object> bindValuesnew LinkedHashMap<Integer,Object>(...)/** Unit tests for {@link AnonymousBindMarkers}. ... */BindMarkers bindMarkers1BindMarkers bindMarkers2BindMarkers bindMarkersBindMarker firstBindMarker second/** Unit tests for {@link Bindings}. ... */BindMarkersFactory markersFactory, ...;BindTarget bindTarget, ...;MutableBindings bindingsnew MutableBindings(...)Bindings.NullBindingBindMarkers markersBindMarker sharedBindMarker leftMarkerList<Binding> leftBindMarker rightMarkerList<Binding> rightBindings mergedBindings.ValueBinding/** Unit tests for {@link IndexedBindMarkers}. ... */BindMarker marker1BindMarker marker2/** Unit tests for {@link NamedBindMarkers}. ... */new Supplier<StringBuilder>(...) { ... }new ObjIntConsumer<StringBuilder>(...) { ... }appendCodePoint(...)new BiConsumer<StringBuilder,StringBuilder>(...) { ... }/** This package contains mock implementations of the ... */import HttpHeadersimport HttpInputMessage/** Mock implementation of {@link HttpInputMessage}. ... */new HttpHeaders(...)HttpHeaders headers, ...;InputStream body, ...;import HttpOutputMessage/** Mock implementation of {@link HttpOutputMessage}. ... */ByteArrayOutputStream body, ...;/** Return the headers. *//** Return the body content. *//** Return body content as a byte array. *//** Return the body content interpreted as a UTF-8 string. */getBodyAsString(...)/** Return the body content as a string. ... */import HttpMethodimport ClientHttpResponse/** An extension of {@link MockClientHttpRequest} that also implements ... */SettableListenableFuture<ClientHttpResponse> futurenew SettableListenableFuture<ClientHttpResponse>(...)import ClientHttpRequestimport MockHttpOutputMessage/** Mock implementation of {@link ClientHttpRequest}. ... */HttpMethod httpMethod, ...;ClientHttpResponse clientHttpResponse, ...;/** Default constructor. */this.httpMethodHttpMethod.GET/** Create an instance with the given HttpMethod and URI. */this.clientHttpResponsethis.executed/** Set the {@link #isExecuted() executed} flag to {@code true} and return the ... *//** The default implementation returns the configured ... */import HttpStatusimport MockHttpInputMessage/** Mock implementation of {@link ClientHttpResponse}. ... */HttpStatus status, ...;/** Constructor with response body as a byte array. *//** Constructor with response body as InputStream. */getReasonPhrase(...)/** Mock implementations of client-side HTTP abstractions. ... */import AbstractClientHttpRequestimport UriComponentsBuilderURI url, ...;Flux<DataBuffer> body, ...;Function<Flux<DataBuffer>,Mono<Void>> writeHandler, ...;buildAndExpand(...)fromUriString(...)this.writeHandlernew Function<Flux<DataBuffer>,Mono<Void>>(...) { ... }/** Configure a custom handler for writing the request body. ... */getCookies(...)new Function<List<HttpCookie>,Stream<? extends HttpCookie>>(...) { ... }new Consumer<HttpCookie>(...) { ... }HttpHeaders.COOKIEdoCommit(...)new Supplier<Publisher<Void>>(...) { ... }writeWith(...)new Function<? extends Publisher<? extends DataBuffer>,Publisher<? extends DataBuffer>>(...) { ... }/** Return the request body, or an error stream if the body was never set ... *//** Aggregate response data and convert to a String using the "Content-Type" ... */new Function<MediaType,Charset>(...) { ... }import MediaTypeimport ResponseCookienew LinkedMultiValueMap<String,ResponseCookie>(...)MultiValueMap<String,ResponseCookie> cookies, ...;HttpHeaders.SET_COOKIEnew Function<List<ResponseCookie>,Stream<? extends ResponseCookie>>(...) { ... }new Consumer<ResponseCookie>(...) { ... }this.cookiessetBody(...)/** Return the response body aggregated and converted to a String using the ... */MediaType contentTypeHttpStatus code/** Mock implementations of reactive HTTP client contracts. *//** Mock implementations of client/server-side HTTP abstractions. ... */import HttpCookieimport HttpRangeimport AbstractServerHttpRequestimport SslInfo/** Mock extension of {@link AbstractServerHttpRequest} for use in tests without ... */String httpMethod, ...;/** String representation of one of {@link HttpMethod} or not empty custom method (e.g. <i>CONNECT</i>). */MultiValueMap<String,HttpCookie> cookies, ...;InetSocketAddress localAddress, ...;InetSocketAddress remoteAddress, ...;SslInfo sslInfo, ...;this.localAddressthis.remoteAddressthis.sslInfo/** Create an HTTP GET builder with the given URI template. The given URI may ... */// Static builder methods/** HTTP HEAD variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.HEAD/** HTTP POST variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.POST/** HTTP PUT variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.PUT/** HTTP PATCH variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.PATCH/** HTTP DELETE variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.DELETE/** HTTP OPTIONS variant. See {@link #get(String, Object...)} for general info. ... */HttpMethod.OPTIONS/** Create a builder with the given HTTP method and a {@link URI}. ... */new DefaultBodyBuilder(...)/** Alternative to {@link #method(HttpMethod, URI)} that accepts a URI template. ... *//** Create a builder with a raw HTTP method value value that is outside the ... *//** Request builder exposing properties not related to the body. ... *//** Set the contextPath to return. *//** Append the given query parameter to the existing query parameters. ... *//** Add the given query parameters and values. The provided query name ... *//** Set the remote address to return. *//** Set the local address to return. ... *//** Set SSL session information and certificates. *//** Add one or more cookies. *//** Add the given cookies. ... *//** Add the given header values. ... *//** Set the list of acceptable {@linkplain MediaType media types}, as ... *//** Set the list of acceptable {@linkplain Charset charsets}, as specified ... *//** Set the list of acceptable {@linkplain Locale locales}, as specified ... *//** Set the value of the {@code If-Modified-Since} header. ... *//** Set the (new) value of the {@code If-Unmodified-Since} header. ... *//** Set the values of the {@code If-None-Match} header. ... *//** Set the (new) value of the Range header. ... *//** Builds the request with no body. ... *//** A builder that adds a body to the request. *//** Set the length of the body in bytes, as specified by the ... *//** Set the {@linkplain MediaType media type} of the body, as specified ... *//** Set the body of the request and build it. ... */new LinkedMultiValueMap<String,HttpCookie>(...)String methodValue, ...;UriComponentsBuilder queryParamsBuilder, ...;this.methodValuequeryParam(...)this.queryParamsBuilderqueryParams(...)setAccept(...)setAcceptCharset(...)setAcceptLanguageAsLocales(...)setIfModifiedSince(...)setIfUnmodifiedSince(...)setIfNoneMatch(...)body(...)applyCookiesIfNecessary(...)new MockServerHttpRequest(...)getUrlToUse(...)MultiValueMap<String,String> paramsgetQueryParams(...)fromUri(...)import AbstractServerHttpResponse/** Mock extension of {@link AbstractServerHttpResponse} for use in tests without ... */Empty<Void> completionunsafe(...)/** Configure a custom handler to consume the response body. ... */List<ResponseCookie> cookiesResponseCookie cookienew Supplier<Mono<Void>>(...) { ... }/** Return the response body or an error stream if the body was not set. */// Avoid .then() that causes data buffers to be discarded and released// Signals are serialized/** Mock implementations of reactive HTTP server contracts. *//** Simple extension of the JndiTemplate class that always returns a given object. ... *//** Simple implementation of a JNDI naming context. ... *//** Simple implementation of a JNDI naming context builder. ... *//** <strong>Deprecated</strong> as of Spring Framework 5.2 in favor of complete ... */import ReadListenerimport ServletInputStream/** Delegating implementation of {@link javax.servlet.ServletInputStream}. ... */InputStream sourceStream, ...;boolean finished, ...;/** Create a DelegatingServletInputStream for the given source stream. ... */this.sourceStream/** Return the underlying source stream (never {@code null}). */this.finishedimport ServletOutputStreamimport WriteListener/** Delegating implementation of {@link javax.servlet.ServletOutputStream}. ... */OutputStream targetStream, ...;/** Create a DelegatingServletOutputStream for the given target stream. ... */this.targetStream/** Return the underlying target stream (never {@code null}). *//** Internal helper class that serves as a value holder for request headers. ... */new LinkedList<Object>(...)List<Object> values, ...;List<String> stringListimport AsyncContextimport ServletContextimport ServletRequestimport ServletResponseimport WebUtils/** Mock implementation of the {@link AsyncContext} interface. ... */new ArrayList<AsyncListener>(...)HttpServletRequest request, ...;HttpServletResponse response, ...;List<AsyncListener> listeners, ...;String dispatchedPath, ...;List<Runnable> dispatchHandlers, ...;this.dispatchedPaththis.dispatchHandlersdispatch(...)getRequestURI(...)new Consumer<Runnable>(...) { ... }MockHttpServletRequest mockRequestgetNativeRequest(...)MockHttpServletRequest.classsetAsyncStarted(...)/** By default this is set to 10000 (10 seconds) even though the Servlet API ... */import JspWriterimport BodyContent/** Mock implementation of the {@link javax.servlet.jsp.tagext.BodyContent} class. ... *//** Create a MockBodyContent for the given response. ... */adaptJspWriter(...)new MockJspWriter(...)// Delegating implementations of JspWriter's abstract methodsgetEnclosingWriter(...)clearBuffer(...)getRemaining(...)import Cookie/** Extension of {@code Cookie} with extra attributes, as defined in ... */ZonedDateTime expires, ...;String sameSite, ...;/** Construct a new {@link MockCookie} with the supplied name and value. ... *//** Set the "Expires" attribute for this cookie. ... */this.expires/** Get the "Expires" attribute for this cookie. ... *//** Set the "SameSite" attribute for this cookie. ... */this.sameSite/** Get the "SameSite" attribute for this cookie. ... *//** Factory method that parses the value of the supplied "Set-Cookie" header. ... */String[] cookiePartsString[] valueAndAttributesString[] attributesvalueAndAttributes.lengthMockCookie cookienew MockCookie(...)cookieParts.lengthsetDomain(...)extractAttributeValue(...)setMaxAge(...)setExpires(...)setPath(...)setSecure(...)setHttpOnly(...)setSameSite(...)String[] nameAndValuenameAndValue.length// ignore invalid date formatsimport JspExceptionimport PageContextimport ExpressionEvaluatorManager/** Mock implementation of the JSP 2.0 {@link javax.servlet.jsp.el.ExpressionEvaluator} ... */PageContext pageContext, ...;/** Create a new MockExpressionEvaluator for the given PageContext. ... */this.pageContextnew Expression(...) { ... }JspException exnew ELException(...)import FilterConfigimport Servlet/** Mock implementation of the {@link javax.servlet.FilterChain} interface. ... */ServletRequest request, ...;ServletResponse response, ...;Iterator<Filter> iterator, ...;/** Register a single do-nothing {@link Filter} implementation. The first ... *//** Create a FilterChain with a Servlet. ... */initFilterList(...)/** Create a {@code FilterChain} with Filter's and a Servlet. ... */Filter[] allFiltersnew ServletFilterProxy(...)/** Return the request that {@link #doFilter} has been called with. *//** Return the response that {@link #doFilter} has been called with. *//** Invoke registered {@link Filter Filters} and/or {@link Servlet} also saving the ... */Filter nextFilter/** Reset the {@link MockFilterChain} allowing it to be invoked again. *//** A filter that simply delegates to a Servlet. */Servlet delegateServlet, ...;this.delegateServletservice(...)/** Mock implementation of the {@link javax.servlet.FilterConfig} interface. ... */ServletContext servletContext, ...;String filterName, ...;Map<String,String> initParameters, ...;/** Create a new MockFilterConfig with a default {@link MockServletContext}. *//** Create a new MockFilterConfig with a default {@link MockServletContext}. ... *//** Create a new MockFilterConfig. ... */this.servletContextthis.filterNamethis.initParametersimport HttpServletMappingimport MappingMatch/** Mock implementation of {@link HttpServletMapping}. ... */String matchValue, ...;String servletName, ...;MappingMatch mappingMatch, ...;this.matchValuethis.servletNamethis.mappingMatchimport DispatcherTypeimport RequestDispatcherimport HttpSessionimport HttpUpgradeHandlerimport Part/** Mock implementation of the {@link javax.servlet.http.HttpServletRequest} interface. ... */new LinkedHashMap<String,String[]>(...)new LinkedList<Locale>(...)DispatcherType.REQUESTnew LinkedCaseInsensitiveMap<HeaderValueHolder>(...)new LinkedMultiValueMap<String,Part>(...)new MockHttpServletMapping(...)new DelegatingServletInputStream(...)String HTTP, ...;String HTTPS, ...;String CHARSET_PREFIX, ...;TimeZone GMT, ...;ServletInputStream EMPTY_SERVLET_INPUT_STREAM, ...;BufferedReader EMPTY_BUFFERED_READER, ...;...[] DATE_FORMATS, ...;/** Date formats as specified in the HTTP RFC. ... *//** The default protocol: 'HTTP/1.1'. ... */// ---------------------------------------------------------------------// Public constantsString DEFAULT_SCHEME, ...;/** The default scheme: 'http'. ... */String DEFAULT_SERVER_ADDR, ...;/** The default server address: '127.0.0.1'. */String DEFAULT_SERVER_NAME, ...;/** The default server name: 'localhost'. */int DEFAULT_SERVER_PORT, ...;/** The default server port: '80'. */String DEFAULT_REMOTE_ADDR, ...;/** The default remote address: '127.0.0.1'. */String DEFAULT_REMOTE_HOST, ...;/** The default remote host: 'localhost'. */// Lifecycle properties// ServletRequest propertiesString characterEncoding, ...;ServletInputStream inputStream, ...;BufferedReader reader, ...;Map<String,String[]> parameters, ...;String scheme, ...;String serverName, ...;int serverPort, ...;String remoteAddr, ...;String remoteHost, ...;LinkedList<Locale> locales, ...;/** List of locales in descending order. */boolean secure, ...;int remotePort, ...;String localName, ...;String localAddr, ...;int localPort, ...;boolean asyncStarted, ...;boolean asyncSupported, ...;MockAsyncContext asyncContext, ...;DispatcherType dispatcherType, ...;String authType, ...;// HttpServletRequest properties...[] cookies, ...;Map<String,HeaderValueHolder> headers, ...;String pathInfo, ...;String queryString, ...;String remoteUser, ...;Set<String> userRoles, ...;Principal userPrincipal, ...;String requestedSessionId, ...;String requestURI, ...;String servletPath, ...;HttpSession session, ...;boolean requestedSessionIdValid, ...;boolean requestedSessionIdFromCookie, ...;boolean requestedSessionIdFromURL, ...;MultiValueMap<String,Part> parts, ...;HttpServletMapping httpServletMapping, ...;/** Create a new {@code MockHttpServletRequest} with a default ... *//** Create a new {@code MockHttpServletRequest} with the supplied {@link ServletContext}. ... *//** Create a new {@code MockHttpServletRequest} with the supplied {@link ServletContext}, ... */this.requestURIthis.locales/** Return the ServletContext that this request is associated with. (Not ... */// Lifecycle methods/** Return whether this request is still active (that is, not completed yet). *//** Mark this request as completed, keeping its state. *//** Invalidate this request, clearing its state. */clearAttributes(...)/** Check whether this request is still active (that is, not completed yet), ... */// ServletRequest interfacecheckActive(...)this.characterEncodingupdateContentTypeHeader(...)doAddHeaderValue(...)HttpHeaders.CONTENT_TYPE/** Set the content of the request body as a byte array. ... *//** Get the content of the request body as a byte array. ... *//** Get the content of the request body as a {@code String}, using the configured ... */this.content.lengthMediaType mediaTypeparseMediaType(...)int charsetIndex/** Set a single value for the specified HTTP parameter. ... *//** Set an array of values for the specified HTTP parameter. ... *//** Set all provided parameters <strong>replacing</strong> any existing ... *//** Add a single value for the specified HTTP parameter. ... */addParameter(...)/** Add an array of values for the specified HTTP parameter. ... */String[] oldArroldArr.length/** Add all provided parameters <strong>without</strong> replacing any ... *//** Remove already registered values for the specified HTTP parameter, if any. *//** Remove all existing parameters. */String[] arrthis.schemethis.serverNameString rawHostHeaderHttpHeaders.HOSTint indexOfClosingBracketthis.serverPortInputStream sourceStreamReader sourceReaderthis.remoteAddrthis.remoteHost/** Clear all of this request's attributes. *//** Add a new preferred locale, before any existing locales. ... */updateAcceptLanguageHeader(...)/** Set the list of preferred locales, in descending order, effectively replacing ... */HttpHeaders headersHttpHeaders.ACCEPT_LANGUAGE/** Return the first preferred {@linkplain Locale locale} configured ... *//** Return an {@linkplain Enumeration enumeration} of the preferred ... *//** Set the boolean {@code secure} flag indicating whether the mock request ... */this.secure/** Return {@code true} if the {@link #setSecure secure} flag has been set ... */new MockRequestDispatcher(...)getRealPath(...)this.remotePortthis.localNamethis.localAddrthis.localPortthis.asyncSupportedthis.asyncStartedthis.asyncContextnew MockAsyncContext(...)this.dispatcherType// HttpServletRequest interfacethis.authTypeencodeCookies(...)new Function<Cookie,String>(...) { ... }/** Add an HTTP header entry for the given name. ... */List<Locale> localesgetAcceptLanguageAsLocales(...)HeaderValueHolder headernew HeaderValueHolder(...)addValueArray(...)/** Remove already registered entries for the specified HTTP header, if any. ... *//** Return the long timestamp for the date header with the given {@code name}. ... */parseDateHeader(...)String dateFormatSimpleDateFormat simpleDateFormatgetStringValues(...)this.pathInfothis.queryStringthis.remoteUserthis.userRolesgetDeclaredRoles(...)this.userPrincipalthis.requestedSessionIdgetServerName(...)getServerPort(...)StringBuffer urlthis.servletPathMockHttpSession mockSessionaccess(...)isInvalid(...)/** The implementation of this (Servlet 3.1+) method calls ... */changeSessionId(...)this.requestedSessionIdValidthis.requestedSessionIdFromCookiethis.requestedSessionIdFromURLisRequestedSessionIdFromURL(...)this.partsList<Part> resultnew LinkedList<Part>(...)List<Part> listthis.httpServletMapping// Try to get charset value anyway// Invalid Accept-Language format -> just store plain header// Reset session if invalidated.// Create new session if necessary./** Mock implementation of the {@link javax.servlet.http.HttpServletResponse} interface. ... */WebUtils.DEFAULT_CHARACTER_ENCODINGnew ResponseServletOutputStream(...)new ArrayList<Cookie>(...)HttpServletResponse.SC_OKString DATE_FORMAT, ...;boolean outputStreamAccessAllowed, ...;// ServletResponse propertiesboolean writerAccessAllowed, ...;boolean charset, ...;ByteArrayOutputStream content, ...;ServletOutputStream outputStream, ...;PrintWriter writer, ...;boolean committed, ...;List<Cookie> cookies, ...;// HttpServletResponse propertiesString errorMessage, ...;String forwardedUrl, ...;List<String> includedUrls, ...;/** Set whether {@link #getOutputStream()} access is allowed. ... */// ServletResponse interfacethis.outputStreamAccessAllowed/** Return whether {@link #getOutputStream()} access is allowed. *//** Set whether {@link #getWriter()} access is allowed. ... */this.writerAccessAllowed/** Return whether the character encoding has been set. ... */updateContentTypePropertyAndHeader(...)this.outputStreamthis.writerWriter targetWriternew ResponsePrintWriter(...)/** Get the content of the response body as a {@code String}, using the charset ... *//** Get the content of the response body as a {@code String}, using the provided ... */isCharset(...)HttpHeaders.CONTENT_LENGTHsetCommitted(...)isCommitted(...)int bufSizethis.committedresetBuffer(...)this.errorMessageHttpHeaders.CONTENT_LANGUAGE// HttpServletResponse interfacegetCookieHeader(...)int maxAgegetMaxAge(...)ZonedDateTime expiresgetExpires(...)HttpHeaders.EXPIRESgetSecure(...)isHttpOnly(...)MockCookie mockCookiegetSameSite(...)new Cookie[]Cookie cookie/** Return the names of all specified headers as a Set of Strings. ... *//** Return the primary value for the given header as a String, if any. ... *//** Return all values for the given header as a List of Strings. ... *//** Return the primary value for the given header, if any. ... *//** Return all values for the given header as a List of value objects. ... *//** The default implementation returns the given URL String as-is. ... *//** The default implementation delegates to {@link #encodeURL}, ... */encodeURL(...)encodeRedirectURL(...)HttpHeaders.LOCATIONsetStatus(...)HttpServletResponse.SC_MOVED_TEMPORARILYsetHeaderValue(...)formatDate(...)addHeaderValue(...)newDateFormat(...)SimpleDateFormat dateFormatboolean replaceHeadersetSpecialHeader(...)String contentLanguagesLocale languagegetContentLanguage(...)setCookie(...)addCookie(...)new Function<String,HeaderValueHolder>(...) { ... }/** Set the {@code Set-Cookie} header to the supplied {@link Cookie}, ... */// Methods for MockRequestDispatcherthis.forwardedUrlthis.includedUrls/** Inner class that adapts the ServletOutputStream to mark the ... */setCommittedIfBufferSizeExceeded(...)/** Inner class that adapts the PrintWriter to mark the ... */// Since setLocale() sets the Content-Language header to the given// single Locale, we have to explicitly set the Content-Language header// to the user-provided value.import HttpSessionBindingEventimport HttpSessionBindingListener/** Mock implementation of the {@link javax.servlet.http.HttpSession} interface. ... */String SESSION_COOKIE_NAME, ...;/** The session cookie name. */int nextId, ...;long creationTime, ...;int maxInactiveInterval, ...;long lastAccessedTime, ...;boolean invalid, ...;boolean isNew, ...;/** Create a new MockHttpSession with a default {@link MockServletContext}. ... *//** Create a new MockHttpSession. ... */assertIsValid(...)this.creationTime/** As of Servlet 3.1, the id of a session can be changed. ... */this.lastAccessedTimethis.isNewthis.maxInactiveIntervalvalueUnbound(...)new HttpSessionBindingEvent(...)valueBound(...)/** Clear all of this session's attributes. */Iterator<Entry<String,Object>> it/** Invalidates this session then unbinds any objects bound to it. ... */this.invalid/** Convenience method for asserting that this session has not been ... *//** Serialize the attributes of this session into an object that can be ... */HashMap<String,Serializable> state/** Deserialize the attributes of this session from a state object created by ... */// Not serializable... Servlet containers usually automatically// unbind the attribute in this case./** Mock implementation of the {@link javax.servlet.jsp.JspWriter} class. ... */PrintWriter targetWriter, ...;/** Create a MockJspWriter for the given response, ... *//** Create a MockJspWriter for the given plain Writer. ... *//** Create a MockJspWriter for the given response. ... */this.targetWriter/** Lazily initialize the target Writer. */flushBuffer(...)getTargetWriter(...)import MultipartFile/** Mock implementation of the {@link org.springframework.web.multipart.MultipartFile} ... */String originalFilename, ...;/** Create a new MockMultipartFile with the given content. ... */this.originalFilenameimport MultipartExceptionimport MultipartHttpServletRequest/** Mock implementation of the ... */new LinkedMultiValueMap<String,MultipartFile>(...)MultiValueMap<String,MultipartFile> multipartFiles, ...;/** Create a new {@code MockMultipartHttpServletRequest} with a default ... *//** Create a new {@code MockMultipartHttpServletRequest} with the supplied {@link ServletContext}. ... *//** Add a file to this request. The parameter name from the multipart ... */this.multipartFilesList<MultipartFile> multipartFilesMultipartFile filePart partgetPart(...)Enumeration<String> headerNamesgetHeaderNames(...)new MultipartException(...)// Should never happen (we're not actually parsing)import ELContextimport ServletConfig/** Mock implementation of the {@link javax.servlet.jsp.PageContext} interface. ... */ServletConfig servletConfig, ...;JspWriter out, ...;/** Create new MockPageContext with a default {@link MockServletContext}, ... *//** Create new MockPageContext with a default {@link MockHttpServletRequest}, ... *//** Create new MockPageContext with a MockHttpServletResponse, ... *//** Create new MockPageContext with a MockServletConfig. ... *//** Create new MockServletConfig. ... */this.servletConfigHttpSession sessionPageContext.PAGE_SCOPEPageContext.REQUEST_SCOPEPageContext.SESSION_SCOPEPageContext.APPLICATION_SCOPEemptyEnumeration(...)new MockExpressionEvaluator(...)getRequestDispatcher(...)getContentAsByteArray(...)getContentAsString(...)/** Mock implementation of {@code javax.servlet.http.Part}. ... */String filename, ...;/** Constructor for a part with byte[] content only. ... *//** Constructor for a part with a filename and byte[] content. ... */this.filenamesetContentDispositionFormData(...)Collection<String> headerValues/** Return the {@link HttpHeaders} backing header related accessor methods, ... */import HttpServletResponseWrapper/** Mock implementation of the {@link javax.servlet.RequestDispatcher} interface. ... */String resource, ...;/** Create a new MockRequestDispatcher for the given resource. ... */setForwardedUrl(...)getMockHttpServletResponse(...)addIncludedUrl(...)/** Obtain the underlying {@link MockHttpServletResponse}, unwrapping ... *//** Mock implementation of the {@link javax.servlet.ServletConfig} interface. ... *//** Create a new MockServletConfig with a default {@link MockServletContext}. *//** Create a new MockServletConfig with a default {@link MockServletContext}. ... *//** Create a new MockServletConfig. ... */import InvalidPathExceptionimport FilterRegistrationimport ServletRegistrationimport SessionCookieConfigimport SessionTrackingModeimport JspConfigDescriptorimport MediaTypeFactory/** Mock implementation of the {@link javax.servlet.ServletContext} interface. ... */new HashMap<String,ServletContext>(...)new HashMap<String,RequestDispatcher>(...)new MockSessionCookieConfig(...)new LinkedHashMap<String,MediaType>(...)new LinkedHashSet<SessionTrackingMode>(...)SessionTrackingMode.COOKIESessionTrackingMode.URLSessionTrackingMode.SSLString COMMON_DEFAULT_SERVLET_NAME, ...;/** Default Servlet name used by Tomcat, Jetty, JBoss, and GlassFish: {@value}. */String TEMP_DIR_SYSTEM_PROPERTY, ...;Set<SessionTrackingMode> DEFAULT_SESSION_TRACKING_MODES, ...;String resourceBasePath, ...;Map<String,ServletContext> contexts, ...;int minorVersion, ...;int effectiveMajorVersion, ...;int effectiveMinorVersion, ...;Map<String,RequestDispatcher> namedRequestDispatchers, ...;String defaultServletName, ...;String servletContextName, ...;Set<String> declaredRoles, ...;Set<SessionTrackingMode> sessionTrackingModes, ...;SessionCookieConfig sessionCookieConfig, ...;int sessionTimeout, ...;String requestCharacterEncoding, ...;String responseCharacterEncoding, ...;Map<String,MediaType> mimeTypes, ...;/** Create a new {@code MockServletContext}, using no base path and a ... *//** Create a new {@code MockServletContext}, using a {@link DefaultResourceLoader}. ... *//** Create a new {@code MockServletContext}, using the specified {@link ResourceLoader} ... *//** Create a new {@code MockServletContext} using the supplied resource base ... */String tempDirthis.resourceBasePathWebUtils.TEMP_DIR_CONTEXT_ATTRIBUTEregisterNamedDispatcher(...)this.defaultServletName/** Build a full resource location for the given path, prepending the resource ... */this.minorVersionthis.effectiveMajorVersionthis.effectiveMinorVersionthis.mimeTypesgetMediaType(...)new Function<MediaType,String>(...) { ... }/** Adds a mime type mapping for use by {@link #getMimeType(String)}. ... */String actualPathString[] fileListSet<String> resourcePathsfileList.lengthString fileEntryString resultPaththis.namedRequestDispatchers/** Register a {@link RequestDispatcher} (typically a {@link MockRequestDispatcher}) ... *//** Unregister the {@link RequestDispatcher} with the given name. ... *//** Get the name of the <em>default</em> {@code Servlet}. ... *//** Set the name of the <em>default</em> {@code Servlet}. ... */unregisterNamedDispatcher(...)this.servletContextNameString roleNamethis.declaredRolesthis.sessionTrackingModesthis.sessionCookieConfigthis.sessionTimeoutthis.requestCharacterEncodingthis.responseCharacterEncoding// Unsupported Servlet 3.0 registration methodsServletRegistration.Dynamic/** This method always returns {@code null}. ... *//** This method always returns an {@linkplain Collections#emptyMap empty map}. ... */FilterRegistration.Dynamic// Use JVM temp dir as ServletContext temp dir.// on Servlet 4.0/** Mock implementation of the {@link javax.servlet.SessionCookieConfig} interface. ... */String domain, ...;String comment, ...;boolean httpOnly, ...;int maxAge, ...;this.domainthis.commentthis.httpOnlythis.maxAge/** Implementation of the {@link javax.servlet.FilterConfig} interface which ... */Filter filter, ...;FilterChain nextFilterChain, ...;Servlet servlet, ...;/** Create a new PassThroughFilterChain that delegates to the given Filter, ... */this.nextFilterChain/** Create a new PassThroughFilterChain that delegates to the given Servlet. ... */this.servlet/** Pass the call on to the Filter/Servlet. *//** A comprehensive set of Servlet API 4.0 mock objects, targeted at usage with ... */import HttpMessageReaderimport RequestPathimport ServerHttpRequestimport BodyExtractorimport HandlerStrategiesimport ServerRequestimport ServerWebExchangeimport WebSessionimport UriBuilder/** Mock implementation of {@link ServerRequest}. ... */HttpMethod method, ...;RequestPath requestPath, ...;MockHeaders headers, ...;Object body, ...;MultiValueMap<String,String> queryParams, ...;Map<String,String> pathVariables, ...;WebSession session, ...;Principal principal, ...;List<HttpMessageReader<?>> messageReaders, ...;ServerWebExchange exchange, ...;this.requestPaththis.queryParamsthis.pathVariablesthis.principalthis.messageReadersthis.exchangenew BuilderImpl(...)/** Builder for {@link MockServerRequest}. *//** Sets the request {@link Principal}. ... */new MockHeaders(...)messageReaders(...)principal(...)new MockServerRequest(...)getAccept(...)delegate(...)getAcceptCharset(...)Locale.LanguageRangegetAcceptLanguage(...)toOptionalLong(...)readOnlyHttpHeaders(...)/** Mock objects for the functional web framework. ... */import ServerCodecConfigurerimport MockServerHttpRequestimport MockServerHttpResponseimport DefaultServerWebExchangeimport AcceptHeaderLocaleContextResolverimport DefaultWebSessionManagerimport WebSessionManager/** Extension of {@link DefaultServerWebExchange} for use in tests, along with ... */new MockServerHttpResponse(...)new AcceptHeaderLocaleContextResolver(...)/** Create a {@link MockServerWebExchange} from the given mock request. ... *//** Variant of {@link #from(MockServerHttpRequest)} with a mock request builder. ... */MockServerHttpRequest.BaseBuilder<?>/** Create a {@link Builder} starting with the given mock request. ... */MockServerWebExchange.Builder/** Variant of {@link #builder(MockServerHttpRequest)} with a mock request builder. ... *//** Builder for a {@link MockServerWebExchange}. ... */MockServerHttpRequest request, ...;WebSessionManager sessionManager, ...;/** Set the session to use for the exchange. ... */this.sessionManagernew WebSessionManager(...) { ... }/** Provide a {@code WebSessionManager} instance to use with the exchange. ... *//** Build the {@code MockServerWebExchange} instance. */new MockServerWebExchange(...)new DefaultWebSessionManager(...)import InMemoryWebSessionStore/** Implementation of {@code WebSession} that delegates to a session instance ... */WebSession delegate, ...;InMemoryWebSessionStore sessionStorenew InMemoryWebSessionStore(...)WebSession sessioncreateWebSession(...)setClock(...)getCreationTime(...)getLastAccessTime(...)setMaxIdleTime(...)getMaxIdleTime(...)/** Mock implementations of Spring's reactive server web API abstractions. *//** {@code @Commit} is a test annotation that is used to indicate that a ... *//** Test annotation which indicates that the ... *//** The <i>mode</i> to use when a test method is annotated with ... *//** The <i>mode</i> to use when a test class is annotated with ... *//** The context cache clearing <em>mode</em> to use when a context is ... *//** Defines <i>modes</i> which determine how {@code @DirtiesContext} is ... */new MethodMode(...)MethodMode BEFORE_METHOD, ...;/** The associated {@code ApplicationContext} will be marked as ... */MethodMode AFTER_METHOD, ...;new ClassMode(...)ClassMode BEFORE_CLASS, ...;ClassMode BEFORE_EACH_TEST_METHOD, ...;ClassMode AFTER_EACH_TEST_METHOD, ...;ClassMode AFTER_CLASS, ...;/** Defines <i>modes</i> which determine how the context cache is cleared ... */new HierarchyMode(...)HierarchyMode EXHAUSTIVE, ...;/** The context cache will be cleared using an <em>exhaustive</em> algorithm ... */HierarchyMode CURRENT_LEVEL, ...;/** The {@code ApplicationContext} for the <em>current level</em> in the ... *//** Test annotation for use with JUnit 4 to indicate whether a test is enabled or ... *//** The {@code name} of the <em>profile value</em> against which to test. *//** A single, permissible {@code value} of the <em>profile value</em> ... *//** A list of all permissible {@code values} of the <em>profile value</em> ... *//** Get the <em>profile value</em> indicated by the specified key. ... *//** {@code ProfileValueSourceConfiguration} is a class-level annotation for use ... *//** The type of {@link ProfileValueSource} to use when retrieving ... *//** General utility methods for working with <em>profile values</em>. ... */ProfileValueUtils.class/** Retrieves the {@link ProfileValueSource} type for the specified ... */Class<ProfileValueSourceConfiguration> annotationTypeProfileValueSourceConfiguration.classProfileValueSourceConfiguration configClass<? extends ProfileValueSource> profileValueSourceTypeProfileValueSource profileValueSourceSystemProfileValueSource.class/** Determine if the supplied {@code testClass} is <em>enabled</em> in ... */IfProfileValue ifProfileValueIfProfileValue.classisTestEnabledInThisEnvironment(...)retrieveProfileValueSource(...)/** Determine if the supplied {@code testMethod} is <em>enabled</em> in ... */boolean classLevelEnabled/** Determine if the {@code value} (or one of the {@code values}) ... */String environmentValueString[] annotatedValuesannotatedValues.length/** Test annotation for use with JUnit 4 to indicate that a test method should be ... *//** The number of times that the annotated test method should be repeated. *//** {@code @Rollback} is a test annotation that is used to indicate whether ... *//** Whether the <em>test-managed transaction</em> should be rolled back ... *//** Implementation of {@link ProfileValueSource} which uses system properties as ... */new SystemProfileValueSource(...)SystemProfileValueSource INSTANCE, ...;/** Obtain the canonical instance of this ProfileValueSource. *//** Private constructor, enforcing the singleton pattern. *//** Get the <em>profile value</em> indicated by the specified key from the ... *//** Collection of utility methods for working with Spring's core testing annotations. ... *//** Get the {@code timeout} configured via the {@link Timed @Timed} ... */Timed timedTimed.class/** Get the repeat count configured via the {@link Repeat @Repeat} ... */Repeat repeatRepeat.class/** Test annotation for use with JUnit 4 to indicate that a test method has to finish ... *//** The maximum amount of time (in milliseconds) that a test execution can ... *//** Support classes for annotation-driven tests. *//** {@code ActiveProfiles} is a class-level annotation that is used to declare ... *//** Alias for {@link #profiles}. ... *//** The bean definition profiles to activate. ... *//** The type of {@link ActiveProfilesResolver} to use for resolving the active ... *//** Whether or not bean definition profiles from superclasses should be ... *//** Strategy interface for programmatically resolving which <em>active bean ... *//** Resolve the <em>bean definition profiles</em> to use when loading an ... *//** {@code BootstrapContext} encapsulates the context in which the <em>Spring ... *//** Get the {@linkplain Class test class} for this bootstrap context. ... *//** Get the {@link CacheAwareContextLoaderDelegate} to use for transparent ... */import AnnotationDescriptor/** {@code BootstrapUtils} is a collection of utility methods to assist with ... */loadWebAppConfigurationClass(...)BootstrapUtils.classString DEFAULT_BOOTSTRAP_CONTEXT_CLASS_NAME, ...;String DEFAULT_CACHE_AWARE_CONTEXT_LOADER_DELEGATE_CLASS_NAME, ...;String DEFAULT_TEST_CONTEXT_BOOTSTRAPPER_CLASS_NAME, ...;String DEFAULT_WEB_TEST_CONTEXT_BOOTSTRAPPER_CLASS_NAME, ...;String WEB_APP_CONFIGURATION_ANNOTATION_CLASS_NAME, ...;Class<? extends Annotation> webAppConfigurationClass, ...;/** Create the {@code BootstrapContext} for the specified {@linkplain Class test class}. ... */CacheAwareContextLoaderDelegate cacheAwareContextLoaderDelegatecreateCacheAwareContextLoaderDelegate(...)Class<? extends BootstrapContext> clazzConstructor<? extends BootstrapContext> constructorCacheAwareContextLoaderDelegate.classClass<? extends CacheAwareContextLoaderDelegate> clazz/** Resolve the {@link TestContextBootstrapper} type for the test class in the ... */Class<?> testClassgetTestClass(...)TestContextBootstrapper testContextBootstrapperTestContextBootstrapper.classresolveExplicitTestContextBootstrapper(...)resolveDefaultTestContextBootstrapper(...)setBootstrapContext(...)Set<BootstrapWith> annotationsnew LinkedHashSet<BootstrapWith>(...)AnnotationDescriptor<BootstrapWith> descriptorfindAnnotationDescriptor(...)BootstrapWith.classBootstrapWith bootstrapWithfindAllLocalMergedAnnotations(...)boolean webAppString bootstrapperClassName// Allow directly-present annotation to override annotations that are meta-present./** {@code @BootstrapWith} defines class-level metadata that is used to determine ... *//** The {@link TestContextBootstrapper} to use to bootstrap the <em>Spring ... */import HierarchyMode/** A {@code CacheAwareContextLoaderDelegate} is responsible for {@linkplain ... *//** Determine if the {@linkplain ApplicationContext application context} for ... *//** Load the {@linkplain ApplicationContext application context} for the supplied ... *//** Remove the {@linkplain ApplicationContext application context} for the ... */import ApplicationContextInitializer/** {@code @ContextConfiguration} defines class-level metadata that is used to determine ... *//** The resource locations to use for loading an ... *//** The <em>component classes</em> to use for loading an ... *//** The application context <em>initializer classes</em> to use for initializing ... *//** Whether or not {@linkplain #locations resource locations} or ... *//** Whether or not {@linkplain #initializers context initializers} from test ... *//** The type of {@link SmartContextLoader} (or {@link ContextLoader}) to use ... *//** The name of the context hierarchy level represented by this configuration. ... */import ToStringCreator/** {@code ContextConfigurationAttributes} encapsulates the context configuration ... */ContextConfigurationAttributes.class...[] EMPTY_LOCATIONS, ...;...[] EMPTY_CLASSES, ...;...[] classes, ...;boolean inheritLocations, ...;...[] initializers, ...;boolean inheritInitializers, ...;Class<? extends ContextLoader> contextLoaderClass, ...;/** Construct a new {@link ContextConfigurationAttributes} instance with default values. ... */ContextLoader.class/** Construct a new {@link ContextConfigurationAttributes} instance for the ... */inheritLocations(...)initializers(...)inheritInitializers(...)loader(...)this.classesthis.inheritLocationsthis.initializersthis.inheritInitializersthis.contextLoaderClass/** Get the {@linkplain Class class} that declared the ... *//** Set the <em>processed</em> annotated classes, effectively overriding the ... *//** Get the annotated classes that were declared via ... *//** Determine if this {@code ContextConfigurationAttributes} instance has ... */getClasses(...).lengthgetClasses(...)/** Set the <em>processed</em> resource locations, effectively overriding the ... *//** Get the resource locations that were declared via ... */getLocations(...).lengthgetLocations(...)hasLocations(...)hasClasses(...)/** Get the {@code inheritLocations} flag that was declared via ... *//** Get the {@code ApplicationContextInitializer} classes that were declared via ... *//** Get the {@code inheritInitializers} flag that was declared via ... *//** Get the name of the context hierarchy level that was declared via ... *//** Get the {@code ContextLoader} class that was declared via ... *//** Determine if the supplied object is equal to this ... */ContextConfigurationAttributes otherAttrotherAttr.declaringClassotherAttr.classesotherAttr.locationsotherAttr.inheritLocationsotherAttr.initializersotherAttr.inheritInitializersotherAttr.nameotherAttr.contextLoaderClass/** Generate a unique hash code for all properties of this ... *//** Provide a String representation of the context configuration attributes ... *//** Strategy interface for customizing {@link ConfigurableApplicationContext ... *//** Customize the supplied {@code ConfigurableApplicationContext} <em>after</em> ... *//** Factory for creating {@link ContextCustomizer ContextCustomizers}. ... *//** Create a {@link ContextCustomizer} that should be used to customize a ... *//** {@code @ContextHierarchy} is a class-level annotation that is used to define ... *//** A list of {@link ContextConfiguration @ContextConfiguration} instances, ... *//** Strategy interface for loading an {@link ApplicationContext application context} ... *//** Processes application context resource locations for a specified class. ... *//** Loads a new {@link ApplicationContext context} based on the supplied ... *//** Registry used with {@link DynamicPropertySource @DynamicPropertySource} ... *//** Add a {@link Supplier} for the given property name to this registry. ... *//** Method-level annotation for integration tests that need to add properties with ... *//** {@code MergedContextConfiguration} encapsulates the <em>merged</em> ... */Set<Class<? extends ApplicationContextInitializer<?>>> EMPTY_INITIALIZER_CLASSES, ...;Set<ContextCustomizer> EMPTY_CONTEXT_CUSTOMIZERS, ...;Class<?> testClass, ...;Set<Class<? extends ApplicationContextInitializer<?>>> contextInitializerClasses, ...;...[] activeProfiles, ...;...[] propertySourceLocations, ...;...[] propertySourceProperties, ...;Set<ContextCustomizer> contextCustomizers, ...;ContextLoader contextLoader, ...;CacheAwareContextLoaderDelegate cacheAwareContextLoaderDelegate, ...;MergedContextConfiguration parent, ...;/** Create a new {@code MergedContextConfiguration} instance for the ... *//** Create a new {@code MergedContextConfiguration} instance by copying ... */mergedConfig.testClassmergedConfig.locationsmergedConfig.classesmergedConfig.contextInitializerClassesmergedConfig.activeProfilesmergedConfig.propertySourceLocationsmergedConfig.propertySourcePropertiesmergedConfig.contextCustomizersmergedConfig.contextLoadermergedConfig.cacheAwareContextLoaderDelegatemergedConfig.parentthis.testClassprocessStrings(...)processClasses(...)this.contextInitializerClassesprocessContextInitializerClasses(...)processActiveProfiles(...)this.propertySourceLocationsthis.propertySourcePropertiesthis.contextCustomizersprocessContextCustomizers(...)this.contextLoaderthis.cacheAwareContextLoaderDelegate/** Get the {@linkplain Class test class} associated with this ... *//** Get the merged resource locations for {@code ApplicationContext} ... *//** Get the merged annotated classes for the {@linkplain #getTestClass() test class}. *//** Determine if this {@code MergedContextConfiguration} instance has ... *//** Get the merged {@code ApplicationContextInitializer} classes for the ... *//** Get the merged active bean definition profiles for the ... *//** Get the merged resource locations for test {@code PropertySources} ... *//** Get the merged test {@code PropertySource} properties for the ... *//** Get the merged {@link ContextCustomizer ContextCustomizers} that will be applied ... *//** Get the resolved {@link ContextLoader} for the {@linkplain #getTestClass() test class}. *//** Get the {@link MergedContextConfiguration} for the parent application context ... *//** Get the parent {@link ApplicationContext} for the context defined by this ... *//** Determine if the supplied object is equal to this {@code MergedContextConfiguration} ... */MergedContextConfiguration otherConfigotherConfig.locationsotherConfig.classesotherConfig.contextInitializerClassesotherConfig.activeProfilesotherConfig.propertySourceLocationsotherConfig.propertySourcePropertiesotherConfig.contextCustomizersotherConfig.parentotherConfig.contextLoader/** Provide a String representation of the {@linkplain #getTestClass() test class}, ... */Set<String> profilesSet/** Generate a null-safe {@link String} representation of the supplied ... */// Active profiles must be unique/** {@code @NestedTestConfiguration} is a type-level annotation that is used to ... */String ENCLOSING_CONFIGURATION_PROPERTY_NAME, ...;/** JVM system property used to change the default <em>enclosing configuration ... *//** Configures the {@link EnclosingConfiguration} mode. ... *//** Enumeration of <em>modes</em> that dictate how test configuration from ... */new EnclosingConfiguration(...)EnclosingConfiguration INHERIT, ...;/** Indicates that test configuration for an inner test class should be ... */EnclosingConfiguration OVERRIDE, ...;/** Indicates that test configuration for an inner test class should ... *//** Get the {@code EnclosingConfiguration} enum constant with the supplied ... */EnclosingConfiguration.class/** Processes the {@link ContextConfigurationAttributes} for a given test class. ... *//** {@code @TestConstructor} is a type-level annotation that is used to configure ... */String TEST_CONSTRUCTOR_AUTOWIRE_MODE_PROPERTY_NAME, ...;/** JVM system property used to change the default <em>test constructor ... *//** Flag for setting the <em>test constructor {@linkplain AutowireMode autowire ... *//** Defines autowiring modes for parameters in a test constructor. ... */new AutowireMode(...)AutowireMode ALL, ...;/** All test constructor parameters will be autowired as if the constructor ... */AutowireMode ANNOTATED, ...;/** Each individual test constructor parameter will only be autowired if it ... *//** Get the {@code AutowireMode} enum constant with the supplied name, ... */AutowireMode.class// Suppression required due to bug in javac in Java 8: presence of default method in a Serializable interface/** {@code TestContext} encapsulates the context in which a test is executed, ... *//** Get the {@linkplain ApplicationContext application context} for this ... *//** Publish the {@link ApplicationEvent} created by the given {@code eventFactory} ... */hasApplicationContext(...)/** Get the {@linkplain Class test class} for this test context. ... *//** Get the current {@linkplain Object test instance} for this test context. ... *//** Get the current {@linkplain Method test method} for this test context. ... *//** Get the {@linkplain Throwable exception} that was thrown during execution ... *//** Call this method to signal that the {@linkplain ApplicationContext application ... *//** Update this test context to reflect the state of the currently executing test. ... */import EnclosingConfiguration/** {@code TestContextAnnotationUtils} is a collection of utility methods that ... */new ConcurrentLruCache<Class<?>,EnclosingConfiguration>(...)new Function<Class<?>,EnclosingConfiguration>(...) { ... }lookUpEnclosingConfiguration(...)ConcurrentLruCache<Class<?>,EnclosingConfiguration> cachedEnclosingConfigurationModes, ...;EnclosingConfiguration defaultEnclosingConfigurationMode, ...;/** Determine if an annotation of the specified {@code annotationType} is ... */searchEnclosingClass(...)AnnotationDescriptor<T> descriptorSet<T> mergedAnnotations/** Find the {@link AnnotationDescriptor} for the supplied {@code annotationType} ... *//** Perform the search algorithm for {@link #findAnnotationDescriptor(Class, Class)}, ... */new AnnotationDescriptor<T>(...)Annotation composedAnnClass<? extends Annotation> composedType/** Find the {@link UntypedAnnotationDescriptor} for the first {@link Class} ... */assertNonEmptyAnnotationTypeArray(...)findAnnotationDescriptorForTypes(...)new HashSet<Annotation>(...)/** Perform the search algorithm for {@link #findAnnotationDescriptorForTypes(Class, Class...)}, ... */UntypedAnnotationDescriptor descriptornew UntypedAnnotationDescriptor(...)Annotation composedAnnotation/** Determine if annotations on the enclosing class of the supplied class ... */getEnclosingConfiguration(...)EnclosingConfiguration.INHERIT/** Get the {@link EnclosingConfiguration} mode for the supplied class. ... */Predicate<Class<?>> searchEnclosingClassNestedTestConfiguration nestedTestConfigurationNestedTestConfiguration.classgetDefaultEnclosingConfigurationMode(...)EnclosingConfiguration defaultConfigurationModeNestedTestConfiguration.ENCLOSING_CONFIGURATION_PROPERTY_NAMEEnclosingConfiguration enclosingConfigurationMode/** Descriptor for an {@link Annotation}, including the {@linkplain ... */Class<?> rootDeclaringClass, ...;T annotation, ...;T mergedAnnotationthis.rootDeclaringClass/** Get the merged annotation for this descriptor. *//** Find the next {@link AnnotationDescriptor} for the specified annotation ... */AnnotationDescriptor descriptorgetRootDeclaringClass(...)/** Find <strong>all</strong> annotations of the specified annotation type ... */new Function<MergedAnnotation<T>,Object>(...) { ... }/** Provide a textual representation of this {@code AnnotationDescriptor}. *//** <em>Untyped</em> extension of {@link AnnotationDescriptor} that is used ... */...[] annotationTypes, ...;/** Find the next {@link UntypedAnnotationDescriptor} for the specified ... *//** Throws an {@link UnsupportedOperationException} since the type of annotation ... */// Present (via @Inherited semantics), directly present, or meta-present?// Declared on an enclosing class of an inner class?// Then mimic @Inherited semantics within the enclosing class hierarchy.// Declared locally?// Declared on a composed annotation (i.e., as a meta-annotation)?// Declared on an interface?// Declared on a superclass?// @NestedTestConfiguration should not be discovered on an enclosing class// for a nested interface (which is always static), so our predicate simply// ensures that the candidate class is an inner class./** {@code TestContextBootstrapper} defines the SPI for bootstrapping the ... *//** Set the {@link BootstrapContext} to be used by this bootstrapper. *//** Get the {@link BootstrapContext} associated with this bootstrapper. *//** Build the {@link TestContext} for the {@link BootstrapContext} ... *//** Build the {@linkplain MergedContextConfiguration merged context configuration} ... *//** Get a list of newly instantiated {@link TestExecutionListener TestExecutionListeners} ... *//** {@code TestContextManager} is the main entry point into the <em>Spring ... */withInitial(...)new Supplier<TestContext>(...) { ... }copyTestContext(...)TestContextManager.this.testContextTestContextManager.thisnew ArrayList<TestExecutionListener>(...)TestContextManager.classTestContext testContext, ...;ThreadLocal<TestContext> testContextHolder, ...;List<TestExecutionListener> testExecutionListeners, ...;/** Construct a new {@code TestContextManager} for the supplied {@linkplain Class test class}. ... */resolveTestContextBootstrapper(...)createBootstrapContext(...)/** Construct a new {@code TestContextManager} using the supplied {@link TestContextBootstrapper} ... */this.testContextbuildTestContext(...)registerTestExecutionListeners(...)getTestExecutionListeners(...)/** Get the {@link TestContext} managed by this {@code TestContextManager}. */this.testContextHolder/** Register the supplied list of {@link TestExecutionListener TestExecutionListeners} ... */new TestExecutionListener[]/** Register the supplied array of {@link TestExecutionListener TestExecutionListeners} ... */TestExecutionListener listenerthis.testExecutionListeners/** Get the current {@link TestExecutionListener TestExecutionListeners} ... *//** Get a copy of the {@link TestExecutionListener TestExecutionListeners} ... */List<TestExecutionListener> listenersReversed/** Hook for pre-processing a test class <em>before</em> execution of any ... */getTestContext(...)updateState(...)TestExecutionListener testExecutionListenerbeforeTestClass(...)logException(...)/** Hook for preparing a test instance prior to execution of any individual ... */prepareTestInstance(...)/** Hook for pre-processing a test <em>before</em> execution of <em>before</em> ... */String callbackNameprepareForBeforeCallback(...)beforeTestMethod(...)handleBeforeException(...)/** Hook for pre-processing a test <em>immediately before</em> execution of ... */beforeTestExecution(...)/** Hook for post-processing a test <em>immediately after</em> execution of ... */Throwable afterTestExecutionExceptionprepareForAfterCallback(...)getReversedTestExecutionListeners(...)afterTestExecution(...)addSuppressed(...)/** Hook for post-processing a test <em>after</em> execution of <em>after</em> ... */Throwable afterTestMethodExceptionafterTestMethod(...)/** Hook for post-processing a test class <em>after</em> execution of all ... */Throwable afterTestClassExceptionafterTestClass(...)/** Attempt to create a copy of the supplied {@code TestContext} using its ... */Constructor<? extends TestContext> constructor// Implemented as an anonymous inner class instead of a lambda expression due to a bug// in Eclipse IDE: "The blank final field testContext may not have been initialized"// Traverse the TestExecutionListeners in reverse order to ensure proper// "wrapper"-style execution of listeners.// Fallback to original instance/** {@code TestExecutionListener} defines a <em>listener</em> API for reacting to ... *//** Pre-processes a test class <em>before</em> execution of all tests within ... *//** Prepares the {@link Object test instance} of the supplied ... *//** Pre-processes a test <em>before</em> execution of <em>before</em> ... *//** Pre-processes a test <em>immediately before</em> execution of the ... *//** Post-processes a test <em>immediately after</em> execution of the ... *//** Post-processes a test <em>after</em> execution of <em>after</em> ... *//** Post-processes a test class <em>after</em> execution of all tests within ... *//** {@code TestExecutionListeners} defines class-level metadata for configuring ... *//** Alias for {@link #listeners}. ... *//** The {@link TestExecutionListener TestExecutionListeners} to register with ... *//** Whether or not {@link #listeners TestExecutionListeners} from superclasses ... *//** The <em>merge mode</em> to use when {@code @TestExecutionListeners} is ... *//** Enumeration of <em>modes</em> that dictate whether or not explicitly ... */new MergeMode(...)MergeMode REPLACE_DEFAULTS, ...;/** Indicates that locally declared listeners should replace the default ... */MergeMode MERGE_WITH_DEFAULTS, ...;/** Indicates that locally declared listeners should be merged with the ... *//** {@code @TestPropertySource} is a class-level annotation that is used to ... */TestPropertySources.class/** The resource locations of properties files to be loaded into the ... *//** Whether or not test property source {@link #locations} from superclasses ... *//** <em>Inlined properties</em> in the form of <em>key-value</em> pairs that ... *//** Whether or not inlined test {@link #properties} from superclasses should ... *//** {@code @TestPropertySources} is a container for one or more ... *//** An array of one or more {@link TestPropertySource @TestPropertySource} ... */import MergedContextConfiguration/** {@code ContextCache} defines the SPI for caching Spring ... */String CONTEXT_CACHE_LOGGING_CATEGORY, ...;/** The name of the logging category used for reporting {@code ContextCache} ... */int DEFAULT_MAX_CONTEXT_CACHE_SIZE, ...;/** The default maximum size of the context cache: {@value}. ... */String MAX_CONTEXT_CACHE_SIZE_PROPERTY_NAME, ...;/** System property used to configure the maximum size of the {@link ContextCache} ... *//** Determine whether there is a cached context for the given key. ... *//** Obtain a cached {@code ApplicationContext} for the given key. ... *//** Explicitly add an {@code ApplicationContext} instance to the cache ... *//** Remove the context with the given key from the cache and explicitly ... *//** Determine the number of contexts currently stored in the cache. ... *//** Determine the number of parent contexts currently tracked within the cache. *//** Get the overall hit count for this cache. ... *//** Get the overall miss count for this cache. ... *//** Reset all state maintained by this cache including statistics. ... *//** Clear all contexts from the cache, clearing context hierarchy information as well. *//** Clear hit and miss count statistics for the cache (i.e., reset counters to zero). *//** Log the statistics for this {@code ContextCache} at {@code DEBUG} level ... *//** Collection of utilities for working with {@link ContextCache ContextCaches}. ... *//** Retrieve the maximum size of the {@link ContextCache}. ... */String maxSizeContextCache.MAX_CONTEXT_CACHE_SIZE_PROPERTY_NAMEContextCache.DEFAULT_MAX_CONTEXT_CACHE_SIZEimport CacheAwareContextLoaderDelegateimport ContextLoaderimport SmartContextLoader/** Default implementation of the {@link CacheAwareContextLoaderDelegate} interface. ... */DefaultCacheAwareContextLoaderDelegate.classnew DefaultContextCache(...)ContextCache defaultContextCache, ...;/** Default static cache of Spring application contexts. */ContextCache contextCache, ...;/** Construct a new {@code DefaultCacheAwareContextLoaderDelegate} using ... */this.contextCache/** Get the {@link ContextCache} used by this context loader delegate. *//** Load the {@code ApplicationContext} for the supplied merged context configuration. ... */ContextLoader contextLoadergetContextLoader(...)SmartContextLoader smartContextLoaderloadContextInternal(...)logStatistics(...)/** Default implementation of the {@link ContextCache} API. ... */new LruCache(...)new ConcurrentHashMap<MergedContextConfiguration,Set<MergedContextConfiguration>>(...)Log statsLogger, ...;Map<MergedContextConfiguration,ApplicationContext> contextMap, ...;/** Map of context keys to Spring {@code ApplicationContext} instances. */Map<MergedContextConfiguration,Set<MergedContextConfiguration>> hierarchyMap, ...;/** Map of parent keys to sets of children keys, representing a top-down <em>tree</em> ... */AtomicInteger hitCount, ...;AtomicInteger missCount, ...;/** Create a new {@code DefaultContextCache} using the maximum cache size ... */retrieveMaxCacheSize(...)/** Create a new {@code DefaultContextCache} using the supplied maximum ... *//** {@inheritDoc} */this.contextMapthis.missCountMergedContextConfiguration childMergedContextConfiguration parentSet<MergedContextConfiguration> listthis.hierarchyMapnew Function<MergedContextConfiguration,Set<MergedContextConfiguration>>(...) { ... }new HashSet<MergedContextConfiguration>(...)MergedContextConfiguration startKeyList<MergedContextConfiguration> removedContextsnew ArrayList<MergedContextConfiguration>(...)HierarchyMode.EXHAUSTIVEMergedContextConfiguration currentKeySet<MergedContextConfiguration> childrenEntry<MergedContextConfiguration,Set<MergedContextConfiguration>> entryMap<>.Entry<MergedContextConfiguration,Set<MergedContextConfiguration>>/** Get the maximum size of this cache. */clearStatistics(...)/** Generate a text string containing the implementation type of this ... */getMissCount(...)getParentContextCount(...)/** Simple cache implementation based on {@link LinkedHashMap} with a maximum ... *//** Create a new {@code LruCache} with the supplied initial capacity ... */Map<>.Entry<MergedContextConfiguration,ApplicationContext>DefaultContextCache.thisHierarchyMode.CURRENT_LEVEL// startKey is the level at which to begin clearing the cache,// depending on the configured hierarchy mode.s// Remove all remaining references to any removed contexts from the// hierarchy map.// Remove empty entries from the hierarchy map.// Recurse through lower levels// Remove the set of children for the current context from the hierarchy map.// Physically remove and close leaf nodes first (i.e., on the way back up the// stack as opposed to prior to the recursive call).// Do NOT delete "DefaultContextCache.this."; otherwise, we accidentally// invoke java.util.Map.remove(Object, Object).// Return false since we invoke a custom eviction algorithm./** Support for context caching within the <em>Spring TestContext Framework</em>. */import TestContext/** {@link TestContextEvent} published by the {@link EventPublishingTestExecutionListener} when ... *//** {@code ApplicationEvents} encapsulates all {@linkplain ApplicationEvent ... *//** Stream all application events that were fired during test execution. ... *//** Stream all application events or event payloads of the given type that ... *//** Clear all application events recorded by this {@code ApplicationEvents} instance. ... *//** {@link ApplicationListener} that listens to all events and adds them to the ... */DefaultApplicationEvents applicationEventsgetApplicationEvents(...)/** Holder class to expose the application events published during the execution ... */new ThreadLocal<DefaultApplicationEvents>(...)ThreadLocal<DefaultApplicationEvents> applicationEvents, ...;/** Get the {@link ApplicationEvents} for the current thread. ... */ApplicationEvents events/** Register a new {@link DefaultApplicationEvents} instance to be used for the ... */registerApplicationEvents(...)new DefaultApplicationEvents(...)/** Remove the registration of the {@link ApplicationEvents} for the current thread. */// no-op to prevent instantiation of this holder classimport TestContextAnnotationUtilsimport AbstractTestExecutionListener/** {@code TestExecutionListener} which provides support for {@link ApplicationEvents}. ... */ApplicationEventsTestExecutionListener.classString RECORD_APPLICATION_EVENTS, ...;/** Attribute name for a {@link TestContext} attribute which indicates ... */Object applicationEventsMonitor, ...;/** Returns {@code 1800}. */recordApplicationEvents(...)registerListenerAndResolvableDependencyIfNecessary(...)registerApplicationEventsIfNecessary(...)unregisterApplicationEvents(...)new Function<String,Boolean>(...) { ... }RecordApplicationEvents.classAbstractApplicationContext aacAbstractApplicationContext.classboolean notAlreadyRegisterednew Function<ApplicationListener<?>,Class<? extends Object>>(...) { ... }new Predicate<Class<? extends Object>>(...) { ... }ApplicationEventsApplicationListener.classnew ApplicationEventsApplicationListener(...)ApplicationEvents.classnew ApplicationEventsObjectFactory(...)/** Factory that exposes the current {@link ApplicationEvents} object on demand. */getRequiredApplicationEvents(...)// Register a new ApplicationEvents instance for the current thread// in case the test instance is shared -- for example, in TestNG or// JUnit Jupiter with @TestInstance(PER_CLASS) semantics.// Synchronize to avoid race condition in parallel test execution// Register a new ApplicationEventsApplicationListener.// Register ApplicationEvents as a resolvable dependency for @Autowired support in test classes./** Default implementation of {@link ApplicationEvents}. ... */List<ApplicationEvent> events, ...;new Function<ApplicationEvent,Object>(...) { ... }unwrapPayloadEvent(...)new Function<Object,T>(...) { ... }/** {@link org.springframework.test.context.TestExecutionListener TestExecutionListener} ... *//** Returns {@code 10000}. *//** Publish a {@link BeforeTestClassEvent} to the {@code ApplicationContext} ... */new Function<TestContext,ApplicationEvent>(...) { ... }new BeforeTestClassEvent(...)/** Publish a {@link PrepareTestInstanceEvent} to the {@code ApplicationContext} ... */new PrepareTestInstanceEvent(...)/** Publish a {@link BeforeTestMethodEvent} to the {@code ApplicationContext} ... */new BeforeTestMethodEvent(...)/** Publish a {@link BeforeTestExecutionEvent} to the {@code ApplicationContext} ... */new BeforeTestExecutionEvent(...)/** Publish an {@link AfterTestExecutionEvent} to the {@code ApplicationContext} ... */new AfterTestExecutionEvent(...)/** Publish an {@link AfterTestMethodEvent} to the {@code ApplicationContext} ... */new AfterTestMethodEvent(...)/** Publish an {@link AfterTestClassEvent} to the {@code ApplicationContext} ... */new AfterTestClassEvent(...)/** {@code @RecordApplicationEvents} is a class-level annotation that is used to ... *//** Base class for events published by the {@link EventPublishingTestExecutionListener}. ... *//** Create a new {@code TestContextEvent}. ... *//** Get the {@link TestContext} associated with this event. ... *//** Alias for {@link #getSource()}. ... */import AfterTestClassEventimport static ElementType.ANNOTATION_TYPEimport static ElementType.METHOD/** {@link EventListener @EventListener} annotation used to consume a ... */AfterTestClassEvent.class/** Alias for {@link EventListener#condition}. */import AfterTestExecutionEventAfterTestExecutionEvent.classimport AfterTestMethodEventAfterTestMethodEvent.classimport BeforeTestClassEventBeforeTestClassEvent.classimport BeforeTestExecutionEventBeforeTestExecutionEvent.classimport BeforeTestMethodEventBeforeTestMethodEvent.classimport PrepareTestInstanceEventPrepareTestInstanceEvent.classimport ErrorModeimport TransactionMode/** {@code MergedSqlConfig} encapsulates the <em>merged</em> {@link SqlConfig @SqlConfig} ... */String COMMENT_PREFIX, ...;String COMMENT_PREFIXES, ...;String dataSource, ...;String transactionManager, ...;TransactionMode transactionMode, ...;ErrorMode errorMode, ...;/** Construct a {@code MergedSqlConfig} instance by merging the configuration ... */AnnotationAttributes mergedAttributesthis.transactionModeTransactionMode.DEFAULTTransactionMode.INFERREDgetCommentPrefixes(...)this.errorModeErrorMode.DEFAULTErrorMode.FAIL_ON_ERRORAnnotationAttributes localAttributesSqlConfig globalSqlConfigSqlConfig.classAnnotationAttributes globalAttributesenforceCommentPrefixAliases(...)isExplicitValue(...)isEmptyArray(...)isEmptyString(...)/** Get the bean name of the {@link javax.sql.DataSource}. ... *//** Get the bean name of the {@link org.springframework.transaction.PlatformTransactionManager}. ... *//** Get the {@link TransactionMode}. ... *//** Get the encoding for the SQL scripts, if different from the platform ... *//** Get the character string used to separate individual statements within the ... *//** Get the prefixes that identify single-line comments within the SQL scripts. ... *//** Get the start delimiter that identifies block comments within the SQL scripts. ... *//** Get the end delimiter that identifies block comments within the SQL scripts. ... *//** Get the {@link ErrorMode}. ... *//** Provide a String representation of the merged SQL script configuration. */String[] commentPrefixesboolean explicitCommentPrefixboolean explicitCommentPrefixescommentPrefixes.lengthString[] commentPrefix/** Determine if the supplied value is an explicit value (i.e., not a default). */// Enforce comment prefix aliases within the local @SqlConfig.// Get global attributes, if any.// Use local attributes only?// Enforce comment prefix aliases within the global @SqlConfig.// Override global attribute with local attribute.// Ensure comment prefix aliases are honored during the merge.// We know commentPrefixes is an empty array, so make sure commentPrefix// is set to that as well in order to honor the alias contract./** {@code @Sql} is used to annotate a test class or test method to configure ... */SqlGroup.class/** Alias for {@link #scripts}. ... *//** The paths to the SQL scripts to execute. ... *//** <em>Inlined SQL statements</em> to execute. ... *//** When the SQL scripts and statements should be executed. ... *//** Local configuration for the SQL scripts and statements declared within ... *//** Enumeration of <em>phases</em> that dictate when SQL scripts are executed. */new ExecutionPhase(...)ExecutionPhase BEFORE_TEST_METHOD, ...;/** The configured SQL scripts and statements will be executed ... */ExecutionPhase AFTER_TEST_METHOD, ...;/** {@code @SqlConfig} defines metadata that is used to determine how to parse ... *//** The bean name of the {@link javax.sql.DataSource} against which the ... *//** The bean name of the {@link org.springframework.transaction.PlatformTransactionManager ... *//** The <em>mode</em> to use when determining whether SQL scripts should be ... *//** The encoding for the supplied SQL scripts, if different from the platform ... *//** The character string used to separate individual statements within the ... *//** The prefix that identifies single-line comments within the SQL scripts. ... *//** The prefixes that identify single-line comments within the SQL scripts. ... *//** The start delimiter that identifies block comments within the SQL scripts. ... *//** The end delimiter that identifies block comments within the SQL scripts. ... *//** The <em>mode</em> to use when an error is encountered while executing an ... *//** Enumeration of <em>modes</em> that dictate whether SQL scripts should be ... */new TransactionMode(...)TransactionMode DEFAULT, ...;/** Indicates that the <em>default</em> transaction mode should be used. ... */TransactionMode INFERRED, ...;/** Indicates that the transaction mode to use when executing SQL ... */TransactionMode ISOLATED, ...;/** Indicates that SQL scripts should always be executed in a new, ... *//** Enumeration of <em>modes</em> that dictate how errors are handled while ... */new ErrorMode(...)ErrorMode DEFAULT, ...;/** Indicates that the <em>default</em> error mode should be used. ... */ErrorMode FAIL_ON_ERROR, ...;/** Indicates that script execution will fail if an error is encountered. ... */ErrorMode CONTINUE_ON_ERROR, ...;/** Indicates that all errors in SQL scripts should be logged but not ... */ErrorMode IGNORE_FAILED_DROPS, ...;/** Indicates that failed SQL {@code DROP} statements can be ignored. ... *//** Container annotation that aggregates several {@link Sql @Sql} annotations. ... *//** {@code @SqlMergeMode} is used to annotate a test class or test method to ... *//** Indicates whether method-level {@code @Sql} annotations should be merged ... *//** Enumeration of <em>modes</em> that dictate whether method-level {@code @Sql} ... */MergeMode MERGE, ...;/** Indicates that method-level {@code @Sql} declarations should be merged ... */MergeMode OVERRIDE, ...;/** Indicates that method-level {@code @Sql} declarations should override ... */import ExecutionPhaseimport MergeModeimport TestContextTransactionUtilsimport TestContextResourceUtilsimport TransactionAttribute/** {@code TestExecutionListener} that provides support for executing SQL ... */SqlScriptsTestExecutionListener.class/** Returns {@code 5000}. *//** Execute SQL scripts configured via {@link Sql @Sql} for the supplied ... */executeSqlScripts(...)ExecutionPhase.BEFORE_TEST_METHODExecutionPhase.AFTER_TEST_METHODMethod testMethodmergeSqlAnnotations(...)getSqlAnnotationsFor(...)Set<Sql> methodLevelSqlAnnotations/** Determine if method-level {@code @Sql} annotations should be merged with ... */SqlMergeMode sqlMergeModegetSqlMergeModeFor(...)MergeMode.MERGE/** Get the {@code @SqlMergeMode} annotation declared on the supplied class. */SqlMergeMode.class/** Get the {@code @SqlMergeMode} annotation declared on the supplied method. *//** Get the {@code @Sql} annotations declared on the supplied class. */Sql.class/** Get the {@code @Sql} annotations declared on the supplied method. *//** Execute SQL scripts for the supplied {@link Sql @Sql} annotations. */new Consumer<Sql>(...) { ... }/** Execute the SQL scripts configured via the supplied {@link Sql @Sql} ... */MergedSqlConfig mergedSqlConfignew MergedSqlConfig(...)config(...)String[] scriptsgetScripts(...)List<Resource> scriptResourcesconvertToResourceList(...)String dsNameString tmNameretrieveDataSource(...)PlatformTransactionManager txMgrboolean newTxRequiredgetTransactionMode(...)TransactionMode.ISOLATEDexecutionPhase(...)convertToClasspathResourcePaths(...)String stmtstatements(...)DataSource dataSourceFromTxMgrgetDataSourceFromTransactionManager(...)DataSource finalDataSourceint propagationTransactionAttribute txAttrcreateDelegatingTransactionAttribute(...)sameDataSource(...)getBlockCommentStartDelimiter(...)getBlockCommentEndDelimiter(...)getErrorMode(...)ErrorMode.CONTINUE_ON_ERRORErrorMode.IGNORE_FAILED_DROPS/** Determine if the two data sources are effectively the same, unwrapping ... */unwrapResourceIfNecessary(...)scripts(...)detectDefaultScript(...)/** Detect a default SQL script by implementing the algorithm defined in ... */String prefixedResourcePathClassPathResource classPathResource// Execute scripts directly against the DataSource// Ensure user configured an appropriate DataSource/TransactionManager pair./** JDBC support classes for the <em>Spring TestContext Framework</em>, ... *//** Abstract base class for implementations of {@link ExecutionCondition} that ... */AbstractExpressionEvaluatingCondition.class/** Evaluate the expression configured via the supplied annotation type on ... */Optional<A> annotationnew Supplier<IllegalStateException>(...) { ... }boolean loadContextboolean evaluatedToTrueString reasonString adjectiveConfigurableBeanFactory configurableBeanFactoryBeanExpressionResolver expressionResolverBeanExpressionContext beanExpressionContextString contextType/** {@code @DisabledIf} is used to signal that the annotated test class or test ... */DisabledIfCondition.class/** Alias for {@link #expression}; only intended to be used if {@link #reason} ... *//** The expression that will be evaluated to determine if the annotated test ... *//** The reason this test is disabled. ... *//** Whether the {@code ApplicationContext} associated with the current test ... *//** {@code DisabledIfCondition} is an {@link org.junit.jupiter.api.extension.ExecutionCondition} ... *//** Containers and tests are disabled if {@code @DisabledIf} is present on the ... */evaluateAnnotation(...)DisabledIf.classnew Function<DisabledIf,String>(...) { ... }reason(...)new Function<DisabledIf,Boolean>(...) { ... }/** {@code @EnabledIf} is used to signal that the annotated test class or test ... */EnabledIfCondition.class/** The reason this test is enabled. ... *//** {@code EnabledIfCondition} is an {@link org.junit.jupiter.api.extension.ExecutionCondition} ... *//** Containers and tests are enabled if {@code @EnabledIf} is present on the ... */EnabledIf.classnew Function<EnabledIf,String>(...) { ... }new Function<EnabledIf,Boolean>(...) { ... }import AfterAllCallbackimport AfterTestExecutionCallbackimport BeforeAllCallbackimport BeforeEachCallbackimport BeforeTestExecutionCallbackimport Storeimport ParameterContextimport ParameterResolverimport TestInstancePostProcessorimport Testableimport ParameterResolutionDelegateimport TestConstructorimport TestContextManagerimport ApplicationEventsimport PropertyProviderimport TestConstructorUtils/** {@code SpringExtension} integrates the <em>Spring TestContext Framework</em> ... */SpringExtension.classBeforeAll.classAfterAll.classBeforeEach.classAfterEach.classTestable.classisAutowiredTestOrLifecycleMethod(...)Namespace TEST_CONTEXT_MANAGER_NAMESPACE, ...;/** {@link Namespace} in which {@code TestContextManagers} are stored, keyed ... */Namespace AUTOWIRED_VALIDATION_NAMESPACE, ...;/** {@link Namespace} in which {@code @Autowired} validation error messages ... */String NO_AUTOWIRED_VIOLATIONS_DETECTED, ...;List<Class<? extends Annotation>> JUPITER_ANNOTATION_TYPES, ...;// are all meta-annotated with @Testable.// Note that @Test, @TestFactory, @TestTemplate, @RepeatedTest, and @ParameterizedTestMethodFilter autowiredTestOrLifecycleMethodFilter, ...;/** Delegates to {@link TestContextManager#beforeTestClass}. */getTestContextManager(...)/** Delegates to {@link TestContextManager#afterTestClass}. */getStore(...)getRequiredTestClass(...)/** Delegates to {@link TestContextManager#prepareTestInstance}. ... */validateAutowiredConfig(...)/** Validate that test methods and test lifecycle methods in the supplied ... */Store storegetOrComputeIfAbsent(...)Method[] methodsWithErrorsmethodsWithErrors.length/** Delegates to {@link TestContextManager#beforeTestMethod}. */Object testInstancegetRequiredTestInstance(...)getRequiredTestMethod(...)/** Delegates to {@link TestContextManager#beforeTestExecution}. *//** Delegates to {@link TestContextManager#afterTestExecution}. */Throwable testExceptiongetExecutionException(...)/** Delegates to {@link TestContextManager#afterTestMethod}. *//** Determine if the value for the {@link Parameter} in the supplied {@link ParameterContext} ... */PropertyProvider junitPropertyProvidernew PropertyProvider(...) { ... }getConfigurationParameter(...)supportsApplicationEvents(...)isAutowirableConstructor(...)/** Resolve a value for the {@link Parameter} in the supplied {@link ParameterContext} by ... *//** Get the {@link ApplicationContext} associated with the supplied {@code ExtensionContext}. ... *//** Get the {@link TestContextManager} associated with the supplied {@code ExtensionContext}. ... */new Function<Class<?>,TestContextManager>(...) { ... }new TestContextManager(...)// We save the result in the ExtensionContext.Store so that we don't// re-validate all methods for the same test class multiple times.import ContextConfiguration/** {@code @SpringJUnitConfig} is a <em>composed annotation</em> that combines ... *//** Alias for {@link ContextConfiguration#classes}. *//** Alias for {@link ContextConfiguration#locations}. *//** Alias for {@link ContextConfiguration#initializers}. *//** Alias for {@link ContextConfiguration#inheritLocations}. *//** Alias for {@link ContextConfiguration#inheritInitializers}. *//** Alias for {@link ContextConfiguration#name}. *//** Core support for integrating the <em>Spring TestContext Framework</em> ... */import SpringExtensionimport WebAppConfiguration/** {@code @SpringJUnitWebConfig} is a <em>composed annotation</em> that combines ... */WebAppConfiguration.class/** Alias for {@link WebAppConfiguration#value}. *//** Web support for integrating the <em>Spring TestContext Framework</em> ... */import RunWithimport TestExecutionListenersimport ApplicationEventsTestExecutionListenerimport EventPublishingTestExecutionListenerimport DependencyInjectionTestExecutionListenerimport DirtiesContextBeforeModesTestExecutionListenerimport DirtiesContextTestExecutionListenerimport ServletTestExecutionListener/** Abstract base test class which integrates the <em>Spring TestContext ... */SpringRunner.classServletTestExecutionListener.classDirtiesContextBeforeModesTestExecutionListener.classDependencyInjectionTestExecutionListener.classEventPublishingTestExecutionListener.class/** The {@link ApplicationContext} that was injected into this test instance ... *//** Set the {@link ApplicationContext} to be used by this test instance, ... */import SqlScriptsTestExecutionListenerimport TransactionalTestExecutionListenerimport JdbcTestUtils/** Abstract {@linkplain Transactional transactional} extension of ... */TransactionalTestExecutionListener.class/** The {@code JdbcTemplate} that this base class manages, available to subclasses. ... *//** Set the {@code DataSource}, typically provided via Dependency Injection. ... *//** Specify the encoding for SQL scripts, if different from the platform encoding. ... *//** Convenience method for counting the rows in the given table. ... *//** Convenience method for counting the rows in the given table, using the ... */countRowsInTableWhere(...)/** Convenience method for deleting all rows from the specified tables. ... *//** Convenience method for deleting all rows from the given table, using the ... */deleteFromTableWhere(...)/** Convenience method for dropping all of the specified tables. ... */dropTables(...)import Ignoreimport ReflectiveCallableimport ExpectExceptionimport Failimport FailOnTimeoutimport RunNotifierimport BlockJUnit4ClassRunnerimport FrameworkMethodimport InitializationErrorimport ProfileValueUtilsimport TestAnnotationUtilsimport SpringClassRuleimport SpringMethodRuleimport RunAfterTestClassCallbacksimport RunAfterTestExecutionCallbacksimport RunAfterTestMethodCallbacksimport RunBeforeTestClassCallbacksimport RunBeforeTestExecutionCallbacksimport RunBeforeTestMethodCallbacksimport SpringFailOnTimeoutimport SpringRepeat/** {@code SpringJUnit4ClassRunner} is a custom extension of JUnit's ... */SpringJUnit4ClassRunner.classFrameworkMethod.classMethod withRulesMethod, ...;TestContextManager testContextManager, ...;SpringClassRule.classSpringMethodRule.class/** Construct a new {@code SpringJUnit4ClassRunner} and initialize a ... */ensureSpringRulesAreNotPresent(...)this.testContextManagercreateTestContextManager(...)/** Create a new {@link TestContextManager} for the supplied test class. ... *//** Get the {@link TestContextManager} associated with this runner. *//** Return a description suitable for an ignored test class if the test is ... */createSuiteDescription(...)/** Check whether the test is enabled in the current execution environment. ... */fireTestIgnored(...)/** Wrap the {@link Statement} returned by the parent implementation with a ... */Statement junitBeforeClasseswithBeforeClasses(...)new RunBeforeTestClassCallbacks(...)Statement junitAfterClasseswithAfterClasses(...)new RunAfterTestClassCallbacks(...)/** Delegate to the parent implementation for creating the test instance and ... */createTest(...)/** Perform the same logic as ... */Description descriptiondescribeChild(...)isTestMethodIgnored(...)methodBlock(...)new Fail(...)runLeaf(...)/** Augment the default JUnit behavior ... */methodInvoker(...)new ReflectiveCallable(...) { ... }withBeforeTestExecutionCallbacks(...)withAfterTestExecutionCallbacks(...)possiblyExpectingExceptions(...)withBefores(...)withAfters(...)withRulesReflectively(...)withPotentialRepeat(...)withPotentialTimeout(...)/** Invoke JUnit's private {@code withRules()} method using reflection. *//** Return {@code true} if {@link Ignore @Ignore} is present for the supplied ... */Ignore.classClass<? extends Throwable> expectedExceptiongetExpectedException(...)new ExpectException(...)/** Get the {@code exception} that the supplied {@linkplain FrameworkMethod ... */Test testTest.classexpected(...)Test.None.classTest.Nonelong springTimeoutgetSpringTimeout(...)long junitTimeoutgetJUnitTimeout(...)new SpringFailOnTimeout(...)withTimeout(...)/** Retrieve the configured JUnit {@code timeout} from the {@link Test @Test} ... */timeout(...)/** Retrieve the configured Spring-specific {@code timeout} from the ... *//** Wrap the supplied {@link Statement} with a {@code RunBeforeTestExecutionCallbacks} ... */new RunBeforeTestExecutionCallbacks(...)/** Wrap the supplied {@link Statement} with a {@code RunAfterTestExecutionCallbacks} ... */new RunAfterTestExecutionCallbacks(...)Statement junitBeforesnew RunBeforeTestMethodCallbacks(...)Statement junitAftersnew RunAfterTestMethodCallbacks(...)/** Wrap the supplied {@link Statement} with a {@code SpringRepeat} statement. ... */new SpringRepeat(...)// Retain the following warning suppression for deprecation (even if Eclipse// states it is unnecessary) since withPotentialTimeout(FrameworkMethod,Object,Statement)// in BlockJUnit4ClassRunner has been deprecated./** {@code SpringRunner} is an <em>alias</em> for the {@link SpringJUnit4ClassRunner}. ... *//** Construct a new {@code SpringRunner} and initialize a ... *//** Support classes for integrating the <em>Spring TestContext Framework</em> ... */import TestRuleimport ProfileValueChecker/** {@code SpringClassRule} is a custom JUnit {@link TestRule} that supports ... */new ConcurrentHashMap<Class<?>,TestContextManager>(...)Map<Class<?>,TestContextManager> testContextManagerCache, ...;/** Cache of {@code TestContextManagers} keyed by test class. *//** Apply <em>class-level</em> features of the <em>Spring TestContext ... */TestContextManager testContextManagerwithBeforeTestClassCallbacks(...)withAfterTestClassCallbacks(...)withProfileValueCheck(...)withTestContextManagerCacheEviction(...)/** Wrap the supplied {@link Statement} with a {@code RunBeforeTestClassCallbacks} statement. ... *//** Wrap the supplied {@link Statement} with a {@code RunAfterTestClassCallbacks} statement. ... *//** Wrap the supplied {@link Statement} with a {@code ProfileValueChecker} statement. ... */new ProfileValueChecker(...)/** Wrap the supplied {@link Statement} with a {@code TestContextManagerCacheEvictor} statement. ... */new TestContextManagerCacheEvictor(...)/** Get the {@link TestContextManager} associated with the supplied test class. ... */Statement next, ...;import MethodRuleimport RunPrepareTestInstanceCallbacks/** {@code SpringMethodRule} is a custom JUnit 4 {@link MethodRule} that ... *//** Apply <em>instance-level</em> and <em>method-level</em> features of ... */withBeforeTestMethodCallbacks(...)withAfterTestMethodCallbacks(...)withTestInstancePreparation(...)/** Wrap the supplied {@link Statement} with a {@code RunBeforeTestMethodCallbacks} statement. ... *//** Wrap the supplied {@link Statement} with a {@code RunAfterTestMethodCallbacks} statement. ... *//** Wrap the supplied {@link Statement} with a {@code RunPrepareTestInstanceCallbacks} statement. ... */new RunPrepareTestInstanceCallbacks(...)/** Wrap the supplied {@link Statement} with a {@code SpringFailOnTimeout} statement. ... *//** Custom JUnit 4 {@code Rules} used in the <em>Spring TestContext Framework</em>. */import AssumptionViolatedExceptionimport IfProfileValue/** {@code ProfileValueChecker} is a custom JUnit {@link Statement} that checks ... */Method testMethod, ...;/** Construct a new {@code ProfileValueChecker} statement. ... *//** Determine if the test specified by arguments to the ... */new AssumptionViolatedException(...)import MultipleFailureException/** {@code RunAfterTestClassCallbacks} is a custom JUnit {@link Statement} which allows ... *//** Construct a new {@code RunAfterTestClassCallbacks} statement. ... *//** Evaluate the next {@link Statement} in the execution chain (typically an instance of ... */List<Throwable> errorsassertEmpty(...)/** {@code RunAfterTestExecutionCallbacks} is a custom JUnit {@link Statement} ... */Object testInstance, ...;/** Construct a new {@code RunAfterTestExecutionCallbacks} statement. ... */this.testInstance/** Evaluate the next {@link Statement} in the execution chain (typically an ... *//** {@code RunAfterTestMethodCallbacks} is a custom JUnit {@link Statement} which allows ... *//** Construct a new {@code RunAfterTestMethodCallbacks} statement. ... *//** {@code RunBeforeTestClassCallbacks} is a custom JUnit {@link Statement} which allows ... *//** Construct a new {@code RunBeforeTestClassCallbacks} statement. ... *//** Invoke {@link TestContextManager#beforeTestClass()} and then evaluate ... *//** {@code RunBeforeTestExecutionCallbacks} is a custom JUnit {@link Statement} ... *//** Construct a new {@code RunBeforeTestExecutionCallbacks} statement. ... *//** Invoke {@link TestContextManager#beforeTestExecution(Object, Method)} ... *//** {@code RunBeforeTestMethodCallbacks} is a custom JUnit {@link Statement} which allows ... *//** Construct a new {@code RunBeforeTestMethodCallbacks} statement. ... *//** Invoke {@link TestContextManager#beforeTestMethod(Object, Method)} ... *//** {@code RunPrepareTestInstanceCallbacks} is a custom JUnit {@link Statement} which ... *//** Construct a new {@code RunPrepareTestInstanceCallbacks} statement. ... *//** Invoke {@link TestContextManager#prepareTestInstance(Object)} and ... *//** {@code SpringFailOnTimeout} is a custom JUnit {@link Statement} which adds ... *//** Construct a new {@code SpringFailOnTimeout} statement for the supplied ... *//** Evaluate the next {@link Statement statement} in the execution chain ... */long elapsednew TimeoutException(...)/** {@code SpringRepeat} is a custom JUnit {@link Statement} which adds support ... */SpringRepeat.classint repeat, ...;/** Construct a new {@code SpringRepeat} statement for the supplied ... */this.repeat/** Custom JUnit 4 {@code Statements} used in the <em>Spring TestContext Framework</em>. *//** This package contains the <em>Spring TestContext Framework</em> which ... */import ContextConfigurationAttributesimport ContextCustomizer/** Abstract application context loader that provides a basis for all concrete ... */AbstractContextLoader.class/** For backwards compatibility with the {@link ContextLoader} SPI, the ... */// SmartContextLoaderString[] processedLocationsprocessLocations(...)/** Prepare the {@link ConfigurableApplicationContext} created by this ... */addPropertiesFilesToEnvironment(...)getPropertySourceLocations(...)addInlinedPropertiesToEnvironment(...)getPropertySourceProperties(...)invokeApplicationContextInitializers(...)Set<Class<? extends ApplicationContextInitializer<?>>> initializerClassesgetContextInitializerClasses(...)List<ApplicationContextInitializer<ConfigurableApplicationContext>> initializerInstancesnew ArrayList<ApplicationContextInitializer<ConfigurableApplicationContext>>(...)Class<? extends ApplicationContextInitializer<?>> initializerClassClass<?> initializerContextClassApplicationContextInitializer<>.classApplicationContextInitializer<ConfigurableApplicationContext> initializer/** Customize the {@link ConfigurableApplicationContext} created by this ... */ContextCustomizer contextCustomizergetContextCustomizers(...)customizeContext(...)/** If the supplied {@code locations} are {@code null} or <em>empty</em> ... */// ContextLoadergenerateDefaultLocations(...)modifyLocations(...)isGenerateDefaultLocations(...)/** Generate the default classpath resource locations array based on the ... */String[] suffixesgetResourceSuffixes(...)/** Generate a modified version of the supplied locations array and return it. ... *//** Determine whether or not <em>default</em> resource locations should be ... *//** Get the suffixes to append to {@link ApplicationContext} resource locations ... */getResourceSuffix(...)/** Get the suffix to append to {@link ApplicationContext} resource locations ... */// no ApplicationContextInitializers have been declared -> nothing to do/** {@code AbstractDelegatingSmartContextLoader} serves as an abstract base class ... */AbstractDelegatingSmartContextLoader.class/** Get the delegate {@code SmartContextLoader} that supports XML configuration ... *//** Get the delegate {@code SmartContextLoader} that supports annotated classes. *//** {@code AbstractDelegatingSmartContextLoader} does not support the ... *//** Delegates to candidate {@code SmartContextLoaders} to process the supplied ... */delegateProcessing(...)getXmlLoader(...)getAnnotationConfigLoader(...)boolean xmlLoaderDetectedDefaults/** Delegates to an appropriate candidate {@code SmartContextLoader} to load ... */SmartContextLoader[] candidatesnew SmartContextLoader[]SmartContextLoader loaderdelegateLoading(...)processContextConfiguration(...)// If the original locations or classes were not empty, there's no// need to bother with default detection checks; just let the// appropriate loader process the configuration.// Else attempt to detect defaults...// Let the XML loader process the configuration.// Now let the annotation config loader process the configuration.// Determine if each loader can load a context from the mergedConfig. If it// can, let it; otherwise, keep iterating.// If neither of the candidates supports the mergedConfig based on resources but// ACIs or customizers were declared, then delegate to the annotation config// loader.// else...import ClassModeimport MethodMode/** Abstract base class for {@code TestExecutionListener} implementations that ... */AbstractDirtiesContextTestExecutionListener.class/** Mark the {@linkplain ApplicationContext application context} of the supplied ... */markApplicationContextDirty(...)DependencyInjectionTestExecutionListener.REINJECT_DEPENDENCIES_ATTRIBUTE/** Perform the actual work for {@link #beforeTestMethod} and {@link #afterTestMethod} ... */DirtiesContext methodAnnDirtiesContext.classDirtiesContext classAnnboolean methodAnnotatedboolean classAnnotatedMethodMode methodModemethodMode(...)ClassMode classModeclassMode(...)HierarchyMode hierarchyModehierarchyMode(...)dirtyContext(...)/** Perform the actual work for {@link #beforeTestClass} and {@link #afterTestClass} ... */DirtiesContext dirtiesContext/** Abstract, generic extension of {@link AbstractContextLoader} that loads a ... */AbstractGenericContextLoader.class/** Load a Spring ApplicationContext from the supplied {@link MergedContextConfiguration}. ... */getParentApplicationContext(...)validateMergedContextConfiguration(...)prepareContext(...)registerShutdownHook(...)/** Validate the supplied {@link MergedContextConfiguration} with respect to ... *//** Load a Spring ApplicationContext from the supplied {@code locations}. ... */createBeanDefinitionReader(...)/** Factory method for creating the {@link GenericApplicationContext} used by ... *//** Prepare the {@link GenericApplicationContext} created by this {@code ContextLoader}. ... *//** Customize the internal bean factory of the ApplicationContext created by ... *//** Load bean definitions into the supplied {@link GenericApplicationContext context} ... *//** Factory method for creating a new {@link BeanDefinitionReader} for loading ... *//** Customize the {@link GenericApplicationContext} created by this ... */import ContextCustomizerFactoryimport ContextHierarchyimport TestContextBootstrapper/** Abstract implementation of the {@link TestContextBootstrapper} interface which ... */BootstrapContext bootstrapContext, ...;this.bootstrapContext/** Build a new {@link DefaultTestContext} using the {@linkplain Class test class} ... */new DefaultTestContext(...)buildMergedContextConfiguration(...)getCacheAwareContextLoaderDelegate(...)getBootstrapContext(...)Class<TestExecutionListeners> annotationTypeTestExecutionListeners.classList<Class<? extends TestExecutionListener>> classesListnew ArrayList<Class<? extends TestExecutionListener>>(...)boolean usingDefaultsAnnotationDescriptor<TestExecutionListeners> descriptorCollection<Class<? extends TestExecutionListener>> classesToUseList<TestExecutionListener> listenersinstantiateListeners(...)getDefaultTestExecutionListenerClasses(...)TestExecutionListeners testExecutionListenersboolean inheritListenersinheritListeners(...)AnnotationDescriptor<TestExecutionListeners> parentDescriptormergeMode(...)MergeMode.MERGE_WITH_DEFAULTSlisteners(...)new LinkedHashSet<Class<? extends TestExecutionListener>>(...)Class<? extends TestExecutionListener> listenerClassBeanInstantiationException ex/** Get the default {@link TestExecutionListener} classes for this bootstrapper. ... */Set<Class<? extends TestExecutionListener>> defaultListenerClassesgetDefaultTestExecutionListenerClassNames(...)/** Get the names of the default {@link TestExecutionListener} classes for ... */List<String> classNamesTestExecutionListener.classSpringFactoriesLoader.FACTORIES_RESOURCE_LOCATIONContextHierarchy.classbuildDefaultMergedContextConfiguration(...)Map<String,List<ContextConfigurationAttributes>> hierarchyMapbuildContextHierarchyMap(...)MergedContextConfiguration parentConfigMergedContextConfiguration mergedConfigList<ContextConfigurationAttributes> listList<ContextConfigurationAttributes> reversedListnew ArrayList<ContextConfigurationAttributes>(...)resolveContextConfigurationAttributes(...)List<ContextConfigurationAttributes> defaultConfigAttributesListnew ContextConfigurationAttributes(...)resolveContextLoader(...)/** Build the {@link MergedContextConfiguration merged context configuration} ... */List<Class<?>> initializersSet<ContextCustomizer> contextCustomizersMergedTestPropertySources mergedTestPropertySourcesbuildMergedTestPropertySources(...)new MergedContextConfiguration(...)resolveInitializerClasses(...)resolveActiveProfiles(...)ContextConfigurationAttributes configAttributesgetInitializers(...)isInheritLocations(...)areAllEmpty(...)processMergedContextConfiguration(...)List<ContextCustomizerFactory> factoriesgetContextCustomizerFactories(...)Set<ContextCustomizer> customizersnew LinkedHashSet<ContextCustomizer>(...)ContextCustomizerFactory factoryContextCustomizer customizercreateContextCustomizer(...)/** Get the {@link ContextCustomizerFactory} instances for this bootstrapper. ... */ContextCustomizerFactory.class/** Resolve the {@link ContextLoader} {@linkplain Class class} to use for the ... */Class<? extends ContextLoader> contextLoaderClassresolveExplicitContextLoaderClass(...)getDefaultContextLoaderClass(...)/** Resolve the {@link ContextLoader} {@linkplain Class class} to use for the supplied ... */getContextLoaderClass(...)/** Determine the default {@link ContextLoader} {@linkplain Class class} ... *//** Process the supplied, newly instantiated {@link MergedContextConfiguration} instance. ... */new Predicate<Collection<?>>(...) { ... }// Use defaults?// Traverse the class hierarchy...// If there are no listeners to inherit, we might need to merge the// locally declared listeners with the defaults.// Remove possible duplicates if we loaded default listeners.// Sort by Ordered/@Order if we loaded default listeners.// TestExecutionListener not applicable due to a missing dependency// Don't use the supplied testClass; instead ensure that we are// building the MCC for the actual test class that declared the// configuration for the current level in the context hierarchy.// Return the last level in the context hierarchy// Legacy ContextLoaders don't know how to process classes/** Abstract {@linkplain Ordered ordered} implementation of the ... *//** The default implementation returns {@link Ordered#LOWEST_PRECEDENCE}, ... *//** The default implementation is <em>empty</em>. Can be overridden by ... */import ActiveProfilesimport ActiveProfilesResolverimport static TestContextAnnotationUtils.findAnnotationDescriptor/** Utility methods for working with {@link ActiveProfiles @ActiveProfiles} and ... */ActiveProfilesUtils.classnew DefaultActiveProfilesResolver(...)DefaultActiveProfilesResolver defaultActiveProfilesResolver, ...;/** Resolve <em>active bean definition profiles</em> for the supplied {@link Class}. ... */AnnotationDescriptor<ActiveProfiles> descriptorActiveProfiles.classList<String[]> profileArraysSet<String> activeProfilesClass<?> rootDeclaringClassActiveProfiles annotationActiveProfilesResolver resolverClass<? extends ActiveProfilesResolver> resolverClassresolver(...)String[] profilesActiveProfilesResolver.classinheritProfiles(...)// Prepend to the list so that we can later traverse "down" the hierarchy// to ensure that we retain the top-down profile registration order// within a test class hierarchy./** Concrete implementation of {@link AbstractGenericContextLoader} that loads ... */AnnotationConfigContextLoader.class/** Process <em>component classes</em> in the supplied {@link ContextConfigurationAttributes}. ... */setClasses(...)detectDefaultConfigurationClasses(...)/** Detect the default configuration classes for the supplied test class. ... */// AnnotationConfigContextLoader/** {@code AnnotationConfigContextLoader} should be used as a ... */// AbstractContextLoader/** Ensure that the supplied {@link MergedContextConfiguration} does not ... */// AbstractGenericContextLoader/** Register classes in the supplied {@link GenericApplicationContext context} ... */Class<?>[] componentClasses/** Utility methods for {@link SmartContextLoader SmartContextLoaders} that deal ... */AnnotationConfigContextLoaderUtils.classList<Class<?>> configClassesisDefaultConfigurationClassCandidate(...)/** Determine if the supplied {@link Class} meets the criteria for being ... */isStaticNonPrivateAndNonFinal(...)/** Utility methods for working with ... */ApplicationContextInitializerUtils.class/** Resolve the set of merged {@code ApplicationContextInitializer} classes for the ... */new LinkedHashSet<Class<? extends ApplicationContextInitializer<?>>>(...)isInheritInitializers(...)import UntypedAnnotationDescriptorimport static TestContextAnnotationUtils.findAnnotationDescriptorForTypes/** Utility methods for resolving {@link ContextConfigurationAttributes} from the ... */ContextLoaderUtils.classString GENERATED_CONTEXT_HIERARCHY_LEVEL_PREFIX, ...;/** Resolve the list of lists of {@linkplain ContextConfigurationAttributes context ... */Class<ContextConfiguration> contextConfigTypeClass<ContextHierarchy> contextHierarchyTypeList<List<ContextConfigurationAttributes>> hierarchyAttributesnew ArrayList<List<ContextConfigurationAttributes>>(...)UntypedAnnotationDescriptor descboolean contextConfigDeclaredLocallyboolean contextHierarchyDeclaredLocallyList<ContextConfigurationAttributes> configAttributesListContextConfiguration contextConfigurationconvertContextConfigToConfigAttributesAndAddToList(...)ContextHierarchy contextHierarchy/** Build a <em>context hierarchy map</em> for the supplied {@linkplain Class ... */Map<String,List<ContextConfigurationAttributes>> mapnew LinkedHashMap<String,List<ContextConfigurationAttributes>>(...)int hierarchyLevelSet<List<ContextConfigurationAttributes>> setnew HashSet<List<ContextConfigurationAttributes>>(...)resolveContextHierarchyAttributes(...)/** Resolve the list of {@linkplain ContextConfigurationAttributes context ... */Class<ContextConfiguration> annotationTypeAnnotationDescriptor<ContextConfiguration> descriptorList<ContextConfigurationAttributes> attributesListContextConfiguration previousAnnotationClass<?> previousDeclaringClassContextConfiguration currentAnnotationhasResources(...)locations(...).lengthclasses(...).length/** Convenience method for creating a {@link ContextConfigurationAttributes} ... */ContextConfigurationAttributes attributes// This should theoretically never happen...// Assign a generated name?// Encountered a new context hierarchy level?// Check for uniqueness// Don't ignore duplicate @ContextConfiguration declaration without resources,// because the ContextLoader will likely detect default resources specific to the// annotated class./** Default implementation of the {@link ActiveProfilesResolver} strategy that ... */DefaultActiveProfilesResolver.class/** Resolve the <em>bean definition profiles</em> for the given {@linkplain ... */profiles(...)/** Default implementation of the {@link BootstrapContext} interface. ... *//** Construct a new {@code DefaultBootstrapContext} from the supplied arguments. ... *//** Provide a String representation of this bootstrap context's state. *//** Default implementation of the {@link TestContext} interface. ... */MergedContextConfiguration mergedContextConfiguration, ...;Throwable testException, ...;/** <em>Copy constructor</em> for creating a new {@code DefaultTestContext} ... */testContext.testClasstestContext.mergedContextConfigurationtestContext.cacheAwareContextLoaderDelegatetestContext.attributes/** Construct a new {@code DefaultTestContext} from the supplied arguments. ... */this.mergedContextConfigurationisContextLoaded(...)ConfigurableApplicationContext cac/** Mark the {@linkplain ApplicationContext application context} associated ... */closeContext(...)this.testException/** Provide a String representation of this test context's state. *//** Default implementation of the {@link TestContextBootstrapper} SPI. ... *//** Returns {@link DelegatingSmartContextLoader}. */DelegatingSmartContextLoader.class/** {@code DelegatingSmartContextLoader} is a concrete implementation of ... */String GROOVY_XML_CONTEXT_LOADER_CLASS_NAME, ...;boolean groovyPresent, ...;SmartContextLoader xmlLoader, ...;SmartContextLoader annotationConfigLoader, ...;Class<?> loaderClassthis.xmlLoadernew GenericXmlContextLoader(...)this.annotationConfigLoadernew AnnotationConfigContextLoader(...)/** {@code TestExecutionListener} which provides support for dependency ... */String REINJECT_DEPENDENCIES_ATTRIBUTE, ...;/** Returns {@code 2000}. *//** Performs dependency injection on the ... */injectDependencies(...)/** If the {@link #REINJECT_DEPENDENCIES_ATTRIBUTE} in the supplied ... *//** Performs dependency injection and bean initialization for the supplied ... */getTestInstance(...)import static ClassMode.BEFORE_CLASSimport static ClassMode.BEFORE_EACH_TEST_METHODimport static MethodMode.BEFORE_METHOD/** {@code TestExecutionListener} which provides support for marking the ... *//** Returns {@code 1500}. *//** If the test class of the supplied {@linkplain TestContext test context} ... */beforeOrAfterTestClass(...)/** If the current test method of the supplied {@linkplain TestContext test ... */beforeOrAfterTestMethod(...)import static ClassMode.AFTER_CLASSimport static ClassMode.AFTER_EACH_TEST_METHODimport static MethodMode.AFTER_METHOD/** Returns {@code 3000}. */import DynamicPropertyRegistryimport DynamicPropertySource/** {@link ContextCustomizer} to support ... */String PROPERTY_SOURCE_NAME, ...;Set<Method> methods, ...;new Consumer<Method>(...) { ... }assertValid(...)DynamicPropertyRegistry.classnew DynamicValuesPropertySource(...)buildDynamicPropertiesMap(...)Map<String,Supplier<Object>> mapnew LinkedHashMap<String,Supplier<Object>>(...)DynamicPropertyRegistry dynamicPropertyRegistrynew DynamicPropertyRegistry(...) { ... }(...).methods/** {@link ContextCustomizerFactory} to support ... */findMethods(...)new DynamicPropertiesContextCustomizer(...)DynamicPropertySource.classimport EnumerablePropertySource/** {@link EnumerablePropertySource} backed by a map with dynamically supplied ... */Supplier<Object> valueSupplier/** Concrete implementation of {@link AbstractGenericContextLoader} that reads ... *//** Returns {@code "-context.xml"} and {@code "Context.groovy"} in order to ... *//** {@code GenericGroovyXmlContextLoader} supports both Groovy and XML ... *//** Creates a new {@link org.springframework.beans.factory.support.PropertiesBeanDefinitionReader}. ... *//** Returns &quot;{@code -context.properties}&quot;. *//** Create a new {@link XmlBeanDefinitionReader}. ... *//** Returns {@code "-context.xml"} in order to support detection of a ... */import TestPropertySource/** {@code MergedTestPropertySources} encapsulates the <em>merged</em> ... */new MergedTestPropertySources(...)MergedTestPropertySources empty, ...;...[] properties, ...;/** Factory for an <em>empty</em> {@code MergedTestPropertySources} instance. *//** Create a {@code MergedTestPropertySources} instance with the supplied ... *//** Get the resource locations of properties files. ... *//** Get the properties in the form of <em>key-value</em> pairs. ... *//** Determine if the supplied object is equal to this {@code MergedTestPropertySources} ... */MergedTestPropertySources thatthat.locationsthat.properties/** Provide a String representation of this {@code MergedTestPropertySources} ... *//** Strategy for providing named properties &mdash; for example, for looking up ... *//** Get the value of the named property. ... */import AutowireMode/** Utility methods for working with {@link TestConstructor @TestConstructor}. ... *//** Determine if the supplied executable for the given test class is an ... *//** Determine if the supplied constructor for the given test class is ... */AutowireMode autowireModeTestConstructor testConstructorTestConstructor.classautowireMode(...)TestConstructor.TEST_CONSTRUCTOR_AUTOWIRE_MODE_PROPERTY_NAMEAutowireMode.ALL// Is the constructor annotated with @Autowired?// Is the test class annotated with @TestConstructor?// Custom global default from SpringProperties?// Use fallback provider?/** {@code TestPropertySourceAttributes} encapsulates attributes declared ... */TestPropertySourceAttributes.classMergedAnnotation<?> rootAnnotation, ...;List<String> properties, ...;boolean inheritProperties, ...;this.rootAnnotationthis.inheritPropertiesaddPropertiesAndLocationsFrom(...)/** Merge this {@code TestPropertySourceAttributes} instance with the ... */attributes.declaringClassassertSameBooleanAttribute(...)attributes.inheritLocationsattributes.inheritPropertiesmergePropertiesAndLocationsFrom(...)that.rootAnnotationthat.declaringClassString[] propertiesaddPropertiesAndLocations(...)detectDefaultPropertiesFile(...)/** Add all of the supplied elements to the provided list, honoring the ... *//** Get the {@linkplain Class class} that declared {@code @TestPropertySource}. ... *//** Get the resource locations that were declared via {@code @TestPropertySource}. ... *//** Get the {@code inheritLocations} flag that was declared via {@code @TestPropertySource}. ... *//** Get the inlined properties that were declared via {@code @TestPropertySource}. ... *//** Get the {@code inheritProperties} flag that was declared via {@code @TestPropertySource}. ... */TestPropertySourceAttributes thatthat.inheritLocationsthat.inheritProperties/** Provide a String representation of the {@code @TestPropertySource} ... *//** Utility methods for working with {@link TestPropertySource @TestPropertySource} ... */TestPropertySourceUtils.classString INLINED_PROPERTIES_PROPERTY_SOURCE_NAME, ...;/** The name of the {@link MapPropertySource} created from <em>inlined properties</em>. ... */List<TestPropertySourceAttributes> attributesListnew ArrayList<TestPropertySourceAttributes>(...)TestPropertySourceAttributes previousAttributesList<MergedAnnotation<TestPropertySource>> aggregatedAnnotationsList<TestPropertySourceAttributes> aggregatedAttributesListnew Function<MergedAnnotation<TestPropertySource>,TestPropertySourceAttributes>(...) { ... }new TestPropertySourceAttributes(...)TestPropertySourceAttributes mergedAttributesmergeTestPropertySourceAttributes(...)duplicationDetected(...)mergeLocations(...)TestPropertySourceAttributes currentAttributesmergeWith(...)boolean duplicationDetectedTestPropertySourceAttributes attrsString[] locationsArrayList<String> propertiesString[] attrPropsisInheritProperties(...)/** Add the {@link Properties} files from the given resource {@code locations} ... *//** Add the given <em>inlined properties</em> to the {@link Environment} of the ... *//** Add the given <em>inlined properties</em> (in the form of <em>key-value</em> ... */MapPropertySource psconvertInlinedPropertiesToMap(...)/** Convert the supplied <em>inlined properties</em> (in the form of <em>key-value</em> ... */String pairstringPropertyNames(...)List<List<MergedAnnotation<T>>> listOfListsnew ArrayList<List<MergedAnnotation<T>>>(...)new ArrayList<MergedAnnotation<T>>(...)highMetaDistancesFirst(...)new Consumer<MergedAnnotation<T>>(...) { ... }// Iterate over all aggregate levels, where each level is represented by// a list of merged annotations found at that level (e.g., on a test// class in the class hierarchy).// Convert all of the merged annotations for the current aggregate// level to a list of TestPropertySourceAttributes.// Merge all TestPropertySourceAttributes instances for the current// aggregate level into a single TestPropertySourceAttributes instance.// Ensure we have a list for the current aggregate index./** Support classes for the <em>Spring TestContext Framework</em>. */import IHookCallBackimport IHookableimport ITestResultimport AfterClassimport AfterMethodimport BeforeClassimport BeforeMethod/** Abstract base test class which integrates the <em>Spring TestContext Framework</em> ... *//** Construct a new {@code AbstractTestNGSpringContextTests} instance and initialize ... *//** Delegates to the configured {@link TestContextManager} to call ... *//** Delegates to the configured {@link TestContextManager} to ... *//** Delegates to the {@linkplain IHookCallBack#runTestMethod(ITestResult) test ... */getConstructorOrMethod(...)boolean beforeCallbacksExecutedrunTestMethod(...)getTestResultException(...)throwAsUncheckedException(...)Throwable testResultExceptiongetThrowable(...)throwAs(...)// Appeasing the compiler: the following line will never be executed./** <p>Test annotation which indicates that the annotated {@code void} method ... */import TransactionManagementConfigurerimport DelegatingTransactionAttribute/** Utility methods for working with transactions and data access related beans ... */TestContextTransactionUtils.classString DEFAULT_DATA_SOURCE_NAME, ...;/** Default bean name for a {@link DataSource}: {@code "dataSource"}. */String DEFAULT_TRANSACTION_MANAGER_NAME, ...;/** Default bean name for a {@link PlatformTransactionManager}: ... *//** Retrieve the {@link DataSource} to use for the supplied {@linkplain TestContext ... */logBeansException(...)/** Retrieve the {@linkplain PlatformTransactionManager transaction manager} ... */Map<String,TransactionManagementConfigurer> configurersTransactionManagementConfigurer.classMap<String,PlatformTransactionManager> txMgrsTransactionManager tmannotationDrivenTransactionManager(...)/** Create a delegating {@link TransactionAttribute} for the supplied target ... */new TestContextTransactionAttribute(...)// Look up by type and explicit name// Look up single bean by type// look up single bean by type, with support for 'primary' beans// look up by type and default name// Look up single TransactionManagementConfigurer// Look up single bean by type, with support for 'primary' beans/** {@code TestTransaction} provides a collection of static utility methods for ... *//** Determine whether a test-managed transaction is currently <em>active</em>. ... */TransactionContext transactionContextgetCurrentTransactionContext(...)getTransactionStatus(...)/** Determine whether the current test-managed transaction has been ... */isFlaggedForRollback(...)requireCurrentTransactionContext(...)/** Flag the current test-managed transaction for <em>rollback</em>. ... */setFlaggedForRollback(...)/** Flag the current test-managed transaction for <em>commit</em>. ... *//** Start a new test-managed transaction. ... */startTransaction(...)/** Immediately force a <em>commit</em> or <em>rollback</em> of the ... */TransactionContext txContext/** Transaction context for a specific {@link TestContext}. ... */TransactionContext.classTransactionDefinition transactionDefinition, ...;boolean defaultRollback, ...;boolean flaggedForRollback, ...;AtomicInteger transactionsStarted, ...;this.defaultRollbackthis.flaggedForRollback/** Has the current transaction been flagged for rollback? ... *//** Start a new transaction for the configured test context. ... */int transactionsStartedthis.transactionsStarted/** Immediately force a <em>commit</em> or <em>rollback</em> of the transaction for the ... *//** {@link InheritableThreadLocal}-based holder for the current {@link TransactionContext}. ... */new NamedInheritableThreadLocal<TransactionContext>(...)ThreadLocal<TransactionContext> currentTransactionContext, ...;import Commitimport Rollbackimport AnnotationTransactionAttributeSourceimport TransactionAttributeSource/** {@code TestExecutionListener} that provides support for executing tests ... */new AnnotationTransactionAttributeSource(...) { ... }TransactionAttribute resultfindTransactionAttribute(...)findTransactionAttributeInEnclosingClassHierarchy(...)TransactionAttributeSource attributeSource, ...;// Do not require @Transactional test methods to be public./** Returns {@code 4000}. *//** If the test method of the supplied {@linkplain TestContext test context} ... */removeCurrentTransactionContext(...)PlatformTransactionManager tmTransactionAttribute transactionAttributegetTransactionAttribute(...)getPropagationBehavior(...)new TransactionContext(...)isRollback(...)runBeforeTransactionMethods(...)setCurrentTransactionContext(...)/** If a transaction is currently active for the supplied ... */runAfterTransactionMethods(...)/** Run all {@link BeforeTransaction @BeforeTransaction} methods for the ... */BeforeTransaction.class/** Run all {@link AfterTransaction @AfterTransaction} methods for the ... */Throwable afterTransactionExceptionAfterTransaction.class/** Get the {@linkplain PlatformTransactionManager transaction manager} to use ... *//** Get the {@linkplain PlatformTransactionManager transaction manager} ... *//** Determine whether or not to rollback transactions by default for the ... */Rollback rollbackRollback.classboolean rollbackPresentboolean defaultRollback/** Determine whether or not to rollback transactions for the supplied ... */boolean rollbackisDefaultRollback(...)Rollback rollbackAnnotationboolean rollbackOverride/** Get all methods in the supplied {@link Class class} and its superclasses ... */MethodFilter methodFilter// @Transactional present in inheritance hierarchy?// @Transactional present in enclosing class hierarchy?// If there was (or perhaps still is) a transaction...// If the transaction is still active...// Look up by type and qualifier from @Transactional// Use autowire-capable factory in order to support extended qualifier matching// (only exposed on the internal BeanFactory, not on the ApplicationContext)./** Transactional support classes for the <em>Spring TestContext Framework</em>. *//** Utility methods for working with resources within the <em>Spring TestContext ... */String SLASH, ...;Pattern PLACEHOLDER_PATTERN, ...;/** Convert the supplied paths to classpath resource paths. ... */String[] convertedPaths/** Convert the supplied paths to an array of {@link Resource} handles using ... *//** Convert the supplied paths to a list of {@link Resource} handles using ... */new Function<String,Resource>(...) { ... }// Absolute path// Relative path// URL/** Common utilities used within the <em>Spring TestContext Framework</em>. */import FileSystemResourceLoaderimport AbstractContextLoaderAbstractGenericWebContextLoader.class/** Load a Spring {@link WebApplicationContext} from the supplied ... */WebMergedContextConfiguration webMergedConfigconfigureWebResources(...)/** Validate the supplied {@link WebMergedContextConfiguration} with respect to ... *//** Configures web resources for the supplied web application context (WAC). ... */String resourceBasePathgetResourceBasePath(...)new FileSystemResourceLoader(...)ServletContext servletContext/** Customize the internal bean factory of the {@code WebApplicationContext} ... *//** Load bean definitions into the supplied {@link GenericWebApplicationContext context} ... *//** Customize the {@link GenericWebApplicationContext} created by this context ... *//** {@code AbstractGenericWebContextLoader} should be used as a ... */// If the WebApplicationContext has no parent or the parent is not a WebApplicationContext,// set the current context as the root WebApplicationContext:// Find the root WebApplicationContextimport AnnotationConfigContextLoaderUtils/** Concrete implementation of {@link AbstractGenericWebContextLoader} that loads ... */AnnotationConfigWebContextLoader.class/** Process <em>annotated classes</em> in the supplied {@link ContextConfigurationAttributes}. ... *//** {@code AnnotationConfigWebContextLoader} should be used as a ... *//** Register classes in the supplied {@linkplain GenericWebApplicationContext context} ... */// AbstractGenericWebContextLoaderClass<?>[] annotatedClasses/** Ensure that the supplied {@link WebMergedContextConfiguration} does not ... *//** Returns {@code "-context.xml" and "Context.groovy"} in order to ... *//** {@code GenericGroovyXmlWebContextLoader} supports both Groovy and XML ... */import RequestAttributes/** {@code TestExecutionListener} which provides mock Servlet API support to ... */String RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE, ...;String POPULATED_REQUEST_CONTEXT_HOLDER_ATTRIBUTE, ...;/** Attribute name for a {@link TestContext} attribute which indicates that ... */String CREATED_BY_THE_TESTCONTEXT_FRAMEWORK, ...;/** Attribute name for a request attribute which indicates that the ... */String ACTIVATE_LISTENER, ...;/** Attribute name for a {@link TestContext} attribute which indicates that the ... *//** Returns {@code 1000}. *//** Sets up thread-local state during the <em>test instance preparation</em> ... */setUpRequestContextIfNecessary(...)/** Sets up thread-local state before each test method via Spring Web's ... *//** If the {@link #RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE} in the supplied ... */alreadyPopulatedRequestContextHolder(...)isActivated(...)MockServletContext mockServletContextServletWebRequest servletWebRequestConfigurableApplicationContext configurableApplicationContextMockHttpServletResponse.classServletWebRequest.class/** {@code @WebAppConfiguration} is a class-level annotation that is used to ... *//** The resource path to the root directory of the web application. ... */import AbstractDelegatingSmartContextLoader/** {@code WebDelegatingSmartContextLoader} is a concrete implementation of ... */WebDelegatingSmartContextLoader.classString GROOVY_XML_WEB_CONTEXT_LOADER_CLASS_NAME, ...;new GenericXmlWebContextLoader(...)new AnnotationConfigWebContextLoader(...)/** {@code WebMergedContextConfiguration} encapsulates the <em>merged</em> ... *//** Create a new {@code WebMergedContextConfiguration} instance by copying ... *//** Create a new {@code WebMergedContextConfiguration} instance for the ... *//** Get the resource path to the root directory of the web application for the ... *//** Determine if the supplied object is equal to this {@code WebMergedContextConfiguration} ... */(...).resourceBasePathimport DefaultTestContextBootstrapper/** Web-specific implementation of the {@link TestContextBootstrapper} SPI. ... *//** Returns {@link WebDelegatingSmartContextLoader} if the supplied class is ... */getWebAppConfiguration(...)/** Returns a {@link WebMergedContextConfiguration} if the test class in the ... */WebAppConfiguration webAppConfigurationnew WebMergedContextConfiguration(...)/** Web support classes for the <em>Spring TestContext Framework</em>. */import ClientEndpointConfigimport DeploymentExceptionimport Endpointimport Extensionimport ServerContainerimport ServerEndpointConfig/** Mock implementation of the {@link javax.websocket.server.ServerContainer} interface. ... */long defaultAsyncSendTimeout, ...;long defaultMaxSessionIdleTimeout, ...;int defaultMaxBinaryMessageBufferSize, ...;int defaultMaxTextMessageBufferSize, ...;// WebSocketContainerthis.defaultAsyncSendTimeoutthis.defaultMaxSessionIdleTimeoutthis.defaultMaxBinaryMessageBufferSizethis.defaultMaxTextMessageBufferSize// ServerContainer/** {@link ContextCustomizer} that instantiates a new {@link MockServerContainer} ... */ServletContext scnew MockServerContainer(...)/** {@link ContextCustomizerFactory} which creates a {@link MockServerContainerContextCustomizer} ... */MockServerContainerContextCustomizerFactory.classString MOCK_SERVER_CONTAINER_CONTEXT_CUSTOMIZER_CLASS_NAME, ...;boolean webSocketPresent, ...;isAnnotatedWithWebAppConfiguration(...)// Else, nothing to customize/** WebSocket support classes for the <em>Spring TestContext Framework</em>. *//** {@code JdbcTestUtils} is a collection of JDBC related utility functions ... */JdbcTestUtils.class/** Count the rows in the given table. ... *//** Count the rows in the given table, using the provided {@code WHERE} clause. ... *//** Delete all rows from the specified tables. ... */int totalRowCount/** Delete rows from the given table, using the provided {@code WHERE} clause. ... *//** Drop the specified tables. ... *//** Support classes for tests based on JDBC. *//** {@code AopTestUtils} is a collection of AOP-related utility methods for ... *//** Get the <em>target</em> object of the supplied {@code candidate} object. ... *//** Get the ultimate <em>target</em> object of the supplied {@code candidate} ... */getUltimateTargetObject(...)/** Test assertions that are independent of any third-party assertion library. ... *//** Fail a test with the given message. ... *//** Fail a test with the given message passing along expected and actual ... *//** Assert the given condition is {@code true} and raise an ... *//** Assert the given condition is {@code false} and raise an ... *//** Assert that the given object is {@code null} and raise an ... */assertTrue(...)/** Assert that the given object is not {@code null} and raise an ... *//** Assert two objects are equal and raise an {@link AssertionError} otherwise. ... *//** Assert two objects are not equal and raise an {@link AssertionError} otherwise. ... */import JSONAssert/** A helper class for assertions on JSON content. ... *//** Parse the expected and actual strings as JSON and assert the two ... */assertJsonEqual(...)assertEquals(...)assertJsonNotEqual(...)assertNotEquals(...)import JsonPathimport CoreMatchersimport MatcherAssert/** A helper class for applying assertions via JSON path expressions. ... */JsonPath jsonPath, ...;/** Construct a new {@code JsonPathExpectationsHelper}. ... */this.jsonPath/** Evaluate the JSON path expression against the supplied {@code content} ... */evaluateJsonPath(...)/** An overloaded variant of {@link #assertValue(String, Matcher)} that also ... */List<> actualValueListassertExistsAndReturn(...)failureReason(...)instanceOf(...)pathIsIndefinite(...)/** Evaluate the JSON path and return the resulting value. ... *//** Variant of {@link #evaluateJsonPath(String)} with a target type. ... */isDefinite(...)/** {@code MetaAnnotationUtils} is a collection of utility methods that complements ... */getComposedAnnotation(...)Annotation composedAnnotation, ...;AnnotationAttributes annotationAttributes, ...;this.composedAnnotationthis.annotationAttributes/** Synthesize the merged {@link #getAnnotationAttributes AnnotationAttributes} ... *//** {@code ReflectionTestUtils} is a collection of reflection-based utility ... */ReflectionTestUtils.classString SETTER_PREFIX, ...;String GETTER_PREFIX, ...;boolean springAopPresent, ...;/** Set the {@linkplain Field field} with the given {@code name} on the ... *//** Set the {@linkplain Field field} with the given {@code name}/{@code type} ... *//** Set the static {@linkplain Field field} with the given {@code name} on ... *//** Set the static {@linkplain Field field} with the given ... */safeToString(...)/** Get the value of the {@linkplain Field field} with the given {@code name} ... *//** Get the value of the static {@linkplain Field field} with the given ... *//** Invoke the setter method with the given {@code name} on the supplied ... */invokeSetterMethod(...)String setterMethodName/** Invoke the getter method with the given {@code name} on the supplied ... */String getterMethodName/** Invoke the method with the given {@code name} on the supplied target ... *//** Invoke the static method with the given {@code name} on the supplied target ... *//** Invoke the method with the given {@code name} on the provided ... */import DiffBuilderimport DefaultNodeMatcherimport Diffimport ElementSelectorsimport static MatcherAssert.assertThat/** A helper class for assertions on XML content. ... *//** Parse the content as {@link Node} and apply a {@link Matcher}. */parseXmlString(...)/** Parse the content as {@link DOMSource} and apply a {@link Matcher}. ... *//** Parse the expected and actual content strings as XML and assert that the ... */XmlUnitDiff diffnew XmlUnitDiff(...)hasDifferences(...)/** Inner class to prevent hard dependency on XML Unit. */Diff diff, ...;this.diffcheckForSimilar(...)ignoreComments(...)withTest(...)new DefaultNodeMatcher(...)ElementSelectors.byNameAndTextimport XPathimport XPathConstantsimport XPathExpressionimport XPathExpressionExceptionimport XPathFactoryimport SimpleNamespaceContext/** A helper class for applying assertions via XPath expressions. ... */XPathExpression xpathExpression, ...;boolean hasNamespaces, ...;/** XpathExpectationsHelper constructor. ... */this.xpathExpressioncompileXpathExpression(...)this.hasNamespacesSimpleNamespaceContext namespaceContextXPath xpathnewXPath(...)/** Return the compiled XPath expression. *//** Parse the content, evaluate the XPath expression as a {@link Node}, ... */evaluateXpath(...)Node.class/** Parse the content, evaluate the XPath expression as a {@link NodeList}, ... */parseXmlByteArray(...)XPathConstants.NODESETNodeList.classgetXpathExpression(...)/** Apply the XPath expression and assert the resulting content exists. ... *//** Apply the XPath expression and assert the resulting content does not exist. ... */assertNull(...)/** Apply the XPath expression and assert the resulting content with the ... *//** Apply the XPath expression and assert the resulting content as an integer. ... *//** Apply the XPath expression and assert the resulting content as a String. ... */Double actual/** Apply the XPath expression and assert the resulting content as a Double. ... *//** Apply the XPath expression and assert the resulting content as a Boolean. ... *//** Evaluate the XPath and return the resulting value. ... *//** Parse the given XML content to a {@link Document}. ... *//** Apply the XPath expression to given document. ... */QName evaluationTypeXPathConstants.NUMBERXPathConstants.STRINGXPathConstants.BOOLEANXPathConstants.NODE/** General utility classes for use in unit and integration tests. */import ModelAndViewimport static AssertionErrors.assertTrueimport static AssertionErrors.fail/** A collection of assertions intended to simplify testing scenarios dealing ... *//** Checks whether the model value under the given {@code modelName} ... *//** Compare each individual entry in a list, without first sorting the lists. ... */List<> modelListassertAndReturnModelAttributeOfType(...)/** Assert whether or not a model attribute is available. ... *//** Compare a given {@code expectedValue} to the value from the model ... */Object modelValue/** Inspect the {@code expectedModel} to see if all elements in the ... */appendNonMatchingSetsErrorMessage(...)Object assertionValueinsert(...)/** Compare each individual entry in a list after having sorted both lists ... *//** Check to see if the view name in the ModelAndView matches the given ... */getViewName(...)Set<String> tempSet/** Base class for {@code RequestExpectationManager} implementations responsible ... */new ArrayList<RequestExpectation>(...)new ArrayList<ClientHttpRequest>(...)new LinkedHashMap<ClientHttpRequest,Throwable>(...)List<RequestExpectation> expectations, ...;List<ClientHttpRequest> requests, ...;Map<ClientHttpRequest,Throwable> requestFailures, ...;/** Return a read-only list of the expectations. */this.expectations/** Return a read-only list of requests executed so far. */this.requestsRequestExpectation expectationnew DefaultRequestExpectation(...)afterExpectationsDeclared(...)ClientHttpResponse responsevalidateRequestInternal(...)matchRequest(...)this.requestFailurescreateResponse(...)/** Invoked at the time of the first actual request, which effectively means ... *//** Subclasses must implement the actual validation of the request ... *//** As of 5.0.3 subclasses should implement this method instead of ... */verifyInternal(...)getRequestDetails(...)Instant endTimenew Function<Entry<ClientHttpRequest,Throwable>,String>(...) { ... }isSatisfied(...)/** Return details of executed requests. */ClientHttpRequest request/** Return an {@code AssertionError} that a sub-class can raise for an ... */HttpMethod method/** Helper class to manage a group of remaining expectations. */new LinkedHashSet<RequestExpectation>(...)Set<RequestExpectation> expectations, ...;/** Return a matching expectation, or {@code null} if none match. *//** Invoke this for an expectation that has been matched. ... */incrementAndValidate(...)updateInternal(...)hasRemainingCount(...)/** Add expectations to this group. ... */new Consumer<RequestExpectation>(...) { ... }/** Reset all expectations for this group. */// Try this first for backwards compatibility// We're looking to find a match or return null../** Default implementation of {@code RequestExpectation} that simply delegates ... */new ArrayList<RequestMatcher>(...)RequestCount requestCount, ...;List<RequestMatcher> requestMatchers, ...;ResponseCreator responseCreator, ...;/** Create a new request expectation that should be called a number of times ... */this.requestCountnew RequestCount(...)this.requestMatchersthis.responseCreatorRequestMatcher matchergetRequestMatchers(...)/** Note that as of 5.0.3, the creation of the response, which may block ... */ResponseCreator responseCreatorgetResponseCreator(...)getRequestCount(...)/** Helper class that keeps track of actual vs expected request count. */ExpectedCount expectedCount, ...;int matchedRequestCount, ...;this.matchedRequestCountgetMatchedRequestCount(...)getMaxCount(...)getExpectedCount(...)getMinCount(...)// Only validate min count since max count is checked on every request.../** A simple type representing a range for an expected count. ... */int minCount, ...;int maxCount, ...;/** Private constructor. ... */this.minCountthis.maxCount/** Return the {@code min} boundary of the expected count range. *//** Return the {@code max} boundary of the expected count range. *//** Exactly once. */new ExpectedCount(...)/** Exactly twice. *//** Many times (range of 1..Integer.MAX_VALUE). *//** Exactly N times. *//** At least {@code min} number of times. *//** At most {@code max} number of times. *//** No calls expected at all, i.e. min=0 and max=0. ... *//** Between {@code min} and {@code max} number of times. */import ClientHttpRequestFactoryimport MockClientHttpRequestimport MockClientHttpResponseimport MockMvcimport static MockMvcRequestBuilders.request/** A {@link ClientHttpRequestFactory} for requests executed via {@link MockMvc}. ... */MockMvc mockMvc, ...;this.mockMvcnew MockClientHttpRequest(...) { ... }getClientHttpResponse(...)getBodyAsBytes(...)new MockAsyncClientHttpRequest(...) { ... }MockHttpServletResponse servletResponseandReturn(...)perform(...)headers(...)content(...)HttpStatus statusbyte[] bodyMockClientHttpResponse clientResponsenew MockClientHttpResponse(...)getResponseHeaders(...)HttpStatus.INTERNAL_SERVER_ERRORimport BufferingClientHttpRequestFactoryimport RestTemplateimport RestGatewaySupport/** <strong>Main entry point for client-side REST testing</strong>. Used for tests ... */RequestExpectationManager expectationManager, ...;/** Private constructor with {@code RequestExpectationManager}. ... */this.expectationManager/** Set up an expectation for a single HTTP request. The returned ... */once(...)/** An alternative to {@link #expect(RequestMatcher)} that also indicates how ... */expectRequest(...)/** Verify that all expected requests set up via ... *//** Variant of {@link #verify()} that waits for up to the specified time for ... *//** Reset the internal state removing all expectations and recorded requests. *//** Return a builder for a {@code MockRestServiceServer} that should be used ... */new DefaultBuilder(...)getRestTemplate(...)/** A shortcut for {@code bindTo(restTemplate).build()}. ... *//** A shortcut for {@code bindTo(asyncRestTemplate).build()}. ... *//** A shortcut for {@code bindTo(restGateway).build()}. ... *//** Builder to create a {@code MockRestServiceServer}. *//** Whether to allow expected requests to be executed in any order not ... *//** Use the {@link BufferingClientHttpRequestFactory} wrapper to buffer ... *//** Build the {@code MockRestServiceServer} and set up the underlying ... *//** An overloaded build alternative that accepts a custom ... */RestTemplate restTemplate, ...;AsyncRestTemplate asyncRestTemplate, ...;boolean ignoreExpectOrder, ...;boolean bufferContent, ...;this.restTemplatethis.asyncRestTemplatethis.ignoreExpectOrderthis.bufferContentnew UnorderedRequestExpectationManager(...)new SimpleRequestExpectationManager(...)MockRestServiceServer servernew MockRestServiceServer(...)MockClientHttpRequestFactory factorynew MockClientHttpRequestFactory(...)setRequestFactory(...)new BufferingClientHttpRequestFactory(...)setAsyncRequestFactory(...)/** Mock ClientHttpRequestFactory that creates requests by iterating ... */createRequestInternal(...)validateRequest(...)setResponse(...)/** An extension of {@code ResponseActions} that also implements ... *//** Whether there is a remaining count of invocations for this expectation. *//** Increase the matched request count and check we haven't passed the max count. ... *//** Whether the requirements for this request expectation have been met. *//** Encapsulates the behavior required to implement {@link MockRestServiceServer} ... *//** Set up a new request expectation. The returned {@link ResponseActions} is ... *//** Verify that all expectations have been met. ... *//** Reset the internal state removing all expectations and recorded requests. ... *//** Validate the given actual request against the declared expectations. ... *//** A contract for matching requests to expectations. ... *//** Match the given request against specific expectations. ... *//** A contract for setting up request expectations and defining a response. ... *//** Add a request expectation. ... *//** Define the response. ... */import MockRestResponseCreators/** A contract for creating a {@link ClientHttpResponse}. ... *//** Create a response for the given request. ... *//** Simple {@code RequestExpectationManager} that matches requests to expectations ... */new RequestExpectationGroup(...)Iterator<RequestExpectation> expectationIterator, ...;/** Expectations in the order of declaration (count may be > 1). */RequestExpectationGroup repeatExpectations, ...;/** Track expectations that have a remaining count. */this.expectationIteratorgetExpectations(...)findExpectation(...)this.repeatExpectationscreateUnexpectedRequestError(...)/** {@code RequestExpectationManager} that matches requests to expectations ... */RequestExpectationGroup remainingExpectations, ...;addAllExpectations(...)this.remainingExpectationsimport FormHttpMessageConverterimport JsonExpectationsHelperimport XmlExpectationsHelperimport RequestMatcherimport CommonsMultipartResolverimport static AssertionErrors.assertEquals/** Factory for request content {@code RequestMatcher}'s. An instance of this ... */XmlExpectationsHelper xmlHelper, ...;JsonExpectationsHelper jsonHelper, ...;/** Class constructor, not for direct instantiation. ... */this.xmlHelpernew XmlExpectationsHelper(...)this.jsonHelpernew JsonExpectationsHelper(...)/** Assert the request content type as a String. */contentType(...)/** Assert the request content type as a {@link MediaType}. */new RequestMatcher(...) { ... }MediaType actualContentType/** Assert the request content type is compatible with the given ... */contentTypeCompatibleWith(...)/** Get the body of the request as a UTF-8 string and apply the given {@link Matcher}. */MockClientHttpRequest mockRequest/** Get the body of the request as a UTF-8 string and compare it to the given String. *//** Compare the body of the request to the given byte array. *//** Parse the body as form data and compare to the given {@code MultiValueMap}. ... */formData(...)/** Variant of {@link #formData(MultiValueMap)} that matches the given subset ... */MultiValueMap<String,String> multiValueMapMockHttpInputMessage messagenew MockHttpInputMessage(...)MultiValueMap<String,String> actualMapnew FormHttpMessageConverter(...)Entry<String,? extends List<?>> entryMap<>.Entry<String,? extends List<?>>List<?> values/** Parse the body as multipart data and assert it contains exactly the ... */multipartData(...)/** Variant of {@link #multipartData(MultiValueMap)} that does the same but ... */MultiValueMap<String,?> actualMap/** Parse the request body and the given String as XML and assert that the ... */new AbstractXmlRequestMatcher(...) { ... }assertXmlEqual(...)/** Parse the request content as {@link Node} and apply the given {@link Matcher}. */assertNode(...)/** Parse the request content as {@link DOMSource} and apply the given {@link Matcher}. ... */assertSource(...)json(...)/** Parse the request body and the given string as JSON and assert the two ... *//** Abstract base class for XML {@link RequestMatcher}'s. */MultipartHttpServletRequest servletRequestadaptToMultipartRequest(...)MultiValueMap<String,Object> resultEntry<String,List<MultipartFile>> entryMap<>.Entry<String,List<MultipartFile>>getMultiFileMap(...)MultipartFile valueEntry<String,String[]> entryMap<>.Entry<String,String[]>getParameterMap(...)MockClientHttpRequest sourceMockHttpServletRequest targetaddHeader(...)resolveMultipart(...)new CommonsMultipartResolver(...)import JsonPathExpectationsHelper/** Factory for assertions on the request content using ... */JsonPathExpectationsHelper jsonPathHelper, ...;/** Protected constructor. ... */this.jsonPathHelpernew JsonPathExpectationsHelper(...)/** Evaluate the JSON path expression against the request content and ... */new AbstractJsonPathRequestMatcher(...) { ... }assertValue(...)JsonPathRequestMatchers.this.jsonPathHelperJsonPathRequestMatchers.this/** An overloaded variant of {@link #value(Matcher)} that also accepts a ... */doesNotExist(...)/** Evaluate the JSON path expression against the response content ... */hasJsonPath(...)doesNotHaveJsonPath(...)assertValueIsEmpty(...)assertValueIsNotEmpty(...)assertValueIsString(...)assertValueIsBoolean(...)assertValueIsNumber(...)assertValueIsArray(...)assertValueIsMap(...)/** Abstract base class for {@code JsonPath}-based {@link RequestMatcher RequestMatchers}. ... */import MockRestServiceServer/** Static factory methods for {@link RequestMatcher} classes. Typically used to ... *//** Match to any request. *//** Assert the {@link HttpMethod} of the request. ... *//** Assert the request URI string with the given Hamcrest matcher. ... *//** Assert the request URI matches the given string. ... *//** Variant of {@link #requestTo(URI)} that prepares the URI from a URI ... */requestTo(...)/** Expect a request to the given URI. ... *//** Assert request query parameter values with the given Hamcrest matcher(s). */assertValueCount(...)matchers.length/** Assert request query parameter values. */expectedValues.length/** Assert request header values with the given Hamcrest matcher(s). *//** Assert request header values. *//** Assert that the given request header does not exist. ... *//** Access to request body matchers. */new ContentRequestMatchers(...)/** Access to request body matchers using a ... */new JsonPathRequestMatchers(...)/** Access to request body matchers using an XPath to inspect a specific ... */new XpathRequestMatchers(...)/** Access to response body matchers using an XPath to inspect a specific ... */import XpathExpectationsHelper/** Factory methods for request content {@code RequestMatcher} implementations ... */XpathExpectationsHelper xpathHelper, ...;this.xpathHelpernew XpathExpectationsHelper(...)/** Apply the XPath and assert it with the given {@code Matcher<Node>}. */new XpathRequestMatcher(...) { ... }/** Assert that content exists at the given XPath. *//** Assert that content does not exist at the given XPath. *//** Apply the XPath and assert the number of nodes found with the given ... */assertNodeCount(...)/** Apply the XPath and assert the number of nodes found. *//** Apply the XPath and assert the String content found with the given matcher. */assertString(...)/** Apply the XPath and assert the String content found. *//** Apply the XPath and assert the number found with the given matcher. */assertNumber(...)/** Apply the XPath and assert the number value found. *//** Apply the XPath and assert the boolean value found. */assertBoolean(...)/** Functional interface for XPath {@link RequestMatcher} implementations. *//** Contains built-in {@link org.springframework.test.web.client.RequestMatcher} ... *//** Contains client-side REST testing support. ... */import ResponseCreator/** A {@code ResponseCreator} with builder-style methods for adding response details. ... */HttpStatus statusCode, ...;Resource contentResource, ...;this.statusCode/** Set the body as a UTF-8 String. *//** Set the body as a byte array. *//** Set the body as a {@link Resource}. */this.contentResource/** Set the {@code Content-Type} header. *//** Set the {@code Location} header. *//** Copy all given headers. */MockClientHttpResponse response/** Static factory methods for obtaining a {@link ResponseCreator} instance. ... *//** {@code ResponseCreator} for a 200 response (OK). */new DefaultResponseCreator(...)HttpStatus.OK/** {@code ResponseCreator} for a 200 response (OK) with String body. ... */DefaultResponseCreator creator/** {@code ResponseCreator} for a 200 response (OK) with byte[] body. ... *//** {@code ResponseCreator} for a 200 response (OK) content with {@link Resource}-based body. ... *//** {@code ResponseCreator} for a 201 response (CREATED) with a 'Location' header. ... */HttpStatus.CREATED/** {@code ResponseCreator} for a 204 response (NO_CONTENT). */HttpStatus.NO_CONTENT/** {@code ResponseCreator} for a 400 response (BAD_REQUEST). */HttpStatus.BAD_REQUEST/** {@code ResponseCreator} for a 401 response (UNAUTHORIZED). */HttpStatus.UNAUTHORIZED/** {@code ResponseCreator} for a 500 response (SERVER_ERROR). *//** {@code ResponseCreator} with a specific HTTP status. ... *//** {@code ResponseCreator} with an internal application {@code IOException}. ... */new ResponseCreator(...) { ... }/** Contains built-in {@link org.springframework.test.web.client.ResponseCreator} ... */import WebFilterimport WebHttpHandlerBuilder/** Base class for implementations of {@link WebTestClient.MockServerSpec}. ... */WebTestClient.MockServerSpec<B>List<WebFilter> filters, ...;List<MockServerConfigurer> configurers, ...;new ArrayList<WebFilter>(...)self(...)afterConfigureAdded(...)this.configurersnew ArrayList<MockServerConfigurer>(...)WebTestClient.BuilderWebHttpHandlerBuilder builderinitHttpHandlerBuilder(...)filters(...)new Consumer<List<WebFilter>>(...) { ... }hasSessionManager(...)sessionManager(...)new Consumer<MockServerConfigurer>(...) { ... }beforeServerCreated(...)new DefaultWebTestClientBuilder(...)/** Sub-classes must create an {@code WebHttpHandlerBuilder} that will then ... */configureClient(...)// Default instance to be re-used across requests, unless one is configured explicitly/** Spec for setting up server-less testing by detecting components in an ... */applicationContext(...)import AssertionErrors/** Assertions on cookies of the response. ... */ExchangeResult exchangeResult, ...;WebTestClient.ResponseSpec responseSpec, ...;WebTestClient.ResponseSpecthis.exchangeResultthis.responseSpec/** Expect a header with the given name to match the specified values. */assertWithDiagnostics(...)getCookie(...)/** Assert the first value of the response cookie with a Hamcrest {@link Matcher}. *//** Consume the value of the response cookie. *//** Expect that the cookie with the given name is present. *//** Expect that the cookie with the given name is not present. */getResponseCookies(...)/** Assert a cookie's maxAge attribute. */Duration maxAge/** Assert a cookie's maxAge attribute with a Hamcrest {@link Matcher}. */long maxAgegetSeconds(...)/** Assert a cookie's path attribute. *//** Assert a cookie's path attribute with a Hamcrest {@link Matcher}. *//** Assert a cookie's domain attribute. *//** Assert a cookie's domain attribute with a Hamcrest {@link Matcher}. *//** Assert a cookie's secure attribute. */boolean isSecureisSecure(...)/** Assert a cookie's httpOnly attribute. */boolean isHttpOnly/** Assert a cookie's sameSite attribute. */String sameSiteimport RequestedContentTypeResolverBuilderimport CorsRegistryimport DelegatingWebFluxConfigurationimport PathMatchConfigurerimport ViewResolverRegistryimport WebFluxConfigurerimport ArgumentResolverConfigurer/** Default implementation of {@link WebTestClient.ControllerSpec}. ... */WebTestClient.ControllerSpecnew TestWebFluxConfigurer(...)List<Object> controllers, ...;List<Object> controllerAdvice, ...;TestWebFluxConfigurer configurer, ...;this.controllersinstantiateIfNecessary(...)List<Object> instancesspecified.lengththis.controllerAdvicethis.configurer.contentTypeResolverConsumerthis.configurerthis.configurer.corsRegistryConsumerthis.configurer.argumentResolverConsumerthis.configurer.pathMatchConsumerthis.configurer.messageCodecsConsumerthis.configurer.formattersConsumerthis.configurer.validatorthis.configurer.viewResolversConsumerDelegatingWebFluxConfiguration.classWebFluxConfigurer.classnew Supplier<WebFluxConfigurer>(...) { ... }Consumer<RequestedContentTypeResolverBuilder> contentTypeResolverConsumer, ...;Consumer<CorsRegistry> corsRegistryConsumer, ...;Consumer<ArgumentResolverConfigurer> argumentResolverConsumer, ...;Consumer<PathMatchConfigurer> pathMatchConsumer, ...;Consumer<ServerCodecConfigurer> messageCodecsConsumer, ...;Consumer<FormatterRegistry> formattersConsumer, ...;Consumer<ViewResolverRegistry> viewResolversConsumer, ...;this.contentTypeResolverConsumerthis.corsRegistryConsumerthis.pathMatchConsumerthis.argumentResolverConsumerthis.messageCodecsConsumerthis.formattersConsumerthis.viewResolversConsumerimport WebHandler/** Simple extension of {@link AbstractMockServerSpec} that is given a target ... */WebHandler webHandler, ...;this.webHandlerwebHandler(...)import RouterFunctionimport RouterFunctions/** Spec for setting up server-less testing against a RouterFunction. ... */WebTestClient.RouterFunctionSpecRouterFunction<?> routerFunction, ...;HandlerStrategies handlerStrategies, ...;this.routerFunctionthis.handlerStrategiesWebHandler webHandlertoWebHandler(...)localeContextResolver(...)exceptionHandlers(...)webFilters(...)new Consumer<List<WebExceptionHandler>>(...) { ... }import ClientHttpConnectorimport BodyInserterimport BodyInsertersimport ClientRequestimport ClientResponseimport ExchangeFunctionimport UriBuilderFactory/** Default implementation of {@link WebTestClient}. ... */WiretapConnector wiretapConnector, ...;ExchangeFunction exchangeFunction, ...;UriBuilderFactory uriBuilderFactory, ...;HttpHeaders defaultHeaders, ...;MultiValueMap<String,String> defaultCookies, ...;Duration responseTimeout, ...;DefaultWebTestClientBuilder builder, ...;AtomicLong requestIndex, ...;this.wiretapConnectornew WiretapConnector(...)this.exchangeFunctionthis.uriBuilderFactorythis.defaultHeadersthis.defaultCookiesthis.responseTimeoutthis.buildermethodInternal(...)new DefaultRequestBodyUriSpec(...)MultiValueMap<String,String> cookies, ...;BodyInserter<?,? super ClientHttpRequest> inserter, ...;Consumer<ClientHttpRequest> httpRequestConsumer, ...;String uriTemplate, ...;String requestId, ...;this.requestIdWebTestClient.WEBTESTCLIENT_REQUEST_IDthis.uriTemplateuri(...)this.inserterfromValue(...)fromProducer(...)bodyValue(...)ClientRequest requestinitRequestBuilder(...)ClientResponse responseexchange(...)getResponseTimeout(...)ExchangeResult resultgetExchangeResult(...)new DefaultResponseSpec(...)ClientRequest.Builderattributes(...)cookies(...)initUri(...)new Consumer<HttpHeaders>(...) { ... }new Consumer<MultiValueMap<String,String>>(...) { ... }initCookies(...)this.httpRequestConsumerhttpRequest(...)HttpHeaders resultClientResponse response, ...;Duration timeout, ...;new StatusAssertions(...)new HeaderAssertions(...)new CookieAssertions(...)B bodybodyToMono(...)EntityExchangeResult<B> entityResultnew EntityExchangeResult<B>(...)new DefaultBodySpec<B,S>(...)getListBodySpec(...)bodyToFlux(...)Flux<E> fluxList<E> bodyEntityExchangeResult<List<E>> entityResultnew EntityExchangeResult<List<E>>(...)new DefaultListBodySpec<E>(...)ByteArrayResource resourceEntityExchangeResult<byte[]> entityResultnew EntityExchangeResult<byte[]>(...)new DefaultBodyContentSpec(...)Flux<T> bodyreleaseBody(...)new FluxExchangeResult<T>(...)EntityExchangeResult<B> result, ...;getResponseBody(...)List<E> actualList<E> expectedEntityExchangeResult<byte[]> result, ...;boolean isEmpty, ...;this.isEmptygetResponseBody(...).lengthnew EntityExchangeResult<Void>(...)new JsonPathAssertions(...)new XpathAssertions(...)body.lengthimport HttpComponentsClientHttpConnectorimport JettyClientHttpConnectorimport ReactorClientHttpConnectorimport ClientCodecConfigurerimport ExchangeFilterFunctionimport ExchangeFunctionsimport ExchangeStrategiesimport DefaultUriBuilderFactory/** Default implementation of {@link WebTestClient.Builder}. ... */DefaultWebTestClientBuilder.classboolean reactorClientPresent, ...;boolean jettyClientPresent, ...;boolean httpComponentsClientPresent, ...;boolean webFluxPresent, ...;WebHttpHandlerBuilder httpHandlerBuilder, ...;ClientHttpConnector connector, ...;String baseUrl, ...;List<ExchangeFilterFunction> filters, ...;ExchangeStrategies strategies, ...;ExchangeStrategies.Builder/** Determine connector via classpath detection. *//** Use HttpHandlerConnector with mock server. *//** Use given connector. */this.httpHandlerBuilderother.httpHandlerBuilderother.connectorother.responseTimeoutthis.baseUrlother.baseUrlother.uriBuilderFactoryother.defaultHeadersother.defaultCookiesnew ArrayList<ExchangeFilterFunction>(...)other.filtersother.strategiesother.strategiesConfigurersinitFilters(...)new Consumer<Builder>(...) { ... }codecs(...)afterConfigurerAdded(...)ClientHttpConnector connectorToUseFunction<ClientHttpConnector,ExchangeFunction> exchangeFactorynew Function<ClientHttpConnector,ExchangeFunction>(...) { ... }ExchangeFunction exchangeinitExchangeStrategies(...)reduce(...)new BinaryOperator<ExchangeFilterFunction>(...) { ... }new Function<ExchangeFilterFunction,ExchangeFunction>(...) { ... }new HttpHandlerConnector(...)new DefaultWebTestClient(...)initUriBuilderFactory(...)new ReactorClientHttpConnector(...)new JettyClientHttpConnector(...)new HttpComponentsClientHttpConnector(...)new DefaultUriBuilderFactory(...)// Helpful message especially for MockMvcWebTestClient users/** {@code ExchangeResult} sub-class that exposes the response body fully ... */T body, ...;/** Return the entity extracted from the response body. *//** Container for request and response details for exchanges performed through ... */ExchangeResult.classMediaType.APPLICATION_JSONMediaType.APPLICATION_XMLMediaType.APPLICATION_FORM_URLENCODEDList<MediaType> PRINTABLE_MEDIA_TYPES, ...;ClientHttpRequest request, ...;ClientHttpResponse response, ...;Mono<byte[]> requestBody, ...;Mono<byte[]> responseBody, ...;Object mockServerResult, ...;/** Create an instance with an HTTP request and response along with promises ... */this.requestBodythis.responseBodythis.mockServerResult/** Copy constructor to use after body is decoded and/or consumed. */other.requestother.responseother.requestBodyother.responseBodyother.timeoutother.uriTemplateother.mockServerResult/** Return the method of the request. *//** Return the URI of the request. *//** Return the original URI template used to prepare the request, if any. *//** Return the request headers sent to the server. *//** Return the raw request body content written through the request. ... *//** Return the HTTP status code as an {@link HttpStatus} enum value. */getStatusCode(...)/** Return the HTTP status code (potentially non-standard and not resolvable ... */getRawStatusCode(...)/** Return the response headers received from the server. *//** Return response cookies received from the server. *//** Return the raw request body content written to the response. ... *//** Return the result from the mock server exchange, if applicable, for ... *//** Execute the given Runnable, catch any {@link AssertionError}, decorate ... */formatMockServerResult(...)formatBody(...)formatHeaders(...)getRequestHeaders(...)new Function<Entry<String,List<String>>,String>(...) { ... }new Function<byte[],String>(...) { ... }new Predicate<MediaType>(...) { ... }new Function<Throwable,Mono<? extends String>>(...) { ... }/** {@code ExchangeResult} variant with the response body decoded as ... */Flux<T> body, ...;/** Return the response body as a {@code Flux<T>} of decoded elements. ... *//** Invoke the given consumer within {@link #assertWithDiagnostics(Runnable)} ... */import CacheControlimport ContentDispositionimport static AssertionErrors.assertNotNull/** Assertions on headers of the response. ... */assertHeader(...)getOrEmpty(...)/** Expect a header with the given name to match the given long value. ... *//** Expect a header with the given name to match the specified long value ... */getFirstDate(...)/** Match the first value of the response header with a regex. ... *//** Match all values of the response header with the given regex ... */getRequiredValues(...)/** Assert the first value of the response header with a Hamcrest {@link Matcher}. ... *//** Assert all values of the response header with a Hamcrest {@link Matcher}. ... *//** Consume the first value of the named response header. ... *//** Consume all values of the named response header. ... *//** Expect that the header with the given name is present. ... *//** Expect that the header with the given name is not present. *//** Expect a "Cache-Control" header with the given value. */getHeaderValue(...)getCacheControl(...)/** Expect a "Content-Disposition" header with the given value. */getContentDisposition(...)/** Expect a "Content-Length" header with the given value. *//** Expect a "Content-Type" header with the given value. *//** Expect a "Content-Type" header compatible with the given value. */MediaType actual/** Expect an "Expires" header with the given value. *//** Expect a "Last-Modified" header with the given value. *//** Expect a "Location" header with the given value. ... */import HttpHeadResponseDecoratorimport ServerHttpResponse/** Connector that handles requests by invoking an {@link HttpHandler} rather ... */HttpHandlerConnector.classHttpHandler handler, ...;/** Constructor with the {@link HttpHandler} to handle requests with. */new Supplier<Mono<? extends ClientHttpResponse>>(...) { ... }doConnect(...)Empty<Void> requestWriteSinkEmpty<Void> handlerSinkClientHttpResponse[] savedResponsenew ClientHttpResponse[]MockClientHttpRequest mockClientRequestnew MockClientHttpRequest(...)MockServerHttpResponse mockServerResponsesetWriteHandler(...)ServerHttpRequest mockServerRequestadaptRequest(...)ServerHttpResponse responseToUseprepareResponse(...)adaptResponse(...)new FailureAfterResponseCompletedException(...)new Callable<ClientHttpResponse>(...) { ... }MultiValueMap<String,HttpCookie> cookiesnew HttpHeadResponseDecorator(...)Integer status/** Indicates that an error occurred after the server response was completed, ... */ClientHttpResponse completedResponse, ...;this.completedResponse// unsafe(): we're intercepting, already serialized Publisher signals/** <a href="https://github.com/jayway/JsonPath">JsonPath</a> assertions. ... */WebTestClient.BodyContentSpec bodySpec, ...;WebTestClient.BodyContentSpecJsonPathExpectationsHelper pathHelper, ...;this.bodySpecthis.pathHelper/** Applies {@link JsonPathExpectationsHelper#assertValue(String, Object)}. *//** Applies {@link JsonPathExpectationsHelper#exists(String)}. *//** Applies {@link JsonPathExpectationsHelper#doesNotExist(String)}. *//** Applies {@link JsonPathExpectationsHelper#assertValueIsEmpty(String)}. *//** Applies {@link JsonPathExpectationsHelper#assertValueIsNotEmpty(String)}. *//** Applies {@link JsonPathExpectationsHelper#hasJsonPath}. ... *//** Applies {@link JsonPathExpectationsHelper#doesNotHaveJsonPath}. ... *//** Applies {@link JsonPathExpectationsHelper#assertValueIsBoolean(String)}. *//** Applies {@link JsonPathExpectationsHelper#assertValueIsNumber(String)}. *//** Applies {@link JsonPathExpectationsHelper#assertValueIsArray(String)}. *//** Applies {@link JsonPathExpectationsHelper#assertValueIsMap(String)}. *//** Delegates to {@link JsonPathExpectationsHelper#assertValue(String, Matcher)}. ... *//** Delegates to {@link JsonPathExpectationsHelper#assertValue(String, Matcher, Class)}. ... *//** Consume the result of the JSONPath evaluation. ... *//** Consume the result of the JSONPath evaluation and provide a target class. ... *//** Simple {@link ClientHttpResponse} extension that also exposes a result object ... *//** Return the result object with the server request and response. *//** Contract that frameworks or applications can use to pre-package a set of ... *//** Invoked immediately, i.e. before this method returns. ... */WebTestClient.MockServerSpec<?>/** Invoked just before the mock server is built. Use this hook to inspect ... *//** Assertions on the response status. ... *//** Assert the response status as an {@link HttpStatus}. *//** Assert the response status as an integer. *//** Assert the response status code is {@code HttpStatus.OK} (200). */assertStatusAndReturn(...)/** Assert the response status code is {@code HttpStatus.CREATED} (201). */HttpStatus expected/** Assert the response status code is {@code HttpStatus.ACCEPTED} (202). */HttpStatus.ACCEPTED/** Assert the response status code is {@code HttpStatus.NO_CONTENT} (204). *//** Assert the response status code is {@code HttpStatus.FOUND} (302). */HttpStatus.FOUND/** Assert the response status code is {@code HttpStatus.SEE_OTHER} (303). */HttpStatus.SEE_OTHER/** Assert the response status code is {@code HttpStatus.NOT_MODIFIED} (304). */HttpStatus.NOT_MODIFIED/** Assert the response status code is {@code HttpStatus.TEMPORARY_REDIRECT} (307). */HttpStatus.TEMPORARY_REDIRECT/** Assert the response status code is {@code HttpStatus.PERMANENT_REDIRECT} (308). */HttpStatus.PERMANENT_REDIRECT/** Assert the response status code is {@code HttpStatus.BAD_REQUEST} (400). *//** Assert the response status code is {@code HttpStatus.UNAUTHORIZED} (401). *//** Assert the response status code is {@code HttpStatus.FORBIDDEN} (403). ... */HttpStatus.FORBIDDEN/** Assert the response status code is {@code HttpStatus.NOT_FOUND} (404). */HttpStatus.NOT_FOUND/** Assert the response error message. *//** Assert the response status code is in the 1xx range. */assertSeriesAndReturn(...)HttpStatus.Series.INFORMATIONAL/** Assert the response status code is in the 2xx range. */HttpStatus.Series.SUCCESSFUL/** Assert the response status code is in the 3xx range. */HttpStatus.Series.REDIRECTION/** Assert the response status code is in the 4xx range. */HttpStatus.Series.CLIENT_ERROR/** Assert the response status code is in the 5xx range. */Series expectedHttpStatus.Series.SERVER_ERROR/** Match the response status value with a Hamcrest matcher. ... *//** Consume the response status value as an integer. ... */HttpStatus actualseries(...)import WebClient/** Client for testing web servers that uses {@link WebClient} internally to ... */String WEBTESTCLIENT_REQUEST_ID, ...;/** The name of a request header used to assign a unique id to every request ... *//** Prepare an HTTP GET request. ... *//** Prepare an HTTP HEAD request. ... *//** Prepare an HTTP POST request. ... *//** Prepare an HTTP PUT request. ... *//** Prepare an HTTP PATCH request. ... *//** Prepare an HTTP DELETE request. ... *//** Prepare an HTTP OPTIONS request. ... *//** Prepare a request for the specified {@code HttpMethod}. ... *//** Return a builder to mutate properties of this web test client. *//** Mutate the {@link WebTestClient}, apply the given configurer, and build ... *//** Use this server setup to test one {@code @Controller} at a time. ... */new DefaultControllerSpec(...)/** Use this option to set up a server from a {@link RouterFunction}. ... */new DefaultRouterFunctionSpec(...)/** Use this option to setup a server from the Spring configuration of your ... */new ApplicationContextSpec(...)/** Integration testing with a "mock" server targeting the given WebHandler. ... */new DefaultMockServerSpec(...)/** This server setup option allows you to connect to a live server through ... *//** A variant of {@link #bindToServer()} with a pre-configured connector. ... *//** Base specification for setting up tests without a server. ... *//** Register {@link WebFilter} instances to add to the mock server. ... *//** Provide a session manager instance for the mock server. ... *//** Shortcut for pre-packaged customizations to the mock server setup. ... *//** Proceed to configure and build the test client. *//** Shortcut to build the test client. *//** Specification for customizing controller configuration equivalent to, and ... *//** Register one or more {@link org.springframework.web.bind.annotation.ControllerAdvice} ... *//** Customize content type resolution. ... *//** Configure CORS support. ... *//** Configure path matching options. ... *//** Configure resolvers for custom controller method arguments. ... *//** Configure custom HTTP message readers and writers or override built-in ones. ... *//** Register formatters and converters to use for type conversion. ... *//** Configure a global Validator. ... *//** Configure view resolution. ... *//** Specification for customizing router function configuration. *//** Configure handler strategies. *//** Steps for customizing the {@link WebClient} used to test with, ... *//** Configure a base URI as described in ... *//** Provide a pre-configured {@link UriBuilderFactory} instance as an ... *//** Add the given header to all requests that haven't added it. ... *//** Manipulate the default headers with the given consumer. The ... *//** Manipulate the default cookies with the given consumer. The ... *//** Add the given filter to the filter chain. ... *//** Manipulate the filters with the given consumer. The ... *//** Configure the codecs for the {@code WebClient} in the ... *//** Configure the {@link ExchangeStrategies} to use. ... *//** Customize the strategies configured via ... *//** Max amount of time to wait for responses. ... *//** Apply the given configurer to this builder instance. ... *//** Build the {@link WebTestClient} instance. *//** Specification for providing the URI of a request. ... *//** Specify the URI using an absolute, fully constructed {@link URI}. ... *//** Specify the URI for the request using a URI template and URI variables. ... *//** Build the URI for the request with a {@link UriBuilder} obtained ... *//** Specification for adding request headers and performing an exchange. ... *//** Add a cookie with the given name and value. ... *//** Manipulate this request's cookies with the given consumer. The ... *//** Manipulate the request's headers with the given consumer. The ... *//** Set the attribute with the given name to the given value. ... *//** Manipulate the request attributes with the given consumer. The attributes provided to ... *//** Perform the exchange without a request body. ... *//** Specification for providing body of a request. *//** Set the body to the given {@code Object} value. This method invokes the ... *//** Set the body from the given {@code Publisher}. Shortcut for ... *//** Variant of {@link #body(Publisher, Class)} that allows providing ... *//** Set the body from the given producer. This method invokes the ... *//** Set the body of the request to the given {@code BodyInserter}. ... *//** Shortcut for {@link #body(BodyInserter)} with a ... *//** Specification for providing request headers and the URI of a request. ... *//** Specification for providing the body and the URI of a request. *//** Chained API for applying assertions to a response. *//** Assertions on the response status. *//** Assertions on the headers of the response. *//** Assertions on the cookies of the response. ... *//** Consume and decode the response body to a single object of type ... *//** Alternative to {@link #expectBody(Class)} that accepts information ... *//** Consume and decode the response body to {@code List<E>} and then apply ... *//** Alternative to {@link #expectBodyList(Class)} that accepts information ... *//** Consume and decode the response body to {@code byte[]} and then apply ... *//** Exit the chained flow in order to consume the response body ... *//** Alternative to {@link #returnResult(Class)} that accepts information ... *//** Spec for expectations on the response body decoded to a single Object. ... *//** Assert the extracted body is equal to the given value. *//** Assert the extracted body with a {@link Matcher}. ... *//** Transform the extracted the body with a function, e.g. extracting a ... *//** Assert the extracted body with a {@link Consumer}. ... *//** Assert the exchange result with the given {@link Consumer}. *//** Exit the chained API and return an {@code ExchangeResult} with the ... *//** Spec for expectations on the response body decoded to a List. ... *//** Assert the extracted list of values is of the given size. ... *//** Assert the extracted list of values contains the given elements. ... *//** Assert the extracted list of values doesn't contain the given elements. ... *//** Spec for expectations on the response body content. *//** Assert the response body is empty and return the exchange result. *//** Parse the expected and actual response content as JSON and perform a ... *//** Parse expected and actual response content as XML and assert that ... *//** Access to response body assertions using a ... *//** Access to response body assertions using an XPath expression to ... */xpath(...)/** Access to response body assertions with specific namespaces using an ... *//** Assert the response body content with the given {@link Consumer}. ... *//** Invoked once only, immediately (i.e. before this method returns). ... */import ClientHttpRequestDecoratorimport ClientHttpResponseDecorator/** Decorate another {@link ClientHttpConnector} with the purpose of ... */new ConcurrentHashMap<String,ClientExchangeInfo>(...)ClientHttpConnector delegate, ...;Map<String,ClientExchangeInfo> exchanges, ...;AtomicReference<WiretapClientHttpRequest> requestRefnew AtomicReference<WiretapClientHttpRequest>(...)new Function<ClientHttpRequest,Mono<Void>>(...) { ... }WiretapClientHttpRequest wrappednew WiretapClientHttpRequest(...)new Function<ClientHttpResponse,ClientHttpResponse>(...) { ... }WiretapClientHttpRequest wrappedRequestString requestIdWiretapClientHttpResponse wrappedResponsenew WiretapClientHttpResponse(...)this.exchangesnew ClientExchangeInfo(...)/** Create the {@link ExchangeResult} for the given "request-id" header value. */ClientExchangeInfo clientInfonew ExchangeResult(...)getRequest(...)getMockServerResult(...)getRecorder(...)/** Holder for {@link WiretapClientHttpRequest} and {@link WiretapClientHttpResponse}. */WiretapClientHttpRequest request, ...;WiretapClientHttpResponse response, ...;/** Tap into a Publisher of data buffers to save the content. */Flux<? extends DataBuffer> publisher, ...;Flux<? extends Publisher<? extends DataBuffer>> publisherNested, ...;DataBuffer buffer, ...;Sinks.One<byte[]> content, ...;Sinks.One<byte[]>boolean hasContentConsumer, ...;doOnCancel(...)this.hasContentConsumerhandleOnError(...)handleOnComplete(...)this.publisherNestednew Function<? extends Publisher<? extends DataBuffer>,Flux<? extends DataBuffer>>(...) { ... }new Supplier<Mono<? extends byte[]>>(...) { ... }Scannable.Attr<>.TERMINATEDScannable.Attr<>tryEmitValue(...)/** ClientHttpRequestDecorator that intercepts and saves the request body. */WiretapRecorder recorder, ...;this.recordernew WiretapRecorder(...)getPublisherToUse(...)writeAndFlushWith(...)getNestedPublisherToUse(...)/** ClientHttpResponseDecorator that intercepts and saves the response body. */getServerResult(...)// Couple of possible cases://  1. Mock server never consumed request body (e.g. error before read)//  2. FluxExchangeResult: getResponseBodyContent called before getResponseBody/** XPath assertions for the {@link WebTestClient}. ... */initXpathHelper(...)XPathExpressionException ex/** Delegates to {@link XpathExpectationsHelper#assertString(byte[], String, String)}. */assertWith(...)new CheckedExceptionTask(...) { ... }/** Delegates to {@link XpathExpectationsHelper#assertNumber(byte[], String, Double)}. *//** Delegates to {@link XpathExpectationsHelper#assertBoolean(byte[], String, boolean)}. *//** Delegates to {@link XpathExpectationsHelper#exists(byte[], String)}. *//** Delegates to {@link XpathExpectationsHelper#doesNotExist(byte[], String)}. *//** Delegates to {@link XpathExpectationsHelper#assertNodeCount(byte[], String, int)}. *//** Delegates to {@link XpathExpectationsHelper#assertString(byte[], String, Matcher)}. ... *//** Delegates to {@link XpathExpectationsHelper#assertNumber(byte[], String, Matcher)}. ... *//** Delegates to {@link XpathExpectationsHelper#assertNodeCount(byte[], String, Matcher)}. ... *//** Consume the result of the XPath evaluation as a String. ... *//** Consume the result of the XPath evaluation as a Double. ... */Double value/** Consume the count of nodes as result of the XPath evaluation. ... */returnResult(...)new Function<EntityExchangeResult<byte[]>,HttpHeaders>(...) { ... }new Function<HttpHeaders,MediaType>(...) { ... }/** Lets us be able to use lambda expressions that could throw checked exceptions, since ... *//** Support for testing Spring WebFlux server endpoints via ... */import FlashMapimport HandlerInterceptorimport RequestContextUtils/** A simple implementation of {@link MvcResult} with setters. ... */Object RESULT_NONE, ...;MockHttpServletRequest mockRequest, ...;MockHttpServletResponse mockResponse, ...;Object handler, ...;ModelAndView modelAndView, ...;Exception resolvedException, ...;AtomicReference<Object> asyncResult, ...;CountDownLatch asyncDispatchLatch, ...;/** Create a new instance with the given request and response. */this.mockRequestthis.mockResponsethis.resolvedExceptionthis.modelAndViewgetOutputFlashMap(...)this.asyncResultgetAsyncResult(...)long requestTimeoutawaitAsyncDispatch(...)/** True if the latch count reached 0 within the specified timeout. */this.asyncDispatchLatchimport DispatcherServlet/** Strategy interface for customizing {@link DispatcherServlet} instances that are ... *//** Customize the supplied {@link DispatcherServlet} <em>before</em> it is ... */import MockFilterChain/** <strong>Main entry point for server-side Spring MVC test support.</strong> ... */new ArrayList<ResultMatcher>(...)new ArrayList<ResultHandler>(...)MockMvc.classString MVC_RESULT_ATTRIBUTE, ...;TestDispatcherServlet servlet, ...;RequestBuilder defaultRequestBuilder, ...;List<ResultMatcher> defaultResultMatchers, ...;List<ResultHandler> defaultResultHandlers, ...;/** Private constructor, not for direct instantiation. ... *//** A default request builder merged into every performed request. ... */this.defaultRequestBuilder/** Expectations to assert after every performed request. ... */this.defaultResultMatchers/** General actions to apply after every performed request. ... */this.defaultResultHandlers/** Return the underlying {@link DispatcherServlet} instance that this ... *//** Perform a request and return a type that allows chaining further ... */buildRequest(...)AsyncContext asyncContextMockHttpServletResponse mockResponseHttpServletResponse servletResponseMvcResult mvcResultnew DefaultMvcResult(...)RequestAttributes previousAttributesgetRequestAttributes(...)MockFilterChain filterChainnew MockFilterChain(...)unwrapResponseIfNecessary(...)postProcessRequest(...)DispatcherType.ASYNCgetDispatcherType(...)applyDefaultResultActions(...)new ResultActions(...) { ... }ResultMatcher matcherResultHandler handler/** Builds a {@link MockMvc} instance. ... *//** Build a {@link MockMvc} instance. *//** Base class for MockMvc builder implementations, providing the capability to ... */TestDispatcherServlet dispatcherServletnew TestDispatcherServlet(...)MockMvc mockMvcnew MockMvc(...)DispatcherServletCustomizer customizersnew MockMvcBuildException(...)setDefaultRequest(...)setGlobalResultMatchers(...)setGlobalResultHandlers(...)// should never happen..import HandlerExceptionResolver/** Provides access to the result of an executed request. ... *//** Return the performed request. ... *//** Return the resulting response. ... *//** Return the executed handler. ... *//** Return interceptors around the handler. ... *//** Return the {@code ModelAndView} prepared by the handler. ... *//** Return any exception raised by a handler and successfully resolved ... *//** Return the "output" flash attributes saved during request processing. ... *//** Get the result of async execution. ... *//** Get the result of async execution and wait if necessary. ... *//** Builds a {@link MockHttpServletRequest}. ... *//** Build the request. ... *//** Allows applying actions, such as expectations, on the result of an executed ... *//** Perform an expectation. ... *//** Perform a general action. ... *//** Return the result of the executed request for direct access to the results. ... *//** A {@code ResultHandler} performs a generic action on the result of an ... *//** Perform an action on the given result. ... *//** A {@code ResultMatcher} matches the result of an executed request against ... *//** Assert the result of an executed request. ... *//** Static method for matching with an array of result matchers. ... */new ResultMatcher(...) { ... }/** Extended variant of a {@link RequestBuilder} that applies its ... *//** Apply request post processing. Typically that means invoking one or more ... */import HandlerExecutionChain/** A sub-class of {@code DispatcherServlet} that saves the result in an ... */TestDispatcherServlet.classString KEY, ...;/** Create a new instance with the given web application context. */registerAsyncResultInterceptors(...)CountDownLatch dispatchLatchString requestClassNameaddDispatchHandler(...)setAsyncDispatchLatch(...)getMvcResult(...)new CallableProcessingInterceptor(...) { ... }setAsyncResult(...)new DeferredResultProcessingInterceptor(...) { ... }MockMvc.MVC_RESULT_ATTRIBUTEHandlerExecutionChain chainDefaultMvcResult mvcResultsetModelAndView(...)render(...)ModelAndView mavprocessHandlerException(...)setResolvedException(...)// We got the result, must also wait for the dispatch// We got this far, exception was processed..import WebTestClientimport DispatcherServletCustomizerimport RequestBuilderimport ResultMatcherimport ConfigurableMockMvcBuilderimport MockMvcConfigurer/** Base class for implementations of {@link MockMvcWebTestClient.MockMvcServerSpec} ... */MockMvcWebTestClient.MockMvcServerSpec<B>addFilters(...)getMockMvcBuilder(...)defaultRequest(...)alwaysExpect(...)dispatchOptions(...)addDispatcherServletCustomizer(...)/** Return the concrete {@link ConfigurableMockMvcBuilder} to delegate ... */ClientHttpConnector connectornew MockMvcHttpConnector(...)bindToServer(...)import DefaultMockMvcBuilderimport MockMvcBuilders/** Simple wrapper around a {@link DefaultMockMvcBuilder}. ... */DefaultMockMvcBuilder mockMvcBuilder, ...;this.mockMvcBuilderwebAppContextSetup(...)import ReactiveHttpInputMessageimport DefaultPartHttpMessageReaderimport FilePartimport MockPartimport MockServerClientHttpResponseimport MvcResultimport MockHttpServletRequestBuilderimport MockMultipartHttpServletRequestBuilderimport MockMvcRequestBuildersimport MockMvcResultHandlersimport static MockMvcRequestBuilders.asyncDispatch/** Connector that handles requests by invoking a {@link MockMvc} rather than ... */new DefaultPartHttpMessageReader(...)DefaultPartHttpMessageReader MULTIPART_READER, ...;Duration TIMEOUT, ...;RequestBuilder requestBuilderasyncDispatch(...)MockClientHttpRequest httpRequestAtomicReference<byte[]> contentRefnew AtomicReference<byte[]>(...)MockHttpServletRequestBuilder requestBuilderList<HttpCookie> cookiesHttpCookie cookiecookie(...)new Cookie(...)MockMultipartHttpServletRequestBuilder requestBuildermultipart(...)ReactiveHttpInputMessage inputMessagepost(...)Part.classnew Function<Part,Publisher<? extends DataBuffer>>(...) { ... }byte[] partBytesMockPart mockPartnew MockPart(...)filename(...)part(...)new MockMvcServerClientHttpResponse(...)getForwardedUrl(...)ResponseCookie httpCookiehttpOnly(...)secure(...)domain(...)maxAge(...)fromClientResponse(...)MvcResult mvcResult, ...;this.mvcResultnew PrintingMvcResult(...)getModelAndView(...)getResolvedException(...)getFlashMap(...)// Initialize the client request// Parse the multipart request in order to adapt to Servlet Part's// Adapt to javax.servlet.http.Part...import HttpMessageConverterimport ExchangeResultimport ResultActionsimport ResultHandlerimport StandaloneMockMvcBuilderimport ContentNegotiationManagerimport FlashMapManagerimport LocaleResolverimport Viewimport ViewResolverimport RequestMappingHandlerMappingimport PathPatternParser/** The main class for testing Spring MVC applications via {@link WebTestClient} ... *//** Begin creating a {@link WebTestClient} by providing the {@code @Controller} ... */new StandaloneMockMvcSpec(...)/** Begin creating a {@link WebTestClient} by providing a ... */new ApplicationContextMockMvcSpec(...)/** Begin creating a {@link WebTestClient} by providing an already ... *//** This method can be used to apply further assertions on a given ... */Object serverResultMvcResult.class/** Base specification for configuring {@link MockMvc}, and a simple facade ... *//** Add a global filter. ... *//** Add a filter for specific URL patterns. ... *//** Define default request properties that should be merged into all ... *//** Define a global expectation that should <em>always</em> be applied to ... *//** Whether to handle HTTP OPTIONS requests. ... *//** Allow customization of {@code DispatcherServlet}. ... *//** Add a {@code MockMvcConfigurer} that automates MockMvc setup. ... *//** Specification for configuring {@link MockMvc} to test one or more ... *//** Register {@link org.springframework.web.bind.annotation.ControllerAdvice} ... *//** Set the message converters to use. ... *//** Provide a custom {@link Validator}. ... *//** Provide a conversion service. ... *//** Add global interceptors. ... *//** Add interceptors for specific patterns. ... *//** Set a ContentNegotiationManager. ... *//** Specify the timeout value for async execution. ... *//** Provide custom argument resolvers. ... *//** Provide custom return value handlers. ... *//** Set the HandlerExceptionResolver types to use. ... *//** Set up view resolution. ... *//** Set up a single {@link ViewResolver} with a fixed view. ... *//** Provide the LocaleResolver to use. ... *//** Provide a custom FlashMapManager. ... *//** Enable URL path matching with parsed ... *//** Whether to match trailing slashes. ... *//** Configure placeholder values to use. ... *//** Configure factory for a custom {@link RequestMappingHandlerMapping}. ... *//** Simple wrapper around a {@link StandaloneMockMvcBuilder} that implements ... */MockMvcWebTestClient.ControllerSpecStandaloneMockMvcBuilder mockMvcBuilder, ...;standaloneSetup(...)setControllerAdvice(...)setMessageConverters(...)mappedInterceptors(...)addMappedInterceptors(...)setContentNegotiationManager(...)setAsyncRequestTimeout(...)setHandlerExceptionResolvers(...)setViewResolvers(...)setSingleView(...)setLocaleResolver(...)setFlashMapManager(...)setPatternParser(...)setUseTrailingSlashPatternMatch(...)addPlaceholderValue(...)setCustomHandlerMapping(...)/** Support for testing Spring MVC applications via ... */import WebConnectionimport WebResponse/** Implementation of {@link WebConnection} that allows delegating to various ... */List<DelegateWebConnection> connections, ...;WebConnection defaultConnection, ...;this.defaultConnectionDelegateWebConnection connectiongetMatcher(...)/** The delegate web connection. */WebRequestMatcher matcher, ...;WebConnection delegate, ...;this.matcherimport RequestPostProcessor/** {@link RequestPostProcessor} for forward requests. ... */String forwardUrl, ...;this.forwardUrlsetServletPath(...)/** A {@link WebRequestMatcher} that allows matching on the host and optionally ... */Set<String> hosts, ...;/** Create a new {@code HostRequestMatcher} for the given hosts &mdash; ... */this.hostsString hostAndPortgetDefaultPort(...)import CookieManagerimport FormEncodingTypeimport KeyDataPairimport NameValuePairimport SmartRequestBuilderimport UriComponents/** Internal class used to transform a {@link WebRequest} into a ... */Map<String,MockHttpSession> sessions, ...;WebClient webClient, ...;WebRequest webRequest, ...;RequestBuilder parentBuilder, ...;SmartRequestBuilder parentPostProcessor, ...;RequestPostProcessor forwardPostProcessor, ...;/** Construct a new {@code HtmlUnitRequestBuilder}. ... */this.webClientString httpMethodgetHttpMethod(...)UriComponents uriComponentsuriComponents(...)new HtmlUnitMockHttpServletRequest(...)parent(...)this.parentBuildersetServerName(...)authType(...)setCharacterEncoding(...)contextPath(...)locales(...)servletPath(...)params(...)ports(...)setProtocol(...)setQueryString(...)getQuery(...)setScheme(...)setPathInfo(...)this.parentPostProcessorthis.forwardPostProcessorMockHttpServletRequest parentRequestHttpSession parentSessionMap<String,String[]> parentParamsCookie[] parentCookiesEnumeration<String> parentAttrNamesHttpSession localSessionEnumeration<String> attrNamesObject attrValueEnumeration<String> attrValuesString attrValuenew BiConsumer<String,String[]>(...) { ... }setCookies(...)String parentAttrName/** Set the contextPath to be used. ... */validateContextPath(...)String authorizationString[] authSplitsetAuthType(...)String requestBodygetRequestBody(...)FormEncodingType encodingTypegetEncodingType(...)MediaType.ALL_VALUEList<String> pathSegmentsgetPathSegments(...)List<Cookie> cookiesString cookieHeaderValueSet<Cookie> managedCookiesString cookieNameString cookieValueprocessCookie(...)setRequestedSessionId(...)httpSession(...)getAdditionalHeaders(...)MockHttpSession sessionnew HtmlUnitMockHttpSession(...)setNew(...)addSessionCookie(...)getCookieManager(...)createCookie(...)removeCookie(...)getContextPath(...)String localeaddPreferredLocale(...)String urlDecodedNameurlDecode(...)NameValuePair paramgetRequestParameters(...)KeyDataPair pairMockPart partreadAllBytes(...)addPart(...)String servletPathgetPathInfo(...)int serverPortsetServerPort(...)int portConnectionsetLocalPort(...)setRemotePort(...)MockHttpServletRequestBuilder copiedParent/** An extension to {@link MockHttpServletRequest} that ensures that when a ... */HtmlUnitMockHttpSession newSessionString sessionidHtmlUnitRequestBuilder.this.sessionsHtmlUnitRequestBuilder.this/** An extension to {@link MockHttpSession} that ensures when ... */removeSessionCookie(...)// needs to be first for additional headers// session// header// parameter// cookie// request attribute/** {@code MockMvcWebClientBuilder} simplifies the creation of an HtmlUnit ... *//** Create a new {@code MockMvcWebClientBuilder} based on the supplied ... */new MockMvcWebClientBuilder(...)/** Supply the {@code WebClient} that the client {@linkplain #build built} ... */setWebConnection(...)/** Build the {@link WebClient} configured via this builder. ... */withDelegate(...)new WebClient(...)import BasicClientCookie/** {@code MockMvcWebConnection} enables {@link MockMvc} to transform a ... */new HashMap<String,MockHttpSession>(...)/** Create a new instance that assumes the context path of the application ... *//** Create a new instance with the specified context path. ... *//** Validate the supplied {@code contextPath}. ... */HtmlUnitRequestBuilder requestBuildernew HtmlUnitRequestBuilder(...)MockHttpServletResponse httpServletResponseString forwardedUrlsetForwardPostProcessor(...)new ForwardRequestPostProcessor(...)storeCookies(...)new MockWebResponseBuilder(...)ResultActions resultActionsCookieManager cookieManagerCookie toManageDate expiresafter(...)BasicClientCookie resultnew BasicClientCookie(...)setComment(...)getComment(...)setExpiryDate(...)import DelegateWebConnection/** Support class that simplifies the creation of a {@link WebConnection} that ... */new ArrayList<WebRequestMatcher>(...)List<WebRequestMatcher> requestMatchers, ...;boolean alwaysUseMockMvc, ...;/** Create a new instance using the supplied {@link MockMvc} instance. ... */new HostRequestMatcher(...)/** Create a new instance using the supplied {@link WebApplicationContext}. ... *//** Create a new instance using the supplied {@link WebApplicationContext} ... *//** Set the context path to use. ... *//** Specify that {@link MockMvc} should always be used regardless of ... */this.alwaysUseMockMvc/** Add additional {@link WebRequestMatcher} instances that will ensure ... *//** Add additional {@link WebRequestMatcher} instances that return {@code true} ... *//** Create a new {@link WebConnection} that will use a {@link MockMvc} ... */getWebConnection(...)WebConnection connectionnew MockMvcWebConnection(...)List<DelegateWebConnection> delegatesnew ArrayList<DelegateWebConnection>(...)WebRequestMatcher matchernew DelegateWebConnection(...)new DelegatingWebConnection(...)import WebResponseData/** Builder used internally to create {@link WebResponse WebResponses}. ... */String DEFAULT_STATUS_MESSAGE, ...;long startTime, ...;WebResponseData webResponseDatawebResponseData(...)long endTimenew WebResponse(...)List<NameValuePair> responseHeadersresponseHeaders(...)int statusCodegetRedirectedUrl(...)HttpStatus.MOVED_PERMANENTLYString statusMessagestatusMessage(...)new WebResponseData(...)getErrorMessage(...)Collection<String> headerNamesnew ArrayList<NameValuePair>(...)List<Object> headerValuesgetHeaderValues(...)new NameValuePair(...)/** A {@link WebRequestMatcher} that allows matching on ... *//** Strategy for matching on a {@link WebRequest}. ... *//** Whether this matcher matches on the supplied web request. ... *//** Server-side support for testing Spring MVC applications with {@code MockMvc} ... */import BrowserVersionimport HtmlUnitDriverimport MockMvcWebConnectionBuilderSupportimport WebRequestMatcher/** {@code MockMvcHtmlUnitDriverBuilder} simplifies the building of an ... */HtmlUnitDriver driver, ...;boolean javascriptEnabled, ...;/** Create a new {@code MockMvcHtmlUnitDriverBuilder} based on the supplied ... */new MockMvcHtmlUnitDriverBuilder(...)/** Specify whether JavaScript should be enabled. ... */this.javascriptEnabled/** Supply the {@code WebConnectionHtmlUnitDriver} that the driver ... */setJavascriptEnabled(...)getWebClient(...)/** Build the {@link HtmlUnitDriver} configured via this builder. ... */new WebConnectionHtmlUnitDriver(...)BrowserVersion.CHROMEimport Capabilities/** {@code WebConnectionHtmlUnitDriver} enables configuration of the ... *//** Modify the supplied {@link WebClient} and retain a reference to it so that its ... */modifyWebClient(...)modifyWebClientInternal(...)/** Modify the supplied {@link WebClient}. ... *//** Return the current {@link WebClient}. ... *//** Set the {@link WebConnection} to be used with the {@link WebClient}. ... *//** Access the current {@link WebConnection} for the {@link WebClient}. ... *//** Contains server-side support for testing Spring MVC applications. ... *//** An extension of {@link org.springframework.test.web.servlet.SmartRequestBuilder ... *//** Add the given {@code RequestPostProcessor}. */import SessionFlashMapManagerimport UriUtilsimport UrlPathHelper/** Default builder for {@link MockHttpServletRequest} required as input to ... */new ArrayList<Locale>(...)new ArrayList<RequestPostProcessor>(...)Boolean secure, ...;MockHttpSession session, ...;MultiValueMap<String,Object> headers, ...;MultiValueMap<String,String> parameters, ...;List<Locale> locales, ...;Map<String,Object> requestAttributes, ...;Map<String,Object> sessionAttributes, ...;Map<String,Object> flashAttributes, ...;List<RequestPostProcessor> postProcessors, ...;/** Package private constructor. To get an instance, use static factory ... *//** Alternative to {@link #MockHttpServletRequestBuilder(HttpMethod, String, Object...)} ... *//** Alternative constructor for custom HTTP methods. ... *//** Specify the portion of the requestURI that represents the context path. ... *//** Specify the portion of the requestURI that represents the path to which ... *//** Specify the portion of the requestURI that represents the pathInfo. ... *//** Set the secure property of the {@link ServletRequest} indicating use of a ... *//** Set the character encoding of the request. ... *//** Set the request body. ... *//** Set the request body as a UTF-8 String. ... *//** Set the 'Content-Type' header of the request. ... *//** Set the 'Content-Type' header of the request as a raw String value, ... *//** Set the 'Accept' header to the given media type(s). ... *//** Set the 'Accept' header using raw String values, possibly not even well ... *//** Add a header to the request. Values are always added. ... */addToMultiValueMap(...)/** Add all headers to the request. Values are always added. ... *//** Add a request parameter to {@link MockHttpServletRequest#getParameterMap()}. ... *//** Variant of {@link #param(String, String...)} with a {@link MultiValueMap}. ... *//** Append to the query string and also add to the ... *//** Add the given cookies to the request. Cookies are always added. ... *//** Add the specified locales as preferred request locales. ... *//** Set the locale of the request, overriding any previous locales. ... *//** Set a request attribute. ... */this.requestAttributes/** Set a session attribute. ... */this.sessionAttributes/** Set session attributes. ... */sessionAttr(...)/** Set an "input" flash attribute. ... */this.flashAttributes/** Set flash attributes. ... */flashAttr(...)/** Set the HTTP session to use, possibly re-used across requests. ... *//** Set the principal of the request. ... *//** An extension point for further initialization of {@link MockHttpServletRequest} ... */this.postProcessors/** Merges the properties of the "parent" RequestBuilder accepting values ... */MockHttpServletRequestBuilder parentBuilderparentBuilder.contextPathparentBuilder.servletPathparentBuilder.pathInfoparentBuilder.secureparentBuilder.principalparentBuilder.sessionparentBuilder.characterEncodingparentBuilder.contentparentBuilder.contentTypeparentBuilder.headersparentBuilder.parametersparentBuilder.queryParamsparentBuilder.cookiescontainsCookie(...)parentBuilder.localesparentBuilder.requestAttributesparentBuilder.sessionAttributesparentBuilder.flashAttributesparentBuilder.postProcessorsCookie cookieToCheck/** Build a {@link MockHttpServletRequest}. */createServletRequest(...)String requestUrigetRawPath(...)String querygetRawQuery(...)FlashMap flashMapnew FlashMap(...)FlashMapManager flashMapManagergetFlashMapManager(...)setRequestURI(...)updatePathRequestProperties(...)setUserPrincipal(...)new BiConsumer<String,List<Object>>(...) { ... }HttpHeaders.TRANSFER_ENCODINGaddRequestParams(...)String requestContentTypeparseFormData(...)setPreferredLocales(...)saveOutputFlashMap(...)/** Create a new {@link MockHttpServletRequest} based on the supplied ... *//** Update the contextPath, servletPath, and pathInfo of the request. */String extraPathdecodeRequestString(...)UrlPathHelper.defaultInstanceHttpInputMessage messagenew HttpInputMessage(...) { ... }DispatcherServlet.FLASH_MAP_MANAGER_BEAN_NAMEFlashMapManager.classnew SessionFlashMapManager(...)RequestPostProcessor postProcessor// Must be invalid, ignore..import MockMultipartFileimport MockMultipartHttpServletRequest/** Default builder for {@link MockMultipartHttpServletRequest}. ... */new ArrayList<MockMultipartFile>(...)List<MockMultipartFile> files, ...;/** Package-private constructor. Use static factory methods in ... */MediaType.MULTIPART_FORM_DATAthis.filesnew MockMultipartFile(...)/** Add the given MockMultipartFile. ... *//** Add {@link Part} components to the request. ... */MockMultipartHttpServletRequestBuilder parentBuilderparentBuilder.filesparentBuilder.parts/** Create a new {@link MockMultipartHttpServletRequest} based on the ... */MockMultipartHttpServletRequest requestnew MockMultipartHttpServletRequest(...)Charset defaultCharsetgetCharacterEncoding(...)new Consumer<MockMultipartFile>(...) { ... }addFile(...)new Function<List<Part>,Stream<? extends Part>>(...) { ... }new Consumer<Part>(...) { ... }getSubmittedFileName(...)getCharsetOrDefault(...)/** Static factory methods for {@link RequestBuilder RequestBuilders}. ... *//** Create a {@link MockHttpServletRequestBuilder} for a GET request. ... */new MockHttpServletRequestBuilder(...)/** Create a {@link MockHttpServletRequestBuilder} for a POST request. ... *//** Create a {@link MockHttpServletRequestBuilder} for a PUT request. ... *//** Create a {@link MockHttpServletRequestBuilder} for a PATCH request. ... *//** Create a {@link MockHttpServletRequestBuilder} for a DELETE request. ... *//** Create a {@link MockHttpServletRequestBuilder} for an OPTIONS request. ... *//** Create a {@link MockHttpServletRequestBuilder} for a HEAD request. ... *//** Create a {@link MockHttpServletRequestBuilder} for a request with the given HTTP method. ... *//** Alternative factory method that allows for custom HTTP verbs (e.g. WebDAV). ... *//** Create a {@link MockMultipartHttpServletRequestBuilder} for a multipart request. ... */new MockMultipartHttpServletRequestBuilder(...)/** Create a {@link RequestBuilder} for an async dispatch from the ... */new RequestBuilder(...) { ... }setDispatcherType(...)// There must be an async result before dispatching/** Extension point for applications or 3rd party libraries that wish to further ... *//** Post-process the given {@code MockHttpServletRequest} after its creation ... *//** Contains built-in {@link org.springframework.test.web.servlet.RequestBuilder} ... *//** Factory for response content assertions. ... *//** Assert the ServletResponse content type. The given content type must ... *//** Assert the ServletResponse content type after parsing it as a MediaType. ... *//** Assert the ServletResponse content type is compatible with the given ... *//** Assert the character encoding in the ServletResponse. ... *//** Assert the response body content with a Hamcrest {@link Matcher}. ... *//** Assert the response body content as a String. *//** Assert the response body content as a byte array. *//** Parse the response content and the given string as XML and assert the two ... *//** Parse the response content as {@link Node} and apply the given Hamcrest ... *//** Parse the response content as {@link DOMSource} and apply the given ... *//** Parse the response content and the given string as JSON and assert the two are "similar" - ... */import static AssertionErrors.assertNull/** Factory for response cookie assertions. ... *//** Assert a cookie value with the given Hamcrest {@link Matcher}. *//** Assert a cookie value. *//** Assert a cookie exists. The existence check is irrespective of whether ... *//** Assert a cookie does not exist. Note that the existence check is ... *//** Assert a cookie's maxAge with a Hamcrest {@link Matcher}. *//** Assert a cookie's maxAge. *//** Assert a cookie's path with a Hamcrest {@link Matcher}. *//** Assert a cookie's path. *//** Assert a cookie's domain with a Hamcrest {@link Matcher}. *//** Assert a cookie's domain. *//** Assert a cookie's comment with a Hamcrest {@link Matcher}. *//** Assert a cookie's comment. *//** Assert a cookie's version with a Hamcrest {@link Matcher}. *//** Assert a cookie's version. *//** Assert whether the cookie must be sent over a secure protocol or not. *//** Assert whether the cookie must be HTTP only. ... *//** Factory for "output" flash attribute assertions. ... *//** Assert a flash attribute's value with the given Hamcrest {@link Matcher}. *//** Assert a flash attribute's value. *//** Assert the existence of the given flash attributes. *//** Assert the number of flash attributes. */import MvcUriComponentsBuilderimport MethodInvocationInfoimport RequestMappingHandlerAdapter/** Factory for assertions on the selected handler or handler method. ... *//** Assert the type of the handler that processed the request. */Class<?> actual/** Assert the controller method used to process the request. ... */MethodInvocationInfo invocationInfogetControllerMethod(...)Method actualMethodInvocationInfo.class/** Assert the name of the controller method used to process the request ... *//** Assert the name of the controller method used to process the request. *//** Assert the controller method used to process the request. */import static AssertionErrors.assertFalse/** Factory for response header assertions. ... *//** Assert the primary value of the response header with the given Hamcrest ... *//** Assert the values of the response header with the given Hamcrest ... *//** Assert the primary value of the response header as a String value. *//** Assert the values of the response header as String values. ... *//** Assert that the named response header exists. ... */containsHeader(...)/** Assert that the named response header does not exist. ... */assertFalse(...)/** Assert the primary value of the named response header as a {@code long}. ... *//** Assert the primary value of the named response header parsed into a date ... */import StringStartsWith/** Factory for assertions on the response content using ... *//** Configures the current {@code JsonPathResultMatchers} instance ... *//** Evaluate the JSON path expression against the response content and ... */StringIndexOutOfBoundsException ex/** Static factory methods for {@link ResultHandler}-based result actions. ... *//** Log {@link MvcResult} details as a {@code DEBUG} log message via ... */new LoggingResultHandler(...)/** Print {@link MvcResult} details to the "standard" output stream. ... *//** Print {@link MvcResult} details to the supplied {@link OutputStream}. ... */new PrintWriterPrintingResultHandler(...)/** Print {@link MvcResult} details to the supplied {@link Writer}. ... *//** A {@link PrintingResultHandler} that writes to a {@link PrintWriter}. */new ResultValuePrinter(...) { ... }/** A {@link ResultHandler} that logs {@link MvcResult} details at ... */ResultHandler printingResultHandler/** Static factory methods for {@link ResultMatcher}-based result actions. ... *//** Access to request-related assertions. */new RequestResultMatchers(...)/** Access to assertions for the handler that handled the request. */new HandlerResultMatchers(...)/** Access to model-related assertions. */new ModelResultMatchers(...)/** Access to assertions on the selected view. */new ViewResultMatchers(...)/** Access to flash attribute assertions. */new FlashAttributeResultMatchers(...)/** Asserts the request was forwarded to the given URL. ... *//** Asserts the request was forwarded to the given URL template. ... */toUriString(...)forwardedUrl(...)/** Asserts the request was redirected to the given URL. ... *//** Asserts the request was redirected to the given URL template. ... */redirectedUrl(...)/** Access to response status assertions. */new StatusResultMatchers(...)/** Access to response header assertions. */new HeaderResultMatchers(...)/** Access to response body assertions. */new ContentResultMatchers(...)new JsonPathResultMatchers(...)/** Evaluate the given <a href="https://github.com/jayway/JsonPath">JsonPath</a> ... */new XpathResultMatchers(...)/** Access to response cookie assertions. */new CookieResultMatchers(...)/** Factory for assertions on the model. ... *//** Assert a model attribute value with the given Hamcrest {@link Matcher}. *//** Assert a model attribute value. *//** Assert the given model attributes exist. *//** Assert the given model attributes do not exist. *//** Assert the given model attribute(s) have errors. *//** Assert the given model attribute(s) do not have errors. *//** Assert the given model attribute field(s) have errors. */boolean hasFieldErrors/** Assert a field error code for a model attribute using exact String match. ... *//** Assert a field error code for a model attribute using a {@link org.hamcrest.Matcher}. ... *//** Assert the total number of errors in the model. */int actualCountgetModelMap(...)/** Assert the model has errors. *//** Assert the model has no errors. *//** Assert the number of model attributes. *//** Result handler that prints {@link MvcResult} details to a given output ... */String MISSING_CHARACTER_ENCODING, ...;ResultValuePrinter printer, ...;/** Return the result value printer. ... *//** Print {@link MvcResult} details. */printHeading(...)printRequest(...)printHandler(...)printAsyncResult(...)printResolvedException(...)printModelAndView(...)printFlashMap(...)printResponse(...)/** Print the request. */printValue(...)getParamsMultiValueMap(...)Enumeration<String> valuesMap<String,String[]> paramsHttpServletRequest requestObject asyncResult/** Print the handler. *//** Print exceptions resolved through a HandlerExceptionResolver. *//** Print the ModelAndView. */getView(...)/** Print "output" flash attributes. *//** Print the response. */printCookies(...)/** Print the supplied cookies in a human-readable form, assuming the ... */String[] cookieStringscookies.length/** A contract for how to actually write result information. */// Not setimport WebAsyncTask/** Factory for assertions on the request. ... *//** Assert whether asynchronous processing started, usually as a result of a ... */assertAsyncStarted(...)/** Assert that asynchronous processing was not started. ... *//** Assert the result from asynchronous processing with the given matcher. ... *//** Assert the result from asynchronous processing. ... *//** Assert a request attribute value with the given Hamcrest {@link Matcher}. *//** Assert a request attribute value. *//** Assert a session attribute value with the given Hamcrest {@link Matcher}. *//** Assert a session attribute value. *//** Assert the given session attributes do not exist. ... *//** Factory for assertions on the response status. ... *//** Assert the response status code with the given Hamcrest {@link Matcher}. ... *//** Assert the response status code is equal to an integer value. ... */getHttpStatusSeries(...)int statusValue/** Assert the Servlet response error message with the given Hamcrest {@link Matcher}. *//** Assert the Servlet response error message. *//** Assert the response status code is {@code HttpStatus.CONTINUE} (100). */HttpStatus.CONTINUE/** Assert the response status code is {@code HttpStatus.SWITCHING_PROTOCOLS} (101). */HttpStatus.SWITCHING_PROTOCOLS/** Assert the response status code is {@code HttpStatus.PROCESSING} (102). */HttpStatus.PROCESSING/** Assert the response status code is {@code HttpStatus.CHECKPOINT} (103). *//** Assert the response status code is {@code HttpStatus.NON_AUTHORITATIVE_INFORMATION} (203). */HttpStatus.NON_AUTHORITATIVE_INFORMATION/** Assert the response status code is {@code HttpStatus.RESET_CONTENT} (205). */HttpStatus.RESET_CONTENT/** Assert the response status code is {@code HttpStatus.PARTIAL_CONTENT} (206). */HttpStatus.PARTIAL_CONTENT/** Assert the response status code is {@code HttpStatus.MULTI_STATUS} (207). */HttpStatus.MULTI_STATUS/** Assert the response status code is {@code HttpStatus.ALREADY_REPORTED} (208). */HttpStatus.ALREADY_REPORTED/** Assert the response status code is {@code HttpStatus.IM_USED} (226). */HttpStatus.IM_USED/** Assert the response status code is {@code HttpStatus.MULTIPLE_CHOICES} (300). */HttpStatus.MULTIPLE_CHOICES/** Assert the response status code is {@code HttpStatus.MOVED_PERMANENTLY} (301). *//** Assert the response status code is {@code HttpStatus.MOVED_TEMPORARILY} (302). ... */HttpStatus.MOVED_TEMPORARILY/** Assert the response status code is {@code HttpStatus.USE_PROXY} (305). ... */HttpStatus.USE_PROXY/** Assert the response status code is {@code HttpStatus.PAYMENT_REQUIRED} (402). */HttpStatus.PAYMENT_REQUIRED/** Assert the response status code is {@code HttpStatus.FORBIDDEN} (403). *//** Assert the response status code is {@code HttpStatus.METHOD_NOT_ALLOWED} (405). */HttpStatus.METHOD_NOT_ALLOWED/** Assert the response status code is {@code HttpStatus.NOT_ACCEPTABLE} (406). */HttpStatus.NOT_ACCEPTABLE/** Assert the response status code is {@code HttpStatus.PROXY_AUTHENTICATION_REQUIRED} (407). */HttpStatus.PROXY_AUTHENTICATION_REQUIRED/** Assert the response status code is {@code HttpStatus.REQUEST_TIMEOUT} (408). */HttpStatus.REQUEST_TIMEOUT/** Assert the response status code is {@code HttpStatus.CONFLICT} (409). */HttpStatus.CONFLICT/** Assert the response status code is {@code HttpStatus.GONE} (410). */HttpStatus.GONE/** Assert the response status code is {@code HttpStatus.LENGTH_REQUIRED} (411). */HttpStatus.LENGTH_REQUIRED/** Assert the response status code is {@code HttpStatus.PRECONDITION_FAILED} (412). */HttpStatus.PRECONDITION_FAILED/** Assert the response status code is {@code HttpStatus.PAYLOAD_TOO_LARGE} (413). ... */HttpStatus.PAYLOAD_TOO_LARGE/** Assert the response status code is {@code HttpStatus.REQUEST_ENTITY_TOO_LARGE} (413). ... */HttpStatus.REQUEST_ENTITY_TOO_LARGE/** Assert the response status code is {@code HttpStatus.REQUEST_URI_TOO_LONG} (414). ... */HttpStatus.URI_TOO_LONGHttpStatus.REQUEST_URI_TOO_LONG/** Assert the response status code is {@code HttpStatus.UNSUPPORTED_MEDIA_TYPE} (415). */HttpStatus.UNSUPPORTED_MEDIA_TYPE/** Assert the response status code is {@code HttpStatus.REQUESTED_RANGE_NOT_SATISFIABLE} (416). */HttpStatus.REQUESTED_RANGE_NOT_SATISFIABLE/** Assert the response status code is {@code HttpStatus.EXPECTATION_FAILED} (417). */HttpStatus.EXPECTATION_FAILED/** Assert the response status code is {@code HttpStatus.I_AM_A_TEAPOT} (418). *//** Assert the response status code is {@code HttpStatus.INSUFFICIENT_SPACE_ON_RESOURCE} (419). ... */HttpStatus.INSUFFICIENT_SPACE_ON_RESOURCE/** Assert the response status code is {@code HttpStatus.METHOD_FAILURE} (420). ... */HttpStatus.METHOD_FAILURE/** Assert the response status code is {@code HttpStatus.DESTINATION_LOCKED} (421). ... */HttpStatus.DESTINATION_LOCKED/** Assert the response status code is {@code HttpStatus.UNPROCESSABLE_ENTITY} (422). */HttpStatus.UNPROCESSABLE_ENTITY/** Assert the response status code is {@code HttpStatus.LOCKED} (423). */HttpStatus.LOCKED/** Assert the response status code is {@code HttpStatus.FAILED_DEPENDENCY} (424). */HttpStatus.FAILED_DEPENDENCY/** Assert the response status code is {@code HttpStatus.TOO_EARLY} (425). ... *//** Assert the response status code is {@code HttpStatus.UPGRADE_REQUIRED} (426). */HttpStatus.UPGRADE_REQUIRED/** Assert the response status code is {@code HttpStatus.PRECONDITION_REQUIRED} (428). *//** Assert the response status code is {@code HttpStatus.TOO_MANY_REQUESTS} (429). *//** Assert the response status code is {@code HttpStatus.REQUEST_HEADER_FIELDS_TOO_LARGE} (431). *//** Assert the response status code is {@code HttpStatus.UNAVAILABLE_FOR_LEGAL_REASONS} (451). ... *//** Assert the response status code is {@code HttpStatus.INTERNAL_SERVER_ERROR} (500). *//** Assert the response status code is {@code HttpStatus.NOT_IMPLEMENTED} (501). */HttpStatus.NOT_IMPLEMENTED/** Assert the response status code is {@code HttpStatus.BAD_GATEWAY} (502). */HttpStatus.BAD_GATEWAY/** Assert the response status code is {@code HttpStatus.SERVICE_UNAVAILABLE} (503). */HttpStatus.SERVICE_UNAVAILABLE/** Assert the response status code is {@code HttpStatus.GATEWAY_TIMEOUT} (504). */HttpStatus.GATEWAY_TIMEOUT/** Assert the response status code is {@code HttpStatus.HTTP_VERSION_NOT_SUPPORTED} (505). */HttpStatus.HTTP_VERSION_NOT_SUPPORTED/** Assert the response status code is {@code HttpStatus.VARIANT_ALSO_NEGOTIATES} (506). */HttpStatus.VARIANT_ALSO_NEGOTIATES/** Assert the response status code is {@code HttpStatus.INSUFFICIENT_STORAGE} (507). */HttpStatus.INSUFFICIENT_STORAGE/** Assert the response status code is {@code HttpStatus.LOOP_DETECTED} (508). */HttpStatus.LOOP_DETECTED/** Assert the response status code is {@code HttpStatus.BANDWIDTH_LIMIT_EXCEEDED} (509). *//** Assert the response status code is {@code HttpStatus.NOT_EXTENDED} (510). */HttpStatus.NOT_EXTENDED/** Assert the response status code is {@code HttpStatus.NETWORK_AUTHENTICATION_REQUIRED} (511). *//** Match the expected response status to that of the HttpServletResponse. *//** Factory for assertions on the selected view. ... *//** Assert the selected view name with the given Hamcrest {@link Matcher}. *//** Assert the selected view name. *//** Factory for assertions on the response content using XPath expressions. ... *//** Protected constructor, not for direct instantiation. Use ... *//** Evaluate the XPath and assert the {@link Node} content found with the ... */getDefinedEncoding(...)/** Evaluate the XPath and assert the {@link NodeList} content found with the ... */assertNodeList(...)/** Get the response encoding if explicitly defined in the response, {code null} otherwise. *//** Evaluate the XPath and assert that content exists. *//** Evaluate the XPath and assert that content doesn't exist. *//** Evaluate the XPath and assert the number of nodes found with the given ... *//** Evaluate the XPath and assert the number of nodes found. *//** Apply the XPath and assert the {@link String} value found with the given ... *//** Apply the XPath and assert the {@link String} value found. *//** Evaluate the XPath and assert the {@link Double} value found with the ... *//** Evaluate the XPath and assert the {@link Double} value found. *//** Evaluate the XPath and assert the {@link Boolean} value found. *//** Contains built-in {@code ResultMatcher} and {@code ResultHandler} implementations. ... */import MockMvcBuilderimport MockMvcBuilderSupportimport ConfigurableSmartRequestBuilder/** Abstract implementation of {@link MockMvcBuilder} with common methods for ... */new ArrayList<Filter>(...)new ArrayList<DispatcherServletCustomizer>(...)new ArrayList<MockMvcConfigurer>(...)List<ResultMatcher> globalResultMatchers, ...;List<ResultHandler> globalResultHandlers, ...;List<DispatcherServletCustomizer> dispatcherServletCustomizers, ...;List<MockMvcConfigurer> configurers, ...;Filter furlPatterns.lengthnew PatternMappingFilterProxy(...)this.globalResultMatchersthis.globalResultHandlersthis.dispatcherServletCustomizersnew DispatcherServletCustomizer(...) { ... }setDispatchOptionsRequest(...)/** Build a {@link org.springframework.test.web.servlet.MockMvc} instance. */initWebAppContext(...)MockServletConfig mockServletConfigFilter[] filterArrayMockMvcConfigurer configurerRequestPostProcessor processorbeforeMockMvcCreated(...)createMockMvc(...)/** A method to obtain the {@code WebApplicationContext} to be passed to the ... *//** Defines common methods for building a {@code MockMvc}. ... *//** Add filters mapped to any request (i.e. "/*"). For example: ... *//** Add a filter mapped to a specific set of patterns. For example: ... *//** Define a global action that should <em>always</em> be applied to every ... *//** Whether to enable the DispatcherServlet property ... *//** A more advanced variant of {@link #dispatchOptions(boolean)} that allows ... *//** Add a {@code MockMvcConfigurer} that automates MockMvc setup and ... *//** A concrete implementation of {@link AbstractMockMvcBuilder} that provides ... */WebApplicationContext webAppContext, ...;/** Protected constructor. Not intended for direct instantiation. ... */this.webAppContextApplicationContext rootWacgetWebApplicationContext(...)/** The main class to import in order to access all available {@link MockMvcBuilder MockMvcBuilders}. ... *//** Build a {@link MockMvc} instance using the given, fully initialized ... */new DefaultMockMvcBuilder(...)/** Build a {@link MockMvc} instance by registering one or more ... */new StandaloneMockMvcBuilder(...)/** Contract for customizing a {@code ConfigurableMockMvcBuilder} in some ... *//** Invoked immediately when this {@code MockMvcConfigurer} is added via ... *//** Invoked when the MockMvc instance is about to be created with the MockMvc ... *//** An empty method implementation of {@link MockMvcConfigurer}. ... *//** A Filter that invokes a delegate {@link Filter} only if the request URL ... */String EXTENSION_MAPPING_PATTERN, ...;String PATH_MAPPING_PATTERN, ...;Filter delegate, ...;List<String> exactMatches, ...;/** Patterns that require an exact match, e.g. "/test" */List<String> startsWithMatches, ...;/** Patterns that require the URL to have a specific prefix, e.g. "/test/*" */List<String> endsWithMatches, ...;/** Patterns that require the request URL to have a specific suffix, e.g. "*.html" *//** Creates a new instance. */String urlPatternaddUrlPattern(...)this.endsWithMatchesthis.startsWithMatchesthis.exactMatchesHttpServletRequest httpRequestString requestPathgetPathWithinApplication(...)/** {@link MockMvcConfigurer} that stores and re-uses the HTTP session across ... */alwaysDo(...)new ResultHandler(...) { ... }new RequestPostProcessor(...) { ... }new SharedHttpSessionConfigurer(...)import WebApplicationObjectSupportimport AsyncSupportConfigurerimport InterceptorRegistrationimport InterceptorRegistryimport WebMvcConfigurationSupportimport AbstractHandlerMappingimport MappedInterceptorimport AcceptHeaderLocaleResolverimport ResourceUrlProviderimport FixedThemeResolverimport DefaultRequestToViewNameTranslatorimport InternalResourceViewResolver/** A {@code MockMvcBuilder} that accepts {@code @Controller} registrations ... */new ArrayList<HttpMessageConverter<?>>(...)new ArrayList<MappedInterceptor>(...)new AcceptHeaderLocaleResolver(...)new Supplier<RequestMappingHandlerMapping>(...) { ... }new RequestMappingHandlerMapping(...)List<HttpMessageConverter<?>> messageConverters, ...;List<MappedInterceptor> mappedInterceptors, ...;ContentNegotiationManager contentNegotiationManager, ...;List<HandlerExceptionResolver> handlerExceptionResolvers, ...;Long asyncRequestTimeout, ...;List<ViewResolver> viewResolvers, ...;LocaleResolver localeResolver, ...;FlashMapManager flashMapManager, ...;PathPatternParser patternParser, ...;boolean useSuffixPatternMatch, ...;boolean useTrailingSlashPatternMatch, ...;Boolean removeSemicolonContent, ...;Map<String,String> placeholderValues, ...;Supplier<RequestMappingHandlerMapping> handlerMappingFactory, ...;/** Set the message converters to use in argument resolvers and in return value ... */this.messageConverters/** Provide a custom {@link Validator} instead of the one created by default. ... *//** Provide a conversion service with custom formatters and converters. ... *//** Add interceptors mapped to all incoming requests. *//** Add interceptors mapped to a set of path patterns. */HandlerInterceptor interceptorthis.mappedInterceptorsnew MappedInterceptor(...)/** Set a ContentNegotiationManager. */this.contentNegotiationManager/** Specify the timeout value for async execution. In Spring MVC Test, this ... */this.asyncRequestTimeout/** Provide custom resolvers for controller method arguments. *//** Provide custom handlers for controller method return values. *//** Set the HandlerExceptionResolver types to use as a list. */this.handlerExceptionResolvers/** Set the HandlerExceptionResolver types to use as an array. *//** Set up view resolution with the given {@link ViewResolver ViewResolvers}. ... */this.viewResolvers/** Sets up a single {@link ViewResolver} that always returns the provided ... */new StaticViewResolver(...)/** Provide a LocaleResolver instance. ... */this.localeResolver/** Provide a custom FlashMapManager instance. ... */this.flashMapManagerthis.patternParser/** Whether to use suffix pattern match (".*") when matching patterns to ... */this.useSuffixPatternMatch/** Whether to match to URLs irrespective of the presence of a trailing slash. ... */this.useTrailingSlashPatternMatch/** Set if ";" (semicolon) content should be stripped from the request URI. The value, ... */this.removeSemicolonContent/** In a standalone setup there is no support for placeholder values embedded in ... */this.placeholderValues/** Configure factory to create a custom {@link RequestMappingHandlerMapping}. ... */this.handlerMappingFactoryStubWebApplicationContext wacnew StubWebApplicationContext(...)registerMvcSingletons(...)StandaloneConfiguration confignew StandaloneConfiguration(...)FormattingConversionService mvcConversionServicemvcConversionService(...)ResourceUrlProvider resourceUrlProvidermvcResourceUrlProvider(...)ContentNegotiationManager mvcContentNegotiationManagermvcContentNegotiationManager(...)Validator mvcValidatormvcValidator(...)RequestMappingHandlerMapping hmgetHandlerMapping(...)RequestMappingHandlerAdapter harequestMappingHandlerAdapter(...)addBeans(...)handlerExceptionResolver(...)initViewResolvers(...)DispatcherServlet.LOCALE_RESOLVER_BEAN_NAMEDispatcherServlet.THEME_RESOLVER_BEAN_NAMEnew FixedThemeResolver(...)DispatcherServlet.REQUEST_TO_VIEW_NAME_TRANSLATOR_BEAN_NAMEnew DefaultRequestToViewNameTranslator(...)extendMvcSingletons(...)new InternalResourceViewResolver(...)Object viewResolver/** This method could be used from a sub-class to register additional Spring ... *//** Using the MVC Java configuration as the starting point for the "standalone" setup. */RequestMappingHandlerMapping handlerMappingnew StaticStringValueResolver(...)setUseSuffixPatternMatch(...)setRemoveSemicolonContent(...)setUseTrailingSlashMatch(...)MappedInterceptor interceptorInterceptorRegistration registrationgetPathPatterns(...)addPathPatterns(...)setDefaultTimeout(...)HandlerExceptionResolver resolver/** A static resolver placeholder for values embedded in request mappings. *//** A {@link ViewResolver} that always returns same View. */View view, ...;this.viewimport DelegatingMessageSourceimport ServletContextResourcePatternResolver/** A stub WebApplicationContext that accepts registrations of object instances. ... */new StubBeanFactory(...)StubBeanFactory beanFactory, ...;new ServletContextResourcePatternResolver(...)/** Returns an instance that can initialize {@link ApplicationContextAware} beans. */// Implementation of ResourceLoader interface// Other/** An extension of StaticListableBeanFactory that implements ... */StubWebApplicationContext.this/** Contains built-in {@code MockMvcBuilder} implementations. ... *//** Unit tests for {@link MockServerHttpRequest}. ... */HttpCookie foo11new HttpCookie(...)HttpCookie foo12HttpCookie foo21HttpCookie foo22MockServerHttpRequest requestassertThrows(...)String uriTemplatenew Executable(...) { ... }/** Unit tests for {@link MockServerHttpResponse}. ... */ResponseCookie foo11ResponseCookie foo12ResponseCookie foo21ResponseCookie foo22MockServerHttpResponse responseapplyCookies(...)/** Tests for {@link SimpleNamingContextBuilder} and {@link SimpleNamingContext}. ... */InitialContextFactory factorycreateInitialContextFactory(...)Context context1getInitialContext(...)Hashtable<String,String> env2Context context2Context context3Map<String,Binding> bindingMapnew HashMap<String,Binding>(...)NamingEnumeration<?> bindingEnumlistBindings(...)Context jdbcContextMap<String,Binding> subBindingMapNamingEnumeration<?> subBindingEnumMap<String,String> pairMapNamingEnumeration<?> pairEnumContext subContextMap<String,String> subPairMapNamingEnumeration<?> subPairEnumaddToEnvironment(...)removeFromEnvironment(...)SimpleNamingContext.classStubDataSource.classcreateSubcontext(...)hasMore(...)NameClassPair pair/** Demonstrates how emptyActivatedContextBuilder() method can be ... */InitialContext badCtx1InitialContext badCtx2// Check it affects JNDI// Check it returns mutable contexts// Check the same call will work again, but the context is empty/** Unit tests for {@link MockCookie}. ... */assertCookie(...)/** Test fixture for {@link MockFilterChain}. ... */Servlet.classMockFilterChain chainServlet servletMockFilter filter2new MockFilter(...)MockFilter filter1filter1.invokedfilter2.invokedthis.invoked/** Unit tests for {@link MockHttpServletRequest}. ... */MockHttpServletRequest.DEFAULT_PROTOCOLMockHttpServletRequest.DEFAULT_SCHEMEString palindromeEnumeration<String> requestHeadersString[] values1getParameterValues(...)String[] values3values1.lengthvalues3.lengthaddParameters(...)removeAllParameters(...)Cookie cookie1Cookie cookie2Cookie[] cookiesList<String> cookieHeadersdescribedAs(...)new Consumer<Cookie[]>(...) { ... }Locale originalDefaultLocaleLocale newDefaultLocaleLocale.FRANCEList<Locale> preferredLocalesLocale.ITALYLocale.CHINAassertEqualEnumerations(...)getLocales(...)List<Locale> actualString testServerint testPortgetRequestURL(...)StringBuffer requestURLHttpHeaders.IF_MODIFIED_SINCEgetDateHeader(...)// SPR-16505// SPR-16499// SPR-12677// Create the request after changing the default locale.// missing closing bracket// "bogus" is not a port number// SPR-16138import static SoftAssertions.assertSoftlyimport static HttpHeaders.CONTENT_LANGUAGEimport static HttpHeaders.CONTENT_LENGTHimport static HttpHeaders.CONTENT_TYPEimport static HttpHeaders.LAST_MODIFIEDimport static HttpHeaders.LOCATIONimport static HttpHeaders.SET_COOKIE/** Unit tests for {@link MockHttpServletResponse}. ... */String contentLanguageassertSoftly(...)new Consumer<SoftAssertions>(...) { ... }Locale.ITALIANaddIntHeader(...)Collection<String> responseHeadersgetContentAsByteArray(...).lengthString redirectUrlsendRedirect(...)setDateHeader(...)addDateHeader(...)sendError(...)HttpServletResponse.SC_NOT_FOUNDHttpServletResponse.SC_INTERNAL_SERVER_ERRORassertNumCookies(...)assertPrimarySessionCookie(...)assertCookieValues(...)new ThrowingExtractor<Cookie,String,RuntimeException>(...) { ... }MockCookie.classString contentTypeHeader// gh-26488// gh-26493// gh-25281// SPR-16683// gh-23219// SPR-16160// SPR-10414// Setting the Set-Cookie header a 2nd time should overwrite the previous value// We don't assert the actual Expires value since it is based on the current time.// Adding a 2nd cookie header should result in 2 cookies.// Adding a 2nd Cookie should result in 2 Cookies.// gh-25501// Do not invoke setCharacterEncoding() since that sets the charset flag to true.// response.setCharacterEncoding("UTF-8");// should still be false/** Unit tests for {@link MockHttpSession}. ... */getLastAccessedTime(...)getValueNames(...)putValue(...)isNew(...)String bindingListenerNameCountingHttpSessionBindingListener bindingListenernew CountingHttpSessionBindingListener(...)CountingHttpSessionBindingListener bindingListener1CountingHttpSessionBindingListener bindingListener2getFileNames(...)getFileMap(...)doTestMultipartHttpServletRequest(...)MockPart metadataPartHttpHeaders fileHttpHeadersgetMultipartHeaders(...)HttpHeaders dataHttpHeadersMediaType.TEXT_PLAIN_VALUEMediaType.TEXT_PLAINSet<String> fileNamesIterator<String> fileIterMultipartFile file1MultipartFile file2Map<String,MultipartFile> fileMapList<String> fileMapKeysgetOriginalFilename(...)/** Unit tests for the {@code MockPageContext} class. ... */new MockPageContext(...)MockPageContext ctx, ...;import OS/** Unit tests for {@link MockServletContext}. ... */MockServletContext servletContext, ...;Set<String> pathsgetResourcePaths(...)MockServletContext sc2registerContext(...)/** Introduced to dispel claims in a thread on Stack Overflow: ... */addMimeType(...)new MediaType(...)getMinorVersion(...)getEffectiveMajorVersion(...)getEffectiveMinorVersion(...)setMajorVersion(...)setMinorVersion(...)setEffectiveMajorVersion(...)setEffectiveMinorVersion(...)RequestDispatcher namedDispatchergetNamedDispatcher(...)String originalDefaultString newDefaultsetDefaultServletName(...)getDefaultServletName(...)getServletRegistration(...)Map<String,? extends ServletRegistration> servletRegistrationsgetServletRegistrations(...)getFilterRegistration(...)Map<String,? extends FilterRegistration> filterRegistrationsgetFilterRegistrations(...)URL resourceString realPathisCurrentOs(...)OS.WINDOWS/** Unit tests for {@link ProfileValueUtils}. ... */String NON_ANNOTATED_METHOD, ...;String ENABLED_ANNOTATED_METHOD, ...;String DISABLED_ANNOTATED_METHOD, ...;// -------------------------------------------------------------------assertClassIsEnabled(...)NonAnnotated.classEnabledAnnotatedSingleValue.classEnabledAnnotatedMultiValue.classMetaEnabledClass.classMetaEnabledWithCustomProfileValueSourceClass.classEnabledWithCustomProfileValueSourceOnTestInterface.classassertClassIsDisabled(...)DisabledAnnotatedSingleValue.classDisabledAnnotatedSingleValueOnTestInterface.classDisabledAnnotatedMultiValue.classMetaDisabledClass.classMetaDisabledWithCustomProfileValueSourceClass.classassertMethodIsEnabled(...)assertMethodIsDisabled(...)MetaEnabledAnnotatedSingleValue.classMetaDisabledAnnotatedSingleValue.classHardCodedProfileValueSource.classimport DefaultBootstrapContext/** Collection of test-related utility methods for working with {@link BootstrapContext ... */new DefaultBootstrapContext(...)import NestedWithInheritedBootstrapperimport DoubleNestedWithInheritedButOverriddenBootstrapperimport DoubleNestedWithOverriddenBootstrapperimport TripleNestedWithInheritedBootstrapperimport TripleNestedWithInheritedBootstrapperButLocalOverrideimport NestedWithInheritedWebConfigimport DoubleNestedWithImplicitlyInheritedWebConfigimport DoubleNestedWithOverriddenWebConfigimport TripleNestedWithInheritedOverriddenWebConfigimport TripleNestedWithInheritedOverriddenWebConfigAndTestInterfaceimport WebTestContextBootstrapperimport static BootstrapUtils.resolveTestContextBootstrapperimport static EnclosingConfiguration.INHERITimport static EnclosingConfiguration.OVERRIDE/** Unit tests for {@link BootstrapUtils}. ... */CacheAwareContextLoaderDelegate delegate, ...;BootstrapContext bootstrapContextbuildBootstrapContext(...)EmptyBootstrapWithAnnotationClass.classDoubleMetaAnnotatedBootstrapWithAnnotationClass.classFooBootstrapper.classBarBootstrapper.classassertBootstrapper(...)DefaultTestContextBootstrapper.classDirectBootstrapWithAnnotationClass.classInheritedBootstrapWithAnnotationClass.classMetaAnnotatedBootstrapWithAnnotationClass.classDuplicateMetaAnnotatedBootstrapWithAnnotationClass.classargs(...)OuterClass.classNestedWithInheritedBootstrapper.classDoubleNestedWithInheritedButOverriddenBootstrapper.classEnigmaBootstrapper.classDoubleNestedWithOverriddenBootstrapper.classTripleNestedWithInheritedBootstrapper.classTripleNestedWithInheritedBootstrapperButLocalOverride.classWebAppConfigClass.classWebTestContextBootstrapper.classNestedWithInheritedWebConfig.classDoubleNestedWithImplicitlyInheritedWebConfig.classDoubleNestedWithOverriddenWebConfig.classTripleNestedWithInheritedOverriddenWebConfig.classTripleNestedWithInheritedOverriddenWebConfigAndTestInterface.classLocalDeclarationAndMetaAnnotatedBootstrapWithAnnotationClass.classTestContextBootstrapper bootstrapper// Invalid// enclosing class for TestInterface is annotated with @WebAppConfiguration.// considered to be annotated with @WebAppConfiguration even though the// TripleNestedWithInheritedOverriddenWebConfigAndTestInterface is not// Intentionally not annotated with @WebAppConfiguration to ensure that// @WebAppConfiguration and default bootstrapperimport MethodOrdererimport TestMethodOrderimport JUnitCoreimport SpringRunner/** Integration tests that verify proper behavior of {@link DirtiesContext @DirtiesContext} ... */MethodOrderer.MethodName.classMethodOrderer.MethodNameString baz, ...;ContextHierarchyDirtiesContextTests.contextContextHierarchyDirtiesContextTests.fooContextHierarchyDirtiesContextTests.barContextHierarchyDirtiesContextTests.bazrunTestAndVerifyHierarchies(...)ClassLevelDirtiesContextWithCurrentLevelModeTestCase.classClassLevelDirtiesContextWithExhaustiveModeTestCase.classMethodLevelDirtiesContextWithCurrentLevelModeTestCase.classMethodLevelDirtiesContextWithExhaustiveModeTestCase.classJUnitCore jUnitCorenew JUnitCore(...)ConfigurableApplicationContext bazContextConfigurableApplicationContext barContextConfigurableApplicationContext fooContextwasSuccessful(...)/** {@link DirtiesContext} is declared at the class level, without specifying ... *//** {@link DirtiesContext} is declared at the class level, specifying the ... *//** {@link DirtiesContext} is declared at the method level, without specifying ... *//** {@link DirtiesContext} is declared at the method level, specifying the ... */import static Lifecycle.PER_CLASS/** Integration tests for {@link DynamicPropertySource @DynamicPropertySource}. ... */new DemoContainer(...)String TEST_CONTAINER_IP, ...;DemoContainer container, ...;getIpAddress(...)getIp(...)String ip, ...;this.ipimport AnnotationConfigContextLoaderimport GenericXmlContextLoader/** Unit tests for {@link MergedContextConfiguration}. ... */GenericXmlContextLoader loader, ...;MergedContextConfiguration mergedConfig1MergedContextConfiguration mergedConfig2String[] locations1String[] locations2Class<?>[] classes1Class<?>[] classes2String[] activeProfiles1String[] activeProfiles2Set<Class<? extends ApplicationContextInitializer<?>>> initializerClasses1new HashSet<Class<? extends ApplicationContextInitializer<?>>>(...)Set<Class<? extends ApplicationContextInitializer<?>>> initializerClasses2FooInitializer.classBarInitializer.classMergedContextConfiguration parent1MergedContextConfiguration parent2ContextCustomizer.classSet<ContextCustomizer> customizers1Set<ContextCustomizer> customizers2/** Unit tests for {@link TestContextAnnotationUtils} that verify support for ... */MetaValueConfigTestCase.classMetaValueConfig.classOverriddenMetaValueConfigTestCase.classMetaLocationsConfigTestCase.classMetaLocationsConfig.classOverriddenMetaLocationsConfigTestCase.classimport JUnitPlatformimport ExcludeTagsimport IncludeClassNamePatternsimport SelectPackagesimport UseTechnicalNames/** JUnit Platform based test suite for tests that involve the Spring TestContext ... */JUnitPlatform.classimport static TestContextAnnotationUtils.searchEnclosingClass/** Unit tests for {@link TestContextAnnotationUtils}. ... */clearCaches(...)setGlobalFlag(...)OuterTestCase.classOuterTestCase.NestedTestCase.classOuterTestCase.NestedTestCaseOuterTestCase.NestedTestCase.DoubleNestedTestCase.classOuterTestCase.NestedTestCase.DoubleNestedTestCaseTransactional rawAnnotationAnnotationDescriptor<Transactional> descriptorOrder rawAnnotationAnnotationDescriptor<Order> descriptorassertAtComponentOnComposedAnnotation(...)HasMetaComponentAnnotation.classClass<Component> annotationTypeAnnotationDescriptor<Component> descriptorHasLocalAndMetaComponentAnnotation.classInterfaceWithMetaAnnotation.classComponent rawAnnotationClassWithMetaAnnotatedInterface.classMetaAnnotatedAndSuperAnnotatedContextConfigClass.classMetaConfig.classSubClassWithLocalMetaAnnotationAndMetaAnnotatedInterface.classClass<?> startClassassertAtComponentOnComposedAnnotationForMultipleCandidateTypes(...)MetaConfigWithDefaultAttributesTestCase.classMetaConfig.DevConfig.classMetaConfig.ProductionConfig.classMetaConfig.DevConfigMetaConfig.ProductionConfigMetaConfigWithOverriddenAttributesTestCase.classTestContextAnnotationUtilsTests.class// Note: @Transactional is inherited// Note: @Order is not inherited.// InheritedAnnotationClass is NOT annotated or meta-annotated with @Component// InheritedAnnotationClass is NOT annotated or meta-annotated with @Component,// @Service, or @Order, but it is annotated with @Transactional.import static Collectors.toCollection/** Integration tests that verify proper concurrency support between a ... */TestCase.classnew Supplier<TreeSet<String>>(...) { ... }new TestCase(...)Set<String> expectedMethods, ...;Set<String> actualMethods, ...;TestCase testInstance, ...;TestContextManager tcmattributeNames(...).lengthTrackingListener.classnew ThreadLocal<String>(...)ThreadLocal<String> methodName, ...;// Run the actual test several times in order to increase the chance of threads// stepping on each others' toes by overwriting the same mutable state in the// TestContext.// Execute TestExecutionListener in parallel, thereby simulating parallel// test method execution.// no need to invoke the actual test method/** JUnit 4 based unit tests for {@link TestContextManager}, which verify proper ... */FailingAfterTestExecutionTestCase.classnew Callback(...) { ... }FailingAfterTestMethodTestCase.classFailingAfterTestClassTestCase.classThrowable[] suppressedgetSuppressed(...)FailingAfterTestExecutionListener1.classFailingAfterTestExecutionListener2.classFailingAfterTestMethodListener1.classFailingAfterTestMethodListener2.classFailingAfterTestClassListener1.classFailingAfterTestClassListener2.class// 'after' callbacks are reversed, so 2 comes before 1./** JUnit 4 based unit test for {@link TestContextManager}, which verifies proper ... */ExampleTestCase.classList<String> executionOrder, ...;assertExecutionOrder(...)FirstTel.classSecondTel.classThirdTel.classimport ContextCacheimport DefaultCacheAwareContextLoaderDelegate/** Collection of test-related utility methods for working with {@link TestContext TestContexts}. ... */new DefaultCacheAwareContextLoaderDelegate(...)import AnnotationConfigurationExceptionimport static MergeMode.MERGE_WITH_DEFAULTS/** Unit tests for the {@link TestExecutionListeners @TestExecutionListeners} ... */List<Class<?>> expectedassertRegisteredListeners(...)DefaultListenersTestCase.classQuuxTestExecutionListener.classMergedDefaultListenersWithCustomListenerPrependedTestCase.classBazTestExecutionListener.classMergedDefaultListenersWithCustomListenerAppendedTestCase.classBarTestExecutionListener.classMergedDefaultListenersWithCustomListenerInsertedTestCase.classNonInheritedDefaultListenersTestCase.classInheritedDefaultListenersTestCase.classSubInheritedDefaultListenersTestCase.classSubSubInheritedDefaultListenersTestCase.classEnigmaTestExecutionListener.classassertNumRegisteredListeners(...)ExplicitListenersTestCase.classExplicitListenersOnTestInterfaceTestCase.classFooTestExecutionListener.classNonInheritedListenersTestCase.classInheritedListenersTestCase.classMetaTestCase.classMetaNonInheritedListenersTestCase.classMetaInheritedListenersTestCase.classMetaWithOverridesTestCase.classMetaInheritedListenersWithOverridesTestCase.classMetaNonInheritedListenersWithOverridesTestCase.classDuplicateListenersConfigTestCase.classnew Function<TestExecutionListener,Class<? extends Object>>(...) { ... }// 2500 is between DependencyInjectionTestExecutionListener (2000) and// DirtiesContextTestExecutionListener (3000)import RepeatedTest/** Integration tests for applications using {@link Async @Async} methods with ... */// If we don't run out of memory, then this test is a success.import TestNGimport AbstractTestNGSpringContextTestsimport TrackingTestNGTestListenerimport static ContextCacheTestUtils.assertContextCacheStatisticsimport static ContextCacheTestUtils.resetContextCache/** JUnit based integration test which verifies correct {@linkplain ContextCache ... */AtomicInteger cacheHits, ...;AtomicInteger cacheMisses, ...;resetContextCache(...)assertContextCacheStatistics(...)assertBehaviorForCleanTestCase(...)runTestClassAndAssertStats(...)ClassLevelDirtiesContextWithCleanMethodsAndDefaultModeTestCase.classInheritedClassLevelDirtiesContextWithCleanMethodsAndDefaultModeTestCase.classClassLevelDirtiesContextWithCleanMethodsAndAfterClassModeTestCase.classInheritedClassLevelDirtiesContextWithCleanMethodsAndAfterClassModeTestCase.classClassLevelDirtiesContextWithAfterEachTestMethodModeTestCase.classInheritedClassLevelDirtiesContextWithAfterEachTestMethodModeTestCase.classClassLevelDirtiesContextWithDirtyMethodsTestCase.classInheritedClassLevelDirtiesContextWithDirtyMethodsTestCase.classint expectedTestFailureCountint expectedTestStartedCountint expectedTestFinishedCountTrackingTestNGTestListener listenernew TrackingTestNGTestListener(...)TestNG testNGnew TestNG(...)setTestClasses(...)setVerbose(...)listener.testFailureCountlistener.testStartCountlistener.testSuccessCountCleanTestCase.classDisabledRetryAnalyzer.classassertApplicationContextWasAutowired(...)ClassMode.AFTER_CLASSClassMode.AFTER_EACH_TEST_METHOD// Reset static counters in case tests are run multiple times in a test suite --// for example, via JUnit's @Suite./* no beans */import static JUnitTestingUtils.runTestsAndAssertCountersrunTestsAndAssertCounters(...)// Ensure that we do not include the EventPublishingTestExecutionListener// since it will access the ApplicationContext for each method in the// TestExecutionListener API, thus distorting our cache hit/miss results./** Collection of utility methods for testing scenarios involving the ... *//** Reset the state of the static context cache in {@link DefaultCacheAwareContextLoaderDelegate}. */DefaultCacheAwareContextLoaderDelegate.defaultContextCache/** Assert the statistics of the static context cache in {@link DefaultCacheAwareContextLoaderDelegate}. ... *//** Assert the statistics of the supplied context cache. ... */import TestContextTestUtilsimport ReflectionTestUtils/** Integration tests for verifying proper behavior of the {@link ContextCache} in ... */assertParentContextCount(...)TestContext testContextloadCtxAndAssertStats(...)AnnotationConfigContextLoaderTestCase.classCustomAnnotationConfigContextLoaderTestCase.classint hitint missFooBarProfilesTestCase.classBarFooProfilesTestCase.classFooBarActiveProfilesResolverTestCase.classint hitsint missesClassHierarchyContextHierarchyLevel1TestCase.classClassHierarchyContextHierarchyLevel2TestCase.classClassHierarchyContextHierarchyLevel3aTestCase.classClassHierarchyContextHierarchyLevel3bTestCase.classTestContext testContext3aTestContext testContext3bgetMergedContextConfiguration(...)CustomAnnotationConfigContextLoader.classFooBarActiveProfilesResolver.class// Profiles {foo, bar} should not hash to the same as {bar,foo}// Level 1// Level 2/* L2 *//* L1 */// Level 3-A/* L3A */// Level 3-B/* L3B */// Load Level 3-A// Load Level 3-B// Remove Level 1// Should also remove Levels 2, 3-A, and 3-B, leaving nothing.// Remove Level 2// Should also remove Levels 3-A and 3-B, leaving only Level 1 as a context in the// cache but also removing the Level 1 hierarchy since all children have been// removed.// Should wipe the cache// Remove Level 3-A// Should also remove Level 3-B, leaving only Level 1.// Should wipe the cache.// Should not actually do anything since the cache was cleared in the// previous step. So the stats should remain the same.import static ContextCache.DEFAULT_MAX_CONTEXT_CACHE_SIZEimport static ContextCache.MAX_CONTEXT_CACHE_SIZE_PROPERTY_NAMEimport static ContextCacheUtils.retrieveMaxCacheSize/** Unit tests for {@link ContextCacheUtils}. ... */assertDefaultValue(...)/** Unit tests for the LRU eviction policy in {@link DefaultContextCache}. ... */Abc.classMergedContextConfiguration abcConfig, ...;MergedContextConfiguration fooConfig, ...;MergedContextConfiguration barConfig, ...;MergedContextConfiguration bazConfig, ...;ConfigurableApplicationContext abcContext, ...;ConfigurableApplicationContext fooContext, ...;ConfigurableApplicationContext barContext, ...;ConfigurableApplicationContext bazContext, ...;DefaultContextCache cacheassertCacheContents(...)Map<MergedContextConfiguration,ApplicationContext> contextMapList<String> actualNamesnew Function<MergedContextConfiguration,Class<?>>(...) { ... }// Note: when a new entry is added it is considered the MRU entry and inserted at the tail.// Note: the MRU entry is moved to the tail when accessed./** Integration test which verifies correct interaction between the ... */MethodOrderer.OrderAnnotation.classMethodOrderer.OrderAnnotationAtomicInteger contextCount, ...;Integer count, ...;performAssertions(...)/** Unit tests which verify correct {@link ContextCache ... */ApplicationContext dirtiedApplicationContext, ...;SpringExtensionContextCacheTests.dirtiedApplicationContextimport Petimport PropertiesBasedSpringJUnit4ClassRunnerAppCtxTests/** Integration tests which verify that the same custom {@link ContextLoader} can ... */Pet dog, ...;String testString2, ...;this.dogthis.testString2GenericPropertiesContextLoader.classEmployee employee, ...;import BootstrapWithimport CustomTestContextBootstrapperCustomTestContextBootstrapper.classnew ContextCustomizerFactory(...) { ... }new ContextCustomizer(...) { ... }import Configimport SingleTestClassWithTwoLevelContextHierarchyTestsSingleTestClassWithTwoLevelContextHierarchyTests.ParentConfig.classSingleTestClassWithTwoLevelContextHierarchyTests.ParentConfigSingleTestClassWithTwoLevelContextHierarchyTests.ChildConfig.classSingleTestClassWithTwoLevelContextHierarchyTests.ChildConfigimport Sqlimport SqlConfigassertNumUsers(...)import EmptyDatabaseConfigEmptyDatabaseConfig.class/* no user beans required for these tests */WebApplicationContext wac, ...;String userHomeKey/** Integration tests for {@link TestPropertySource @TestPropertySource} ... *//** Integration tests that verify detection of a default properties file ... */assertEnvironmentValue(...)// from DefaultPropertiesFileDetectionTestPropertySourceTests.properties/** Collection of integration tests that verify proper support for ... */String CURRENT_TEST_PACKAGE, ...;ExplicitPropertiesFileTestPropertySourceTests.class/** Integration tests that verify detection of default properties files ... */verifyPropertiesAreAvailableInEnvironment(...)// from ExtendedDefaultPropertiesFileDetectionTestPropertySourceTests.properties/* all tests are in superclass *//** Integration tests for {@link TestPropertySource @TestPropertySource} support with ... */String explicit, ...;this.explicitimport static TestPropertySourceUtils.INLINED_PROPERTIES_PROPERTY_SOURCE_NAMEString[] expectedPropertyNamesEnumerablePropertySource<> eps// Simple key/value pairs// Values containing key/value delimiters (":", "=", " ")/** Integration tests that verify support for overriding properties from ... *//** Integration tests that verify support for contributing additional properties ... */SystemPropertyOverridePropertiesFileTestPropertySourceTests.classimport IncludeEngines/** Test suite for tests that involve {@link TestPropertySource @TestPropertySource}. ... *//** Abstract base class which declares an inlined property via ... *//** Abstract base class for integration tests involving ... *//** Integration tests for {@link TestPropertySource @TestPropertySource} as a ... */import Key1InlinedTestPropertyimport MetaFileTestProperty/** Composed annotation that declares a properties file via ... */import MetaMetaInlinedTestProperty/** Composed annotation that declares a property via ... *//** Composed annotation that declares a {@code meta} inlined property via ... *//** Same as {@link ExplicitPropertiesFilesRepeatedTestPropertySourceTests}, but ... */import ExplicitPropertiesFileInClasspathTestPropertySourceTestsimport CustomEventPublishingTestExecutionListener/** Integration tests for custom event publication via ... */CustomEventPublishingTestExecutionListener.classnew ArrayList<CustomEvent>(...)List<CustomEvent> events, ...;CustomEvent customEventgetTestName(...)new CustomEvent(...)import AsyncConfigurerSupportimport AfterTestClassimport AfterTestExecutionimport AfterTestMethodimport BeforeTestClassimport BeforeTestExecutionimport BeforeTestMethodimport PrepareTestInstanceimport static Mockito.only/** Integration tests for {@link EventPublishingTestExecutionListener} and ... */new ExampleTestCase(...)String THREAD_NAME_PREFIX, ...;TestExecutionListener listener, ...;// would never fire any events for ExampleTestCase.// publication of all test execution events. Otherwise, TestContext#publishEvent// loading of the test's ApplicationContext which consequently results in the// Note that the following invocation of getApplicationContext() forces eagerMethod traceableTestMethod, ...;only(...)/** The {@code @BeforeTestMethod} condition in ... */Method standardTest/** An exception thrown from an event listener executed in the current thread ... *//** An exception thrown from an event listener that is executed asynchronously ... */TrackingAsyncUncaughtExceptionHandler.asyncExceptionTestEventListenerConfiguration.classnew TrackingAsyncUncaughtExceptionHandler(...)/** The {@code @Async} test event listener method must reside in a separate ... */new AsyncTestEventComponent(...)listener(...)/** MUST be annotated with {@code @Component} due to a change in Spring 5.1 that ... */Throwable asyncException, ...;import static BDDMockito.willCallRealMethod/** Unit tests for {@link EventPublishingTestExecutionListener}. ... */new EventPublishingTestExecutionListener(...)EventPublishingTestExecutionListener listener, ...;ArgumentCaptor<Function<TestContext,? extends ApplicationEvent>> eventFactory, ...;willCallRealMethod(...)new Consumer<TestContext>(...) { ... }assertNoEvent(...)// Force Mockito to invoke the interface default method// Only allow events to be published for test methods named "publish*".// The listener attempted to publish the event...// The listener successfully published the event...// Verify the type of event that was published.// But the event was not actually published since the ApplicationContext// was not available.// In any case, we can still verify the type of event that would have// been published.Foo andy2, ...;Foo andy, ...;// verify the property values have been evaluated as expressions// verify the property keys have been evaluated as expressions/** Extension of {@link GroovySpringContextTests} that declares a Groovy ... *//* all tests are in the superclass *//** Integration test class that verifies proper detection of a default ... */Pet pet, ...;this.employeethis.pet// Config loaded from DefaultScriptDetectionGroovySpringContextTestsContext.groovy/** Simple integration test to verify the expected functionality of ... */Pet.classEmployee employeeEmployee.class/** Integration tests for loading an {@code ApplicationContext} from a ... */Long nonrequiredLong, ...;boolean beanInitialized, ...;this.beanInitializedthis.nonrequiredLong/** Integration test class that verifies proper support for mixing XML ... *//** Custom context hierarchy configuration annotation. ... */ProductionConfig.class/** Custom context hierarchy configuration annotation that is itself meta-annotated ... */ClassHierarchyWithMergedConfigLevelOneTests.AppConfig.classClassHierarchyWithMergedConfigLevelOneTests.AppConfigClassHierarchyWithMergedConfigLevelOneTests.UserConfig.classClassHierarchyWithMergedConfigLevelOneTests.UserConfigAppConfig appConfig, ...;String parent, ...;String beanFromUserConfig, ...;ClassHierarchyWithMergedConfigLevelTwoTests.OrderConfig.classClassHierarchyWithMergedConfigLevelTwoTests.OrderConfigClassHierarchyWithMergedConfigLevelOneTests.UserConfig userConfig, ...;user(...)String order, ...;loadContextHierarchy(...)ClassHierarchyWithOverriddenConfigLevelTwoTests.TestUserConfig.classClassHierarchyWithOverriddenConfigLevelTwoTests.TestUserConfigClassHierarchyWithMergedConfigLevelOneTests.AppConfig appConfig, ...;String beanFromTestUserConfig, ...;/** Integration tests that verify support for {@link DirtiesContext.HierarchyMode} ... */DirtiesContextWithContextHierarchyTests.ParentConfig.classDirtiesContextWithContextHierarchyTests.ParentConfigDirtiesContextWithContextHierarchyTests.ChildConfig.classDirtiesContextWithContextHierarchyTests.ChildConfigStringBuffer foo, ...;StringBuffer baz, ...;assertOriginalState(...)reverseStringBuffers(...)assertDirtyParentContext(...)assertDirtyChildContext(...)assertCleanChildContext(...)assertCleanParentContext(...)SingleTestClassWithTwoLevelContextHierarchyAndMixedConfigTypesTests.ParentConfig.classSingleTestClassWithTwoLevelContextHierarchyAndMixedConfigTypesTests.ParentConfigimport AppConfigimport WebConfigWebConfig.classWebApplicationContext rootServletContext childServletContextServletContext rootServletContextString ear, ...;String dispatcher, ...;ApplicationContext grandParentServletContext dispatcherServletContextList<String> actualUsersimport static ExecutionPhase.BEFORE_TEST_METHOD/** Integration tests that verify support for using {@link Sql @Sql} as a ... *//** Integration tests that verify support for custom SQL script syntax ... */import static TransactionAssert.assertThatTransaction/** Integration tests for {@link Sql @Sql} support with only a {@link DataSource} ... */isNotActive(...)assertThatTransaction(...)/** Integration tests that verify support for default SQL script detection. ... *//** Empty database configuration class for SQL script integration tests. ... *//** Modified copy of {@link CustomScriptSyntaxSqlScriptsTests} with ... *//** Integration tests for {@link Sql @Sql} that verify support for inferring ... */DataSource dataSource1, ...;DataSource dataSource2, ...;assertUsers(...)dataSource1(...)dataSource2(...)/** Exact copy of {@link InferredDataSourceSqlScriptsTests}, except that test ... *//** Transactional integration tests for {@link Sql @Sql} support when the ... */wrapDataSource(...)new DataSourceInvocationHandler(...)InfrastructureProxyTransactionalSqlScriptsTests.classimport AfterTransactionimport BeforeTransaction/** Transactional integration tests that verify commit semantics for ... */PopulatedSchemaDatabaseConfig.classimport static ErrorMode.CONTINUE_ON_ERRORimport static ErrorMode.FAIL_ON_ERRORimport static ErrorMode.IGNORE_FAILED_DROPSimport static TransactionMode.INFERREDimport static TransactionMode.ISOLATED/** Unit tests for {@link MergedSqlConfig}. ... */SqlConfig sqlConfigGlobalConfigClass.classSqlConfig localSqlConfigMergedSqlConfig cfgGlobalConfigWithWithEmptyCommentPrefixClass.classGlobalConfigWithWithEmptyCommentPrefixesClass.classGlobalConfigWithWithDuplicatedCommentPrefixesClass.classassertGlobalConfigWithDefaults(...)GlobalConfigWithDefaultsClass.classassertGlobalConfig(...)assertGlobalConfigWithLocalOverrides(...)assertGlobalConfigWithCommentPrefixAndLocalOverrides(...)GlobalConfigWithPrefixClass.classassertGlobalConfigWithCommentPrefixesAndLocalOverrides(...)GlobalConfigWithPrefixesClass.classGlobalConfigWithDefaultsClass.Nested.classGlobalConfigWithDefaultsClass.NestedGlobalConfigClass.Nested.classGlobalConfigClass.NestedGlobalConfigWithPrefixClass.Nested.classGlobalConfigWithPrefixClass.NestedGlobalConfigWithPrefixesClass.Nested.classGlobalConfigWithPrefixesClass.Nested/** Integration tests that verify support for using {@link Sql @Sql} and ... *//** Integration tests for {@link Sql @Sql} that verify support for multiple ... *//** Exact copy of {@link MultipleDataSourcesAndTransactionManagersSqlScriptsTests}, ... *//** Integration tests which verify that scripts executed via {@link Sql @Sql} ... *//** Database configuration class for SQL script integration tests with the 'user' ... *//** Transactional integration tests that verify rollback semantics for ... *//** Integration tests that ensure that <em>primary</em> data sources are ... *//** Subclass of {@link RepeatableSqlAnnotationSqlScriptsParentTests} which verifies ... */// Should not find Dilbert, since local @Sql declarations shadow @Sql// declarations on a superclass. This is due to the fact that we use// "get" semantics instead of "find" semantics when searching for @Sql./** This is a copy of {@link TransactionalSqlScriptsTests} that verifies proper ... */import BDDMockito/** Unit tests for {@link SqlScriptsTestExecutionListener}. ... */new SqlScriptsTestExecutionListener(...)SqlScriptsTestExecutionListener listener, ...;MissingValueAndScriptsAndStatementsAtClassLevel.classassertExceptionContains(...)MissingValueAndScriptsAndStatementsAtMethodLevel.classValueAndScriptsDeclared.classIsolatedWithoutTxMgr.classMissingDataSourceAndTxMgr.classimport static ExecutionPhase.AFTER_TEST_METHOD/** Transactional integration tests for {@link Sql @Sql} that verify proper ... */// Should throw a BadSqlGrammarException after test01, assuming 'drop-schema.sql' was executed// test## is required for @TestMethodOrder./** Transactional integration tests for {@link Sql @Sql} support with ... *//** Transactional integration tests for {@link Sql @Sql} support. ... */import AbstractTransactionalTestsimport SqlMergeMode/** Abstract base class for tests involving {@link SqlMergeMode @SqlMergeMode}. ... */import static MergeMode.MERGEimport static MergeMode.OVERRIDE/** Transactional integration tests that verify proper merging and overriding support ... *//** JUnit 4 based test suite for tests that involve the Spring TestContext ... */import DynamicTestimport TestFactoryimport EngineTestKitimport EventConditionsimport Eventsimport static Assertions.allOfimport static DynamicTest.dynamicTestimport static DiscoverySelectors.selectClassimport static EventConditions.containerimport static EventConditions.eventimport static EventConditions.finishedWithFailureimport static TestExecutionResultConditions.instanceOfimport static TestExecutionResultConditions.messageNonStaticAutowiredBeforeAllMethod.classNonStaticAutowiredAfterAllMethod.classStaticAutowiredBeforeAllMethod.classStaticAutowiredAfterAllMethod.classAutowiredBeforeEachMethod.classAutowiredAfterEachMethod.classAutowiredTestMethod.classAutowiredRepeatedTestMethod.classAutowiredParameterizedTestMethod.class/** Integration tests for {@link Autowired @Autowired} configuration errors in ... */String DISPLAY_NAME, ...;haveExactly(...)assertThatEvents(...)event(...)assertStatistics(...)testEventsFor(...)new Consumer<EventStatistics>(...) { ... }succeeded(...)started(...)testWithDisplayName(...)finishedWithFailure(...)/** A non-autowired test method should fail the same as an autowired test ... */AutowiredAndNonAutowiredTestMethods.classcontainerEventsFor(...)container(...)AutowiredTestFactoryMethod.classtestEvents(...)selectors(...)engine(...)selectClass(...)containerEvents(...)displayName(...)dynamicTest(...)import SpringJUnitJupiterTestSuite/** Integration tests which demonstrate the composability of annotations from ... */TestConfig.classPerson dilbert, ...;List<Person> people, ...;/** Tests for {@link DisabledIfCondition} that verify actual condition evaluation ... */new DisabledIfCondition(...)DisabledIfCondition condition, ...;ConditionEvaluationResult resultevaluateExecutionCondition(...)buildExtensionContext(...)isDisabled(...)getReason(...)assertExpressionIsBlank(...)SpringTestCase.classStore.classExtensionContext extensionContextExtensionContext.class/** Integration tests which verify support for {@link DisabledIf @DisabledIf} ... */String os/** Demo <em>composed annotation</em> for {@link DisabledIf @DisabledIf} that ... *//** Integration tests which verify support for {@link EnabledIf @EnabledIf} ... *//** Demo <em>composed annotation</em> for {@link EnabledIf @EnabledIf} that ... */import static EventConditions.testAlwaysFailingBeforeTestClassTestCase.classAlwaysFailingAfterTestClassTestCase.classAlwaysFailingPrepareTestInstanceTestCase.classAlwaysFailingBeforeTestMethodTestCase.classAlwaysFailingBeforeTestExecutionTestCase.classAlwaysFailingAfterTestExecutionTestCase.classAlwaysFailingAfterTestMethodTestCase.classFailingBeforeTransactionTestCase.classFailingAfterTransactionTestCase.class/** Integration tests which verify that '<i>before</i>' and '<i>after</i>' ... */Events eventsgetExpectedFailedCount(...)getExpectedSucceededCount(...)aborted(...)getExpectedStartedCount(...)skipped(...)AlwaysFailingBeforeTestClassTestExecutionListener.classAlwaysFailingAfterTestClassTestExecutionListener.classAlwaysFailingPrepareTestInstanceTestExecutionListener.classAlwaysFailingBeforeTestMethodTestExecutionListener.classAlwaysFailingBeforeTestExecutionTestExecutionListener.classAlwaysFailingAfterTestExecutionTestExecutionListener.classAlwaysFailingAfterTestMethodTestExecutionListener.classDatabaseConfig.class// Must not be private.// Ensure it was an AssertionError that failed the test and not// something else like an error in the @Configuration class, etc.import Tag/** Custom annotation for tagging "fake" test cases which are supposed to fail ... */import TestReporterimport Catimport Dog/** Integration tests which demonstrate that the Spring TestContext Framework can be used ... */new SpringExtension(...)SpringExtension springExtension, ...;Dog dog, ...;Cat cat, ...;List<Cat> cats, ...;Integer enigma, ...;this.dilbertthis.peoplethis.catthis.catsthis.enigma/** NOTE: Test code must be compiled with "-g" (debug symbols) or "-parameters" in ... */isNotPresent(...)/** Integration tests which demonstrate that the Spring TestContext Framework ... */new Function<Person,String>(...) { ... }Dog.classnew Function<Dog,String>(...) { ... }Cat.classnew Function<Cat,String>(...) { ... }/** Integration tests which demonstrate that the Spring TestContext Framework can ... *//** NOTE: Test code must be compiled with "-g" (debug symbols) or "-parameters" in order ... *//** Integration tests which demonstrate support for {@link Autowired @Autowired} ... *//** Integration tests which demonstrate support for autowiring individual ... */TestInfo testInfo, ...;this.testInfoimport TestTemplateimport TestTemplateInvocationContextimport TestTemplateInvocationContextProvider/** This class demonstrates how to have a JUnit Jupiter extension managed as a ... */TestTemplateInvocationContextProvider provider, ...;new StringInvocationContextProvider(...)List<String> parameters, ...;new Function<String,TestTemplateInvocationContext>(...) { ... }invocationContext(...)new TestTemplateInvocationContext(...) { ... }new ParameterResolver(...) { ... }/** Demo config for tests. ... */new Cat(...)import static AutowireMode.ALL/** Integration tests which demonstrate support for automatically ... */import ParameterResolutionExceptionimport static TestConstructor.TEST_CONSTRUCTOR_AUTOWIRE_MODE_PROPERTY_NAME/** Integration tests for {@link TestConstructor @TestConstructor} support. ... */setSpringProperty(...)AutomaticallyAutowiredTestCase.classParameterResolutionException.classconfigurationParameter(...)/** Demo class for tests. ... *//** Parameterized test class for integration tests that demonstrate support for ... */import TestConfigimport Character/** Interface for integration tests that demonstrate support for interface default ... */getExpectedNumCharacters(...)getExpectedName(...)new Function<C,String>(...) { ... }import ApplicationEventsHolder/** Default implementation of {@link PublishedEvents}. ... */List<T> events, ...;new SimpleTypedPublishedEvents<T>(...)getFilteredEvents(...)new Function<T,S>(...) { ... }new Function<T,Stream<? extends T>>(...) { ... }S mappedimport RecordApplicationEventsimport static Lifecycle.PER_METHOD/** Integration tests for {@link ApplicationEvents} in conjunction with JUnit Jupiter. ... */ApplicationEvents applicationEvents, ...;assertEventTypes(...)assertCustomEvents(...)assertTestExpectations(...)String testNameassertPayloads(...)boolean testAlreadyExecuted, ...;new Function<ApplicationEvent,String>(...) { ... }new ThrowingExtractor<String,String,RuntimeException>(...) { ... }CustomEvent.classnew ThrowingExtractor<CustomEvent,String,RuntimeException>(...) { ... }import Executionimport ExecutionModeTestInstancePerMethodTestCase.classTestInstancePerClassTestCase.class/** Integration tests that verify parallel execution support for {@link ApplicationEvents} ... */newKeySet(...)Set<String> payloads, ...;Set<String> testNamesSet<String> threadNamesint availableProcessorsLifecycle.PER_METHODExecutionMode.CONCURRENTApplicationEvents events, ...;String localPayload// Skip the following assertion entirely if too few processors are available// to the current JVM.// There are probably 10 different thread names on a developer's machine,// but we really just want to assert that at least two different threads// were used, since the CI server often has fewer threads available./** All Spring application events fired during the test execution. ... *//** Creates a new {@link PublishedEvents} instance for the given events. ... *//** Returns all application events of the given type that were fired during the test execution. ... *//** All application events of a given type that were fired during a test execution. ... *//** Further constrain the event type for downstream assertions. ... *//** Returns all {@link TypedPublishedEvents} that match the given predicate. ... *//** Returns all {@link TypedPublishedEvents} that match the given predicate ... */PublishedEvents.classnew DefaultPublishedEvents(...)import TestContextEvent/** Integration tests for the example {@link PublishedEvents} extension to the ... */PublishedEventsExtension.classTestContextEvent.classofSubType(...)/** Abstract base class for integration tests that demonstrate support for ... */T character, ...;List<T> characters, ...;this.characternew Function<T,String>(...) { ... }this.characters/** Integration tests that verify support for Java generics combined with {@code @Nested} ... */import NestedTestConfigurationimport Config1/** Integration tests that verify support for {@code @Nested} test classes using ... */List<String> localStrings, ...;this.localStrings// since INHERIT is now the global defaultimport TopLevelConfig/** Integration tests that verify support for {@code @Nested} test classes in conjunction ... */TopLevelConfig.classNestedConfig.classint answer, ...;this.answerString FOO, ...;String BAR, ...;String BAZ, ...;String localFoo, ...;this.localFoothis.bazTestInterfaceConfig.class// In contrast to nested test classes running in JUnit 4, the foo// field in the outer instance should have been injected from the// test ApplicationContext for the outer instance.// Since the configuration is inherited, the foo field in the outer instance// and the bar field in the inner instance should both have been injected// from the test ApplicationContext for the outer instance.ParentConfig.classString QUX, ...;Child1Config.classChild2Config.classString TEST_CONTAINER_PORT, ...;assertServiceHasInjectedValues(...)import PopulatedSchemaDatabaseConfigimport AbstractSqlMergeModeTests/** Integration tests that verify support for {@link Nested @Nested} test classes in ... */EnclosingConfiguration.OVERRIDEMergeMode.OVERRIDEimport static AutowireMode.ANNOTATEDimport FooTestExecutionListenerList<String> listeners, ...;QuxTestExecutionListener.classEnvironment env1, ...;Environment env2, ...;Environment env3, ...;Environment env4, ...;Environment env5, ...;import TestTransactionimport static Propagation.NOT_SUPPORTEDassertCommit(...)assertRollback(...)WebApplicationContext.classimport Launcherimport LauncherDiscoveryRequestimport LauncherFactoryimport SummaryGeneratingListenerimport static LauncherDiscoveryRequestBuilder.request/** Integration tests which verify that {@code @BeforeEach} and {@code @AfterEach} methods ... */int NUM_TESTS, ...;Launcher launcherSummaryGeneratingListener listenernew SummaryGeneratingListener(...)LauncherDiscoveryRequest requestgetTestsSucceededCount(...)getSummary(...)import FailingTestCaseimport Propagation/** JUnit Jupiter based integration tests which verify support for Spring's ... */Propagation.NOT_SUPPORTEDimport static Matchers.isimport static MediaType.APPLICATION_JSONimport static MockMvcRequestBuilders.getimport static MockMvcResultMatchers.contentimport static MockMvcResultMatchers.jsonPathimport static MockMvcResultMatchers.statusimport static MockMvcBuilders.webAppContextSetup/** Integration tests which demonstrate how to set up a {@link MockMvc} ... */isOk(...)status(...)andExpect(...)jsonPath(...)import GetMappingimport PathVariableimport RestControllerimport EnableWebMvcnew PersonController(...)/** Integration tests which demonstrate use of the Spring MVC Test Framework and ... *//** Extension of {@link SpringJUnit4ClassRunnerAppCtxTests}, which verifies that ... */SpringJUnit4ClassRunnerAppCtxTests.DEFAULT_CONTEXT_RESOURCE_PATH/* all tests are in the parent class. *//** Abstract base class for verifying support of Spring's {@link Transactional ... */String BOB, ...;String JANE, ...;String SUE, ...;String LUKE, ...;String LEIA, ...;String YODA, ...;import Ruleimport TestName/** JUnit 4 based integration test which verifies ... */new TestName(...)int numBeforeTransactionCalls, ...;int numAfterTransactionCalls, ...;boolean inTransaction, ...;TestName testName, ...;BeforeAndAfterTransactionAnnotationTests.numBeforeTransactionCallsBeforeAndAfterTransactionAnnotationTests.numAfterTransactionCallscountRowsInPersonTable(...)this.inTransactionclearPersonTable(...)addPerson(...)deletePerson(...)long expectedassertShouldBeInTransaction(...)boolean shouldBeInTransactionisInTransaction(...)ClassLevelDisabledSpringRunnerTests.CustomTestExecutionListener.classClassLevelDisabledSpringRunnerTests.CustomTestExecutionListener/** JUnit 4 based integration test which verifies support of Spring's ... */ClassPathResourceSpringJUnit4ClassRunnerAppCtxTests.CLASSPATH_CONTEXT_RESOURCE_PATHString CLASSPATH_CONTEXT_RESOURCE_PATH, ...;/** Classpath-based resource path for the application context configuration ... */import static TransactionSynchronizationManager.isActualTransactionActive/** Combined integration test for {@link AbstractJUnit4SpringContextTests} and ... */super.applicationContextsuper.jdbcTemplate/** JUnit 4 based integration test which verifies support of ... *//** Integration tests which verify that a subclass of {@link DefaultTestContextBootstrapper} ... */CustomDefaultContextLoaderClassSpringRunnerTests.PropertiesBasedTestContextBootstrapper.classCustomDefaultContextLoaderClassSpringRunnerTests.PropertiesBasedTestContextBootstrapperPet cat, ...;/** Integration test which verifies proper transactional behavior when the ... */EmbeddedPersonDatabaseTestsConfig.class/** Integration test which verifies proper transactional behavior when the default ... */int originalNumRows, ...;/** Shared configuration for tests that need an embedded database pre-loaded ... */import ProfileValueSourceimport ProfileValueSourceConfiguration/** Verifies proper handling of JUnit's {@link Ignore &#064;Ignore} and Spring's ... */int numTestsExecuted, ...;import JUnit4/** Verifies proper handling of JUnit's {@link Test#expected() &#064;Test(expected = ...)} ... */JUnit4.classExpectedExceptionSpringRunnerTestCase.class// Should Pass.import Runnerimport Parameterizedimport ParametersParameterized.classint expectedStartedCountint expectedFinishedCountgetRunnerClass(...)import AbstractTransactionalTestNGSpringContextTestsint expectedTestStartCount, ...;int expectedTestSuccessCount, ...;int expectedFailureCount, ...;int expectedFailedConfigurationsCount, ...;new Object[][]this.expectedTestStartCountthis.expectedTestSuccessCountthis.expectedFailureCountthis.expectedFailedConfigurationsCountlistener.failedConfigurationsCountHardCodedProfileValueSourceSpringRunnerTests.HardCodedProfileValueSource.classHardCodedProfileValueSourceSpringRunnerTests.HardCodedProfileValueSource// Set the system property to something other than VALUE as a sanity// check./** Extension of {@link SpringJUnit4ClassRunnerAppCtxTests} which verifies that ... */import ParallelComputerimport Computer/** Collection of utilities for testing the execution of JUnit 4 based tests. ... *//** Run the tests in the supplied {@code testClass}, using the {@link Runner} ... *//** Run the tests in the supplied {@code testClass}, using the specified ... */TrackingRunListener listenernew TrackingRunListener(...)Runner runnerRunNotifier notifiernew RunNotifier(...)JUnitCore junitgetTestStartedCount(...)getTestFailureCount(...)getTestFinishedCount(...)getTestIgnoredCount(...)getTestAssumptionFailureCount(...)/** Run all tests in the supplied test classes according to the policies of ... */MultipleResourcesSpringJUnit4ClassRunnerAppCtxTests.CLASSPATH_RESOURCE_PATHMultipleResourcesSpringJUnit4ClassRunnerAppCtxTests.LOCAL_RESOURCE_PATHMultipleResourcesSpringJUnit4ClassRunnerAppCtxTests.ABSOLUTE_RESOURCE_PATHString CLASSPATH_RESOURCE_PATH, ...;String LOCAL_RESOURCE_PATH, ...;String ABSOLUTE_RESOURCE_PATH, ...;/** JUnit 4 based integration test which verifies that ... *//** Simple JUnit 4 based integration test which demonstrates how to use JUnit's ... */ParameterizedDependencyInjectionTests.classAtomicInteger invocationCount, ...;String employeeBeanName, ...;String employeeName, ...;this.employeeBeanNamethis.employeeNameemployeeData(...).lengthemployeeData(...)// Verifying dependency injection:// Verifying 'parameterized' support:import Repeatimport Timed/** Verifies proper handling of the following in conjunction with the ... */int expectedStartedCount, ...;int expectedFinishedCount, ...;int expectedInvocationCount, ...;NonAnnotatedRepeatedTestCase.classDefaultRepeatValueRepeatedTestCase.classNegativeRepeatValueRepeatedTestCase.classRepeatedFiveTimesRepeatedTestCase.classRepeatedFiveTimesViaMetaAnnotationRepeatedTestCase.classTimedRepeatedTestCase.classthis.expectedStartedCountthis.expectedFinishedCountthis.expectedInvocationCountincrementInvocationCount(...)/** Unit tests for claims raised in <a href="https://jira.spring.io/browse/SPR-6011" target="_blank">SPR-6011</a>. *//** Extension of {@link DefaultRollbackFalseRollbackAnnotationTransactionalTests} ... *//** Extension of {@link DefaultRollbackTrueRollbackAnnotationTransactionalTests} ... *//** Verifies support for JUnit 4.7 {@link Rule Rules} in conjunction with the ... */TestName name, ...;/** SpringJUnit4ClassRunnerAppCtxTests serves as a <em>proof of concept</em> ... */String DEFAULT_CONTEXT_RESOURCE_PATH, ...;/** Default resource path for the application context configuration for ... */Pet autowiredPet, ...;Pet injectedPet, ...;String literalFieldValue, ...;Boolean spelFieldValue, ...;String literalParameterValue, ...;Boolean spelParameterValue, ...;String quux, ...;String namedQuux, ...;this.literalParameterValuethis.spelParameterValuethis.quuxthis.namedQuuxthis.autowiredPetthis.injectedPetthis.literalFieldValuethis.spelFieldValue/** Unit tests for {@link SpringJUnit4ClassRunner}. ... */SpringJUnit4ClassRunner runnernew SpringJUnit4ClassRunner(...) { ... }new TestContextManager(...) { ... }new SpringJUnit4ClassRunner(...)new FrameworkMethod(...)import Suiteimport SuiteClassesimport AnnotationConfigSpringJUnit4ClassRunnerAppCtxTestsimport BeanOverridingDefaultConfigClassesInheritedTestsimport BeanOverridingExplicitConfigClassesInheritedTestsimport DefaultConfigClassesBaseTestsimport DefaultConfigClassesInheritedTestsimport DefaultLoaderBeanOverridingDefaultConfigClassesInheritedTestsimport DefaultLoaderBeanOverridingExplicitConfigClassesInheritedTestsimport DefaultLoaderDefaultConfigClassesBaseTestsimport DefaultLoaderDefaultConfigClassesInheritedTestsimport DefaultLoaderExplicitConfigClassesBaseTestsimport DefaultLoaderExplicitConfigClassesInheritedTestsimport ExplicitConfigClassesBaseTestsimport ExplicitConfigClassesInheritedTestsimport HibernateSessionFlushingTestsimport DefaultProfileAnnotationConfigTestsimport DevProfileAnnotationConfigTestsimport DevProfileResolverAnnotationConfigTestsimport DefaultProfileXmlConfigTestsimport DevProfileResolverXmlConfigTestsimport DevProfileXmlConfigTests/** JUnit test suite for tests involving {@link SpringRunner} and the ... */Suite.classStandardJUnit4FeaturesTests.classStandardJUnit4FeaturesSpringRunnerTests.classSpringJUnit47ClassRunnerRuleTests.classAnnotationConfigSpringJUnit4ClassRunnerAppCtxTests.classDefaultConfigClassesBaseTests.classDefaultConfigClassesInheritedTests.classBeanOverridingDefaultConfigClassesInheritedTests.classExplicitConfigClassesBaseTests.classExplicitConfigClassesInheritedTests.classBeanOverridingExplicitConfigClassesInheritedTests.classDefaultLoaderDefaultConfigClassesBaseTests.classDefaultLoaderDefaultConfigClassesInheritedTests.classDefaultLoaderBeanOverridingDefaultConfigClassesInheritedTests.classDefaultLoaderExplicitConfigClassesBaseTests.classDefaultLoaderExplicitConfigClassesInheritedTests.classDefaultLoaderBeanOverridingExplicitConfigClassesInheritedTests.classDefaultProfileAnnotationConfigTests.classDevProfileAnnotationConfigTests.classDevProfileResolverAnnotationConfigTests.classDefaultProfileXmlConfigTests.classDevProfileXmlConfigTests.classDevProfileResolverXmlConfigTests.classExpectedExceptionSpringRunnerTests.classTimedSpringRunnerTests.classRepeatedSpringRunnerTests.classEnabledAndIgnoredSpringRunnerTests.classHardCodedProfileValueSourceSpringRunnerTests.classSpringJUnit4ClassRunnerAppCtxTests.classClassPathResourceSpringJUnit4ClassRunnerAppCtxTests.classAbsolutePathSpringJUnit4ClassRunnerAppCtxTests.classRelativePathSpringJUnit4ClassRunnerAppCtxTests.classMultipleResourcesSpringJUnit4ClassRunnerAppCtxTests.classInheritedConfigSpringJUnit4ClassRunnerAppCtxTests.classPropertiesBasedSpringJUnit4ClassRunnerAppCtxTests.classCustomDefaultContextLoaderClassSpringRunnerTests.classConcreteTransactionalJUnit4SpringContextTests.classClassLevelTransactionalSpringRunnerTests.classMethodLevelTransactionalSpringRunnerTests.classDefaultRollbackTrueRollbackAnnotationTransactionalTests.classDefaultRollbackFalseRollbackAnnotationTransactionalTests.classRollbackOverrideDefaultRollbackTrueTransactionalTests.classRollbackOverrideDefaultRollbackFalseTransactionalTests.classBeforeAndAfterTransactionAnnotationTests.classTimedTransactionalSpringRunnerTests.classHibernateSessionFlushingTests.class// Note: the following 'multi-line' layout is for enhanced code readability./* this test case consists entirely of tests loaded as a suite. *//* All tests are in the parent class... */import static Assume.assumeTrue/** Simple unit test to verify the expected functionality of standard JUnit 4.4+ ... */int staticBeforeCounter, ...;StandardJUnit4FeaturesTests.staticBeforeCounterint beforeCounter, ...;this.beforeCounter// Instead of testing for equality to 1, we just assert that the value// was incremented at least once, since this test class may serve as a// parent class to other tests in a suite, etc.TimedSpringRunnerTestCase.classgetTestCase(...)// Should Fail due to timeout.// Should Fail due to duplicate configuration.import Failureimport RunListener/** Simple {@link RunListener} which tracks how many times certain JUnit callback ... */AtomicInteger testFailureCount, ...;AtomicInteger testStartedCount, ...;AtomicInteger testFinishedCount, ...;AtomicInteger testAssumptionFailureCount, ...;AtomicInteger testIgnoredCount, ...;this.testFailureCountthis.testStartedCountthis.testFinishedCountthis.testAssumptionFailureCountthis.testIgnoredCountimport InitializerWithoutConfigFilesOrClassesTestsimport MergedInitializersAnnotationConfigTestsimport MultipleInitializersAnnotationConfigTestsimport OrderedInitializersAnnotationConfigTestsimport OverriddenInitializersAnnotationConfigTestsimport SingleInitializerAnnotationConfigTestsimport MultipleInitializersXmlConfigTests/** Convenience test suite for integration tests that verify support for ... */MultipleInitializersXmlConfigTests.classSingleInitializerAnnotationConfigTests.classMultipleInitializersAnnotationConfigTests.classMergedInitializersAnnotationConfigTests.classOverriddenInitializersAnnotationConfigTests.classOrderedInitializersAnnotationConfigTests.classInitializerWithoutConfigFilesOrClassesTests.classimport ComposedContextConfiguration/** Integration test that demonstrates how to register one or more {@code @Configuration} ... */BarConfig.classFooConfigInitializer.classimport SpringJUnit4ClassRunnerimport EntireAppInitializer/** Integration test that verifies support for {@link ApplicationContextInitializer ... */EntireAppInitializer.classGlobalConfig.classimport DevProfileInitializer/** Integration tests that verify support for {@link ApplicationContextInitializer ... */DevProfileInitializer.classimport FooBarAliasInitializerDevProfileConfig.classFooBarAliasInitializer.classimport ConfigOneimport ConfigTwoimport GlobalConfigimport OrderedOneInitializerimport OrderedTwoInitializer/** Integration tests that verify that any {@link ApplicationContextInitializer ... */ConfigTwo.classConfigOne.classOrderedTwoInitializer.classOrderedOneInitializer.classString PROFILE_GLOBAL, ...;String PROFILE_ONE, ...;String PROFILE_TWO, ...;// Note: the ordering of the config classes is intentionally: global, two, one.// Note: the ordering of the initializers is intentionally: two, one./** Integration tests that verify that a {@link PropertySource} can be set via a ... */PropertySourcesInitializerTests.PropertySourceInitializer.classPropertySourcesInitializerTests.PropertySourceInitializerString enigma, ...;// The following can also be used to directly access the// environment instead of relying on placeholder replacement.// @Value("#{ environment['enigma'] }")import SpringJUnit4ClassRunnerAppCtxTests/** Integration tests that verify support for configuration classes in ... */PojoAndStringConfig.class/** JUnit test suite for annotation-driven <em>configuration class</em> ... */BeanOverridingDefaultConfigClassesInheritedTests.ContextConfiguration.classBeanOverridingDefaultConfigClassesInheritedTests.ContextConfigurationnew Pet(...)import DelegatingSmartContextLoaderDefaultLoaderBeanOverridingDefaultConfigClassesInheritedTests.Config.classDefaultLoaderBeanOverridingDefaultConfigClassesInheritedTests.ConfigDefaultLoaderDefaultConfigClassesBaseTests.Config.classDefaultLoaderDefaultConfigClassesBaseTests.ConfigDefaultLoaderDefaultConfigClassesInheritedTests.Config.classDefaultLoaderDefaultConfigClassesInheritedTests.ConfigDefaultConfigClassesBaseTests.ContextConfiguration.classDefaultConfigClassesBaseTests.ContextConfigurationDefaultConfigClassesInheritedTests.ContextConfiguration.classDefaultConfigClassesInheritedTests.ContextConfiguration/** ApplicationContext configuration class for various integration tests. ... *//** Custom configuration annotation with meta-annotation attribute overrides for ... *//** Integration tests for meta-annotation attribute override support, relying on ... *//** Integration tests for meta-annotation attribute override support, overriding ... */LocalDevConfig.classDevResolver.class// Checking that the "test class" name ends with "*Tests" ensures that an actual// test class is passed to this method as opposed to a "*Config" class which would// imply that we likely have been passed the 'declaringClass' instead of the// 'rootDeclaringClass'./** Integration tests for meta-annotation attribute override support, demonstrating ... */import PojoAndStringConfigConfigClassesAndProfilesWithCustomDefaultsMetaConfig.ProductionConfig.classConfigClassesAndProfilesWithCustomDefaultsMetaConfig.ProductionConfig/** Custom configuration annotation that is itself meta-annotated with {@link ... */// Override default "dev" profile from// @ConfigClassesAndProfilesWithCustomDefaultsMetaConfig:/** Integration tests for meta-meta-annotation support, relying on default attribute ... */import TestGroupimport InheritedConfigSpringJUnit4ClassRunnerAppCtxTestsimport MethodLevelTransactionalSpringRunnerTestsimport SpringJUnit47ClassRunnerRuleTestsimport TimedTransactionalSpringRunnerTestsimport BaseAppCtxRuleTestsimport BasicAnnotationConfigWacSpringRuleTests/** Concurrency tests for the {@link SpringRunner}, {@link SpringClassRule}, and ... */BaseAppCtxRuleTests.classBasicAnnotationConfigWacSpringRuleTests.class...[] testClasses, ...;int FAILEDint ABORTEDint IGNOREDcountAnnotatedMethods(...)int TESTSnew ParallelComputer(...)this.testClassesnew Function<Method[],Stream<? extends Method>>(...) { ... }// Basics// Transactional// Web and Scopes// Spring MVC Test/** Integration tests for {@link ApplicationEvents} in conjunction with JUnit 4. ... */import AbstractGenericContextLoaderimport static AnnotationConfigContextLoaderUtils.detectDefaultConfigurationClasses/** Hybrid {@link SmartContextLoader} that supports path-based and class-based ... */// Detect default XML configuration files:// Detect default configuration classes:// Order doesn't matter: <bean> always wins over @Bean./** Integration tests for hybrid {@link SmartContextLoader} implementations that ... */HybridContextLoader.classString fooFromXml, ...;String fooFromJava, ...;// Note: the XML bean definition for "enigma" always wins since// ConfigurationClassBeanDefinitionReader.isOverriddenByExistingDefinition()// lets XML bean definitions override those "discovered" later via an// @Bean method.import HierarchicalContextRunner/** JUnit 4 based integration tests for <em>nested</em> test classes that are ... */HierarchicalContextRunner.class// Note: the following would fail since TestExecutionListeners in// the Spring TestContext Framework are not applied to the enclosing// instance of an inner test class.// assertEquals("foo", foo);import ClassRule/** Abstract base test class that preconfigures the {@link SpringClassRule} and ... */new SpringMethodRule(...)new SpringClassRule(...)SpringClassRule springClassRule, ...;SpringMethodRule springMethodRule, ...;import AbstractTransactionalJUnit4SpringContextTestsimport PersonService/** Transactional integration tests regarding <i>manual</i> session flushing with ... */String SAM, ...;PersonService personService, ...;Person samfindByName(...)DriversLicense driversLicensePerson juergenint numRowsConstraintViolationException.classupdateSamWithNullDriversLicense(...)// By setting setDefaultReadOnly(true), the user can no longer modify any entity...// no expected exception!// False positive, since an exception will be thrown once the session is// finally flushed (i.e., in production code)// Manual flush is required to avoid false positive in test// Wrapped in Hibernate 5.2, with the constraint violation as cause/** DriversLicense POJO. ... */Long number, ...;/** Person POJO. ... *//** Person Repository API. ... */import PersonRepository/** Hibernate implementation of the {@link PersonRepository} API. ... *//** Person Service API. ... *//** Standard implementation of the {@link PersonService} API. ... */PersonRepository personRepository, ...;this.personRepositoryDefaultProfileConfig.class/** JUnit test suite for <em>bean definition profile</em> support in the ... */ClassNameActiveProfilesResolver.class/** Integration tests for an issue raised in https://jira.spring.io/browse/SPR-15927. ... */AutowiredTestRule autowiredTestRule, ...;autowiredTestRule.appliednew AutowiredTestRule(...)boolean applied, ...;this.applied// Rationale for the following assertion:// The field value for the custom rule is null when JUnit sees it. JUnit then// ignores the null value, and at a later point in time Spring injects the rule// from the ApplicationContext and overrides the null field value. But that's too// late: JUnit never sees the rule supplied by Spring via dependency injection./** Base class for integration tests involving Spring {@code ApplicationContexts} ... */import BasicAnnotationConfigWacTests/** This class is an extension of {@link BasicAnnotationConfigWacTests} ... */// All tests are in superclass.import BeforeAndAfterTransactionAnnotationTests/** This class is an extension of {@link BeforeAndAfterTransactionAnnotationTests} ... */import ClassLevelDisabledSpringRunnerTests/** This class is an extension of {@link ClassLevelDisabledSpringRunnerTests} ... */import EnabledAndIgnoredSpringRunnerTests/** This class is an extension of {@link EnabledAndIgnoredSpringRunnerTests} ... */import FailingBeforeAndAfterMethodsSpringRunnerTests/** This class is an extension of {@link FailingBeforeAndAfterMethodsSpringRunnerTests} ... */AlwaysFailingBeforeTestClassSpringRuleTestCase.classAlwaysFailingAfterTestClassSpringRuleTestCase.classAlwaysFailingPrepareTestInstanceSpringRuleTestCase.classAlwaysFailingBeforeTestMethodSpringRuleTestCase.classAlwaysFailingAfterTestMethodSpringRuleTestCase.classFailingBeforeTransactionSpringRuleTestCase.classFailingAfterTransactionSpringRuleTestCase.class/** Integration test which demonstrates how to use JUnit's {@link Parameterized} ... *//** This class is a copy of ... */flagForRollback(...)flagForCommit(...)// Commit// Rollback (automatically)// Start new transaction with default rollback semantics// Rollback// Start new transaction with default commit semanticsimport RepeatedSpringRunnerTests/** This class is an extension of {@link RepeatedSpringRunnerTests} ... *//** Subclass #1 of {@link BaseAppCtxRuleTests}. ... *//** Subclass #2 of {@link BaseAppCtxRuleTests}. ... */import TimedSpringRunnerTests/** This class is an extension of {@link TimedSpringRunnerTests} ... */TimedSpringRuleTestCase.class/** Overridden to always throw an exception, since Spring's Rule-based ... */// All other tests are in superclass./** This class is an extension of {@link TimedTransactionalSpringRunnerTests} ... */Timeout timeout, ...;/** Overridden since Spring's Rule-based JUnit support cannot properly ... *//** {@code timeout} explicitly not declared due to presence of Timeout rule. */import FixMethodOrderimport MethodSorters/** This class is a JUnit 4 based copy of ... */MethodSorters.NAME_ASCENDING/** JUnit 4 based integration test for verifying support for the ... *//** JUnit 4 based test suite for functionality proposed in <a ... */DefaultLocationsBaseTests.classDefaultLocationsInheritedTests.classExplicitLocationsBaseTests.classExplicitLocationsInheritedTests.classBeanOverridingDefaultLocationsInheritedTests.classBeanOverridingExplicitLocationsInheritedTests.class/** Integration tests that investigate the applicability of JSR-250 lifecycle ... */Jsr250LifecycleTests.classnew LifecycleBean(...)LifecycleBean lifecycleBean, ...;LifecycleBean.class/** Integration tests to verify claims made in <a ... */String customFoo, ...;/** Test suite to investigate claims raised in ... */TestClass2.classTestClass3.classTestClass4.class/** This name of this class intentionally does not end with "Test" or "Tests" ... *//** This set of tests (i.e., all concrete subclasses) investigates the claims made in ... */DataSource dataSourceFromTxManager, ...;DataSource dataSourceViaInjection, ...;this.dataSourceFromTxManagerthis.dataSourceViaInjectionassertNumRowsInPersonTable(...)assertAddPerson(...)/** This set of tests refutes the claims made in ... */AnnotatedConfigClassesWithoutAtConfigurationTests.AnnotatedFactoryBeans.classAnnotatedConfigClassesWithoutAtConfigurationTests.AnnotatedFactoryBeans/** This is intentionally <b>not</b> annotated with {@code @Configuration}. ... */AtomicInteger enigmaCallCount, ...;enigma(...)// The following call to enigma() literally invokes the local// enigma() method, not a CGLIB proxied version, since these methods// are essentially factory bean methods./** Integration tests that verify proper scoping of beans created in ... */AtBeanLiteModeScopeTests.LiteBeans.classAtBeanLiteModeScopeTests.LiteBeans/** This is intentionally <b>not</b> annotated with {@code @Configuration}. */LifecycleBean injectedSingletonBean, ...;LifecycleBean injectedPrototypeBean, ...;LifecycleBean retrievedSingletonBeanLifecycleBean retrievedPrototypeBean/** Simple POJO that contains lifecycle callbacks. ... *//** Concrete implementation of {@link AbstractTransactionalAnnotatedConfigClassTests} ... *//** This is <b>intentionally</b> annotated with {@code @Configuration}. ... */// Ensure that this in-memory database is only used by this class:// NOTE: the two DataSource instances ARE the same!TransactionalAnnotatedConfigClassesWithoutAtConfigurationTests.AnnotatedFactoryBeans.classTransactionalAnnotatedConfigClassesWithoutAtConfigurationTests.AnnotatedFactoryBeans// @Configuration/** Since this method does not reside in a true {@code @Configuration class}, ... *//** Overrides {@code afterTransaction()} in order to assert a different result. ... */// NOTE: the two DataSource instances are NOT the same!// NOTE: We would actually expect that there are now ZERO entries in the// person table, since the transaction is rolled back by the framework;// however, since our JdbcTemplate and the transaction manager used by// the Spring TestContext Framework use two different DataSource// instances, our insert statements were executed in transactions that// are not controlled by the test framework. Consequently, there was no// rollback for the two insert statements in// modifyTestDataWithinTransaction()./** Integration tests used to assess claims raised in ... */// NOTE: if we omit the @WebAppConfiguration declaration, the ApplicationContext will fail// to load since @EnableWebMvc requires that the context be a WebApplicationContext./* intentionally no beans defined */// nothing to assert: we just want to make sure that the context loads without// errors./** Unit tests for {@link SpringFailOnTimeout}. ... */new Boom(...)Boom.classnew Answer<Void>(...) { ... }import BootstrapTestUtils/** Abstract base class for tests involving {@link ContextLoaderUtils}, ... */assertMergedConfig(...)// sense, but that's OK for unit testing purposes.// Combining @Configuration classes with a Properties based loader doesn't really makeBazConfig.classQuuxConfig.classimport static ActiveProfilesUtils.resolveActiveProfiles/** Unit tests for {@link ActiveProfilesUtils} involving resolution of active bean ... */assertResolvedProfiles(...)Enigma.classBareAnnotations.classEmptyProfiles.classDuplicatedProfiles.classExtendedDuplicatedProfiles.classLocationsFoo.classInheritedLocationsFoo.classInheritedClassesFoo.classLocationsBar.classAnimals.classMetaLocationsFoo.classMetaLocationsFooWithOverrides.classMetaLocationsFooWithOverriddenAttributes.classMetaLocationsBar.classMetaAnimals.classFooActiveProfilesResolverTestCase.classInheritedFooActiveProfilesResolverTestCase.classMergedInheritedFooActiveProfilesResolverTestCase.classOverriddenInheritedFooActiveProfilesResolverTestCase.classResolverAndProfilesTestCase.classResolverAndValueTestCase.classConflictingProfilesAndValueTestCase.classNoDefaultConstructorActiveProfilesResolverTestCase.classNullActiveProfilesResolverTestCase.class/** This test verifies that the actual test class, not the composed annotation, ... */Class<TestClassVerifyingActiveProfilesResolverTestCase> testClassTestClassVerifyingActiveProfilesResolverTestCase.class/** This test verifies that {@link DefaultActiveProfilesResolver} can be declared explicitly. ... */DefaultActiveProfilesResolverTestCase.class/** This test verifies that {@link DefaultActiveProfilesResolver} can be extended. ... */ExtendedDefaultActiveProfilesResolverTestCase.classTestClassVerifyingActiveProfilesResolver.classNullActiveProfilesResolver.classNoDefaultConstructorActiveProfilesResolver.classFooActiveProfilesResolver.classBarActiveProfilesResolver.classExtendedDefaultActiveProfilesResolver.classList<String> profiles/** Not an actual <em>test case</em>. ... *//** Unit tests for {@link AnnotationConfigContextLoader}. ... */AnnotationConfigContextLoader contextLoader, ...;Class<?>[] configClassesContextConfigurationInnerClassTestCase.classconfigClasses.lengthAnnotatedFooConfigInnerClassTestCase.classMultipleStaticConfigurationClassesTestCase.classPlainVanillaFooConfigInnerClassTestCase.classFinalConfigInnerClassTestCase.classPrivateConfigInnerClassTestCase.classNonStaticConfigInnerClassesTestCase.class/** Unit tests for {@link AnnotationConfigContextLoaderUtils}. ... */NoConfigTestCase.classExplicitConfigTestCase.classExplicitConfigTestCase.Config.classExplicitConfigTestCase.ConfigMetaAnnotatedConfigTestCase.classMetaAnnotatedConfigTestCase.Config.classMetaAnnotatedConfigTestCase.Config/** Unit tests for {@link BootstrapTestUtils} involving {@link ApplicationContextInitializer}s. ... */SingleInitializer.classInitializersFoo.classInitializersBar.classOverriddenInitializersBar.classOverriddenInitializersAndClassesBar.classimport AssertionsForClassTypesimport WebDelegatingSmartContextLoaderimport WebMergedContextConfiguration/** Unit tests for {@link BootstrapTestUtils} involving {@link MergedContextConfiguration}. ... */MissingContextAttributesTestCase.classbuildMergedConfigWithMetaAnnotationAndClasses(...)WorkingDog.classGermanShepherd.classClassesFoo.class/** Introduced to investigate claims made in a discussion on ... */Class<?> webTestClassWebClassesFoo.classClass<?> standardTestClassMergedContextConfiguration standardMergedConfigPropertiesLocationsFoo.classClass<? extends ContextLoader> expectedContextLoaderClassPropertiesClassesFoo.classString[] expectedLocationsClassesBar.classClass<?>[] expectedClassesOverriddenLocationsBar.classOverriddenClassesBar.classassertMergedConfigForLocationPaths(...)AbsoluteFooXmlLocationWithoutClasspathPrefix.classAbsoluteFooXmlLocationWithInnerRelativePathWithoutClasspathPrefix.classAbsoluteFooXmlLocationWithClasspathPrefix.classRelativeFooXmlLocation.classOuterTestCase.NestedTestCaseWithInheritedConfig.classOuterTestCase.NestedTestCaseWithInheritedConfigOuterTestCase.NestedTestCaseWithMergedInheritedConfig.classOuterTestCase.NestedTestCaseWithMergedInheritedConfigOuterTestCase.NestedTestCaseWithOverriddenConfig.classOuterTestCase.NestedTestCaseWithOverriddenConfigOuterTestCase.NestedTestCaseWithOverriddenConfig.DoubleNestedTestCaseWithInheritedOverriddenConfig.classOuterTestCase.NestedTestCaseWithOverriddenConfig.DoubleNestedTestCaseWithInheritedOverriddenConfigContextHierarchyOuterTestCase.classClass<?> enclosingTestClassContextHierarchyOuterTestCase.NestedTestCaseWithInheritedConfig.classContextHierarchyOuterTestCase.NestedTestCaseWithInheritedConfigContextHierarchyOuterTestCase.NestedTestCaseWithMergedInheritedConfig.classContextHierarchyOuterTestCase.NestedTestCaseWithMergedInheritedConfigContextHierarchyOuterTestCase.NestedTestCaseWithOverriddenConfig.classContextHierarchyOuterTestCase.NestedTestCaseWithOverriddenConfigcompareApplesToApples(...)AppleConfigTestCase.classDuplicateConfigAppleConfigTestCase.classSubDuplicateConfigAppleConfigTestCase.classcompareApplesToOranges(...)ApplesAndOrangesConfigTestCase.classDuplicateConfigApplesAndOrangesConfigTestCase.classSubDuplicateConfigApplesAndOrangesConfigTestCase.classAppleConfigTestCase.Nested.classAppleConfigTestCase.NestedAppleConfigTestCase.Nested.DoubleNested.classAppleConfigTestCase.Nested.DoubleNestedApplesAndOrangesConfigTestCase.Nested.classApplesAndOrangesConfigTestCase.NestedApplesAndOrangesConfigTestCase.Nested.DoubleNested.classApplesAndOrangesConfigTestCase.Nested.DoubleNestedMergedContextConfiguration parentMergedConfigMergedContextConfiguration childMergedConfigAppleConfig.classassertEmptyConfigsAreNotEqual(...)EmptyConfigTestCase.classSubEmptyConfigTestCase.classSubSubEmptyConfigTestCase.classMergedContextConfiguration grandchildMergedConfigEmptyConfigTestCase.Config.classEmptyConfigTestCase.ConfigSubEmptyConfigTestCase.Config.classSubEmptyConfigTestCase.ConfigSubSubEmptyConfigTestCase.Config.classSubSubEmptyConfigTestCase.ConfigClass<EmptyConfigTestCase> enclosingClassClass<Nested> nestedClassEmptyConfigTestCase.Nested.classEmptyConfigTestCase.NestedMergedContextConfiguration enclosingMergedConfigMergedContextConfiguration nestedMergedConfig// org.springframework.test.context.support --> 5 levels up to the root of the classpath// The following does not work -- at least not in Eclipse.// asssertThat(parent.getClasses())...// So we use AssertionsForClassTypes directly.// not equal because different defaults are detected for each class// inner classes cannot have static nested @Configuration classesimport static ContextLoaderUtils.resolveContextConfigurationAttributes/** Unit tests for {@link ContextLoaderUtils} involving {@link ContextConfigurationAttributes}. ... */assertAttributes(...)ConflictingLocations.classClass<BareAnnotations> testClassassertLocationsFooAttributes(...)Class<MetaLocationsFoo> testClassClass<MetaLocationsFooWithOverrides> testClassClass<MetaLocationsFooWithOverriddenAttributes> testClassClass<MetaLocationsBar> testClassassertClassesFooAttributes(...)assertLocationsBarAttributes(...)assertClassesBarAttributes(...)/** Verifies change requested in <a href="https://jira.spring.io/browse/SPR-11634">SPR-11634</a>. ... */LocationsAndClasses.classimport static ContextLoaderUtils.GENERATED_CONTEXT_HIERARCHY_LEVEL_PREFIXimport static ContextLoaderUtils.buildContextHierarchyMapimport static ContextLoaderUtils.resolveContextHierarchyAttributes/** Unit tests for {@link ContextLoaderUtils} involving context hierarchies. ... */SingleTestClassWithContextConfigurationAndContextHierarchy.classSingleTestClassWithContextConfigurationAndContextHierarchyOnSingleMetaAnnotation.classdebugConfigAttributes(...)SingleTestClassWithSingleLevelContextHierarchy.classClass<SingleTestClassWithSingleLevelContextHierarchyFromMetaAnnotation> testClassSingleTestClassWithSingleLevelContextHierarchyFromMetaAnnotation.classClass<SingleTestClassWithTripleLevelContextHierarchy> testClassSingleTestClassWithTripleLevelContextHierarchy.classTestClass3WithSingleLevelContextHierarchy.classList<ContextConfigurationAttributes> configAttributesListClassLevel1List<ContextConfigurationAttributes> configAttributesListClassLevel2List<ContextConfigurationAttributes> configAttributesListClassLevel3TestClass3WithSingleLevelContextHierarchyFromMetaAnnotation.classTestClass1WithSingleLevelContextHierarchyFromMetaAnnotation.classTestClass2WithSingleLevelContextHierarchyFromMetaAnnotation.classassertOneTwo(...)TestClass2WithBareContextConfigurationInSuperclass.classTestClass2WithBareContextConfigurationInSubclass.classTestClass2WithBareMetaContextConfigWithOverridesInSuperclass.classTestClass2WithBareMetaContextConfigWithOverridesInSubclass.classTestClass3WithMultiLevelContextHierarchy.classList<ContextConfigurationAttributes> alphaConfigList<ContextConfigurationAttributes> betaConfigList<ContextConfigurationAttributes> gammaConfigcontainsKeys(...)TestClass3WithMultiLevelContextHierarchyAndUnnamedConfig.classString level1String level2String level3String level4String level5String level6String level7List<ContextConfigurationAttributes> level1ConfigList<ContextConfigurationAttributes> level2ConfigList<ContextConfigurationAttributes> level3ConfigList<ContextConfigurationAttributes> level7ConfigTestClass2WithMultiLevelContextHierarchyAndPartiallyNamedConfig.classIterator<String> levelsassertContextConfigEntriesAreNotUnique(...)SingleTestClassWithMultiLevelContextHierarchyWithEmptyContextConfig.classSingleTestClassWithMultiLevelContextHierarchyWithDuplicatedContextConfig.class/** Used to reproduce bug reported in https://jira.spring.io/browse/SPR-10997 */TestClass2WithMultiLevelContextHierarchyWithOverriddenInitializers.classgetInitializers(...).lengthDummyApplicationContextInitializer.class// for (ContextConfigurationAttributes configAttributes : configAttributesList) {// System.err.println(configAttributes);// duplicate!/** Unit test which verifies that extensions of ... */String expectedContentsnew GenericXmlContextLoader(...) { ... }/** Unit tests for {@link DelegatingSmartContextLoader}. ... */new DelegatingSmartContextLoader(...)DelegatingSmartContextLoader loader, ...;// --- SmartContextLoader - processContextConfiguration() ------------------XmlTestCase.classConfigClassTestCase.classImproperDuplicateDefaultXmlAndConfigClassTestCase.class// --- SmartContextLoader - loadContext() ----------------------------------assertApplicationContextLoadsAndContainsFooString(...)ConfigClassTestCase.Config.classConfigClassTestCase.Config// --- ContextLoader -------------------------------------------------------// intentionally empty: we just need the class to be present to fail// the testimport static HierarchyMode.CURRENT_LEVELimport static HierarchyMode.EXHAUSTIVE/** Unit tests for {@link DirtiesContextBeforeModesTestExecutionListener}. ... */new DirtiesContextBeforeModesTestExecutionListener(...)new DirtiesContextTestExecutionListener(...)TestExecutionListener beforeListener, ...;TestExecutionListener afterListener, ...;HierarchyMode.classassertBeforeMethod(...)DirtiesContextDeclaredLocallyBeforeEachTestMethod.classassertAfterMethod(...)DirtiesContextDeclaredLocallyAfterEachTestMethod.classDirtiesContextDeclaredViaMetaAnnotationAfterEachTestMethod.classDirtiesContextDeclaredLocallyBeforeClass.classDirtiesContextDeclaredLocallyAfterClass.classDirtiesContextDeclaredViaMetaAnnotationAfterClass.classDirtiesContextViaMetaAnnotationWithOverrides.classassertBeforeClass(...)assertAfterClass(...)DirtiesContextViaMetaAnnotationWithOverridenAttributes.classBeforeAndAfterTestMethodTopLevelClass.classBeforeAndAfterTestMethodTopLevelClass.ConfigOverriddenByDefault.classBeforeAndAfterTestMethodTopLevelClass.ConfigOverriddenByDefaultBeforeAndAfterTestMethodTopLevelClass.InheritedConfig.classBeforeAndAfterTestMethodTopLevelClass.InheritedConfigBeforeAndAfterTestMethodTopLevelClass.OverriddenConfig.classBeforeAndAfterTestMethodTopLevelClass.OverriddenConfigBeforeAndAfterTestMethodTopLevelClass.OverriddenConfig.InheritedConfigButOverridden.classBeforeAndAfterTestMethodTopLevelClass.OverriddenConfig.InheritedConfigButOverriddenBeforeAndAfterTestClassTopLevelClass.classBeforeAndAfterTestClassTopLevelClass.ConfigOverriddenByDefault.classBeforeAndAfterTestClassTopLevelClass.ConfigOverriddenByDefaultBeforeAndAfterTestClassTopLevelClass.InheritedConfig.classBeforeAndAfterTestClassTopLevelClass.InheritedConfigBeforeAndAfterTestClassTopLevelClass.OverriddenConfig.classBeforeAndAfterTestClassTopLevelClass.OverriddenConfigBeforeAndAfterTestClassTopLevelClass.OverriddenConfig.InheritedConfigButOverridden.classBeforeAndAfterTestClassTopLevelClass.OverriddenConfig.InheritedConfigButOverridden/** Tests for {@link DynamicPropertiesContextCustomizerFactory}. ... */new DynamicPropertiesContextCustomizerFactory(...)DynamicPropertiesContextCustomizerFactory factory, ...;List<ContextConfigurationAttributes> configAttributes, ...;DynamicPropertiesContextCustomizer customizerNoDynamicPropertySource.classthis.configAttributesSingleDynamicPropertySource.classMultipleDynamicPropertySources.classSubDynamicPropertySource.class/** Tests for {@link DynamicPropertiesContextCustomizer}. ... */customizerFor(...)MergedContextConfiguration.classDynamicPropertiesContextCustomizer c1DynamicPropertiesContextCustomizer c2DynamicPropertiesContextCustomizer c3DynamicPropertySourceTestCase.class/** Unit tests for {@link DynamicValuesPropertySource}. ... */new HashMap<String,Supplier<Object>>(...) { ... }DynamicValuesPropertySource source, ...;// Intentionally FINAL./** Unit tests for {@link GenericPropertiesContextLoader}. ... */GenericPropertiesContextLoader loadernew GenericPropertiesContextLoader(...)/** Unit test which verifies proper ... */GenericXmlContextLoaderResourceLocationsTests.classContextConfiguration contextConfigString[] configuredLocationsClasspathNonExistentDefaultLocationsTestCase.classClasspathExistentDefaultLocationsTestCase.classImplicitClasspathLocationsTestCase.classExplicitClasspathLocationsTestCase.classExplicitFileLocationsTestCase.classExplicitUrlLocationsTestCase.classExplicitMixedPathTypesLocationsTestCase.class/** Unit tests for {@link GenericXmlContextLoader}. ... */GenericXmlContextLoader loader// Intentionally not static// Intentionally NOT annotated with @Configuration// Intentionally private/** Unit tests for {@link TestConstructorUtils}. ... */assertNotAutowirable(...)NotAutowirableTestCase.classassertAutowirable(...)AutowiredAnnotationTestCase.classTestConstructorAnnotationTestCase.classTestConstructorAsMetaAnnotationTestCase.classTestConstructorAnnotationOverridesGlobalFlagTestCase.class// precedence.// The following declaration simply verifies that @Autowired on the constructor takesimport SoftAssertionsimport static TestPropertySourceUtils.addInlinedPropertiesToEnvironmentimport static TestPropertySourceUtils.addPropertiesFilesToEnvironmentimport static TestPropertySourceUtils.buildMergedTestPropertySourcesimport static TestPropertySourceUtils.convertInlinedPropertiesToMap/** Unit tests for {@link TestPropertySourceUtils}. ... */...[] KEY_VALUE_PAIR, ...;...[] FOO_LOCATIONS, ...;EmptyPropertySources.classExtendedEmptyPropertySources.classRepeatedPropertySourcesWithConflictingInheritLocationsFlags.classRepeatedPropertySourcesWithConflictingInheritPropertiesFlags.classassertMergedTestPropertySources(...)ValuePropertySources.classLocationsAndValuePropertySources.classLocationsAndPropertiesPropertySources.classInheritedPropertySources.classLocallyDuplicatedLocationsAndProperties.classDuplicatedLocationsAndPropertiesPropertySources.classLocationsAndPropertiesPropertySources.Nested.classLocationsAndPropertiesPropertySources.NestedExtendedPropertySources.classOverriddenLocationsPropertySources.classOverriddenPropertiesPropertySources.classOverriddenLocationsAndPropertiesPropertySources.classMockPropertySource.MOCK_PROPERTIES_PROPERTY_SOURCE_NAMEMergedTestPropertySources mergedPropertySources/** Integration tests that verify support for ... */int NUM_TX_TESTS, ...;int numSetUpCalls, ...;int numSetUpCallsInTransaction, ...;int numTearDownCalls, ...;int numTearDownCallsInTransaction, ...;/** Combined integration test for {@link AbstractTestNGSpringContextTests} and ... */Employee employeeBeanperformCommonAssertions(...)this.dirtiedApplicationContext/** Timed integration tests for ... */// TODO Enable TestNG test with timeout once we have a solution.import ITestContextimport ITestListener/** Simple {@link ITestListener} which tracks how many times certain TestNG ... */int testStartCount, ...;int testSuccessCount, ...;int testFailureCount, ...;int failedConfigurationsCount, ...;this.failedConfigurationsCountgetFailedConfigurations(...)this.testStartCountthis.testSuccessCount/** Integration tests for {@link ApplicationEvents} in conjunction with TestNG. ... */import TestEntityDao/** Abstract base class for all TestNG-based tests involving EJB transaction ... */String TEST_NAME, ...;TestEntityDao dao, ...;incrementCount(...)/** The default implementation of this method assumes that the transaction ... */import RequiredEjbTxTestEntityDao/** Concrete subclass of {@link AbstractEjbTxDaoTestNGTests} which uses the ... *//* test methods in superclass */import RequiresNewEjbTxTestEntityDao/** Extension of {@link CommitForRequiredEjbTxDaoTestNGTests} which sets the default ... *//** Overrides parent implementation in order to change expectations to align with ... */// Expecting count=0 after test2IncrementCount1() since REQUIRED transactions// participate in the existing transaction (if present), which in this case is the// transaction managed by the TestContext framework which will be rolled back// after each test method./** Extension of {@link CommitForRequiresNewEjbTxDaoTestNGTests} which sets the default ... *//** This class is a copy of the JUnit-based ... *//** TestNG-based integration tests for {@link ServletTestExecutionListener}. ... */MockHttpServletRequest servletRequest, ...;/** Verifies bug fix for <a href="https://jira.spring.io/browse/SPR-11626">SPR-11626</a>. ... */assertInjectedServletRequestEqualsRequestInRequestContextHolder(...)/* no beans required for this test */import ServletContextAware/** TestNG-based integration tests that verify support for loading a ... */MockServletContext mockServletContext, ...;Object rootWacgetCanonicalPath(...)import SimpleTransactionStatusimport static Propagation.REQUIRED/** Unit tests for {@link TransactionalTestExecutionListener}. ... */new TransactionalTestExecutionListener(...) { ... }PlatformTransactionManager tm, ...;TransactionalTestExecutionListener listener, ...;TransactionalTestExecutionListener listenerClass<? extends Invocable> clazzTransactionalDeclaredOnClassLocallyTestCase.classInvocable instanceinvoked(...)assertBeforeTestMethodWithTransactionalTestMethod(...)TransactionalDeclaredOnClassViaMetaAnnotationTestCase.classTransactionalDeclaredOnClassViaMetaAnnotationWithOverrideTestCase.classTransactionalDeclaredOnMethodViaMetaAnnotationWithOverrideTestCase.classassertBeforeTestMethodWithNonTransactionalTestMethod(...)assertBeforeTestMethod(...)TransactionalDeclaredOnMethodLocallyTestCase.classTransactionalDeclaredOnMethodViaMetaAnnotationTestCase.classBeforeTransactionDeclaredLocallyTestCase.classBeforeTransactionDeclaredViaMetaAnnotationTestCase.classassertAfterTestMethod(...)AfterTransactionDeclaredLocallyTestCase.classAfterTransactionDeclaredViaMetaAnnotationTestCase.classBeforeTransactionDeclaredAsInterfaceDefaultMethodTestCase.classAfterTransactionDeclaredAsInterfaceDefaultMethodTestCase.classassertIsRollback(...)MissingRollbackTestCase.classEmptyMethodLevelRollbackTestCase.classMethodLevelRollbackWithExplicitValueTestCase.classMethodLevelRollbackViaMetaAnnotationTestCase.classEmptyClassLevelRollbackTestCase.classClassLevelRollbackWithExplicitValueTestCase.classClassLevelRollbackViaMetaAnnotationTestCase.classClassLevelRollbackWithExplicitValueOnTestInterfaceTestCase.classClassLevelRollbackViaMetaAnnotationOnTestInterfaceTestCase.classassertAfterTestMethodWithTransactionalTestMethod(...)assertAfterTestMethodWithNonTransactionalTestMethod(...)new SimpleTransactionStatus(...)// SPR-13895// Note: not actually invoked within a transaction since the test class is// annotated with @MetaTxWithOverride(propagation = NOT_SUPPORTED)// Note: not actually invoked within a transaction since the method is/** Abstract base class for all tests involving EJB transaction support in the ... *//** Concrete subclass of {@link AbstractEjbTxDaoTests} which uses the ... *//** Extension of {@link CommitForRequiredEjbTxDaoTests} which sets the default ... *//** Extension of {@link CommitForRequiresNewEjbTxDaoTests} which sets the default ... *//** Abstract base class for EJB implementations of {@link TestEntityDao} which ... */TestEntity tegetTestEntity(...)setCount(...)import Statelessimport TransactionAttributeType/** EJB implementation of {@link TestEntityDao} which declares transaction ... */TestEntityDao.classTransactionAttributeType.MANDATORYgetCountInternal(...)TransactionAttributeType.REQUIREDincrementCountInternal(...)TransactionAttributeType.REQUIRES_NEW/** Test DAO for EJB transaction support in the TestContext framework. ... */import Column/** Test entity for EJB transaction support in the TestContext framework. ... */TestEntity.TABLE_NAMEString TABLE_NAME, ...;/** Integration tests that verify the behavior requested in ... */CallCountingTransactionManager transactionManager, ...;CallCountingTransactionManager txManager2, ...;transactionManager.beguntransactionManager.inflighttransactionManager.commitstransactionManager.rollbackstxManager2.inflightCallCountingTransactionManager txManager1, ...;txManager1.inflightCallCountingTransactionManager txManager, ...;txManager.inflight/** Integration test that verifies the behavior for transaction manager lookups ... */CallCountingTransactionManager primary, ...;CallCountingTransactionManager annotationDriven, ...;primary.begunprimary.inflightprimary.commitsprimary.rollbacksannotationDriven.begunannotationDriven.inflightannotationDriven.commitsannotationDriven.rollbacksConfig config, ...;CallCountingTransactionManager annotationDrivenconfig.annotationDriven/** Integration tests that ensure that <em>primary</em> transaction managers ... *//* Intentionally FINAL */// SPR-17137: should not break trying to proxy the final test class/** JUnit-based integration tests that verify support for programmatic transaction ... */Propagation.NEVER/** Unit tests for {@link AnnotationConfigWebContextLoader}. ... */AnnotationConfigWebContextLoader loaderWebMergedContextConfiguration mergedConfignew ServletContextAwareBean(...)ServletContextAwareBean servletContextAwareBean, ...;servletContextAwareBean.servletContext// Config loaded from BasicGroovyWacTestsContext.groovy/** Unit tests for {@link GenericXmlWebContextLoader}. ... */GenericXmlWebContextLoader loaderimport AbstractJUnit4SpringContextTests/** JUnit-based integration tests that verify support for loading a ... *//** Integration test that verifies meta-annotation support for {@link WebAppConfiguration} ... *//** Integration tests that verify support for request and session scoped beans ... *//** Introduced to investigate claims in SPR-11145. ... */BasicAnnotationConfigWacTests.class/** JUnit-based integration tests for {@link ServletTestExecutionListener}. ... */import static ServletTestExecutionListener.POPULATED_REQUEST_CONTEXT_HOLDER_ATTRIBUTEimport static ServletTestExecutionListener.RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE/** Unit tests for {@link ServletTestExecutionListener}. ... */new ServletTestExecutionListener(...)String SET_UP_OUTSIDE_OF_STEL, ...;ServletTestExecutionListener listener, ...;assertSetUpOutsideOfStelAttributeExists(...)LegacyWebTestCase.classassertRequestAttributesDoNotExist(...)AtWebAppConfigWebTestCase.classassertWebAppConfigTestCase(...)assertRequestAttributesExist(...)NoAtWebAppConfigWebTestCase.classServletTestExecutionListener.ACTIVATE_LISTENERRequestAttributes requestAttributesObject setUpOutsideOfStelRequestAttributes.SCOPE_REQUESTassertSetUpOutsideOfStelAttributeDoesNotExist(...)import CustomWebTestContextBootstrapperCustomWebTestContextBootstrapper.class/** Custom {@link WebTestContextBootstrapper} that requires {@code @WebAppConfiguration} ... */// from: src/test/webapp/resources/Spring.js/** Custom <em>composed annotation</em> combining {@link WebAppConfiguration} and ... */import EnableWebSocketimport ServletServerContainerFactoryBean/** Integration tests that validate support for {@link ServletServerContainerFactoryBean} ... */getDefaultMaxTextMessageBufferSize(...)ServletServerContainerFactoryBean containernew ServletServerContainerFactoryBean(...)setMaxTextMessageBufferSize(...)/** Unit tests for {@link JdbcTestUtils}. ... */int deleted/** Collection of assertions for tests involving transactions. Intended for ... */new TransactionAssert(...)TransactionAssert instance, ...;import static AopTestUtils.getTargetObjectimport static AopTestUtils.getUltimateTargetObject/** Unit tests for {@link AopTestUtils}. ... */FooImpl foo, ...;jdkProxy(...)cglibProxy(...)import static Is.is/** Unit tests for {@link JsonPathExpectationsHelper}. ... */String SIMPSONS, ...;// SPR-16339// SPR-14498import static MetaAnnotationUtils.findAnnotationDescriptorimport static MetaAnnotationUtils.findAnnotationDescriptorForTypes/** Unit tests for {@link MetaAnnotationUtils}. ... */getComposedAnnotationType(...)Class<MetaMetaAnnotatedClass> startClassMetaMeta.classClass<MetaMetaMetaAnnotatedClass> startClassMetaMetaMeta.classClass<HasMetaComponentAnnotation> startClassMetaAnnotationUtilsTests.classClass<InterfaceWithMetaAnnotation> startClassClass<ClassWithLocalMetaAnnotationAndMetaAnnotatedInterface> startClass/** Unit tests for {@link MetaAnnotationUtils} that verify support for overridden ... */Class<MetaValueConfigTestCase> declaringClassClass<MetaLocationsConfigTestCase> declaringClass// direct access to annotation value:// overridden attribute:// NOTE: we would like to be able to override the 'value' attribute; however,// Spring currently does not allow overrides for the 'value' attribute.// See SPR-11393 for related discussions.// direct access to annotation attributes:// overridden attributes:import LegacyEntityimport PersonEntityimport StaticFieldsimport StaticMethodsimport static ReflectionTestUtils.getFieldimport static ReflectionTestUtils.invokeGetterMethodimport static ReflectionTestUtils.invokeMethodimport static ReflectionTestUtils.invokeSetterMethodimport static ReflectionTestUtils.setField/** Unit tests for {@link ReflectionTestUtils}. ... */new PersonEntity(...)new Component(...)new LegacyEntity(...)Float PI, ...;Component component, ...;LegacyEntity entity, ...;assertSetFieldAndGetFieldBehavior(...)Person proxyassertSetFieldAndGetFieldBehaviorForProxy(...)getEyeColor(...)likesPets(...)getFavoriteNumber(...)StaticFields.classStaticFields.publicFieldgetPrivateField(...)StaticFields staticFieldsnew StaticFields(...)invokeGetterMethod(...)Integer differenceInteger sumObject collaboratorString testCollaboratorgetPublicMethodValue(...)StaticMethods.classgetPrivateMethodValue(...)// Set reflectively// Get reflectively// Get directly// Get directly from Target// Fields must be non-null to start with// Set to null// IntelliJ IDEA 11 won't accept int assignment here// Simulate autowiring a configuration method// Simulate @PostConstruct life-cycle event// assertions in init() should succeed// Simulate @PreDestroy life-cycle event// SPR-14363// SPR-9571 and SPR-14363/** Unit tests for {@link XmlExpectationsHelper}. ... */String controlString testXmlExpectationsHelper xmlHelper/** Simple POJO representing a <em>component</em>; intended for use in ... */int product/** A <em>legacy entity</em> whose {@link #toString()} method has side effects; ... */new LegacyEntityException(...)Object collaborator, ...;/** Exception thrown by a {@link LegacyEntity}. ... *//** Abstract base class for <em>persistent entities</em>; intended for use in ... */long id, ...;/* Copyright 2007-2016 the original author or authors. ... *//** Interface representing a <em>person</em> entity; intended for use in unit tests. ... *//** Concrete subclass of {@link PersistentEntity} representing a <em>person</em> ... */String eyeColor, ...;boolean likesPets, ...;Number favoriteNumber, ...;this.eyeColorthis.likesPetsthis.favoriteNumber/** Simple class with static fields; intended for use in unit tests. ... */String privateField, ...;/** Simple class with static methods; intended for use in unit tests. ... */String publicMethodValue, ...;String privateMethodValue, ...;double someDouble, ...;boolean someBoolean, ...;this.someDoublePerson otherPersonotherPerson.nameotherPerson.someDoubleotherPerson.someBooleanimport static HttpMethod.GETimport static HttpMethod.POSTimport static ExpectedCount.onceimport static ExpectedCount.twiceimport static MockRestRequestMatchers.methodimport static MockRestRequestMatchers.requestToimport static MockRestResponseCreators.withSuccess/** Unit tests for {@link DefaultRequestExpectation}. ... */createRequest(...)twice(...)andRespond(...)withSuccess(...)new MockAsyncClientHttpRequest(...)import MockRestServiceServerBuilder/** Unit tests for {@link MockRestServiceServer}. ... */new RestTemplate(...)MockRestServiceServerBuilder buildergetForObject(...)ignoreExpectOrder(...)postForEntity(...)getForEntity(...)MockRestServiceServer server1MockRestServiceServer server2// gh-24486// SPR-16132// gh-21799import static ExpectedCount.maximport static ExpectedCount.minimport static ExpectedCount.times/** Unit tests for {@link SimpleRequestExpectationManager}. ... */SimpleRequestExpectationManager manager, ...;// SPR-15672// SPR-15719/** Unit tests for {@link UnorderedRequestExpectationManager}. ... */UnorderedRequestExpectationManager manager, ...;import static Matchers.hasXPath/** Unit tests for {@link ContentRequestMatchers}. ... */MockClientHttpRequest request, ...;MediaType.APPLICATION_ATOM_XMLstring(...)bytes(...)formDataContains(...)hasXPath(...)import static Matchers.equalTo/** Unit tests for {@link JsonPathRequestMatchers}. ... */String REQUEST_CONTENT, ...;equalTo(...)isBoolean(...)isNumber(...)isString(...)import static Matchers.containsString/** Unit tests for {@link MockRestRequestMatchers}. ... */setURI(...)requestToUriTemplate(...)containsString(...)headerDoesNotExist(...)// SPR-15819MultiValueMap<String,Object> input, ...;MultiValueMap<String,Object> expected, ...;this.inputwriteAndAssertContains(...)writeAndAssert(...)MultipartFile f1MultipartFile f2MultipartFile f3MockMultipartFile fooMockMultipartFile barwriteForm(...)Map<String,Object> expectedMapmultipartDataContains(...)new HttpOutputMessage(...) { ... }MultipartRequestMatchersTests.this.requestMultipartRequestMatchersTests.thisimport Matchers/** Unit tests for {@link XpathRequestMatchers}. ... */String RESPONSE_CONTENT, ...;notNullValue(...)nodeCount(...)number(...)import SocketTimeoutException/** Tests for the {@link MockRestResponseCreators} static factory methods. ... */copyToByteArray(...).lengthDefaultResponseCreator responseCreatorURI locationwithCreatedEntity(...)withNoContent(...)withBadRequest(...)withUnauthorizedRequest(...)withServerError(...)withStatus(...)withException(...)new SocketTimeoutException(...)SocketTimeoutException.classimport ResponseEntityimport MockMvcClientHttpRequestFactoryimport RequestMappingimport RequestMethodimport ResponseBodyimport WebMvcConfigurer/** Tests that use a {@link RestTemplate} configured with a ... */this.wacRestTemplate templatenew MockMvcClientHttpRequestFactory(...)AsyncRestTemplate templatenew AsyncRestTemplate(...)ListenableFuture<ResponseEntity<String>> entityMockMvcClientHttpRequestFactoryTests.classimport static ExpectedCount.manyTimes/** Examples to demonstrate writing client-side REST tests with Spring MVC Test. ... */createServer(...)AsyncRestTemplate restTemplate, ...;MockRestServiceServer mockServer, ...;String responseBodyListenableFuture<ResponseEntity<Person>> ludwigthis.mockServermanyTimes(...)Resource responseBodyListenableFuture<ResponseEntity<String>> result// We are only validating the request. The response is mocked out.// person.getName().equals("Ludwig van Beethoven")// person.getDouble().equals(1.6035)// hotel.getId() == 42// hotel.getName().equals("Holiday Inn")// result == "1"// result == "2"import HttpRequestimport ClientHttpRequestExecutionimport ClientHttpRequestInterceptorimport static ExpectedCount.neverPerson ludwigString result1String result2RestTemplate restTemplateMockRestServiceServer mockServerbufferContent(...)new ContentInterceptor(...)// result1 == "1"// SPR-14694// enable repeated reads of response bodyimport StringHttpMessageConverterimport MappingJackson2HttpMessageConverterimport static Matchers.startsWithimport static MockRestRequestMatchers.content/** Examples of defining expectations on request content and content type. ... */List<HttpMessageConverter<?>> convertersnew StringHttpMessageConverter(...)new MappingJackson2HttpMessageConverter(...)executeAndVerify(...)import static MockRestRequestMatchers.header/** Examples of defining expectations on request headers. ... */String RESPONSE_BODY, ...;import static Matchers.endsWithimport static Matchers.hasItemimport static Matchers.inimport static MockRestRequestMatchers.jsonPath/** Examples of defining expectations on JSON request content with ... */new LinkedMultiValueMap<String,Person>(...)MultiValueMap<String,Person> people, ...;in(...)hasItem(...)String composerNameString performerNameimport XmlElementWrapperimport Jaxb2RootElementHttpMessageConverter/** Examples of defining expectations on XML request content with XMLUnit. ... */String PEOPLE_XML, ...;PeopleWrapper people, ...;List<Person> composerssetSomeDouble(...)Double.NaNnew PeopleWrapper(...)new Jaxb2RootElementHttpMessageConverter(...)List<Person> composers, ...;this.composersimport static Matchers.closeToimport static Matchers.notNullValueimport static MockRestRequestMatchers.xpath/** Examples of defining expectations on XML request content with XPath expressions. ... */Map<String,String> NS, ...;List<Person> performerssetSomeBoolean(...)String composerString performerString composerDoublecloseTo(...)String performerBooleanValueList<Person> performers, ...;this.performers// Hamcrest..import MockWebSessionimport EnableWebFluximport ServerResponse/** Unit tests with {@link ApplicationContextSpec}. ... */ApplicationContextSpec specWebTestClient testClientexpectBody(...)expectStatus(...)GET(...)new HandlerFunction<ServerResponse>(...) { ... }session(...)new Function<WebSession,Mono<? extends ServerResponse>>(...) { ... }ok(...)MockWebSession sessionnew MockWebSession(...)// SPR-17094/** Unit tests for {@link CookieAssertions} ... */sameSite(...)ofMinutes(...)cookieAssertions(...)ResponseCookie cookie, ...;CookieAssertions assertions, ...;valueEquals(...)MockClientHttpRequest requestWebTestClient.ResponseSpec.classimport ControllerAdviceimport ExceptionHandler/** Unit tests for {@link DefaultControllerSpec}. ... */new MyController(...)isBadRequest(...)controllerAdvice(...)new MyControllerAdvice(...)MyControllerAdvice.classMyController.classTestConsumer<ArgumentResolverConfigurer> argumentResolverConsumernew TestConsumer<ArgumentResolverConfigurer>(...)TestConsumer<RequestedContentTypeResolverBuilder> contenTypeResolverConsumernew TestConsumer<RequestedContentTypeResolverBuilder>(...)TestConsumer<CorsRegistry> corsRegistryConsumernew TestConsumer<CorsRegistry>(...)TestConsumer<FormatterRegistry> formatterConsumernew TestConsumer<FormatterRegistry>(...)TestConsumer<ServerCodecConfigurer> codecsConsumernew TestConsumer<ServerCodecConfigurer>(...)TestConsumer<PathMatchConfigurer> pathMatchingConsumernew TestConsumer<PathMatchConfigurer>(...)TestConsumer<ViewResolverRegistry> viewResolverConsumernew TestConsumer<ViewResolverRegistry>(...)viewResolvers(...)pathMatching(...)httpMessageCodecs(...)formatters(...)corsMappings(...)contentTypeResolver(...)argumentResolvers(...)consumeWith(...)new Consumer<EntityExchangeResult<String>>(...) { ... }getUriTemplate(...)// gh-25854/** Unit tests for {@link DefaultRouterFunctionSpec}. ... */RouterFunction<ServerResponse> routerFunctionexpectHeader(...)handlerStrategies(...)webFilter(...)new WebFilter(...) { ... }new WebExceptionHandler(...) { ... }setStatusCode(...)import static Matchers.hasItems/** Unit tests for {@link HeaderAssertions}. ... */HeaderAssertions assertionsheaderAssertions(...)valueMatches(...)valuesMatch(...)hasItems(...)MediaType.TEXT_XMLCacheControl controlnoTransform(...)setCacheControl(...)cacheControl(...)noStore(...)expires(...)ZonedDateTime lastModifiedsetLastModified(...)// Success// Missing header// Wrong value// Wrong # of values// Too few values// Wrong pattern// Header should not exist// Existing header// MediaTypes not compatibleimport ReactiveHttpOutputMessage/** Unit tests for {@link HttpHandlerConnector}. ... */TestHttpHandler handlernew TestHttpHandler(...)new Function<ServerHttpResponse,Mono<Void>>(...) { ... }getSavedRequest(...)blockFirst(...)isInNonBlockingThread(...)ServerHttpRequest savedRequest, ...;Function<ServerHttpResponse,Mono<Void>> responseMonoFunction, ...;this.responseMonoFunctionthis.savedRequest// gh-23936import WebFilterChain/** Unit tests for {@link AbstractMockServerSpec}. ... */new TestMockServerSpec(...)TestMockServerSpec serverSpec, ...;this.serverSpecnew TestWebFilter(...)new MockServerConfigurer(...) { ... }new WebHandler(...) { ... }DefaultDataBufferFactory factorygetAttributeOrDefault(...)/** Test scenarios involving a mock server. ... */WebTestClient clientbindToWebHandler(...)new Consumer<WebSession>(...) { ... }new Function<WebSession,String>(...) { ... }new Function<String,Mono<? extends Void>>(...) { ... }EntityExchangeResult<Void> resultResponseCookie sessionWebTestClient client1WebTestClient client2Builder mutatedBuilderWebTestClient clientFromMutatedBuildernew ExchangeFilterFunction(...) { ... }defaultHeader(...)defaultCookie(...)new Consumer<List<ExchangeFilterFunction>>(...) { ... }defaultHeaders(...)defaultCookies(...)ServerHttpResponse responseFluxExchangeResult<String> resultgetResponseBodyContent(...)// SPR-15674 (in comments)// Set the session attribute// Now get attribute// SPR-16059// SPR-16124// Get the raw content without consuming the response body flux..import static Matchers.greaterThan/** Unit tests for {@link StatusAssertions}. ... */StatusAssertions assertionsstatusAssertions(...)reasonEquals(...)is1xxInformational(...)is2xxSuccessful(...)is5xxServerError(...)is3xxRedirection(...)is4xxClientError(...)greaterThan(...)// Wrong status// Wrong status value// gh-23630// Wrong reason// Wrong seriesimport static Duration.ofMillis/** Unit tests for {@link WiretapConnector}. ... */new ClientHttpConnector(...) { ... }ClientRequest clientRequestWiretapConnector wiretapConnectorExchangeFunction functionimport EntityExchangeResultimport PostMappingimport RequestBody/** Tests with error status codes or error conditions. ... */bindToController(...)WebTestClient client, ...;isNotFound(...)getRequestBodyContent(...)// SPR-17363import MockServerConfigurerimport WebTestClientConfigurer/** Samples tests that demonstrate applying ServerWebExchange initialization. ... */WebTestClient webTestClient, ...;this.webTestClientmutateWith(...)new IdentityConfigurer(...)IdentityFilter filter, ...;new IdentityFilter(...)new Predicate<WebFilter>(...) { ... }Mono<Principal> userMono, ...;this.userMonoimport CookieValueimport RequestHeader/** Tests with headers and cookies. ... */new ResponseEntity<Void>(...)/** Samples of tests using {@link WebTestClient} with serialized JSON content. ... */isCreated(...)created(...)import JsonCreatorimport JsonProperty// No-arg constructor for XMLimport FluxExchangeResultimport static MediaType.TEXT_EVENT_STREAM/** Annotated controllers accepting and returning typed Objects. ... */baseUrl(...)new Consumer<EntityExchangeResult<Person>>(...) { ... }List<Person> expectedexpectBodyList(...)new Consumer<List<Person>>(...) { ... }Map<String,Person> mapnew LinkedHashMap<String,Person>(...)new ParameterizedTypeReference<Map<String,Person>>(...) { ... }FluxExchangeResult<Person> resultnew Consumer<Person>(...) { ... }new Function<Long,Person>(...) { ... }/** Samples of tests using {@link WebTestClient} with XML content. ... */String persons_XML, ...;new ArrayList<Person>(...)List<Person> persons, ...;this.personsMediaType.APPLICATION_XML_VALUEnew PersonsWrapper(...)/** Sample tests demonstrating "mock" server tests binding to server infrastructure ... */bindToApplicationContext(...)/** Sample tests demonstrating "mock" server tests binding to an annotated ... */import ReactorHttpServerimport static RequestPredicates.GETimport static RouterFunctions.route/** Sample tests demonstrating live server integration tests. ... */ReactorHttpServer server, ...;HttpHandler httpHandlertoHttpHandler(...)new ReactorHttpServer(...)/** Sample tests demonstrating "mock" server tests binding to a RouterFunction. ... */WebTestClient testClient, ...;RouterFunction<?> routethis.testClientbindToRouterFunction(...)/** Tests for a {@link WebFilter}. ... */WebFilter filter/** Test fixture for {@link DefaultMvcResult}. ... */DefaultMvcResult mvcResult, ...;import static Matchers.nullValueimport static MockMvcResultMatchers.request/** Integration tests that verify that {@link MockMvc} can be reused multiple ... */String HELLO, ...;String ENIGMA, ...;MockMvc mvc, ...;this.mvcsessionAttribute(...)/** A stub implementation of the {@link MvcResult} contract. ... */ModelAndView mav, ...;FlashMap flashMap, ...;this.mavthis.flashMap/** Abstract base class for testing {@link WebRequestMatcher} implementations. ... */new WebRequest(...)import HttpWebConnectionimport Page/** Unit and integration tests for {@link DelegatingWebConnection}. ... */DelegatingWebConnection webConnection, ...;WebRequest request, ...;WebResponse expectedResponse, ...;WebRequestMatcher matcher1, ...;WebRequestMatcher matcher2, ...;WebConnection connection1, ...;WebConnection connection2, ...;WebResponseData dataWebResponse responseWebClient webClientMockMvcWebConnection mockConnectionWebRequestMatcher cdnMatchernew UrlRegexRequestMatcher(...)WebConnection httpConnectionnew HttpWebConnection(...)Page pagegetWebResponse(...)/** Unit tests for {@link HostRequestMatcher}. ... */assertMatches(...)assertDoesNotMatch(...)import IOUtilsimport UsernamePasswordCredentials/** Unit tests for {@link HtmlUnitRequestBuilder}. ... */HtmlUnitRequestBuilder requestBuilder, ...;setHttpMethod(...)// --- constructor// --- buildRequestString base64CredentialsString authzHeaderValueUsernamePasswordCredentials credentialsnew UsernamePasswordCredentials(...)MockHttpServletRequest actualRequestsetCredentials(...)setAdditionalHeader(...)getAuthType(...)setCharset(...)setRequestBody(...)setEncodingType(...)FormEncodingType.URL_ENCODEDgetLocalAddr(...)getLocalPort(...)HttpMethod expectedMethodString actualMethodsetRequestParameters(...)new KeyDataPair(...)MimeType.TEXT_PLAINgetParts(...)// SPR-14177getServletPath(...)String expectedQueryString expectedBodygetRemoteAddr(...)getRemotePort(...)getRequestedSessionId(...)HttpSession newSessionassertSingleSessionCookie(...)HttpSession sessionToRemoveremoveAdditionalHeader(...)// --- setContextPathString expectedContextPathnew HelloController(...)String paramValueString paramValue2MockHttpServletRequest performedRequestrequestAttr(...)String pathInfoCookie jsessionidCookie// SPR-14916// gh-24926// verify it is going to work with Spring Security's AntPathRequestMatcher// SPR-14584/** Integration tests for {@link MockMvcWebConnectionBuilderSupport}. ... */WebClient.classWebClient client, ...;MockMvcWebConnectionBuilderSupport<> builder, ...;WebConnection.classnew MockMvcWebConnectionBuilderSupport<>(...) { ... }WebConnection connassertMockMvcUsed(...)assertMockMvcNotUsed(...)useMockMvcForHosts(...)alwaysUseMockMvc(...)import DeleteMappingimport RequestParam/** Integration tests for {@link MockMvcWebClientBuilder}. ... */mockMvcSetup(...)WebClient clientWebClient otherClientnew CookieController(...)postResponse(...)deleteResponse(...)String COOKIE_NAME, ...;// SPR-14066// SPR-14265import FailingHttpStatusCodeException/** Integration tests for {@link MockMvcWebConnection}. ... */new ForwardController(...)FailingHttpStatusCodeException.classnew Consumer<FailingHttpStatusCodeException>(...) { ... }// Empty context path (root context) should not match to a URL with a context path// No context is the same providing an empty context path/** Tests for {@link MockWebResponseBuilder}. ... */MockWebResponseBuilder responseBuilder, ...;this.responseBuilder// --- buildWebResponse webResponsegetContentCharset(...)NameValuePair header// SPR-14169getStatusMessage(...)getWebRequest(...)/** Unit tests for {@link UrlRegexRequestMatcher}. ... *//** Integration tests for {@link MockMvcHtmlUnitDriverBuilder}. ... */String EXPECTED_BODY, ...;WebConnectionHtmlUnitDriver otherDriverisJavascriptEnabled(...)javascriptEnabled(...)getPageSource(...)import WebDriverException/** Unit tests for {@link WebConnectionHtmlUnitDriver}. ... */WebConnectionHtmlUnitDriver driver, ...;WebConnection connection, ...;WebRequest.classWebDriverException.class/** Unit tests for building a {@link MockHttpServletRequest} with ... */MockHttpServletRequestBuilder builder, ...;pathInfo(...)testContextPathServletPathInvalid(...)Map<String,String[]> parameterMapMultiValueMap<String,String> queryParamsList<String> acceptList<MediaType> resultparseMediaTypes(...)MediaType.TEXT_HTMLList<String> contentTypesMediaType.TEXT_HTML_VALUEList<String> headersHttpHeaders httpHeaderslocale(...)characterEncoding(...)sessionAttrs(...)retrieveAndUpdate(...)User usergetUserPrincipal(...)String ATTRString EXPECTEDMockHttpServletRequestBuilder defaultBuilderURI urlfromPath(...)attr(...)new RequestAttributePostProcessor(...)String attr, ...;this.attr// SPR-13435// gh-24556// SPR-16453// SPR-11043// SPR-13801// gh-2079// SPR-11308// SPR-12945// SPR-13719/** Unit tests for {@link MockMultipartHttpServletRequestBuilder}. ... */MockMultipartHttpServletRequest mockRequestfile(...)new ThrowingExtractor<Part,String,RuntimeException>(...) { ... }MockPart jsonPartMockHttpServletRequestBuilder parentMockMultipartHttpServletRequestBuilder builderMockMultipartHttpServletRequestBuilder.class// gh-26166// gh-26261, gh-26400import StubMvcResultgetStubMvcResult(...)MediaType.APPLICATION_JSON_VALUEencoding(...)String UTF8_CONTENT, ...;new StubMvcResult(...)// gh-23622attributeExists(...)StubMvcResult mvcResult/** Unit tests for {@link HeaderResultMatchers}. ... */HeaderResultMatchers matchers, ...;long epochMillidateValue(...)// SPR-17330/** Unit tests for {@link JsonPathResultMatchers}. ... */StubMvcResult stubMvcResult, ...;String jsonPrefixStubMvcResult resultcreatePrefixedStubMvcResult(...)// SPR-16587import static MockMvcResultMatchers.forwardedUrlimport static MockMvcResultMatchers.forwardedUrlPatternimport static MockMvcResultMatchers.forwardedUrlTemplateimport static MockMvcResultMatchers.redirectedUrlimport static MockMvcResultMatchers.redirectedUrlPatternimport static MockMvcResultMatchers.redirectedUrlTemplate/** Unit tests for {@link MockMvcResultMatchers}. ... */redirectedUrlStub(...)forwardedUrlStub(...)redirectedUrlTemplate(...)redirectedUrlPattern(...)forwardedUrlPattern(...)forwardedUrlTemplate(...)/** Unit tests for {@link ModelResultMatchers}. ... */ModelResultMatchers matchers, ...;MvcResult mvcResultWithError, ...;new ModelAndView(...)BindingResult bindingResultWithErrorModelAndView mavWithErrorthis.mvcResultWithErrorattributeDoesNotExist(...)hasNoErrors(...)attributeHasErrors(...)attributeErrorCount(...)attributeHasNoErrors(...)attributeHasFieldErrors(...)attributeHasFieldErrorCode(...)/** Unit tests for {@link PrintingResultHandler}. ... */new TestPrintingResultHandler(...)new MockHttpServletRequest(...) { ... }TestPrintingResultHandler handler, ...;StubMvcResult mvcResult, ...;HttpSession.classCookie enigmaCookieList<String> cookieValuesString headingMap<String,Map<String,Object>> printedValuesgetPrinter(...).printedValuesString[] cookiesString cookie1String cookie2Cookie.classBindException bindExceptionsetMav(...)DispatcherServlet.classnew TestResultValuePrinter(...)String printedHeading, ...;Map<String,Map<String,Object>> printedValues, ...;this.printedHeadingthis.printedValues// Manually validate cookie values since maxAge changes.../** Tests for {@link StatusResultMatchers}. ... */StatusResultMatchers matchers, ...;List<AssertionError> failuresnew ArrayList<AssertionError>(...)getMethodForHttpStatus(...)StatusResultMatchers.class/** Tests for {@link XpathResultMatchers}. ... */nodeList(...)import MockMvcWebTestClient/** {@link MockMvcWebTestClient} equivalent of the MockMvc ... */AsyncControllerJavaConfigTests.WebConfig.classAsyncControllerJavaConfigTests.WebConfigCallableProcessingInterceptor callableInterceptor, ...;beforeConcurrentHandling(...)this.callableInterceptorregisterCallableInterceptors(...)callableInterceptor(...)CallableProcessingInterceptor.classnew AsyncController(...)new Callable<Map<String,String>>(...) { ... }import PersonControllerimport PersonDaoimport DefaultServletHandlerConfigurerimport ResourceHandlerRegistryimport ViewControllerRegistryimport TilesConfigurerJavaConfigTests.RootConfig.classJavaConfigTests.RootConfigJavaConfigTests.WebConfig.classJavaConfigTests.WebConfigPersonDao personDao, ...;this.personDaoPersonDao.classRootConfig rootConfig, ...;personDao(...)this.rootConfigaddResourceLocations(...)addResourceHandler(...)setViewName(...)addViewController(...)enable(...)tiles(...)TilesConfigurer configurernew TilesConfigurer(...)setDefinitions(...)import DefaultServletHttpRequestHandlerimport static MockMvcResultMatchers.handler// TilesConfigurer: resources under "/WEB-INF/**/tiles.xml"// Resources served via <mvc:resources/>// Forwarded to the "default" servlet via <mvc:default-servlet-handler/>resultActionsFor(...)handlerType(...)handler(...)DefaultServletHttpRequestHandler.classimport ResponseStatusimport StreamingResponseBodynew Callable<Person>(...) { ... }new StreamingResponseBody(...) { ... }DeferredResult<Person> resultnew DeferredResult<Person>(...)setErrorResult(...)ListenableFutureTask<Person> futureTasknew ListenableFutureTask<Person>(...)CompletableFuture<Person> futurenew CompletableFuture<Person>(...)import RestControllerAdvicenew GlobalExceptionHandler(...)new RestPersonControllerExceptionHandler(...)new RestPersonController(...)new RestGlobalExceptionHandler(...)RestGlobalExceptionHandler.classRestPersonControllerExceptionHandler.classdispatcherServletCustomizer(...)setThrowExceptionIfNoHandlerFound(...)RestPersonController.classString error, ...;import HttpServletRequestWrapperimport ShallowEtagHeaderFilterimport RedirectAttributesimport static MockMvcResultMatchers.flashimport static MockMvcResultMatchers.modelnew ContinueFilter(...)EntityExchangeResult<Void> exchangeResultisFound(...)attributeCount(...)model(...)flash(...)new RedirectFilter(...)new WrappingRequestResponseFilter(...)WrappingRequestResponseFilter.PRINCIPAL_NAMEnew ShallowEtagHeaderFilter(...)addFlashAttribute(...)String PRINCIPAL_NAME, ...;new HttpServletRequestWrapper(...) { ... }new HttpServletResponseWrapper(...)// Like Spring Security does in HttpServlet3RequestFactory..new AsyncContextWrapper(...)AsyncContext delegate, ...;hasOriginalRequestAndResponse(...)createListener(...)// Further assertions on the server responseimport MockMvcConfigurerAdapterdefaultSetup(...)new SampleController(...)new TestMockMvcConfigurer(...)/** Test {@code MockMvcConfigurer}. */import MultipartBodyBuilderimport Modelimport RequestPartnew MultipartController(...)byte[] fileContentMap<String,String> jsonMultipartBodyBuilder bodyBuildernew MultipartBodyBuilder(...)new RequestWrappingFilter(...)file.lengthnew HttpServletRequestWrapper(...)Flux<String> bodyFluxMediaType.TEXT_EVENT_STREAM_VALUEandDo(...)/** MockMvcTestClient equivalent of the MockMvc ... */import FixedContentNegotiationStrategyimport HeaderContentNegotiationStrategyimport ContentNegotiatingViewResolverimport MappingJackson2JsonViewimport MarshallingViewimport static Matchers.hasPropertysingleView(...)new MappingJackson2JsonView(...)new MarshallingView(...)List<View> viewListnew ArrayList<View>(...)ContentNegotiationManager managernew ContentNegotiationManager(...)new HeaderContentNegotiationStrategy(...)new FixedContentNegotiationStrategy(...)ContentNegotiatingViewResolver cnViewResolvernew ContentNegotiatingViewResolver(...)setDefaultViews(...)hasProperty(...)// InternalResourceViewResolver// Comment out class-level @Disabled to see the output.// Not intended to be executed with the build.EntityExchangeResult<String> result// Hamcrest matchers...// "Hello world! (Japanese)import CookieLocaleResolverimport LocaleChangeInterceptorCookieLocaleResolver.DEFAULT_COOKIE_NAMECookieLocaleResolver localeResolvernew CookieLocaleResolver(...)setCookieDomain(...)setCookieHttpOnly(...)localeResolver(...)new LocaleChangeInterceptor(...)expectCookie(...)performRequest(...)import static Matchers.notimport static MvcUriComponentsBuilder.onSimpleController.classmethodCall(...)MvcUriComponentsBuilder.MethodInvocationInfo.classMvcUriComponentsBuilder.MethodInvocationInfomethodName(...)import static HttpHeaders.IF_MODIFIED_SINCEimport static HttpHeaders.VARYString ERROR_MESSAGE, ...;String now, ...;String minuteAgo, ...;long currentTime, ...;SimpleDateFormat dateFormat, ...;PersonController controllerthis.nowthis.currentTimethis.minuteAgosetStubTimestamp(...)valueEqualsDate(...)isNotModified(...)AssertionError errlong secondLaterassertIncorrectResponseHeader(...)new Consumer<ResponseSpec>(...) { ... }ResponseSpec specassertMessageContains(...)// Comparison by date uses HttpHeaders to format the date in the error message.HttpHeaders.ACCEPTnew MusicController(...)String composerByNameString performerByNameMultiValueMap<String,Person> mapimport ModelAttributeimport static Matchers.allOfnew ModelAttributeAdvice(...)...[] values, ...;// Hamcrest...import HandlerMapping/** MockMvcWebTestClient equivalent of the MockMvc ... */WebTestClient mainServletClient, ...;HandlerMapping.BEST_MATCHING_PATTERN_ATTRIBUTEHandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTEString producibleMediaTypesHandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTEimport SessionAttributessessionAttributeDoesNotExist(...)import static HttpStatus.BAD_REQUESTimport static HttpStatus.CREATEDimport static HttpStatus.INTERNAL_SERVER_ERRORimport static HttpStatus.NOT_IMPLEMENTEDnew StatusController(...)ResponseStatus.classimport static MockMvcResultMatchers.viewview(...)import static RequestMethod.GETimport static RequestMethod.HEADMap<String,String> musicNamespace, ...;new BlogFeedController(...)/** Tests with Java configuration. ... */// SPR-13615asyncResult(...)asyncStarted(...)import RootConfigimport static MockMvcResultHandlers.printRootConfig.classPersonController personController, ...;verifyRootWacSupport(...)asyncNotStarted(...)/** Verify that the breaking change introduced in <a ... *//** Tests dependent on access to resources under the web application root directory. ... *//** Tests with XML configuration. ... *//** Integration tests for {@link ControllerAdvice @ControllerAdvice}. ... */resetCounters(...)SingletonControllerAdvice.invocationCountPrototypeControllerAdvice.invocationCountRequestScopedControllerAdvice.invocationCountSingletonControllerAdvice.instanceCountPrototypeControllerAdvice.instanceCountRequestScopedControllerAdvice.instanceCountnew SingletonControllerAdvice(...)new PrototypeControllerAdvice(...)new RequestScopedControllerAdvice(...)AtomicInteger instanceCount, ...;// singleton @ControllerAdvice beans should not be instantiated again.// prototype and request-scoped @ControllerAdvice beans should be instantiated once per request./** Integration tests for SPR-13211 which verify that a custom mock request ... */String FROM_CUSTOM_MOCK, ...;String FROM_MVC_TEST_DEFAULT, ...;String FROM_MVC_TEST_MOCK, ...;GenericWebApplicationContext wac, ...;ServletRequestAttributes.classnew SingletonController(...)assertRequestAttributes(...)/** Tests for SPR-11441 (MockMvc accepts an already encoded URI). ... */pathSegment(...)ResultActions resultnew HandlerMappingConfigurer(...)jsp(...)RequestMappingHandlerMapping requestMappingHandlerMappingsetUrlDecode(...)// URL decode after request mapping, not before.import PutMappingimport FormContentFilterimport static MockMvcRequestBuilders.put/** Test for issues related to form content. ... */new FormContentFilter(...)new Spr15753Controller(...)getD1(...)getD2(...)String d1, ...;String d2, ...;this.d1this.d2// SPR-15753import static MockMvcRequestBuilders.options/** Tests for SPR-10093 (support for OPTIONS requests). ... */MyController controllerint initialCountcontroller.counterRequestMethod.OPTIONSimport CharacterEncodingFilter/** Test for SPR-10277 (multiple method chaining when building MockMvc). ... */new CharacterEncodingFilter(...)import GenericFilterBean/** Integration tests for the following use cases. ... */String FROM_TCF_MOCK, ...;String FROM_REQUEST_FILTER, ...;String FROM_REQUEST_ATTRIBUTES_FILTER, ...;RequestScopedController requestScopedController, ...;RequestScopedService requestScopedService, ...;SessionScopedService sessionScopedService, ...;FilterWithSessionScopedService filterWithSessionScopedService, ...;new RequestFilter(...)new RequestAttributesFilter(...)this.filterWithSessionScopedServicethis.requestScopedControllerthis.requestScopedServicethis.sessionScopedServicenew RequestScopedController(...)new RequestScopedService(...)new ControllerWithRequestScopedService(...)new SessionScopedService(...)new ControllerWithSessionScopedService(...)new FilterWithSessionScopedService(...)RequestScopedService service, ...;SessionScopedService service, ...;import static CoreMatchers.equalToimport static MockMvcBuilders.standaloneSetup/** Tests with asynchronous request handling. ... */this.asyncControllerAsyncController asyncController, ...;DeferredResult<Person> deferredResult// fetch async result similar to "asyncDispatch" builder// SPR-13079// SPR-12597// SPR-12735/** Exception handling via {@code @ExceptionHandler} methods. ... */import static MockMvcRequestBuilders.postimport static MockMvcResultMatchers.header/** Tests with {@link Filter}'s. ... */// SPR-16067, SPR-16695/** Demonstrates use of SPI extension points: ... */new TestRequestPostProcessor(...)/** Test {@code RequestPostProcessor}. */import static MockMvcRequestBuilders.multipartMockMultipartFile filePartbyte[] jsonMockMultipartFile jsonPartMockMultipartFile filePart1MockMultipartFile filePart2MockPart filePartMap<String,String> jsonMap// SPR-13317/** Tests with reactive return value types. ... */ReactiveController.class// SPR-16869/** Redirect scenarios including saving and retrieving flash attributes. ... *//** Tests demonstrating the use of request parameters. ... *//** Response written from {@code @ResponseBody} method. ... */import static MockMvcResultMatchers.xpath/** Tests with view resolution. ... */InternalResourceViewResolver viewResolverimport PrintingResultHandlerimport static MockMvcResultHandlers.log/** Smoke test for {@link PrintingResultHandler}. ... *//** Examples of defining expectations on the response content, content type, and ... */import static MockMvcResultMatchers.cookie/** Examples of expectations on response cookies values. ... */addInterceptors(...)version(...)/** Examples of expectations on flash attributes. ... *//** Examples of expectations on the controller type and controller method. ... *//** Examples of expectations on response header values. ... */stringValues(...)// SPR-10771// SPR-10659: ensure header name is in the message// Unfortunately, we can't control formatting from JUnit or Hamcrest./** Examples of defining expectations on JSON response content with ... *//** Examples of expectations on the content of the model prepared by the controller. ... */SampleController controller/** Examples of expectations on created request attributes. ... *//** Examples of expectations on created session attributes. ... *//** Examples of expectations on the status and the status reason found in the response. ... *//** Examples of expectations on forwarded or redirected URLs. ... *//** Examples of expectations on the view name selected by the controller. ... *//** Examples of defining expectations on XML response content with XMLUnit. ... *//** Examples of expectations on XML response content with XPath expressions. ... */// SPR-10704//		Map<String, String> namespace = Collections.singletonMap("ns", "");MockFilterChain filterChain, ...;MockFilter delegate, ...;PatternMappingFilterProxy filter, ...;FilterConfig configdelegate.filterConfigdelegate.destroyassertFilterInvoked(...)assertFilterNotInvoked(...)/* Below are tests from Table 12-1 of the Servlet Specification */delegate.requestdelegate.responsedelegate.chainFilterConfig filterConfig, ...;FilterChain chain, ...;boolean destroy, ...;this.filterConfigthis.chainthis.destroy// pattern uses extension mapping but starts with / (treated as exact match)/** Tests for {@link DefaultMockMvcBuilder}. ... *//** See SPR-12553 and SPR-13075. */StubWebApplicationContext childDefaultMockMvcBuilder builderStubWebApplicationContext rootStaticWebApplicationContext childStaticApplicationContext earStaticWebApplicationContext rootStaticWebApplicationContext dispatcher/** See /SPR-14277 */MockMvc mvcDispatcherServlet dssetContextId(...)getContextId(...)import static SharedHttpSessionConfigurer.sharedHttpSession/** Tests for {@link SharedHttpSessionConfigurer}. ... */sharedHttpSession(...)MvcResult resultInteger counterimport JsonSerializerimport UnknownSerializerimport SpringHandlerInstantiator/** Tests for {@link StandaloneMockMvcBuilder} ... */TestStandaloneMockMvcBuilder buildernew TestStandaloneMockMvcBuilder(...)new PlaceholderController(...)builder.wacRequestMappingHandlerMapping.classStandaloneMockMvcBuilder builderSpringHandlerInstantiator instantiatornew SpringHandlerInstantiator(...)JsonSerializer<> serializerserializerInstance(...)UnknownSerializer.class// SPR-10825// SPR-13637// SPR-12553// SPR-13375/** Exception thrown on failure to acquire a lock during an update, ... *//** Constructor for CannotAcquireLockException. ... *//** Exception thrown on failure to complete a transaction in serialized mode ... *//** Constructor for CannotSerializeTransactionException. ... *//** Exception thrown when we couldn't cleanup after a data access operation, ... *//** Constructor for CleanupFailureDataAccessException. ... *//** Exception thrown on concurrency failure. ... *//** Constructor for ConcurrencyFailureException. ... *//** Root of the hierarchy of data access exceptions discussed in ... *//** Constructor for DataAccessException. ... *//** Data access exception thrown when a resource fails completely: ... *//** Constructor for DataAccessResourceFailureException. ... *//** Exception thrown when an attempt to insert or update data ... *//** Constructor for DataIntegrityViolationException. ... *//** Exception thrown if certain expected data could not be retrieved, e.g. ... *//** Constructor for DataRetrievalFailureException. ... *//** Generic exception thrown when the current process was ... *//** Constructor for DeadlockLoserDataAccessException. ... *//** Constructor for DuplicateKeyException. ... *//** Data access exception thrown when a result was expected to have at least ... *//** Constructor for EmptyResultDataAccessException. ... *//** Data access exception thrown when a result was not of the expected size, ... */int expectedSize, ...;int actualSize, ...;/** Constructor for IncorrectResultSizeDataAccessException. ... */this.expectedSizethis.actualSize/** Return the expected result size. *//** Return the actual result size (or -1 if unknown). *//** Data access exception thrown when something unintended appears to have ... *//** Constructor for IncorrectUpdateSemanticsDataAccessException. ... *//** Return whether data was updated. ... *//** Exception thrown on incorrect usage of the API, such as failing to ... *//** Constructor for InvalidDataAccessApiUsageException. ... *//** Root for exceptions thrown when we use a data access resource incorrectly. ... *//** Constructor for InvalidDataAccessResourceUsageException. ... *//** Root of the hierarchy of data access exceptions that are considered non-transient - ... *//** Constructor for NonTransientDataAccessException. ... *//** Data access exception thrown when a resource fails completely and the failure is permanent. ... *//** Constructor for NonTransientDataAccessResourceException. ... *//** Exception thrown on an optimistic locking violation. ... *//** Constructor for OptimisticLockingFailureException. ... *//** Exception thrown when the underlying resource denied a permission ... *//** Constructor for PermissionDeniedDataAccessException. ... *//** Exception thrown on a pessimistic locking violation. ... *//** Constructor for PessimisticLockingFailureException. ... *//** Exception to be thrown on a query timeout. This could have different causes depending on ... *//** Constructor for QueryTimeoutException. ... *//** Data access exception thrown when a previously failed operation might be able ... *//** Constructor for RecoverableDataAccessException. ... *//** Root of the hierarchy of data access exceptions that are considered transient - ... *//** Constructor for TransientDataAccessException. ... *//** Data access exception thrown when a resource fails temporarily ... *//** Constructor for TransientDataAccessResourceException. ... *//** Exception thrown on mismatch between Java type and database type: ... *//** Constructor for TypeMismatchDataAccessException. ... *//** Normal superclass when we can't distinguish anything more specific ... *//** Constructor for UncategorizedDataAccessException. ... */import PersistenceExceptionTranslationInterceptor/** Spring AOP exception translation aspect for use at Repository or DAO layer level. ... */PersistenceExceptionTranslationInterceptor advice, ...;AnnotationMatchingPointcut pointcut, ...;/** Create a new PersistenceExceptionTranslationAdvisor. ... */new PersistenceExceptionTranslationInterceptor(...)/** Bean post-processor that automatically applies persistence exception translation to any ... */Class<? extends Annotation> repositoryAnnotationType, ...;/** Set the 'repository' annotation type. ... */this.repositoryAnnotationTypenew PersistenceExceptionTranslationAdvisor(...)/** Annotation support for DAOs. Contains a bean post-processor for translating ... *//** Exception hierarchy enabling sophisticated error handling independent ... *//** Implementation of {@link PersistenceExceptionTranslator} that supports chaining, ... */new ArrayList<PersistenceExceptionTranslator>(...)List<PersistenceExceptionTranslator> delegates, ...;/** List of PersistenceExceptionTranslators. *//** Add a PersistenceExceptionTranslator to the chained delegate list. *//** Return all registered PersistenceExceptionTranslator delegates (as array). */new PersistenceExceptionTranslator[]PersistenceExceptionTranslator petDataAccessException translatedDex/** Generic base class for DAOs, defining template methods for DAO initialization. ... */checkDaoConfig(...)initDao(...)/** Abstract subclasses must override this to check their configuration. ... *//** Concrete subclasses can override this for custom initialization behavior. ... */// Let abstract subclasses check their configuration.// Let concrete implementations initialize themselves./** Miscellaneous utility methods for DAO implementations. ... *//** Return a single result object from the given Collection. ... *//** Return a unique result object from the given Collection. ... */requiredUniqueResult(...)/** Return a unique int result from the given Collection. ... */objectResult(...)/** Return a unique long result from the given Collection. ... *//** Return a translated exception if this is appropriate, ... */// This is identical to the requiredSingleResult implementation but differs in the// semantics of the incoming Collection (which we currently can't formally express)/** AOP Alliance MethodInterceptor that provides persistence exception translation ... */PersistenceExceptionTranslator persistenceExceptionTranslator, ...;boolean alwaysTranslate, ...;/** Create a new PersistenceExceptionTranslationInterceptor. ... *//** Create a new PersistenceExceptionTranslationInterceptor ... */this.persistenceExceptionTranslator/** Create a new PersistenceExceptionTranslationInterceptor, autodetecting ... *//** Specify the PersistenceExceptionTranslator to use. ... *//** Specify whether to always translate the exception ("true"), or whether throw the ... */this.alwaysTranslatePersistenceExceptionTranslator translatordetectPersistenceExceptionTranslators(...)/** Detect all PersistenceExceptionTranslators in the given BeanFactory. ... */ChainedPersistenceExceptionTranslator cpetnew ChainedPersistenceExceptionTranslator(...)new Consumer<PersistenceExceptionTranslator>(...) { ... }addDelegate(...)// No explicit exception translator specified - perform autodetection.// Let it throw raw if the type of the exception is on the throws clause of the method.// Find all translators, being careful not to activate FactoryBeans./** Interface implemented by Spring integrations with data access technologies ... *//** Translate the given runtime exception thrown by a persistence framework to a ... *//** Support classes for DAO implementations, ... *//** Exception thrown when the creating of a CCI Record failed ... *//** Constructor for CannotCreateRecordException. ... *//** Fatal exception thrown when we can't connect to an EIS using CCI. ... *//** Constructor for CannotGetCciConnectionException. ... *//** Exception thrown when the connector doesn't support a specific CCI operation. ... *//** Constructor for CciOperationNotSupportedException. ... *//** Exception thrown when the creating of a CCI Record failed because ... *//** Constructor for RecordTypeNotSupportedException. ... */import NotSupportedExceptionimport LocalTransactionException/** Create a new CciLocalTransactionManager instance. ... *//** Set the CCI ConnectionFactory that this instance should manage local ... *//** Return the CCI ConnectionFactory that this instance manages local ... */CciLocalTransactionObject txObjectnew CciLocalTransactionObject(...)getLocalTransaction(...)NotSupportedException exLocalTransactionException ex/** CCI local transaction object, representing a ConnectionHolder. ... */// Consider a pre-bound connection as transaction.// Remove the connection holder from the thread.import ConnectionSpec/** Helper class that provides static methods for obtaining CCI Connections ... *//** Obtain a Connection from the given ConnectionFactory. Translates ResourceExceptions ... */new CannotGetCciConnectionException(...)/** Actually obtain a CCI Connection from the given ConnectionFactory. ... *//** Determine whether the given JCA CCI Connection is transactional, that is, ... *//** Close the given Connection, obtained from the given ConnectionFactory, ... *//** Actually close the given Connection, obtained from the given ConnectionFactory. ... *//** Callback for resource cleanup at the end of a non-native CCI transaction ... */// We don't trust the CCI driver: It might throw RuntimeException or Error./** Resource holder wrapping a CCI {@link Connection}. ... *//** An adapter for a target CCI {@link javax.resource.cci.ConnectionFactory}, ... */new NamedThreadLocal<ConnectionSpec>(...)ConnectionSpec connectionSpec, ...;ThreadLocal<ConnectionSpec> threadBoundSpec, ...;/** Set the ConnectionSpec that this adapter should use for retrieving Connections. ... */this.connectionSpec/** Set a ConnectionSpec for this proxy and the current thread. ... */this.threadBoundSpec/** Remove any ConnectionSpec for this proxy from the current thread. ... *//** Determine whether there is currently a thread-bound ConnectionSpec, ... */ConnectionSpec threadSpec/** This implementation delegates to the {@code getConnection(ConnectionSpec)} ... */import RecordFactoryimport ResourceAdapterMetaData/** CCI {@link ConnectionFactory} implementation that delegates all calls ... *//** Obtain the target {@code ConnectionFactory} for actual use (never {@code null}). ... */getRecordFactory(...)setReference(...)import IndexedRecordimport MappedRecord/** Implementation of the CCI RecordFactory interface that always throws ... */new NotSupportedException(...)/** A CCI ConnectionFactory adapter that returns the same Connection on all ... *//** Create a new SingleConnectionFactory that always returns the ... *//** Create a new SingleConnectionFactory that always returns a single ... *//** Initialize the single underlying Connection. ... *//** Create a CCI Connection via this template's ConnectionFactory. ... *//** Invocation handler that suppresses close calls on CCI Connections. *//** Proxy for a target CCI {@link javax.resource.cci.ConnectionFactory}, adding ... *//** Delegate to ConnectionFactoryUtils for automatically participating in Spring-managed ... */ConnectionFactory targetConnectionFactory/** Invocation handler that delegates close calls on CCI Connections ... */// Invocation on Connection interface coming in...import InteractionSpecimport Record/** Interface that specifies a basic set of CCI operations on an EIS. ... *//** Execute a request on an EIS with CCI, implemented as callback action ... *//** Execute the specified interaction on an EIS with CCI. ... */import Interaction/** <b>This is the central class in the CCI core package.</b> ... */RecordCreator outputRecordCreator, ...;/** Construct a new CciTemplate for bean usage. ... *//** Construct a new CciTemplate, given a ConnectionFactory to obtain Connections from. ... */setConnectionSpec(...)/** Set the CCI ConnectionFactory to obtain Connections from. *//** Return the CCI ConnectionFactory used by this template. *//** Set the CCI ConnectionSpec that this template instance is ... *//** Return the CCI ConnectionSpec used by this template, if any. *//** Set a RecordCreator that should be used for creating default output Records. ... */this.outputRecordCreator/** Return a RecordCreator that should be used for creating default output Records. *//** Create a template derived from this template instance, ... */CciTemplate derivednew CciTemplate(...)RecordCreator recordCreatorgetOutputRecordCreator(...)setOutputRecordCreator(...)getConnectionSpec(...)new CciOperationNotSupportedException(...)new ConnectionCallback<T>(...) { ... }Interaction interactioncreateInteraction(...)doInInteraction(...)closeInteraction(...)new SimpleRecordExtractor(...)Record outputcreateRecord(...)new InteractionCallback<T>(...) { ... }Record outputRecordToUseRecordFactory recordFactory/** Create an indexed Record through the ConnectionFactory's RecordFactory. ... */createIndexedRecord(...)new RecordTypeNotSupportedException(...)new CannotCreateRecordException(...)/** Create a mapped Record from the ConnectionFactory's RecordFactory. ... */createMappedRecord(...)/** Invoke the given RecordCreator, converting JCA ResourceExceptions ... *//** Return a RecordFactory for the given ConnectionFactory. ... */new NotSupportedRecordFactory(...)/** Close the given CCI Interaction and ignore any thrown exception. ... *//** Close the given CCI ResultSet and ignore any thrown exception. ... */// Use the CCI execute method with output record as parameter./** Generic callback interface for code that operates on a CCI Connection. ... *//** Gets called by {@code CciTemplate.execute} with an active CCI Connection. ... *//** Generic callback interface for code that operates on a CCI Interaction. ... *//** Gets called by {@code CciTemplate.execute} with an active CCI Interaction. ... *//** Callback interface for creating a CCI Record instance, ... *//** Create a CCI Record instance, usually based on the passed-in CCI RecordFactory. ... *//** Callback interface for extracting a result object from a CCI Record instance. ... *//** Process the data in the given Record, creating a corresponding result object. ... *//** Provides the core JCA CCI support, based on CciTemplate ... *//** Convenient super class for CCI-based data access objects. ... */CciTemplate cciTemplate, ...;/** Set the ConnectionFactory to be used by this DAO. */this.cciTemplatecreateCciTemplate(...)/** Create a CciTemplate for the given ConnectionFactory. ... *//** Return the ConnectionFactory used by this DAO. *//** Set the CciTemplate for this DAO explicitly, ... *//** Return the CciTemplate for this DAO, ... *//** Obtain a CciTemplate derived from the main template instance, ... */CciTemplate cciTemplategetCciTemplate(...)getDerivedTemplate(...)/** Get a CCI Connection, either from the current transaction or a new one. ... *//** Close the given CCI Connection, created via this bean's ConnectionFactory, ... */import Streamable/** CCI Record implementation for a COMMAREA, holding a byte array. ... */String recordName, ...;String recordShortDescription, ...;/** Create a new CommAreaRecord. ... */this.recordNamethis.recordShortDescriptionnew CommAreaRecord(...)/** Classes supporting the {@code org.springframework.jca.cci.core} package. ... *//** Base class for EIS operation objects that work with the CCI API. ... */InteractionSpec interactionSpec, ...;/** Set the CciTemplate to be used by this operation. ... *//** Return the CciTemplate used by this operation. *//** Set the CCI ConnectionFactory to be used by this operation. *//** Set the CCI InteractionSpec for this operation. */this.interactionSpec/** Return the CCI InteractionSpec for this operation. *//** EIS operation object for access to COMMAREA records. ... *//** Create a new MappingCommAreaQuery. ... */objectToBytes(...)CommAreaRecord commAreaRecordbytesToObject(...)/** Method used to convert an object into COMMAREA bytes. ... *//** Method used to convert the COMMAREA's bytes to an object. ... *//** EIS operation object that expects mapped input and output objects, ... *//** Convenient constructor with ConnectionFactory and specifications ... */setInteractionSpec(...)/** Execute the interaction encapsulated by this operation object. ... */InteractionSpec interactionSpecgetInteractionSpec(...)new RecordCreatorImpl(...)new RecordExtractorImpl(...)/** Subclasses must implement this method to generate an input Record ... *//** Subclasses must implement this method to convert the Record returned ... *//** Implementation of RecordCreator that calls the enclosing ... */Object inputObject, ...;this.inputObjectcreateInputRecord(...)/** Implementation of RecordExtractor that calls the enclosing ... */extractOutputData(...)/** EIS operation object that accepts a passed-in CCI input Record ... *//** Execute the CCI interaction encapsulated by this operation object. ... *//** The classes in this package represent EIS operations as threadsafe, ... *//** This package contains Spring's support for the Common Client Interface (CCI), ... *//** Interface to be implemented by any object that wishes to be ... *//** Set the BootstrapContext that this object runs in. ... *//** Create a new BootstrapContextAwareProcessor for the given context. *//** Create a new ResourceAdapterApplicationContext for the given BootstrapContext. ... */new BootstrapContextAwareProcessor(...)BootstrapContextAware.classBootstrapContext.classnew ObjectFactory<WorkManager>(...) { ... }getWorkManager(...)// JCA WorkManager resolved lazily - may not be available./** JCA 1.7 {@link javax.resource.spi.ResourceAdapter} implementation ... */String DEFAULT_CONTEXT_CONFIG_LOCATION, ...;/** The default {@code applicationContext.xml} location. */String contextConfigLocation, ...;/** Set the location of the context configuration files, within the ... */this.contextConfigLocation/** Return the specified context configuration files. *//** Return a new {@link StandardEnvironment}. ... *//** This implementation loads a Spring ApplicationContext through the ... *//** Build a Spring ApplicationContext for the given JCA BootstrapContext. ... */ResourceAdapterApplicationContext applicationContextgetContextConfigLocation(...)/** Load the bean definitions into the given registry, ... *//** This implementation closes the Spring ApplicationContext. *//** This implementation always throws a NotSupportedException. *//** This implementation does nothing. *//** This implementation always returns {@code null}. */// Set ResourceAdapter's ClassLoader as bean class loader.// Extract individual config locations./** Integration package that allows for deploying a Spring application context ... */import ApplicationServerInternalExceptionimport MessageEndpointimport SimpleTransactionFactoryimport TransactionFactory/** Abstract base implementation of the JCA 1.7 ... */TransactionFactory transactionFactory, ...;String transactionName, ...;int transactionTimeout, ...;this.transactionFactorynew SimpleTransactionFactory(...)/** Set the Spring TransactionFactory to use for wrapping endpoint ... *//** Specify the name of the transaction, if any. ... */this.transactionName/** Specify the transaction timeout, if any. ... */this.transactionTimeout/** Implementation of the JCA 1.7 {@code #getActivationName()} method, ... *//** Implementation of the JCA 1.7 {@code #getEndpointClass()} method, ... *//** This implementation returns {@code true} if a transaction manager ... *//** The standard JCA 1.5 version of {@code createEndpoint}. ... */AbstractMessageEndpoint endpointcreateEndpointInternal(...)initXAResource(...)/** The alternative JCA 1.6 version of {@code createEndpoint}. ... *//** Create the actual endpoint instance, as a subclass of the ... *//** Inner class for actual endpoint implementations, based on template ... */TransactionDelegate transactionDelegate, ...;boolean beforeDeliveryCalled, ...;ClassLoader previousContextClassLoader, ...;/** Initialize this endpoint's TransactionDelegate. ... */this.transactionDelegatenew TransactionDelegate(...)/** This {@code beforeDelivery} implementation starts a transaction, ... */this.beforeDeliveryCallednew ApplicationServerInternalException(...)this.previousContextClassLoadergetEndpointClassLoader(...)/** Template method for exposing the endpoint's ClassLoader ... *//** Return whether the {@link #beforeDelivery} method of this endpoint ... *//** Callback method for notifying the endpoint base class ... *//** This {@code afterDelivery} implementation resets the thread context ... *//** Private inner class that performs the actual transaction handling, ... */XAResource xaResource, ...;boolean rollbackOnly, ...;supportsResourceAdapterManagedTransactions(...)this.xaResourcecreateTransaction(...)enlistResource(...)this.rollbackOnly/** Generic implementation of the JCA 1.7 ... *//** Specify the message listener object that the endpoint should expose ... *//** Return the message listener object for this endpoint. ... *//** Wrap each concrete endpoint instance with an AOP proxy, ... */GenericMessageEndpoint endpoint/** Creates a concrete generic message endpoint, internal to this factory. */new GenericMessageEndpoint(...)/** Private inner class that implements the concrete generic message endpoint, ... */adaptExceptionIfNecessary(...)new InternalResourceException(...)/** Generic bean that manages JCA 1.7 message endpoints within a Spring ... */MessageEndpointFactory messageEndpointFactory, ...;ActivationSpec activationSpec, ...;/** Set the JCA ResourceAdapter to manage endpoints for. *//** Return the JCA ResourceAdapter to manage endpoints for. *//** Set the JCA MessageEndpointFactory to activate, pointing to a ... */this.messageEndpointFactory/** Return the JCA MessageEndpointFactory to activate. *//** Set the JCA ActivationSpec to use for activating the endpoint. ... */this.activationSpec/** Return the JCA ActivationSpec to use for activating the endpoint. *//** Set whether to auto-start the endpoint activation after this endpoint ... *//** Return the value for the 'autoStartup' property.	If "true", this ... *//** Specify the phase in which this endpoint manager should be started ... *//** Return the phase in which this endpoint manager will be started and stopped. *//** Prepares the message endpoint, and automatically activates it ... */ActivationSpec activationSpecgetActivationSpec(...)getMessageEndpointFactory(...)/** Activates the configured message endpoint. */ResourceAdapter resourceAdapterendpointActivation(...)/** Deactivates the configured message endpoint. */endpointDeactivation(...)/** Return whether the configured message endpoint is currently active. *//** Deactivates the message endpoint, preparing it for shutdown. *//** This package provides a facility for generic JCA message endpoint management. */import ConnectionManagerimport ManagedConnectionFactory/** {@link org.springframework.beans.factory.FactoryBean} that creates ... */ManagedConnectionFactory managedConnectionFactory, ...;ConnectionManager connectionManager, ...;Object connectionFactory, ...;/** Set the JCA ManagerConnectionFactory that should be used to create ... */this.managedConnectionFactory/** Set the JCA ConnectionManager that should be used to create the ... */this.connectionManagerimport XATerminator/** {@link org.springframework.beans.factory.FactoryBean} that bootstraps ... */XATerminator xaTerminator, ...;/** Specify the target JCA ResourceAdapter as class, to be instantiated ... *//** Specify the target JCA ResourceAdapter, passed in as configured instance ... *//** Specify the JCA BootstrapContext to use for starting the ResourceAdapter. ... *//** Specify the JCA WorkManager to use for bootstrapping the ResourceAdapter. ... *//** Specify the JCA XATerminator to use for bootstrapping the ResourceAdapter. ... */this.xaTerminator/** Builds the BootstrapContext and starts the ResourceAdapter with it. ... */ResourceAdapter.class/** Stops the ResourceAdapter. ... */import WorkContext/** Simple implementation of the JCA 1.7 {@link javax.resource.spi.BootstrapContext} ... *//** Create a new SimpleBootstrapContext for the given WorkManager, ... *//** Create a new SimpleBootstrapContext for the given WorkManager and XATerminator. ... *//** Create a new SimpleBootstrapContext for the given WorkManager, XATerminator ... */new Timer(...)/** Provides generic support classes for JCA usage within Spring, ... */import ExecutionContextimport WorkAdapterimport WorkCompletedExceptionimport WorkEventimport TaskTimeoutException/** Simple JCA 1.7 {@link javax.resource.spi.work.WorkManager} implementation that ... */TaskExecutor syncTaskExecutor, ...;AsyncTaskExecutor asyncTaskExecutor, ...;/** Specify the TaskExecutor to use for <i>synchronous</i> work execution ... */this.syncTaskExecutor/** Specify the TaskExecutor to use for <i>asynchronous</i> work execution ... */this.asyncTaskExecutorWorkManager.INDEFINITEexecuteWork(...)startWork(...)scheduleWork(...)/** Execute the given Work on the specified TaskExecutor. ... */WorkListener workListenerToUseboolean isAsyncDelegatingWorkAdapter workHandlenew DelegatingWorkAdapter(...)getXid(...)new WorkException(...)new WorkAdapter(...)TaskTimeoutException exWorkException wexnew WorkRejectedException(...)setErrorCode(...)WorkException.START_TIMED_OUTworkRejected(...)new WorkEvent(...)WorkEvent.WORK_REJECTEDTaskRejectedException exWorkException.INTERNALworkAccepted(...)WorkEvent.WORK_ACCEPTEDlong acceptanceTimeworkHandle.monitorworkHandle.startedWorkManager.UNKNOWN/** Work adapter that supports start timeouts and WorkListener callbacks ... */Work work, ...;boolean acceptOnExecution, ...;boolean started, ...;this.workthis.acceptOnExecutionthis.startedworkStarted(...)WorkEvent.WORK_STARTEDworkCompleted(...)WorkEvent.WORK_COMPLETEDnew WorkCompletedException(...)import BootstrapContextAware/** {@link org.springframework.core.task.TaskExecutor} implementation ... */boolean blockUntilStarted, ...;boolean blockUntilCompleted, ...;/** Create a new WorkManagerTaskExecutor, expecting bean-style configuration. ... *//** Create a new WorkManagerTaskExecutor for the given WorkManager. ... */setWorkManager(...)/** Specify the JCA WorkManager instance to delegate to. *//** Set the JNDI name of the JCA WorkManager. ... *//** Specify the JCA BootstrapContext that contains the ... *//** Set whether to let {@link #execute} block until the work ... */this.blockUntilStartedthis.blockUntilCompleted/** Specify a JCA WorkListener to apply, if any. ... */getDefaultWorkManager(...)/** Obtain a default WorkManager to delegate to. ... */new TaskTimeoutException(...)// Implementation of the JCA WorkManager interface/** Convenience classes for scheduling based on the JCA WorkManager facility, ... *//** Exception thrown when a transaction can't be created using an ... *//** Constructor for CannotCreateTransactionException. ... *//** Exception that represents a transaction failure caused by a heuristic ... */int STATE_UNKNOWN, ...;/** Unknown outcome state. */int STATE_COMMITTED, ...;/** Committed outcome state. */int STATE_ROLLED_BACK, ...;/** Rolledback outcome state. */int STATE_MIXED, ...;/** Mixed outcome state. */int outcomeState, ...;/** The outcome state of the transaction: have some or all resources been committed? *//** Constructor for HeuristicCompletionException. ... */getStateString(...)this.outcomeState/** Return the outcome state of the transaction state, ... *//** Exception thrown when the existence or non-existence of a transaction ... *//** Constructor for IllegalTransactionStateException. ... *//** Exception that gets thrown when an invalid isolation level is specified, ... *//** Constructor for InvalidIsolationLevelException. ... *//** Exception that gets thrown when an invalid timeout is specified, ... *//** Constructor for InvalidTimeoutException. ... *//** Return the invalid timeout value. *//** Exception thrown when attempting to work with a nested transaction ... *//** Constructor for NestedTransactionNotSupportedException. ... *//** Exception thrown when an operation is attempted that ... *//** Constructor for NoTransactionException. ... *//** This is the central interface in Spring's imperative transaction infrastructure. ... *//** Return a currently active transaction or create a new one, according to ... *//** Commit the given transaction, with regard to its status. If the transaction ... *//** Perform a rollback of the given transaction. ... *//** Representation of an ongoing reactive transaction. ... *//** This is the central interface in Spring's reactive transaction infrastructure. ... *//** Emit a currently active reactive transaction or create a new one, according to ... *//** Interface that specifies an API to programmatically manage transaction ... *//** Create a new savepoint. You can roll back to a specific savepoint ... *//** Roll back to the given savepoint. ... *//** Explicitly release the given savepoint. ... *//** A static unmodifiable transaction definition. ... */new StaticTransactionDefinition(...)StaticTransactionDefinition INSTANCE, ...;/** Interface that defines Spring-compliant transaction properties. ... */int PROPAGATION_REQUIRED, ...;/** Support a current transaction; create a new one if none exists. ... */int PROPAGATION_SUPPORTS, ...;/** Support a current transaction; execute non-transactionally if none exists. ... */int PROPAGATION_MANDATORY, ...;/** Support a current transaction; throw an exception if no current transaction ... */int PROPAGATION_REQUIRES_NEW, ...;/** Create a new transaction, suspending the current transaction if one exists. ... */int PROPAGATION_NOT_SUPPORTED, ...;/** Do not support a current transaction; rather always execute non-transactionally. ... */int PROPAGATION_NEVER, ...;/** Do not support a current transaction; throw an exception if a current transaction ... */int PROPAGATION_NESTED, ...;/** Execute within a nested transaction if a current transaction exists, ... */int ISOLATION_DEFAULT, ...;/** Use the default isolation level of the underlying datastore. ... */int ISOLATION_READ_UNCOMMITTED, ...;/** Indicates that dirty reads, non-repeatable reads and phantom reads ... */int ISOLATION_READ_COMMITTED, ...;/** Indicates that dirty reads are prevented; non-repeatable reads and ... */// same as java.sql.Connection.TRANSACTION_READ_UNCOMMITTED;int ISOLATION_REPEATABLE_READ, ...;/** Indicates that dirty reads and non-repeatable reads are prevented; ... */// same as java.sql.Connection.TRANSACTION_READ_COMMITTED;int ISOLATION_SERIALIZABLE, ...;// same as java.sql.Connection.TRANSACTION_REPEATABLE_READ;int TIMEOUT_DEFAULT, ...;/** Use the default timeout of the underlying transaction system, ... */// same as java.sql.Connection.TRANSACTION_SERIALIZABLE;/** Return the propagation behavior. ... *//** Return the isolation level. ... *//** Return the transaction timeout. ... *//** Return whether to optimize as a read-only transaction. ... *//** Return the name of this transaction. Can be {@code null}. ... *//** Return an unmodifiable {@code TransactionDefinition} with defaults. ... */StaticTransactionDefinition.INSTANCE/** Superclass for all transaction exceptions. ... *//** Constructor for TransactionException. ... *//** Common representation of the current state of a transaction. ... *//** Return whether the present transaction is new; otherwise participating ... *//** Set the transaction rollback-only. This instructs the transaction manager ... *//** Return whether the transaction has been marked as rollback-only ... *//** Return whether this transaction is completed, that is, ... *//** Marker interface for Spring transaction manager implementations, ... */import Flushable/** Representation of the status of a transaction. ... *//** Return whether this transaction internally carries a savepoint, ... *//** Flush the underlying session to the datastore, if applicable: ... *//** Exception thrown when attempting to suspend an existing transaction ... *//** Constructor for TransactionSuspensionNotSupportedException. ... *//** Exception thrown when a general transaction system error is encountered, ... */Throwable applicationException, ...;/** Constructor for TransactionSystemException. ... *//** Set an application exception that was thrown before this transaction exception, ... */this.applicationException/** Return the application exception that was thrown before this transaction exception, ... *//** Return the exception that was the first to be thrown within the failed transaction: ... *//** Exception to be thrown when a transaction has timed out. ... *//** Constructor for TransactionTimedOutException. ... *//** Superclass for exceptions caused by inappropriate usage of ... *//** Constructor for TransactionUsageException. ... *//** Thrown when an attempt to commit a transaction resulted ... *//** Constructor for UnexpectedRollbackException. ... */import TransactionManagementConfigUtilsimport TransactionalEventListenerFactory/** Abstract base {@code @Configuration} class providing common structure for enabling ... */AnnotationAttributes enableTx, ...;TransactionManager txManager, ...;/** Default transaction manager, as configured through a {@link TransactionManagementConfigurer}. */this.enableTxEnableTransactionManagement.classTransactionManagementConfigurer configurerthis.txManagerTransactionManagementConfigUtils.TRANSACTIONAL_EVENT_LISTENER_FACTORY_BEAN_NAMEnew TransactionalEventListenerFactory(...)import AbstractFallbackTransactionAttributeSource/** Implementation of the ... */AnnotationTransactionAttributeSource.classboolean jta12Present, ...;boolean ejb3Present, ...;Set<TransactionAnnotationParser> annotationParsers, ...;/** Create a default AnnotationTransactionAttributeSource, supporting ... *//** Create a custom AnnotationTransactionAttributeSource, supporting ... */new LinkedHashSet<TransactionAnnotationParser>(...)new SpringTransactionAnnotationParser(...)new JtaTransactionAnnotationParser(...)new Ejb3TransactionAnnotationParser(...)/** Create a custom AnnotationTransactionAttributeSource. ... */TransactionAnnotationParser parserdetermineTransactionAttribute(...)/** Determine the transaction attribute for the given method or class. ... */TransactionAttribute attrparseTransactionAnnotation(...)/** By default, only public methods can be made transactional. */AnnotationTransactionAttributeSource otherTasotherTas.annotationParsersotherTas.publicMethodsOnlyimport ApplicationException/** Strategy implementation for parsing EJB3's {@link javax.ejb.TransactionAttribute} ... */TransactionAttribute.classTransactionAttribute annnew Ejb3TransactionAttribute(...)Ejb3TransactionAnnotationParser.class/** EJB3-specific TransactionAttribute, implementing EJB3's rollback rules ... */setPropagationBehaviorName(...)ApplicationException annApplicationException.classrollbackOn(...)/** Enables Spring's annotation-driven transaction management capability, similar to ... */TransactionManagementConfigurationSelector.class/** Indicate whether subclass-based (CGLIB) proxies are to be created ({@code true}) as ... *//** Indicate how transactional advice should be applied. ... *//** Indicate the ordering of the execution of the transaction advisor ... *//** Enumeration that represents transaction isolation levels for use ... */new Isolation(...)Isolation DEFAULT, ...;Isolation READ_UNCOMMITTED, ...;/** A constant indicating that dirty reads, non-repeatable reads and phantom reads ... */Isolation READ_COMMITTED, ...;/** A constant indicating that dirty reads are prevented; non-repeatable reads ... */Isolation REPEATABLE_READ, ...;/** A constant indicating that dirty reads and non-repeatable reads are ... */Isolation SERIALIZABLE, ...;/** A constant indicating that dirty reads, non-repeatable reads and phantom ... */import NoRollbackRuleAttributeimport RollbackRuleAttributeimport RuleBasedTransactionAttribute/** Strategy implementation for parsing JTA 1.2's {@link javax.transaction.Transactional} annotation. ... */RuleBasedTransactionAttribute rbtanew RuleBasedTransactionAttribute(...)List<RollbackRuleAttribute> rollbackRulesnew ArrayList<RollbackRuleAttribute>(...)RuleBasedTransactionAttribute.PREFIX_PROPAGATIONClass<?> rbRulenew RollbackRuleAttribute(...)new NoRollbackRuleAttribute(...)setRollbackRules(...)JtaTransactionAnnotationParser.class/** Enumeration that represents transaction propagation behaviors for use ... */new Propagation(...)TransactionDefinition.PROPAGATION_MANDATORYPropagation REQUIRED, ...;/** Support a current transaction, create a new one if none exists. ... */Propagation SUPPORTS, ...;/** Support a current transaction, execute non-transactionally if none exists. ... */Propagation MANDATORY, ...;/** Support a current transaction, throw an exception if none exists. ... */Propagation REQUIRES_NEW, ...;/** Create a new transaction, and suspend the current transaction if one exists. ... */Propagation NOT_SUPPORTED, ...;/** Execute non-transactionally, suspend the current transaction if one exists. ... */Propagation NEVER, ...;/** Execute non-transactionally, throw an exception if a transaction exists. ... */Propagation NESTED, ...;/** {@code @Configuration} class that registers the Spring infrastructure beans ... */TransactionManagementConfigUtils.TRANSACTION_ADVISOR_BEAN_NAMEBeanFactoryTransactionAttributeSourceAdvisor advisornew BeanFactoryTransactionAttributeSourceAdvisor(...)setTransactionAttributeSource(...)new AnnotationTransactionAttributeSource(...)TransactionInterceptor interceptornew TransactionInterceptor(...)/** Strategy implementation for parsing Spring's {@link Transactional} annotation. ... */Propagation propagationIsolation isolationString timeoutStringsetTimeoutString(...)setQualifier(...)setLabels(...)String rbRuleSpringTransactionAnnotationParser.class/** Strategy interface for parsing known transaction annotation types. ... *//** Determine whether the given class is a candidate for transaction attributes ... *//** Parse the transaction attribute for the given method or class, ... *//** Selects which implementation of {@link AbstractTransactionManagementConfiguration} ... *//** Returns {@link ProxyTransactionManagementConfiguration} or ... */ProxyTransactionManagementConfiguration.classdetermineTransactionAspectClass(...)TransactionManagementConfigUtils.JTA_TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAMETransactionManagementConfigUtils.TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAME/** Return the default transaction manager bean to use for annotation-driven database ... *//** Describes a transaction attribute on an individual method or on a class. ... *//** Alias for {@link #transactionManager}. ... *//** A <em>qualifier</em> value for the specified transaction. ... *//** Defines zero (0) or more transaction labels. Labels may be used to ... *//** The transaction propagation type. ... *//** The transaction isolation level. ... *//** The timeout for this transaction (in seconds). ... *//** A boolean flag that can be set to {@code true} if the transaction is ... *//** Defines zero (0) or more exception {@link Class classes}, which must be ... *//** Defines zero (0) or more exception names (for exceptions which must be a ... *//** Defines zero (0) or more exception {@link Class Classes}, which must be ... *//** Spring's support for annotation-based transaction demarcation. ... *//** Parses the {@code <tx:annotation-driven/>} tag. Will ... */registerTransactionalEventListenerFactory(...)registerTransactionAspect(...)registerJtaTransactionAspect(...)String txAspectBeanNameTransactionManagementConfigUtils.TRANSACTION_ASPECT_BEAN_NAMEString txAspectClassNameTransactionManagementConfigUtils.TRANSACTION_ASPECT_CLASS_NAMEregisterTransactionManager(...)TransactionManagementConfigUtils.JTA_TRANSACTION_ASPECT_BEAN_NAMETransactionManagementConfigUtils.JTA_TRANSACTION_ASPECT_CLASS_NAMEgetTransactionManagerName(...)TransactionalEventListenerFactory.class/** Inner class to just introduce an AOP framework dependency when actually in proxy mode. */String txAdvisorBeanNameTransactionInterceptor.class// Create the TransactionAttributeSource definition.// Create the TransactionInterceptor definition.// Create the TransactionAttributeSourceAdvisor definition./** Parser for the &lt;tx:jta-transaction-manager/&gt; XML configuration element, ... */resolveJtaTransactionManagerClassName(...)TxNamespaceHandler.DEFAULT_TRANSACTION_MANAGER_BEAN_NAME/** A {@link FactoryBean} equivalent to the &lt;tx:jta-transaction-manager/&gt; XML element, ... */JtaTransactionManagerFactoryBean.classString WEBLOGIC_JTA_TRANSACTION_MANAGER_CLASS_NAME, ...;String WEBSPHERE_TRANSACTION_MANAGER_CLASS_NAME, ...;String JTA_TRANSACTION_MANAGER_CLASS_NAME, ...;JtaTransactionManager transactionManager, ...;Class<? extends JtaTransactionManager> clazzString TRANSACTION_ADVISOR_BEAN_NAME, ...;/** The bean name of the internally managed transaction advisor (used when mode == PROXY). */String TRANSACTION_ASPECT_BEAN_NAME, ...;/** The bean name of the internally managed transaction aspect (used when mode == ASPECTJ). */String TRANSACTION_ASPECT_CLASS_NAME, ...;/** The class name of the AspectJ transaction management aspect. */String TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAME, ...;/** The name of the AspectJ transaction management @{@code Configuration} class. */String JTA_TRANSACTION_ASPECT_BEAN_NAME, ...;/** The bean name of the internally managed JTA transaction aspect (used when mode == ASPECTJ). ... */String JTA_TRANSACTION_ASPECT_CLASS_NAME, ...;/** The class name of the AspectJ transaction management aspect. ... */String JTA_TRANSACTION_ASPECT_CONFIGURATION_CLASS_NAME, ...;/** The name of the AspectJ transaction management @{@code Configuration} class for JTA. ... */String TRANSACTIONAL_EVENT_LISTENER_FACTORY_BEAN_NAME, ...;/** The bean name of the internally managed TransactionalEventListenerFactory. */import NameMatchTransactionAttributeSourceString METHOD_ELEMENT, ...;String METHOD_NAME_ATTRIBUTE, ...;String ATTRIBUTES_ELEMENT, ...;String TIMEOUT_ATTRIBUTE, ...;String READ_ONLY_ATTRIBUTE, ...;String PROPAGATION_ATTRIBUTE, ...;String ISOLATION_ATTRIBUTE, ...;String ROLLBACK_FOR_ATTRIBUTE, ...;String NO_ROLLBACK_FOR_ATTRIBUTE, ...;List<Element> txAttributesElement attributeSourceElementparseAttributeSource(...)List<Element> methodsManagedMap<TypedStringValue,RuleBasedTransactionAttribute> transactionAttributeMapnew ManagedMap<TypedStringValue,RuleBasedTransactionAttribute>(...)NameMatchTransactionAttributeSource.classElement methodEleRuleBasedTransactionAttribute attributeString propagationString isolationString timeoutString readOnlysetIsolationLevelName(...)RuleBasedTransactionAttribute.PREFIX_ISOLATIONString rollbackForValueaddRollbackRuleAttributesTo(...)String noRollbackForValueaddNoRollbackRuleAttributesTo(...)String[] exceptionTypeNames/** {@code NamespaceHandler} allowing for the configuration of ... */String DEFAULT_TRANSACTION_MANAGER_BEAN_NAME, ...;new TxAdviceBeanDefinitionParser(...)new JtaTransactionManagerBeanDefinitionParser(...)/** Support package for declarative transaction configuration, ... *//** The phase at which a transactional event listener applies. ... */new TransactionPhase(...)TransactionPhase BEFORE_COMMIT, ...;/** Fire the event before transaction commit. ... */TransactionPhase AFTER_COMMIT, ...;/** Fire the event after the commit has completed successfully. ... */TransactionPhase AFTER_ROLLBACK, ...;/** Fire the event if the transaction has rolled back. ... */TransactionPhase AFTER_COMPLETION, ...;/** Fire the event after the transaction has completed. ... *//** An {@link ApplicationListener} that is invoked according to a {@link TransactionPhase}. ... *//** Return the execution order within transaction synchronizations. ... *//** Return the {@link TransactionPhase} in which the listener will be invoked. ... */TransactionPhase.AFTER_COMMIT/** Return an identifier for the listener to be able to refer to it individually. ... *//** Add a callback to be invoked on processing within transaction synchronization, ... *//** Immediately process the given {@link ApplicationEvent}. In contrast to ... *//** Create a new {@code TransactionalApplicationListener} for the given payload consumer, ... *//** Create a new {@code TransactionalApplicationListener} for the given payload consumer. ... */TransactionalApplicationListenerAdapter<PayloadApplicationEvent<T>> listenernew TransactionalApplicationListenerAdapter<PayloadApplicationEvent<T>>(...)setTransactionPhase(...)/** Callback to be invoked on synchronization-driven event processing, ... *//** Called before transactional event listener invocation. ... *//** Called after a transactional event listener invocation. ... *//** {@link TransactionalApplicationListener} adapter that delegates the processing of ... */new CopyOnWriteArrayList<SynchronizationCallback>(...)ApplicationListener<E> targetListener, ...;TransactionPhase transactionPhase, ...;String listenerId, ...;List<SynchronizationCallback> callbacks, ...;/** Construct a new TransactionalApplicationListenerAdapter. ... */this.targetListener/** Specify the synchronization order for the listener. *//** Return the synchronization order for the listener. *//** Specify the transaction phase to invoke the listener in. ... */this.transactionPhase/** Return the transaction phase to invoke the listener in. *//** Specify an id to identify the listener with. ... */this.listenerId/** Return an id to identify the listener with. */new TransactionalApplicationListenerSynchronization<E>(...)import ApplicationListenerMethodAdapterimport GenericApplicationListenerTransactionalEventListener annotation, ...;/** Construct a new TransactionalApplicationListenerMethodAdapter. ... */TransactionalEventListener annTransactionalEventListener.classphase(...)getDefaultListenerId(...)/** Determine the default id for the target listener, to be applied in case of ... */new TransactionalApplicationListenerSynchronization<ApplicationEvent>(...)fallbackExecution(...)TransactionPhase.AFTER_ROLLBACK// No transactional event execution at all/** {@link TransactionSynchronization} implementation for event processing with a ... */E event, ...;TransactionalApplicationListener<E> listener, ...;TransactionalApplicationListener<>.SynchronizationCallbackgetTransactionPhase(...)TransactionPhase.BEFORE_COMMITprocessEventWithCallbacks(...)TransactionPhase phaseTransactionPhase.AFTER_COMPLETIONnew Consumer<SynchronizationCallback>(...) { ... }preProcessEvent(...)postProcessEvent(...)/** An {@link EventListener} that is invoked according to a {@link TransactionPhase}. ... *//** Phase to bind the handling of an event to. ... *//** An optional identifier to uniquely reference the listener. ... *//** Whether the event should be processed if no transaction is running. *//** Spring Expression Language (SpEL) attribute used for making the event ... *//** {@link EventListenerFactory} implementation that handles {@link TransactionalEventListener} ... */new TransactionalApplicationListenerMethodAdapter(...)/** Spring's support for listening to transaction events. *//** Abstract implementation of {@link TransactionAttributeSource} that caches ... */new ConcurrentHashMap<Object,TransactionAttribute>(...)new DefaultTransactionAttribute(...) { ... }TransactionAttribute NULL_TRANSACTION_ATTRIBUTE, ...;/** Canonical value held in cache to indicate no transaction attribute was ... */Map<Object,TransactionAttribute> attributeCache, ...;/** Cache of TransactionAttributes, keyed by method on a specific target class. ... *//** Determine the transaction attribute for this method invocation. ... */TransactionAttribute cachedcomputeTransactionAttribute(...)String methodIdentificationDefaultTransactionAttribute dtaresolveAttributeStrings(...)/** Same signature as {@link #getTransactionAttribute}, but doesn't cache the result. ... *//** Subclasses need to implement this to return the transaction attribute for the ... *//** Should only public methods be allowed to have transactional semantics? ... */// First, see if we have a cached value.// Value will either be canonical value indicating there is no transaction attribute,// or an actual transaction attribute.// We need to work it out.// Put it in the cache.// Second try is the transaction attribute on the target class./** Advisor driven by a {@link TransactionAttributeSource}, used to include ... */new TransactionAttributeSourcePointcut(...) { ... }TransactionAttributeSource transactionAttributeSource, ...;TransactionAttributeSourcePointcut pointcut, ...;/** Set the transaction attribute source which is used to find transaction ... */this.transactionAttributeSource/** Composite {@link TransactionAttributeSource} implementation that iterates ... */...[] transactionAttributeSources, ...;/** Create a new CompositeTransactionAttributeSource for the given sources. ... */this.transactionAttributeSources/** Return the TransactionAttributeSource instances that this ... */TransactionAttributeSource source/** Spring's common transaction attribute implementation. ... */String timeoutString, ...;String qualifier, ...;Collection<String> labels, ...;/** Create a new DefaultTransactionAttribute, with default settings. ... *//** Copy constructor. Definition can be modified through bean property setters. ... *//** Create a new DefaultTransactionAttribute with the given ... *//** Set a descriptor for this transaction attribute, ... *//** Return a descriptor for this transaction attribute, ... *//** Set the timeout to apply, if any, ... */this.timeoutString/** Return the timeout to apply, if any, ... *//** Associate a qualifier value with this transaction attribute. ... */this.qualifier/** Return a qualifier value associated with this transaction attribute. ... *//** Associate one or more labels with this transaction attribute. ... */this.labels/** The default behavior is as with EJB: rollback on unchecked exception ... *//** Resolve attribute values that are defined as resolvable Strings: ... */Set<String> resolvedLabelsString label/** Return an identifying description for this transaction attribute. ... */getDefinitionDescription(...)/** {@link TransactionAttribute} implementation that delegates all calls to a given target ... */TransactionAttribute targetAttribute, ...;/** Create a DelegatingTransactionAttribute for the given target attribute. ... */this.targetAttributegetLabels(...)/** Very simple implementation of TransactionAttributeSource which will always return ... */TransactionAttribute transactionAttribute, ...;/** Allows a transaction attribute to be specified, using the String form, for ... */this.transactionAttributeMatchAlwaysTransactionAttributeSource otherTasotherTas.transactionAttributeMatchAlwaysTransactionAttributeSource.class/** Simple {@link TransactionAttributeSource} implementation that ... */new HashMap<Method,TransactionAttribute>(...)new HashMap<Method,String>(...)Map<String,TransactionAttribute> methodMap, ...;/** Map from method name to attribute value. */boolean eagerlyInitialized, ...;Map<Method,TransactionAttribute> transactionAttributeMap, ...;/** Map from Method to TransactionAttribute. */Map<Method,String> methodNameMap, ...;/** Map from Method to name pattern used for registration. *//** Set a name/attribute map, consisting of "FQCN.method" method names ... */this.methodMap/** Eagerly initializes the specified ... */initMethodMap(...)this.eagerlyInitialized/** Initialize the specified {@link #setMethodMap(java.util.Map) "methodMap"}, if any. ... */new BiConsumer<String,TransactionAttribute>(...) { ... }addTransactionalMethod(...)/** Add an attribute for a transactional method. ... */List<Method> matchingMethodsString regMethodNamethis.methodNameMapthis.transactionAttributeMapMethodMapTransactionAttributeSource otherTasotherTas.methodMapMethodMapTransactionAttributeSource.class// Register all matching methods// No already registered method name, or more specific// method name specification now -> (re-)register method.new HashMap<String,TransactionAttribute>(...)Map<String,TransactionAttribute> nameMap, ...;/** Parse the given properties into a name/attribute map. ... */TransactionAttributeEditor taenew TransactionAttributeEditor(...)Enumeration<?> propNames/** Determine if the given method name matches the mapped name. ... */NameMatchTransactionAttributeSource otherTas// Look for direct name match./** Tag subclass of {@link RollbackRuleAttribute} that has the opposite behavior ... *//** Create a new instance of the {@code NoRollbackRuleAttribute} class ... *//** Rule determining whether or not a given exception (and any subclasses) ... */RollbackRuleAttribute ROLLBACK_ON_RUNTIME_EXCEPTIONS, ...;/** The {@link RollbackRuleAttribute rollback rule} for ... */String exceptionName, ...;/** Could hold exception, resolving class name but would always require FQN. ... *//** Create a new instance of the {@code RollbackRuleAttribute} class. ... */this.exceptionName/** Create a new instance of the {@code RollbackRuleAttribute} class ... *//** Return the pattern for the exception name. *//** Return the depth of the superclass matching. ... */RollbackRuleAttribute rhsrhs.exceptionName/** TransactionAttribute implementation that works out whether a given exception ... */RuleBasedTransactionAttribute.classString PREFIX_ROLLBACK_RULE, ...;/** Prefix for rollback-on-exception rules in description strings. */String PREFIX_COMMIT_RULE, ...;/** Prefix for commit-on-exception rules in description strings. *//** Static for optimal serializability. */List<RollbackRuleAttribute> rollbackRules, ...;/** Create a new RuleBasedTransactionAttribute, with default settings. ... */this.rollbackRulesother.rollbackRules/** Set the list of {@code RollbackRuleAttribute} objects ... *//** Return the list of {@code RollbackRuleAttribute} objects ... *//** Winning rule is the shallowest rule (that is, the closest in the ... */RollbackRuleAttribute winnerint deepestRollbackRuleAttribute ruleint depthString signgetExceptionName(...)// User superclass behavior (rollback on unchecked) if no rule matches.import Tryimport Continuationimport AwaitKtimport ReactiveFlowKtimport ReactiveTransactionimport TransactionContextManagerimport CallbackPreferringPlatformTransactionManager/** Base class for transactional aspects, such as the {@link TransactionInterceptor} ... */new ConcurrentReferenceHashMap<Object,TransactionManager>(...)new ConcurrentReferenceHashMap<Method,ReactiveTransactionSupport>(...)TransactionAspectSupport.classnew NamedThreadLocal<TransactionInfo>(...)Object DEFAULT_TRANSACTION_MANAGER_KEY, ...;/** Key to use to store the default transaction manager. */// class for AspectJ aspects (which are not allowed to implement Serializable)!// NOTE: This class must not implement Serializable because it serves as baseboolean vavrPresent, ...;/** Vavr library present on the classpath? *//** Reactive Streams API present on the classpath? */ThreadLocal<TransactionInfo> transactionInfoHolder, ...;/** Holder to support the {@code currentTransactionStatus()} method, ... *//** Subclasses can use this to return the current TransactionInfo. ... *//** Return the transaction status of the current method invocation. ... */TransactionInfo infocurrentTransactionInfo(...)info.transactionStatusnew NoTransactionException(...)String transactionManagerBeanName, ...;ConcurrentMap<Object,TransactionManager> transactionManagerCache, ...;ConcurrentMap<Method,ReactiveTransactionSupport> transactionSupportCache, ...;/** Specify the name of the default transaction manager bean. ... */this.transactionManagerBeanName/** Return the name of the default transaction manager bean. *//** Specify the <em>default</em> transaction manager to use to drive transactions. ... *//** Return the default transaction manager, or {@code null} if unknown. ... *//** Set properties with method names as keys and transaction attribute ... */NameMatchTransactionAttributeSource tasnew NameMatchTransactionAttributeSource(...)/** Set multiple transaction attribute sources which are used to find transaction ... */new CompositeTransactionAttributeSource(...)/** Return the transaction attribute source. *//** Set the BeanFactory to use for retrieving {@code TransactionManager} beans. *//** Return the BeanFactory to use for retrieving {@code TransactionManager} beans. *//** Check that required properties were set. */getTransactionAttributeSource(...)/** General delegate for around-advice-based subclasses, delegating to several other template ... */TransactionAttributeSource tasdetermineTransactionManager(...)PlatformTransactionManager ptmasPlatformTransactionManager(...)String joinpointIdentificationmethodIdentification(...)boolean hasSuspendingFlowReturnTypeCoroutinesInvocationCallback corInvReactiveTransactionSupport txSupportthis.transactionSupportCachenew Function<Method,ReactiveTransactionSupport>(...) { ... }new ReactiveTransactionSupport(...)InvocationCallback callbackinvokeWithinTransaction(...)new InvocationCallback(...) { ... }Publisher<?> prawaitSingleOrNull(...)getContinuation(...)TransactionInfo txInfocreateTransactionIfNecessary(...)proceedWithInvocation(...)completeTransactionAfterThrowing(...)cleanupTransactionInfo(...)isVavrTry(...)evaluateTryFailure(...)commitTransactionAfterReturning(...)ThrowableHolder throwableHoldernew ThrowableHolder(...)prepareTransactionInfo(...)new ThrowableHolderException(...)throwableHolder.throwableThrowableHolderException exTransactionSystemException ex2initApplicationException(...)/** Clear the transaction manager cache. */this.transactionManagerCache/** Determine the specific transaction manager to use for the given transaction. */determineQualifiedTransactionManager(...)TransactionManager defaultTransactionManagerTransactionManager txManager/** Create a transaction if necessary based on the given TransactionAttribute. ... */new DelegatingTransactionAttribute(...) { ... }/** Prepare a TransactionInfo for the given attribute and status object. ... */new TransactionInfo(...)getJoinpointIdentification(...)newTransactionStatus(...)bindToThread(...)/** Execute after successful completion of call, but not after an exception was handled. ... *//** Handle a throwable, completing the transaction. ... */txInfo.transactionAttribute/** Reset the TransactionInfo ThreadLocal. ... */restoreThreadLocalStatus(...)/** Opaque object used to hold transaction information. Subclasses ... */String joinpointIdentification, ...;TransactionInfo oldTransactionInfo, ...;this.joinpointIdentification/** Return a String representation of this joinpoint (usually a Method call) ... *//** Return whether a transaction was created by this aspect, ... */this.oldTransactionInfo/** Simple callback interface for proceeding with the target invocation. ... *//** Coroutines-supporting extension of the callback interface. *//** Internal holder class for a Throwable in a callback transaction model. */Throwable throwable, ...;/** Internal holder class for a Throwable, used as a RuntimeException to be ... *//** Inner class to avoid a hard dependency on the Vavr library at runtime. *//** Delegate for Reactor-based management of transactional methods with a ... */ReactiveAdapter adapter, ...;getOrCreateContextHolder(...)getOrCreateContext(...)new Function<TransactionContext,Mono<? extends Object>>(...) { ... }new Function<ReactiveTransactionInfo,Mono<? extends Object>>(...) { ... }new Function<ReactiveTransactionInfo,Publisher<?>>(...) { ... }new BiFunction<ReactiveTransactionInfo,Throwable,Publisher<?>>(...) { ... }rollbackTransactionOnCancel(...)new Function<Throwable,Mono<? extends Object>>(...) { ... }new Function<TransactionContext,Publisher<? extends Object>>(...) { ... }new Function<ReactiveTransactionInfo,Publisher<? extends Object>>(...) { ... }new Function<Throwable,Publisher<? extends Object>>(...) { ... }TransactionAttribute attrToUseMono<ReactiveTransaction> txgetReactiveTransaction(...)new Function<ReactiveTransaction,ReactiveTransactionInfo>(...) { ... }new Supplier<Mono<? extends ReactiveTransactionInfo>>(...) { ... }ReactiveTransactionInfo txInfonew ReactiveTransactionInfo(...)newReactiveTransaction(...)/** Opaque object used to hold transaction information for reactive methods. */ReactiveTransactionManager transactionManager, ...;ReactiveTransaction reactiveTransaction, ...;this.reactiveTransaction// If the transaction attribute is null, the method is non-transactional.// Standard transaction demarcation with getTransaction and commit/rollback calls.// This is an around advice: Invoke the next interceptor in the chain.// This will normally result in a target object being invoked.// target invocation exception// Set rollback-only in case of Vavr failure matching our rollback rules...// It's a CallbackPreferringPlatformTransactionManager: pass a TransactionCallback in.// A RuntimeException: will lead to a rollback.// A normal return value: will lead to a commit.// Check result state: It might indicate a Throwable to rethrow.// Do not attempt to lookup tx manager if no tx attributes are set// If no name specified, apply method identification as transaction name.// We need a transaction for this method...// The transaction manager will flag an error if an incompatible tx already exists.// The TransactionInfo.hasTransaction() method will return false. We created it only// to preserve the integrity of the ThreadLocal stack maintained in this class.// We always bind the TransactionInfo to the thread, even if we didn't create// a new transaction here. This guarantees that the TransactionInfo stack// will be managed correctly even if no transaction was created by this aspect.// We don't roll back on this exception.// Will still roll back if TransactionStatus.isRollbackOnly() is true.// Expose current TransactionStatus, preserving any existing TransactionStatus// for restoration after this transaction is complete.// Use stack to restore old transaction TransactionInfo.// Will be null if none was set.// For Mono and suspending functions not returning kotlinx.coroutines.flow.Flow// Need re-wrapping until we get hold of the exception through usingWhen.// Any other reactive type, typically a Flux/** This interface adds a {@code rollbackOn} specification to {@link TransactionDefinition}. ... *//** Return labels associated with this transaction attribute. ... *//** Should we roll back on the given exception? ... *//** PropertyEditor for {@link TransactionAttribute} objects. Accepts a String of form ... *//** Format is PROPAGATION_NAME,ISOLATION_NAME,readOnly,timeout_NNNN,+Exception1,-Exception2. ... */RuleBasedTransactionAttribute attrString trimmedTokenRuleBasedTransactionAttribute.PREFIX_TIMEOUTDefaultTransactionAttribute.PREFIX_TIMEOUTRuleBasedTransactionAttribute.READ_ONLY_MARKERRuleBasedTransactionAttribute.PREFIX_COMMIT_RULEgetRollbackRules(...)RuleBasedTransactionAttribute.PREFIX_ROLLBACK_RULE// tokenize it with ","// Trim leading and trailing whitespace.// Check whether token contains illegal whitespace within text.// Check token type.// placeholders expected to be pre-resolved/** Strategy interface used by {@link TransactionInterceptor} for metadata retrieval. ... *//** Return the transaction attribute for the given method, ... */TransactionInterceptor transactionInterceptor, ...;/** Create a new TransactionAttributeSourceAdvisor. *//** Create a new TransactionAttributeSourceAdvisor. ... */setTransactionInterceptor(...)/** Set the transaction interceptor to use for this advisor. */this.transactionInterceptor/** Property editor that converts a String into a {@link TransactionAttributeSource}. ... */MethodMapTransactionAttributeSource sourcenew MethodMapTransactionAttributeSource(...)PropertiesEditor propertiesEditor// Use properties editor to tokenize the hold string.// Now we have properties, process each one individually.// Convert value to a transaction attribute.// Register name and attribute./** Abstract class that implements a Pointcut that matches if the underlying ... */new TransactionAttributeSourceClassFilter(...)TransactionAttributeSourcePointcut otherPcTransactionAttributeSourcePointcut.class/** Obtain the underlying TransactionAttributeSource (may be {@code null}). ... *//** {@link ClassFilter} that delegates to {@link TransactionAttributeSource#isCandidateClass} ... */TransactionalProxy.class/** AOP Alliance MethodInterceptor for declarative transaction ... *//** Create a new TransactionInterceptor. ... */setTransactionAttributes(...)new CoroutinesInvocationCallback(...) { ... }getTransactionManagerBeanName(...)setTransactionManagerBeanName(...)// Work out the target class: may be {@code null}.// The TransactionAttributeSource should be passed the target class// as well as the method, which may be from an interface.// Adapt to TransactionAspectSupport's invokeWithinTransaction...// Rely on default serialization, although this class itself doesn't carry state anyway...// Deserialize superclass fields.// Serialize all relevant superclass fields.// Superclass can't implement Serializable because it also serves as base class// for AspectJ aspects (which are not allowed to implement Serializable)!/** Proxy factory bean for simplified declarative transaction handling. ... *//** Set the default transaction manager. This will perform actual ... *//** Set a pointcut, i.e a bean that can cause conditional invocation ... *//** This callback is optional: If running in a BeanFactory and no transaction ... *//** Creates an advisor for this FactoryBean's TransactionInterceptor. */new TransactionAttributeSourceAdvisor(...)/** As of 4.2, this method adds {@link TransactionalProxy} to the set of ... */// Rely on default pointcut./** A marker interface for manually created transactional proxies. ... *//** AOP-based solution for declarative transaction demarcation. ... *//** Adapter for a JTA Synchronization, invoking the {@code afterCommit} / ... */List<TransactionSynchronization> synchronizations, ...;/** Create a new JtaAfterCompletionSynchronization for the given synchronization objects. ... */this.synchronizationsStatus.STATUS_COMMITTEDinvokeAfterCommit(...)Status.STATUS_ROLLEDBACKimport HeuristicMixedExceptionimport HeuristicRollbackExceptionimport InvalidTransactionExceptionimport HeuristicCompletionExceptionimport TransactionSuspensionNotSupportedExceptionString DEFAULT_USER_TRANSACTION_NAME, ...;/** Default JNDI location for the JTA UserTransaction. Many Java EE servers ... */...[] FALLBACK_TRANSACTION_MANAGER_NAMES, ...;/** Fallback JNDI locations for the JTA TransactionManager. Applied if ... */String DEFAULT_TRANSACTION_SYNCHRONIZATION_REGISTRY_NAME, ...;/** Standard Java EE 5 JNDI location for the JTA TransactionSynchronizationRegistry. ... */String userTransactionName, ...;boolean autodetectUserTransaction, ...;boolean cacheUserTransaction, ...;boolean userTransactionObtainedFromJndi, ...;String transactionManagerName, ...;boolean autodetectTransactionManager, ...;String transactionSynchronizationRegistryName, ...;boolean autodetectTransactionSynchronizationRegistry, ...;boolean allowCustomIsolationLevels, ...;/** Create a new JtaTransactionManager instance, to be configured as bean. ... *//** Create a new JtaTransactionManager instance. ... */buildUserTransaction(...)/** Set the JndiTemplate to use for JNDI lookups. ... *//** Return the JndiTemplate used for JNDI lookups. *//** Set the JTA UserTransaction to use as direct reference. ... *//** Return the JTA UserTransaction that this transaction manager uses. *//** Set the JNDI name of the JTA UserTransaction. ... */this.userTransactionName/** Set whether to autodetect the JTA UserTransaction at its default ... */this.autodetectUserTransaction/** Set whether to cache the JTA UserTransaction object fetched from JNDI. ... */this.cacheUserTransaction/** Set the JTA TransactionManager to use as direct reference. ... *//** Return the JTA TransactionManager that this transaction manager uses, if any. *//** Set the JNDI name of the JTA TransactionManager. ... */this.transactionManagerName/** Set whether to autodetect a JTA UserTransaction object that implements ... */this.autodetectTransactionManager/** Set the JTA 1.1 TransactionSynchronizationRegistry to use as direct reference. ... *//** Return the JTA 1.1 TransactionSynchronizationRegistry that this transaction manager uses, if any. *//** Set the JNDI name of the JTA 1.1 TransactionSynchronizationRegistry. ... */this.transactionSynchronizationRegistryName/** Set whether to autodetect a JTA 1.1 TransactionSynchronizationRegistry object ... */this.autodetectTransactionSynchronizationRegistry/** Set whether to allow custom isolation levels to be specified. ... */this.allowCustomIsolationLevels/** Initialize the UserTransaction as well as the TransactionManager handle. ... */initUserTransactionAndTransactionManager(...)checkUserTransactionAndTransactionManager(...)initTransactionSynchronizationRegistry(...)lookupUserTransaction(...)this.userTransactionObtainedFromJndiretrieveUserTransaction(...)findUserTransaction(...)lookupTransactionManager(...)findTransactionManager(...)/** Check the UserTransaction as well as the TransactionManager handle, ... *//** Initialize the JTA 1.1 TransactionSynchronizationRegistry, if available. ... */lookupTransactionSynchronizationRegistry(...)retrieveTransactionSynchronizationRegistry(...)findTransactionSynchronizationRegistry(...)/** Build a UserTransaction handle based on the given TransactionManager. ... *//** Look up the JTA UserTransaction in JNDI via the configured name. ... *//** Look up the JTA TransactionManager in JNDI via the configured name. ... *//** Look up the JTA 1.1 TransactionSynchronizationRegistry in JNDI via the configured name. ... */TransactionSynchronizationRegistry.class/** Allows subclasses to retrieve the JTA UserTransaction in a vendor-specific manner. ... *//** Allows subclasses to retrieve the JTA TransactionManager in a vendor-specific manner. ... *//** Allows subclasses to retrieve the JTA 1.1 TransactionSynchronizationRegistry ... *//** Find the JTA UserTransaction through a default JNDI lookup: ... */UserTransaction ut/** Find the JTA TransactionManager through autodetection: checking whether the ... *//** Find the JTA 1.1 TransactionSynchronizationRegistry through autodetection: ... */TransactionSynchronizationRegistry tsr/** This implementation returns a JtaTransactionObject instance for the ... */doGetJtaTransaction(...)/** Get a JTA transaction object for the given current UserTransaction. ... */new JtaTransactionObject(...)JtaTransactionObject txObject/** This implementation returns false to cause a further invocation ... */doJtaBegin(...)/** Perform a JTA begin on the JTA UserTransaction or TransactionManager. ... */applyIsolationLevel(...)/** Apply the given transaction isolation level. The default implementation ... *//** Apply the given transaction timeout. The default implementation will call ... */setTransactionTimeout(...)txObject.resetTransactionTimeoutdoJtaSuspend(...)/** Perform a JTA suspend on the JTA TransactionManager. ... */new TransactionSuspensionNotSupportedException(...)doJtaResume(...)InvalidTransactionException ex/** Perform a JTA resume on the JTA TransactionManager. ... *//** This implementation returns "true": a JTA commit will properly handle ... */int jtaStatusHeuristicMixedException exnew HeuristicCompletionException(...)HeuristicCompletionException.STATE_MIXEDHeuristicRollbackException exHeuristicCompletionException.STATE_ROLLED_BACKdoRegisterAfterCompletionWithJtaTransaction(...)/** Register a JTA synchronization on the JTA TransactionManager, for calling ... */new JtaAfterCompletionSynchronization(...)Transaction transaction// Implementation of TransactionFactory interfacenew ManagedTransactionAdapter(...)// Fetch JTA UserTransaction from JNDI, if necessary.// Autodetect UserTransaction at its default JNDI location.// Fetch JTA TransactionManager from JNDI, if necessary.// Autodetect UserTransaction object that implements TransactionManager,// and check fallback JNDI locations otherwise.// If only JTA TransactionManager specified, create UserTransaction handle for it.// We at least need the JTA UserTransaction.// For transaction suspension, the JTA TransactionManager is necessary too.// Fetch JTA TransactionSynchronizationRegistry from JNDI, if necessary.// Autodetect in JNDI if applicable, and check UserTransaction/TransactionManager// object that implements TransactionSynchronizationRegistry otherwise.// Check fallback JNDI locations.// OK, so no JTA TransactionManager is available...// UserTransaction has already been obtained from JNDI, so the// TransactionSynchronizationRegistry probably sits there as well.// Check whether the UserTransaction or TransactionManager implements it...// OK, so no JTA 1.1 TransactionSynchronizationRegistry is available...// Should never happen... would have thrown an exception before// and as a consequence led to a rollback, not to a commit call.// In any case, the transaction is already fully cleaned up.// Only really happens on JBoss 4.2 in case of an early timeout...// Explicit rollback call necessary to clean up the transaction.// IllegalStateException expected on JBoss; call still necessary.// Note: JBoss throws plain RuntimeException with RollbackException as cause.// JTA 1.1 TransactionSynchronizationRegistry available - use it.// At least the JTA TransactionManager available - use that one.// No JTA TransactionManager available - log a warning.// Create template for client-side JNDI lookup.// Perform a fresh lookup for JTA handles./** JTA transaction object, representing a {@link javax.transaction.UserTransaction}. ... */boolean resetTransactionTimeout, ...;/** Create a new JtaTransactionObject for the given JTA UserTransaction. ... *//** Return the JTA UserTransaction object for the current transaction. *//** This implementation checks the UserTransaction's rollback-only flag. */Status.STATUS_MARKED_ROLLBACK/** This implementation triggers flush callbacks, ... *//** Adapter for a managed JTA Transaction handle, taking a JTA ... *//** Create a new ManagedTransactionAdapter for the given TransactionManager. ... *//** Return the JTA TransactionManager that this adapter delegates to. */delistResource(...)/** Default implementation of the {@link TransactionFactory} strategy interface, ... *//** Create a new SimpleTransactionFactory for the given TransactionManager. ... *//** Adapter that implements the JTA {@link javax.transaction.Synchronization} ... */SpringJtaSynchronizationAdapter.classTransactionSynchronization springSynchronization, ...;UserTransaction jtaTransaction, ...;/** Create a new SpringJtaSynchronizationAdapter for the given Spring ... */this.springSynchronizationthis.jtaTransaction/** JTA {@code beforeCompletion} callback: just invoked before commit. ... */boolean readOnlysetRollbackOnlyIfPossible(...)/** Set the underlying JTA transaction to rollback-only. *//** JTA {@code afterCompletion} callback: invoked after commit/rollback. ... */// Process Spring's beforeCompletion early, in order to avoid issues// with strict JTA implementations that issue warnings when doing JDBC// operations after transaction completion (e.g. Connection.getWarnings).// Probably Hibernate's WebSphereExtendedJTATransactionLookup pseudo JTA stuff...// beforeCompletion not called before (probably because of JTA rollback).// Perform the cleanup here.// Call afterCompletion with the appropriate status indication./** Strategy interface for creating JTA {@link javax.transaction.Transaction} ... *//** Create an active Transaction object based on the given name and timeout. ... *//** Determine whether the underlying transaction manager supports XA transactions ... *//** Adapter for a JTA UserTransaction handle, taking a JTA ... *//** Create a new UserTransactionAdapter for the given TransactionManager. ... *//** Special {@link JtaTransactionManager} variant for BEA WebLogic (9.0 and higher). ... */String USER_TRANSACTION_CLASS_NAME, ...;String CLIENT_TRANSACTION_MANAGER_CLASS_NAME, ...;String TRANSACTION_CLASS_NAME, ...;String TRANSACTION_HELPER_CLASS_NAME, ...;String ISOLATION_LEVEL_KEY, ...;boolean weblogicUserTransactionAvailable, ...;Method beginWithNameMethod, ...;Method beginWithNameAndTimeoutMethod, ...;boolean weblogicTransactionManagerAvailable, ...;Method forceResumeMethod, ...;Method setPropertyMethod, ...;Object transactionHelper, ...;loadWebLogicTransactionClasses(...)Object helperloadWebLogicTransactionHelper(...)Method getUserTransactionMethodthis.transactionHelperMethod getTransactionManagerMethodClass<?> transactionHelperClassMethod getTransactionHelperMethodClass<?> userTransactionClassClass<?> transactionManagerClassthis.weblogicUserTransactionAvailablethis.beginWithNameMethodthis.beginWithNameAndTimeoutMethodthis.weblogicTransactionManagerAvailableClass<?> transactionClassthis.forceResumeMethodthis.setPropertyMethodTransaction txobtainTransactionManager(...)Integer isolationLevelInvocationTargetException ex2// Obtain WebLogic ClientTransactionManager interface.// Apply transaction name (if any) to WebLogic transaction./* weblogic.transaction.UserTransaction wut = (weblogic.transaction.UserTransaction) ut; ... */// No WebLogic UserTransaction available or no transaction name specified// -> standard JTA begin call.// Specify isolation level, if any, through corresponding WebLogic transaction property./* weblogic.transaction.Transaction wtx = (weblogic.transaction.Transaction) tx; ... *//* weblogic.transaction.TransactionManager wtm = ... */// No name specified - standard JTA is sufficient.import UOWSynchronizationRegistryimport UOWActionimport UOWActionExceptionimport UOWExceptionimport UOWManagerimport UOWManagerFactoryimport InvalidTimeoutException/** WebSphere-specific PlatformTransactionManager implementation that delegates ... */String DEFAULT_UOW_MANAGER_NAME, ...;/** Default JNDI location for the WebSphere UOWManager. ... */UOWManager uowManager, ...;String uowManagerName, ...;/** Create a new WebSphereUowTransactionManager. */setAutodetectTransactionManager(...)/** Create a new WebSphereUowTransactionManager for the given UOWManager. ... */this.uowManager/** Set the WebSphere UOWManager to use as direct reference. ... *//** Set the JNDI name of the WebSphere UOWManager. ... */this.uowManagerNamelookupUowManager(...)lookupDefaultUowManager(...)/** Look up the WebSphere UOWManager in JNDI via the configured name. ... */UOWManager.class/** Obtain the WebSphere UOWManager from the default JNDI location ... */getUOWManager(...)/** Registers the synchronizations as interposed JTA Synchronization on the UOWManager. */obtainUOWManager(...)/** Returns {@code true} since WebSphere ResourceAdapters (as exposed in JNDI) ... */TransactionDefinition defUOWManager uowManagerint pbboolean existingTxgetUOWStatus(...)UOWSynchronizationRegistry.UOW_STATUS_NONEgetUOWType(...)UOWSynchronizationRegistry.UOW_TYPE_LOCAL_TRANSACTIONint uowTypeUOWSynchronizationRegistry.UOW_TYPE_GLOBAL_TRANSACTIONboolean joinTxboolean newSynchSuspendedResourcesHolder suspendedResourcesUOWActionAdapter<T> actionnew InvalidTimeoutException(...)getTransactionSynchronization(...)boolean actualTransactionUOWManager.UOW_TYPE_GLOBAL_TRANSACTIONsetUOWTimeout(...)new UOWActionAdapter<T>(...)runUnderUOW(...)Throwable appEx/** Adapter that executes the given Spring transaction within the WebSphere UOWAction shape. */TransactionDefinition definition, ...;TransactionCallback<T> callback, ...;boolean actualTransaction, ...;boolean newTransaction, ...;boolean newSynchronization, ...;boolean debug, ...;T result, ...;this.callbackthis.actualTransactionthis.newTransactionthis.newSynchronizationthis.debugDefaultTransactionStatus statusprepareTransactionStatus(...)triggerBeforeCommit(...)isLocalRollbackOnly(...)triggerBeforeCompletion(...)isNewSynchronization(...)List<TransactionSynchronization> synchronizations// Fetch UOWManager handle from JNDI, if necessary.// Use defaults if no transaction definition given./** Transaction SPI implementation for JTA. *//** Spring's core transaction management APIs (independent of any specific transaction ... *//** Abstract base class that implements Spring's standard reactive transaction workflow, ... *//** This implementation handles propagation behavior. Delegates to ... */// Implementation of ReactiveTransactionManagernew Function<TransactionSynchronizationManager,Mono<? extends ReactiveTransaction>>(...) { ... }Object transactiondoGetTransaction(...)isExistingTransaction(...)handleExistingTransaction(...)new Function<TransactionContext,TransactionSynchronizationManager>(...) { ... }new TransactionSynchronizationManager(...)new Function<TransactionSynchronizationManager,Mono<? extends GenericReactiveTransaction>>(...) { ... }new Function<SuspendedResourcesHolder,Optional<SuspendedResourcesHolder>>(...) { ... }new Function<Optional<SuspendedResourcesHolder>,Mono<? extends GenericReactiveTransaction>>(...) { ... }ErrorPredicates.RUNTIME_OR_ERRORnew Supplier<Mono<? extends GenericReactiveTransaction>>(...) { ... }GenericReactiveTransaction statusdoBegin(...)prepareSynchronization(...)new Function<Throwable,Mono<? extends GenericReactiveTransaction>>(...) { ... }prepareReactiveTransaction(...)/** Create a ReactiveTransaction for an existing transaction. */Mono<SuspendedResourcesHolder> suspendReactiveTransaction.classnew Function<SuspendedResourcesHolder,GenericReactiveTransaction>(...) { ... }new Supplier<GenericReactiveTransaction>(...) { ... }Mono<SuspendedResourcesHolder> suspendedResourcesnew Function<SuspendedResourcesHolder,Mono<? extends ReactiveTransaction>>(...) { ... }resumeAfterBeginException(...)/** Create a new ReactiveTransaction for the given arguments, ... *//** Create a ReactiveTransaction instance for the given arguments. */new GenericReactiveTransaction(...)/** Initialize transaction synchronization as appropriate. */setActualTransactionActive(...)setCurrentTransactionIsolationLevel(...)setCurrentTransactionReadOnly(...)setCurrentTransactionName(...)/** Suspend the given transaction. Suspends transaction synchronization first, ... */Mono<List<TransactionSynchronization>> suspendedSynchronizationsdoSuspendSynchronization(...)new Function<List<TransactionSynchronization>,Mono<? extends SuspendedResourcesHolder>>(...) { ... }Mono<Optional<Object>> suspendedResourcesdoSuspend(...)new Function<Object,Optional<Object>>(...) { ... }new Function<Optional<Object>,SuspendedResourcesHolder>(...) { ... }boolean wasActivenew Function<Throwable,Mono<? extends SuspendedResourcesHolder>>(...) { ... }doResumeSynchronization(...)SuspendedResourcesHolder.class/** Resume the given transaction. Delegates to the {@code doResume} ... */Mono<Void> resumeObject suspendedResourcesresourcesHolder.suspendedResourcesList<TransactionSynchronization> suspendedSynchronizationsresourcesHolder.suspendedSynchronizationsdoResume(...)resourcesHolder.wasActiveresourcesHolder.isolationLevelresourcesHolder.readOnlyresourcesHolder.name/** Resume outer transaction after inner transaction begin failed. */String exMessage/** Suspend all current synchronizations and deactivate transaction ... */new Function<TransactionSynchronization,Publisher<? extends Void>>(...) { ... }new Supplier<Mono<? extends List<TransactionSynchronization>>>(...) { ... }/** Reactivate transaction synchronization for the current transaction context ... *//** This implementation of commit handles participating in existing ... */GenericReactiveTransaction reactiveTxprocessRollback(...)processCommit(...)/** Process an actual commit. ... */AtomicBoolean beforeCompletionInvokedMono<Object> commitprepareForCommit(...)Mono<Object> propagateExceptionErrorPredicates.UNEXPECTED_ROLLBACKtriggerAfterCompletion(...)ErrorPredicates.TRANSACTION_EXCEPTIONMono<Void> monodoRollbackOnCommitException(...)triggerAfterCommit(...)cleanupAfterCompletion(...)/** This implementation of rollback handles participating in existing transactions. ... *//** Process an actual rollback. ... */doRollback(...)Mono<Void> beforeCompletiondoSetRollbackOnly(...)/** Invoke {@code doRollback}, handling rollback exceptions properly. ... *//** Trigger {@code beforeCommit} callbacks. ... *//** Trigger {@code beforeCompletion} callbacks. ... *//** Trigger {@code afterCommit} callbacks. ... *//** Trigger {@code afterCompletion} callbacks. ... */registerAfterCompletionWithExistingTransaction(...)/** Actually invoke the {@code afterCompletion} methods of the ... *//** Clean up after completion, clearing synchronization if necessary, ... */Mono<Void> cleanupsetCompleted(...)doCleanupAfterCompletion(...)getSuspendedResources(...)/** Return a transaction object for the current transaction state. ... */// Template methods to be implemented in subclasses/** Check if the given transaction object indicates an existing transaction ... *//** Begin a new transaction with semantics according to the given transaction ... *//** Suspend the resources of the current transaction. ... *//** Resume the resources of the current transaction. ... *//** Make preparations for commit, to be performed before the ... *//** Perform an actual commit of the given transaction. ... *//** Perform an actual rollback of the given transaction. ... *//** Set the given transaction rollback-only. Only called on rollback ... *//** Register the given list of transaction synchronizations with the existing transaction. ... *//** Cleanup resources after transaction completion. ... */Object suspendedResources, ...;List<TransactionSynchronization> suspendedSynchronizations, ...;boolean wasActive, ...;this.suspendedResourcesthis.suspendedSynchronizationsthis.wasActive/** Predicates for exception types that transactional error handling applies to. */new ErrorPredicates(...) { ... }/** Predicate matching {@link RuntimeException} or {@link Error}. *//** Predicate matching {@link TransactionException}. *//** Predicate matching {@link UnexpectedRollbackException}. */ErrorPredicates RUNTIME_OR_ERROR, ...;ErrorPredicates TRANSACTION_EXCEPTION, ...;ErrorPredicates UNEXPECTED_ROLLBACK, ...;// Cache debug flag to avoid repeated checks.// Existing transaction found -> check propagation behavior to find out how to behave.// Check definition settings for new transaction.// No existing transaction found -> check propagation behavior to find out how to proceed.// Create "empty" transaction: no actual transaction, but potentially synchronization.// Nested transaction through nested begin and commit/rollback calls.// Assumably PROPAGATION_SUPPORTS or PROPAGATION_REQUIRED.// Transaction active but no synchronization active.// Neither transaction nor synchronization active.// Store result in a local variable in order to appease the// Eclipse compiler with regard to inferred generics.// Participating in larger transaction// No transaction or new transaction for the current scope ->// invoke the afterCompletion callbacks immediately// Existing transaction that we participate in, controlled outside// of the scope of this Spring transaction manager -> try to register// an afterCompletion callback with the existing (JTA) transaction./** Default implementation of the {@link ReactiveTransaction} interface, ... */Object transaction, ...;/** Create a new {@code DefaultReactiveTransactionStatus} instance. ... *//** Return the underlying transaction object. ... *//** Return whether there is an actual transaction active. *//** Return if a new transaction synchronization has been opened ... *//** Return if this transaction is defined as read-only transaction. *//** Return whether the progress of this transaction is debugged. This is used by ... *//** Return the holder for resources that have been suspended for this transaction, ... *//** Determine the rollback-only flag via checking this ReactiveTransactionStatus. ... *//** Mark this transaction as completed, that is, committed or rolled back. *//** {@link TransactionSynchronization} implementation that manages a ... */O resourceObject, ...;K resourceKey, ...;TransactionSynchronizationManager synchronizationManager, ...;/** Create a new ReactiveResourceSynchronization for the given holder. ... */this.resourceObjectthis.resourceKeythis.synchronizationManagershouldUnbindAtCompletion(...)shouldReleaseBeforeCompletion(...)releaseResource(...)processResourceAfterCommit(...)Mono<Void> syncboolean releaseNecessaryshouldReleaseAfterCompletion(...)cleanupResource(...)/** Return whether this holder should be unbound at completion ... *//** Return whether this holder's resource should be released before ... *//** Return whether this holder's resource should be released after ... *//** After-commit callback for the given resource holder. ... *//** Release the given resource (after it has been unbound from the thread). ... *//** Perform a cleanup on the given resource (which is left bound to the thread). ... */// The thread-bound resource holder might not be available anymore,// Probably a pre-bound resource.../** Callback interface for reactive transactional code. Used with {@link TransactionalOperator}'s ... *//** Gets called by {@link TransactionalOperator} within a transactional context. ... *//** Mutable transaction context that encapsulates transactional synchronizations and ... */TransactionContext parent, ...;UUID contextId, ...;Map<Object,Object> resources, ...;Set<TransactionSynchronization> synchronizations, ...;String currentTransactionName, ...;boolean currentTransactionReadOnly, ...;Integer currentTransactionIsolationLevel, ...;boolean actualTransactionActive, ...;this.currentTransactionNamethis.contextIdthis.currentTransactionReadOnlythis.currentTransactionIsolationLevelthis.actualTransactionActive/** Mutable holder for reactive transaction {@link TransactionContext contexts}. ... */Deque<TransactionContext> transactionStack, ...;this.transactionStack/** Return the current {@link TransactionContext}. ... */TransactionContext context/** Create a new {@link TransactionContext}. *//** Check whether the holder has a {@link TransactionContext}. ... *//** Delegate to register and obtain transactional contexts. ... *//** Obtain the current {@link TransactionContext} from the subscriber context or the ... */new Function<ContextView,Mono<? extends TransactionContext>>(...) { ... }TransactionContextHolder.classTransactionContextHolder holderhasContext(...)new NoTransactionInContextException(...)/** Create a {@link TransactionContext} and register it in the subscriber {@link Context}. ... */new Function<Context,Context>(...) { ... }/** Return a {@link Function} to create or associate a new {@link TransactionContext}. ... *//** Return a {@link Function} to create or associate a new ... */new TransactionContextHolder(...)new ArrayDeque<TransactionContext>(...)/** Stackless variant of {@link NoTransactionException} for reactive flows. */// stackless exception/** Interface for reactive transaction synchronization callbacks. ... */int STATUS_COMMITTED, ...;/** Completion status in case of proper commit. */int STATUS_ROLLED_BACK, ...;/** Completion status in case of proper rollback. */int STATUS_UNKNOWN, ...;/** Completion status in case of heuristic mixed completion or system errors. *//** Suspend this synchronization. ... *//** Resume this synchronization. ... *//** Invoked before transaction commit (before "beforeCompletion"). ... *//** Invoked before transaction commit/rollback. ... *//** Invoked after transaction commit. Can perform further operations right ... *//** Invoked after transaction commit/rollback. ... *//** Central delegate that manages resources and transaction synchronizations per ... */TransactionSynchronizationManager.classTransactionContext transactionContext, ...;this.transactionContext/** Get the {@link TransactionSynchronizationManager} that is associated with ... *//** Check if there is a resource for the given key bound to the current thread. ... */Object actualKeydoGetResource(...)/** Retrieve a resource for the given key that is bound to the current thread. ... *//** Actually check the value of the resource that is bound for the given key. *//** Bind the given resource for the given key to the current context. ... *//** Unbind a resource for the given key from the current context. ... */doUnbindResource(...)/** Actually remove the value of the resource that is bound for the given key. *//** Return if transaction synchronization is active for the current context. ... */// Management of transaction synchronizations/** Activate transaction synchronization for the current context. ... */setSynchronizations(...)new LinkedHashSet<TransactionSynchronization>(...)/** Register a new transaction synchronization for the current context. ... */Set<TransactionSynchronization> synchs/** Return an unmodifiable snapshot list of all registered synchronizations ... */List<TransactionSynchronization> sortedSynchsnew ArrayList<TransactionSynchronization>(...)/** Deactivate transaction synchronization for the current context. ... *//** Expose the name of the current transaction, if any. ... */// Exposure of transaction characteristics/** Return the name of the current transaction, or {@code null} if none set. ... *//** Expose a read-only flag for the current transaction. ... *//** Return whether the current transaction is marked as read-only. ... *//** Expose an isolation level for the current transaction. ... *//** Return the isolation level for the current transaction, if any. ... *//** Expose whether there currently is an actual transaction active. ... *//** Return whether there currently is an actual transaction active. ... *//** Clear the entire transaction synchronization state: ... */// Return unmodifiable snapshot, to avoid ConcurrentModificationExceptions// while iterating and invoking synchronization callbacks that in turn// might register further synchronizations.// Sort lazily here, not in registerSynchronization./** Utility methods for triggering specific {@link TransactionSynchronization} ... */TransactionSynchronizationUtils.classboolean aopAvailable, ...;/** Unwrap the given resource handle if necessary; otherwise return ... */Object resourceRefgetWrappedObject(...)unwrapIfNecessary(...)/** Actually invoke the {@code triggerBeforeCommit} methods of the ... *//** Actually invoke the {@code beforeCompletion} methods of the ... */onErrorContinue(...)new BiConsumer<Throwable,Object>(...) { ... }/** Actually invoke the {@code afterCommit} methods of the ... *//** Inner class to avoid hard-coded dependency on AOP module. */// unwrap infrastructure proxy// now unwrap scoped proxy/** Operator class that simplifies programmatic transaction demarcation and ... *//** Wrap the functional sequence specified by the given Flux within a transaction. ... */new TransactionCallback<T>(...) { ... }/** Wrap the functional sequence specified by the given Mono within a transaction. ... *//** Execute the action specified by the given callback object within a transaction. ... *//** Create a new {@link TransactionalOperator} using {@link ReactiveTransactionManager}, ... *//** Create a new {@link TransactionalOperator} using {@link ReactiveTransactionManager} ... */new TransactionalOperatorImpl(...)TransactionalOperatorImpl.class/** Construct a new TransactionTemplate using the given transaction manager, ... *//** Return the transaction management strategy to be used. */new Function<TransactionContext,Mono<? extends T>>(...) { ... }Mono<ReactiveTransaction> statusnew Function<ReactiveTransaction,Mono<? extends T>>(...) { ... }new Function<ReactiveTransaction,Publisher<?>>(...) { ... }new BiFunction<ReactiveTransaction,Throwable,Publisher<?>>(...) { ... }new Function<Throwable,Mono<? extends T>>(...) { ... }new Function<TransactionContext,Publisher<? extends T>>(...) { ... }new Function<ReactiveTransaction,Publisher<? extends T>>(...) { ... }new Function<Throwable,Publisher<? extends T>>(...) { ... }// Need re-wrapping of ReactiveTransaction until we get hold of the exception// through usingWhen./** Support classes for reactive transaction management. ... *//** Abstract base class that implements Spring's standard transaction workflow, ... */AbstractPlatformTransactionManager.classint SYNCHRONIZATION_ALWAYS, ...;/** Always activate transaction synchronization, even for "empty" transactions ... */int SYNCHRONIZATION_ON_ACTUAL_TRANSACTION, ...;/** Activate transaction synchronization only for actual transactions, ... */int SYNCHRONIZATION_NEVER, ...;/** Never active transaction synchronization, not even for actual transactions. *//** Constants instance for AbstractPlatformTransactionManager. */int transactionSynchronization, ...;int defaultTimeout, ...;boolean nestedTransactionAllowed, ...;boolean validateExistingTransaction, ...;boolean globalRollbackOnParticipationFailure, ...;boolean failEarlyOnGlobalRollbackOnly, ...;boolean rollbackOnCommitFailure, ...;/** Set the transaction synchronization by the name of the corresponding constant ... *//** Set when this transaction manager should activate the thread-bound ... */this.transactionSynchronization/** Return if this transaction manager should activate the thread-bound ... *//** Specify the default timeout that this transaction manager should apply ... */this.defaultTimeout/** Return the default timeout that this transaction manager should apply ... *//** Set whether nested transactions are allowed. Default is "false". ... */this.nestedTransactionAllowed/** Return whether nested transactions are allowed. *//** Set whether existing transactions should be validated before participating ... */this.validateExistingTransaction/** Return whether existing transactions should be validated before participating ... *//** Set whether to globally mark an existing transaction as rollback-only ... */this.globalRollbackOnParticipationFailure/** Return whether to globally mark an existing transaction as rollback-only ... *//** Set whether to fail early in case of the transaction being globally marked ... */this.failEarlyOnGlobalRollbackOnly/** Return whether to fail early in case of the transaction being globally marked ... *//** Set whether {@code doRollback} should be performed on failure of the ... */this.rollbackOnCommitFailure/** Return whether {@code doRollback} should be performed on failure of the ... */// Implementation of PlatformTransactionManagerboolean newSynchronization/** Start a new transaction. *//** Create a TransactionStatus for an existing transaction. */Throwable beginExuseSavepointForNestedTransaction(...)createAndHoldSavepoint(...)isValidateExistingTransaction(...)Integer currentIsolationLevelConstants isoConstantsDefaultTransactionDefinition.constants/** Create a new TransactionStatus for the given arguments, ... *//** Create a TransactionStatus instance for the given arguments. */boolean actualNewSynchronizationnew DefaultTransactionStatus(...)getDefaultTimeout(...)Throwable resumeExTransactionSynchronization synchronization/** Reactivate transaction synchronization for the current thread ... */DefaultTransactionStatus defStatusisGlobalRollbackOnly(...)shouldCommitOnGlobalRollbackOnly(...)boolean beforeCompletionInvokedboolean unexpectedRollbackreleaseHeldSavepoint(...)isFailEarlyOnGlobalRollbackOnly(...)isRollbackOnCommitFailure(...)/** This implementation of rollback handles participating in existing ... */rollbackToHeldSavepoint(...)isGlobalRollbackOnParticipationFailure(...)Throwable rbex/** Return whether to use a savepoint for a nested transaction. ... *//** Return whether to call {@code doCommit} on a transaction that has been ... */// Create savepoint within existing Spring-managed transaction,// through the SavepointManager API implemented by TransactionStatus.// Usually uses JDBC 3.0 savepoints. Never activates Spring synchronization.// Usually only for JTA: Spring synchronization might get activated here// in case of a pre-existing JTA transaction.// doSuspend failed - original transaction is still active...// Throw UnexpectedRollbackException if we have a global rollback-only// marker but still didn't get a corresponding exception from commit.// can only be caused by doCommit// Trigger afterCommit callbacks, with an exception thrown there// propagated to callers but the transaction still considered as committed.// Unexpected rollback only matters here if we're asked to fail early// Raise UnexpectedRollbackException if we had a global rollback-only marker/** Abstract base implementation of the ... */Object savepoint, ...;// Implementation of TransactionExecution/** Determine the rollback-only flag via checking both the local rollback-only flag ... *//** Determine the rollback-only flag via checking this TransactionStatus. ... *//** Template method for determining the global rollback-only flag of the ... */// Handling of current savepoint statethis.savepoint/** Set a savepoint for this transaction. Useful for PROPAGATION_NESTED. ... *//** Get the savepoint for this transaction, if any. *//** Create a savepoint and hold it for the transaction. ... *//** Roll back to the savepoint that is held for the transaction ... */getSavepoint(...)/** Release the savepoint that is held for the transaction. *//** This implementation delegates to a SavepointManager for the ... *//** Return a SavepointManager for the underlying transaction, if possible. ... *//** This implementations is empty, considering flush as a no-op. */// Flushing support/** Extension of the {@link org.springframework.transaction.PlatformTransactionManager} ... *//** Default implementation of the {@link TransactionDefinition} interface, ... */String PREFIX_PROPAGATION, ...;/** Prefix for the propagation constants defined in TransactionDefinition. */String PREFIX_ISOLATION, ...;/** Prefix for the isolation constants defined in TransactionDefinition. */String PREFIX_TIMEOUT, ...;/** Prefix for transaction timeout values in description strings. */String READ_ONLY_MARKER, ...;/** Marker for read-only transactions in description strings. */int propagationBehavior, ...;int isolationLevel, ...;/** Create a new DefaultTransactionDefinition, with default settings. ... */this.propagationBehavior/** Create a new DefaultTransactionDefinition with the given ... *//** Set the propagation behavior by the name of the corresponding constant in ... *//** Set the propagation behavior. Must be one of the propagation constants ... *//** Set the isolation level by the name of the corresponding constant in ... *//** Set the isolation level. Must be one of the isolation constants ... *//** Set the timeout to apply, as number of seconds. ... *//** Set whether to optimize as read-only transaction. ... *//** Set the name of this transaction. Default is none. ... *//** Return an identifying description for this transaction definition. ... *//** Default implementation of the {@link org.springframework.transaction.TransactionStatus} ... *//** Create a new {@code DefaultTransactionStatus} instance. ... *//** Determine the rollback-only flag via checking the transaction object, provided ... */// Enable functionality through underlying transaction object/** This implementation exposes the {@link SavepointManager} interface ... *//** Return whether the underlying transaction implements the {@link SavepointManager} ... *//** Delegate the flushing to the transaction object, provided that the latter ... *//** {@link TransactionDefinition} implementation that delegates all calls to a given target ... */TransactionDefinition targetDefinition, ...;this.targetDefinition/** Generic interface to be implemented by resource holders. ... *//** Reset the transactional state of this holder. *//** Notify this holder that it has been unbound from transaction synchronization. *//** Determine whether this holder is considered as 'void', ... *//** Convenient base class for resource holders. ... */Date deadline, ...;int referenceCount, ...;boolean isVoid, ...;/** Mark the resource as synchronized with a transaction. *//** Return whether the resource is synchronized with a transaction. *//** Mark the resource transaction as rollback-only. *//** Reset the rollback-only status for this resource transaction. ... *//** Return whether the resource transaction is marked as rollback-only. *//** Set the timeout for this object in seconds. ... *//** Set the timeout for this object in milliseconds. ... */this.deadline/** Return whether this object has an associated timeout. *//** Return the expiration deadline of this object. ... *//** Return the time to live for this object in seconds. ... */double diffint secscheckTransactionTimeout(...)/** Return the time to live for this object in milliseconds. ... */long timeToLive/** Set the transaction rollback-only if the deadline has been reached, ... */new TransactionTimedOutException(...)/** Increase the reference count by one because the holder has been requested ... */this.referenceCount/** Decrease the reference count by one because the holder has been released ... *//** Return whether there are still open references to this holder. *//** Clear the transactional state of this resource holder. *//** Reset this resource holder - transactional state as well as reference count. */this.isVoidH resourceHolder, ...;/** Create a new ResourceHolderSynchronization for the given holder. ... */flushResource(...)unbound(...)/** Flush callback for the given resource holder. ... *//** Extended variant of {@link TransactionDefinition}, indicating a resource transaction ... *//** Determine whether the transactional resource is ready for local optimizations. ... *//** Return the resource factory that this transaction manager operates on, ... *//** A simple transaction-backed {@link Scope} implementation, delegating to ... */ScopedObjectsHolder scopedObjectsscopedObjects.scopedInstancesnew ScopedObjectsHolder(...)new CleanupSynchronization(...)scopedObjects.destructionCallbacks/** Holder for scoped objects. */new LinkedHashMap<String,Runnable>(...)Map<String,Object> scopedInstances, ...;Map<String,Runnable> destructionCallbacks, ...;ScopedObjectsHolder scopedObjects, ...;this.scopedObjectsSimpleTransactionScope.thisthis.scopedObjects.destructionCallbacksthis.scopedObjects.scopedInstances/** A simple {@link org.springframework.transaction.TransactionStatus} ... *//** Create a new {@code SimpleTransactionStatus} instance, ... *//** Create a new {@code SimpleTransactionStatus} instance. ... *//** Interface to be implemented by transaction objects that are able to ... *//** Return whether the transaction is internally marked as rollback-only. ... *//** Flush the underlying sessions to the datastore, if applicable: ... *//** Callback interface for transactional code. Used with {@link TransactionTemplate}'s ... *//** Gets called by {@link TransactionTemplate#execute} within a transactional context. ... *//** Simple convenience class for TransactionCallback implementation. ... */doInTransactionWithoutResult(...)/** Gets called by {@code TransactionTemplate.execute} within a transactional ... *//** Interface specifying basic transaction execution operations. ... *//** Execute the action specified by the given {@link Runnable} within a transaction. ... *//** Return an implementation of the {@code TransactionOperations} interface which ... */WithoutTransactionOperations.INSTANCE/** Interface for transaction synchronization callbacks. ... *//** Return the execution order for this transaction synchronization. ... *//** Simple {@link TransactionSynchronization} adapter containing empty ... *//** Central delegate that manages resources and transaction synchronizations per thread. ... */new NamedThreadLocal<Map<Object,Object>>(...)new NamedThreadLocal<Set<TransactionSynchronization>>(...)new NamedThreadLocal<Boolean>(...)new NamedThreadLocal<Integer>(...)ThreadLocal<Map<Object,Object>> resources, ...;ThreadLocal<Set<TransactionSynchronization>> synchronizations, ...;ThreadLocal<String> currentTransactionName, ...;ThreadLocal<Boolean> currentTransactionReadOnly, ...;ThreadLocal<Integer> currentTransactionIsolationLevel, ...;ThreadLocal<Boolean> actualTransactionActive, ...;/** Return all resources that are bound to the current thread. ... */// Management of transaction-associated resource handles/** Bind the given resource for the given key to the current thread. ... *//** Unbind a resource for the given key from the current thread. ... *//** Return if transaction synchronization is active for the current thread. ... *//** Activate transaction synchronization for the current thread. ... *//** Register a new transaction synchronization for the current thread. ... *//** Deactivate transaction synchronization for the current thread. ... *//** Clear the entire transaction synchronization state for the current thread: ... */// Transparently remove ResourceHolder that was marked as void...// Remove entire ThreadLocal if empty...// set ThreadLocal Map if none found// Transparently suppress a ResourceHolder that was marked as void.../** Check whether the given resource transaction manager refers to the given ... */getResourceFactory(...)/** Trigger {@code flush} callbacks on all currently registered synchronizations. ... *//** Trigger {@code beforeCommit} callbacks on all currently registered synchronizations. ... *//** Trigger {@code beforeCompletion} callbacks on all currently registered synchronizations. ... *//** Trigger {@code afterCommit} callbacks on all currently registered synchronizations. ... *//** Trigger {@code afterCompletion} callbacks on all currently registered synchronizations. ... *//** Template class that simplifies programmatic transaction demarcation and ... *//** Construct a new TransactionTemplate for bean usage. ... *//** Construct a new TransactionTemplate using the given transaction manager. ... *//** Set the transaction management strategy to be used. */// Transactional code threw application exception -> rollback// Transactional code threw unexpected exception -> rollback/** A {@link TransactionOperations} implementation which executes a given ... */new WithoutTransactionOperations(...)WithoutTransactionOperations INSTANCE, ...;/** Support classes for the org.springframework.transaction package. ... */import MapPersistenceExceptionTranslator/** Tests for PersistenceExceptionTranslationAdvisor's exception translation, as applied by ... */RuntimeException doNotTranslate, ...;PersistenceException persistenceException1, ...;MapPersistenceExceptionTranslator mpetnew MapPersistenceExceptionTranslator(...)addTranslation(...)RepositoryInterface.classaddPersistenceExceptionTranslation(...)RepositoryInterfaceImpl targetnew RepositoryInterfaceImpl(...)RepositoryInterface rinoThrowsClause(...)throwsPersistenceException(...)setBehavior(...)new StereotypedRepositoryInterfaceImpl(...)doTestTranslationNeededForTheseExceptions(...)new MyStereotypedRepositoryInterfaceImpl(...)new CustomStereotypedRepositoryInterfaceImpl(...)new MyInterfaceStereotypedRepositoryInterfaceImpl(...)new MyInterfaceInheritedStereotypedRepositoryInterfaceImpl(...)RuntimeException runtimeException, ...;this.runtimeException// Extends above class just to add repository annotation/** Tests for standalone usage of a PersistenceExceptionTranslationInterceptor, ... */PersistenceExceptionTranslationInterceptor.classList<Integer> callOrderPersistenceExceptionTranslationInterceptor interceptornew CallOrderAwareExceptionTranslator(...)setAlwaysTranslate(...)List<Integer> callOrder, ...;this.callOrderimport RepositoryInterfaceimport RepositoryInterfaceImplimport StereotypedRepositoryInterfaceImplRepositoryInterface shouldNotBeProxiedRepositoryInterface shouldBeProxiedRepositoryWithoutInterface rwiAdditional rwi2PersistenceExceptionTranslationPostProcessor.classRepositoryInterfaceImpl.classStereotypedRepositoryInterfaceImpl.classRepositoryWithoutInterface.classRepositoryWithoutInterfaceAndOtherwiseAdvised.classMyPersistenceExceptionTranslator.classLogAllAspect.classcheckWillTranslateExceptions(...)additionalMethod(...)PersistenceExceptionTranslationAdvisor.classChainedPersistenceExceptionTranslator petRuntimeException inMapPersistenceExceptionTranslator mpet1InvalidDataAccessApiUsageException out1InvalidDataAccessApiUsageException out2ChainedPersistenceExceptionTranslator chainedPet1MapPersistenceExceptionTranslator mpet2ChainedPersistenceExceptionTranslator chainedPet2RuntimeException in2OptimisticLockingFailureException out3new OptimisticLockingFailureException(...)MapPersistenceExceptionTranslator mpet3//MapPersistenceExceptionTranslator mpet = new MapPersistenceExceptionTranslator();// Now add a new translator and verify it winsCollection<String> coluniqueResult(...)sizeRequirements(...)intResult(...)longResult(...)Collection<Integer> colCollection<Long> colnew HashSet<Long>(...)Collection<Date> colnew HashSet<Date>(...)InvalidDataAccessApiUsageException outgetExpectedSize(...)getActualSize(...)new HashMap<RuntimeException,RuntimeException>(...)Map<RuntimeException,RuntimeException> translations, ...;// in to outthis.translationsimport LocalTransactionimport CciLocalTransactionManagerimport CciTemplate/** Test if a transaction ( begin / commit ) is executed on the ... */Interaction.classLocalTransaction localTransactionLocalTransaction.classRecord recordRecord.classInteractionSpec.classCciLocalTransactionManager tmnew CciLocalTransactionManager(...)CciTemplate ct/** Test if a transaction ( begin / rollback ) is executed on the ... */import ConnectionSpecConnectionFactoryAdapterimport NotSupportedRecordFactoryimport InteractionCallbackimport RecordCreatorimport RecordExtractorRecordFactory.classIndexedRecord indexedRecordIndexedRecord.classMappedRecord mappedRecordMappedRecord.classRecord inputRecordRecord outputRecordnew RecordCreator(...) { ... }RecordCreator creatorRecordCreator.classRecordExtractor<Object> extractorRecordExtractor<>.classRecordCreator generatorConnectionSpec connectionSpecConnectionSpec.classConnectionSpecConnectionFactoryAdapter adapternew ConnectionSpecConnectionFactoryAdapter(...)ResultSet resultsetConnectionCallback<Object> connectionCallbackConnectionCallback<>.classInteractionCallback<Object> interactionCallbackInteractionCallback<>.classRecord inputOutputRecordRecord tmpOutputRecordimport MappingRecordOperationimport SimpleRecordOperationSimpleRecordOperation querynew SimpleRecordOperation(...)SimpleRecordOperation operationQueryCallDetector callDetectorQueryCallDetector.classMappingRecordOperationImpl querynew MappingRecordOperationImpl(...)Object inObjObject outObjsetCallDetector(...)callCreateInputRecord(...)callExtractOutputData(...)RecordCreator outputCreatorQueryCallDetector callDetector, ...;this.callDetector/** Unit tests for the {@link LocalConnectionFactoryBean} class. ... */new LocalConnectionFactoryBean(...)LocalConnectionFactoryBean factoryObject CONNECTION_FACTORYManagedConnectionFactory managedConnectionFactoryManagedConnectionFactory.classsetManagedConnectionFactory(...)ConnectionManager connectionManagerConnectionManager.classsetConnectionManager(...)doTestJtaTransactionManagerWithDefaultJndiLookups(...)UserTransactionAdapter utasetUserTransactionName(...)setTransactionManagerName(...)UserTransaction ut2setCacheUserTransaction(...)JtaTransactionManager.SYNCHRONIZATION_ALWAYS/** Prevent any side-effects due to this test modifying ThreadLocals that might ... */TransactionSynchronization.classnewJtaTransactionManager(...)JtaTransactionManager.SYNCHRONIZATION_ON_ACTUAL_TRANSACTIONJtaTransactionManager.SYNCHRONIZATION_NEVERsetTransactionSynchronizationName(...)setGlobalRollbackOnParticipationFailure(...)MockJtaTransaction txnew MockJtaTransaction(...)getSynchronization(...)TransactionSuspensionNotSupportedException.classNestedTransactionNotSupportedException.classdoTestJtaTransactionManagerWithNoExceptionOnGlobalRollbackOnly(...)JtaTransactionManager tmnew HeuristicMixedException(...)HeuristicCompletionException.classnew Consumer<HeuristicCompletionException>(...) { ... }getOutcomeState(...)new HeuristicRollbackException(...)// first commit// second commit attempt// first rollback// second rollback attempt// first: rollback// second: commit attemptTransactionStatus status, ...;Synchronization synchronization, ...;this.synchronizationObject TRANSACTION, ...;boolean existingTransaction, ...;boolean canCreateTransaction, ...;boolean begin, ...;boolean commit, ...;boolean rollback, ...;this.existingTransactionthis.canCreateTransactionthis.beginthis.committhis.rollbacknew TestTransactionManager(...)DefaultTransactionStatus status1DefaultTransactionStatus status2DefaultTransactionStatus status3TestTransactionManager tmtm.begintm.committm.rollbacktm.rollbackOnlyTransactionTemplate templateMockCallbackPreferringTransactionManager ptmnew MockCallbackPreferringTransactionManager(...)getDefinition(...)TransactionSystemException texnew TestTransactionManager(...) { ... }TestTransactionManager tm1TestTransactionManager tm2TransactionTemplate template1TransactionTemplate template2TransactionTemplate template3BeanComponentDefinition.classMethod getAgeMethod, ...;Method setAgeMethod, ...;this.getAgeMethodthis.setAgeMethodCallCountingTransactionManager ptmptm.begunptm.lastDefinitionptm.commitsptm.rollbacksTransactionInterceptor txInterceptorTransactionAttributeSource txAttrSource// try with transactional// try with non-transaction// try with exceptionalTestBean1 tbnew TestBean1(...)AnnotationTransactionAttributeSource tasTransactionInterceptor tiITestBean1 proxyITestBean1 serializedProxyTransactionInterceptor serializedTiCallCountingTransactionManager serializedPtmITestBean1.classserializedPtm.commitsEmpty.classAnnotationTransactionAttributeSource atas/** Test the important case where the invocation is on a proxied interface method ... */Method classMethodTransactionAttribute actualTestBean1.class/** Test case where attribute is on the interface method. */ITestBean2.classTestBean2.class/** Test that when an attribute exists on both class and interface, class takes precedence. */ITestBean3.classMethod interfaceMethod2Method interfaceMethod3TestBean3.classTransactionAttribute actual2TransactionAttribute actual3TransactionAttribute.PROPAGATION_REQUIRES_NEWTransactionAttribute.ISOLATION_REPEATABLE_READTransactionAttribute.PROPAGATION_REQUIREDTestBean11.class/** Test that transaction attribute is inherited from class ... */TestBean4.classTestBean5.classTestBean6.classTestBean7.classTestBean8.classTestInterface9.classTransactional annotationTestBean9.classTestInterface10.classTestBean10.classMethod getAgeMethodMethod getNameMethodTransactionAttribute getAgeAttrEjb3AnnotatedBean1.classTransactionAttribute getNameAttrTransactionAttribute.PROPAGATION_SUPPORTSEjb3AnnotatedBean2.classITestEjb.classEjb3AnnotatedBean3.classJtaAnnotatedBean1.classJtaAnnotatedBean2.classJtaAnnotatedBean3.classMethod getMetaClassMethodGroovyObject.classGroovyTestBean.classPropagation.REQUIRES_NEWIsolation.REPEATABLE_READTransactionAttributeType.SUPPORTSTransactional.TxType.SUPPORTSTransactional.TxType// Try again in case of cachingimport ReactiveCallCountingTransactionManagernew ReactiveCallCountingTransactionManager(...)this.ptmCallCountingTransactionManager ptm, ...;ReactiveCallCountingTransactionManager rtm, ...;AnnotationTransactionAttributeSource source, ...;TransactionInterceptor ti, ...;TestClassLevelOnly proxynew TestClassLevelOnly(...)this.tiassertGetTransactionAndCommitCount(...)doSomethingElse(...)TestWithSingleMethodOverride proxynew TestWithSingleMethodOverride(...)doSomethingCompletelyElse(...)TestWithSingleMethodOverrideInverted proxynew TestWithSingleMethodOverrideInverted(...)TestWithMultiMethodOverride proxynew TestWithMultiMethodOverride(...)TestWithExceptions proxynew TestWithExceptions(...)doSomethingErroneous(...)new Consumer<IllegalStateException>(...) { ... }assertGetTransactionAndRollbackCount(...)doSomethingElseErroneous(...)doSomethingElseWithCheckedException(...)doSomethingElseWithCheckedExcep    <    